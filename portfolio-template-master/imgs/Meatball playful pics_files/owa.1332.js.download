self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1332.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1332],{12142:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n(2013),i=n(2272),a=n(2449),c=n(23),u=n(2050);function s(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return 1!==(n=t.tableQuery).listViewType?[3,2]:(i={Id:e,mailboxInfo:Object(o.d)(n)},[4,a.f.importAndExecute(i,"LoadNudgedItem")]);case 1:return[2,r.sent()];case 2:return[2,d(e,t)]}}))}))}function d(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,a;return Object(r.f)(this,(function(r){return n=t.tableQuery,a=Object(o.d)(n),[2,i.i.importAndExecute(e,n.folderId,n.sortBy,Object(u.l)(n),n.requestShapeName,a).then((function(e){return e})).catch((function(e){return c.g.warn("loadNudgedConversation throws an exception"+e.message),null}))]}))}))}var l=n(24),f=n(197),b=n(440),O="https://outlook.office.com/FocusedInboxB2",w="https://outlook.office.com/M365.Access";function v(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,g(e,t)];case 1:return(n=r.sent())?((o=new Headers).authorization="Bearer "+n,[2,o]):[2,null]}}))}))}function g(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,o,i;return Object(r.f)(this,(function(a){switch(a.label){case 0:return Object(f.a)()?[3,3]:(n=Object(r.g)(Object(b.getAccessTokenforResourceAsLazy)(O,t,e),2),o=n[0],i=n[1],o?[3,2]:[4,i]);case 1:o=a.sent(),a.label=2;case 2:return[2,o];case 3:if(Object(l.i)("tri-nudge-consumer"))return[2,Object(b.getDelegationTokenForOwa)(w,t,e)];a.label=4;case 4:return[2,null]}}))}))}var I=n(151),m=n(217),j=n(146),h=n(172);function y(e){var t=parseInt(e)||-1;return-1!=t&&Object(h.a)(t)||503==t||-1==t}var p="FocusedInboxB2/api/v1/Nudges/GetNudges",N=1500;function R(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n,o,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,v(e,"getNudge")];case 1:if(!(t=r.sent()))return[2,{getNudgesResponse:null,errorOrStatus:"Token Failure"}];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Object(I.b)(p,e,!0,t,!0,!1,"GetNudges")];case 3:return n=r.sent(),[3,5];case 4:return[2,{errorDetails:r.sent().message,errorOrStatus:"RequestNotComplete"}];case 5:return r.trys.push([5,13,,14]),Object(m.a)(n.status)?[4,n.json()]:[3,10];case 6:return(o=r.sent()).Nudges?[2,{getNudgesResponse:o,errorOrStatus:n.status}]:[3,7];case 7:return[4,n.text()];case 8:return[2,{errorOrStatus:"No Nudges",errorDetails:i=r.sent()}];case 9:return[3,12];case 10:return[4,n.text()];case 11:return(null==(i=r.sent())?void 0:i.toLowerCase().indexOf("html"))>-1&&(i=""),[2,{errorOrStatus:n.status,errorDetails:i}];case 12:return[3,14];case 13:return r.sent(),[2,{errorOrStatus:"Parse Error"}];case 14:return[2]}}))}))}function S(e){return function e(t,n,o){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(r){switch(r.label){case 0:return n>2?[2,o]:[4,R(t)];case 1:return y((o=r.sent()).errorOrStatus)?[4,Object(j.a)(N)]:[3,3];case 2:return r.sent(),[2,e(t,n+1,o)];case 3:return o.retryAttempt=n,[2,o]}}))}))}(e,1,null)}var _=n(1947),T=n(8),E=n(1244);function C(e){switch(e){case"Received":return 0;case"Sent":return 1;default:return c.g.warn("No nudge reason returned in GetNudge server response"),0}}var L=n(3547),K=n(2474),A=n(3548),D=n(9594),x=n(2384),V=n(2401);function P(e,t){var n=t.rowKeys.indexOf(e);if(-1!=n){var r=_.b.getLastDeliveryOrRenewTimeStamp(e,t);if(Object(V.a)(e,t.id,r)){var o=Object(A.a)(r,_.b.getLastDeliveryTimeStamp(e,t),t,n+1);-1==o?Object(K.a)([e],t,"NotNudgeAnymore"):(Object(D.a)([e],t),x.a.updateRowPosition(--o,e,t))}}}var M=n(121),F=n(31),k=n(203),U=n(2965),G=n(1955),B=n(5);function W(e,t,n){Object(M.s)("Nudge_RowRemove",{owa_1:t,owa_2:n,rKey:e},{isCore:!0})}var Q=n(5487),z=n(1964);function J(e){var t,n=(null!==(t=e.IconIndex)&&void 0!==t?t:"").toString().toLowerCase();return n.indexOf("replied")>-1||n.indexOf("forwarded")>-1}function H(e,t,n,r,o,i,a,u,s,d){var l=a?"inbox":"sentitems";Object(M.s)("Nudge_Discarded",{owa_1:e,owa_2:o,owa_3:i,owa_4:l,owa_5:s,rt:u,itemId:t,cId:n,crId:r,lGId:d},{isCore:!0}),c.g.warn("Nudge Discarded - isConversationView: "+o+" itemId: "+t+" conversationId: "+n+" folderId: "+l+" isNudgeFromOtherTable: "+i)}function $(e,t,n,r,o,i,a,c){var u,s;void 0===c&&(c=!0),_.b.getIsPinned(i,r)&&(u="RowPinned");var d=Object(_.S)(r);if(!u&&d){s=_.b.getLatestGlobalItemId(i,r);var l=_.b.getDraftItemIds(i,r);i&&-1==l.indexOf(s)&&s!=e&&(u="NotLatestItemInRow")}else{var f=Object(G.b)().items.get(e);f&&J(f)&&(u="NotLatestItemInRow")}if(u){var b=_.b.getLastDeliveryOrRenewTimeStamp(i,r);return c&&H(u,e,t,n,d,!1,o,b,a,s),u}return null}var q,X,Y=n(4),Z=!1,ee={},te=36e5,ne=18e5,re=Object(F.e)(Q.a,"getNudgesOnNudgeOptionChangeClone",(function(e){ce(!0,"SettingChange")})),oe=Object(F.e)(U.a,"clone_onSelectFolderComplete",(function(e){var t=e.selectedFolderId,n=e.previousFolderId,r=e.isExitingSearch;t==n||r||ce(!1,"FolderSwitch")})),ie=Object(F.e)(V.i,"clone_getNudgesOnNudgeRemoved",(function(e){Object(l.i)("tri-nudgePolling")&&(X=setTimeout((function(){return ce(!0,"NudgeRemoval")}),9e5))}));function ae(e,t){"visible"===document.visibilityState&&ce(e,t)}function ce(e,t){if(!Z&&Object(L.b)()){var n=Object(l.i)("tri-nudgePolling");!q&&n&&(q=!0,document.addEventListener("visibilitychange",(function(){return ae(!1,"VisibilityChange")})));var o=Object(_.J)(),i=o.tableQuery.folderId;if(Object(L.a)(i)){if(n){if(!e&&Date.now()-ee[i]<=ne)return;X&&(clearTimeout(X),X=null),X=setTimeout((function(){return ae(!1,"Timer")}),te)}!function(e,t,n){var o;Object(r.c)(this,void 0,void 0,(function(){var i,a,s,d,l,f,b,O,w,v,g,I,m,j,h,y,p,N,R;return Object(r.f)(this,(function(C){switch(C.label){case 0:return Z=!0,i=Object(k.a)(),a=Date.now(),[4,S(i)];case 1:if(s=C.sent(),d=[],l=s,f=Date.now()-a,!(null===(o=null==l?void 0:l.getNudgesResponse)||void 0===o?void 0:o.Nudges))return[3,6];b=l.getNudgesResponse.Nudges,O=0,w=[],v=[],g="sentitems"==Object(z.a)(e),I=0,C.label=2;case 2:return I<b.length?(m=b[I],j=m.FolderId.Id,h=m.ItemId.Id,w.push(h),g&&j!=e?[3,4]:[4,ue(m,t,i,!g,n)]):[3,5];case 3:(y=C.sent())&&(d.push(y),v.push(h)),O++,C.label=4;case 4:return I++,[3,2];case 5:return se(b.length,O,d.length,n,i,w.join(","),f,v.join(","),l.errorOrStatus,"",l.retryAttempt),[3,7];case 6:se(0,0,0,n,i,"",f,"",l.errorOrStatus,Object(Y.M)(l.errorDetails),l.retryAttempt),C.label=7;case 7:return p=Object(T.a)("testOldNudge"),0!=decodeURIComponent(p||"").trim().length&&(d.push({rowKey:"testNudgeRowKey",itemId:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId=",conversationId:"getTestNudgeRowDataForRowNotLoadedInTableViewConversationId=",tableViewId:t.id,reason:0,daysAgo:7}),N={ConversationId:{__type:"ItemId:#Exchange",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewConversationId="},ConversationTopic:"This is a test Nudge Email that is older than the loaded rows",UniqueSenders:["Sayali Shah"],LastDeliveryTime:"2019-10-01T15:30:58-07:00",HasAttachments:!1,MessageCount:1,GlobalMessageCount:1,UnreadCount:1,GlobalUnreadCount:1,Size:1234,ItemClasses:["IPM.Note"],Importance:null,ItemIds:[{__type:"ItemId:#Exchange",ChangeKey:"CQAAAA==",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId="}],GlobalItemIds:[{__type:"ItemId:#Exchange",ChangeKey:"CQAAAA==",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId="}],LastModifiedTime:"2019-10-29T15:30:59-07:00",InstanceKey:"testNudgeRowKey",Preview:"Test nudge email for row that is not loaded",HasIrm:!1,IsLocked:!1,FamilyId:{__type:"ItemId:#Exchange",Id:"AAQkAGZjM2NmMGY1LTkzMzgtNGNhMy04ODg5LWQwMjJjMDc0YjJlMAAQAH9+ZbR0rbRFncY81mWHT1E="},LastDeliveryOrRenewTime:"2019-10-01T15:30:58-07:00",HasAttachmentPreviews:!1,LastSender:{Mailbox:{Name:"Sayali Shah",EmailAddress:"sayalis@microsoft.com",RoutingType:"SMTP"}}},t.rowKeys.indexOf("testNudgeRowKey")<0&&(R=Object(u.f)(t,0),x.a.addRow(R,N,t))),d.push.apply(d,Object(r.j)([],Object(r.g)(function(e){var t=Object(T.a)("testNudge");if(0==decodeURIComponent(t||"").trim().length)return[];var n=[];if(e.rowKeys.length>0){var r=e.tableQuery.folderId===Object(E.a)("sentitems")?1:0,o={rowKey:e.rowKeys[4],itemId:_.b.getItemIds(e.rowKeys[0],e)[0],conversationId:_.b.getConversationId(e.rowKeys[4],e),tableViewId:e.id,reason:r,daysAgo:1};if(n.push(o),e.rowKeys.length>3){var i={rowKey:e.rowKeys[6],itemId:_.b.getItemIds(e.rowKeys[3],e)[0],conversationId:_.b.getConversationId(e.rowKeys[6],e),tableViewId:e.id,reason:r,daysAgo:0};n.push(i)}if(e.rowKeys.length>10&&1===Math.floor(2*Math.random())){var a={rowKey:e.rowKeys[10],itemId:_.b.getItemIds(e.rowKeys[10],e)[0],conversationId:_.b.getConversationId(e.rowKeys[10],e),tableViewId:e.id,reason:r,daysAgo:3};n.push(a)}}return n}(t)))),Object(V.f)().nudgedRows.forEach((function(e){var n=e.rowKey;e.tableViewId!=t.id||d.some((function(t){return t.rowKey===n&&t.tableViewId===e.tableViewId}))||(P(n,t),W(n,"NotReceivedAsNudgeAnyMore",e.reason)),e.tableViewId!=t.id&&d.push(e)})),Object(V.h)(d,t),c.g.info("Nudge: onSelectFolderCompleteOrchestrator new nudges length: "+d.length),Z=!1,[2]}}))}))}(i,o,t),ee[i]=Date.now()}}}function ue(e,t,n,i,d){return Object(r.c)(this,void 0,void 0,(function(){var l,f,b,O,w,v,g,I,m,j,h,y,p,N;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),l=void 0,f=void 0,b=e.ItemId.Id,O=e.ConversationId.Id,w=e.NudgeReason.Reason,v=Object(_.S)(t),g=v?O:b,I=Object(_.G)([g],t),m=i?"Sent"==w:"Received"==w,0!==I.length?[3,2]:[4,s(g,t)];case 1:return j=r.sent(),f=function(e,t,n,r,o,i,a,c,u){var s,d,l,f;if(e||(d=c?"ItemFromOtherTable":"RowNotFound"),!d){var b=void 0;b=o?e.LastDeliveryOrRenewTime:e.ReceivedOrRenewTime,Object(_.w)(b)&&(d="RowPinned")}if(!d)if(o){var O=e;f=O.LastDeliveryOrRenewTime,l=O.GlobalItemIds[0].Id,0==(O.DraftItemIds||[]).filter((function(e){return e.Id==l})).length&&l!=t&&(d="NotLatestItemInRow")}else{var w=e;f=w.ReceivedOrRenewTime,J(w)?d="NotLatestItemInRow":(null===(s=w.ParentFolderId)||void 0===s?void 0:s.Id)!=i.tableQuery.folderId&&(d="ItemFromOtherTable")}return d?(H(d,t,n,r,o,c,a,f,u,l),d):null}(j,b,O,n,v,t,i,m,d),l=null==j?void 0:j.InstanceKey,f||t.rowKeys.indexOf(l)<0&&(h=Object(u.f)(t,0),x.a.addRow(h,j,t)),[3,3];case 2:f=$(b,O,n,t,i,I[0],d),l=I[0],r.label=3;case 3:return!f&&l?(function(e,t){if(1===e.listViewType){var n=Object(G.b)().items.get(t);n&&n.NormalizedBody||a.f.importAndExecute({Id:t,mailboxInfo:Object(o.d)(e)},"LoadNudgedItem")}else Object(G.b)().conversations.get(t)||a.e.importAndExecute({Id:t,mailboxInfo:Object(o.d)(e)},"LoadNudgedConversation")}(t.tableQuery,g),y=e.MessageReceivedOrSentTimeUTC||_.b.getLastDeliveryTimeStamp(l,t),p=Object(B.s)(Object(B.nc)(),Object(B.nc)(y)),[2,{rowKey:l,itemId:b,conversationId:O,tableViewId:t.id,reason:C(e.NudgeReason.Reason),daysAgo:p}]):[2,null];case 4:return N=r.sent(),c.g.warn("Nudge: processNudgeResponse throws an exception"+N.message),[2,null];case 5:return[2]}}))}))}function se(e,t,n,r,o,i,a,c,u,s,d){Object(M.s)("Nudge_GetNudge",{owa_1:e,owa_2:t,owa_3:n,owa_4:r,cId:o,itemId:i,latency:a,validItemId:c,error:null==u?void 0:u.toString(),errorMessage:s,retryAttempt:d})}var de="FocusedInboxB2/api/v1/Nudges/UpdateNudge",le=1500;function fe(e,t,n){return Object(r.c)(this,void 0,void 0,(function(){var o,i,a,c,u;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,v(n,"updateNudge")];case 1:if(!(o=r.sent()))return[2,{errorMessage:"Token Failure"}];i={ItemId:{Id:e},NudgeAction:t},r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Object(I.e)(de,i,n,!0,o,!0,!1,!1,"UpdateNudges")];case 3:return a=r.sent(),[3,5];case 4:return[2,{errorDetails:r.sent().message,errorMessage:"RequestNotComplete"}];case 5:return r.trys.push([5,7,,8]),c=a.status,Object(m.a)(c)?[2,{status:c,errorMessage:"No error",errorDetails:""}]:[4,a.text()];case 6:return(null==(u=r.sent())?void 0:u.toLowerCase().indexOf("html"))>-1&&(u=""),[2,{status:c,errorMessage:c,errorDetails:u}];case 7:return r.sent(),[2,{errorMessage:"Parse Error"}];case 8:return[2]}}))}))}function be(e,t,n,o){var i=Object(k.a)();return function e(t,n,o,i,a,c,u){return Object(r.c)(this,void 0,void 0,(function(){var s;return Object(r.f)(this,(function(r){switch(r.label){case 0:return a>3?[2]:[4,fe(t,n,u)];case 1:return s=r.sent(),function(e,t,n,r,o,i,a,c,u){Object(M.s)("Nudge_Update",{owa_1:e,owa_2:t,owa_3:n,owa_4:o,owa_5:a,itemId:r,errorDetails:Object(Y.M)(i),rA:c,crId:u},{isCore:!0})}(n,o,i,t,s.errorMessage,s.errorDetails,s.status,a,u),y(s.status.toString())?[4,Object(j.a)(c)]:[3,3];case 2:r.sent(),e(t,n,o,i,a+1,2*c,u),r.label=3;case 3:return[2]}}))}))}(e,t,n,o,1,le,i)}var Oe,we,ve=n(2292),ge=n(3313),Ie=n(3314),me=n(4563),je=n(5882),he=n(6975),ye=n(3150),pe=n(3457),Ne=Object(F.e)(he.b,"clone_onNudgeInfoBarClicked",(function(e){var t=e.response===he.a.MarkComplete?"MarkedComplete":"DismissedOnView";De(e.rowKey,e.itemId,t,"ReadingPane")})),Re=Object(F.e)(je.a,"clone_onDismissNudgeClicked",(function(e){Object(V.f)().nudgedRows.filter((function(t){return t.rowKey===e.rowKey&&t.tableViewId===e.tableViewId})).forEach((function(t){De(e.rowKey,t.itemId,"Dismissed",e.actionSource)}))})),Se=Object(F.e)(Ie.a,"clone_markItemsAsPinnedStoreUpdate",(function(e){Ae(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned)})),_e=Object(F.e)(ge.a,"clone_markConversationsAsPinnedStoreUpdate",(function(e){Ae(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned)})),Te=Object(F.e)(ve.a,"clone_deleteItemsStoreUpdate",(function(e){e.itemContexts.map((function(e){return e.itemId})).forEach((function(t){var n=Object(V.e)(t);n&&(Object(V.i)(n),W(n,e.actionType,Ve(n)))}))})),Ee=Object(F.e)(K.a,"clone_removeRowsFromListViewStore",(function(e){xe(e.rowKeys,e.tableView.id,e.actionType)})),Ce=Object(F.e)(me.a,"clone_onSendMessageSucceeded",(function(e){var t=e.operation;if(1===t||2===t||3===t){e.referenceItemId||c.g.warn("Nudge: referenceItemId should not be null for r/R/f operations");var n,r=e.referenceItemId.Id,o=e.conversationId,i=Object(V.e)(r);i||(i=Object(V.d)(o)),i?(P(i,Object(_.J)()),n=Ve(i),Object(V.i)(i)):Oe==r&&(i=we),i&&Object(M.s)("Nudge_Reply",{owa_1:t,owa_2:n,refId:r,cId:o,rKey:i},{isCore:!0})}})),Le=Object(F.e)(pe.a,"clone_removeNudgeUponRowUpdate",(function(e){var t=Object(V.f)().nudgedRows.filter((function(t){return t.rowKey===e.rowKey}));if(t.length>0){var n=$(t[0].itemId,t[0].conversationId,null,e.tableView,"inbox"==Object(z.a)(e.tableView.tableQuery.folderId),e.rowKey,"RowRemove",!1);n&&(Oe=t[0].itemId,we=e.rowKey,P(e.rowKey,e.tableView),xe([e.rowKey],e.tableView.id,n))}})),Ke=Object(F.e)(Q.a,"updateNudgesOnNudgeOptionChangeClone",(function(e){if(Object(ye.a)(32)){var t=Object(V.f)().nudgedRows.map((function(e){return e.rowKey})),n=Object(_.J)();t.forEach((function(e){P(e,n),xe([e],n.id,"NudgeDisabled")}))}}));function Ae(e,t,n){var r=n?"Pinned":"Unpinned";e.forEach((function(e){Object(V.f)().nudgedRows.filter((function(n){return n.rowKey===e&&n.tableViewId===t})).forEach((function(e){be(e.itemId,r,"PinUnpin",e.reason)}))})),xe(e,t,"PinUnpin")}function De(e,t,n,r){be(t,n,r,Ve(e)),P(e,Object(_.J)()),Object(V.i)(e)}function xe(e,t,n){e.forEach((function(e){if(Object(V.g)(e,t)){var r=Ve(e);Object(V.i)(e),W(e,n,r)}}))}function Ve(e){var t=Object(V.f)().nudgedRows.filter((function(t){return t.rowKey===e}));return t.length>0?t[0].reason:null}var Pe=n(2);function Me(e,t,n){if(e.tableViewId==t.id){var r,o="Nudge_Render",i=e.rowKey,a=e.conversationId,s=e.itemId;Object(V.a)(i,t.id,_.b.getLastDeliveryOrRenewTimeStamp(i,t))?(r=Object(u.f)(t,0),x.a.updateRowPosition(r,i,t),c.g.info("Nudge: "+n+" updateNudgedRowPosition - row is inserted at "+r)):(o="Nudge_NotRender",c.g.info("Nudge: "+n+" updateNudgedRowPosition - row is pinned")),Object(M.s)(o,{owa_1:n,rKey:i,iId:s,cId:a,index:r},{isCore:!0})}}Object(Pe.orchestrator)(V.h,(function(e){e.nudgedRows.forEach((function(t){return Me(t,e.tableView,"onGetNudge")}))})),Object(Pe.orchestrator)(u.i,(function(e){var t=Object(V.f)().nudgedRows,n=e.tableView;t.filter((function(e){return e.tableViewId==n.id})).forEach((function(t){return Me(t,e.tableView,"onMerge")}))}));var Fe=n(57);function ke(){Object(ye.b)(!0,32),Fe.w.importAndExecute([{key:"FocusedInboxBitFlags",valuetype:"Integer32",value:[""+Object(Fe.h)().ViewStateConfiguration.FocusedInboxBitFlags]}],"OWA.ViewStateConfiguration"),Object(M.s)("TnS_SaveNudgeOption",[!1,"InlineFeedback"]),Object(Q.a)()}n.d(t,"getNudgesOnSelectFolderComplete",(function(){return oe})),n.d(t,"getNudgesOnNudgeOptionChange",(function(){return re})),n.d(t,"getNudgesOnNudgeRemoved",(function(){return ie})),n.d(t,"removeNudgeOnInfoBarClickedOrchestrator",(function(){return Ne})),n.d(t,"removeNudgeOnDismissNudgeClickedOrchestrator",(function(){return Re})),n.d(t,"removeNudgeOnItemDeleteStoreUpdateOrchestrator",(function(){return Te})),n.d(t,"removeNudgeOnRowsDeleteStoreUpdateOrchestrator",(function(){return Ee})),n.d(t,"removeNudgeOnItemsPinnedStoreUpdateOrchestrator",(function(){return Se})),n.d(t,"removeNudgeOnConversationsPinnedStoreUpdateOrchestrator",(function(){return _e})),n.d(t,"removeNudgeOnReplyOrReplyAllOrForwardOrchestrator",(function(){return Ce})),n.d(t,"updateNudgesOnNudgeOptionChange",(function(){return Ke})),n.d(t,"removeNudgeUponRowUpdate",(function(){return Le})),n.d(t,"disableNudgeOption",(function(){return ke}))},1303:function(e,t,n){"use strict";var r=n(448),o=n(303);t.a=function(e){return Object(o.a)(e)&&Object(r.a)(e)}},186:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,o=!1;function i(t){r--,delete e[t]}this.put=function(t,n,o,a){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var u={value:n,expire:o+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){i(t),a&&a(t,n)}.bind(this),o)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),o&&(t=0,n=0)},this.get=function(i){var a=e[i];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return o&&t++,a.value;o&&n++,r--,delete e[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),o=Date.now(),i=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(i)if(e[a])continue;var c=r[a],u=c.expire-o;if(u<=0){this.del(a);continue}u=u>0?u:void 0,this.put(a,c.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},2072:function(e,t,n){"use strict";n.d(t,"q",(function(){return d})),n.d(t,"t",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"u",(function(){return O})),n.d(t,"i",(function(){return w})),n.d(t,"o",(function(){return v})),n.d(t,"b",(function(){return g})),n.d(t,"m",(function(){return I})),n.d(t,"f",(function(){return m})),n.d(t,"p",(function(){return j})),n.d(t,"s",(function(){return h})),n.d(t,"r",(function(){return y})),n.d(t,"g",(function(){return p})),n.d(t,"j",(function(){return N})),n.d(t,"k",(function(){return R})),n.d(t,"n",(function(){return S})),n.d(t,"d",(function(){return _})),n.d(t,"c",(function(){return T})),n.d(t,"h",(function(){return E})),n.d(t,"l",(function(){return C}));var r=n(1),o=n(44),i=n(1947),a=n(1956),c=n(2),u=n(2010),s=n(19),d=Object(c.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){return Object(o.c)(L(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(c.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){return Object(o.c)(L(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),f=Object(c.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r,o){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r,sxsId:o}})),b=Object(c.action)("EXPAND_ROW_FIRST_LEVEL",(function(e,t){return{rowKey:e,latestItemIdsInForks:t}})),O=Object(c.action)("UPDATE_FORKS_ON_DELETE",(function(e,t){return{latestItemIdsInForks:e,deletedItemIds:t}})),w=Object(c.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),v=Object(c.action)("SET_SECOND_LEVEL_LIST_VIEW_EXPANSION",(function(e){return{rowKey:e}})),g=Object(c.action)("ITEM_PART_SELECTED",(function(e,t,n,r,o){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:o}})),I=Object(c.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),m=Object(c.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),j=Object(c.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r,o){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r,currentSelectedNodeIds:o}})),h=Object(c.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),y=Object(c.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),p=Object(c.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),N=Object(c.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),R=Object(c.action)("RESET_SELECTION",(function(e){return{tableView:e}})),S=Object(c.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){return Object(o.c)(L(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),_=Object(c.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),T=Object(c.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),E=Object(c.action)("RESET_BUS_STOP_STATE_MAP"),C=Object(c.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}}));function L(e,t,n,o){return{name:function(e,t,n,o){return!(function(e){return e===a.b.MailListItemRichPreview||e===a.b.KeyboardShiftEnter||e===a.b.MailListItemBodyDoubleClick}(e)||Object(u.c)()&&!function(e){var t;return e===a.b.KeyboardEnter||e===a.b.MailListItemBody||e===a.b.RouteHandler||e===a.b.CommandBarArrows||e===a.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(s.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,o){if(Object(u.c)())return!1;if(e===a.b.KeyboardUpDown){var c=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==c&&1===t.selectedRowKeys.size){var s=t.rowKeys.indexOf(Object(r.j)([],Object(r.g)(t.selectedRowKeys.keys()))[0]);return o===i.d.Next?s===c+1||s===t.rowKeys.length-1&&c===t.rowKeys.length-1:s===c-1||0===s&&0===c}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,o))}(e,t,n,o)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},293:function(e,t,n){"use strict";var r,o=n(576),i=n(184).a["__core-js_shared__"],a=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var c=function(e){return!!a&&a in e},u=n(216),s=n(423),d=/^\[object .+?Constructor\]$/,l=Function.prototype,f=Object.prototype,b=l.toString,O=f.hasOwnProperty,w=RegExp("^"+b.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var v=function(e){return!(!Object(u.a)(e)||c(e))&&(Object(o.a)(e)?w:d).test(Object(s.a)(e))};var g=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var n=g(e,t);return v(n)?n:void 0}},326:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r,o=n(1);function i(e){r=e}function a(){var e,t;return Object(o.c)(this,void 0,void 0,(function(){var n,i;return Object(o.f)(this,(function(o){switch(o.label){case 0:return(i=r)?[4,r()]:[3,2];case 1:i=o.sent(),o.label=2;case 2:if((n=i)&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},3548:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(2401),o=n(1947),i=n(2050);function a(e,t,n,r){var a=new Date(o.b.getLastDeliveryTimeStamp(n,r)).getTime()-new Date(t).getTime();if(Object(i.l)(r.tableQuery)){var c=new Date(o.b.getLastDeliveryOrRenewTimeStamp(n,r)).getTime()-new Date(e).getTime();return 0!=c?c:a}return a}function c(e,t,n,o,a){return Object(r.a)(a,n.id,e)?Object(i.f)(n,0):u(e,t,n,o)}function u(e,t,n,i){var c=n.rowKeys.length;if(0==c)return 0;var u,s=Object(o.L)(n).sortDirection==o.c.DESCENDING_SORT_DIR;for(u=i;u<c;u++){var d=n.rowKeys[u];if(!Object(r.a)(d,n.id,e)){var l=a(e,t,d,n);if(s?l<=0:l>0)return u}}return c==n.totalRowsInView?c:-1}},423:function(e,t,n){"use strict";var r=Function.prototype.toString;t.a=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},448:function(e,t,n){"use strict";var r=n(576),o=n(580);t.a=function(e){return null!=e&&Object(o.a)(e.length)&&!Object(r.a)(e)}},520:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,o=t%n;return(((e-=r)/n&(t-=o)/n)>>>0)*n+((r&o)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},534:function(e,t,n){"use strict";var r=n(293),o=function(){try{var e=Object(r.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.a=o},576:function(e,t,n){"use strict";var r=n(311),o=n(216),i="[object AsyncFunction]",a="[object Function]",c="[object GeneratorFunction]",u="[object Proxy]";t.a=function(e){if(!Object(o.a)(e))return!1;var t=Object(r.a)(e);return t==a||t==c||t==i||t==u}},577:function(e,t,n){"use strict";t.a=function(e){return e}},580:function(e,t,n){"use strict";var r=9007199254740991;t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},708:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},874:function(e,t,n){"use strict";var r=n(577),o=n(881),i=n(880);t.a=function(e,t){return Object(i.a)(Object(o.a)(e,t,r.a),e+"")}},878:function(e,t,n){"use strict";var r=n(450),o=n(448),i=n(583),a=n(216);t.a=function(e,t,n){if(!Object(a.a)(n))return!1;var c=typeof t;return!!("number"==c?Object(o.a)(n)&&Object(i.a)(t,n.length):"string"==c&&t in n)&&Object(r.a)(n[t],e)}},880:function(e,t,n){"use strict";var r=function(e){return function(){return e}},o=n(534),i=n(577),a=o.a?function(e,t){return Object(o.a)(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i.a,c=800,u=16,s=Date.now;var d=function(e){var t=0,n=0;return function(){var r=s(),o=u-(r-n);if(n=r,o>0){if(++t>=c)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(a);t.a=d},881:function(e,t,n){"use strict";var r=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},o=Math.max;t.a=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,c=o(i.length-t,0),u=Array(c);++a<c;)u[a]=i[t+a];a=-1;for(var s=Array(t+1);++a<t;)s[a]=i[a];return s[t]=n(u),r(e,this,s)}}},887:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},891:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r=1,o=16},896:function(e,t,n){"use strict";var r=n(874),o=n(878);t.a=function(e){return Object(r.a)((function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,c=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,c&&Object(o.a)(n[0],n[1],c)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var u=n[r];u&&e(t,u,r,a)}return t}))}},9594:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2072),o=n(2048);function i(e,t){var n=e[e.length-1],i=t.rowKeys.indexOf(n);i<t.rowKeys.length-1?Object(r.q)(t,t.rowKeys[i+1],!1,o.a.RowRemoval):Object(r.j)(t,o.a.Reset)}}}]);
//# sourceMappingURL=owa.1332.js.map
self.scriptsLoaded['owa.1332.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1332.js'] = (new Date()).getTime();