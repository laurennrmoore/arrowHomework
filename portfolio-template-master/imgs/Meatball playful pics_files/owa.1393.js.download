self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1393.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1393],{18339:function(e,t,n){"use strict";n.r(t);var r=n(31),o=n(3458),c=n(2791),a=n(3294),i=n(1947),u=Object(r.e)(o.a,"reloadTableOnTriageActionFailClone",(function(e){d(e.tableView)})),s=Object(r.e)(c.a,"reloadTableOnTriageActionFailClone",(function(e){d(Object(i.J)())}));function d(e){e&&Object(a.a)(e)}var l=n(1),b=n(2050),f=n(121),O=n(183),j=Object(O.action)("onLoadMoreRowsSucceeded")((function(e,t,n,r){e.isLoading=!1,r(e,t,n),e.currentLoadedIndex=e.rowKeys.length})),w=Object(O.action)("onLoadMoreRowsFailed")((function(e,t){e.isLoading=!1,Object(f.s)("TnS_LoadMoreRowsError",[e.tableQuery.listViewType,t])})),y=n(2013),h=n(2272),v=n(2488);var g=n(2918),I=n(2919),p=n(3268),m=n(979),T=n(2920),F=n(7429);var x=n(24),R=n(2578);function L(e,t){var n=e.rowKeys.length-1,r=e.tableQuery;Object(x.i)("mon-messageList-useGqlForFindItem")?Object(h.h)(Object(i.j)(r),t,r.viewFilter,r.sortBy,Object(b.l)(r),r.focusedViewFilter,r.requestShapeName,Object(y.d)(r),!1,Object(y.e)(r),r.categoryName,Object(i.k)(e,!0),e.rowKeys[n]).then((function(t){var n=[];t.edges&&(n=t.edges.map((function(e){return e.node}))),j(e,n,t.totalItemRowsInView,b.b)})).catch((function(t){var n=Object(v.a)(t);w(e,n)})):function(e,t,n,r,o,c,a,i,u,s){var d=Object(p.a)({FieldURIOrConstant:Object(I.a)({Item:Object(g.a)({Value:t})}),Item:Object(m.a)({FieldURI:"InstanceKey"})}),l=Object(T.a)({Item:d}),b=Object(F.a)({BasePoint:"Beginning",Condition:l,MaxEntriesReturned:n});return Object(h.b)(e,b,r,o,c,a,i,u,Object(h.g)(r),s)}(Object(i.j)(r),e.rowKeys[n],t,r.viewFilter,Object(R.a)(r),r.focusedViewFilter,r.requestShapeName,Object(y.e)(r),r.categoryName,Object(i.k)(e,!0)).then((function(t){"Success"===t.ResponseClass?j(e,t.RootFolder.Items,t.RootFolder.TotalItemsInView,b.b):w(e,t.ResponseCode)}),(function(t){w(e)}))}var C=n(2718),K=50;function S(e){switch(e.isLoading=!0,e.tableQuery.listViewType){case 0:!function(e,t){var n,r=e.rowKeys.length-1,o=e.tableQuery,c=null===(n=Object(i.k)(e,!0))||void 0===n?void 0:n.Id;Object(h.d)(o.folderId,t,o.viewFilter,o.sortBy,Object(b.l)(o),o.focusedViewFilter,o.requestShapeName,Object(y.d)(o),e.rowKeys[r],o.categoryName,c).then((function(t){var n=[];t.edges&&(n=t.edges.map((function(e){return e.node}))),j(e,n,t.totalConversationRowsInView,b.a)})).catch((function(t){var n=Object(v.a)(t);w(e,n)}))}(e,K);break;case 1:L(e,K)}}var V=Object(O.action)("loadMoreInTable")((function(e){return Object(l.c)(this,void 0,void 0,(function(){var t;return Object(l.f)(this,(function(n){if(!e)throw new Error("Selected tableview must not be null if loadMoreRows is being called.");if(e.currentLoadedIndex<e.rowKeys.length){if(e.rowKeys.length-e.currentLoadedIndex>=K)return e.currentLoadedIndex+=K,[2];e.currentLoadedIndex=e.rowKeys.length}return 0!=e.tableQuery.type&&2!=e.tableQuery.type||"spotlight"===e.tableQuery.scenarioType?1===e.tableQuery.type&&("SharedFolders"===(t=e.tableQuery).searchScope.kind?_(e):"PrimaryMailbox"===t.searchScope.kind&&M(e)):S(e),[2]}))}))})),_=function(e){return Object(l.c)(void 0,void 0,void 0,(function(){return Object(l.f)(this,(function(t){switch(t.label){case 0:return[4,C.b.import()];case 1:return t.sent()(e.currentLoadedIndex-1,e,"loadMoreInTable",j,w),[2]}}))}))},M=function(e){return Object(l.c)(void 0,void 0,void 0,(function(){var t,n;return Object(l.f)(this,(function(r){switch(r.label){case 0:return t=e.rowKeys.length-1,n=e.tableQuery,t>n.lastIndexFetched?(n.lastIndexFetched=t,[4,C.c.import()]):[3,2];case 1:r.sent()(t,e,"loadMoreInTable",j,w),r.label=2;case 2:return[2]}}))}))},Q=n(8217);function E(){setTimeout((function(){var e=Object(Q.a)();Object(a.a)(e)}),3e3)}n.d(t,"reloadTableOnTriageActionFailOrchestrator",(function(){return u})),n.d(t,"reloadTableUponUndoWithoutNotificaitonChannel",(function(){return s})),n.d(t,"loadMoreInTable",(function(){return V})),n.d(t,"reloadInboxPostBoot",(function(){return E}))},2918:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){return Object(r.a)({__type:"Constant:#Exchange"},e)}},2919:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){return Object(r.a)({__type:"FieldURIOrConstantType:#Exchange"},e)}},2920:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){return Object(r.a)({__type:"RestrictionType:#Exchange"},e)}},3268:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){return Object(r.a)({__type:"IsEqualTo:#Exchange"},e)}},7429:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){return Object(r.a)({__type:"SeekToConditionPageView:#Exchange"},e)}},8217:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2044),o=n(3381);function c(){var e=Object(o.a)();return Object(r.c)(e)}}}]);
//# sourceMappingURL=owa.1393.js.map
self.scriptsLoaded['owa.1393.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1393.js'] = (new Date()).getTime();