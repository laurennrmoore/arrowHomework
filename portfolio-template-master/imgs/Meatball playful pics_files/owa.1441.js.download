self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1441.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1441],{18258:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r(1947),i=r(7883),o=r(2133),c=r(2559),d=r(2),l=Object(d.mutatorAction)("removeSingleItemFromConversation",(function(e,t){var r,i,c=o.a.tableViews.get(t),d=Object(n.G)([e.itemConversationId.Id],c);try{for(var l=Object(a.k)(d),s=l.next();!s.done;s=l.next()){u(s.value,e,t)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}}));function u(e,t,r){var a=Object(i.a)(t.itemConversationId.Id),n=Object(c.a)(e,r),o=n.itemIds.indexOf(t.itemId);o>=0&&(n.itemIds.splice(o,1),t.isRead||n.unreadCount--),(o=a.globalItemIds.indexOf(t.itemId))>=0&&(a.globalItemIds.splice(o,1),t.isRead||a.globalUnreadCount--),(o=n.draftItemIds.indexOf(t.itemId))>=0&&n.draftItemIds.splice(o,1)}var s=r(6821),b=r(2136),f=r(2292),v=r(31),O=r(3811),m=Object(v.e)(f.a,"clone_deleteItemsStoreUpdate",(function(e){var t,r,i=e.itemContexts[0],o=Object(s.a)(null==i?void 0:i.mailboxInfo,e.parentFolderId,!0);try{for(var c=Object(a.k)(o),d=c.next();!d.done;d=c.next()){var l=d.value;Object(n.S)(l)?I(e.itemContexts,l):1==l.tableQuery.listViewType&&j(e.itemContexts,l)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}}));function j(e,t){var r=e.map((function(e){return e.itemId})),a=Object(n.G)(r,t),i=a.filter((function(e){return t.rowKeys.indexOf(e)>=0}));0!=i.length&&(Object(O.a)(i,t),y(t,a))}function I(e,t){var r,i,o,c;try{for(var d=Object(a.k)(e),u=d.next();!u.done;u=d.next()){var s=u.value,b=Object(n.G)([s.itemConversationId.Id],t);try{for(var f=(o=void 0,Object(a.k)(b)),v=f.next();!v.done;v=f.next()){var m=v.value,j=Object(n.N)(m,t.id);j&&(1==j.itemIds.length&&j.itemIds[0]==s.itemId?(Object(O.a)([m],t),y(t,[m])):l(s,t.id))}}catch(e){o={error:e}}finally{try{v&&!v.done&&(c=f.return)&&c.call(f)}finally{if(o)throw o.error}}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}}function y(e,t){0!==e.tableQuery.type&&2!==e.tableQuery.type||b.a.add(t,e,3)}var w=r(2392),h=r(2474),p=r(3455);function g(e,t,r){var a=t.id,i=Object(n.G)(e,t);if(0!=i.length){var o=function(e,t){for(var r=0,a=0,n=new Map,i=0;i<e.length;i++){var o=e[i],d=Object(c.a)(o,t);n.get(d.id)||(n.set(d.id,!0),r-=d.unreadCount,a-=d.itemIds.length)}return[r,a]}(i,a);Object(p.a)(o[0],o[1],t.serverFolderId,!0),0!=t.tableQuery.type&&2!=t.tableQuery.type||b.a.add(i,t,3),Object(h.a)(i,t,r)}}var C=Object(v.e)(w.a,"deleteConversationStoreUpdateClone",(function(e){g(e.conversationIds,e.tableView,e.actionType)})),V=r(2681),x=r(3521);var S=r(3035),R=Object(v.e)(S.a,"deleteFolderStoreUpdateClone",(function(e){e.folderIds.forEach((function(e){!function(e){Object(V.a)(e,!1).forEach((function(e){return Object(x.c)(e)}))}(e)}))})),k=r(2963),A=r(3548),E=r(2384),U=r(9594);function Q(e,t,r,a,i){void 0===i&&(i={tableViews:n.ab.tableViews});var o=i.tableViews.get(t);0===o.tableQuery.type&&(b.a.add(e,o,1),Object(U.a)(e,o)),Object(n.E)(e,t).forEach((function(e){i.tableViews.forEach((function(i){i.tableQuery.folderId==o.tableQuery.folderId&&Object(n.G)([e],i).forEach((function(e){(a(e,i.id,r),0===i.tableQuery.type)&&(Object(n.cb)(i,2),function(e,t,r,a,n){var i,o=Object(k.a)(a,r);if(o<0)throw new Error("Row being pinned / unpinnned must exist in the list");var c=n?0:o+1;return o<(i=Object(A.a)(e,t,r,c))&&i--,-1==i?(Object(h.a)([a],r,"Pin"),!1):(E.a.updateRowPosition(i,a,r),!0)}(n.b.getLastDeliveryOrRenewTimeStamp(e,i),n.b.getLastDeliveryTimeStamp(e,i),i,e,r)||i.id!=t||b.a.add([e],o,3))}))}))}))}var T=r(3313),M=r(5869),F=Object(v.e)(T.a,"clone_markConversationsAsPinnedStoreUpdate",(function(e){Q(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned,G)}));function G(e,t,r){var a=Object(c.a)(e,t);if(a)if(r){var n=Object(M.d)();n&&(a.lastDeliveryOrRenewTimeStamp=n)}else a.lastDeliveryOrRenewTimeStamp=a.lastDeliveryTimeStamp}var K=r(3314),P=r(1956),D=Object(v.e)(K.a,"clone_markItemsAsPinnedStoreUpdate",(function(e){Q(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned,N)}));function N(e,t,r){var a=Object(n.O)(e,t);if(a){var i=P.u.items.get(a.clientId.Id);if(r){var o=Object(M.d)();o&&(i.ReceivedOrRenewTime=o)}else i.ReceivedOrRenewTime=i.DateTimeReceived}}var _=r(1955),L=r(183),$=r(9518);var q=Object(L.action)("MarkItemsReadInListViewStore")((function(e,t,r,a){void 0===a&&(a={items:_.a.items,conversationItems:n.ab.conversationItems});var i=r?-1*t.length:t.length,o=e.tableQuery.folderId;Object($.a)(o)&&Object(p.a)(i,0,o,!0),0==e.tableQuery.listViewType&&t.forEach((function(e){var t,i=a.items.get(e);if(i){var o=null===(t=i.ConversationId)||void 0===t?void 0:t.Id;Object(s.a)(i.MailboxInfo,i.ParentFolderId.Id,!0).forEach((function(e){return function(e,t,r,a){var i=Object(n.G)([e],t),o=t.id;i.forEach((function(t){var n=Object(c.a)(t,o),i=a.get(e);n&&(r?(n.unreadCount--,i.globalUnreadCount--):(n.unreadCount++,i.globalUnreadCount++))}))}(o,e,r,a.conversationItems)}))}}))})),J=r(2525),z=Object(v.e)(J.a,"clone_markItemsAsReadStoreUpdateOrchestrator",(function(e){var t=e.itemIds,r=e.isReadValue,a=e.isExplicit,i=e.tableViewId,o=n.ab.tableViews.get(i);if(o){q(o,t,r);var c=[],d=Object(n.db)(o,r,a);1==o.tableQuery.listViewType?c=Object(n.G)(t,o):t.forEach((function(e){var t,r=P.u.items.get(e);if(r){var a=null===(t=r.ConversationId)||void 0===t?void 0:t.Id,c=Object(n.G)([a],o);c.forEach((function(e){var t=Object(n.N)(e,i);d&&0!=t.unreadCount||c.push(e)}))}})),0!=c.length&&(d?(b.a.add(c,o,3),Object(h.a)(c,o,"MarkAsRead")):b.a.add(c,o,2))}})),B=Object(L.action)("MarkConversationReadInListViewStore")((function(e,t,r,a,i){void 0===i&&(i={conversationItems:n.ab.conversationItems});var o=0,c={};e.forEach((function(e){if(!(r.virtualSelectAllExclusionList.indexOf(e)>=0)){var a=Object(n.N)(e,r.id),d=H(a,t);a.unreadCount+=d;var l=a.id;i.conversationItems.get(l).globalUnreadCount+=d,c[l]||(c[l]=!0,o+=d),function(e,t,r){Object(V.a)(r.tableQuery.folderId,!1).forEach((function(a){if(a.id!==r.id){var i=Object(n.N)(e,a.id);if(i){var o=H(i,t);i.unreadCount+=o}}}))}(e,t,r)}})),a&&Object(p.a)(o,0,r.tableQuery.folderId,!0)}));function H(e,t){var r=e.unreadCount;return t?-1*r:e.itemIds.length-r}var W=r(2524),X=Object(v.e)(W.a,"clone_markConversationAsReadStoreUpdate",(function(e){var t=e.conversationIds,r=e.tableViewId,a=e.isReadValue,i=e.isExplicit,o=n.ab.tableViews.get(r);if(o){var c=Object(n.G)(t,o);B(c,a,o,!0),Object(n.db)(o,a,i)?(b.a.add(c,o,3),Object(h.a)(c,o,"MarkAsRead")):b.a.add(c,o,2)}})),Y=r(2423),Z=Object(v.e)(Y.a,"markAllAsReadOrchestratorClone",(function(e){var t=e.tableView,r=e.markAsRead;if(t)switch(t.tableQuery.listViewType){case 0:B(t.rowKeys,r,t,!1);break;case 1:var a=Object(n.E)(t.rowKeys,t.id);q(t,a,r)}})),ee=r(3247),te=Object(L.action)("removeTableFromStore")((function(e,t){void 0===t&&(t={tableViews:o.a.tableViews});var r=t.tableViews,a=r.get(e);if(a){if(Object(ee.a)()==e)return;E.a.clear(a,null),r.delete(e),0==Object(V.a)(a.tableQuery.folderId,!1).length&&b.a.clearMapForFolder(a.serverFolderId)}})),re=r(3549),ae=r(3675),ne=r(3676),ie=r(121),oe=Object(v.e)(re.a,"clone_updateCategoriesInView",(function(e){var t,r,i=Object(n.J)();if(i){var o=e.modifiedCategoryName,c=e.newCategoryName,d=[];try{for(var l=Object(a.k)(i.rowKeys),u=l.next();!u.done;u=l.next()){var s=u.value,f=n.b.getCategories(s,i);(null==f?void 0:f.includes(o))&&d.push(s)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}if(Object(ie.s)("UpdateCategoriesInViewMail",[d.length]),d.length>0){var v=c?[c]:null;Object(n.S)(i)?Object(ae.a)(d,i.id,v,[o],!1):Object(ne.a)(Object(n.E)(d,i.id),v,[o],!1),b.a.add(d,i,0)}}}));r.d(t,"deleteItemsStoreUpdateOrchestrator",(function(){return m})),r.d(t,"deleteConversationStoreUpdateOrchestrator",(function(){return C})),r.d(t,"deleteFolderStoreUpdateOrchestrator",(function(){return R})),r.d(t,"markConversationsAsPinnedStoreUpdateOrchestrator",(function(){return F})),r.d(t,"markItemsAsPinnedStoreUpdateOrchestrator",(function(){return D})),r.d(t,"markItemsAsReadStoreUpdateOrchestrator",(function(){return z})),r.d(t,"markConversationsAsReadStoreUpdateOrchestrator",(function(){return X})),r.d(t,"markAllAsReadOrchestrator",(function(){return Z})),r.d(t,"removeTableFromStore",(function(){return te})),r.d(t,"updateCategoriesInViewOrchestrator",(function(){return oe}))},6821:function(e,t,r){"use strict";var a=r(2681),n=r(2027),i=r(1947);function o(e,t,r){return e&&"GroupMailbox"==e.type?function(e,t,r){void 0===r&&(r={tableViews:i.ab.tableViews});var a=r.tableViews,o=[];return a.forEach((function(r){(Object(n.b)(r.tableQuery)==e||t&&1==r.tableQuery.type)&&o.push(r)})),o}(e.mailboxSmtpAddress,r):Object(a.a)(t,r)}r.d(t,"a",(function(){return o}))},9518:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var a=r(1951);function n(e){return Object(a.C)(e,"ArchiveMailbox")||Object(a.C)(e,"SharedMailbox")}},9594:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var a=r(2072),n=r(2048);function i(e,t){var r=e[e.length-1],i=t.rowKeys.indexOf(r);i<t.rowKeys.length-1?Object(a.q)(t,t.rowKeys[i+1],!1,n.a.RowRemoval):Object(a.j)(t,n.a.Reset)}}}]);
//# sourceMappingURL=owa.1441.js.map
self.scriptsLoaded['owa.1441.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1441.js'] = (new Date()).getTime();