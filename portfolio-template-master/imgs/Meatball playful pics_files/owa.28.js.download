self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.28.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[28],{127:function(n,r,e){"use strict";e.d(r,"q",(function(){return i})),e.d(r,"s",(function(){return l})),e.d(r,"g",(function(){return f})),e.d(r,"d",(function(){return I})),e.d(r,"n",(function(){return b})),e.d(r,"m",(function(){return s})),e.d(r,"o",(function(){return p})),e.d(r,"i",(function(){return O})),e.d(r,"f",(function(){return j})),e.d(r,"h",(function(){return v})),e.d(r,"k",(function(){return m})),e.d(r,"p",(function(){return y})),e.d(r,"l",(function(){return C})),e.d(r,"r",(function(){return g})),e.d(r,"e",(function(){return h})),e.d(r,"b",(function(){return M})),e.d(r,"t",(function(){return E})),e.d(r,"u",(function(){return G})),e.d(r,"w",(function(){return x})),e.d(r,"a",(function(){return F})),e.d(r,"j",(function(){return T})),e.d(r,"v",(function(){return w})),e.d(r,"x",(function(){return K})),e.d(r,"c",(function(){return S}));var t=e(1),a=e(601),d=e(676),u=e(435),o=e(130),c=e(209);function i(n){return n||(n=Object(c.d)().userIdentity),Object(o.a)().defaultCalendars.get(n)}function l(n,r){var e=i(r);return e&&n===e.id}function f(){var n=Object(o.a)().calendarEntryMapping;return Object(t.j)([],Object(t.g)(n.values()))}function I(){return f().map((function(n){return j(n.calendarId.itemId.Id)})).filter((function(n){return n}))}function b(){var n=Object(o.a)().calendarGroupsMapping;return Object(t.j)([],Object(t.g)(n.values()))}function s(n,r){var e=Object(o.a)().calendarGroupsMapping,t=Object(u.a)(r,n);return e.get(t)}function p(n){return Object(o.a)().folderIdToCalendarId.get(n)}function O(n){return Object(o.a)().calendarEntryMapping.get(n)}function j(n){var r=O(n);return r?{id:{id:n,mailboxInfo:Object(t.a)({},r.calendarId.mailboxInfo)},calculatedFolderId:h(n),displayName:r.CalendarName,colorScheme:null}:null}function v(n){var r;return O(null===(r=null==n?void 0:n.id)||void 0===r?void 0:r.id)}function m(n){var r=p(n);return r?O(r.id):void 0}function y(n){return Object(o.a)().calendarItemIdToChangeKey.get(n)}function C(n){return g(n.id.id)}function g(n){var r=Object(o.a)().calendarEntryMapping.get(n);return r&&(r.FolderId||r.DistinguishedFolderId)?r.FolderId?r.FolderId.Id:r.DistinguishedFolderId:h(n)}function h(n){var r=Object(o.a)().calendarEntryMapping.get(n);if(r){var e=Object(d.a)(r);return e?e.Id:null}return null}function M(n){return!!O(n)}function E(n){var r=Object(o.a)(),e=r.folderIdToCalendarId,t=r.calendarEntryMapping,a=e.get(n);if(a){var d=t.get(a.id);return d&&!d.IsGroupMailboxCalendar&&null!=d.LocalCalendarFolderId}return!1}function G(n){if(E(n)){var r=m(n);return null==r?void 0:r.IsReadOnly}return!1}function x(n){var r=Object(o.a)().validEntryMapping;return n&&r.get(n.calendarId.itemId.Id)}function F(n){return!E(g(n))&&!x(O(n))}function T(n){var r,e=Object(o.a)(),a=e.folderIdToCalendarId,d=e.calendarEntryMapping,u=a.get(n);u?r=d.get(u.id):r=Object(t.j)([],Object(t.g)(d.values())).filter((function(r){return r.OwnerEmailAddress&&r.OwnerEmailAddress.toLowerCase()==n.toLowerCase()}))[0];return r}function w(n){var r,e;return"TeamsMailbox"==(null===(e=null===(r=null==n?void 0:n.id)||void 0===r?void 0:r.mailboxInfo)||void 0===e?void 0:e.type)}function K(n,r){return[n,r].join(a.a)}function S(n){return n.split(a.a)[0]}},130:function(n,r,e){"use strict";var t=e(2),a=e(14),d={calendarEntryMapping:new a.ObservableMap,calendarItemIdToChangeKey:new a.ObservableMap,folderIdToCalendarId:new a.ObservableMap,validEntryMapping:new a.ObservableMap,calendarGroupsMapping:new a.ObservableMap,defaultCalendars:new a.ObservableMap};r.a=Object(t.createStore)("calendarsCacheStore",d)},426:function(n,r,e){"use strict";var t="LinkedCalendarEntry",a="LocalCacheForRemoteCalendarEntry";function d(n){return(null==n?void 0:n.__typename)==t}function u(n){return(null==n?void 0:n.__typename)==a}function o(n){return(null==n?void 0:n.__typename)==t&&!(null==n?void 0:n.IsGroupMailboxCalendar)}function c(n){return n.CanViewPrivateItems||d(n)}e.d(r,"e",(function(){return d})),e.d(r,"f",(function(){return u})),e.d(r,"g",(function(){return o})),e.d(r,"a",(function(){return t})),e.d(r,"b",(function(){return a})),e.d(r,"c",(function(){return"LocalCalendarEntry"})),e.d(r,"d",(function(){return c}))},435:function(n,r,e){"use strict";function t(n,r){return r+"_"+n}e.d(r,"a",(function(){return t}))},601:function(n,r,e){"use strict";e.d(r,"a",(function(){return t}));var t="_CHANNELTEAMSTYPE_"},676:function(n,r,e){"use strict";function t(n){if(n.FolderId)return n.FolderId;var r=n;return r.IsGeneralScheduleCalendar?{Id:r.OwnerEmailAddress,ChangeKey:""}:r.SharedFolderId?{Id:r.SharedFolderId.Id,ChangeKey:null!=r.SharedFolderId.ChangeKey?r.SharedFolderId.ChangeKey:""}:null}e.d(r,"a",(function(){return t}))},76:function(n,r,e){"use strict";var t=e(130),a=e(1),d=e(2),u=Object(d.action)("initializeCalendarsCacheInStore",(function(n,r,e,t,a){return{defaultCalendarEntry:n,calendarEntries:r,calendarGroups:e,folderIdMapping:t,calendarIdToChangeKeyMapping:a}})),o=Object(d.action)("updateChangeKeyByCalendarItemId",(function(n){return{itemId:n}})),c=Object(d.action)("addToCalendarsCache",(function(n){return{calendarEntry:n}})),i=Object(d.action)("addCalendarGroupToCalendarsCache",(function(n){return{calendarGroup:n}})),l=Object(d.action)("removeCalendarGroupFromCalendarsCache",(function(n){return{calendarGroup:n}})),f=Object(d.action)("updateCalendarEntry",(function(n,r){return{itemId:n,calendarEntry:r}})),I=Object(d.action)("updateCalendarFolder",(function(n,r){return{calendar:n,calendarFolder:r}})),b=Object(d.action)("removeCalendarFromCalendarsCache",(function(n){return{calendar:n}})),s=Object(d.action)("markCalendarEntryAsValid",(function(n){return{calendarEntry:n}})),p=Object(d.action)("calendarUpdated",(function(n,r){return{calendarId:n,updates:r}})),O=Object(d.action)("groupAssociationChanged",(function(n){return{payload:n}})),j=Object(d.action)("removeCalendarWithIDFromCalendarsCache",(function(n){return{calendarId:n}})),v=Object(d.action)("updateCalendarGroup",(function(n,r,e){return{groupId:n,userIdentity:r,calendarGroup:e}})),m=e(127);Object(d.mutator)(o,(function(n){var r=n.itemId,e=r.Id,a=r.ChangeKey;Object(t.a)().calendarItemIdToChangeKey.set(e,a)})),Object(d.mutator)(f,(function(n){var r=n.itemId.Id,e=n.calendarEntry,t=Object(m.i)(r),d=(e.calendarId,Object(a.h)(e,["calendarId"]));t&&Object.keys(d).forEach((function(n){t[n]=d[n]}))})),Object(d.mutator)(s,(function(n){var r=n.calendarEntry;Object(t.a)().validEntryMapping.set(r.calendarId.itemId.Id,!0)}));var y=e(435);function C(n,r){Object.keys(r).forEach((function(e){return n.set(e,r[e])}))}function g(n,r,e){var a=Object(t.a)();a.calendarItemIdToChangeKey.delete(n),e||(a.calendarEntryMapping.delete(n),a.validEntryMapping.delete(n)),r&&a.folderIdToCalendarId.delete(r)}Object(d.mutator)(u,(function(n){var r=n.defaultCalendarEntry;r&&Object(t.a)().defaultCalendars.set(r.id.mailboxInfo.userIdentity,r)})),Object(d.mutator)(u,(function(n){var r=n.calendarEntries;C(Object(t.a)().calendarEntryMapping,r)})),Object(d.mutator)(u,(function(n){var r=n.folderIdMapping;C(Object(t.a)().folderIdToCalendarId,r)})),Object(d.mutator)(u,(function(n){var r=n.calendarIdToChangeKeyMapping;C(Object(t.a)().calendarItemIdToChangeKey,r)})),Object(d.mutator)(u,(function(n){var r=n.calendarGroups;C(Object(t.a)().calendarGroupsMapping,r)})),Object(d.mutator)(c,(function(n){var r=n.calendarEntry,e=Object(t.a)();e.calendarItemIdToChangeKey.set(r.calendarId.itemId.Id,r.calendarId.itemId.ChangeKey),e.calendarEntryMapping.set(r.calendarId.itemId.Id,r),r.FolderId?e.folderIdToCalendarId.set(r.FolderId.Id,{id:r.calendarId.itemId.Id,mailboxInfo:r.calendarId.mailboxInfo}):r.DistinguishedFolderId&&e.folderIdToCalendarId.set(r.DistinguishedFolderId,{id:r.calendarId.itemId.Id,mailboxInfo:r.calendarId.mailboxInfo})})),Object(d.mutator)(i,(function(n){var r=n.calendarGroup,e=Object(t.a)(),a=Object(y.a)(r.calendarGroupId.mailboxInfo.userIdentity,r.serverGroupId);e.calendarItemIdToChangeKey.set(r.calendarGroupId.itemId.Id,r.calendarGroupId.itemId.ChangeKey),e.calendarGroupsMapping.set(a,r)})),Object(d.mutator)(l,(function(n){var r=n.calendarGroup,e=Object(t.a)();e.calendarItemIdToChangeKey.delete(r.calendarGroupId.itemId.Id);var a=Object(y.a)(r.calendarGroupId.mailboxInfo.userIdentity,r.serverGroupId);e.calendarGroupsMapping.delete(a)})),Object(d.mutator)(b,(function(n){var r=n.calendar;g(r.id.id,r.calculatedFolderId?r.calculatedFolderId:null)})),Object(d.mutator)(j,(function(n){var r=n.calendarId;g(r,Object(m.r)(r),!0)})),Object(d.mutator)(I,(function(n){var r=n.calendar,e=n.calendarFolder,t=Object(m.h)(r);Object.keys(e).forEach((function(n){t[n]=e[n]}))})),Object(d.mutator)(v,(function(n){var r=n.groupId,e=n.userIdentity,d=n.calendarGroup,u=Object(t.a)(),o=Object(y.a)(e,r),c=u.calendarGroupsMapping.get(o),i=(d.calendarGroupId,Object(a.h)(d,["calendarGroupId"]));c&&Object.keys(i).forEach((function(n){c[n]=i[n]}))}));e(601);var h=e(676);function M(n){var r=Object(m.o)(n);return r?r.mailboxInfo:null}function E(n){if(!n)return!1;var r=Object(m.h)(n);return r&&!r.IsReadOnly&&r.EffectiveRights&&r.EffectiveRights.CreateContents}var G=e(426),x=e(19);function F(n,r){var e,t=Object(m.h)(n);if(Object(G.e)(t)){var a=t;return!a.IsOwnerEmailAddressInvalid&&a.OwnerEmailAddress==r}return(null===(e=n.id)||void 0===e?void 0:e.mailboxInfo)?r.indexOf(n.id.mailboxInfo.mailboxSmtpAddress)>=0:Object(x.a)().SessionSettings.UserEmailAddress==r}function T(n){return n?n.map(m.f).filter((function(n){return!!n})):null}function w(n){var r=Object(m.h)(n);return!!r&&r.IsGroupMailboxCalendar}function K(n){var r=Object(m.h)(n);return null==r?void 0:r.IsSchoolCalendar}function S(n){var r=Object(m.h)(n);return 4==(null==r?void 0:r.CalendarFolderType)}var A,k,N=e(374),_=e(57),L=e(24);function D(n){if(n.IsGroupMailboxCalendar){var r=n.OwnerEmailAddress,e=n.calendarId.mailboxInfo.userIdentity;return{MailboxId:Object(m.v)(n)&&Object(L.i)("cal-showAddTeamsCalendars")?Object(m.c)(r):r,MailboxType:Object(N.r)(e)?1:0}}var t=n.FolderId;if(t){e=n.calendarId.mailboxInfo.userIdentity;return Object(_.t)(e)?{FolderId:t.Id}:Object(N.r)(e)?{FolderId:t.Id,MailboxId:e,MailboxType:Object(N.t)(e)?2:3}:null}return null}function R(n){return Object(m.n)().filter((function(r){return function(n,r){return!!n&&n.calendarGroupId.mailboxInfo.userIdentity===r}(r,n)})).sort(P)}function P(n,r){var e=q[n.GroupType]-q[r.GroupType];if(0!==e)return e;var t=U[n.calendarGroupId.mailboxInfo.type]-U[r.calendarGroupId.mailboxInfo.type];return 0!==t?t:n.GroupName.localeCompare(r.GroupName)}var q=((A={})[0]=0,A[2]=1,A[1]=2,A[3]=3,A),U=((k={}).UserMailbox=0,k.TeamsMailbox=1,k.GroupMailbox=2,k.PublicMailbox=3,k.SharedMailbox=4,k.ArchiveMailbox=5,k);function V(n,r){var e=Object(m.q)(n),t=Object(m.d)().filter((function(t){return function(n,r){return!!n&&n.id.mailboxInfo.userIdentity===r}(t,n)&&z(t,r)&&(d=e,!((a=t)&&d&&a.id.id===d.id.id));var a,d})).sort(B);return e&&z(e,r)&&t.unshift(e),t}function z(n,r){var e=Object(m.h)(n);return!!e&&e.ParentGroupId===r}function B(n,r){return n.displayName.localeCompare(r.displayName)}e.d(r,"D",(function(){return u})),e.d(r,"b",(function(){return c})),e.d(r,"a",(function(){return i})),e.d(r,"R",(function(){return l})),e.d(r,"T",(function(){return f})),e.d(r,"U",(function(){return I})),e.d(r,"Q",(function(){return b})),e.d(r,"P",(function(){return s})),e.d(r,"e",(function(){return p})),e.d(r,"C",(function(){return O})),e.d(r,"S",(function(){return j})),e.d(r,"V",(function(){return v})),e.d(r,"v",(function(){return m.q})),e.d(r,"F",(function(){return m.s})),e.d(r,"k",(function(){return m.g})),e.d(r,"g",(function(){return m.d})),e.d(r,"s",(function(){return m.n})),e.d(r,"q",(function(){return m.m})),e.d(r,"t",(function(){return m.o})),e.d(r,"m",(function(){return m.i})),e.d(r,"j",(function(){return m.f})),e.d(r,"l",(function(){return m.h})),e.d(r,"o",(function(){return m.k})),e.d(r,"u",(function(){return m.p})),e.d(r,"p",(function(){return m.l})),e.d(r,"w",(function(){return m.r})),e.d(r,"i",(function(){return m.e})),e.d(r,"d",(function(){return m.b})),e.d(r,"I",(function(){return m.t})),e.d(r,"J",(function(){return m.u})),e.d(r,"M",(function(){return m.w})),e.d(r,"c",(function(){return m.a})),e.d(r,"n",(function(){return m.j})),e.d(r,"L",(function(){return m.v})),e.d(r,"O",(function(){return m.x})),e.d(r,"f",(function(){return m.c})),e.d(r,"h",(function(){return h.a})),e.d(r,"x",(function(){return M})),e.d(r,"r",(function(){return y.a})),e.d(r,"N",(function(){return E})),e.d(r,"E",(function(){return F})),e.d(r,"y",(function(){return T})),e.d(r,"G",(function(){return w})),e.d(r,"K",(function(){return K})),e.d(r,"H",(function(){return S})),e.d(r,"B",(function(){return D})),e.d(r,"z",(function(){return R})),e.d(r,"A",(function(){return V}))}}]);
//# sourceMappingURL=owa.28.js.map
self.scriptsLoaded['owa.28.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.28.js'] = (new Date()).getTime();