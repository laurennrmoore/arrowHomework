self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.53.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[53],{101:function(e,t,n){"use strict";var r=n(2),o=n(200);function a(e,t){var n=null;return p(e,t,(function(e){n=e})),n&&(n.forEach((function(t){return v(e,t.Key)})),Object(o.d)(n)),n}n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return i})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"u",(function(){return s})),n.d(t,"t",(function(){return l})),n.d(t,"m",(function(){return f})),n.d(t,"s",(function(){return v})),n.d(t,"p",(function(){return b})),n.d(t,"w",(function(){return O})),n.d(t,"a",(function(){return j})),n.d(t,"q",(function(){return I})),n.d(t,"k",(function(){return m})),n.d(t,"l",(function(){return p})),n.d(t,"n",(function(){return E})),n.d(t,"o",(function(){return y})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return g})),n.d(t,"i",(function(){return R})),n.d(t,"j",(function(){return S})),n.d(t,"h",(function(){return T})),n.d(t,"v",(function(){return C})),n.d(t,"r",(function(){return a}));var c=Object(r.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK",(function(e,t,n,r,o){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r,partialCalendarEvent:o}})),i=Object(r.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK_FAILED",(function(e,t,n,r){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r}})),u=Object(r.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED_FOR_LOCK",(function(e,t,n,r,o,a,c){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r,event:o,hasEventChanged:a,forceOverrideAllPropertiesForEventIfAvailable:c}})),d=Object(r.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED",(function(e,t,n,r){return{folderId:e,eventKey:t,itemResponseShapeType:n,event:r}})),s=Object(r.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_SERVER",(function(e){return{partialCalendarEvent:e}})),l=Object(r.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_PARTIAL_CALENDAR_EVENT",(function(e){return{partialCalendarEvent:e}})),f=Object(r.action)("CALENDAR_EVENT_MERGE_EVENTS_INTO_CACHE",(function(e){return{events:e}})),v=Object(r.action)("CALENDAR_EVENTS_REMOVE_FULL_CALENDAR_EVENT",(function(e,t){return{folderId:e,eventKey:t}})),b=Object(r.action)("CALENDAR_EVENTS_REMOVE_ALL_FULL_CALENDAR_EVENTS_INFO_FOR_CACHE",(function(e){return{folderId:e}})),O=Object(r.action)("ADD_CALENDAR_EVENTS_TO_EVENTS_CACHE",(function(e,t,n,r){return void 0===r&&(r=!1),{folderId:e,calendarEvents:t,dateRanges:n,forceReplace:r}})),j=Object(r.action)("ADD_CALENDAR_EVENTS_WITHING_CURRENT_LOCKED_DATE_RANGES",(function(e,t){return{folderId:e,calendarEvents:t}})),I=Object(r.action)("REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",(function(e,t){return{folderId:e,instanceKey:t}})),m=Object(r.action)("INTERNAL_REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",(function(e,t,n){return{folderId:e,instanceKey:t,onEventsRemoved:n}})),p=Object(r.action)("INTERNAL_REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",(function(e,t,n){return{folderId:e,predicate:t,onEventsRemoved:n}})),E=Object(r.action)("CALENDAR_EVENTS_RELEASE_LOCK",(function(e){return{lockId:e}})),y=Object(r.action)("RELEASE_LOCK",(function(e){return{lockId:e}})),h=Object(r.action)("CALENDAR_EVENTS_IN_EVENTS_CACHE_RELOADED",(function(e,t,n,r){return void 0===r&&(r=!1),{folderId:e,eventsReloaded:t,dateRanges:n,forceReplace:r}})),g=Object(r.action)("CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",(function(e,t,n,r){return{lockId:e,folderId:t,dateRange:n,calendarEvents:r}})),R=Object(r.action)("INTERNAL_CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",(function(e,t,n,r){return{lockId:e,folderId:t,dateRange:n,calendarEvents:r}})),S=Object(r.action)("INTERNAL_DELETE_EVENTS_CACHE",(function(e){return{folderId:e}})),T=Object(r.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_WAS_USED",(function(e,t){return{lockId:e,eventKey:t}})),C=Object(r.action)("UpdateItem",(function(e,t){return{existingItem:e,updatedItem:t}}))},1010:function(e,t,n){"use strict";var r=n(21),o=n(1013),a=n(898),c=n(5),i=n(76);function u(e){var t=Object(i.v)();return e.ParentFolderId&&t&&e.ParentFolderId.Id===t.calculatedFolderId}function d(e){if(!e.ParentFolderId)return!1;var t=Object(i.l)(Object(i.v)()),n=Object(i.o)(e.ParentFolderId.Id);return(null==n?void 0:n.ParentGroupId)===(null==t?void 0:t.ParentGroupId)}function s(e,t){var n=Object(a.a)(e);if(n!=Object(a.a)(t))return n?-1:1;var r=f(t)-f(e);if(0!=r)return r;if(0!=(r=Object(c.w)(e.Start,t.Start)))return r;if(v(e)&&v(t)){var i=u(e);if(i!=u(t))return i?-1:1;var s=d(e);if(s!=d(t))return s?-1:1}return 0!=(r=Object(o.a)(e,t))?r:0!=(r=Object(c.w)(t.End,e.End))?r:0!=(r=l(e.Subject,t.Subject))?r:0!=(r=l(e.CalendarItemType,t.CalendarItemType))?r:0!=(r=l(e.ParentFolderId.Id,t.ParentFolderId.Id))?r:l(e.ItemId.Id,t.ItemId.Id)}function l(e,t){return(e||"").localeCompare(t||"")}function f(e){var t=Object(c.w)(e.End,e.Start);return Math.max(Math.ceil(t/r.e),1)}function v(e){return"Booking"!=e.__type&&"AnonymousCalendarEvent"!=e.__type}n.d(t,"a",(function(){return s}))},1013:function(e,t,n){"use strict";var r=n(901);t.a=function(e,t){return Object(r.a)(e.FreeBusyType)-Object(r.a)(t.FreeBusyType)}},1014:function(e,t,n){"use strict";var r=n(1),o=n(419),a=n(24),c=n(5);var i=n(439),u=n(33);function d(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.a)({__type:"ExpandCalendarEventJsonRequest:#Exchange"},n)),Object(u.a)("ExpandCalendarEvent",e,t)}var s=n(180);function l(e,t){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,d({Header:Object(s.b)(),Body:(u={EventId:Object(i.a)({Id:e.Id}),WindowStart:Object(c.rb)(t.start),WindowEnd:Object(c.rb)(t.end),ReturnMaster:!0,ReturnRegularOccurrences:!0,ReturnExceptions:!0,ReturnCancellations:!0,IncludeDeclinedMeetings:Object(a.i)("cal-surface-declinedMeetings")},Object(r.a)({__type:"ExpandCalendarEventRequest:#Exchange"},u))},Object(o.a)(e.mailboxInfo))];case 1:return[2,n.sent().Body]}var u}))}))}n.d(t,"a",(function(){return l}))},1017:function(e,t,n){"use strict";function r(){return{__type:void 0,ItemId:void 0,ParentFolderId:void 0,Subject:void 0,ReminderIsSet:void 0,ReminderMinutesBeforeStart:void 0,LastModifiedTime:void 0,InstanceKey:void 0,Preview:void 0,EffectiveRights:void 0,HasAttachments:void 0,HasBlockedImages:void 0,Attachments:void 0,Sensitivity:void 0,Body:void 0,EntityNamesMap:void 0,TailoredXpEntities:void 0,IsDraft:void 0,Categories:void 0,Start:void 0,End:void 0,IsAllDayEvent:void 0,IsRoomRequested:void 0,AutoRoomBookingStatus:void 0,FreeBusyType:void 0,IsMeeting:void 0,IsCancelled:void 0,IsRecurring:void 0,IsResponseRequested:void 0,CalendarItemType:void 0,ResponseType:void 0,Organizer:void 0,RequiredAttendees:void 0,OptionalAttendees:void 0,Resources:void 0,AppointmentReplyTime:void 0,Recurrence:void 0,Location:void 0,IntendedFreeBusyStatus:void 0,IsOrganizer:void 0,AppointmentReplyName:void 0,IsSeriesCancelled:void 0,CharmId:void 0,Locations:void 0,ClientSeriesId:void 0,UID:void 0,SeriesId:void 0,ExperienceType:void 0,DoNotForwardMeeting:void 0,IsOnlineMeeting:void 0,JoinOnlineMeetingUrl:void 0,InboxReminders:void 0,MeetingRequestWasSent:void 0,ExtractionSourceId:void 0,StartTimeZoneId:void 0,EndTimeZoneId:void 0,OnlineMeetingProvider:void 0,OnlineMeetingJoinUrl:void 0,OnlineMeetingConferenceId:void 0,OnlineMeetingTollNumber:void 0,OnlineMeetingTollFreeNumbers:void 0,SeriesMasterItemId:void 0,ExtractionSourceInternetMessageId:void 0,HideAttendees:void 0,PersonId:void 0,InReplyTo:void 0,IsFreeBusyOnly:void 0,ConversationId:void 0,SkypeTeamsProperties:void 0,DocLinks:void 0,AppendOnSend:void 0,IsBookedFreeBlocks:void 0,AssociatedTasks:void 0,CollabSpace:void 0,TravelTimeEventsLinked:void 0,FlexEventsMetadata:void 0}}n.d(t,"a",(function(){return r}))},1020:function(e,t,n){"use strict";var r=n(439),o=n(769),a=n(1),c=n(419),i=n(24),u=n(519),d=n(1321),s=n(1324),l=n(180),f=n(745),v=n(833),b=n(870);var O=n(581),j="X-RedirectToCalendarService",I=7,m=null;function p(e,t,n,r,o){return void 0===o&&(o=void 0),Object(a.c)(this,void 0,void 0,(function(){var O,I,m,p,y,h,g,R,S;return Object(a.f)(this,(function(a){switch(a.label){case 0:O=e.Id,I=e.mailboxInfo,p=null,y=null,(h=Object(c.a)(I)||{}).datapoint={customData:{itemId:O,fetchingMasterItem:n},jsonCustomData:function(e){var t=e.Body.ResponseMessages.Items[0];return{responseClass:t.ResponseClass,responseCode:t.ResponseCode}}},Object(i.i)("platform-redirectToCalendarService")&&(h.headers||(h.headers=new Headers),h.headers.set(j,"true")),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,E().add((function(){return Object(s.a)({Header:Object(l.b)(),Body:Object(d.a)({EventIds:r,ItemShape:t,IncludeDeclinedMeetings:Object(i.i)("cal-surface-declinedMeetings")})},h)}))];case 2:return p=a.sent(),"Success"==(m=p.Body.ResponseMessages.Items[0]).ResponseClass?null!=m?null!=(g=m.Items[0])&&(!function(e){e.Locations?e.Locations=e.Locations.filter((function(e){return e})):e.Locations=[],e.Resources&&e.Resources.map((function(t){Object(v.c)(e.Locations,t.Mailbox.EmailAddress)||(e.Locations=e.Locations.filter((function(e){return e.DisplayName!==t.Mailbox.Name||Object(b.r)(e.PostalAddress)})),e.Locations.push(Object(b.g)(t.Mailbox.Name,t.Mailbox.EmailAddress)))}))}(g),o&&(g.ParentFolderId.Id=o),y={calendarEvent:Object(u.a)(g,e.mailboxInfo),error:null,responseCode:m.ResponseCode}):y={calendarEvent:null,error:"[getCalendarEventService] null response.",responseCode:m.ResponseCode}:(R="[getCalendarEventService] request failed. Message: "+m.MessageText+", ResponseCode: "+m.ResponseCode+", ResponseClass: "+m.ResponseClass,y={calendarEvent:null,error:R,responseCode:m.ResponseCode}),[3,5];case 3:return S=a.sent(),y={calendarEvent:null,error:S.message},[3,5];case 4:return Object(i.i)("cal-mf-diagnostics")&&Object(f.a)({action:"GetCalendarEvent",status:(null==m?void 0:m.ResponseClass)||"Error",response:null==p?void 0:p.Body}),[7];case 5:return[2,y]}}))}))}function E(){return null==m&&(m=Object(O.a)(I)),m}var y=n(33);function h(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.a)({__type:"GetBirthdayEventJsonRequest:#Exchange"},n)),Object(y.a)("GetBirthdayEvent",e,t)}var g=n(1024);var R=n(76);function S(e,t,n,i){void 0===i&&(i=!1);var u=Object(R.o)(t);return u&&3==u.CalendarFolderType?function(e,t){return Object(a.c)(this,void 0,void 0,(function(){var n,o,i,u,d;return Object(a.f)(this,(function(s){switch(s.label){case 0:return n=e.Id,o=e.mailboxInfo,(i=Object(c.a)(o)||{}).datapoint={customData:{itemId:n},jsonCustomData:function(e){var t,n;return{responseClass:null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseClass,responseCode:null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseCode}}},[4,h({Header:Object(l.b)(),Body:(f={CalendarItemId:Object(r.a)({Id:n})},Object(a.a)({__type:"GetBirthdayEventRequest:#Exchange"},f))},i)];case 1:return null!=(u=s.sent()).Body&&"Success"==u.Body.ResponseClass&&null!=(d=u.Body.BirthdayEvent)?[2,{calendarEvent:Object(g.a)(d,t,void 0,e.mailboxInfo),error:null}]:[2,{calendarEvent:null,error:"[getBirthdayEventService] request failed"}]}var f}))}))}(e,t):p(e,n,i,[i?Object(o.a)({OccurrenceId:e.Id}):Object(r.a)({Id:e.Id})],Object(R.L)(u)?t:void 0)}n.d(t,"a",(function(){return S}))},1021:function(e,t,n){"use strict";var r=n(1),o=n(1087),a=n(903),c=n(1262),i=n(1100),u=n(24),d=n(94);var s=n(904),l=n(905),f=n(906),v=n(907);function b(e){var t=[a.a];Object(u.i)("cal-time-panel-focusTime")&&t.push(s.a),Object(u.i)("cal-cmp-fluidCollaborativeSpace")&&t.push(l.a),Object(u.i)("cal-mf-mobility-create")&&(t.push(f.a),t.push(v.a));var n={BaseShape:"IdOnly",MaximumBodySize:0,BodyType:"HTML",FilterHtmlContent:!0,InlineImageCustomDataTemplate:o.e,InlineImageUrlTemplate:o.f,AddBlankTargetToLinks:!0,CssScopeClassName:"cal_"+Math.ceil(65534*Math.random()+1).toString(16),AdditionalProperties:t,ImageProxyCapability:Object(u.i)("cal-bodyImageProxy")&&Object(c.a)()?i.a.OwaAndConnectorsProxy:i.a.None};if(!Object(u.i)("cal-mf-blockExternalContent"))return n;switch(e){case"Default":return Object(r.a)(Object(r.a)({},n),{BlockContentFromUnknownSenders:!0,BlockExternalImages:!0});case"WithBlockedExternalContent":return n;default:return Object(d.a)(e)}}n.d(t,"a",(function(){return b}))},1022:function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return h}));var r=n(1),o=n(828),a=n(101),c=n(200),i=n(663),u=n(76),d=n(428),s=n(137),l=n(269),f=n(1027),v=n(199),b=n(911),O=n(23),j=n(1023),I={};function m(e){I[e]||(I[e]=[])}function p(e,t){m(e);for(var n=I[e],r=0;r<n.length;r++)if(t(n[r]))return{index:r,info:n[r]};return{index:-1,info:null}}function E(e,t){return p(e,(function(e){return Object(s.c)(e.dateRange,t,!0)}))}function y(e){return m(e),I[e].map((function(e){return e.dateRange}))}function h(e,t,n){var d=this,O=Object(v.g)(e,t);if(null===n)return{fetchPromise:new Promise((function(e){return Object(r.c)(d,void 0,void 0,(function(){return Object(r.f)(this,(function(t){return[2,e([])]}))}))}))};!function(e,t,n){var r,o,a=function(e,t){return p(e,(function(e){return e.lockIds.indexOf(t)>-1}))}(e,n).info;if(a){var c=1==a.lockIds.length,i=Object(s.c)(a.dateRange,t,!0);c&&!i&&(null===(o=null===(r=a.requestPromises)||void 0===r?void 0:r.cancelEnhancedFetchPromise)||void 0===o||o.call(r))}}(t,n,e);var y=E(t,n).info;if(O&&O.lockedDateRange&&Object(s.c)(O.lockedDateRange,n,!0)){var h=Object(u.t)(t);Object(c.j)(e,h,"Loaded");var T=Object(o.a)(e,t,n);D=g(T,t,n,y);return{fetchPromise:Promise.resolve(T),enhancedFetchPromise:D,events:T}}var C=function(e,t){var n=Object(v.d)(e),o=Object(v.f)(e);return n.some((function(e){return Object(s.c)(e,t,!0)}))&&o?Object(j.a)(Object(l.j)(t,o.events)).map((function(e){return Object(r.a)({},e)})):null}(t,n);if(C){var P=R(e,t,n,Promise.resolve(C),"existing"),A=g(C,t,n,y);return null==P||P.then((function(n){var r=Object(u.t)(t);Object(c.j)(e,r,"Loaded")})),{fetchPromise:P,enhancedFetchPromise:A,events:C}}if(null==y?void 0:y.requestPromises){var F=y.requestPromises,N=F.fetchPromise,M=F.enhancedFetchPromise;return y.lockIds.push(e),{fetchPromise:R(e,t,n,null==N?void 0:N.then((function(e){return e?e.filter((function(e){var t=e.Start,r=e.End;return 0==Object(s.j)(n,{start:t,end:r},!0)})):[]})),"new"),enhancedFetchPromise:null==M?void 0:M.then((function(e){return S(n)(e)})),events:null}}!function(e,t,n){m(t),I[t].push({dateRange:n,requestPromises:null,lockIds:[e]})}(e,t,n);var x=function(e,t,n){var o=this,a=Object(f.a)(t,e,n,i.c);return{fetchPromise:Object(r.c)(o,void 0,void 0,(function(){return Object(r.f)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,,2,3]),[4,null==a?void 0:a.fetchPromise];case 1:return[2,n.sent()];case 2:return function(e,t){var n=E(e,t).index;-1!==n&&I[e].splice(n,1)}(e,t),[7];case 3:return[2]}}))})),enhancedFetchPromise:null==a?void 0:a.enhancedFetchPromise}}(t,n,function(e,t){return function(n,r){var o=E(e,t),a=o.index,i=o.info;-1!==a&&i.lockIds.forEach((function(e){Object(c.j)(e,n,r)}))}}(t,n)),_=null==x?void 0:x.fetchPromise,w=null==x?void 0:x.enhancedFetchPromise;!function(e,t,n){var r=E(e,t),o=r.index,a=r.info;-1!==o&&(a.requestPromises=n)}(t,n,x);var D,L=R(e,t,n,_,"new");return{fetchPromise:L,enhancedFetchPromise:D=function(e,t,n,o){return Object(r.c)(this,void 0,void 0,(function(){var c,i;return Object(r.f)(this,(function(u){switch(u.label){case 0:return[4,Promise.all([n,o])];case 1:return c=r.g.apply(void 0,[u.sent(),1]),(i=c[0])&&(Object(b.a)(e,t),Object(a.m)(i)),[2,i]}}))}))}(t,n,w,L),events:null}}function g(e,t,n,r){var o,a,c=null;if(t===(null===(o=Object(u.v)())||void 0===o?void 0:o.calculatedFolderId))if(Object(b.b)(t,n)&&e)c=Promise.resolve(e);else if(null===(a=null==r?void 0:r.requestPromises)||void 0===a?void 0:a.enhancedFetchPromise){c=r.requestPromises.enhancedFetchPromise.then(S(n))}else O.g.warn("[loadEnhancedEvents] - Failed to load GetCalendarView++ events on an existing lock.");return c}function R(e,t,n,o,c){return Object(r.c)(this,void 0,void 0,(function(){var i,u;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,o];case 1:return i=r.sent(),u=i?i.length:"no",Object(d.a)({lockId:e,updateMessage:"Fetched "+u+" "+c+" items for date range: "+n.start+" - "+n.end}),i&&Object(a.b)(e,t,n,i),[2,i]}}))}))}function S(e){return function(t){return t?t.filter((function(t){var n=t.Start,r=t.End;return!(!n||!r)&&0==Object(s.j)(e,{start:n,end:r},!0)})):[]}}},1023:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(379);function o(e){return e.filter((function(e){return!Object(r.K)(e.CalendarItemType)}))}},1024:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),o=n(5),a=n(1017),c=n(209),i=n(137),u=n(199),d=n(386);function s(e,t,n,d){if(d=d||Object(c.d)(),!n){var s=Object(u.d)(t);s&&s.length>0&&(n=s.sort((function(e,t){var n=Object(i.l)(e),r=Object(i.l)(t);return n>r?-1:n<r?1:0}))[0])}var f=Object(a.a)(),v=function(e,t){var n=Object(o.nc)(e),r=l(n,Object(o.Db)(t.start));return Object(i.t)(t,r)?r:l(n,Object(o.Db)(t.end))}(e.Birthday,n),b=Object(r.a)(Object(r.a)(Object(r.a)({},f),e),{Subject:e.Name,Start:v,End:Object(o.e)(v,1),IsAllDayEvent:!0,ParentFolderId:{Id:t,mailboxInfo:d},ItemId:{Id:e.Id.Id,mailboxInfo:d},PersonId:e.PersonId,EffectiveRights:{Delete:!0,Modify:!0,Read:!0},FreeBusyType:"Free",ReminderIsSet:e.PopupReminderSettings[0].IsReminderSet,ReminderMinutesBeforeStart:e.PopupReminderSettings[0].ReminderMinutesBeforeStart,InboxReminders:e.EmailReminderSettings});return b||null}function l(e,t){var n=Object(o.yb)(e),r=Object(o.mb)(e),a=Object(d.a)(t,n),c=Math.min(r,a);return Object(o.nc)(t,n,c)}},1025:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),o=n(442),a=n(1020),c=n(1021);function i(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return t=e.ParentFolderId.Id,null===Object(o.f)(e.ItemId.Id)?[3,2]:(n=Object(o.b)(e.ItemId.Id),i=Object(c.a)(n),[4,Object(a.a)(e.ItemId,t,i)]);case 1:return[2,r.sent().calendarEvent];case 2:return[2,Promise.resolve(null)]}}))}))}},1026:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("CALENDAR_EVENTS_CLEAR_ALL_FULL_CALENDAR_EVENTS",(function(){return{}}))},1027:function(e,t,n){"use strict";var r=n(1),o=n(76),a=n(519),c=n(1024);var i=n(33);function u(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.a)({__type:"GetBirthdayCalendarViewJsonRequest:#Exchange"},n)),Object(i.a)("GetBirthdayCalendarView",e,t)}var d=n(5),s=n(180),l=n(419);function f(e,t,n){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(o){switch(o.label){case 0:return[4,u({Header:Object(s.b)(),Body:(a={StartRange:Object(d.rb)(e),EndRange:Object(d.rb)(t)},Object(r.a)({__type:"GetBirthdayCalendarViewRequest:#Exchange"},a))},Object(l.a)(n.mailboxInfo))];case 1:return[2,o.sent().Body]}var a}))}))}var v=n(1320),b=n(489),O=n(57);function j(e,t,n,o){return Object(r.c)(this,void 0,void 0,(function(){var a,c;return Object(r.f)(this,(function(r){return a=Object(O.h)().UserOptions.TimeZone,c="ows/api/beta/TeamsCalendarEvents/items?id="+encodeURIComponent(n)+"&rangeStart="+encodeURIComponent(Object(d.rb)(e))+"&rangeEnd="+encodeURIComponent(Object(d.rb)(t))+"&channelId="+o+"&timeZone="+a,[2,Object(b.b)("getTeamsCalendarView",null,c)]}))}))}var I=n(824),m=n(24),p=n(426),E=n(860);function y(e,t,n){return function(r){if(!h(r)||r.ParentFolderId.Id!==e)return!1;var o=function(e,t){return function(n){return h(n)&&n.ParentFolderId.Id===e&&n.ItemId.Id===t}}(r.ParentFolderId.Id,r.ItemId.Id);return n?t.some(o):!t.some(o)}}function h(e){var t;return(null===(t=null==e?void 0:e.ItemId)||void 0===t?void 0:t.Id)&&e.ParentFolderId&&e.ParentFolderId.Id}var g=n(101),R=n(199),S=n(908);var T=n(121),C=n(200);var P=n(23),A=n(2),F=n(268),N=Object(A.mutatorAction)("updateCalendarWorkingHours",(function(e,t){Object(F.a)().calendarFolderWorkingHours.set(e,t)}));function M(e,t,n,a){void 0===a&&(a=0);var c=function(e,t,n,a){void 0===a&&(a=0);return Object(r.c)(this,void 0,void 0,(function(){var c,i,u;return Object(r.f)(this,(function(r){return(c=Object(T.u)())&&c.addCustomData({outOfCacheRange:!0}),i=Object(o.t)(t),n(i,"Loading"),Object(o.I)(t)?3==(u=Object(o.o)(t)).CalendarFolderType?[2,w(e,i,t,n,a)]:[2,_(e,i,t,n,null,a)]:(u=Object(o.l)({id:i}),Object(o.M)(u)?[2,x(t,u,e,i,n,a)]:(n(i,"Failed"),[2,null]))}))}))}(e,t,n,a);return Object(r.a)({fetchPromise:c},function(e,t){var n;if(Object(m.i)("cal-mf-noPeekJump")&&e==(null===(n=Object(o.v)())||void 0===n?void 0:n.calculatedFolderId)){var r=E.u.importAndExecute(t);return{enhancedFetchPromise:r.then((function(e){return e.requestPromise})),cancelEnhancedFetchPromise:function(){r.then((function(e){e.cancel()}))}}}return{enhancedFetchPromise:null,cancelEnhancedFetchPromise:null}}(t,e))}function x(e,t,n,o,c,i){return void 0===i&&(i=0),Object(r.c)(this,void 0,void 0,(function(){var u,d,s,l,f,v;return Object(r.f)(this,(function(b){switch(b.label){case 0:if(!(!t.FolderId&&Object(p.e)(t)||t.hasOwnProperty("OwnerEmailAddress")&&!t.IsGroupMailboxCalendar&&!t.EffectiveRights)&&(t.EffectiveRights&&t.EffectiveRights.Read||!t.IsGeneralScheduleCalendar))return[3,7];b.label=1;case 1:if(!(i>=0))return[3,6];b.label=2;case 2:return b.trys.push([2,4,,5]),[4,Object(I.b)(n.start,n.end,[t.OwnerEmailAddress],"DetailedMerged",null,o.mailboxInfo)];case 3:return"NoError"==(u=b.sent()).ResponseCode?(c(o,"Loaded"),function(e,t){var n=Object(R.a)(e);if(null==n?void 0:n.length){var r=Object(S.a)(n,[t]).eventsOverlapping;Object(g.r)(e,y(e,r,!0))}}(e,n),function(e){var t=Object(R.f)(e),n=t?Object(r.j)([],Object(r.g)(t.events.values())):[];Object(C.e)(y(e,n,!1))}(e),d=u.Responses[0].CalendarView,s=d.WorkingHours,l=d.Items,N(e,s),[2,l.map((function(e){return Object(a.a)(e,o.mailboxInfo)}))]):(i--,[3,5]);case 4:return f=b.sent(),P.g.warn("[loadCalendarEventsInDateRange:loadCalendarEventsUsingFolderId: Exception occured: "+f),f.message&&(f.message.indexOf("ErrorApiQuarantined")>=0||f.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(c(o,"Throttled"),[2,null]):(i--,[3,5]);case 5:return[3,1];case 6:return c(o,"Failed"),[2,null];case 7:return v=t.FolderId?t.FolderId.Id:t.SharedFolderId.Id,[2,_(n,o,v,c,t.IsGroupMailboxCalendar?null:t.OwnerEmailAddress,i)]}}))}))}function _(e,t,n,c,i,u){return void 0===u&&(u=0),Object(r.c)(this,void 0,void 0,(function(){var d,s;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(!(u>=0))return[3,8];r.label=1;case 1:return r.trys.push([1,6,,7]),d=void 0,t.mailboxInfo&&"TeamsMailbox"==t.mailboxInfo.type?[4,j(e.start,e.end,Object(o.f)(n),t.id)]:[3,3];case 2:return(d=r.sent())&&(d=d.Body),[3,5];case 3:return[4,Object(v.a)(e.start,e.end,n,t,i,Object(m.i)("cal-surface-declinedMeetings"))];case 4:d=r.sent(),r.label=5;case 5:return"NoError"==d.ResponseCode?(c(t,"Loaded"),[2,d.Items.map((function(e){return t.mailboxInfo&&"TeamsMailbox"==t.mailboxInfo.type&&(e.ParentFolderId.Id=n),Object(a.a)(e,t.mailboxInfo)}))]):(u--,[3,7]);case 6:return s=r.sent(),P.g.warn("[loadCalendarEventsInDateRange:getCalendarView: Exception occured: "+s),s.message&&(s.message.indexOf("ErrorApiQuarantined")>=0||s.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(c(t,"Throttled"),[2,null]):(u--,[3,7]);case 7:return[3,0];case 8:return c(t,"Failed"),[2,null]}}))}))}function w(e,t,n,o,a){return void 0===a&&(a=0),Object(r.c)(this,void 0,void 0,(function(){var i,u;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(!(a>=0))return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,f(e.start,e.end,t)];case 2:return"NoError"==(i=r.sent()).ResponseCode?(o(t,"Loaded"),[2,i.BirthdayEvents.map((function(r){return Object(c.a)(r,n,e,t.mailboxInfo)}))]):(a--,[3,4]);case 3:return u=r.sent(),P.g.warn("[loadCalendarEventsInDateRange:getBirthdayCalendarView: Exception occured: "+u),u.message&&(u.message.indexOf("ErrorApiQuarantined")>=0||u.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(o(t,"Throttled"),[2,null]):(a--,[3,4]);case 4:return[3,0];case 5:return o(t,"Failed"),[2,null]}}))}))}n.d(t,"a",(function(){return M}))},1028:function(e,t,n){"use strict";var r=n(199),o=n(829);var a=n(1026);function c(){Object(a.a)(),Object(r.b)().map((function(e){return Object(o.a)(e,!0)}))}n.d(t,"a",(function(){return c}))},1282:function(e,t,n){"use strict";var r=n(1010),o=n(1013),a=(n(901),n(5));var c=n(1291),i=function(e,t){return Object(a.Ab)(e.Start)<Object(a.Ab)(t.End)&&Object(a.Ab)(e.End)>Object(a.Ab)(t.Start)},u=function(e,t){return t.filter((function(t){return t!=e&&i(e,t)})).sort(r.a)};function d(e,t){var n,r,o,c,i;e.Start=t.Start,e.ItemId=t.ItemId,e.End=t.End,e.CalendarItemType="ThisAndFollowingInstancesMaster",e.Recurrence.RecurrenceRange.StartDate=(r=(n=t).StartTimeZoneId,o=n.Start,c=Object(a.Sb)(r,o),i=Object(a.Yb)(c),Object(a.vb)(i))}var s=n(898);function l(e){e.Start=Object(a.Sb)(e.StartTimeZoneId,e.Start),e.End=Object(a.Sb)(e.EndTimeZoneId,e.End)}n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return o.a})),n.d(t,"c",(function(){return c.a})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return s.a})),n.d(t,"h",(function(){return l}))},1326:function(e,t,n){"use strict";var r=n(1342),o=1,a=4;t.a=function(e){return Object(r.a)(e,o|a)}},1331:function(e,t,n){"use strict";var r=n(417),o=n(891),a=n(520);var c=n(1347);function i(e){return function(e){return!(e<=0)&&(Object(a.a)(e,o.a)==o.a||Object(a.a)(e,r.d)==r.d||Object(a.a)(e,r.e)==r.e||Object(a.a)(e,o.b)==o.b||Object(a.a)(e,r.a)==r.a||Object(a.a)(e,r.b)==r.b||Object(a.a)(e,r.f)==r.f)}(e)||function(e){return Object(a.a)(e,r.g)==r.g||Object(a.a)(e,r.h)==r.h||Object(a.a)(e,r.i)==r.i}(e)||Object(c.a)(e)}n.d(t,"a",(function(){return i}))},1334:function(e){e.exports=JSON.parse('{"a":"Uha"}')},1336:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(31),o=n(1331);n.d(t,"a",(function(){return o.a}));var a=new r.c((function(){return Promise.all([n.e(121),n.e(972)]).then(n.bind(null,1890))})),c=new r.a(a,(function(e){return e.getTxpObjectFromTxpEntities}))},1338:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(744),o=n(519),a=n(19),c=n(209);function i(e){for(var t,n,a=[],i=0;i<e.length;i++){var l=e[i],f=d(l.Attendees),v=f.requiredAttendees,b=f.optionalAttendees,O={ItemId:{Id:Object(r.b)(l.Id),mailboxInfo:Object(c.d)()},ResponseType:u(null===(t=l.ResponseStatus)||void 0===t?void 0:t.Response),AppointmentReplyTime:Object(o.b)(s(l.Attendees)),IsOnlineMeeting:l.IsOnlineMeeting,OnlineMeetingProvider:l.OnlineMeetingProvider,OnlineMeetingJoinUrl:null===(n=l.OnlineMeeting)||void 0===n?void 0:n.JoinUrl,RequiredAttendees:v,OptionalAttendees:b};a.push(O)}return a}function u(e){var t;switch(e){case"Accepted":t="Accept";break;case"TentativelyAccepted":t="Tentative";break;case"Organizer":t="Organizer";break;case"Declined":t="Decline";break;case"NotResponded":t="NoResponseReceived";break;default:t="Unknown"}return t}function d(e){var t=[],n=[];return null==e||e.forEach((function(e){var r,o,a,c,i={Mailbox:{Name:null===(r=e.EmailAddress)||void 0===r?void 0:r.Name,EmailAddress:null===(o=e.EmailAddress)||void 0===o?void 0:o.Address},ResponseType:u(null===(a=e.Status)||void 0===a?void 0:a.Response),LastResponseTime:null===(c=e.Status)||void 0===c?void 0:c.Time};"Required"==e.Type?t.push(i):"Optional"==e.Type&&n.push(i)})),{requiredAttendees:t,optionalAttendees:n}}function s(e){var t,n,r,o;if(!e)return null;for(var c=0;c<e.length;c++){var i=e[c];if((o=i.EmailAddress)&&(n=o.Address,r=Object(a.a)().SessionSettings.UserEmailAddress,n===r||n&&r&&n.toLowerCase()==r.toLowerCase()))return null===(t=i.Status)||void 0===t?void 0:t.Time}return null}},1342:function(e,t,n){"use strict";var r=n(585),o=n(1315),a=n(775),c=n(536),i=n(479);var u=function(e,t){return e&&Object(c.a)(t,Object(i.a)(t),e)},d=n(584);var s=function(e,t){return e&&Object(c.a)(t,Object(d.a)(t),e)},l=n(917),f=n(916),v=n(640);var b=function(e,t){return Object(c.a)(e,Object(v.a)(e),t)},O=n(1004);var j=function(e,t){return Object(c.a)(e,Object(O.a)(e),t)},I=n(818),m=n(1312),p=n(620),E=Object.prototype.hasOwnProperty;var y=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&E.call(e,"index")&&(n.index=e.index,n.input=e.input),n},h=n(666);var g=function(e,t){var n=t?Object(h.a)(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},R=/\w*$/;var S=function(e){var t=new e.constructor(e.source,R.exec(e));return t.lastIndex=e.lastIndex,t},T=n(312),C=T.a?T.a.prototype:void 0,P=C?C.valueOf:void 0;var A=function(e){return P?Object(P.call(e)):{}},F=n(918),N="[object Boolean]",M="[object Date]",x="[object Map]",_="[object Number]",w="[object RegExp]",D="[object Set]",L="[object String]",k="[object Symbol]",K="[object ArrayBuffer]",U="[object DataView]",B="[object Float32Array]",q="[object Float64Array]",V="[object Int8Array]",H="[object Int16Array]",z="[object Int32Array]",W="[object Uint8Array]",G="[object Uint8ClampedArray]",J="[object Uint16Array]",Z="[object Uint32Array]";var Y=function(e,t,n){var r=e.constructor;switch(t){case K:return Object(h.a)(e);case N:case M:return new r(+e);case U:return g(e,n);case B:case q:case V:case H:case z:case W:case G:case J:case Z:return Object(F.a)(e,n);case x:return new r;case _:case L:return new r(e);case w:return S(e);case D:return new r;case k:return A(e)}},Q=n(919),$=n(292),X=n(562),ee=n(303),te="[object Map]";var ne=function(e){return Object(ee.a)(e)&&Object(p.a)(e)==te},re=n(660),oe=n(540),ae=oe.a&&oe.a.isMap,ce=ae?Object(re.a)(ae):ne,ie=n(216),ue="[object Set]";var de=function(e){return Object(ee.a)(e)&&Object(p.a)(e)==ue},se=oe.a&&oe.a.isSet,le=se?Object(re.a)(se):de,fe=1,ve=2,be=4,Oe="[object Arguments]",je="[object Function]",Ie="[object GeneratorFunction]",me="[object Object]",pe={};pe[Oe]=pe["[object Array]"]=pe["[object ArrayBuffer]"]=pe["[object DataView]"]=pe["[object Boolean]"]=pe["[object Date]"]=pe["[object Float32Array]"]=pe["[object Float64Array]"]=pe["[object Int8Array]"]=pe["[object Int16Array]"]=pe["[object Int32Array]"]=pe["[object Map]"]=pe["[object Number]"]=pe[me]=pe["[object RegExp]"]=pe["[object Set]"]=pe["[object String]"]=pe["[object Symbol]"]=pe["[object Uint8Array]"]=pe["[object Uint8ClampedArray]"]=pe["[object Uint16Array]"]=pe["[object Uint32Array]"]=!0,pe["[object Error]"]=pe[je]=pe["[object WeakMap]"]=!1;t.a=function e(t,n,c,v,O,E){var h,g=n&fe,R=n&ve,S=n&be;if(c&&(h=O?c(t,v,O,E):c(t)),void 0!==h)return h;if(!Object(ie.a)(t))return t;var T=Object($.a)(t);if(T){if(h=y(t),!g)return Object(f.a)(t,h)}else{var C=Object(p.a)(t),P=C==je||C==Ie;if(Object(X.a)(t))return Object(l.a)(t,g);if(C==me||C==Oe||P&&!O){if(h=R||P?{}:Object(Q.a)(t),!g)return R?j(t,s(h,t)):b(t,u(h,t))}else{if(!pe[C])return O?t:{};h=Y(t,C,g)}}E||(E=new r.a);var A=E.get(t);if(A)return A;E.set(t,h),le(t)?t.forEach((function(r){h.add(e(r,n,c,r,t,E))})):ce(t)&&t.forEach((function(r,o){h.set(o,e(r,n,c,o,t,E))}));var F=S?R?m.a:I.a:R?d.a:i.a,N=T?void 0:F(t);return Object(o.a)(N||t,(function(r,o){N&&(r=t[o=r]),Object(a.a)(h,o,e(r,n,c,o,t,E))})),h}},1344:function(e){e.exports=JSON.parse('{"a":"Wha"}')},1345:function(e){e.exports=JSON.parse('{"a":"Vha"}')},1346:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(5);function o(e,t){if(null==t?void 0:t.RecurrenceRange){var n=t.RecurrenceRange.EndDate;if(n)return Object(r.Sb)(e,n)}return null}},1347:function(e,t,n){"use strict";var r=n(520);var o=n(417),a=n(24),c="cal-txp-invoice";function i(e){return function(e,t,n){return Object(r.a)(e,t)==t&&n}(e,o.c,Object(a.i)(c))}n.d(t,"a",(function(){return i}))},1355:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("logNotificationUpdateForDiagnostics",(function(e){return{notificationUpdateLog:e}}))},200:function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return v})),n.d(t,"f",(function(){return b})),n.d(t,"j",(function(){return O})),n.d(t,"g",(function(){return j})),n.d(t,"i",(function(){return I})),n.d(t,"h",(function(){return m}));var r=n(1334),o=n(1344),a=n(1345),c=n(6),i=n(44),u=n(2),d=Object(u.action)("calendarEventsRemoved",(function(e){return{eventsRemoved:e}})),s=Object(u.action)("calendarEventsAdded",(function(e){return{eventsAdded:e}})),l=Object(u.action)("calendarEventUpdated",(function(e){return{eventUpdated:e}})),f=Object(u.action)("calendarEventsRemovedMatchedFilter",(function(e){return{removePredicate:e}})),v=Object(u.action)("cacheReloaded",(function(e,t){return{previousEvents:e,reloadedEvents:t}})),b=Object(u.action)("deleteEventsCache",(function(e){return{folderId:e}})),O=Object(u.action)("loadingCalendarEvents",(function(e,t,n){return Object(i.c)({name:"CalendarLoadState",customData:{loadingState:n},options:{isVerbose:!0}},{lockId:e,calendarId:t,loadingState:n})})),j=Object(u.action)("instantCalendarEventCreate",(function(e,t,n,r,a,i,u){return void 0===r&&(r=function(){}),void 0===a&&(a=void 0),void 0===i&&(i=Object(c.b)(o.a)),void 0===u&&(u=function(){}),{eventToCreate:e,actionToExecute:t,onEventCreatedSuccess:n,onEventCreatedFailed:r,actionSource:a,errorMessage:i,onEventCreatedLocally:u}})),I=Object(u.action)("instantCalendarEventUpdate",(function(e,t,n,o,a,i,u,d,s){return void 0===i&&(i=function(){}),void 0===u&&(u=void 0),void 0===d&&(d=Object(c.b)(r.a)),void 0===s&&(s=function(){}),{eventId:e,eventChanges:t,eventScope:n,actionToExecute:o,onEventUpdateSuccess:a,onEventUpdateFailed:i,actionSource:u,errorMessage:d,onEventUpdatedLocally:s}})),m=Object(u.action)("instantCalendarEventDelete",(function(e,t,n,r,o,i,u,d,s,l){return void 0===i&&(i=function(){}),void 0===u&&(u=void 0),void 0===d&&(d=Object(c.b)(a.a)),void 0===s&&(s=!1),void 0===l&&(l=function(){return Promise.resolve(!1)}),{eventId:e,eventScope:t,dataPoint:n,actionToExecute:r,onEventDeleteSuccess:o,onEventDeleteFailed:i,actionSource:u,errorMessage:d,responseSent:s,asyncUndoAction:l}}))},288:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return l}));var r=n(1),o=n(269),a=n(268),c=n(428);function i(e,t){var n=Object(a.a)().calendarFolderEvents.get(e);return n?Object(r.j)([],Object(r.g)(n.events.values())).filter(t):[]}function u(e,t){return void 0===t&&(t=null),t?Object(r.g)(i(t,(function(t){return t.ItemId.Id===e})),1)[0]||null:f((function(t){return t.ItemId.Id===e}))}function d(e,t){return void 0===t&&(t=null),t?Object(r.g)(i(t,(function(t){return t.InstanceKey===e})),1)[0]||null:f((function(t){return t.InstanceKey===e}))}function s(e,t){void 0===t&&(t=null);var n=Object(a.a)();return t?n.calendarFolderEvents.get(t).events.get(e)||null:function(e){for(var t=Object(a.a)(),n=Object(r.j)([],Object(r.g)(t.calendarFolderEvents.keys())),o=0;o<n.length;o++){var c=n[o],i=s(e,c);if(i)return i}return null}(e)}function l(e,t,n){var i=null,u=(i=e?function(e,t,n){var c=Object(a.a)().calendarFolderEvents.get(e);return c&&Object(r.g)(Object(o.l)([t],n,c),1)[0]||null}(e,t,n):function(e,t){for(var n=Object(a.a)(),c=Object(r.j)([],Object(r.g)(n.calendarFolderEvents.keys())),i=0;i<c.length;i++){var u=c[i],d=n.calendarFolderEvents.get(u),s=Object(r.g)(d?Object(o.l)([e],t,d):[null],1)[0];if(s)return s}return null}(t,n))?"1":"no";return Object(c.a)({lockId:n,updateMessage:"Got "+u+" item from the cache for given folder and key"}),i}function f(e){for(var t=Object(a.a)(),n=Object(r.j)([],Object(r.g)(t.calendarFolderEvents.keys())),o=0;o<n.length;o++){var c=n[o],i=t.calendarFolderEvents.get(c),u=Object(r.g)(i?Object(r.j)([],Object(r.g)(i.events.values())).filter(e):[null],1)[0];if(u)return u}return null}},379:function(e,t,n){"use strict";var r=n(1336),o=n(76),a=n(485),c=n(426);function i(e){return!!e.EffectiveRights&&!!e.EffectiveRights.Modify&&!Object(o.J)(e.ParentFolderId.Id)&&!Object(a.c)(e)&&("Private"!==e.Sensitivity||(t=e.ParentFolderId.Id,n=Object(o.o)(t),Object(c.d)(n)));var t,n}var u=function(e){return J(e)&&i(e)&&!e.IsCancelled},d=function(e){var t;return(null===(t=null==e?void 0:e.ParentFolderId)||void 0===t?void 0:t.mailboxInfo)&&"GroupMailbox"==e.ParentFolderId.mailboxInfo.type};function s(e,t){if(!e)return!1;var n=!d(e),r=function(t){return t?n?t.filter((function(t){return!e.Organizer||t.Mailbox.EmailAddress!=e.Organizer.Mailbox.EmailAddress})):t:[]},o=r(e.RequiredAttendees).length,a=r(e.OptionalAttendees).length;return t?o+a>0:o+a+r(e.Resources).length>0}function l(e){var t=e.RequiredAttendees,n=e.OptionalAttendees;return t&&0!=t.length||n&&0!=n.length}function f(e){return!!e&&(e.IsDraft?s(e):e.IsMeeting||s(e))}var v=function(e){return!f(e)&&!e.IsOrganizer&&i(e)&&!e.IsCancelled},b=function(e){return!(!e.IsOrganizer||f(e)&&e.MeetingRequestWasSent||!i(e))},O=n(57),j=n(519);function I(e){var t=Object(o.o)(e.ParentFolderId.Id),n=Object(j.c)(e);return i(e)&&f(e)&&!!t&&!!n&&!([3,6,7].includes(t.CalendarFolderType)||n.IsMeetingPollEvent)}function m(e){return!!(e.IsOrganizer&&e.IsMeeting&&e.MeetingRequestWasSent&&i(e))}var p=function(e){return b(e)||u(e)||v(e)};function E(e){return!d(e)&&!e.IsOrganizer&&e.IsMeeting&&!e.IsCancelled&&i(e)}function y(e){return 0==Object(O.h)().SessionSettings.WebSessionType&&E(e)&&e.IsResponseRequested&&!e.IsAllDayEvent&&(!e.IsRecurring||R(e))}function h(e){return!e.IsOrganizer&&e.IsCancelled&&i(e)}function g(e){return!Object(r.a)(e.EntityNamesMap)&&e.IsOrganizer&&i(e)}function R(e){return e.IsRecurring&&"RecurringMaster"!==e.CalendarItemType&&"ThisAndFollowingInstancesMaster"!==e.CalendarItemType}function S(e){return"RecurringMaster"===e.CalendarItemType}function T(e){return"ThisAndFollowingInstancesMaster"===e.CalendarItemType}function C(e){return d(e)&&!e.IsCancelled&&!e.DoNotForwardMeeting}function P(e){if(e){var t=Object(o.o)(e.ParentFolderId.Id);if(t)return t.IsSharedWithMe||Object(c.e)(t)}return!1}var A=n(24);function F(e){return!!d(e)||(!P(e)||Object(A.i)("cal-mf-enableFTDFOnSharedCalendar"))}var N=function(e){var t=Object(o.o)(e.ParentFolderId.Id),n=t?t.CalendarFolderType:void 0;return(Object(a.c)(e)||i(e))&&(!n||1==n||3==n||5==n)};function M(e){var t;return!!(null===(t=e.EffectiveRights)||void 0===t?void 0:t.Read)}var x=n(203);function _(e){return e&&M(e)&&w(e.ItemId)}function w(e){return(null==e?void 0:e.Id)&&!Object(x.b)(e.Id)}var D=n(374);function L(e){return e.IsMeeting&&!Object(D.r)(e.ParentFolderId.mailboxInfo.userIdentity)}var k=n(714);function K(e,t){var n,r;return!(t&&t.length>0)||(e.Subject&&-1!=e.Subject.toLowerCase().indexOf(t.toLowerCase())||(null===(n=e.Location)||void 0===n?void 0:n.DisplayName)&&-1!=Object(k.d)(e.Location.DisplayName,e.Location.PostalAddress).toLowerCase().indexOf(t.toLowerCase())||(null===(r=e.Organizer)||void 0===r?void 0:r.Mailbox)&&-1!=e.Organizer.Mailbox.Name.toLowerCase().indexOf(t.toLowerCase()))}var U=function(e){if(!e)return!1;var t=e.ParentFolderId.mailboxInfo.mailboxSmtpAddress;return B(e.RequiredAttendees,t)||B(e.OptionalAttendees,t)};function B(e,t){return e&&e.some((function(e){return e.Mailbox.EmailAddress.toLowerCase()==t}))}var q=n(1290);function V(e){if(!e)return!1;var t=!1;return e.forEach((function(e){Object(q.a)(e.Mailbox)||(t=!0)})),t}function H(e){if(!e)return!1;var t=Object(o.o)(e.ParentFolderId.Id);return t&&3==t.CalendarFolderType}function z(e){return"Exception"===e}function W(e){return"Occurrence"===e}function G(e){return W(e.CalendarItemType)||z(e.CalendarItemType)}function J(e){return(null==e?void 0:e.IsMeeting)&&!e.IsOrganizer}function Z(e){return(null==e?void 0:e.IsMeeting)&&(null==e?void 0:e.IsOrganizer)}function Y(e){return Object(a.c)(e)&&f(e)}var Q=n(5);function $(e,t){return e&&t&&!Object(a.c)(e)&&Object(Q.Ib)(t.Start,e.Start)&&Object(Q.Ib)(t.End,e.End)&&t.IsAllDayEvent==e.IsAllDayEvent}function X(e){return"RecurringMaster"===e}function ee(e){return!(!e.IsMeeting||!e.IsOrganizer||!e.IsDraft&&e.MeetingRequestWasSent)}function te(e){return!(!e.ItemId||!e.IsDraft||function(e){return!!(e.ItemId&&e.IsDraft&&e.IsMeeting&&e.IsOrganizer)}(e))}n.d(t,"j",(function(){return I})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"q",(function(){return E})),n.d(t,"n",(function(){return y})),n.d(t,"o",(function(){return h})),n.d(t,"h",(function(){return g})),n.d(t,"L",(function(){return R})),n.d(t,"M",(function(){return S})),n.d(t,"B",(function(){return T})),n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return F})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return v})),n.d(t,"g",(function(){return b})),n.d(t,"i",(function(){return N})),n.d(t,"k",(function(){return i})),n.d(t,"l",(function(){return _})),n.d(t,"m",(function(){return w})),n.d(t,"p",(function(){return L})),n.d(t,"r",(function(){return K})),n.d(t,"s",(function(){return s})),n.d(t,"w",(function(){return l})),n.d(t,"t",(function(){return U})),n.d(t,"u",(function(){return V})),n.d(t,"v",(function(){return M})),n.d(t,"x",(function(){return H})),n.d(t,"y",(function(){return f})),n.d(t,"z",(function(){return G})),n.d(t,"A",(function(){return z})),n.d(t,"C",(function(){return J})),n.d(t,"D",(function(){return P})),n.d(t,"E",(function(){return Z})),n.d(t,"F",(function(){return Y})),n.d(t,"H",(function(){return W})),n.d(t,"I",(function(){return d})),n.d(t,"J",(function(){return $})),n.d(t,"K",(function(){return X})),n.d(t,"N",(function(){return ee})),n.d(t,"G",(function(){return te}))},417:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l}));var r=2,o=4,a=8,c=32,i=64,u=128,d=4294967296,s=8589934592,l=17179869184},442:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return f}));var r=n(1),o=n(14),a=n(268);function c(){return v.get()}function i(e,t){var n=u(e);return n&&n.itemResponseShapeType===t?n:null}function u(e){var t=c()[e];return t||null}function d(e,t,n){var o=Object(a.a)().fullItemsMruMap.get(e);if(o){var c=Object(r.g)(o.eventInfos.filter((function(e){return e.eventKey===t})),1)[0];if(c&&c.itemResponseShapeType===n)return c}return null}function s(e){var t=u(e);return t?t.loadState:null}function l(e){var t,n=null===(t=u(e))||void 0===t?void 0:t.itemResponseShapeType;return n||"Default"}function f(){return"Default"}var v=Object(o.computed)((function(){var e=Object(a.a)();return Object(r.j)([],Object(r.g)(e.fullItemsMruMap.keys())).reduce((function(t,n){return e.fullItemsMruMap.get(n).eventInfos.forEach((function(e){return t[e.eventKey]=e})),t}),{})}))},485:function(e,t,n){"use strict";function r(e){var t;if(null===(t=null==e?void 0:e.ItemId)||void 0===t?void 0:t.Id){var n=e.ClientSeriesId;return!!n&&(e.IsRecurring?n==e.InstanceKey:n==e.ItemId.Id)}return!0}var o=n(1),a=n(439),c=n(203);function i(e,t){var n=Object(c.a)();e.forEach((function(e){var r=Object(c.a)();d(e,n,r,t),e.IsRecurring=!0,e.InstanceKey=e.InstanceKey&&!t?e.InstanceKey:n}))}function u(e){var t=Object(c.a)();d(e,t,t,!1)}function d(e,t,n,r){e.ItemId=Object(o.a)(Object(o.a)({},Object(a.a)({Id:n})),{mailboxInfo:e.ParentFolderId.mailboxInfo}),e.ClientSeriesId&&!r||(e.ClientSeriesId=t),e.EffectiveRights={Read:!0,Modify:!0,Delete:!0,ViewPrivateItems:!0},e.IsOrganizer=!0}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u}))},486:function(e,t,n){"use strict";n.d(t,"z",(function(){return r})),n.d(t,"p",(function(){return o})),n.d(t,"B",(function(){return a})),n.d(t,"C",(function(){return c})),n.d(t,"A",(function(){return i})),n.d(t,"m",(function(){return u})),n.d(t,"y",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"q",(function(){return l})),n.d(t,"s",(function(){return f})),n.d(t,"e",(function(){return v})),n.d(t,"D",(function(){return b})),n.d(t,"u",(function(){return O})),n.d(t,"a",(function(){return j})),n.d(t,"w",(function(){return I})),n.d(t,"c",(function(){return m})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return E})),n.d(t,"E",(function(){return y})),n.d(t,"v",(function(){return h})),n.d(t,"b",(function(){return g})),n.d(t,"x",(function(){return R})),n.d(t,"d",(function(){return S})),n.d(t,"r",(function(){return T})),n.d(t,"t",(function(){return C})),n.d(t,"l",(function(){return P})),n.d(t,"i",(function(){return A})),n.d(t,"j",(function(){return F})),n.d(t,"k",(function(){return N})),n.d(t,"o",(function(){return M})),n.d(t,"n",(function(){return x}));var r="Sunday",o="Monday",a="Tuesday",c="Wednesday",i="Thursday",u="Friday",d="Saturday",s=[r,o,a,c,i,u,d],l=["January","February","March","April","May","June","July","August","September","October","November","December"],f="None",v="DailyRecurrence",b="WeeklyRecurrence",O="RelativeMonthlyRecurrence",j="AbsoluteMonthlyRecurrence",I="RelativeYearlyRecurrence",m="AbsoluteYearlyRecurrence",p=["None","First","Second","Third","Fourth","Last"],E="DailyRecurrence:#Exchange",y="WeeklyRecurrence:#Exchange",h="RelativeMonthlyRecurrence:#Exchange",g="AbsoluteMonthlyRecurrence:#Exchange",R="RelativeYearlyRecurrence:#Exchange",S="AbsoluteYearlyRecurrence:#Exchange",T="NoEndRecurrence:#Exchange",C="NumberedRecurrence:#Exchange",P="EndDateRecurrence:#Exchange",A=3,F=25,N=1,M=1,x=99},519:function(e,t,n){"use strict";var r=n(1),o=175,a="_____";function c(e){if(!e)return null;var t=e.indexOf(a);if(-1!=t&&(e=e.substring(0,t)),(e=e.trim()).length<o)return e;var n=e.substr(0,o).trim();return n.length>0?n.concat("..."):null}var i=n(209),u=n(79),d=n(24),s=n(10),l=n(5),f=n(1017),v=n(903),b=n(819),O=n(904),j=n(905),I=n(906),m=n(907);n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return g}));var p=Object(f.a)(),E=[[Object(l.oc)("2019-11-03T00:00:00.000-03:00"),Object(l.oc)("2020-02-15T23:59:59.999-03:00")],[Object(l.oc)("2020-11-08T00:00:00.000-03:00"),Object(l.oc)("2021-02-20T23:59:59.999-03:00")],[Object(l.oc)("2021-11-07T00:00:00.000-03:00"),Object(l.oc)("2022-02-20T23:59:59.999-03:00")]];function y(e,t){t=t||Object(i.d)();var n=[],o=!1,a=null,s=!1,f=null;if(null==e?void 0:e.ExtendedProperty){var b=e.ExtendedProperty.filter((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===v.a.PropertyName}))[0];if(null==b?void 0:b.Value)try{n=JSON.parse(b.Value)}catch(e){n=[]}e.ExtendedProperty.some((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===O.a.PropertyName&&!!e.Value}))&&(o=!0),(null==(b=e.ExtendedProperty.filter((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===j.a.PropertyName}))[0])?void 0:b.Value)&&(a=b.Value),(null==(b=e.ExtendedProperty.filter((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===m.a.PropertyName}))[0])?void 0:b.Value)&&(f=b.Value),(null==(b=e.ExtendedProperty.filter((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===I.a.PropertyName}))[0])?void 0:b.Value)&&(s="true"===b.Value.toLowerCase())}var y=Object(r.a)(Object(r.a)(Object(r.a)({},p),e),{ItemId:e.ItemId?Object(r.a)(Object(r.a)({},e.ItemId),{mailboxInfo:t}):e.ItemId,ParentFolderId:e.ParentFolderId?Object(r.a)(Object(r.a)({},e.ParentFolderId),{mailboxInfo:t}):e.ParentFolderId,Start:h(e.Start),End:h(e.End),StartTimeZoneId:Object(u.b)(e.StartTimeZoneId),EndTimeZoneId:Object(u.b)(e.EndTimeZoneId),LastModifiedTime:h(e.LastModifiedTime),FreeBusyType:e.FreeBusyType,ResponseType:e.ResponseType,AppointmentReplyTime:h(e.AppointmentReplyTime),ExperienceType:e.ExperienceType?e.ExperienceType:"Unspecified",SeriesMasterItemId:e.SeriesMasterItemId?Object(r.a)(Object(r.a)({},e.SeriesMasterItemId),{mailboxInfo:t}):null,Sensitivity:"GroupMailbox"==t.type&&"Private"==e.Sensitivity?"Normal":e.Sensitivity,Preview:c(e.Preview),AppendOnSend:n,IsBookedFreeBlocks:o,CollabSpace:a,TravelTimeEventsLinked:s,FlexEventsMetadata:f});if(!e.IsAllDayEvent&&e.SeriesId&&"Occurrence"==e.CalendarItemType&&"tzone://Microsoft/Custom"==e.StartTimeZoneId&&"E. South America Standard Time"==e.EndTimeZoneId&&!Object(d.i)("cal-killSwitch-63446")&&y.Start&&y.End&&E.some((function(e){var t=Object(r.g)(e,2),n=t[0],o=t[1];return Object(l.Ob)(y.Start,n,o)}))){var g=Object(l.x)(y.End,y.Start);y.Start=Object(l.f)(y.Start,1),y.End=Object(l.h)(y.Start,g),y.StartTimeZoneId=y.EndTimeZoneId,y.__BrazilHack__=1}return y}function h(e){if(e){if(Object(d.i)("cal-assumeTzOffsetFromCalendarItem")){var t=Object(s.a)().timezone,n=!!t;return Object(l.Tb)(t,e,n)}return Object(l.qb)(e)}}function g(e){var t=[];return e.AppendOnSend&&e.AppendOnSend.length>0&&t.push(Object(b.a)({ExtendedFieldURI:v.a,Value:JSON.stringify(e.AppendOnSend)})),e.FlexEventsMetadata&&t.push(Object(b.a)({ExtendedFieldURI:m.a,Value:e.FlexEventsMetadata})),e.IsBookedFreeBlocks&&t.push(Object(b.a)({ExtendedFieldURI:O.a,Value:e.IsBookedFreeBlocks.toString()})),e.CollabSpace&&t.push(Object(b.a)({ExtendedFieldURI:j.a,Value:e.CollabSpace})),e.TravelTimeEventsLinked&&t.push(Object(b.a)({ExtendedFieldURI:I.a,Value:e.TravelTimeEventsLinked.toString()})),Object(r.a)(Object(r.a)({__type:"CalendarItem:#Exchange"},e),{Start:e.Start&&Object(l.rb)(e.Start),End:e.End&&Object(l.rb)(e.End),LastModifiedTime:e.LastModifiedTime&&Object(l.rb)(e.LastModifiedTime),AppointmentReplyTime:e.AppointmentReplyTime&&Object(l.rb)(e.AppointmentReplyTime),FreeBusyType:e.FreeBusyType,CharmId:e.CharmId,IsDraft:e.IsDraft,IsRoomRequested:e.IsRoomRequested,SkypeTeamsProperties:e.SkypeTeamsProperties&&JSON.stringify(e.SkypeTeamsProperties),ExtendedProperty:t})}},543:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return s}));var r=n(1),o=n(200),a=n(829),c=n(23),i=n(288),u=n(101);function d(e,t,n,a){void 0===a&&(a=!1);var d=e.ParentFolderId.Id,s=!1,l=function(e,t,n){var o,a,c=null;if(n)c=Object(i.b)(t.ItemId.Id,e);else{o=Object(r.g)(Object(i.a)(e,(function(e){return e.InstanceKey==t.InstanceKey})),1),c=o[0]}if(!c){var u=t.ClientSeriesId;if(u){a=Object(r.g)(Object(i.a)(e,(function(e){return e.ClientSeriesId==u})),1),c=a[0]}}return c}(d,e,t);l?l.IsRecurring&&!t?a?Object(o.d)([l]):s=!0:(null==e.IsOnlineMeeting&&null!=l.IsOnlineMeeting&&(e.IsOnlineMeeting=l.IsOnlineMeeting),null==e.OnlineMeetingJoinUrl&&null!=l.OnlineMeetingJoinUrl&&(e.OnlineMeetingJoinUrl=l.OnlineMeetingJoinUrl),Object(o.d)([l])):c.g.info("[SharedCacheFunctions] addOrModifyItemInCache: Skipping removal of old item from cache as no old item was found"),!l&&n||(s||(Object(u.w)(d,[e],[{start:e.Start,end:e.End}]),Object(o.c)([e])),a?Object(u.u)(e):Object(u.t)(e))}function s(e,t){return void 0===t&&(t=!1),Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,Object(a.a)(e,t)];case 1:return n.sent(),[2]}}))}))}},663:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a}));var r=110,o=3,a=1},715:function(e,t,n){"use strict";var r=n(2),o=Object(r.action)("poll",(function(e,t,n){return{requestFunction:e,requestIdentifier:t,interval:n}})),a=Object(r.action)("cancelPoll",(function(e){return{requestIdentifier:e}})),c={currentRequest:new(n(14).ObservableMap)},i=Object(r.createStore)("requestIdStore",c);Object(r.mutator)(a,(function(e){var t=i().currentRequest.get(e.requestIdentifier);if(t){var n=t.timer;clearTimeout(n),t.timer=null}}));var u=n(1),d=Object(r.mutatorAction)("setCurrentRequestId",(function(e,t){var n=i().currentRequest.get(e);n?n.requestId=t:i().currentRequest.set(e,{requestId:t,timer:null})}));function s(e,t){return i().currentRequest.get(e).requestId===t}function l(e,t){return Object(u.c)(this,void 0,void 0,(function(){var n,r,o;return Object(u.f)(this,(function(a){switch(a.label){case 0:return n=Math.random(),d(t,n),[4,e()];case 1:return r=a.sent(),o={isCurrent:s(t,n)},[2,Object(u.a)({response:r},o)]}}))}))}var f=Object(r.mutatorAction)("setPollTimer",(function(e,t){var n=i().currentRequest.get(e);n&&(n.timer=t)}));Object(r.orchestrator)(o,(function(e){var t=e.requestFunction,n=e.requestIdentifier,r=e.interval;a(n);var c=setTimeout((function(){return function(e,t,n){return Object(u.c)(this,void 0,void 0,(function(){return Object(u.f)(this,(function(r){switch(r.label){case 0:return[4,l((function(){return e()}),t)];case 1:return r.sent(),o(e,t,n),[2]}}))}))}(t,n,r)}),r);f(n,c)})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}))},767:function(e,t,n){"use strict";var r=n(1),o=n(827),a=n(200),c=n(288),i=n(121),u=n(76),d=n(379),s=n(519),l=n(1014),f=n(1355),v=n(24),b=function(e){Object(v.i)("cal-notificationDiagnostics")&&setTimeout((function(){return Object(f.a)(e)}),0)},O=n(485),j=n(137),I=n(101),m=n(869),p=n(543),E=n(199),y=n(1028),h=n(715),g=864e5;n.d(t,"c",(function(){return M})),n.d(t,"e",(function(){return x})),n.d(t,"a",(function(){return K})),n.d(t,"d",(function(){return q})),n.d(t,"b",(function(){return V}));var R,S={RowAdded:"RowAdded",RowModified:"RowModified",RowDeleted:"RowDeleted",Reload:"Reload"},T=2e3,C={},P={},A=[],F=!0,N=!0;function M(e,t){if(N&&(Object(h.b)(y.a,"RELOAD_CALENDAR_SUBSCRIPTIONS",g),N=!1),C[e])return C[e].locks[t]=!0,void b({message:"Already subscribed to calendar item notifications for folder",folderId:e});var n=Object(u.o)(e);if(n){var o=Object(u.B)(n);if(o){var a=Object(v.i)("cal-surface-declinedMeetings");m.b.import().then((function(n){var c,i=Object(r.a)(Object(r.a)({},o),{ChannelId:n(),NotificationType:"CalendarItemNotification",IncludeDeclinedMeetings:a}),u={subscriptionId:""+i.NotificationType+e+(a?"declinedMeetings":""),requiresExplicitSubscribe:!0,subscriptionParameters:i},d={folderId:e,subscription:u,locks:(c={},c[t]=!0,c)};b({message:"Subscribing to calendar item notifications for folder with includeDeclinedMeetings = "+a,folderId:e}),m.h.importAndExecute(u,_),C[e]=d}))}}else b({message:"Calendar entry not found to subscribe to notifications for folder",folderId:e})}function x(e){var t=C[e];t?(b({message:"Unsubscribing from calendar item notifications for folder",folderId:e}),m.i.importAndExecute(t.subscription,_),delete C[e]):b({message:"Could not unsubscribe calendar item notifications for folder due to subscription data not found",folderId:e})}function _(e){L(e,!0),function(e){if(A.some((function(e){return k(e.NotificationPayload)})))b({message:"A reload notification is in the queue. No additional notifications will be added",notificationPayload:e.NotificationPayload});else if(k(e.NotificationPayload))b({message:"A reload notification will be enqueued. All existing notifications will be discarded.",notificationPayload:e.NotificationPayload}),(A=[])[0]=e;else{for(var t=A.length-1;t>=0;t--){var n=A[t].NotificationPayload.Item,r=void 0,o=void 0,a=void 0;if(null!=e.NotificationPayload.Item.InstanceKey?(o=e.NotificationPayload.Item.InstanceKey,r=n.InstanceKey,a="InstanceKey"):(o=e.NotificationPayload.Item.ItemId.Id,r=n.ItemId.Id,a="ItemId"),o===r){b({message:"Found an existing notification in the queue for the same "+a+". Old notification will be removed.",notificationPayload:e.NotificationPayload}),A[t].InstanceKeyToDelete&&(e.InstanceKeyToDelete=A[t].InstanceKeyToDelete),A.splice(t,1);break}}var c=!1;if(null!=e.NotificationPayload.Item.InstanceKey)if(e.NotificationPayload.EventType==S.RowModified&&Object(d.K)(e.NotificationPayload.Item.CalendarItemType)&&null!=e.NotificationPayload.Item.UID&&(P[e.NotificationPayload.Item.InstanceKey]=e.NotificationPayload.Item.UID),e.NotificationPayload.EventType===S.RowAdded||e.NotificationPayload.EventType===S.RowModified){for(t=A.length-1;t>=0;t--)if(A[t].NotificationPayload.EventType===S.RowDeleted&&A[t].OriginalUID==e.NotificationPayload.Item.UID){b({message:"Found an existing RowDeleted notification in the queue for the same UID, which will be removed from the queue.",notificationPayload:e.NotificationPayload}),e.InstanceKeyToDelete=A[t].NotificationPayload.Item.InstanceKey,A.splice(t,1);break}}else if(e.NotificationPayload.EventType===S.RowDeleted){var i=P[e.NotificationPayload.Item.InstanceKey];if(delete P[e.NotificationPayload.Item.InstanceKey],i){e.OriginalUID=i;for(t=A.length-1;t>=0;t--){var u=A[t].NotificationPayload.Item.UID;if((A[t].NotificationPayload.EventType===S.RowAdded||A[t].NotificationPayload.EventType===S.RowModified)&&u==i){b({message:"Found an existing RowAdded or RowModified notification in the queue for the same UID, which will be merged with the RowDelete.",notificationPayload:e.NotificationPayload}),A[t].InstanceKeyToDelete=e.NotificationPayload.Item.InstanceKey,c=!0;break}}}}c?b({message:"RowDeleted notification was merged with a RowAdded notification for the same UID and will not be enqueued",notificationPayload:e.NotificationPayload}):(b({message:"Notification will be enqueued",notificationPayload:e.NotificationPayload}),A.push(e))}b({message:"Notification queue length is "+A.length})}({NotificationPayload:e,InstanceKeyToDelete:null,OriginalUID:null}),F?(R&&(b({message:"Notification processing timer was already started. It will be cancelled and restarted."}),clearTimeout(R)),R=setTimeout(D,T),b({message:"Timer to drain queue has started"})):b({message:"The notification was received while notification processing was suspended"})}function w(e){var t,n;if(L(e.NotificationPayload,!1),k(e.NotificationPayload))K();else{var o=e.NotificationPayload.FolderId,a=null===(t=e.NotificationPayload.Item)||void 0===t?void 0:t.SkypeTeamsProperties;Object(v.i)("cal-showAddTeamsCalendars")&&a&&!Object(u.o)(o)&&(o=function(e,t){var n=JSON.parse(t);if(null==n?void 0:n.cid){var r=n.cid.split("@")[0];e=r?Object(u.O)(e,r):e}return e}(o,a),(null===(n=e.NotificationPayload.Item)||void 0===n?void 0:n.ParentFolderId)&&(e.NotificationPayload.Item.ParentFolderId.Id=o));var i=Object(E.h)(o),f=Object(E.d)(o),O=Object(E.e)(o),m=Object(u.o)(o),y=Object(u.x)(o);m&&3==m.CalendarFolderType?K(o):i&&(f.length>0||Object.keys(O).length>0)?e.NotificationPayload.EventType==S.RowDeleted?function(e,t){var n=t.Item.InstanceKey,r=Object(c.c)(n,e);r?(b({message:"Removing event from cache "+r,folderId:e,notificationPayload:t,notificationItem:r}),Object(I.q)(e,n)):b({message:"Could not find event with instance key "+n+" in the cache to remove",folderId:e,notificationPayload:t})}(o,e.NotificationPayload):Object(d.K)(e.NotificationPayload.Item.CalendarItemType)?function(e,t,n){var o=Object(s.a)(n.NotificationPayload.Item,t);if(o.UID){H(e).forEach((function(a){var c=Object(l.a)(o.ItemId,a);c.then((function(i){i&&"Success"==i.ResponseClass?function(e,t,n,o,a,c,i){if(b({message:"Action to expand series completed successfully. Retrieved "+(a?a.length:0)+" items for dates: "+n.start.toString()+" - "+n.end.toString()+" ",folderId:o,notificationItem:e}),H(o).some((function(e){return Object(j.b)(n,e)}))){b({message:"Updating all cached items for the series and removing nonexistant ones",folderId:o});var u=[];a&&u.push.apply(u,Object(r.j)([],Object(r.g)(a))),c&&u.push(c);var d=u.map((function(e){return e.UID}));B(n,e.ItemId.Id,e.InstanceKey,i,o,(function(e){return!(d.includes(e.UID)&&e.IsRecurring)})),Object(I.u)(c),Object(I.a)(o,a),a.forEach((function(e){Object(I.u)(e)}))}else b({message:"Range in the cache is different from what we originally requested - reloading cache",folderId:o}),Object(p.b)(o,!0)}(o,0,a,e,i.Occurrences.map((function(e){return Object(s.a)(e,t)})),Object(s.a)(i.RecurrenceMaster,t),n.InstanceKeyToDelete):U(o,c,a,e,n.InstanceKeyToDelete,i)})).catch((function(t){U(o,c,a,e,n.InstanceKeyToDelete,null,t.message)}))}))}}(o,y,e):function(e,t,n){var r=Object(s.a)(n.Item,t),o=!1;switch(n.EventType){case S.RowAdded:o=!0;break;case S.RowModified:o=null==r.InstanceKey||Object(d.H)(r.CalendarItemType)||Object(d.A)(r.CalendarItemType)}Object(p.a)(r,o,!1,!0)}(0,y,e.NotificationPayload):b({message:i?"Events cache was empty for folder":"Events cache has not been loaded for folder yet",folderId:e.NotificationPayload.FolderId,notificationPayload:e.NotificationPayload})}}function D(){var e=A.length;if(e>=8||A.some((function(e){return k(e.NotificationPayload)})))K();else for(var t=0;t<e;t++){w(A[t])}A=[],P={},clearTimeout(R)}function L(e,t){var n,r=(null===(n=e.Item)||void 0===n?void 0:n.ItemId)?e.Item.ItemId.Id:"<null>";if(b({message:(t?"Got calendar notification":"Processing calendar notification")+" for event type "+e.EventType,folderId:e.FolderId,notificationPayload:e}),t){var o=e.Item?e.Item.CalendarItemType:"<null>";Object(i.s)("IncomingNotification",{NotificationType:e.EventType,ItemType:o,ItemId:r},{excludeFromKusto:!0,isVerbose:!0})}}function k(e){return e.EventType==S.Reload||e.Reload}function K(e){var t,n,o=e?[e]:Object.keys(C);try{for(var a=Object(r.k)(o),c=a.next();!c.done;c=a.next()){var i=c.value;Object(p.b)(i,!0)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}function U(e,t,n,r,o,a,c){if(void 0===c&&(c=null),a&&"ErrorItemNotFound"==a.ResponseCode)b({message:"Action to expand recurring series failed with item not found because item is not on the server. Removing series.",folderId:r,notificationItem:e}),B(n,e.ItemId.Id,e.InstanceKey,o,r);else{var i=a?a.ResponseCode+": "+a.MessageText:c;b({message:"Action to expand recurring series failed for unknown reason, reloading cache",folderId:r,notificationItem:e,errorMessage:i}),Object(p.b)(r,!0)}}function B(e,t,n,r,o,i){var u=function(o){var a,c={start:o.Start,end:o.End},u=0==Object(j.j)(e,c,!0),d=o.InstanceKey==n||r&&o.InstanceKey==r||t&&t===(null===(a=o.SeriesMasterItemId)||void 0===a?void 0:a.Id);return u&&(Object(O.c)(o)||d&&(!i||i(o)))};Object(I.r)(o,u);var d=Object(c.a)(o,u);Object(a.d)(d)}function q(){F&&(clearTimeout(R),b({message:"Processing of notifications will be suspended"}),F=!1)}function V(){F||(F=!0,b({message:"Processing of notifications will be resumed"}),R=setTimeout(D,T))}function H(e){var t=Object(E.d)(e);return Object(o.a)(t)}},819:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){return Object(r.a)({__type:"ExtendedPropertyType:#Exchange"},e)}},820:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"h",(function(){return f}));var r=n(486);function o(e){return e?l(e)?r.e:f(e)?r.D:d(e)?r.u:i(e)?r.a:s(e)?r.w:u(e)?r.c:r.s:r.s}function a(e){return i(e)||d(e)}function c(e){return u(e)||s(e)}function i(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.b}function u(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.d}function d(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.v}function s(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.x}function l(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.f}function f(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.E}},827:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(137);function o(e){if(0===e.length)return[];var t=[];return e.forEach((function(e){return function(e,t){for(var n=!1,o=0;o<t.length&&!n;o++){var a=t[o];0===Object(r.j)(a,e,!0)&&(t[o]=Object(r.f)(a,e),n=!0)}n||t.push(e)}(e,t)})),t}},828:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(269),o=n(199),a=n(1023);function c(e,t,n){var c=Object(r.k)(n,e,Object(o.f)(t));return c?Object(a.a)(c):[]}},829:function(e,t,n){"use strict";var r=n(1),o=n(101),a=n(199),c=n(1022),i=n(1027),u=n(200),d=n(663),s=n(827);var l=n(1025);n.d(t,"a",(function(){return v}));var f=n(319);function v(e,t){var n,v;return void 0===t&&(t=!1),Object(r.c)(this,void 0,void 0,(function(){var b,O,j,I,m,p,E;return Object(r.f)(this,(function(y){switch(y.label){case 0:b=function(e){var t=Object(c.b)(e),n=null==t?void 0:t.filter((function(e){return null!==e})),o=Object(a.d)(e),i=Object(r.j)(Object(r.j)([],Object(r.g)(n)),Object(r.g)(o));return Object(s.a)(i)}(e),O=b.map((function(t){return Object(i.a)(t,e,function(e,t){return function(n,r){"Loading"!==r&&Object(a.c)(e,t).forEach((function(e){Object(u.j)(e,n,r)}))}}(e,t),d.c)})),j=[],I=0,y.label=1;case 1:return I<O.length?[4,Promise.all([null===(n=O[I])||void 0===n?void 0:n.fetchPromise,null===(v=O[I])||void 0===v?void 0:v.enhancedFetchPromise]).then((function(e){var t=e[0],n=e[1];if(t&&n)for(var o=function(e){var o=t[e].ItemId.Id,a=Object(r.g)(n.filter((function(e){return e.ItemId.Id===o})),1)[0];a&&f(t[e],a),j.push(t[e])},a=0;a<t.length;a++)o(a);else t&&j.push.apply(j,Object(r.j)([],Object(r.g)(t)))}))]:[3,4];case 2:y.sent(),y.label=3;case 3:return I++,[3,1];case 4:return j.length>0?(m=j.map((function(e){return Object(l.a)(e)})),[4,Promise.all(m).then((function(e){for(var t=0;t<e.length;t++){var n=e[t];n&&f(j[t],n)}}))]):[3,6];case 5:return y.sent(),p=j.reduce((function(e,t){return t&&e.push(t),e}),[]),h=function(e){return e.ItemId.Id},g={},R=[],p.forEach((function(e){var t=h(e);g.hasOwnProperty(t)||(R.push(e),g[t]=!0)})),E=R,Object(o.c)(e,E,b,t),[2,E];case 6:case 7:return[2,null]}var h,g,R}))}))}},860:function(e,t,n){"use strict";var r=n(199),o=n(908),a=n(2),c=n(101),i=n(200),u=n(767);Object(a.orchestrator)(i.a,(function(e){var t=e.previousEvents,n=e.reloadedEvents;n&&(t&&Object(i.d)(t),Object(i.c)(n))})),Object(a.orchestrator)(c.q,(function(e){var t=e.folderId,n=e.instanceKey,r=null;Object(c.k)(t,n,(function(e){r=e})),r&&(r.forEach((function(e){return Object(c.s)(t,e.Key)})),Object(i.d)(r))})),Object(a.orchestrator)(c.b,(function(e){var t=e.lockId,n=e.folderId,r=e.dateRange,o=e.calendarEvents;Object(c.i)(t,n,r,o),o&&Object(i.c)(o)})),Object(a.orchestrator)(c.a,(function(e){var t=e.folderId,n=e.calendarEvents,a=Object(r.d)(t),u=Object(o.a)(n,a).eventsOverlapping;u.length>0&&(Object(c.w)(t,u,a),Object(i.c)(u))})),Object(a.orchestrator)(c.c,(function(e){var t=e.folderId,n=e.eventsReloaded,a=e.dateRanges,u=e.forceReplace,d=Object(r.a)(t),s=Object(o.a)(d,a).eventsOverlapping;Object(c.w)(t,n,a,u),Object(i.a)(s,n)})),Object(a.orchestrator)(i.f,(function(e){var t=e.folderId;Object(u.e)(t),Object(c.p)(t),Object(c.j)(t)}));var d=n(1),s=n(5),l=n(1346),f=n(137),v=n(820),b=n(827),O=n(319);function j(e,t){var n=function(e){return Object(v.d)(e)?I:Object(v.h)(e)?m:Object(v.e)(e)?p:(Object(v.i)(e),null)}(e.Recurrence);if(!n)return[Object(d.a)({},e)];var r=Object(b.a)(t),o=[],a=e.Recurrence.RecurrencePattern.Interval;r.forEach((function(t){var r=function(e,t){var n=Object(s.Yb)(e.Start),r=Object(l.a)(n.tz,e.Recurrence),o={start:n,end:r};return function(e,t){e.start=Object(s.p)(e.start,t.start)>0?e.start:t.start,e.end=null!=e.end&&Object(s.p)(e.end,t.end)<0?e.end:t.end}(o,t),o}(e,t),c=n(e,r,a);o.push.apply(o,Object(d.j)([],Object(d.g)(c)))}));var c=Object(s.x)(e.Start,Object(s.Yb)(e.Start)),i=Object(s.x)(e.End,Object(s.Yb)(e.Start));return function(e,t,n,r){var o=[];return r.forEach((function(r){var a={};O(a,e),a.Start=Object(s.h)(r,t),a.End=Object(s.h)(r,n),a.CalendarItemType="Occurrence",o.push(a)})),o}(e,c,i,o)}function I(e,t,n){for(var r=[],o=Object(s.s)(t.end,t.start),a=0;a<=o;a+=n){var c=Object(s.e)(t.start,a);r.push(c)}return r}function m(e,t,n){for(var r=[],o=e.Recurrence.RecurrencePattern,a=o.DaysOfWeek.split(" ").map((function(e){return E(e)})),c=Math.max(E(o.FirstDayOfWeek),0),i=t.start;Object(s.p)(i,t.end)<=0;){for(var u=i,d=Object(s.C)(u,c);Object(s.p)(u,d)<=0;)a.includes(Object(s.ob)(u))&&Object(f.t)(t,u)&&r.push(u),u=Object(s.e)(u,1);i=Object(s.cc)(Object(s.e)(i,7*n),c)}return r}function p(e,t,n){var r=[];if(Object(v.b)(e.Recurrence))for(var o=(u=e.Recurrence.RecurrencePattern).DayOfMonth,a=t.start;Object(s.p)(a,t.end)<=0;){for(var c=a,i=Object(s.B)(c);Object(s.p)(c,i)<=0;)Object(s.mb)(c)==o&&Object(f.t)(t,c)&&r.push(c),c=Object(s.e)(c,1);a=Object(s.bc)(Object(s.i)(a,n))}else{var u,d=E((u=e.Recurrence.RecurrencePattern).DaysOfWeek),l=-1;switch(u.DayOfWeekIndex){case"First":l=1;break;case"Second":l=2;break;case"Third":l=3;break;case"Fourth":l=4}for(a=t.start;Object(s.p)(a,t.end)<=0;){var b=void 0;b=l>0?y(d,l,a):h(d,a),Object(f.t)(t,b)&&r.push(b),a=Object(s.bc)(Object(s.i)(a,n))}}return r}function E(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].indexOf(e)}function y(e,t,n){var r=Object(s.bc)(n),o=(e-Object(s.ob)(r)+7)%7+7*(t-1);return Object(s.e)(r,o)}function h(e,t){var n=y(e,5,t);return Object(s.yb)(n)==Object(s.yb)(t)?n:y(e,4,t)}var g=n(543),R=n(485);function S(e,t){if(t){var n=e.ParentFolderId.Id;e.Recurrence&&Object(c.r)(n,(function(t){return t.InstanceKey==e.InstanceKey})),Object(c.r)(n,(function(t){return t.ItemId.Id===e.ItemId.Id}))}}Object(a.orchestrator)(i.g,(function(e){return Object(d.c)(void 0,void 0,void 0,(function(){var t,n,o,a,u,s,l,f,v,b,O,I;return Object(d.f)(this,(function(m){switch(m.label){case 0:t=e.eventToCreate,n=e.actionToExecute,o=e.actionSource,a=e.onEventCreatedFailed,u=e.onEventCreatedSuccess,s=e.errorMessage,l=e.onEventCreatedLocally,p=t,f=Object(r.h)(p.ParentFolderId.Id),function(e,t,n,o){if(t){var a=e.ParentFolderId.Id;if(e.Recurrence){var i=Object(r.d)(a),u=j(e,i);Object(R.a)(u,!1);var s=u.map((function(e){return Object(d.a)(Object(d.a)({},e),{CalendarItemType:"Occurrence"})}));Object(c.a)(a,s)}Object(R.b)(e);var l=e.Recurrence?Object(d.a)(Object(d.a)({},e),{CalendarItemType:"RecurringMaster"}):e;Object(c.a)(a,[l])}n(o)}(t,f,l,o),v=function(){return Object(i.g)(t,n,(function(){return a(s,null,o)}),u,o,s)},b=null,m.label=1;case 1:return m.trys.push([1,3,,4]),[4,n(t)];case 2:return b=m.sent(),[3,4];case 3:throw O=m.sent(),S(t,f),a(O,v,o),O;case 4:if(I=null,!b.isSuccessful)throw S(t,f),a(s,v,o),s;return I=b.createdItem,function(e,t,n){t.ParentFolderId||(t.ParentFolderId=Object(d.a)({},e.ParentFolderId));if(n){var r=t.ParentFolderId.Id;Object(c.r)(r,(function(t){return t.ItemId.Id===e.ItemId.Id})),Object(g.a)(t,!0,!1)}}(t,I,f),u(I),[2]}var p}))}))}));var T=n(319);function C(e,t){var n={Key:e,Start:t.Start,End:t.End};return T(t,n),t}var P=n(442),A=n(288),F=n(268);var N=n(379),M=n(663),x=n(269),_=n(1282);function w(e,t){return void 0===t&&(t=!1),t?D(e):Object(_.c)(e)}function D(e){var t;return null===(t=e.SeriesMasterItemId)||void 0===t?void 0:t.Id}var L=n(319);function k(e){if(e){var t=Object(F.a)();t.calendarFolderEvents.get(e)||t.calendarFolderEvents.set(e,Object(x.f)())}}Object(a.mutator)(c.n,(function(e){var t=e.lockId,n=Object(F.a)();Object(d.j)([],Object(d.g)(n.calendarFolderEvents.keys())).forEach((function(e){n.calendarFolderEvents.get(e).locksInfo.get(t)&&Object(x.n)(t,n.calendarFolderEvents.get(e))})),n.fullItemsMruMap.delete(t)})),Object(a.mutator)(c.f,(function(e){var t=e.folderId,n=e.eventKey,r=e.event,o=Object(A.d)(n,t);o&&Object(x.q)(o,r,!0)})),Object(a.mutator)(c.t,(function(e){!function(e){var t;if(r=e,o=r,o.Key&&void 0!==o.Start&&void 0!==o.End){e.Key;var n=Object(d.h)(e,["Key"]);e=n}var r,o;var a=w(e),c=null===(t=e.ParentFolderId)||void 0===t?void 0:t.Id;if(c){var i=Object(A.d)(a,c);i&&Object(x.q)(i,e)}}(e.partialCalendarEvent)})),Object(a.mutator)(c.m,(function(e){e.events.forEach((function(e){var t=Object(A.b)(e.ItemId.Id);t&&(Object(N.w)(t)&&(delete e.RequiredAttendees,delete e.OptionalAttendees),Object(x.q)(t,e))}))})),Object(a.mutator)(c.i,(function(e){var t=e.lockId,n=e.folderId,o=e.dateRange,a=e.calendarEvents;k(n);var c=Object(r.f)(n),i=Object(P.a)(),u=a.filter((function(e){return!Object(N.K)(e.CalendarItemType)})).map((function(e){return C(e.ItemId.Id,e)})).filter((function(e){return!i[e.Key]}));Object(x.b)(o,u,t,c);var d=c.locksInfo.get(t).lockedDateRange;if(Object(s.s)(d.end,d.start)>M.a){var l=function(e,t,n){var r=Object(s.s)(t.end,t.start);if(r===n)return t;if(r>n)return{start:t.start,end:Object(s.e)(t.start,n)};var o=n-r,a=Math.abs(Object(s.s)(t.end,e.end)),c=Math.abs(Object(s.s)(e.start,t.start)),i=t.start,u=t.end;if(a>0){var d=Math.min(o,a);u=Object(s.e)(u,d),o-=d}if(o>0&&c>0){var l=Math.min(o,c);i=Object(s.e)(i,-1*l)}return{start:i,end:u}}(d,o,M.a);Object(x.h)(l,t,c)}})),Object(a.mutator)(c.k,(function(e){var t=e.folderId,n=e.instanceKey,o=e.onEventsRemoved;k(t);var a=Object(r.f)(t);o(Object(x.o)((function(e){return e.InstanceKey===n}),a))})),Object(a.mutator)(c.l,(function(e){var t=e.folderId,n=e.predicate,o=e.onEventsRemoved;k(t);var a=Object(r.f)(t);o(Object(x.o)(n,a))})),Object(a.mutator)(c.j,(function(e){var t=e.folderId;Object(F.a)().calendarFolderEvents.delete(t)})),Object(a.mutator)(c.w,(function(e){var t=e.folderId,n=e.calendarEvents,o=e.dateRanges,a=e.forceReplace;k(t);var c=n.map((function(e){return C(e.ItemId.Id,e)})),i=Object(r.f)(t);a?Object(x.p)(c,i,o):Object(x.r)(c,i.events)})),Object(a.mutator)(c.v,(function(e){L(e.existingItem,e.updatedItem)}));var K=n(1026),U=new Map;var B=5;function q(e,t,n,r){H(t,n);var o=e.eventKey,a=n.get(t),c=a.eventInfos,i=Object(d.g)(c.filter((function(e){return e.eventKey===o})),1)[0];i?z(a.eventInfos.indexOf(i),e,a):(c.push(e),function(e,t){!function(e,t,n){for(;e.eventInfos.length>t&&0<e.eventInfos.length;)W(0,e,n)}(e,e.maxSize||B,t)}(a,r));Object(d.j)([],Object(d.g)(n.keys())).forEach((function(t){n.get(t).eventInfos.forEach((function(t){e.eventKey===t.eventKey&&(t.itemResponseShapeType=e.itemResponseShapeType)}))}))}function V(e,t,n,r){void 0===r&&(r=function(){}),H(t,n);var o=n.get(t),a=Object(d.g)(o.eventInfos.filter((function(t){return t.eventKey===e})),1)[0],c=o.eventInfos.indexOf(a);return-1!==c&&W(c,o,r),-1!==c}function H(e,t){if(!t.get(e)){var n=function(e){return U.get(e)}(e);t.set(e,{eventInfos:[],maxSize:n})}}function z(e,t,n){if(-1===e)throw new Error("Item with eventKey "+t.eventKey+" does not exist in the MRU");n.eventInfos.splice(e,1),n.eventInfos.push(t)}function W(e,t,n){if(e<0||e>=t.eventInfos.length)throw new Error("Invalid index to remove "+e);var r=t.eventInfos[e];t.eventInfos.splice(e,1),n(r.eventKey)}function G(e){if(e){var t=Object(F.a)();t.calendarFolderEvents.get(e)||t.calendarFolderEvents.set(e,Object(x.f)())}}function J(e,t){return function(n){Object(x.i)([n],e,Object(F.a)().calendarFolderEvents.get(t))}}Object(a.mutator)(c.d,(function(e){var t=e.eventKey,n=e.folderId,r=e.lockId,o=e.partialCalendarEvent,a=e.itemResponseShapeType;G(n);var c=Object(F.a)();if(o){var i=C(t,o);Object(x.a)(i,r,c.calendarFolderEvents.get(n))}q({eventKey:t,itemResponseShapeType:a,folderId:n,loadState:0},r,c.fullItemsMruMap,J(r,n))})),Object(a.mutator)(c.e,(function(e){var t=e.eventKey,n=e.folderId,r=e.lockId,o=e.itemResponseShapeType;G(n),q({eventKey:t,itemResponseShapeType:o,folderId:n,loadState:2},r,Object(F.a)().fullItemsMruMap,J(r,n))})),Object(a.mutator)(c.g,(function(e){var t=e.lockId,n=e.eventKey,r=e.folderId,o=e.event,a=e.hasEventChanged,c=e.itemResponseShapeType,i=e.forceOverrideAllPropertiesForEventIfAvailable;G(r);var u=Object(F.a)(),d=C(n,o);Object(x.a)(d,t,u.calendarFolderEvents.get(r),a,i),q({eventKey:n,itemResponseShapeType:c,folderId:r,loadState:1},t,u.fullItemsMruMap,J(t,r))})),Object(a.mutator)(c.s,(function(e){var t=e.folderId,n=e.eventKey,r=Object(F.a)();r.calendarFolderEvents.get(t)&&Object(d.j)([],Object(d.g)(r.fullItemsMruMap.keys())).forEach((function(e){V(n,e,r.fullItemsMruMap)}))})),Object(a.mutator)(c.p,(function(e){var t=e.folderId,n=Object(F.a)(),r=n.calendarFolderEvents.get(t);if(r){var o=Object(d.j)([],Object(d.g)(r.locksInfo.entries())).reduce(Object(x.d)(),{}),a=Object.keys(o);Object(d.j)([],Object(d.g)(n.fullItemsMruMap.keys())).forEach((function(e){a.forEach((function(t){return V(t,e,n.fullItemsMruMap)}))}))}})),Object(a.mutator)(K.a,(function(){var e=Object(F.a)();Object(d.j)([],Object(d.g)(e.fullItemsMruMap.keys())).forEach((function(t){!function(e,t){H(e,t),t.get(e).eventInfos=[]}(t,e.fullItemsMruMap)}))})),Object(a.mutator)(c.h,(function(e){var t=Object(F.a)(),n=e.lockId;!function(e,t,n){H(t,n);var r=n.get(t),o=r.eventInfos,a=Object(d.g)(o.filter((function(t){return t.eventKey===e})),1)[0];a&&z(r.eventInfos.indexOf(a),a,r)}(e.eventKey,n,t.fullItemsMruMap)}));var Z=n(439),Y=n(769);function Q(e,t){var n;if(3==t){var r=Object(A.b)(e);n=(null==r?void 0:r.SeriesMasterItemId)?Object(Z.a)({Id:r.SeriesMasterItemId.Id}):n=Object(Y.a)({OccurrenceId:e})}else n=Object(Z.a)({Id:e});return n}function $(e,t,n){n&&(Object(c.w)(t,e,null,!1),Object(i.c)(e))}Object(a.orchestrator)(i.h,(function(e){return Object(d.c)(void 0,void 0,void 0,(function(){var t,n,o,a,u,l,f,v,b,O,j,I,m,p,E,y;return Object(d.f)(this,(function(d){switch(d.label){case 0:t=e.eventId,n=e.eventScope,o=e.dataPoint,a=e.actionToExecute,u=e.onEventDeleteSuccess,l=e.onEventDeleteFailed,f=e.responseSent,v=e.actionSource,b=e.errorMessage,O=e.asyncUndoAction,j=Object(A.b)(t.Id),I=(h=j)&&Object(r.h)(h.ParentFolderId.Id),m=function(e,t,n){var r=[];if(n){var o=e.ParentFolderId.Id;if(3==t||2==t){var a=e.Start;r=Object(c.r)(o,(function(n){return n.InstanceKey==e.InstanceKey&&(3==t||2==t&&!Object(s.Hb)(n.Start,a))}))}else r=Object(c.r)(o,(function(t){return t.ItemId.Id===e.ItemId.Id}))}return r}(j,n,I),o&&o.markUserPerceivedTime(),p=Q(t.Id,n),null,d.label=1;case 1:return d.trys.push([1,4,,5]),[4,O(j,f,v)];case 2:return d.sent()?($(m,j.ParentFolderId.Id,I),[2]):[4,a(p)];case 3:if(!d.sent().isSuccessful)throw new Error(b);return[3,5];case 4:throw E=d.sent(),$(m,j.ParentFolderId.Id,I),y=function(){return Object(i.h)(t,n,null,a,u,(function(){return l(E,null,v)}),v,b,f)},l(E,y,v),E;case 5:return u(),[2]}var h}))}))}));var X=n(1025),ee=(Object(a.orchestrator)(c.u,(function(e){return Object(d.c)(void 0,void 0,void 0,(function(){var t,n,r,o,a;return Object(d.f)(this,(function(i){switch(i.label){case 0:return t=e.partialCalendarEvent,[4,Object(X.a)(t)];case 1:return(n=i.sent())&&(r=w(t),o=t.ParentFolderId.Id,a=Object(P.b)(t.ItemId.Id),Object(c.f)(o,r,a,n)),[2]}}))}))})),n(374));Object(a.orchestrator)(i.i,(function(e){return Object(d.c)(void 0,void 0,void 0,(function(){var t,n,o,a,u,l,f,v,b,O,I,m,p,E,y,h;return Object(d.f)(this,(function(S){switch(S.label){case 0:t=e.eventId,n=e.eventChanges,o=e.errorMessage,a=e.actionToExecute,u=e.onEventUpdateFailed,l=e.onEventUpdateSuccess,f=e.onEventUpdatedLocally,v=e.actionSource,b=e.eventScope,O=Object(A.b)(t.Id),I=Q(t.Id,e.eventScope),O&&Object(N.K)(O.CalendarItemType)&&(b=3),(m=function(e,t){if(!e)return!1;var n=e.ParentFolderId.Id;if(!Object(r.h)(n))return!1;var o=t.ParentFolderId;if(o&&o.Id!=n)return!1;return!0}(O,n))&&function(e,t,n,o,a){var u,l,f=e.ParentFolderId.Id;!Object(N.H)(e.CalendarItemType)||0!=n&&1!=n||(t.CalendarItemType="Exception");var v=Object(d.a)(Object(d.a)({},e),t);if(3==n||2==n)if(t.Recurrence||t.Start||t.StartTimeZoneId||t.End||t.EndTimeZoneId||2==n){var b=e.Start;if(Object(c.r)(f,(function(t){return(Object(N.H)(t.CalendarItemType)||Object(N.A)(t.CalendarItemType))&&t.InstanceKey==e.InstanceKey&&(3==n||2==n&&!Object(s.Hb)(t.Start,b))})),3===n||2===n){var O=Object(r.d)(f);2===n&&(O=O.map((function(e){return{start:Object(s.Sb)(e.start.tz,e.start),end:Object(s.Sb)(e.end.tz,e.end)}})),T=O,C=e.Start,P=[],T.forEach((function(e,t){Object(s.p)(e.start,C)<=0&&Object(s.p)(e.end,C)<=0&&P.push(t),Object(s.p)(e.start,C)<=0&&Object(s.p)(e.end,C)>0&&(e.start=Object(s.Yb)(C))})),P.reverse().forEach((function(e){T.splice(e,1)})));var I=v;"Occurrence"!=v.CalendarItemType||v.Recurrence||(I=Object(A.b)(v.SeriesMasterItemId.Id))||(I=v);var m=j(I,O);Object(R.a)(m.concat(v),!0),delete t.Start,delete t.End;var p=m.map((function(e){return Object(d.a)(Object(d.a)(Object(d.a)({},e),t),{CalendarItemType:"Occurrence"})}));Object(c.a)(v.ParentFolderId.Id,p)}}else{var E=Object(A.a)(f,(function(t){return t.InstanceKey==e.InstanceKey&&Object(N.H)(t.CalendarItemType)}));try{for(var y=Object(d.k)(E),h=y.next();!h.done;h=y.next()){var S=h.value;Object(c.v)(S,t),Object(i.b)(S)}}catch(e){u={error:e}}finally{try{h&&!h.done&&(l=y.return)&&l.call(y)}finally{if(u)throw u.error}}}var T,C,P;if(!Object(N.A)(e.CalendarItemType)||3!=n){var F=null==e.InstanceKey||Object(N.H)(e.CalendarItemType)||Object(N.A)(e.CalendarItemType);Object(g.a)(v,F,!0)}o(v,a)}(O,n,b,f,v),p=function(){return Object(i.i)(t,n,b,a,l,(function(){return u(o,null,v)}),v,o)},E=null,S.label=1;case 1:return S.trys.push([1,3,,4]),[4,a(I)];case 2:return E=S.sent(),[3,4];case 3:throw y=S.sent(),m&&Object(g.b)(O.ParentFolderId.Id),u(y,p,v),y;case 4:if(!E.isSuccessful)throw m&&Object(g.b)(O.ParentFolderId.Id),u(o,p,v),o;return(null===(h=n.ParentFolderId)||void 0===h?void 0:h.mailboxInfo)&&Object(ee.r)(n.ParentFolderId.mailboxInfo.userIdentity)&&(Object(g.b)(n.ParentFolderId.Id,!0),Object(g.b)(O.ParentFolderId.Id,!0)),l(),[2]}}))}))}));var te=n(79),ne=n(1028),re=(Object(a.orchestrator)(te.l,ne.a),n(31)),oe=n(76);function ae(e){var t=Object(oe.o)(e);return t?t.CharmId:null}function ce(e){return(null==e?void 0:e.CharmId)||ae(e.ParentFolderId.Id)}var ie=n(715),ue=n(829),de=n(426);function se(){Object(r.b)().map((function(e){Object(de.g)(Object(oe.o)(e))&&Object(ue.a)(e,!0)}))}var le=3e5;function fe(e){e?Object(ie.b)(se,"RELOAD_LINKEDCALENDAR_ENTRIES",le):Object(ie.a)("RELOAD_LINKEDCALENDAR_ENTRIES")}function ve(e,t,n){return{FreeBusyType:"Decline"===n?"Free":"Free"===e&&"Decline"!==t?"Free":"Accept"===n?"Busy":"Tentative",AppointmentReplyTime:Object(s.Rb)(),ResponseType:n}}var be=n(1014),Oe=n(1338),je=n(1022),Ie=n(94),me=n(1020),pe=n(121),Ee=n(23),ye=n(1021),he=n(1326),ge=n(14),Re={};function Se(e,t){return e+t}function Te(e,t){var n=Se(e,t);return Re[n]||Promise.resolve({calendarEvent:null,error:"Could not find full event promise in existing promises"})}function Ce(e,t,n,r,o,a){var c,i,u;void 0===n&&(n=null),void 0===o&&(o={fetchSource:"unknown"});var s=Ae(n,r);a||(a=Object(P.b)(t.Id));var l,f=Object(P.e)(t.Id,a);if(f)l=function(e,t,n,r,o,a){var c=o(t);switch(n.loadState){case 1:return{event:c,fullEventPromise:Promise.resolve({calendarEvent:c,error:null}),promiseSource:2};case 0:return{event:c,fullEventPromise:Te(t.Id,a),promiseSource:0};case 2:var i=Ne(c,t,r,e,a);return Object(d.a)({event:c},i);default:return Object(Ie.a)(n.loadState)}}(n=n||f.folderId,t,f,!1,s,a);else{var v=s(t),b=Ne(v,t,!1,n||(null===(c=null==v?void 0:v.ParentFolderId)||void 0===c?void 0:c.Id)||null,a);l=Object(d.a)({event:v},b)}var O=null;return l&&(n=n||(null===(u=null===(i=l.event)||void 0===i?void 0:i.ParentFolderId)||void 0===u?void 0:u.Id)||null,O={event:l.event,fullEventPromise:Me(l.fullEventPromise,l.promiseSource,l.event,e,n,o,t.Id,!1,a)}),O}function Pe(e,t,n,r,o,a){var c,i,u;void 0===n&&(n=null),void 0===o&&(o={fetchSource:"unknown"});var d,s=Ae(n,r)(t);n=n||(null===(c=null==s?void 0:s.ParentFolderId)||void 0===c?void 0:c.Id);var l=s&&D(s);a||(a=l?Object(P.b)(l):Object(P.c)());var f=null;return(d=function(e,t,n,r,o){var a=r&&Object(P.e)(r,n);if(a&&1===a.loadState){var c=Object(A.d)(r,e);return{event:c,fullEventPromise:Promise.resolve({calendarEvent:c,error:null}),promiseSource:2}}return a&&0===a.loadState?{event:Object(A.d)(r,e)||Fe(o),fullEventPromise:Te(r,n),promiseSource:0}:{event:Fe(o),fullEventPromise:xe(t,!0,e,n),promiseSource:0}}(n,t,a,l,s))&&(n=n||(null===(u=null===(i=d.event)||void 0===i?void 0:i.ParentFolderId)||void 0===u?void 0:u.Id)||null,f={event:d.event,fullEventPromise:Me(d.fullEventPromise,d.promiseSource,d.event,e,n,o,l,!0,a)}),f}function Ae(e,t){return function(n){return Object(A.b)(n.Id,e)||(null==t?void 0:t(n))}}function Fe(e){return e&&Object(d.a)(Object(d.a)({},Object(he.a)(Object(ge.toJS)(e))),{ItemId:Object(d.a)({},null==e?void 0:e.SeriesMasterItemId),CalendarItemType:"RecurringMaster"})}function Ne(e,t,n,r,o){return e&&e.EffectiveRights&&!Object(N.v)(e)?{fullEventPromise:Promise.resolve({calendarEvent:e,error:null}),promiseSource:1}:{fullEventPromise:xe(t,n,r,o),promiseSource:0}}function Me(e,t,n,r,o,a,u,s,l){return Object(d.c)(this,void 0,void 0,(function(){var f,v,b,O,j,I,m,p,E,y,h;return Object(d.f)(this,(function(g){switch(g.label){case 0:f=Object(P.d)(r,u,l),v=null,b=null,O=null,g.label=1;case 1:return g.trys.push([1,5,6,7]),Ee.g.info("[fetchFullCalendarEvent] Handling loading full calendar event Key: "+u+", Lock: "+r),!o||f&&1===f.loadState||u&&(Ee.g.info("[fetchFullCalendarEvent] Loading full calendar event Key: "+u+", Lock: "+r),function(e,t,n){var r=Se(e,t);Re[r]=n}(u,l,e),Object(c.d)(r,o,u,l,n)),2!=t?[3,2]:(v=n,[3,4]);case 2:return[4,e];case 3:j=g.sent(),v=null==j?void 0:j.calendarEvent,b=null==j?void 0:j.error,O=null==j?void 0:j.responseCode,void 0===u&&(u=w(j.calendarEvent)),g.label=4;case 4:if(!v)throw I=new Error("[fetchFullCalendarEvent] Action source:"+a.fetchSource+" with response code: "+(null!=O?O:"<null>")+" and error: "+b),O&&(I.responseCode=O,I.fetchErrorType="ServerFailure"),I.diagnosticInfo=JSON.stringify({responseCode:O,eventKey:u}),I;return m=o||v.ParentFolderId.Id,h=f,f=Object(P.d)(r,u,l),!m||f&&1===f.loadState?(Ee.g.info('[fetchFullCalendarEvent] Full calendar event already loaded. EventKey: "'+u+'", Lock: "'+r+'", FolderId: "'+m+'"'),Object(c.h)(r,u)):(Ee.g.info('[fetchFullCalendarEvent] Loaded full calendar event Key: "'+u+'", Lock: "'+r+'", FolderId: "'+m+'"'),Object(pe.s)("FullCalendarEventLoaded",Object(d.a)({eventKey:u,lockId:r,prevFullItemLoadState:h?h.loadState:null,fullItemLoadState:f?f.loadState:null,isFullItem:void 0!==v.RequiredAttendees,isSameAsExistingEvent:n===v,eventScope:s?3:0,errorMessage:null},a)),p=0===t,Object(c.g)(r,m,u,l,v,s,p)),(E=Object(A.d)(u,o))&&Object(i.b)(E),[2,E];case 5:throw y=g.sent(),h=f,f=Object(P.d)(r,u,l),Object(pe.s)("FullCalendarEventLoaded",Object(d.a)({eventKey:u,lockId:r,prevFullItemLoadState:h?h.loadState:null,fullItemLoadState:f?f.loadState:null,isFullItem:!1,isSameAsExistingEvent:!1,eventScope:s?3:0,errorMessage:y.toString()},a)),o&&("ErrorItemNotFound"===y.responseCode?Object(c.r)(o,(function(e){return w(e)===u})):Object(c.e)(r,o,u,l)),y;case 6:return function(e,t){var n=Se(e,t);delete Re[n]}(u,l),[7];case 7:return[2]}}))}))}function xe(e,t,n,r){return function(e,t,n,r,o){return Object(d.c)(this,void 0,void 0,(function(){var a,c,i;return Object(d.f)(this,(function(u){switch(u.label){case 0:a=0,u.label=1;case 1:if(!(a<e))return[3,6];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,Object(me.a)(t,r,Object(ye.a)(o),n)];case 3:return c=u.sent(),a++,!c.error||a>=e?[2,c]:[3,5];case 4:if(i=u.sent(),Ee.g.warn('[fetchFullCalendarEvent] Received error when trying to load calendar event from server for "'+t.Id+'" with try '+a+": Error "+i.toString()),++a>=e||"ErrorItemNotFound"===i.responseCode)throw i;return[3,5];case 5:return[3,1];case 6:return[2,{calendarEvent:null,error:"Error: Unable to fetch event"}]}}))}))}(M.b,e,t,n,r)}function _e(e){var t=this;if(!e)throw new Error("The lock id should be provided");return{fetchCalendarEventsForDateRange:function(t,n){var r=Object(je.a)(e,t,n);return{fetchPromise:r.fetchPromise,enhancedFetchPromise:r.enhancedFetchPromise,events:r.events}},subscribeNotifications:function(t){return Object(u.c)(t,e)},fetchFullCalendarEvent:function(n,r,o,a,c){var i=Object(A.b)(n.Id),u=we(e,n,r,o,a,c,(null==i?void 0:i.IsOrganizer)?"WithBlockedExternalContent":null),s=u.event,l=u.fullEventPromise;return l=l.then((function(i){return Object(d.c)(t,void 0,void 0,(function(){return Object(d.f)(this,(function(t){switch(t.label){case 0:return i.IsOrganizer&&i.HasBlockedImages?[4,we(e,n,r,o,a,c,"WithBlockedExternalContent").fullEventPromise]:[3,2];case 1:i=t.sent(),t.label=2;case 2:return[2,i]}}))}))})),{event:s,fullEventPromise:l}},fetchFullCalendarEventAndUpdateItemResponseShapeType:function(t,n,r,o,a,c){return we(e,t,r,o,a,c,n)},getLockId:function(){return e},release:function(){return Object(c.o)(e)}}}function we(e,t,n,r,o,a,c){return o?Pe(e,t,n,r,a,c):Ce(e,t,n,r,a,c)}function De(e,t){var n=Object(x.g)(e);return t&&function(e,t){t?U.set(e,t):U.delete(e)}(n,t.maxMruSize),_e(n)}var Le=n(828),ke=n(911);function Ke(e){return{getCalendarEventsForDateRange:function(t,n){return Object(Le.a)(e,t,n)},getEnhancedCalendarEventsForDateRange:function(t,n){return function(e,t,n){return Object(ke.b)(t,n)?Object(Le.a)(e,t,n):null}(e,t,n)},getFullCalendarEvent:function(t,n){return Object(A.e)(t,n,e)}}}function Ue(e){return Object(F.a)().calendarFolderWorkingHours.get(e)}n.d(t,"u",(function(){return qe})),n.d(t,"k",(function(){return A.b})),n.d(t,"c",(function(){return i.d})),n.d(t,"b",(function(){return i.c})),n.d(t,"a",(function(){return i.b})),n.d(t,"d",(function(){return i.e})),n.d(t,"g",(function(){return i.f})),n.d(t,"v",(function(){return i.j})),n.d(t,"r",(function(){return i.g})),n.d(t,"t",(function(){return i.i})),n.d(t,"s",(function(){return i.h})),n.d(t,"x",(function(){return u.b})),n.d(t,"y",(function(){return u.d})),n.d(t,"i",(function(){return ae})),n.d(t,"m",(function(){return ce})),n.d(t,"o",(function(){return Q})),n.d(t,"n",(function(){return P.f})),n.d(t,"w",(function(){return fe})),n.d(t,"j",(function(){return ve})),n.d(t,"h",(function(){return be.a})),n.d(t,"e",(function(){return Oe.a})),n.d(t,"f",(function(){return De})),n.d(t,"q",(function(){return _e})),n.d(t,"p",(function(){return Ke})),n.d(t,"l",(function(){return Ue}));var Be=new re.c((function(){return Promise.all([n.e(4),n.e(443)]).then(n.bind(null,18590))})),qe=new re.a(Be,(function(e){return e.getCalendarEventsFromRest}))},898:function(e,t,n){"use strict";var r=n(5);t.a=function(e){return e.IsAllDayEvent||Object(r.u)(e.End,e.Start)>0}},901:function(e,t,n){"use strict";t.a=function(e){switch(e){case"OOF":return 0;case"Busy":return 1;case"Tentative":return 2;case"WorkingElsewhere":return 3;case"Free":return 4;default:return 5}}},903:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(449),o=Object(r.a)({DistinguishedPropertySetId:"Common",PropertyName:"AppendOnSend",PropertyType:"String"})},904:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(180),o=Object(r.a)("6ed8da90-450b-101b-98da-00aa003f1305","IsBookedFreeBlocks","Boolean")},905:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(449),o=Object(r.a)({DistinguishedPropertySetId:"PublicStrings",PropertyName:"MeetingAgenda",PropertyType:"String"})},906:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(180),o=Object(r.a)("6ed8da90-450b-101b-98da-00aa003f1305","TravelTimeEventsLinked","Boolean")},907:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(449),o=Object(r.a)({DistinguishedPropertySetId:"Common",PropertyName:"FlexEventsMetadata",PropertyType:"String"})},908:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(137);function o(e,t){var n=[],o=[];return e.forEach((function(e){var a={start:e.Start,end:e.End};t.some((function(e){return 0===Object(r.j)(e,a,!0)}))?n.push(e):o.push(e)})),{eventsOverlapping:n,eventsNotOverlapping:o}}},911:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(137),o={};function a(e,t){i(e),o[e].push({dateRange:t})}function c(e,t){return function(e,t){i(e);for(var n=o[e],a=0;a<n.length;a++)if(Object(r.c)(n[a].dateRange,t,!0))return{index:a,info:n[a]};return{index:-1,info:null}}(e,t).index>=0}function i(e){o[e]||(o[e]=[])}}}]);
//# sourceMappingURL=owa.53.js.map
self.scriptsLoaded['owa.53.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.53.js'] = (new Date()).getTime();