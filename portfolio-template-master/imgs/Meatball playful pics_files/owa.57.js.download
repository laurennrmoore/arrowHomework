self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.57.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[57],{2123:function(e,t,r){"use strict";var n=r(1),a=r(2553),i=r(4215),u=r(3462),o=r(203),s=r(151),c=r(87),l=r(57),d=r(23),f=r(514);function v(e,t,r,n,v,y){var g=function(e,t,r,n,a){var u=Object(c.b)().bestEffort;u["client-session-id"]=t,u["x-client-localtime"]=Object(i.a)(),u["X-Search-Griffin-Version"]="GWSv2",u["Accept-Language"]=Object(l.j)(),n&&n.length>0&&(u["x-anchormailbox"]=n[0].mailboxSmtpAddress,u.authorization=n[0].tokenString);r&&(u["X-Client-Flights"]=r);u.scenariotag=function(e){var t=e.EntityRequests.length>1,r=e.EntityRequests[0],n=[];t&&n.push("ErrMER");0==r.From&&n.push("1stPg");var a=h[r.EntityType];return n.push(a||"Unknown"),n.join("_")}(e),a&&Object.keys(a).forEach((function(e){u[e]=a[e]}));return u}(e,t,r,n,v);return Object(s.e)(Object(f.v)(Object(u.a)("query","SubstrateSearchV2"===y?2:1),Object(a.a)()),e,Object(o.a)(),!0,g,void 0,void 0,!1).then((function(e){return[e,g]})).catch((function(e){return d.g.warn(e),[e]}))}var h={Event:"ev",Conversation:"cv",Email:"em",Message:"mg",MailItems:"mi",CalendarItems:"ci",MailConversations:"mc",MessageItems:"gi"};function y(e){return e?[(t={RefinerQuery:"ShallowRefiner::SearchScope:hasattachment:true"},Object(n.a)({__type:"DynamicRefinerQueryType:#Exchange"},t))]:null;var t}var g=r(4216),S=r(2918),m=r(2919),p=r(5891),I=r(5052),b=r(979),T=r(2920),O=r(5),R="DateTimeReceived";function C(e,t,r,n){if(e||t){var a=[];a.push(Object(I.a)({FieldURIOrConstant:Object(m.a)({Item:Object(S.a)({Value:Object(O.tb)(t||O.b)})}),Item:Object(b.a)({FieldURI:r||R})})),a.push(Object(p.a)({FieldURIOrConstant:Object(m.a)({Item:Object(S.a)({Value:Object(O.tb)(e||O.d)})}),Item:Object(b.a)({FieldURI:n||R})}));var i=Object(g.a)({Items:a});return Object(T.a)({Item:i})}return null}var j=r(2049);function E(e,t){return Object(j.a)(128)?"DateTime":e||(t>0?"Hybrid":"DateTime")}var x=r(2227);function w(e){var t,r;return(null===(r=null===(t=null==e?void 0:e.TimeZoneContext)||void 0===t?void 0:t.TimeZoneDefinition)||void 0===r?void 0:r.Id)?e.TimeZoneContext.TimeZoneDefinition.Id:"UTC"}function D(e,t,r,n){var a,i,u,o=[];if(n===r){var s={Range:(a={},a[n]={gte:t,lte:e},a)};o.push(s)}else{var c={Range:(i={},i[n]={gte:t},i)};o.push(c);var l={Range:(u={},u[r]={lte:e},u)};o.push(l)}return o}function A(e){switch(e){case"StartTime":return"StartTime";case"EndTime":return"EndTime";case"DateTimeReceived":default:return"received"}}var F=r(1244),M=r(1964),_=r(1959),Q="MsgFolderRoot";function P(e){var t=function(e){var t,r,a=[],i=[];if(e&&e.length>0)try{for(var u=Object(n.k)(e),o=u.next();!o.done;o=u.next()){var s=o.value,c=s.__type;if("PrimaryMailboxSearchScopeType:#Exchange"===c)B(s.FolderScope,a,i);else if("SingleLargeArchiveSearchScopeType:#Exchange"===c)B(s.FolderScope,a,i);else if("LargeArchiveSearchScopeType:#Exchange"===c){1==(1&s.ArchiveTypes)&&i.push("archivemsgfolderroot")}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}return{folderIds:a,folderNames:i}}(e.Body.SearchScope);return q(t.folderIds,t.folderNames,e.Body.IncludeDeleted,"CalendarItems"!==e.Body.ItemTypes?Q:null)}function q(e,t,r,a){var i,u,o,s;void 0===a&&(a=null);var c=[];0===e.length&&0===t.length&&null!=a&&e.push(Object(F.a)(a));try{for(var l=Object(n.k)(t),d=l.next();!d.done;d=l.next()){var f=d.value;c.push({Term:{DistinguishedFolderName:f}})}}catch(e){i={error:e}}finally{try{d&&!d.done&&(u=l.return)&&u.call(l)}finally{if(i)throw i.error}}try{for(var v=Object(n.k)(e),h=v.next();!h.done;h=v.next()){var y=h.value;if(y&&Object(M.a)(y)==_.d)return[];c.push({Term:{FolderId:y}})}}catch(e){o={error:e}}finally{try{h&&!h.done&&(s=v.return)&&s.call(v)}finally{if(o)throw o.error}}r&&c.push({Term:{DistinguishedFolderName:"DeletedItems"}});var g=[],S={Or:c};return g.push(S),c.length>0?g:null}function B(e,t,r){var n=e.BaseFolderId,a=e.BaseFolderId.__type;if("FolderId:#Exchange"===a)t.push(n.Id);else if("DistinguishedFolderId:#Exchange"===a){var i=n.Id;if("msgfolderroot"===i.toLowerCase())r.push(i);else{var u=Object(F.a)(i);t.push(u)}}}function N(e){var t=function(e){var t=function(e){var t=null,r=null,n=null,a=null;if(null==e?void 0:e.Item){var i=e.Item;if("And:#Exchange"===i.__type){var u=i;if(u.Items&&2===u.Items.length){if("IsLessThanOrEqualTo:#Exchange"===u.Items[0].__type){var o=u.Items[0];if("Constant:#Exchange"===o.FieldURIOrConstant.Item.__type&&"PropertyUri:#Exchange"===o.Item.__type){var s=o.FieldURIOrConstant.Item,c=o.Item;t=s.Value,r=c.FieldURI}}if("IsGreaterThanOrEqualTo:#Exchange"===u.Items[1].__type){var l=u.Items[1];if("Constant:#Exchange"===l.FieldURIOrConstant.Item.__type&&"PropertyUri:#Exchange"===l.Item.__type){s=l.FieldURIOrConstant.Item,c=l.Item;n=s.Value,a=c.FieldURI}}}}}return{lteFieldValue:t,lteFieldUri:r,gteFieldValue:n,gteFieldUri:a}}(e.Body.SearchRestrictions),r=t.lteFieldValue,n=t.gteFieldValue,a=t.lteFieldUri,i=t.gteFieldUri;return r&&a&&n&&i?D(r,n,a=A(a),i=A(i)):[]}(e),r=P(e),n=t.concat(r).filter((function(e){return!!e})),a={And:n};return 0===n.length?null:1===n.length?n[0]:a}function k(e){var t=[];return e.Body.SearchScope.forEach((function(r){"PrimaryMailboxSearchScopeType:#Exchange"===r.__type||"CalendarItems"===e.Body.ItemTypes?t.push("Exchange"):"LargeArchiveSearchScopeType:#Exchange"!==r.__type&&"SingleLargeArchiveSearchScopeType:#Exchange"!==r.__type||t.push("ExchangeArchive")})),t}function U(e){return 0===(e?e.length:0)?null:e.map((function(e){return{RefinerString:e.RefinerQuery}}))}function H(e){if(!e)return"MailItems";switch(e){case"CalendarItems":return"Event";case"MailConversations":return"Conversation";case"MessageItems":return"Email";case"MailItems":default:return"Message"}}var L=r(24);function J(){var e=["Suggestion","NoResultModification","NoResultFolderRefinerModification","NoRequeryModification"];return Object(L.i)("sea-modificationQueryAlteration")&&e.push("Modification"),Object(L.i)("sea-extensionQueryAlteration")&&e.push("Extension"),e}function V(e,t,r){var n=(0===e||1!==r)&&"QueryAlterationRecourseLink"!==t;return{EnableSuggestion:n,EnableAlteration:n,SupportedRecourseDisplayTypes:J()}}function G(e,t,r){return t?{QueryString:e.Body.Query,DisplayQueryString:"",ClientQueryAlterationReasons:r}:{QueryString:e.Body.Query}}function z(e,t,r,n,a,i){var u=function(e){var t={Field:"Score",SortDirection:"Desc",Count:3},r={Field:"Time",SortDirection:"Desc"},n={Relevance:[t],Hybrid:[t,r],DateTime:[r]};return e&&n[e]?n[e]:[r]}(e.Body.SortOrder),o=2===i?function(e){return e.filter((function(e){return"Score"===e.Field}))}(u):null;return 2===i?[{EntityType:H(e.Body.ItemTypes),ContentSources:["Exchange"],Filter:N(e),From:e.Body.ResultRowOffset,Query:G(e,t,r),RefiningQueries:U(e.Body.SearchRefiners),Size:e.Body.ResultRowCount,EnableTopResults:(null==o?void 0:o.length)>0,TopResultsCount:(null==o?void 0:o.length)>0?o[0].Count:void 0}]:[{EntityType:H(e.Body.ItemTypes),Filter:N(e),From:e.Body.ResultRowOffset,Provenances:k(e),Query:G(e,t,r),RefiningQueries:U(e.Body.SearchRefiners),Size:e.Body.ResultRowCount,Sort:u,QueryAlterationOptions:V(n,a,i),PropertySet:"ProvenanceOptimized"}]}var K=r(2185);function W(e,t,r){var a,i,u,o;return Object(n.c)(this,void 0,void 0,(function(){var s;return Object(n.f)(this,(function(c){return e&&200===e.status&&(s=Object(L.i)("sea-v23sQueryApi")?null===(a=t)||void 0===a?void 0:a.QueryAlterationResponse:null===(o=null===(u=null===(i=t)||void 0===i?void 0:i.EntitySets)||void 0===u?void 0:u[0])||void 0===o?void 0:o.QueryAlterationResponse)?X(s.QueryAlterationType)?[2,Object(n.a)(Object(n.a)({},r),{querySuggestionData:Z(s)})]:[2,Object(n.a)(Object(n.a)({},r),{querySuggestionData:{alteredQuery:"",flaggedTokens:null,recourseQuery:"",suggestedSearchTerm:null,suggestedSearchTermReferenceId:null,queryAlterationType:null}})]:[2,Object(n.a)({},r)]}))}))}var Z=function(e){var t,r,n,a,i,u,o,s,c,l,d,f,v,h,y,g,S,m;if(Object(L.i)("sea-v23sQueryApi")){var p=e;return{alteredQuery:null===(r=null===(t=p.QueryAlteration)||void 0===t?void 0:t.AlteredQuery)||void 0===r?void 0:r.RawString,flaggedTokens:null===(n=p.QueryAlteration)||void 0===n?void 0:n.FlaggedTokens,recourseQuery:null===(a=p.RecourseQuery)||void 0===a?void 0:a.RawString,suggestedSearchTerm:null===(o=null===(u=null===(i=p.QueryAlteration)||void 0===i?void 0:i.FlaggedTokens)||void 0===u?void 0:u[0])||void 0===o?void 0:o.Suggestion,suggestedSearchTermReferenceId:null===(c=null===(s=p.QueryAlteration)||void 0===s?void 0:s.AlteredQuery)||void 0===c?void 0:c.ReferenceId,queryAlterationType:p.QueryAlterationType}}var I=e;return{alteredQuery:null===(d=null===(l=I.AlteredQuery)||void 0===l?void 0:l.AlteredQuery)||void 0===d?void 0:d.RawString,flaggedTokens:null===(f=I.AlteredQuery)||void 0===f?void 0:f.FlaggedTokens,recourseQuery:null===(v=I.RecourseQuery)||void 0===v?void 0:v.RawString,suggestedSearchTerm:null===(g=null===(y=null===(h=I.AlteredQuery)||void 0===h?void 0:h.FlaggedTokens)||void 0===y?void 0:y[0])||void 0===g?void 0:g.Suggestion,suggestedSearchTermReferenceId:null===(m=null===(S=I.AlteredQuery)||void 0===S?void 0:S.AlteredQuery)||void 0===m?void 0:m.ReferenceId,queryAlterationType:I.QueryAlterationType}},X=function(e){return J().includes(e)};function $(e){return e?{Id:e.Id,ChangeKey:null}:null}function Y(e,t){var r=null;(null==t?void 0:t.TimeZone)&&(r=new Date(e).toISOString());return r}function ee(e){return(null==e?void 0:e.EmailAddress)?{Mailbox:{EmailAddress:e.EmailAddress.Address,Name:e.EmailAddress.Name,RoutingType:"SMTP"}}:null}function te(e){return e?{__typename:"FolderId",Id:e.Id}:null}function re(e){switch(e){case"DateTime":return"DateTime";case"Hybrid":return"Hybrid";case"Relevance":return"Relevance";default:return null}}function ne(e){if(null===e||0===e.length)return null;for(var t=[],r=0;r<e.length;r++)t[r]=$(e[r]);return t}function ae(e){var t;return(null===(t=null==e?void 0:e.QueryId)||void 0===t?void 0:t.Id)?{Id:e.QueryId.Id}:null}function ie(e,t){return{__typename:"ConversationType",Categories:e.Categories,ConversationId:$(e.ConversationId),ConversationTopic:e.ConversationTopic,FlagStatus:e.FlagStatus,From:ee(e.From),GlobalItemIds:ne(e.GlobalItemIds),GlobalMessageCount:e.GlobalMessageCount,GlobalUnreadCount:e.GlobalUnreadCount,HasAttachments:e.HasAttachments,HasIrm:e.HasIrm,HasProcessedSharepointLink:e.HasProcessedSharepointLink,Importance:e.Importance,ItemClasses:e.ItemClasses,ItemIds:ne(e.ItemIds),LastDeliveryOrRenewTime:Y(e.LastDeliveryOrRenewTime,t),LastDeliveryTime:Y(e.LastDeliveryTime,t),LastModifiedTime:Y(e.LastModifiedTime,t),MessageCount:e.MessageCount,ParentFolderId:te(e.ParentFolderId),Preview:e.Preview,SortOrderSource:re(e.SortOrderSource),UniqueRecipients:e.UniqueRecipients,UniqueSenders:e.UniqueSenders,UnreadCount:e.UnreadCount}}var ue=r(19),oe="IPM.Appointment";function se(e){var t,r=ee(e.Organizer);return{CalendarItemType:e.CalendarItemType.toString(),Categories:e.Categories,CharmId:e.Charm,DisplayTo:e.DisplayTo,End:e.End,Start:e.Start,HasAttachments:e.HasAttachments,IsAllDayEvent:e.IsAllDayEvent,IsMeeting:e.IsMeeting,IsMeetingPollEvent:e.IsMeetingPollEvent,ItemClass:e.ItemClass?e.ItemClass:oe,FreeBusyType:e.LegacyFreeBusyStatus?e.LegacyFreeBusyStatus.toString():null,Location:{DisplayName:e.Location},Sensitivity:e.Sensitivity,SeriesId:e.SeriesMasterItemId?e.SeriesMasterItemId.Id:null,Subject:e.Subject,Organizer:r,UID:e.UID,ItemId:$(e.ItemId),ParentFolderId:te(e.ParentFolderId),SerializedImmutableId:e.ImmutableId,SortOrderSource:re(e.SortOrderSource),Preview:e.Preview,IsOrganizer:e.IsOrganizer&&Object(ue.a)().SessionSettings.UserEmailAddress===(null===(t=null==r?void 0:r.Mailbox)||void 0===t?void 0:t.EmailAddress),IsCancelled:e.IsCancelled,ResponseType:e.MyResponseType}}function ce(e,t){var r,n,a=function(e){if(!e)return e;var t=e.indexOf(":");return t>0&&t<6&&t+1<e.length?e.substring(t+1).trim():e}(e.Subject);return{Categories:e.Categories,ConversationId:$(e.ConversationId),ConversationIndex:e.ConversationIndex,ConversationThreadId:{Id:e.ConversationThreadId,ChangeKey:null},ConversationTopic:a,DateTimeReceived:Y(e.DateTimeReceived,t),DateTimeSent:e.DateTimeSent&&Y(e.DateTimeSent,t),LastModifiedTime:Y(e.DateTimeLastModified,t),DisplayBcc:e.DisplayBcc,DisplayCc:e.DisplayCc,DisplayTo:e.DisplayTo,Flag:(n=e.Flag,n?{FlagStatus:n.FlagStatus,CompleteDate:n.CompleteDate,DueDate:n.DueDate,StartDate:n.StartDate}:null),From:ee(e.From),HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,IconIndex:e.IconIndex,Importance:e.Importance,IsDraft:e.IsDraft,IsRead:e.IsRead,ItemClass:e.ItemClass||"IPM.Note",ItemId:{Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey},MailboxGuids:e.MailboxGuids,ParentFolderId:te(e.ParentFolderId),Preview:e.Preview,Sender:ee(e.Sender),SenderSMTPAddress:e.SenderSMTPAddress,Sensitivity:e.Sensitivity,SerializedImmutableId:e.ImmutableId,SortOrderSource:re(e.SortOrderSource),Subject:e.Subject,MentionedMe:null===(r=e.MentionsPreview)||void 0===r?void 0:r.IsMentioned,ExtendedProperty:[{ExtendedFieldURI:{DistinguishedPropertySetId:"Common",PropertyId:3613,PropertyType:"String"},Value:a}]}}function le(e){var t,r,n;return(null===(n=null===(r=null===(t=null==e?void 0:e.EntitySets)||void 0===t?void 0:t[0])||void 0===r?void 0:r.ResultSets)||void 0===n?void 0:n[0])?e.EntitySets[0].ResultSets[0]:null}function de(e,t,r){var a,i,u,o,s,c,l=le(e);if(!l||!l.Results||0===l.Results.length)return{SearchResults:{MoreResultsAvailable:!1,TotalResultsCount:0,SearchResultsCount:0,TDQueryId:ae(null)}};var d=l.Results,f=d.length,v=[],h=[],y=[];switch("SubstrateSearchV2"===r?e.EntitySets[0].EntityType:e.EntitySets[0].Type){case"Message":case"Messages":try{for(var g=Object(n.k)(d),S=g.next();!S.done;S=g.next()){var m=ce((R=S.value).Source,t);m.InstanceKey=R.ReferenceId,v.push(m)}}catch(e){a={error:e}}finally{try{S&&!S.done&&(i=g.return)&&i.call(g)}finally{if(a)throw a.error}}break;case"Conversation":case"Conversations":try{for(var p=Object(n.k)(d),I=p.next();!I.done;I=p.next()){var b=ie((R=I.value).Source,t);b.InstanceKey=R.ReferenceId,h.push(b)}}catch(e){u={error:e}}finally{try{I&&!I.done&&(o=p.return)&&o.call(p)}finally{if(u)throw u.error}}break;case"Event":case"Events":try{for(var T=Object(n.k)(d),O=T.next();!O.done;O=T.next()){var R,C=se((R=O.value).Source);C.InstanceKey=R.ReferenceId,y.push(C)}}catch(e){s={error:e}}finally{try{O&&!O.done&&(c=T.return)&&c.call(T)}finally{if(s)throw s.error}}}return{SearchResults:{Items:v.length>0?v:null,Conversations:h.length>0?h:null,CalendarItems:y.length>0?y:null,MoreResultsAvailable:l.MoreResultsAvailable,SearchRefiners:null,TotalResultsCount:l.Total,SearchTerms:e.SearchTerms,SearchResultsCount:f,TDQueryId:ae(l)}}}function fe(e,t,r,a){return Object(n.c)(this,void 0,void 0,(function(){var i;return Object(n.f)(this,(function(u){return e?200!==e.status?[2,{Body:{MessageText:ve(e,t)}}]:(i=de(t,r,a),[2,{Body:Object(n.a)({},i)}]):[2,{Body:{MessageText:"No response received"}}]}))}))}var ve=function(e,t){return(null==t?void 0:t.error)?JSON.stringify(t.error):e.statusText};var he=r(180),ye=r(10),ge=r(157),Se=r(117),me=r(4),pe="ows/beta/substratesearch/query",Ie=2048;function be(e,t,r,n,a,i){return Oe(e,t,r,n,Ce,a,i)}function Te(e,t,r,n,a,i){return Oe(e,t,r,n,Re,a,i)}function Oe(e,t,r,n,a,i,u){return Object(ge.a)().then((function(o){var s=o.headers;i&&s.append("X-OWA-ActionSource",i);var c=a("ExecuteSearch",t,e,r,o,u),l=0,d=0;return n&&(l=n.addCheckmark("ClientJSPreRequestTime"),Promise.resolve().then((function(){d=n.addCheckmark("ClientJSRequestThread")}))),c?c.then((function(e){var t=e[0],r=e[1],n=[t,r,e[2]];return r.ClientJSPreRequestTime=l,r.ClientJSRequestThreadTime=d,n})):Promise.reject("Client-side issue prevented request from being sent")}))}function Re(e,t,r,a,i,u){var s=this,c=JSON.stringify(r),l=encodeURIComponent(c),d=!1,f=i.headers;f.append("Content-Type","application/json; charset=utf-8"),i.returnFullResponseOnSuccess=!0,l.length>Ie?i.body=c:(d=!0,f.append("X-OWA-UrlPostData",l),i.body=null);var v=function(e,t){var r=Object(ye.a)(),n=(r.baseUrl?r.baseUrl+"/service.svc?action=":"/owa/service.svc?action=")+e;r.appName&&(n+="&app="+r.appName);t&&(n+="&EP=1");return n+="&id="+Object(o.a)()}(e,d),h=new Date;return Object(Se.a)("ExecuteSearch",v,1,i).then((function(e){return Object(n.c)(s,void 0,void 0,(function(){var o;return Object(n.f)(this,(function(n){switch(n.label){case 0:return[4,e.json()];case 1:return o=n.sent(),[2,[o,je(e,r.Body.Query,200==e.status?null:o?JSON.stringify(o.Body):null,"ExecuteSearch",h,new Date,a,i.headers,t,u),e.url]]}}))}))}))}function Ce(e,t,r,a,i,u){var c=this;if(!a)return d.d("SearchQueryId must be specified when calling makeExecuteSearchRequest!"),null;var l={};i.headers.forEach((function(e,t){l[t]=e})),l["X-Search-Griffin-Version"]="GWSv2";var f=new Date;return r.Body.SearchSessionId=a,r.Body.Scenario=u,Object(s.e)(pe,r,Object(o.a)(),!0,l).then((function(e){return Object(n.c)(c,void 0,void 0,(function(){var o;return Object(n.f)(this,(function(n){switch(n.label){case 0:return[4,e.json()];case 1:return[2,[o=n.sent(),je(e,r.Body.Query,200==e.status?null:o?JSON.stringify(o.Body):null,"SubstrateSearch",f,new Date,a,i.headers,t,u),e.url]]}}))}))})).catch((function(e){return d.g.warn(e),null}))}var je=function(e,t,r,n,a,i,u,o,s,c){var l=e.headers||new Headers;return{ClientSearchProvider:n,PageNumber:s,ClientNetworkTime:i.getTime()-a.getTime(),ClientJSEndToEndTime:0,ClientJSPreRequestTime:0,ClientJSRequestThreadTime:0,ClientResponseProcessTime:0,ClientJSRenderingTime:0,SearchDateTime:l.get("date"),SearchBETarget:l.get("x-calculatedbetarget"),SearchFETarget:l.get("x-calculatedfetarget"),SearchBEHttpStatus:l.get("x-backendhttpstatus"),SearchMsEdgeRef:l.get("x-msedge-ref"),SearchErrorContent:r,SearchTraceID:l.get("request-id"),SearchQueryId:u,ClientBuildNumber:Object(me.r)(),ClientTimeSentUTC:a,ClientTimeFinishedUTC:i,ClientHttpStatus:e.status||-1,SearchClientRequestID:o.get("client-request-id"),SearchClientSessionID:Object(me.q)(),ClientName:c,DiagnosticsCheckpoints:l.get("x-ms-diagnostics-checkpoints"),ResourceTimingEntry:null,PIIData:{queryText:t}}};var Ee=250;function xe(e,t,r,a,i,u,o,s,c,l,f,h,g,S,m,p,I,b,T,O,R,D){return void 0===h&&(h=0),void 0===g&&(g=!1),void 0===S&&(S=null),void 0===m&&(m=null),void 0===p&&(p=null),void 0===I&&(I=null),void 0===b&&(b=null),void 0===T&&(T=!1),void 0===O&&(O=null),void 0===R&&(R=null),void 0===D&&(D=null),Object(n.c)(this,void 0,void 0,(function(){var A,F,M,_,Q,P,q,B,N,k,U,H,L,J,G,Z,X,$;return Object(n.f)(this,(function(Y){switch(Y.label){case 0:if((A=Object(he.b)()).RequestServerVersion="V2016_06_15",F={Header:A,Body:(ee={ApplicationId:"Owa",IdFormat:"EwsId",IncludeDeleted:!Object(j.a)(256),ItemTypes:o,MaxPreviewLength:60,MaxRefinersCountPerRefinerType:5,MaxResultsCountHint:Ee,PropertySetName:"Owa16",Query:t,ResultRowCount:e.resultRowCount,ResultRowOffset:e.resultRowOffset,RetrieveRefiners:!1,Scenario:"Calendar"==c?"CalendarSearch":"MailSearch",SearchRefiners:y(g),SearchScope:Object(x.c)(i),SearchRestrictions:C(S,m,p,I),SearchSessionId:r,SortOrder:E(b,h),MaxHybridCountHint:h},Object(n.a)({__type:"ExecuteSearchRequest:#Exchange"},ee))},M=function(e){return Object(n.a)({__type:"ExecuteSearchJsonRequest:#Exchange"},e)}(F),_=-1===u?-1:e.pageNumber,"SubstrateSearch"!==l&&"SubstrateSearchV2"!==l)return[3,9];Y.label=1;case 1:return Y.trys.push([1,7,,8]),Q=function(e){var t=e.request,r=e.cvid,n=e.skipAddToHistory,a=e.clientQueryAlterationReason,i=e.pageNumber,u=e.substrateSearchScenario,o=e.actionSource,s=e.apiVersion,c={Cvid:r,Scenario:{Name:u},TimeZone:w(t.Header),TextDecorations:"Off",EntityRequests:z(t,n,a,i,o,s)};return 2===s&&(c.QueryAlterationOptions=V(i,o,s)),u==K.b.Mail&&(c.LogicalId=r),c}({request:M,cvid:a,skipAddToHistory:T,clientQueryAlterationReason:O,pageNumber:_,substrateSearchScenario:f,actionSource:c,apiVersion:"SubstrateSearch"===l?1:2}),P=0,q=0,s&&(P=s.addCheckmark("ClientJSPreRequestTime"),Promise.resolve().then((function(){q=s.addCheckmark("ClientJSRequestThread")}))),B=new Date,[4,v(Q,r,R,[],D,l)];case 2:return N=Y.sent(),k=new Date,N&&2==N.length?(U=Object(n.g)(N,2),H=U[0],L=U[1],J=null,(null==H?void 0:H.json)?[4,H.json().catch((function(e){return[e]}))]:[3,4]):[2,null];case 3:J=Y.sent(),Y.label=4;case 4:return[4,fe(H,J,Q,l)];case 5:return G=Y.sent(),[4,W(H,J,G.Body)];case 6:return Z=Y.sent(),(X=je(H,M.Body.Query,200==H.status?null:G?JSON.stringify(G.Body):null,l,B,k,a,new Headers(L),e.pageNumber,f)).ClientJSPreRequestTime=P,X.ClientJSRequestThreadTime=q,[2,[Z,X,H.url]];case 7:return $=Y.sent(),d.d("An unexpected error occurred while processing a Substrate Search request: "+$),[2,null];case 8:return[3,10];case 9:return[2,("ExecuteSearch"===l?Te:be)(M,e.pageNumber,a,s,c,f).then((function(e){return[e[0].Body,e[1],e[2]]})).catch((function(e){return null}))];case 10:return[2]}var ee}))}))}function we(e,t,r,n,i,o,c){var l={cvid:r,query:e,textdecorations:"1",scenario:i,entityTypes:n};return c&&(l.logicalId=c),Object(L.i)("sea-modernFileSuggestions")&&(null==e?void 0:e.length)>0&&(l.setFlight="odspFilesForOwa"),t?Object(s.b)(Object(f.v)(Object(u.a)("suggestions"),Object(a.a)(l)),void 0,!0,o,void 0,!1).then((function(e){return e})).catch((function(e){return d.g.warn(e),null})):Promise.resolve(null)}var De=r(33);function Ae(e,t){var r;return void 0===e||e.__type||(r=e,e=Object(n.a)({__type:"StartSearchSessionJsonRequest:#Exchange"},r)),Object(De.a)("StartSearchSession",e,t)}function Fe(e,t){return Ae({Header:Object(he.b)(),Body:(r={SearchSessionId:e,WarmupOptions:16777215,SuggestionTypes:1,SearchScope:Object(x.c)(t),IdFormat:"EwsId",ApplicationId:"Owa"},Object(n.a)({__type:"StartSearchSessionRequest:#Exchange"},r))}).then((function(e){return e.Body}));var r}function Me(e,t){var r;return void 0===e||e.__type||(r=e,e=Object(n.a)({__type:"EndSearchSessionJsonRequest:#Exchange"},r)),Object(De.a)("EndSearchSession",e,t)}function _e(e){return Me({Header:Object(he.b)(),Body:(t={SearchSessionId:e},Object(n.a)({__type:"EndSearchSessionRequest:#Exchange"},t))}).then((function(e){return e.Body}));var t}var Qe,Pe,qe=r(2485),Be=r(2471),Ne=r(2158),ke=r(3943);function Ue(e,t){return{content:e.Preview,id:e.InternetMessageId,composeTime:Y(e.DateTimeSent,t),originalArrivalTime:Y(e.DateTimeReceived,t),containerId:e.ClientConversationId,imDisplayName:e.Sender.EmailAddress.Name,senderProfile:{displayName:e.Sender.EmailAddress.Name,email:e.Sender.EmailAddress.Address},displayTo:e.DisplayTo}}!function(e){e[e.Single=0]="Single",e[e.Occurrence=1]="Occurrence",e[e.Exception=2]="Exception",e[e.RecurringMaster=3]="RecurringMaster"}(Qe||(Qe={})),function(e){e[e.Free=0]="Free",e[e.Tentative=1]="Tentative",e[e.Busy=2]="Busy",e[e.Oof=3]="Oof",e[e.WorkingElsewhere=4]="WorkingElsewhere",e[e.NoData=5]="NoData"}(Pe||(Pe={}));var He=r(2157);r.d(t,"o",(function(){return xe})),r.d(t,"I",(function(){return v})),r.d(t,"J",(function(){return we})),r.d(t,"p",(function(){return Fe})),r.d(t,"n",(function(){return _e})),r.d(t,"g",(function(){return qe.a})),r.d(t,"q",(function(){return x.a})),r.d(t,"x",(function(){return x.b})),r.d(t,"C",(function(){return Be.e})),r.d(t,"D",(function(){return Be.g})),r.d(t,"A",(function(){return Be.b})),r.d(t,"B",(function(){return Be.c})),r.d(t,"y",(function(){return u.a})),r.d(t,"v",(function(){return C})),r.d(t,"E",(function(){return Ne.b})),r.d(t,"e",(function(){return Ne.a})),r.d(t,"G",(function(){return Ne.d})),r.d(t,"H",(function(){return Ne.e})),r.d(t,"F",(function(){return Ne.c})),r.d(t,"r",(function(){return i.a})),r.d(t,"t",(function(){return ke.b})),r.d(t,"s",(function(){return ke.a})),r.d(t,"u",(function(){return ke.c})),r.d(t,"i",(function(){return se})),r.d(t,"h",(function(){return ie})),r.d(t,"j",(function(){return ce})),r.d(t,"k",(function(){return Ue})),r.d(t,"l",(function(){return D})),r.d(t,"m",(function(){return q})),r.d(t,"w",(function(){return le})),r.d(t,"z",(function(){return w})),r.d(t,"f",(function(){return je})),r.d(t,"c",(function(){return K.b})),r.d(t,"b",(function(){return He.b})),r.d(t,"d",(function(){return He.c})),r.d(t,"a",(function(){return He.a}))},2553:function(e,t,r){"use strict";var n=r(1),a=r(210);var i=r(24),u=r(8);r.d(t,"a",(function(){return c}));var o=null,s="searchtesthook";function c(e){void 0===e&&(e={});var t,r=Object(n.a)(Object(n.a)(Object(n.a)({},e),function(){if(!o){o={};var e=Object(u.a)(s),t=decodeURIComponent(e||"").trim();if(Object(i.i)("sea-debugHook")&&t.length>0){var r=t.split("&");o=r.reduce((function(e,t){var r=Object(n.g)(t.split("="),2),a=r[0],i=r[1];return e[a]=i,e}),{})}}return o}()),Object(a.a)("includePartnerIn3SRequest")?((t={}).partner="exchangeshared",t):null);return Object.keys(r).filter((function(e){return null!==r[e]})).reduce((function(e,t){var a;return Object(n.a)(Object(n.a)({},e),((a={})[t]=r[t],a))}),{})}},2918:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(1);function a(e){return Object(n.a)({__type:"Constant:#Exchange"},e)}},2919:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(1);function a(e){return Object(n.a)({__type:"FieldURIOrConstantType:#Exchange"},e)}},2920:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(1);function a(e){return Object(n.a)({__type:"RestrictionType:#Exchange"},e)}},3462:function(e,t,r){"use strict";function n(e,t){return"search/api/"+(2===t?"v2":"v1")+"/"+e}r.d(t,"a",(function(){return n}))},3943:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return u}));var n=[{resultRowOffset:0,resultRowCount:25,pageNumber:0},{resultRowOffset:25,resultRowCount:50,pageNumber:1},{resultRowOffset:75,resultRowCount:75,pageNumber:2},{resultRowOffset:150,resultRowCount:100,pageNumber:3},{resultRowOffset:250,resultRowCount:200,pageNumber:4},{resultRowOffset:450,resultRowCount:200,pageNumber:5},{resultRowOffset:650,resultRowCount:200,pageNumber:6},{resultRowOffset:850,resultRowCount:200,pageNumber:7}],a=function(e,t){if(void 0===t&&(t={pageContexts:n}),e<0||e>=t.pageContexts.length)throw new Error("The pageNumber for execute search is invalid:"+e);return t.pageContexts[e]},i=function(e,t,r,i){void 0===i&&(i={pageContexts:n});var u=e.pageNumber+1,o="PrimaryMailbox"===r?2:4;return t.MoreResultsAvailable&&u<o?a(u,i):null},u=function(e){switch(e){case 74:return n[2];case 149:return n[3];case 249:return n[4];case 449:return n[5];case 649:return n[6];case 849:return n[7];default:return null}}},4215:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(5);function a(){return Object(n.nc)().toString()}},4216:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(1);function a(e){return Object(n.a)({__type:"And:#Exchange"},e)}},5052:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(1);function a(e){return Object(n.a)({__type:"IsLessThanOrEqualTo:#Exchange"},e)}},5891:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(1);function a(e){return Object(n.a)({__type:"IsGreaterThanOrEqualTo:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.57.js.map
self.scriptsLoaded['owa.57.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.57.js'] = (new Date()).getTime();