self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.99.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[99],{1281:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(1);function a(e){return Object(i.a)({__type:"FindItemJsonRequest:#Exchange"},e)}},1302:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(33),a=t(1281);function r(e,n){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(i.a)("FindItem",e,n)}},1304:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(1);function a(e){return Object(i.a)({__type:"FindItemRequest:#Exchange"},e)}},2050:function(e,n,t){"use strict";var i=t(1);function a(e,n){var t,i;switch(n){case 0:t=e.LastDeliveryOrRenewTime,i=e.LastDeliveryTime;break;case 1:t=e.ReceivedOrRenewTime,i=e.DateTimeReceived}return{lastDeliveryOrRenewTimeStamp:t,lastDeliveryTimeStamp:i}}var r=t(2136);function o(e,n){var t=a(e,n.tableQuery.listViewType);return!!(n.lastEmptiedTime&&n.lastEmptiedTime>new Date(t.lastDeliveryTimeStamp))||r.a.getTombstonedReasons(e.InstanceKey,n.serverFolderId).indexOf(3)>-1}var d=t(24),l=t(2593),u=t(2777),s=t(3247),c=t(2013),m=t(3149),v=t(2792),f=t(19),k=t(2709);function b(e){var n=e.tableQuery.listViewType,t=Object(c.b)(e);Object(f.a)().UserOptions.ShowInlinePreviews&&l.b.importAndExecute(t,n),Object(d.i)("tri-coupon-peek")&&u.d.import().then((function(e){e(t.mailboxSmtpAddress,n)}));var i=e.id!==Object(s.a)();k.b.importAndExecute({task:function(){return m.b.importAndExecute(t,n,i)}},{task:function(){return v.d.importAndExecute(t,n,i)},condition:Object(d.i)("tri-txpButtonInLV")})}var I=t(1947),p=t(3456),y=t(2384),w=t(2401),O=t(183),N=Object(O.action)("appendRowResponse")((function(e,n,t,a,r,l,u){var s,c;void 0===a&&(a=""),void 0===u&&(u=!1);var m=n||[],v=0;try{for(var f=Object(i.k)(m),k=f.next();!k.done;k=f.next()){var O=k.value;if(!o(O,e)){var N=!0,F=O.InstanceKey;if(y.a.containsRowKey(e,Object(I.F)(O,e.tableQuery.listViewType))){var g=Object(w.a)(F,e.id,I.b.getLastDeliveryOrRenewTimeStamp(F,e))?e.rowKeys.indexOf(F):e.rowKeys.length-1;y.a.updateRow(g,O,e,a,u)}else N=y.a.appendRow(O,e,a,u);if(Object(d.i)("tri-handleTableAddFailures")&&!N&&v++,r){var h={referenceKey:O.ReferenceKey,index:e.rowKeys.length-1,traceId:r,logicalId:l};Object(p.a)(F,e,h)}}}}catch(e){s={error:e}}finally{try{k&&!k.done&&(c=f.return)&&c.call(f)}finally{if(s)throw s.error}}e.totalRowsInView=t-v,b(e)})),F=t(2027),g=t(1244);function h(e){if(Object(F.e)(e))return!1;if(0==e.type){var n=e.sortBy,t=I.c.getSortBySupportingPin();return n.sortColumn==t.sortColumn&&n.sortDirection==t.sortDirection&&function(e){if(!e)throw new Error("Current folder id should not be null");return Object(g.a)("sentitems")!=e&&Object(g.a)("deleteditems")!=e&&Object(g.a)("drafts")!=e&&Object(g.a)("junkemail")!=e&&Object(g.a)("archive")!=e}(e.folderId)}return 1==e.type}var S=t(23),R=t(2559),T=t(1956);function j(e,n){var t=!1;switch(n.tableQuery.listViewType){case 0:t=C(n.tableQuery,Object(R.a)(e.InstanceKey,n.id),e);break;case 1:t=x(n.tableQuery,e,T.u.items.get(e.ItemId.Id))}return t}var C=function(e,n,t,i){if(void 0===i&&(i={listViewStore:I.ab}),0!==e.type&&2!==e.type)return S.d("isConversationSortKeyEqual should not be called on non MailFolderTableQuery type"),!1;var a=e.sortBy;if(!a)throw new Error("SortBy should not be null");var r=n.instanceKey===t.InstanceKey,o=function(e,n,t){var i=new Date(n.lastDeliveryTimeStamp).getTime()===new Date(t.LastDeliveryTime).getTime();if(h(e)){return new Date(n.lastDeliveryOrRenewTimeStamp).getTime()===new Date(t.LastDeliveryOrRenewTime).getTime()&&i}return i}(e,n,t);if(!r||!o)return!1;var d=i.listViewStore.conversationItems.get(n.id);switch(a.sortColumn){case 1:case 3:return!0;case 5:return d.subject===t.ConversationTopic;case 8:return n.importance===t.Importance;case 7:return d.size===t.Size;default:return S.g.warn("isSortKeyEqual: sortColumn not supported "+a.sortColumn),!1}};function x(e,n,t){if(0!=e.type&&2!==e.type)return S.d("isItemSortKeyEqual should not be called on non MailFolderTableQuery type"),!1;var i=e.sortBy;if(!i)throw new Error("SortBy should not be null");var a=n.InstanceKey===t.InstanceKey,r=function(e,n,t){var i=new Date(n.DateTimeReceived).getTime()===new Date(t.DateTimeReceived).getTime();if(h(e)){return new Date(n.ReceivedOrRenewTime).getTime()===new Date(t.ReceivedOrRenewTime).getTime()&&i}return i}(e,n,t);if(!a||!r)return!1;switch(i.sortColumn){case 1:return!0;case 5:return n.Importance===t.Importance;case 8:return n.Subject===t.Subject;case 3:var o=V(n),d=V(t);return!o||!d||(o.From&&o.From.Mailbox.EmailAddress)===(d.From&&d.From.Mailbox.EmailAddress);case 7:return n.Size===t.Size;default:return S.g.warn("isSortKeyEqual: sortColumn not supported "+i.sortColumn),!1}}function V(e){return-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.Note")?e:null}var D=t(121),M=t(2),K=Object(M.action)("ON_MERGE_ROW_COMPLETED",(function(e){return{tableView:e}})),P=Object(O.action)("mergeRowResponseFromTop")((function(e,n,t,a,r,l){var u,s;if(e){if(r){for(var c=!0,m=0;m<Math.min(n.rowKeys.length,2,e.length);m++)if(n.rowKeys[m]!=e[m].InstanceKey||!j(e[m],n)){c=!1;break}Object(D.t)("TnS_MergeFindResponse",[c])}var v=0,f=0,k=n.tableQuery.listViewType;try{for(var p=Object(i.k)(e),O=p.next();!O.done;O=p.next()){var N=O.value;if(!o(N,n)){var F=Object(I.F)(N,k),g=!0;y.a.containsRowKey(n,F)?Object(d.i)("tri-smartMergeFindResponse")&&I.b.getLastModifiedTimeStamp(F,n)===N.LastModifiedTime?y.a.updateRowPosition(v,F,n,l):y.a.updateRow(v,N,n,l):g=y.a.addRow(v,N,n,l),!Object(d.i)("tri-handleTableAddFailures")||g?v++:f++}}}catch(e){u={error:e}}finally{try{O&&!O.done&&(s=p.return)&&s.call(p)}finally{if(u)throw u.error}}if(a){var h=v;for(m=n.rowKeys.length-1;m>=h;m--){F=n.rowKeys[m];Object(w.a)(F,n.id,I.b.getLastDeliveryOrRenewTimeStamp(F,n))||y.a.removeRow(F,n,l+"_RemoveAfterMerge")}}K(n),n.totalRowsInView=t-f,b(n)}else S.d("We need to have a valid list of rows")}));function E(e,n,t){if(n&&0!=n.length){var i=n[0].InstanceKey,a=Object(R.a)(i,e.id);a&&C(e.tableQuery,a,n[0])&&N(e,n,t,"AppendOnLoadMore")}}function L(e,n,t){if(n&&0!=n.length){var i=n[0].ItemId.Id;T.u.items.has(i)&&(1==e.tableQuery.type||x(e.tableQuery,T.u.items.get(i),n[0]))&&N(e,n,t,"AppendOnLoadMore")}}function A(e,n){var t;for(t=n;t<e.rowKeys.length&&I.b.getIsPinned(e.rowKeys[t],e);t++);return t}var U=t(3810),q=new Map;function _(e,n){var t,i=Object(I.S)(n);t=i?e.LastDeliveryOrRenewTime:e.ReceivedOrRenewTime;var a=I.b.getLastDeliveryOrRenewTimeStamp(e.InstanceKey,n),r=new Date(t).toString()===new Date(a).toString();return r||(i?e.LastDeliveryOrRenewTime=a:e.ReceivedOrRenewTime=a),r}function B(e,n,t){return(0,q[t])(e,n)}function H(e,n){return!o(e,n)&&(function(e,n){var t,a,o=e.InstanceKey,d=n.serverFolderId,l=r.a.getTombstonedReasons(o,d).slice(0);if(l)try{for(var u=Object(i.k)(l),s=u.next();!s.done;s=u.next()){var c=s.value;if(3==c)throw new Error("syncTombstonedProperties should not be called for Remove reason");B(e,n,c)&&r.a.remove(o,d,c)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(a=u.return)&&a.call(u)}finally{if(t)throw t.error}}}(e,n),!0)}function Q(e,n){var t=e.InstanceKey,i=n.serverFolderId,a=r.a.getTombstonedReasons(t,i);return a.indexOf(3)>-1?(r.a.remove(t,i,3),!0):!("Unread"===Object(I.R)(n)&&Object(I.g)(n)&&a.indexOf(2)>-1)||(r.a.remove(t,i,2),!1)}q[1]=_,q[0]=function(e,n){var t=I.b.getCategories(e.InstanceKey,n),i=t?t.slice().sort():[],a=e.Categories?e.Categories.slice().sort():[],r=U(i,a);r||(e.Categories=t);return r},q[2]=function(e,n){var t,i,a,r=I.b.getUnreadCount(e.InstanceKey,n);Object(I.S)(n)?(i=(t=e).UnreadCount,(a=r==i)||(t.UnreadCount=r),Object(I.e)(n)&&(!function(e,n){var t=e,i=t.LastDeliveryTime,a=I.b.getLastDeliveryTimeStamp(e.InstanceKey,n);new Date(i).toString()!==new Date(a).toString()&&(t.LastDeliveryTime=a)}(e,n),_(e,n))):Object(I.Y)(e)?(i=(t=e).IsRead?0:1,(a=r==i)||(t.IsRead=0==r)):a=!0;return a},q[4]=function(){},t.d(n,"c",(function(){return N})),t.d(n,"h",(function(){return P})),t.d(n,"a",(function(){return E})),t.d(n,"b",(function(){return L})),t.d(n,"l",(function(){return h})),t.d(n,"f",(function(){return A})),t.d(n,"d",(function(){return b})),t.d(n,"k",(function(){return H})),t.d(n,"j",(function(){return Q})),t.d(n,"g",(function(){return j})),t.d(n,"e",(function(){return a})),t.d(n,"i",(function(){return K}))},2067:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(1);function a(e){return Object(i.a)({__type:"IndexedPageView:#Exchange"},e)}},2136:function(e,n,t){"use strict";var i={};t.r(i),t.d(i,"add",(function(){return u})),t.d(i,"remove",(function(){return s})),t.d(i,"removeAll",(function(){return c})),t.d(i,"getCount",(function(){return m})),t.d(i,"getTombstonedReasons",(function(){return v})),t.d(i,"clearMapForFolder",(function(){return f})),t.d(i,"removeRowsFromTombstone",(function(){return k}));var a=t(1),r=t(2),o=Object(r.createStore)("tombstone",{folderTombstoneMap:{}}),d=(o(),t(121)),l=t(183),u=Object(l.action)("tombstoneOperations.add")((function(e,n,t){if(1!=n.tableQuery.type&&"spotlight"!==n.tableQuery.scenarioType){var i=n.serverFolderId,a=o().folderTombstoneMap;i in a||(a[i]={});var r=a[i];e.forEach((function(e){var n=r[e];n?3!=t?n.indexOf(3)>-1||-1==n.indexOf(t)&&n.push(t):r[e]=[3]:r[e]=[t]}))}})),s=Object(l.action)("tombstoneOperations.remove")((function(e,n,t){var i=o().folderTombstoneMap;if(n in i){var a=i[n],r=a[e],d=r?r.indexOf(t):-1;if(-1==d)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");r.splice(d,1),0==r.length&&delete a[e],0==Object.keys(a).length&&delete i[n]}})),c=Object(l.action)("tombstoneOperations.removeAll")((function(){o().folderTombstoneMap={},Object(d.t)("TnS_RemoveAllFromTombstone")})),m=function(e,n){var t=o().folderTombstoneMap;if(!(e in t))return 0;var i=0,a=t[e];return Object.values(a).forEach((function(e){e==n&&i++})),i},v=function(e,n){var t=o().folderTombstoneMap;if(n in t){var i=t[n][e];if(i)return i}return[]},f=Object(l.action)("tombstoneOperations.clearMapForFolder")((function(e){var n=o().folderTombstoneMap;n[e]&&(Object(d.t)("TnS_ClearFolderMapInTombstone",[Object.keys(n[e]).length]),delete n[e])})),k=Object(l.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,n){var t,i,r=o().folderTombstoneMap;if(n in r){var d=r[n];try{for(var l=Object(a.k)(e),u=l.next();!u.done;u=l.next()){var s=u.value;s in d&&delete d[s]}}catch(e){t={error:e}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(t)throw t.error}}0==Object.keys(d).length&&delete r[n]}}));n.a=i},2272:function(e,n,t){"use strict";var i=t(31),a=t(981),r=t(979),o=t(1964),d="MailListItem";function l(e){return e&&"scheduled"==Object(o.a)(e)?Object(a.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(r.a)({FieldURI:"ReturnTime"})]}):Object(a.a)({BaseShape:"IdOnly"})}function u(){return d}var s=t(1304),c=t(1302),m=t(180);function v(e,n,t,i,a,r,o,d,u,v,f){if(d&&"UserCategory"!=t)throw new Error("CategoryName should be set only for UserCategory view filter");var k=function(e,n,t,i,a,r,o,d,u,c){var m={ParentFolderIds:[e],ItemShape:c||l(e.Id),ShapeName:r,Traversal:d,Paging:n,FocusedViewFilter:a,ViewFilter:t,SortOrder:i,CategoryFilter:o};return u&&(m.SearchFolderId=u),Object(s.a)(m)}(e,n,t,i,a,r,d,u,v,f);return Object(c.a)({Header:Object(m.b)(),Body:k},o).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var f=t(2067),k=t(2912);function b(e){switch(e){case"Hashtag":case"UserCategory":return"SoftDeleted";default:return"Shallow"}}var I=t(1244);function p(e,n,t,i,a,r,o,d,l,u,s,c){if(d){var m=Object(k.d)(e.Id,0,Object(I.a)("inbox"));if(m)return Promise.resolve(m)}return v(e,Object(f.a)({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:t}),i,a,r,o,l,u,b(i),s,c)}var y=t(2407),w=t(1),O=t(1250),N=t(3080),F={kind:"Document",definitions:Object(w.j)([{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ConversationRows"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchFolderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sortBy"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SortByInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FocusedViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"category"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shapeName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pausedInboxTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationRows"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"searchFolderId"},value:{kind:"Variable",name:{kind:"Name",value:"searchFolderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"viewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"focusedViewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"category"},value:{kind:"Variable",name:{kind:"Name",value:"category"}}},{kind:"ObjectField",name:{kind:"Name",value:"pausedInboxTime"},value:{kind:"Variable",name:{kind:"Name",value:"pausedInboxTime"}}},{kind:"ObjectField",name:{kind:"Name",value:"commonRowsOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"sortBy"},value:{kind:"Variable",name:{kind:"Name",value:"sortBy"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}},{kind:"ObjectField",name:{kind:"Name",value:"shape"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ShapeName"},value:{kind:"Variable",name:{kind:"Name",value:"shapeName"}}},{kind:"ObjectField",name:{kind:"Name",value:"IsScheduledFolder"},value:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ConversationTypeFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"cursor"}}]}},{kind:"Field",name:{kind:"Name",value:"searchFolderId"}},{kind:"Field",name:{kind:"Name",value:"folderId"}},{kind:"Field",name:{kind:"Name",value:"totalConversationRowsInView"}},{kind:"Field",name:{kind:"Name",value:"pageInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"endCursor"}},{kind:"Field",name:{kind:"Name",value:"hasNextPage"}},{kind:"Field",name:{kind:"Name",value:"hasPreviousPage"}},{kind:"Field",name:{kind:"Name",value:"startCursor"}}]}}]}}]}}],Object(w.g)(N.a.definitions))},g=t(1947),h=t(5);function S(e){return Object(g.W)(e)?Object(h.rb)(g.ab.inboxPausedDateTime):null}var R=t(3217),T=t(24),j=t(210);function C(e,n,t,i,a,r,d,l,u,s,c,m,v){return void 0===v&&(v=!1),Object(w.c)(this,void 0,void 0,(function(){var f,b;return Object(w.f)(this,(function(I){switch(I.label){case 0:return!v||u?[3,3]:!Object(j.a)("nativeResolvers")||Object(T.i)("mon-conv-useHx")?[3,1]:(f=Object(k.c)(e,0))?[2,Promise.resolve(Object(R.a)(f))]:[3,3];case 1:return[4,Object(k.b)(e,0)];case 2:if(b=I.sent())return[2,Promise.resolve(b)];I.label=3;case 3:return[4,Object(O.a)()];case 4:return[4,I.sent().query({query:F,variables:{first:n,after:u,folderId:e,searchFolderId:c,viewFilter:Object(g.u)(t),focusedViewFilter:Object(g.q)(r),sortBy:{sortColumn:Object(g.s)(i.sortColumn),sortDirection:i.sortDirection,canSortByRenewTime:a},category:s,mailboxInfo:l,shapeName:d,isScheduledFolder:"scheduled"==Object(o.a)(e),pausedInboxTime:S(e)},context:{requestOptions:m}})];case 5:return[2,I.sent().data.conversationRows]}}))}))}var x=t(3146),V={kind:"Document",definitions:Object(w.j)([{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ItemRows"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchFolderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sortBy"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SortByInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FocusedViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"category"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shapeName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"itemRows"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"searchFolderId"},value:{kind:"Variable",name:{kind:"Name",value:"searchFolderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"viewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"focusedViewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"category"},value:{kind:"Variable",name:{kind:"Name",value:"category"}}},{kind:"ObjectField",name:{kind:"Name",value:"commonRowsOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"sortBy"},value:{kind:"Variable",name:{kind:"Name",value:"sortBy"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}},{kind:"ObjectField",name:{kind:"Name",value:"shape"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ShapeName"},value:{kind:"Variable",name:{kind:"Name",value:"shapeName"}}},{kind:"ObjectField",name:{kind:"Name",value:"IsScheduledFolder"},value:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ItemRowFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"cursor"}}]}},{kind:"Field",name:{kind:"Name",value:"searchFolderId"}},{kind:"Field",name:{kind:"Name",value:"totalItemRowsInView"}},{kind:"Field",name:{kind:"Name",value:"pageInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"endCursor"}},{kind:"Field",name:{kind:"Name",value:"hasNextPage"}},{kind:"Field",name:{kind:"Name",value:"hasPreviousPage"}},{kind:"Field",name:{kind:"Name",value:"startCursor"}}]}}]}}]}}],Object(w.g)(x.a.definitions))},D=t(3517);function M(e,n,t,i,a,r,d,l,u,s,c,m,v){return Object(w.c)(this,void 0,void 0,(function(){var f,b;return Object(w.f)(this,(function(p){switch(p.label){case 0:return u&&!v&&(f=Object(k.d)(e.Id,0,Object(I.a)("inbox")))?[2,Promise.resolve(Object(D.a)(f))]:(b=e.Id,[4,Object(O.a)()]);case 1:return[4,p.sent().query({query:V,variables:{first:n,after:v,folderId:b,searchFolderId:m?m.Id:void 0,viewFilter:Object(g.u)(t),focusedViewFilter:Object(g.q)(r),sortBy:{sortColumn:Object(g.s)(i.sortColumn),sortDirection:i.sortDirection,canSortByRenewTime:a,isDraftsFolder:"drafts"==Object(o.a)(b)},category:c,mailboxInfo:l,shapeName:d,isScheduledFolder:"scheduled"==Object(o.a)(b)},context:{requestOptions:s}})];case 2:return[2,p.sent().data.itemRows]}}))}))}t.d(n,"i",(function(){return P})),t.d(n,"c",(function(){return p})),t.d(n,"a",(function(){return y.a})),t.d(n,"e",(function(){return y.c})),t.d(n,"f",(function(){return u})),t.d(n,"g",(function(){return b})),t.d(n,"b",(function(){return v})),t.d(n,"d",(function(){return C})),t.d(n,"h",(function(){return M}));var K=new i.c((function(){return t.e(1101).then(t.bind(null,18525))})),P=new i.a(K,(function(e){return e.getConversationRowById}))},2384:function(e,n,t){"use strict";var i={};t.r(i),t.d(i,"addRow",(function(){return W})),t.d(i,"appendRow",(function(){return J})),t.d(i,"removeRow",(function(){return Y})),t.d(i,"updateRowPosition",(function(){return $})),t.d(i,"updateRow",(function(){return X})),t.d(i,"updateRowData",(function(){return Z})),t.d(i,"clear",(function(){return ee})),t.d(i,"containsRowKey",(function(){return ne}));var a=t(1),r=t(2593),o=t(2777),d=t(2013),l=t(57),u=t(24),s=t(2027),c=t(891),m=t(520);var v=t(1947),f=t(2792);function k(e,n,t,i){return!!(e>0&&Object(u.i)("tri-txpButtonInLV")&&!Object(s.e)(i.tableQuery)&&function(e){return e>0&&(Object(m.a)(e,c.b)==c.b||Object(m.a)(e,c.a)==c.a)}(e))&&(Object(v.M)().txpActionButtonData.get(t)||f.b.importAndExecute(i,n,t),!0)}function b(e,n){return{Id:e.ConversationId.Id,mailboxInfo:Object(d.b)(n)}}function I(e,n){var t=function(e){var n,t,i=[];try{for(var r=Object(a.k)(e),o=r.next();!o.done;o=r.next()){var d=o.value,l=Object(a.a)({},d);i.push(l.Id)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}return i}(e.GlobalItemIds),i=e.ItemIds[0].Id;return{id:e.ConversationId.Id,subject:e.ConversationTopic,globalItemIds:t,shouldShowAttachmentPreviews:Object(l.h)().UserOptions.ShowInlinePreviews&&Object(r.e)(e,n.tableQuery),validCouponIndexes:Object(o.b)(e,n.tableQuery),globalUnreadCount:e.GlobalUnreadCount,size:e.Size,clientId:b(e,n),globalMessageCount:e.GlobalMessageCount,shouldShowTxpButton:k(e.EntityNamesMap,e.InstanceKey,i,n),hasExternalEmails:e.HasExternalEmails,hasSharepointLink:e.HasProcessedSharepointLink}}var p=t(4396),y=t(2342),w=t(979),O=t(1964),N=t(2136),F=[Object(w.a)({FieldURI:"Start"}),Object(w.a)({FieldURI:"End"}),Object(w.a)({FieldURI:"CalendarItemType"})],g=[Object(w.a)({FieldURI:"ConflictingMeetings"}),Object(w.a)({FieldURI:"IsResponseRequested"}),Object(w.a)({FieldURI:"Organizer"})];function h(e,n,t,i){if(N.a.getTombstonedReasons(e,i.serverFolderId).indexOf(4)>-1)return!1;var a=i.tableQuery.folderId?Object(O.a)(i.tableQuery.folderId):null;return!(!n||Object(s.e)(i.tableQuery)||!t||!(a||"deleteditems"!==a&&"sentitems"!==a)||!Object(y.q)(t)&&!Object(y.l)(t))}function S(e,n,t,i){h(e,n,t,i)&&function(e,n){var t=Object(v.M)().meetingMessageItems.get(e);if(!t)return!0;var i=F;Object(y.q)(n)&&(i=i.concat(g));return i.some((function(e){return void 0===t[e.FieldURI]}))}(n,t)&&p.a(i,e,n)}function R(e,n){if(!e.ItemClasses||0===e.ItemClasses.length)return!1;var t=e.ItemIds[0].Id,i=e.ItemClasses[0];return!!h(e.InstanceKey,t,i,n)&&(S(e.InstanceKey,t,i,n),!0)}function T(e){return e.GlobalMentionedMe||e.GlobalAtAllMention}function j(e){return Object(u.i)("tri-flagStatusV2")&&e.FlagStatusV2?e.FlagStatusV2:e.FlagStatus}var C=t(2133),x=t(3245),V=t(183),D=t(23),M=Object(V.action)("addOrUpdateConversationData")((function(e,n,t,i){void 0===t&&(t=!1),void 0===i&&(i={conversationItems:C.a.conversationItems,tableViewConversationRelations:C.a.tableViewConversationRelations});var a=i.conversationItems,r=i.tableViewConversationRelations;e.ConversationId||D.d("addOrUpdateConversationData: ConversationId is undefined");var o=e.ConversationId.Id,d=Object(x.a)(e.InstanceKey,n.id);if(K(t,o,a)){var l=I(e,n);a.set(o,l)}var u=function(e,n){return{categories:e.Categories,draftItemIds:e.DraftItemIds?e.DraftItemIds.map((function(e){return e.Id})):[],effectiveMentioned:T(e),executeSearchSortOrder:e.SortOrderSource,flagStatus:j(e),hasAttachments:e.HasAttachments,hasIrm:e.HasIrm,iconIndex:e.IconIndex,id:e.ConversationId.Id,importance:e.Importance,instanceKey:e.InstanceKey,itemClasses:e.ItemClasses,itemIds:e.ItemIds.map((function(e){return e.Id})),lastDeliveryOrRenewTimeStamp:e.LastDeliveryOrRenewTime,lastDeliveryTimeStamp:e.LastDeliveryTime,lastModifiedTimeStamp:e.LastModifiedTime,lastSender:e.LastSender?e.LastSender:e.From,parentFolderId:e.ParentFolderId?e.ParentFolderId.Id:null,previewText:e.Preview,returnTime:e.ReturnTime?e.ReturnTime:null,uniqueRecipients:e.UniqueRecipients,uniqueSenders:e.UniqueSenders,unreadCount:e.UnreadCount,globalLikeCount:e.GlobalLikeCount?e.GlobalLikeCount:null,shouldShowRSVP:R(e,n)}}(e,n);r.set(d,u)})),K=function(e,n,t){return!t.get(n)||!e},P=t(4397),E=t(1956);function L(e,n){var t=e.ItemId.Id,i=e.ItemClass;return!!h(e.InstanceKey,t,i,n)&&(S(e.InstanceKey,t,i,n),!0)}var A=Object(V.action)("addOrUpdateItemData")((function(e,n,t){void 0===t&&(t={items:E.u.items,tableViewItemRelations:v.ab.tableViewItemRelations});var i=e.ItemId.Id,u=Object(a.a)(Object(a.a)({},e),{MailboxInfo:Object(d.b)(n),validCouponIndexes:Object(o.c)(e,n.tableQuery),shouldShowAttachmentPreviews:Object(l.h)().UserOptions.ShowInlinePreviews&&Object(r.f)(e,n.tableQuery),shouldShowRSVP:L(e,n),shouldShowTxpButton:k(e.EntityNamesMap,e.InstanceKey,e.ItemId.Id,n)});t.items.has(i)?function(e,n,t){var i,a="spotlight"==(null===(i=null==t?void 0:t.tableQuery)||void 0===i?void 0:i.scenarioType);if(1===t.tableQuery.type||a||(e.ItemId=n.ItemId,e.ReceivedOrRenewTime=n.ReceivedOrRenewTime,e.validCouponIndexes=n.validCouponIndexes,e.shouldShowRSVP=n.shouldShowRSVP,e.shouldShowTxpButton=n.shouldShowTxpButton),e.Subject=n.Subject,e.Importance=n.Importance,e.Sensitivity=n.Sensitivity,e.HasAttachments=n.HasAttachments,e.ItemClass=n.ItemClass,e.Flag=n.Flag,e.Categories=n.Categories,e.SystemCategories=n.SystemCategories,e.ParentFolderId=n.ParentFolderId,e.ConversationId=n.ConversationId,e.DateTimeReceived=n.DateTimeReceived,e.IsDraft=n.IsDraft,e.Size=n.Size,e.Preview=n.Preview,e.DisplayTo=n.DisplayTo,e.IconIndex=n.IconIndex,n.ReturnTime&&(e.ReturnTime=n.ReturnTime),-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.Note")){var r=e,o=n;r.IsRead=o.IsRead,1!==t.tableQuery.type&&(r.IsReadReceiptRequested=o.IsReadReceiptRequested,r.IsDeliveryReceiptRequested=o.IsDeliveryReceiptRequested)}}(t.items.get(i),u,n):(t.items.set(i,u),u.ConversationId||D.d("addOrUpdateItemData: item.ConversationId is null."));var s=Object(x.a)(e.InstanceKey,n.id),c=Object(P.a)(e,n);t.tableViewItemRelations.set(s,c)})),U=Object(V.action)("addOrUpdateRowData")((function(e,n,t){switch(void 0===t&&(t=!1),n.tableQuery.listViewType){case 0:M(e,n,t);break;case 1:A(e,n)}})),q=t(2066),_=t(3149),B=Object(V.action)("removeConversationData")((function(e,n,t){var i,d;void 0===t&&(t={tableViewConversationRelations:C.a.tableViewConversationRelations,tableViews:C.a.tableViews,conversationItems:C.a.conversationItems,conversationCache:q.a});var l=Object(x.a)(e,n.id),s=t.tableViewConversationRelations,c=s.get(l).id,m=s.get(l).itemIds;if(!s.has(l))throw new Error("Conversation not found in store");s.delete(l);var v=!1;try{for(var k=Object(a.k)(t.tableViews.values()),b=k.next();!b.done;b=k.next()){var I=b.value;if(I.id!=n.id&&I.rowIdToRowKeyMap.get(c)){v=!0;break}}}catch(e){i={error:e}}finally{try{b&&!b.done&&(d=k.return)&&d.call(k)}finally{if(i)throw i.error}}v||(t.conversationItems.delete(c),r.d.importAndExecute(c),Object(u.i)("tri-coupon-peek")&&o.e.import().then((function(e){e(c)})),_.a.importAndExecute(m),Object(u.i)("tri-txpButtonInLV")&&f.c.importAndExecute(m),t.conversationCache.remove(c))})),H=t(2487);var Q=t(2962),G=Object(V.action)("removeRowData")((function(e,n){switch(n.selectedRowKeys.has(e)&&Object(Q.a)(e,n.id,!1),n.tableQuery.listViewType){case 0:B(e,n);break;case 1:!function(e,n){var t=Object(v.E)([e],n.id)[0],i=Object(v.P)(e,n.id);if(!v.ab.tableViewItemRelations.has(i))throw new Error("Item not found in list view store");v.ab.tableViewItemRelations.delete(i),_.a.importAndExecute([t]),Object(u.i)("tri-txpButtonInLV")&&f.c.importAndExecute([t]),Object(H.a)(t,0)}(e,n)}})),z=t(5);function W(e,n,t,i,a){return void 0===i&&(i=""),void 0===a&&(a=!1),U(n,t,a),te(t,e,Object(v.F)(n,t.tableQuery.listViewType),i)}function J(e,n,t,i){return void 0===t&&(t=""),void 0===i&&(i=!1),W(n.rowKeys.length,e,n,t,i)}var Y=Object(V.action)("tableOperations.removeRow")((function(e,n,t){void 0===t&&(t=""),ae(n,e,t),G(e,n)})),$=Object(V.action)("tableOperations.updateRowPosition")((function(e,n,t,i){void 0===i&&(i="");var a=t.rowKeys.indexOf(n);if(a<0){var r=new Error("updateRowPosition: Row not found in table, source: "+i);return r.diagnosticInfo="tableLength: "+t.rowKeys.length+" rowKey: "+n,void D.d(r)}a!=e&&(ae(t,n,i),te(t,e,n,i))})),X=Object(V.action)("tableOperations.updateRow")((function(e,n,t,i,a){void 0===i&&(i=""),void 0===a&&(a=!1),$(e,Object(v.F)(n,t.tableQuery.listViewType),t,i),U(n,t,a)})),Z=Object(V.action)("tableOperations.updateRowData")((function(e,n){U(e,n)})),ee=Object(V.action)("tableOperations.clear")((function(e,n,t,i){void 0===n&&(n=null),void 0===t&&(t=[]),void 0===i&&(i="");for(var a=e.rowKeys.length-1;a>=0;a--){var r=e.rowKeys[a];if(-1==t.indexOf(r))if(n){var o=v.b.getLastDeliveryTimeStamp(r,e);Object(z.nc)(o)<n&&Y(r,e,i)}else Y(r,e,i)}}));function ne(e,n){return e.rowKeys.indexOf(n)>=0}function te(e,n,t,i){if(void 0===i&&(i=""),n<0||n>e.rowKeys.length)return le("addToTableRowKeys: Invalid add index",i,re(e,n)),!1;if(ne(e,t))return le("addToTableRowKeys: RowKey already exists",i,re(e,n)),!1;try{var a=v.b.getRowIdString(t,e);return ie(e,a,t,n),!0}catch(t){return le("addToTableRowKeys: exception when adding row at valid index",i,re(e,n)+" exp: "+(null==t?void 0:t.message)),!1}}var ie=Object(V.action)("tableOperations.addRowKeyToTableRowKeysAndMap")((function(e,n,t,i){var a=e.rowIdToRowKeyMap.get(n);a||(a=[]),-1==a.indexOf(t)&&a.push(t),e.rowIdToRowKeyMap.set(n,a),e.rowKeys.splice(i,0,t)}));function ae(e,n,t){void 0===t&&(t="");var i=e.rowKeys.indexOf(n);if(i<0)le("removeFromTableRowKeys: RowKey not found in tableView.rowKeys",t,oe(e));else{var a=v.b.getRowIdString(n,e),r=e.rowIdToRowKeyMap.get(a);if(r){var o=r.indexOf(n);-1!=o?(1==r.length?e.rowIdToRowKeyMap.delete(a):r.splice(o,1),e.rowKeys.splice(i,1)):le("removeFromTableRowKeys: RowKey should be present in rowIdToRowKey map",t,oe(e,a))}else le("removeFromTableRowKeys: invalid rowKeysForRowId",t,oe(e,a))}}function re(e,n){return"addAtIndex: "+n+de(e)}function oe(e,n){return(n?"rowId: "+n:"")+de(e)}function de(e){return" tableLength: "+e.rowKeys.length+" tableType: "+e.tableQuery.type+" lvType: "+e.tableQuery.listViewType}function le(e,n,t){var i=new Error(e+": source: "+n);i.diagnosticInfo=t,D.d(i)}n.a=i},2407:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return u})),t.d(n,"c",(function(){return s}));var i=t(3312),a=t(1964),r=t(979),o="ReactConversationListView",d="ReactConversationSentItemsListView",l="ReactFindConversationSearchFolderListView";function u(e){return e&&"scheduled"==Object(a.a)(e)?Object(i.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(r.a)({FieldURI:"ConversationReturnTime"})]}):Object(i.a)({BaseShape:"IdOnly"})}function s(e,n){return"sentitems"==Object(a.a)(e)||"drafts"==Object(a.a)(e)?d:n?l:o}},2709:function(e,n,t){"use strict";t.d(n,"c",(function(){return r})),t.d(n,"b",(function(){return o})),t.d(n,"a",(function(){return d}));var i=t(31),a=new i.c((function(){return t.e(1056).then(t.bind(null,4247))})),r=new i.a(a,(function(e){return e.tti})),o=new i.a(a,(function(e){return e.govern})),d=new i.a(a,(function(e){return e.enableGovernReport}))},2777:function(e,n,t){"use strict";var i=t(31),a=t(4392),r=t(4395);function o(e,n){return new Date(e)>new Date(n)}var d=t(24),l=t(2013),u=t(1956),s=t(1964),c=t(1947);function m(e,n){var t=e.ConversationId.Id;if(Object(c.M)().couponPeekPreviews.get(t)){var i=Object(c.bb)(t);if(i)return i.validCouponIndexes}return f(e.ItemIds[0].Id,e.CouponRanks,e.CouponExpiryDates,n)}function v(e,n){if(!Object(c.Y)(e))return null;var t=e,i=e.ItemId.Id;if(Object(c.M)().couponPeekPreviews.get(i)){var a=Object(u.g)().items.get(i);if(a)return a.validCouponIndexes}return f(e.ItemId.Id,t.CouponRanks,t.CouponExpiryDates,n)}function f(e,n,t,i){if(1==i.type)return null;if("junkemail"==Object(s.a)(i.folderId))return null;if(!n||!t||n.length!=t.length)return null;for(var a=[],u=0;u<t.length;u++){o(t[u],Date.now())&&a.push({index:u,rank:n[u]})}return a.sort((function(e,n){return n.rank-e.rank})),a.length>0&&Object(d.i)("tri-coupon-peek")&&r.a(Object(l.d)(i).mailboxSmtpAddress,e),a.map((function(e){return e.index}))}t.d(n,"d",(function(){return b})),t.d(n,"e",(function(){return I})),t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return m})),t.d(n,"c",(function(){return v}));var k=new i.c((function(){return t.e(405).then(t.bind(null,18341))})),b=new i.b(k,(function(e){return e.fetchCouponData})),I=new i.b(k,(function(e){return e.removeCouponFromStore})),p=Object(i.d)(k,(function(e){return e.CouponPreviewWell}),(function(e){return Object(a.a)(e)}))},2792:function(e,n,t){"use strict";t.d(n,"d",(function(){return r})),t.d(n,"c",(function(){return o})),t.d(n,"b",(function(){return d})),t.d(n,"a",(function(){return l}));var i=t(31),a=new i.c((function(){return Promise.all([t.e(76),t.e(121),t.e(865)]).then(t.bind(null,6780))})),r=new i.a(a,(function(e){return e.tryGetTxpAdditionalData})),o=new i.a(a,(function(e){return e.removeTxpFromStoreAction})),d=new i.a(a,(function(e){return e.addToTxpItemIdMap})),l=Object(i.d)(a,(function(e){return e.TxpListViewButton}))},2962:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(2),a=Object(i.action)("SET_SELECTION_ON_ROW",(function(e,n,t){return{rowKey:e,tableViewId:n,shouldSelect:t}}))},3080:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ConversationTypeFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConversationType"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ConversationId"}},{kind:"Field",name:{kind:"Name",value:"ConversationTopic"}},{kind:"Field",name:{kind:"Name",value:"UniqueRecipients"}},{kind:"Field",name:{kind:"Name",value:"UniqueSenders"}},{kind:"Field",name:{kind:"Name",value:"LastDeliveryTime"}},{kind:"Field",name:{kind:"Name",value:"Categories"}},{kind:"Field",name:{kind:"Name",value:"FlagStatus"}},{kind:"Field",name:{kind:"Name",value:"HasAttachments"}},{kind:"Field",name:{kind:"Name",value:"MessageCount"}},{kind:"Field",name:{kind:"Name",value:"GlobalMessageCount"}},{kind:"Field",name:{kind:"Name",value:"UnreadCount"}},{kind:"Field",name:{kind:"Name",value:"GlobalUnreadCount"}},{kind:"Field",name:{kind:"Name",value:"Size"}},{kind:"Field",name:{kind:"Name",value:"ItemClasses"}},{kind:"Field",name:{kind:"Name",value:"Importance"}},{kind:"Field",name:{kind:"Name",value:"ItemIds"}},{kind:"Field",name:{kind:"Name",value:"GlobalItemIds"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"InstanceKey"}},{kind:"Field",name:{kind:"Name",value:"Preview"}},{kind:"Field",name:{kind:"Name",value:"IconIndex"}},{kind:"Field",name:{kind:"Name",value:"DraftItemIds"}},{kind:"Field",name:{kind:"Name",value:"HasIrm"}},{kind:"Field",name:{kind:"Name",value:"GlobalLikeCount"}},{kind:"Field",name:{kind:"Name",value:"LastDeliveryOrRenewTime"}},{kind:"Field",name:{kind:"Name",value:"GlobalMentionedMe"}},{kind:"Field",name:{kind:"Name",value:"GlobalAtAllMention"}},{kind:"Field",name:{kind:"Name",value:"SortOrderSource"}},{kind:"Field",name:{kind:"Name",value:"LastSender"}},{kind:"Field",name:{kind:"Name",value:"From"}},{kind:"Field",name:{kind:"Name",value:"ParentFolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"ChangeKey"}}]}},{kind:"Field",name:{kind:"Name",value:"EntityNamesMap"}},{kind:"Field",name:{kind:"Name",value:"HasExternalEmails"}},{kind:"Field",name:{kind:"Name",value:"ReturnTime"}},{kind:"Field",name:{kind:"Name",value:"HasSharepointLink"}},{kind:"Field",name:{kind:"Name",value:"HasAttachmentPreviews"}},{kind:"Field",name:{kind:"Name",value:"HasProcessedSharepointLink"}},{kind:"Field",name:{kind:"Name",value:"CouponRanks"}},{kind:"Field",name:{kind:"Name",value:"CouponExpiryDates"}}]}}]}},3146:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ItemRowFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ItemRow"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"}},{kind:"Field",name:{kind:"Name",value:"AntispamUnauthenticatedSender"}},{kind:"Field",name:{kind:"Name",value:"Categories"}},{kind:"Field",name:{kind:"Name",value:"ConversationId"}},{kind:"Field",name:{kind:"Name",value:"DateTimeReceived"}},{kind:"Field",name:{kind:"Name",value:"DateTimeSent"}},{kind:"Field",name:{kind:"Name",value:"DisplayTo"}},{kind:"Field",name:{kind:"Name",value:"EntityNamesMap"}},{kind:"Field",name:{kind:"Name",value:"Flag"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"FlagStatus"}},{kind:"Field",name:{kind:"Name",value:"StartDate"}},{kind:"Field",name:{kind:"Name",value:"DueDate"}},{kind:"Field",name:{kind:"Name",value:"CompleteDate"}}]}},{kind:"Field",name:{kind:"Name",value:"From"}},{kind:"Field",name:{kind:"Name",value:"HasAttachments"}},{kind:"Field",name:{kind:"Name",value:"HasProcessedSharepointLink"}},{kind:"Field",name:{kind:"Name",value:"IconIndex"}},{kind:"Field",name:{kind:"Name",value:"Importance"}},{kind:"Field",name:{kind:"Name",value:"InstanceKey"}},{kind:"Field",name:{kind:"Name",value:"IsDeliveryReceiptRequested"}},{kind:"Field",name:{kind:"Name",value:"IsDraft"}},{kind:"Field",name:{kind:"Name",value:"IsRead"}},{kind:"Field",name:{kind:"Name",value:"IsReadReceiptRequested"}},{kind:"Field",name:{kind:"Name",value:"IsExternalSender"}},{kind:"Field",name:{kind:"Name",value:"ItemClass"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"LikeCount"}},{kind:"Field",name:{kind:"Name",value:"MentionedMe"}},{kind:"Field",name:{kind:"Name",value:"ParentFolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"ChangeKey"}}]}},{kind:"Field",name:{kind:"Name",value:"Preview"}},{kind:"Field",name:{kind:"Name",value:"ReceivedOrRenewTime"}},{kind:"Field",name:{kind:"Name",value:"ReturnTime"}},{kind:"Field",name:{kind:"Name",value:"Sensitivity"}},{kind:"Field",name:{kind:"Name",value:"Size"}},{kind:"Field",name:{kind:"Name",value:"SortOrderSource"}},{kind:"Field",name:{kind:"Name",value:"Subject"}},{kind:"Field",name:{kind:"Name",value:"SystemCategories"}}]}}]}},3149:function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return o}));var i=t(31),a=new i.c((function(){return t.e(784).then(t.bind(null,6785))})),r=new i.a(a,(function(e){return e.tryPrefetchMeetingMessage})),o=new i.a(a,(function(e){return e.removeMeetingMessagesFromStore}))},3217:function(e,n,t){"use strict";function i(e){var n,t,i,a;return{__typename:"ConversationType",ConversationId:{Id:e.ConversationId.Id},ConversationTopic:null!==(n=e.ConversationTopic)&&void 0!==n?n:"",UniqueRecipients:e.UniqueRecipients,UniqueSenders:e.UniqueSenders,LastDeliveryTime:null!==(t=e.LastDeliveryTime)&&void 0!==t?t:"",Categories:e.Categories,FlagStatus:e.FlagStatus,FlagStatusV2:e.FlagStatusV2,HasAttachments:e.HasAttachments,MessageCount:e.MessageCount,GlobalMessageCount:e.GlobalMessageCount,UnreadCount:null!==(i=e.UnreadCount)&&void 0!==i?i:0,GlobalUnreadCount:e.GlobalUnreadCount,Size:e.Size,ItemClasses:e.ItemClasses,Importance:e.Importance,ItemIds:e.ItemIds,GlobalItemIds:e.GlobalItemIds,LastModifiedTime:e.LastModifiedTime,InstanceKey:e.InstanceKey,Preview:e.Preview,IconIndex:e.IconIndex,DraftItemIds:e.DraftItemIds,HasIrm:e.HasIrm,GlobalLikeCount:e.GlobalLikeCount,LastDeliveryOrRenewTime:null!==(a=e.LastDeliveryOrRenewTime)&&void 0!==a?a:"",GlobalMentionedMe:e.GlobalMentionedMe,GlobalAtAllMention:e.GlobalAtAllMention,SortOrderSource:e.SortOrderSource,LastSender:e.LastSender,From:e.From,ParentFolderId:e.ParentFolderId?{__typename:"FolderId",Id:e.ParentFolderId.Id}:void 0,EntityNamesMap:e.EntityNamesMap,HasExternalEmails:e.HasExternalEmails,ReturnTime:e.ReturnTime,HasSharepointLink:e.HasSharepointLink,HasAttachmentPreviews:e.HasAttachmentPreviews,HasProcessedSharepointLink:e.HasProcessedSharepointLink,CouponRanks:e.CouponRanks,CouponExpiryDates:e.CouponExpiryDates,mentionedMe:e.GlobalMentionedMe||e.GlobalAtAllMention,id:e.ConversationId.Id}}function a(e){var n,t,i,a,s;return{__typename:"ConversationRowConnection",edges:u(e.Conversations),pageInfo:{__typename:"PageInfo",endCursor:l(e.Conversations),hasNextPage:o(e),hasPreviousPage:r(e),startCursor:d(e.Conversations)},searchFolderId:null!==(t=null===(n=e.SearchFolderId)||void 0===n?void 0:n.Id)&&void 0!==t?t:void 0,folderId:null!==(a=null===(i=e.FolderId)||void 0===i?void 0:i.Id)&&void 0!==a?a:void 0,totalConversationRowsInView:null!==(s=e.TotalConversationsInView)&&void 0!==s?s:0}}function r(e){return!(void 0===e.IndexedOffset||!e.Conversations)&&e.IndexedOffset>e.Conversations.length}function o(e){return void 0!==e.IndexedOffset&&null!=e.TotalConversationsInView&&e.IndexedOffset<e.TotalConversationsInView}function d(e){var n;return e&&e.length>0&&null!==(n=e[0].InstanceKey)&&void 0!==n?n:""}function l(e){var n;return e&&e.length>0&&null!==(n=e[e.length-1].InstanceKey)&&void 0!==n?n:""}function u(e){return e&&0!=e.length?e.map((function(e){var n;return{__typename:"ConversationRowEdge",cursor:null!==(n=e.InstanceKey)&&void 0!==n?n:"",node:i(e)}})):[]}t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return i}))},3312:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(1);function a(e){return Object(i.a)({__type:"ConversationResponseShape:#Exchange"},e)}},3456:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(2559),a=t(5028);function r(e,n,t){switch(n.tableQuery.listViewType){case 0:Object(i.a)(e,n.id).instrumentationContext=t;break;case 1:Object(a.a)(e,n.id).instrumentationContext=t}}},3517:function(e,n,t){"use strict";function i(e){var n={__typename:"ItemRow",ItemId:{Id:e.ItemId.Id},Categories:e.Categories,ConversationId:{Id:e.ConversationId.Id},DateTimeReceived:e.DateTimeReceived,DateTimeSent:e.DateTimeSent,DisplayTo:e.DisplayTo,EntityNamesMap:e.EntityNamesMap,Flag:e.Flag,HasAttachments:e.HasAttachments,HasProcessedSharepointLink:e.HasProcessedSharepointLink,IconIndex:e.IconIndex,Importance:e.Importance,InstanceKey:e.InstanceKey,IsDraft:e.IsDraft,IsExternalSender:e.IsExternalSender,ItemClass:e.ItemClass,LastModifiedTime:e.LastModifiedTime,MentionedMe:e.MentionedMe,ParentFolderId:e.ParentFolderId?{__typename:"FolderId",Id:e.ParentFolderId.Id}:void 0,Preview:e.Preview,ReceivedOrRenewTime:e.ReceivedOrRenewTime,ReturnTime:e.ReturnTime,Sensitivity:e.Sensitivity,Size:e.Size,SortOrderSource:e.SortOrderSource,Subject:e.Subject,SystemCategories:e.SystemCategories,id:e.ItemId.Id};if(!(null==e?void 0:e.ItemClass)||-1!==e.ItemClass.indexOf("IPM.Note")||-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.GroupMailbox.JoinRequest")||-1!==e.ItemClass.indexOf("IPM.Post")||-1!==e.ItemClass.indexOf("IPM.Sharing")){var t=e;n.From=t.From,n.IsRead=t.IsRead,n.IsReadReceiptRequested=t.IsReadReceiptRequested,n.IsDeliveryReceiptRequested=t.IsDeliveryReceiptRequested,n.LikeCount=t.LikeCount,n.AntispamUnauthenticatedSender=t.AntispamUnauthenticatedSender}return n}function a(e){var n,t,i,a,s,c,m;return{__typename:"ItemRowConnection",edges:u(null===(n=e.RootFolder)||void 0===n?void 0:n.Items),pageInfo:{__typename:"PageInfo",endCursor:l(null===(t=e.RootFolder)||void 0===t?void 0:t.Items),hasNextPage:o(e),hasPreviousPage:r(e),startCursor:d(null===(i=e.RootFolder)||void 0===i?void 0:i.Items)},searchFolderId:null!==(s=null===(a=e.SearchFolderId)||void 0===a?void 0:a.Id)&&void 0!==s?s:void 0,totalItemRowsInView:null!==(m=null===(c=e.RootFolder)||void 0===c?void 0:c.TotalItemsInView)&&void 0!==m?m:0}}function r(e){var n,t,i,a,r;return!(void 0===(null===(n=e.RootFolder)||void 0===n?void 0:n.IndexedPagingOffset)||null===(t=e.RootFolder)||void 0===t||!t.Items)&&(null===(i=e.RootFolder)||void 0===i?void 0:i.IndexedPagingOffset)>(null===(r=null===(a=e.RootFolder)||void 0===a?void 0:a.Items)||void 0===r?void 0:r.length)}function o(e){var n,t,i,a;return void 0!==(null===(n=e.RootFolder)||void 0===n?void 0:n.IndexedPagingOffset)&&null!=(null===(t=e.RootFolder)||void 0===t?void 0:t.TotalItemsInView)&&(null===(i=e.RootFolder)||void 0===i?void 0:i.IndexedPagingOffset)<(null===(a=e.RootFolder)||void 0===a?void 0:a.TotalItemsInView)}function d(e){var n;return e&&e.length>0&&null!==(n=e[0].InstanceKey)&&void 0!==n?n:""}function l(e){var n;return e&&e.length>0&&null!==(n=e[e.length-1].InstanceKey)&&void 0!==n?n:""}function u(e){return e&&0!=e.length?e.map((function(e){var n;return{__typename:"ItemRowEdge",cursor:null!==(n=e.InstanceKey)&&void 0!==n?n:"",node:i(e)}})):[]}t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return i}))},3810:function(e,n){e.exports=function(e,n){var t=e.length;if(t!==n.length)return!1;for(var i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}},4392:function(e,n,t){"use strict";t.d(n,"a",(function(){return d}));var i=t(4393),a=t(424),r=t(0),o=t(4394);function d(e){var n=Math.min(i.a,e.validCouponIndexes.length);return Array.apply(null,Array(n)).map((function(e){return r.createElement("div",{key:e},r.createElement(a.a,{iconName:"",className:o.icon}))}))}},4393:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var i=1},4394:function(e,n,t){var i=t(4557),a=t(78);"string"==typeof i&&(i=[[e.i,i]]);for(var r=0;r<i.length;r++)a.loadStyles(i[r][1],!1);i.locals&&(e.exports=i.locals)},4395:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"c",(function(){return d})),t.d(n,"b",(function(){return l}));var i=t(23),a={},r=function(e,n){o(e,n)?i.g.warn("couponPeekOperations: duplicate itemId should not be fetched again"):a[e]?a[e].push(n):a[e]=[n]},o=function(e,n){var t=a[e];return t&&t.indexOf(n)>0},d=function(e){delete a[e]},l=function(e){return a[e]}},4396:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"c",(function(){return d})),t.d(n,"b",(function(){return l}));var i=t(2013),a={},r=function(e,n,t){var r=Object(i.d)(e.tableQuery).mailboxSmtpAddress;o(r,t)||(a[r]?a[r].push({rowKey:n,itemId:t,tableViewId:e.id}):a[r]=[{rowKey:n,itemId:t,tableViewId:e.id}])},o=function(e,n){var t=a[e];return t&&t.some((function(e){return e.itemId===n}))},d=function(e){delete a[e]},l=function(e){return a[e]}},4397:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return r}));var i=t(2013);function a(e,n){return{Id:e,mailboxInfo:Object(i.b)(n)}}function r(e,n){return{executeSearchSortOrder:e.SortOrderSource,clientId:a(e.ItemId.Id,n),instanceKey:e.InstanceKey}}},4557:function(e,n,t){(n=e.exports=t(77)(!1)).push([e.i,'.CN8b_H-vp26NxjABwwT7a{white-space:nowrap;color:"[theme:redDark, default:#a80000]";font-weight:400}html[dir=ltr] .rK3aivbMQMOCkH0WcMu-q{margin-right:10px}html[dir=rtl] .rK3aivbMQMOCkH0WcMu-q{margin-left:10px}',""]),n.locals={couponRow:"CN8b_H-vp26NxjABwwT7a",icon:"rK3aivbMQMOCkH0WcMu-q"}}}]);
//# sourceMappingURL=owa.99.js.map
self.scriptsLoaded['owa.99.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.99.js'] = (new Date()).getTime();