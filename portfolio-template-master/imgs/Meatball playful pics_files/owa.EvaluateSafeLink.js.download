self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.EvaluateSafeLink.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[439],{10339:function(n,e,t){"use strict";t.r(e);var r=t(1),i=t(33);function u(n,e){var t;return void 0===n||n.__type||(t=n,n=Object(r.a)({__type:"EvaluateSafeLinkRequest:#Exchange"},t)),Object(i.a)("EvaluateSafeLink",n,e)}var c=t(23);function o(n){return Object(r.c)(this,void 0,void 0,(function(){var e,t;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(!n)return[2,null];if(!(n.length>0))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,u({SafeLinkUrls:n})];case 2:return(null==(e=r.sent())?void 0:e.Results)?[2,e.Results]:[3,4];case 3:return t=r.sent(),c.g.warn("evaluateSafeLinkService failed with error: "+t),[3,4];case 4:return[2,n.map((function(){return null}))]}}))}))}var a,s=[],f=new Map;function l(n){return Object(r.c)(this,void 0,void 0,(function(){var e,t;return Object(r.f)(this,(function(r){return n&&n.length?f.has(n)?[2,f.get(n)]:(null==(e=s.filter((function(e){return e.url===n})))?void 0:e.length)>0?[2,e[0].promise]:((t={url:n,promise:null,resolve:null}).promise=new Promise((function(n){t.resolve=n})),s.push(t),a&&clearTimeout(a),a=setTimeout(v,1e3),[2,t.promise]):[2,null]}))}))}function h(n){return Promise.all(n.map((function(n){return l(n)})))}function v(){return Object(r.c)(this,void 0,void 0,(function(){var n;return Object(r.f)(this,(function(e){switch(e.label){case 0:return s.length>0?(n=s.splice(0,s.length),[4,o(n.map((function(n){return n.url})))]):[3,2];case 1:e.sent().map((function(e,t){var r=n[t],i=r.url,u=r.resolve;f.set(i,e),u(e)})),e.label=2;case 2:return[2]}}))}))}var d=t(2416),b=t(3339);function w(n){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(e){switch(e.label){case 0:return[4,d.e.import()];case 1:return e.sent()(n.href)?[2,!1]:[2,n.hasAttribute(b.b)&&n.hasAttribute(b.d)]}}))}))}t.d(e,"evaluateSafeLink",(function(){return l})),t.d(e,"evaluateSafeLinks",(function(){return h})),t.d(e,"isSafeLink",(function(){return w}))},2416:function(n,e,t){"use strict";t.d(e,"a",(function(){return u})),t.d(e,"c",(function(){return c})),t.d(e,"e",(function(){return o})),t.d(e,"f",(function(){return a})),t.d(e,"d",(function(){return s})),t.d(e,"b",(function(){return f}));var r=t(31),i=new r.c((function(){return t.e(1025).then(t.bind(null,3289))})),u=new r.b(i,(function(n){return n.extractFileUrlFromOfficeSharePointLink})),c=new r.b(i,(function(n){return n.isLinkPrefixedWithBaseUrl})),o=new r.b(i,(function(n){return n.isSharePointLink})),a=new r.b(i,(function(n){return n.isSharePointServiceGeneratedLink})),s=new r.b(i,(function(n){return n.isOfficeSharePointLink})),f=new r.b(i,(function(n){return n.getParsedQueryStringFromUrl}))}}]);
//# sourceMappingURL=owa.EvaluateSafeLink.js.map
self.scriptsLoaded['owa.EvaluateSafeLink.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.EvaluateSafeLink.js'] = (new Date()).getTime();