self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FilterContextMenu.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[451],{11589:function(e,t,n){var r=n(14349),i=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},12168:function(e,t,n){"use strict";n.r(t);var r=n(20),i=n(14347),o=n(9604),c=n(6),a=n(14348),u=n(7416);function l(e){switch(e){case 1:return Object(c.b)(a.a);case 3:return Object(c.b)(a.b);case 7:return Object(c.b)(a.d);case 5:return Object(c.b)(a.c);case 8:return Object(c.b)(u.a);default:throw new Error("Sort not implemented")}}var s=n(5485),d=n(5486),f=n(7417),b=n(7418),p=n(7255),m=n(94),g=n(23);function h(e){switch(e){case"All":return Object(c.b)(o.a);case"Unread":return Object(c.b)(d.a);case"Flagged":return Object(c.b)(s.a);case"ToOrCcMe":return Object(c.b)(f.a);case"HasAttachment":return Object(c.b)(p.a);case"Mentioned":return Object(c.b)(b.a);case"TaskActive":case"TaskOverdue":case"TaskCompleted":case"DeprecatedSuggestions":case"DeprecatedSuggestionsRespond":case"DeprecatedSuggestionsDelete":case"DeprecatedNoClutter":case"DeprecatedClutter":case"SystemCategory":case"UserCategory":case"Pinned":case"Focused":case"Locked":case"Hashtag":case"Liked":return g.d("Filter not implemented"),"";default:return Object(m.a)(e)}}var w=n(4562),S=n(1947),x=n(0),O=n(143),y=n(805),j=n(60),C=n(4720),v=n(1975),k=n(2816),E=n(1964),I=n(11589),D=Object(r.a)((function(e){var t=x.useMemo((function(){return S.ab.tableViews.get(e.tableViewId)}),[e.tableViewId]),n=function(){var e=Object(S.L)(t),n=e.sortDirection==S.c.ASCENDING_SORT_DIR,r=e.sortColumn,o=S.c.getSupportedSortColumns(t.tableQuery.folderId),u=[],s=[];o.forEach((function(t){var n=r==t;s.push({key:t.toString(),name:l(t),data:{sortOrder:n?e.sortDirection:S.c.getDefaultSortDirectionForSortColumn(t),sortColumn:t},onClick:a,canCheck:!0,isChecked:n})})),u.push({key:"sortBySection",itemType:O.a.Section,sectionProps:{bottomDivider:!0,title:Object(c.b)(i.j),items:s}});var d=function(e){switch(e){case 1:return{ascendingString:Object(c.b)(i.g),descendingString:Object(c.b)(i.f)};case 3:case 8:return{ascendingString:Object(c.b)(i.a),descendingString:Object(c.b)(i.b)};case 7:return{ascendingString:Object(c.b)(i.h),descendingString:Object(c.b)(i.d)};case 5:return{ascendingString:Object(c.b)(i.e),descendingString:Object(c.b)(i.c)};default:throw new Error("Sort not implemented")}}(r),f=d.ascendingString,b=d.descendingString,p=[{key:"ascending",name:f,data:{sortOrder:"Ascending",sortColumn:r},onClick:a,canCheck:!0,isChecked:n},{key:"descending",name:b,data:{sortOrder:"Descending",sortColumn:r},onClick:a,canCheck:!0,isChecked:!n}];return u.push({key:"sortOrderSection",itemType:O.a.Section,sectionProps:{bottomDivider:!0,title:Object(c.b)(i.k),items:p}}),u},r=function(t){return{key:t.toString(),name:h(t),data:t,canCheck:!0,isChecked:e.currentViewFilter==t,onClick:u}},a=function(t,n){e.dismissContextMenu(),w.e.importAndExecute(n.data.sortColumn,n.data.sortOrder,e.tableViewId,e.filterMenuSource)},u=function(t,n){e.dismissContextMenu();var r=n.data;"Important"===r?w.c.importAndExecute(e.filterMenuSource):w.d.importAndExecute(r,e.filterMenuSource)},s=e.dismissContextMenu,d=e.contextMenuTargetElement,f=function(){var a=e.supportedViewFilters.filter((function(e){return!(Object(v.c)()&&("Mentioned"===e||"ToOrCcMe"===e))})).map((function(e){return r(e)}));if(Object(k.b)()&&t.tableQuery.folderId&&"inbox"==Object(E.a)(t.tableQuery.folderId)){var l=k.h.tryImportForRender(),s=(null==l?void 0:l())||0;a.push({key:"importantFilter",name:Object(c.b)(o.c),canCheck:!0,data:"Important",onClick:u,secondaryText:s>0?s.toString():null,itemProps:{styles:{secondaryText:I.secondaryText}}})}if(1!=t.tableQuery.type){a.push({key:"divider",name:"-",itemType:O.a.Divider});var d=S.ab.tableViews.get(e.tableViewId).tableQuery.folderId;a.push({key:"sortBy",name:Object(c.b)(i.i),items:n()});var f=C.a.tryImportForRender();if(f){var b=f(d,e.dismissContextMenu,"filterMenu");b&&(a.push({key:"divider",name:"-",itemType:O.a.Divider}),a.push(b))}}return a}();return x.createElement(y.a,{shouldFocusOnMount:!0,target:d,directionalHint:j.a.bottomRightEdge,onDismiss:s,items:f})}));var M=n(1),N=n(424),V=n(2053),_=n(183),F=n(2),P=Object(F.createStore)("mailListFilterView",{filterContextMenuDisplayState:!1}),Q=P(),T=Object(_.action)("showFilterDropDownContextMenu")((function(){P().filterContextMenuDisplayState=!0})),K=Object(_.action)("hideFilterDropDownContextMenu")((function(){P().filterContextMenuDisplayState=!1})),A=n(5776);Object(F.mutator)(A.e,(function(e){P().filterContextMenuDisplayState=!0}));var R=n(1977),H=n(24),z=n(57),L=n(11589),J=n(378).bind(L),Y=Object(r.a)((function(e){var t,n=x.useRef(),r=S.ab.tableViews.get(e.tableViewId),i=Object(S.R)(r),a=r.tableQuery,u="spotlight"===a.scenarioType,l="All"==i&&!u,s=function(t){t.stopPropagation();var n=Q.filterContextMenuDisplayState;u?w.b.importAndExecute(e.filterMenuSource):l?n?B():T():w.d.importAndExecute("All",e.filterMenuSource)},d=J(e.containerClassName,e.isInboxWithPivots&&L.filterPivots,Q.filterContextMenuDisplayState?L.filterAllOpened:L.filterAll),f={role:R.a.button},b=x.useMemo((function(){return l?Object(c.b)(o.b):u?Object(c.b)(o.c):h(i)}),[e.tableViewId]),p=Object(H.i)("mon-densities"),m="Ascending"==(null===(t=null==a?void 0:a.sortBy)||void 0===t?void 0:t.sortDirection)?"SortUp":"SortDown",g=l?p?m:"ChevronDownMed":"Cancel";return x.createElement("div",Object(M.a)({ref:function(e){return n.current=e},className:d,onClick:s,onKeyDown:function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),s(e))}},Object(R.b)(f),{tabIndex:0}),x.createElement("div",{className:J(L.filterContents,p&&L.filterContentsNext,p&&Object(z.d)())},p&&x.createElement(N.a,{className:L.filterIcon,iconName:"Filter"}),b,x.createElement(N.a,{className:p?L.sortOrderIcon:L.icon,iconName:g})),Q.filterContextMenuDisplayState&&x.createElement(D,{currentViewFilter:i,supportedViewFilters:e.supportedViewFilters,dismissContextMenu:B,contextMenuTargetElement:n.current,filterMenuSource:e.filterMenuSource,tableViewId:e.tableViewId}))}));function B(){K(),V.b.importAndExecute()}n.d(t,"MailFilterContextMenu",(function(){return D})),n.d(t,"MailListFilterMenu",(function(){return Y}))},14347:function(e){e.exports=JSON.parse('{"i":"bVc","j":"cVc","k":"dVc","a":"eVc","b":"fVc","g":"gVc","f":"hVc","d":"iVc","h":"jVc","c":"kVc","e":"lVc"}')},14348:function(e){e.exports=JSON.parse('{"a":"pVc","b":"qVc","d":"rVc","c":"sVc"}')},14349:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._2HxQ4wKES5wjvIgnjfLcQK,._3HGhEMHDY2i8us0auVPsuI{cursor:pointer;font-size:14px;font-weight:400;color:"[theme:themePrimary, default:#0078D4]";font-weight:600;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;height:32px}html[dir] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir] ._3HGhEMHDY2i8us0auVPsuI{padding:0 8px;border-radius:2px;margin-top:5px}html[dir=ltr] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir=ltr] ._3HGhEMHDY2i8us0auVPsuI{margin-left:auto;margin-right:-8px}html[dir=rtl] ._2HxQ4wKES5wjvIgnjfLcQK,html[dir=rtl] ._3HGhEMHDY2i8us0auVPsuI{margin-right:auto;margin-left:-8px}html[dir] ._2HxQ4wKES5wjvIgnjfLcQK:hover,html[dir] ._3HGhEMHDY2i8us0auVPsuI{background-color:"[theme:neutralLighter, default:#f3f2f1]"}html[dir] .SNcGPM0gk8ayZzwzROpZX{margin-bottom:8px}html[dir] ._3lIR1LfENBYPLTyCDNhq5k{margin-top:6px}._2oQ9sQfC-vORW35CueNgmA{font-weight:400;font-size:10px;color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] ._2oQ9sQfC-vORW35CueNgmA{padding-left:4px}html[dir=rtl] ._2oQ9sQfC-vORW35CueNgmA{padding-right:4px}._2_SkjBhZSNqf9Kyzy4u3E7{font-size:14px}html[dir=ltr] ._2_SkjBhZSNqf9Kyzy4u3E7{padding-right:7px}html[dir=rtl] ._2_SkjBhZSNqf9Kyzy4u3E7{padding-left:7px}._2Bkh9v8E1TnE5lKtn0SYsl{font-size:16px}html[dir=ltr] ._2Bkh9v8E1TnE5lKtn0SYsl{padding-left:14px}html[dir=rtl] ._2Bkh9v8E1TnE5lKtn0SYsl{padding-right:14px}.QCFDYNlgEXFDrarlbtyNf{color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] .QCFDYNlgEXFDrarlbtyNf{margin-right:3px}html[dir=rtl] .QCFDYNlgEXFDrarlbtyNf{margin-left:3px}._3dwdEulgzlEpJJiG-ps3f0{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:"[theme:neutralSecondary, default:#605e5c]";font-size:12px}._3dwdEulgzlEpJJiG-ps3f0._1W88wkOoEJMgVZLcIKJkVj{font-size:14px}',""]),t.locals={filterAll:"_2HxQ4wKES5wjvIgnjfLcQK",filterAllOpened:"_3HGhEMHDY2i8us0auVPsuI",filterPivots:"SNcGPM0gk8ayZzwzROpZX",filterContents:"_3lIR1LfENBYPLTyCDNhq5k",icon:"_2oQ9sQfC-vORW35CueNgmA",filterIcon:"_2_SkjBhZSNqf9Kyzy4u3E7",sortOrderIcon:"_2Bkh9v8E1TnE5lKtn0SYsl",secondaryText:"QCFDYNlgEXFDrarlbtyNf",filterContentsNext:"_3dwdEulgzlEpJJiG-ps3f0",full:"_1W88wkOoEJMgVZLcIKJkVj"}},2719:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2049),i=n(24);function o(){return Object(i.i)("tri-spotlight2")&&!Object(r.a)(2048)}},2793:function(e,t,n){"use strict";var r=n(2),i=Object(r.createStore)("spotlightStore",{spotlightItems:[],rollupDismissed:!1,logicalId:null,requestStartTime:null,spotlightTableQuery:null});t.a=i},2816:function(e,t,n){"use strict";var r=n(31),i=n(2793);function o(e){var t=e.itemId,n=e.conversationId,r=e.rowKey;return Object(i.a)().spotlightItems.some((function(e){return t&&e.itemId===t||n&&e.conversationId===n||r&&e.rowKey===r}))}var c=n(2719);n.d(t,"i",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"m",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"g",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return g})),n.d(t,"l",(function(){return h})),n.d(t,"a",(function(){return w})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c.a}));var a=new r.c((function(){return Promise.all([n.e(4),n.e(15),n.e(17),n.e(16),n.e(57),n.e(76),n.e(99),n.e(117),n.e(827)]).then(n.bind(null,18206))})),u=new r.a(a,(function(e){return e.initializeSpotlight})),l=new r.b(a,(function(e){return e.getSpotlightLogicalId})),s=new r.b(a,(function(e){return e.getSpotlightItem})),d=new r.b(a,(function(e){return e.getUnacknowledgedSpotlightCount})),f=new r.a(a,(function(e){return e.onSpotlightDismissedFromRP})),b=new r.a(a,(function(e){return e.getSpotlightDonationJson})),p=new r.a(a,(function(e){return e.getSpotlightReasonString})),m=new r.a(a,(function(e){return e.loadImportantTable})),g=new r.a(a,(function(e){return e.logSpotlightItemClicked})),h=new r.a(a,(function(e){return e.logSpotlightResultsRendered})),w=Object(r.d)(a,(function(e){return e.SpotlightIconTeachingMoment}))},4533:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),i=Object(r.createStore)("whatsNewStore",{cards:null,disablePauseInboxTryIt:!1})},4562:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return a})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return s}));var r=n(31),i=new r.c((function(){return Promise.all([n.e(52),n.e(87),n.e(99),n.e(117),n.e(191),n.e(281),n.e(708)]).then(n.bind(null,8517))})),o=new r.a(i,(function(e){return e.selectFilter})),c=new r.a(i,(function(e){return e.selectSort})),a=new r.a(i,(function(e){return e.togglePauseInbox})),u=new r.a(i,(function(e){return e.clearFilter})),l=new r.a(i,(function(e){return e.loadSpotlightFilter})),s=new r.a(i,(function(e){return e.clearSpotlightFilter}))},4720:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(31),i=new r.c((function(){return n.e(974).then(n.bind(null,6851))})),o=new r.b(i,(function(e){return e.getPauseInboxContextMenuItem}))},4991:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Read="Read",e.Unread="Unread"}(r||(r={}))},4992:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),i=Object(r.action)("OPEN_PAUSE_INBOX")},5776:function(e,t,n){"use strict";var r=n(31),i=n(4533),o=n(4991);function c(){var e=Object(i.a)();return e.cards?Object.keys(e.cards).filter((function(t){return e.cards[t].status===o.a.Unread})).length:0}var a=n(4992);n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return a.a}));var u=new r.c((function(){return Promise.all([n.e(0),n.e(28),n.e(307),n.e(875)]).then(n.bind(null,18179))})),l=Object(r.d)(u,(function(e){return e.WhatsNewFluentPane})),s=new r.a(u,(function(e){return e.initializeWhatsNewIfNecessary})),d=new r.a(u,(function(e){return e.openPremiumDashboard}))},7255:function(e){e.exports=JSON.parse('{"a":"j3a"}')},7416:function(e){e.exports=JSON.parse('{"a":"_2a"}')},7417:function(e){e.exports=JSON.parse('{"a":"E2a"}')},7418:function(e){e.exports=JSON.parse('{"a":"C2a"}')},9604:function(e){e.exports=JSON.parse('{"b":"_Uc","a":"$Uc","c":"aVc"}')}}]);
//# sourceMappingURL=owa.FilterContextMenu.js.map
self.scriptsLoaded['owa.FilterContextMenu.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FilterContextMenu.js'] = (new Date()).getTime();