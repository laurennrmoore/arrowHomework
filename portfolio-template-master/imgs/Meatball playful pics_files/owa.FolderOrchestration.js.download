self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FolderOrchestration.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[460],{10368:function(e,n,i){"use strict";var a=i(1),d=i(1250),l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FolderCounts"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"additionalProperties"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"TotalCount",block:!1},{kind:"StringValue",value:"UnreadCount",block:!1}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"FolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"Field",name:{kind:"Name",value:"TotalCount"}},{kind:"Field",name:{kind:"Name",value:"UnreadCount"}}]}}]}}]},t=i(6614),o={kind:"Document",definitions:Object(a.j)([{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FolderCountsAndPermissions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"additionalProperties"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"TotalCount",block:!1},{kind:"StringValue",value:"UnreadCount",block:!1},{kind:"StringValue",value:"PermissionSet",block:!1}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"FolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"Field",name:{kind:"Name",value:"TotalCount"}},{kind:"Field",name:{kind:"Name",value:"UnreadCount"}},{kind:"FragmentSpread",name:{kind:"Name",value:"MailFolderPermissionsFragment"}}]}}]}}],Object(a.g)(t.a.definitions))},m={kind:"Document",definitions:Object(a.j)([{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FolderPermissions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"additionalProperties"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"PermissionSet",block:!1}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"FolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"MailFolderPermissionsFragment"}}]}}]}}],Object(a.g)(t.a.definitions))},k=i(6421);function u(e,n){return r(e,"Permissions",n||Object(k.a)(e,!0))}function r(e,n,i){return Object(a.c)(this,void 0,void 0,(function(){var t,k;return Object(a.f)(this,(function(a){switch(a.label){case 0:return[4,Object(d.a)()];case 1:switch(t=a.sent(),n){case"Counts":k=l;break;case"CountsAndPermissions":k=o;break;case"Permissions":k=m}a.label=2;case 2:return a.trys.push([2,4,,5]),[4,t.query({query:k,variables:{id:e,mailboxInfo:i}})];case 3:return[2,a.sent().data.folder];case 4:return a.sent(),[2,null];case 5:return[2]}}))}))}i.d(n,"b",(function(){return u})),i.d(n,"a",(function(){return r}))},18591:function(e,n,i){"use strict";i.r(n);var a=i(2654),d=i(3455),l=i(10368),t=i(1951),o=i(2088),m=i(31),k=i(23),u=Object(m.e)(a.a,"getFolderDataClone",(function(e){var n,i,a,m,u;n=e.folderId,i=Object(t.n)().get(n),a="SharedMailbox"===(null==i?void 0:i.mailboxInfo.type),m=Object(o.b)(n),u=a?"CountsAndPermissions":"Counts",Object(l.a)(n,u,m).then((function(e){e&&(Object(d.a)(e.UnreadCount,e.TotalCount,n,!1),a&&t.O.import().then((function(i){i(n,e.PermissionSet.Permissions)})))})).catch((function(e){k.g.warn("GetFolderDataOrchestrator: "+e)}))}));i.d(n,"getFolderDataOrchestrator",(function(){return u}))},6614:function(e,n,i){"use strict";i.d(n,"a",(function(){return a}));var a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"MailFolderPermissionsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MailFolderPermissions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"PermissionSet"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"PermissionLevel"}},{kind:"Field",name:{kind:"Name",value:"ReadItems"}},{kind:"Field",name:{kind:"Name",value:"UserId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"PrimarySmtpAddress"}},{kind:"Field",name:{kind:"Name",value:"DisplayName"}},{kind:"Field",name:{kind:"Name",value:"DistinguishedUser"}}]}},{kind:"Field",name:{kind:"Name",value:"CanCreateItems"}},{kind:"Field",name:{kind:"Name",value:"CanCreateSubFolders"}},{kind:"Field",name:{kind:"Name",value:"IsFolderOwner"}},{kind:"Field",name:{kind:"Name",value:"IsFolderVisible"}},{kind:"Field",name:{kind:"Name",value:"IsFolderContact"}},{kind:"Field",name:{kind:"Name",value:"EditItems"}},{kind:"Field",name:{kind:"Name",value:"DeleteItems"}}]}}]}}]}}]}}}]);
//# sourceMappingURL=owa.FolderOrchestration.js.map
self.scriptsLoaded['owa.FolderOrchestration.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FolderOrchestration.js'] = (new Date()).getTime();