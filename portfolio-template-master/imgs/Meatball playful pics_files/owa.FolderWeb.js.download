self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FolderWeb.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[461,463],{12237:function(e,r,n){"use strict";n.r(r);var t=n(1),o=n(2901),i=n(979),d=n(2028),u=n(419),l=n(613),a=n(3257),s=n(3468),c=n(3522),f=n(180);function v(e,r,n,o,i){return Object(t.c)(this,void 0,void 0,(function(){return Object(t.f)(this,(function(t){return[2,Object(c.a)({Header:Object(f.b)(),Body:Object(s.a)({FolderShape:Object(a.a)({BaseShape:"IdOnly",AdditionalProperties:e}),ShapeName:n,FolderIds:r.map((function(e){return Object(l.a)({Id:e})}))})},Object(u.a)(o,i)).then((function(e){var r,n;return null===(n=null===(r=e.Body)||void 0===r?void 0:r.ResponseMessages)||void 0===n?void 0:n.Items}))]}))}))}n.d(r,"foldersWeb",(function(){return p}));var p=function(e,r,n,u){return Object(t.c)(void 0,void 0,void 0,(function(){var e,u,l,a,s,c;return Object(t.f)(this,(function(t){switch(t.label){case 0:return e=[],(null===(s=r.options)||void 0===s?void 0:s.additionalProperties)?(e=r.options.additionalProperties.map((function(e){return Object(i.a)({FieldURI:e})}))).push(Object(i.a)({FieldURI:"ParentFolderId"})):u="Folder",[4,v(e,r.ids,u,null===(c=r.options)||void 0===c?void 0:c.mailboxInfo,n.requestOptions)];case 1:return l=t.sent(),[4,Object(d.a)(l)];case 2:if(t.sent(),a=[],l.forEach((function(e){var n;null===(n=e.Folders)||void 0===n||n.forEach((function(e){var n=Object(o.c)(e,r.options.mailboxInfo);n&&a.push(n)}))})),0===a.length)throw new Error("foldersWeb: failed to get folders");return[2,a]}}))}))}},18023:function(e,r,n){"use strict";n.r(r),n.d(r,"folderWeb",(function(){return i}));var t=n(1),o=n(12237),i=function(e,r,n,i){return Object(t.c)(void 0,void 0,void 0,(function(){var d;return Object(t.f)(this,(function(t){switch(t.label){case 0:return d={ids:[r.id],options:r.options},[4,Object(o.foldersWeb)(e,d,n,i)];case 1:return[2,t.sent()[0]]}}))}))}},1959:function(e,r,n){"use strict";n.d(r,"f",(function(){return t})),n.d(r,"d",(function(){return o})),n.d(r,"j",(function(){return i})),n.d(r,"a",(function(){return d})),n.d(r,"g",(function(){return u})),n.d(r,"b",(function(){return l})),n.d(r,"h",(function(){return a})),n.d(r,"l",(function(){return s})),n.d(r,"k",(function(){return c})),n.d(r,"i",(function(){return f})),n.d(r,"c",(function(){return v})),n.d(r,"e",(function(){return p}));var t=["journal","outbox","syncissues"],o="archivemsgfolderroot",i="msgfolderroot",d="archivedeleteditems",u="deleteditems",l="archiverecoverableitemsdeletions",a="recoverableitemsdeletions",s="msgfolderroot",c="sharedFolderTree",f="primaryFolderTree",v="archiveFolderTree",p="favorites"},2028:function(e,r,n){"use strict";n.d(r,"a",(function(){return d}));var t=n(1),o=n(2032),i=n(2033);function d(e){var r,n;if(!e)return Promise.reject(Object(o.a)("500","Server returned a null response!",null));var d=Array.isArray(e)?e:[e];try{for(var u=Object(t.k)(d),l=u.next();!l.done;l=u.next()){var a=l.value;if(a&&!Object(i.a)(a))return Promise.reject(Object(o.a)(a.ResponseCode,a.StackTrace,a.MessageText))}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}return Promise.resolve()}},2032:function(e,r,n){"use strict";function t(e,r,n){var t="ResponseCode="+e;r&&(t+=", Stacktrace="+r);var o=new Error(t);return o.responseCode=e,o.fetchErrorType="ServerFailure",n&&(o.diagnosticInfo="MessageText= "+n),o}n.d(r,"a",(function(){return t}))},2033:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t="Success";function o(e){return e&&e.ResponseClass==t}},2901:function(e,r,n){"use strict";var t=function(e,r){var n,t;if(e.ExtendedProperty)for(var o=0;o<e.ExtendedProperty.length;o++){var i=e.ExtendedProperty[o];if((null===(n=null==i?void 0:i.ExtendedFieldURI)||void 0===n?void 0:n.PropertyTag)===r||(null===(t=null==i?void 0:i.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===r)return i.Value}},o=function(e){var r=t(e,"SourceWellKnownFolderType");return r&&parseInt(r,10)||-1},i=function(e){return t(e,"0x7018")||null},d=function(e){return"false"!==t(e,"0x10f4")},u=n(1959),l=n(23);function a(e,r,n,t,o,i,l){var a,c=e.RootFolder;if(!c||!c.Folders||!c.ParentFolder)throw new Error("folderHierarchyWeb: failed to get folders");var f=[];null==c||c.Folders.forEach((function(e){if(e&&function(e,r,n){if(t=null==e?void 0:e.__type,"Folder:#Exchange"!=t)return!1;var t;if((null==e?void 0:e.DistinguishedFolderId)&&u.f.indexOf(e.DistinguishedFolderId)>=0)return!1;if(d(e))return!1;if("clutter"===e.DistinguishedFolderId&&0===e.TotalCount)return!1;if("junkemail"===e.DistinguishedFolderId)return!!r;if("notes"===e.DistinguishedFolderId)return!!n;return!0}(e,t,o)){var n=s(e,r);if(n&&(f.push(n),null==l?void 0:l[n.FolderId.Id])){var i=l[n.FolderId.Id];n.ReplicaList=i,n.mailboxInfo.auxiliaryMailboxGuid=i[0]}}}));var v=function(e,r){return"SharedMailbox"===r?void 0:e}((null===(a=null==c?void 0:c.ParentFolder)||void 0===a?void 0:a.DistinguishedFolderId)||"none",r.type);c.ParentFolder.DistinguishedFolderId=v;var p=s(c.ParentFolder,r);return i&&function(e,r,n){if(e){var t={},o={},i=[];t[e.FolderId.Id]=e,i.push(e.FolderId.Id),r.forEach((function(e){e&&(t[e.FolderId.Id]=e,i.push(e.FolderId.Id))})),i.forEach((function(e){var r,n=t[e],i=null===(r=n.ParentFolderId)||void 0===r?void 0:r.Id;n.DistinguishedFolderId&&(o[n.DistinguishedFolderId]=e);var d=i&&t[i];d&&d.childFolderIds.push(e)}));var d=[];n.forEach((function(e){var r=o[e];r&&d.push(r)}));for(var u=e.childFolderIds||[],l=0;l<u.length;l++){var a=u[l]||null;a&&-1==d.indexOf(a)&&d.push(a)}e.childFolderIds=d}}(p,f,n),{__typename:"FolderHierarchyResult",Folders:f,RootFolder:p,IndexedPagingOffset:c.IndexedPagingOffset,TotalItemsInView:c.TotalItemsInView,IncludesLastItemInRange:c.IncludesLastItemInRange}}function s(e,r){var n=e,t=n.FolderId,d=n.ParentFolderId,u=n.DisplayName,a=n.ArchiveTag,s=n.PolicyTag,p=n.ChildFolderCount,I=n.UnreadCount,h=n.TotalCount,F=n.FolderClass,b=n.DistinguishedFolderId;if(!t||!d)return l.g.warn("mapOWSFolderToGql: ignoring folder with missing folderId or missing parentFolderId"),null;var y=p||0,g=f(t);return{id:g.Id,__typename:"MailFolder",type:n.__type,FolderId:g,ParentFolderId:f(d),DisplayName:u||"",DistinguishedFolderId:b||null,FolderClass:F||"IPF.Note",UnreadCount:I||0,TotalCount:h||0,ArchiveTag:a?v(a):null,PolicyTag:s?v(s):null,hasChildren:y>0,remoteFolderDisplayName:i(n),sourceWellKnownFolderType:o(n),ReplicaList:n.ReplicaList,PermissionSet:n.PermissionSet,size:c(n),childFolderIds:[],pausedTotalCount:null,principalSMTPAddress:null,mailboxInfo:{type:r.type,userIdentity:r.userIdentity,mailboxSmtpAddress:r.mailboxSmtpAddress,auxiliaryMailboxGuid:r.auxiliaryMailboxGuid}}}function c(e){var r,n;return null===(n=null===(r=e.ExtendedProperty)||void 0===r?void 0:r[0])||void 0===n?void 0:n.Value}function f(e){return{__typename:"FolderId",Id:e.Id,ChangeKey:e.ChangeKey}}function v(e){return{__typename:"RetentionTagType",IsExplicit:e.IsExplicit,Value:e.Value}}n.d(r,"a",(function(){return o})),n.d(r,"b",(function(){return a})),n.d(r,"c",(function(){return s}))},3257:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(1);function o(e){return Object(t.a)({__type:"FolderResponseShape:#Exchange"},e)}},3468:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(1);function o(e){return Object(t.a)({__type:"GetFolderRequest:#Exchange"},e)}},3522:function(e,r,n){"use strict";var t=n(33),o=n(1);function i(e,r){var n;return void 0===e||e.__type||(n=e,e=Object(o.a)({__type:"GetFolderJsonRequest:#Exchange"},n)),Object(t.a)("GetFolder",e,r)}n.d(r,"a",(function(){return i}))},419:function(e,r,n){"use strict";var t=n(1);function o(e,r){return e?Object(t.a)({mailboxInfo:e},r):null!=r?r:void 0}n.d(r,"a",(function(){return o}))},613:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(1);function o(e){return Object(t.a)({__type:"FolderId:#Exchange"},e)}},979:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(1);function o(e){return Object(t.a)({__type:"PropertyUri:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.FolderWeb.js.map
self.scriptsLoaded['owa.FolderWeb.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FolderWeb.js'] = (new Date()).getTime();