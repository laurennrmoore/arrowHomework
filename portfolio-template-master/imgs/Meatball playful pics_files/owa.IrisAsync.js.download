self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.IrisAsync.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[491],{12172:function(e,t,i){"use strict";i.r(t);var r=i(1),n=i(2),o=Object(n.createStore)("LeftNavIrisState",{message:"",userRedirectionUrl:"",textColor:"",iconUri:"",trackingBaseUri:"",impressionBaseUri:""})(),a=Object(n.mutatorAction)("setLeftNavIrisState",(function(e){var t,i,r=null==e?void 0:e.ad;r&&(o.message=r.body,o.iconUri=r.icon,o.textColor=r.textColor,o.userRedirectionUrl=r.ctaUrl,o.trackingBaseUri=null===(t=e.tracking)||void 0===t?void 0:t.baseUri,o.impressionBaseUri=null===(i=e.prm)||void 0===i?void 0:i._imp)})),s=i(440),c=i(217),u=i(57),l=i(6),d=i(121),f="https://arc.msn.com/v4/api/selection?placement={0}&puid={1}&country={2}&locale={3}&nct=1{4}",v="service::ads.arcct.msn.com::MBI_SSL";function p(e,t){var i;return void 0===t&&(t=""),Object(r.c)(this,void 0,void 0,(function(){var n,o,a,c,d,p;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=new Headers,[4,Object(s.getDelegationTokenForOwa)(v)];case 1:return o=r.sent(),n.append("authorization","WLID1.1 t="+o),a={method:"GET",headers:n},c=Object(u.j)(),d="",c&&(d=c.split("-").pop()),p=null===(i=Object(u.h)().SessionSettings)||void 0===i?void 0:i.UserPuid,[2,Promise.race([fetch(Object(l.c)(f,e,p,d,c,t),a).then(b),new Promise((function(e,t){setTimeout((function(){return t()}),2e3)}))])]}}))}))}function h(e,t){var i=e.replace(new RegExp("{ACTION}"),t);fetch(i,{method:"GET"}).then(b)}function m(e){fetch(e,{method:"GET"}).then(b)}var b=function(e){return Object(c.a)(e.status)||Object(d.q)("Failed to make iris api call with response "+e.status+e.statusText),e.json()},O=i(24),x="88000363",j="88000364";function w(){return Object(r.c)(this,void 0,void 0,(function(){var e;return Object(r.f)(this,(function(t){switch(t.label){case 0:return[4,p(Object(O.i)("auth-EnableIrisTestCampaign")?x:j)];case 1:return(e=t.sent())&&a(e),[2]}}))}))}var S,N,U,g=Object(n.createStore)("UpsellBizBarState",{message:"",userRedirectionText:"",userRedirectionUrl:"",textColor:"",backgroundColor:"",urlTextColor:"",iconUri:"",trackingBaseUri:"",impressionBaseUri:""})(),C=Object(n.mutatorAction)("setBizBarUpsellState",(function(e){var t,i,r=null==e?void 0:e.ad;r&&(g.message=r.bodyText,g.userRedirectionText=r.ctaText,g.textColor=r.bodyTextColor,g.urlTextColor=r.ctaTextColor,g.backgroundColor=r.backgroundColor,g.userRedirectionUrl=r.ctaUrl,g.trackingBaseUri=null===(t=e.tracking)||void 0===t?void 0:t.baseUri,g.impressionBaseUri=null===(i=e.prm)||void 0===i?void 0:i._imp)})),T=i(67),k="88000453",I="88000452",B=Object(T.c)(),E=((S={}).Edge="1",S.Chrome="2",S.MSIE="3",S.Firefox="4",S.Safari="5",S["Edge Anaheim"]="6",S.Opera="7",S.Electron="8",S.SkypeShell="9",S.PhantomJS="10",S),y=((N={}).XP="WINXP",N[7]="WIN7",N[8]="WIN8",N[8.1]="WIN81",N[10]="WIN10",N),z=((U={})["Chromium OS"]="CHROMIUMOS",U.iOS="IOS",U.Android="ANDROID",U.Linux="LINUX",U["Mac OS X"]="MAC",U.Windows=y[B.osVersion]||"WIN",U);function A(){return Object(r.c)(this,void 0,void 0,(function(){var e,t,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return Object(O.i)("edge-iris-upsell-experiment")?(e=Object(O.i)("edge-iris-upsell-testExperiment")?k:I,t="&OPSYS="+(z[B.os]||"UNKNOWN")+"&browser="+(E[Object(T.a)().browser]||"11"),[4,p(e,t)]):[3,2];case 1:(i=r.sent())&&C(i),r.label=2;case 2:return[2]}}))}))}i.d(t,"initializeLeftNavUpsellState",(function(){return w})),i.d(t,"makeBeaconCall",(function(){return h})),i.d(t,"makeImpressionCall",(function(){return m})),i.d(t,"initializeUpsellBarState",(function(){return A})),i.d(t,"ArcStore",(function(){return o})),i.d(t,"BizBarArcStore",(function(){return g}))},186:function(e,t,i){"use strict";function r(){var e=Object.create(null),t=0,i=0,r=0,n=!1;function o(t){r--,delete e[t]}this.put=function(t,i,n,a){if(void 0!==n&&("number"!=typeof n||isNaN(n)||n<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var s=e[t];s?clearTimeout(s.timeout):r++;var c={value:i,expire:n+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){o(t),a&&a(t,i)}.bind(this),n)),e[t]=c,i},this.del=function(t){var i=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(i=!1)):i=!1,i&&o(t),i},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),n&&(t=0,i=0)},this.get=function(o){var a=e[o];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return n&&t++,a.value;n&&i++,r--,delete e[o]}else n&&i++;return null},this.size=function(){return r},this.memsize=function(){var t,i=0;for(t in e)i++;return i},this.debug=function(e){n=e},this.hits=function(){return t},this.misses=function(){return i},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var i in e){var r=e[i];t[i]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,i){var r=JSON.parse(t),n=Date.now(),o=i&&i.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(o)if(e[a])continue;var s=r[a],c=s.expire-n;if(c<=0){this.del(a);continue}c=c>0?c:void 0,this.put(a,s.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},326:function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return a}));var r,n=i(1);function o(e){r=e}function a(){var e,t;return Object(n.c)(this,void 0,void 0,(function(){var i,o;return Object(n.f)(this,(function(n){switch(n.label){case 0:return(o=r)?[4,r()]:[3,2];case 1:o=n.sent(),n.label=2;case 2:if((i=o)&&i.length>0){if("bearer"===(null===(e=null==i?void 0:i.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,i.split(" ")[1]];if("msauth1.0"===(null===(t=null==i?void 0:i.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,i]}return[2,void 0]}}))}))}}}]);
//# sourceMappingURL=owa.IrisAsync.js.map
self.scriptsLoaded['owa.IrisAsync.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.IrisAsync.js'] = (new Date()).getTime();