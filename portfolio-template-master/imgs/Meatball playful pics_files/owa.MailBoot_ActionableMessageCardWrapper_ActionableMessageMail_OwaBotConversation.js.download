self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ActionableMessageCardWrapper~ActionableMessageMail~OwaBotConversation.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[164],{10126:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(7633),r=i(8361);function o(t,e){return t||e}function s(t){return null==t||""===t}function a(t,e,i){if(s(e))return i;for(var n in t){if(parseInt(n,10)>=0){var r=t[n];if(r&&"string"==typeof r&&r.toLowerCase()===e.toLowerCase())return parseInt(n,10)}}return i}function l(t){var e=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(t);if(e&&e[4]){var i=parseInt(e[1],16)/255;return"rgba("+parseInt(e[2],16)+","+parseInt(e[3],16)+","+parseInt(e[4],16)+","+i+")"}return t}function u(t,e){for(e+=1;e<t.length&&"<"==t[e];)for(;e<t.length&&">"!=t[e++];);return e}e.generateUniqueId=function(){return"__ac-"+r.UUID.generate()},e.getStringValue=function(t,e){return void 0===e&&(e=void 0),t?t.toString():e},e.getValueOrDefault=o,e.isNullOrEmpty=s,e.appendChild=function(t,e){null!=e&&null!=e&&t.appendChild(e)},e.setProperty=function(t,e,i,n){void 0===n&&(n=void 0),null==i||i===n?delete t[e]:t[e]=i},e.setEnumProperty=function(t,e,i,n,r){void 0===r&&(r=void 0);var o=e[i],s=null==o||void 0!==t[o];n==r?s&&delete e[i]:null==n?s&&delete e[i]:e[i]=t[n]},e.getBoolValue=function(t,e){if("boolean"==typeof t)return t;if("string"==typeof t)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;default:return e}return e},e.getEnumValue=a,e.parseHostConfigEnum=function(t,e,i){return"string"==typeof e?a(t,e,i):"number"==typeof e?o(e,i):i},e.renderSeparation=function(t,e,i){if(e.spacing>0||e.lineThickness>0){var r=document.createElement("div");return r.className=t.makeCssClassName("ac-"+(i==n.Orientation.Horizontal?"horizontal":"vertical")+"-separator"),i==n.Orientation.Horizontal?e.lineThickness?(r.style.paddingTop=e.spacing/2+"px",r.style.marginBottom=e.spacing/2+"px",r.style.borderBottom=e.lineThickness+"px solid "+l(e.lineColor)):r.style.height=e.spacing+"px":e.lineThickness?(r.style.paddingLeft=e.spacing/2+"px",r.style.marginRight=e.spacing/2+"px",r.style.borderRight=e.lineThickness+"px solid "+l(e.lineColor)):r.style.width=e.spacing+"px",r.style.overflow="hidden",r}return null},e.stringToCssColor=l,e.truncate=function(t,e,i){var n=function(){return e-t.scrollHeight>=-1};if(!n()){for(var r=t.innerHTML,o=function(e){t.innerHTML=r.substring(0,e)+"..."},s=function(t){var e=[],i=u(t,-1);for(;i<t.length;)" "==t[i]&&e.push(i),i=u(t,i);return e}(r),a=0,l=s.length,p=0;a<l;){var c=Math.floor((a+l)/2);o(s[c]),n()?(p=s[c],a=c+1):l=c}if(o(p),i&&e-t.scrollHeight>=i-1){for(var h=u(r,p);h<r.length&&(o(h),n());)p=h,h=u(r,h);o(p)}}},e.getFitStatus=function(t,e){var i=t.offsetTop;return i+t.clientHeight<=e?n.ContainerFitStatus.FullyInContainer:i<e?n.ContainerFitStatus.Overflowing:n.ContainerFitStatus.FullyOutOfContainer}},11968:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CardObjectRegistry=void 0;var n=i(6721),r=function(){function t(){this._items={}}return t.prototype.findByName=function(t){return this._items.hasOwnProperty(t)?this._items[t]:void 0},t.prototype.clear=function(){this._items={}},t.prototype.register=function(t,e,i){void 0===i&&(i=n.Versions.v1_0);var r=this.findByName(t);void 0!==r?r.objectType=e:r={typeName:t,objectType:e,schemaVersion:i},this._items[t]=r},t.prototype.unregister=function(t){delete this._items[t]},t.prototype.createInstance=function(t,e){var i=this.findByName(t);return i&&i.schemaVersion.compareTo(e)<=0?new i.objectType:void 0},t.prototype.getItemCount=function(){return Object.keys(this._items).length},t.prototype.getItemAt=function(t){var e=this;return Object.keys(this._items).map((function(t){return e._items[t]}))[t]},t}();e.CardObjectRegistry=r},11969:function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(e,"__esModule",{value:!0}),e.CardObject=e.ValidationResults=void 0;var s=i(5699),a=i(7632),l=i(6286),u=i(11970),p=i(6721),c=function(){function t(){this.allIds={},this.validationEvents=[]}return t.prototype.addFailure=function(t,e,i){this.validationEvents.push({phase:s.ValidationPhase.Validation,source:t,event:e,message:i})},t}();e.ValidationResults=c;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._shouldFallback=!1,e}return r(e,t),e.prototype.getSchemaKey=function(){return this.getJsonTypeName()},Object.defineProperty(e.prototype,"requires",{get:function(){return this.getValue(e.requiresProperty)},enumerable:!1,configurable:!0}),e.prototype.contains=function(t){return!!this._renderedElement&&this._renderedElement.contains(t)},e.prototype.preProcessPropertyValue=function(t,e){var i=void 0===e?this.getValue(t):e;if(l.GlobalSettings.allowPreProcessingPropertyValues){for(var n=this;n&&!n.onPreProcessPropertyValue;)n=n.parent;if(n&&n.onPreProcessPropertyValue)return n.onPreProcessPropertyValue(this,t,i)}return i},e.prototype.setParent=function(t){this._parent=t},e.prototype.setShouldFallback=function(t){this._shouldFallback=t},e.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)},e.prototype.getRootObject=function(){for(var t=this;t.parent;)t=t.parent;return t},e.prototype.internalValidateProperties=function(t){this.id&&(t.allIds.hasOwnProperty(this.id)?(1==t.allIds[this.id]&&t.addFailure(this,s.ValidationEvent.DuplicateId,a.Strings.errors.duplicateId(this.id)),t.allIds[this.id]+=1):t.allIds[this.id]=1)},e.prototype.validateProperties=function(){var t=new c;return this.internalValidateProperties(t),t},e.prototype.findDOMNodeOwner=function(t){return this.contains(t)?this:void 0},Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!1,configurable:!0}),e.typeNameProperty=new p.StringProperty(p.Versions.v1_0,"type",void 0,void 0,void 0,(function(t){return t.getJsonTypeName()})),e.idProperty=new p.StringProperty(p.Versions.v1_0,"id"),e.requiresProperty=new p.SerializableObjectProperty(p.Versions.v1_2,"requires",u.HostCapabilities,!1,new u.HostCapabilities),o([p.property(e.idProperty)],e.prototype,"id",void 0),o([p.property(e.requiresProperty)],e.prototype,"requires",null),e}(p.SerializableObject);e.CardObject=h},11970:function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.HostCapabilities=void 0;var o=i(6721),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._capabilities={},e}return r(e,t),e.prototype.getSchemaKey=function(){return"HostCapabilities"},e.prototype.internalParse=function(e,i){if(t.prototype.internalParse.call(this,e,i),e)for(var n in e){var r=e[n];if("string"==typeof r)if("*"==r)this.addCapability(n,"*");else{var s=o.Version.parse(r,i);s&&s.isValid&&this.addCapability(n,s)}}},e.prototype.internalToJSON=function(e,i){for(var n in t.prototype.internalToJSON.call(this,e,i),this._capabilities)e[n]=this._capabilities[n]},e.prototype.addCapability=function(t,e){this._capabilities[t]=e},e.prototype.removeCapability=function(t){delete this._capabilities[t]},e.prototype.clear=function(){this._capabilities={}},e.prototype.hasCapability=function(t,e){return!!this._capabilities.hasOwnProperty(t)&&("*"==e||"*"==this._capabilities[t]||e.compareTo(this._capabilities[t])<=0)},e.prototype.areAllMet=function(t){for(var e in this._capabilities)if(!t.hasCapability(e,this._capabilities[e]))return!1;return!0},e}(o.SerializableObject);e.HostCapabilities=s},11971:function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(e,"__esModule",{value:!0}),e.SerializationContext=e.GlobalRegistry=e.AdaptiveCard=e.Authentication=e.TokenExchangeResource=e.AuthCardButton=e.RefreshDefinition=e.RefreshActionProperty=e.ContainerWithActions=e.ColumnSet=e.Column=e.Container=e.BackgroundImage=e.StylableCardElementContainer=e.ActionSet=e.ShowCardAction=e.HttpAction=e.HttpHeader=e.ToggleVisibilityAction=e.OpenUrlAction=e.ExecuteAction=e.SubmitAction=e.SubmitActionBase=e.Action=e.TimeInput=e.TimeProperty=e.DateInput=e.NumberInput=e.ChoiceSetInput=e.Choice=e.ToggleInput=e.TextInput=e.Input=e.Media=e.MediaSource=e.ImageSet=e.CardElementContainer=e.Image=e.FactSet=e.Fact=e.RichTextBlock=e.TextRun=e.TextBlock=e.BaseTextBlock=e.ActionProperty=e.CardElement=void 0;var s=i(5699),a=i(6286),l=i(7631),u=i(11972),p=i(16980),c=i(11969),h=i(6721),d=i(11968),f=i(7632),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._truncatedDueToOverflow=!1,e}return r(e,t),Object.defineProperty(e.prototype,"lang",{get:function(){var t=this.getValue(e.langProperty);return t||(this.parent?this.parent.lang:void 0)},set:function(t){this.setValue(e.langProperty,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return this.getValue(e.isVisibleProperty)},set:function(t){a.GlobalSettings.useAdvancedCardBottomTruncation&&!t&&this.undoOverflowTruncation(),this.isVisible!==t&&(this.setValue(e.isVisibleProperty,t),this.updateRenderedElementVisibility(),this._renderedElement&&ot(this)),this._renderedElement&&this._renderedElement.setAttribute("aria-expanded",t.toString())},enumerable:!1,configurable:!0}),e.prototype.internalRenderSeparator=function(){var t=l.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:void 0,lineColor:this.separator?this.hostConfig.separator.lineColor:void 0},this.separatorOrientation);if(a.GlobalSettings.alwaysBleedSeparators&&t&&this.separatorOrientation==s.Orientation.Horizontal){var e=this.getParentContainer();if(e&&e.getEffectivePadding()){var i=this.hostConfig.paddingDefinitionToSpacingDefinition(e.getEffectivePadding());t.style.marginLeft="-"+i.left+"px",t.style.marginRight="-"+i.right+"px"}}return t},e.prototype.updateRenderedElementVisibility=function(){var t=this.isDesignMode()||this.isVisible?this._defaultRenderedElementDisplayMode:"none";this._renderedElement&&(t?this._renderedElement.style.display=t:this._renderedElement.style.removeProperty("display")),this._separatorElement&&(this.parent&&this.parent.isFirstElement(this)?this._separatorElement.style.display="none":t?this._separatorElement.style.display=t:this._separatorElement.style.removeProperty("display"))},e.prototype.hideElementDueToOverflow=function(){this._renderedElement&&this.isVisible&&(this._renderedElement.style.visibility="hidden",this.isVisible=!1,ot(this,!1))},e.prototype.showElementHiddenDueToOverflow=function(){this._renderedElement&&!this.isVisible&&(this._renderedElement.style.removeProperty("visibility"),this.isVisible=!0,ot(this,!1))},e.prototype.handleOverflow=function(t){if(this.isVisible||this.isHiddenDueToOverflow()){var e=this.truncateOverflow(t);this._truncatedDueToOverflow=e||this._truncatedDueToOverflow,e?e&&!this.isVisible&&this.showElementHiddenDueToOverflow():this.hideElementDueToOverflow()}},e.prototype.resetOverflow=function(){var t=!1;return this._truncatedDueToOverflow&&(this.undoOverflowTruncation(),this._truncatedDueToOverflow=!1,t=!0),this.isHiddenDueToOverflow()&&this.showElementHiddenDueToOverflow(),t},e.prototype.getDefaultSerializationContext=function(){return new yt},e.prototype.createPlaceholderElement=function(){var t=this.getEffectiveStyleDefinition(),e=l.stringToCssColor(t.foregroundColors.default.subtle),i=document.createElement("div");return i.style.border="1px dashed "+e,i.style.padding="4px",i.style.minHeight="32px",i.style.fontSize="10px",i.style.color=e,i.innerText="Empty "+this.getJsonTypeName(),i},e.prototype.adjustRenderedElementSize=function(t){"auto"===this.height?t.style.flex="0 0 auto":t.style.flex="1 1 auto"},e.prototype.isDisplayed=function(){return void 0!==this._renderedElement&&this.isVisible&&this._renderedElement.offsetHeight>0},e.prototype.overrideInternalRender=function(){return this.internalRender()},e.prototype.applyPadding=function(){if(this.separatorElement&&this.separatorOrientation===s.Orientation.Horizontal)if(a.GlobalSettings.alwaysBleedSeparators&&!this.isBleeding()){var t=new a.PaddingDefinition;this.getImmediateSurroundingPadding(t);var e=this.hostConfig.paddingDefinitionToSpacingDefinition(t);this.separatorElement.style.marginLeft="-"+e.left+"px",this.separatorElement.style.marginRight="-"+e.right+"px"}else this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0"},e.prototype.truncateOverflow=function(t){return!1},e.prototype.undoOverflowTruncation=function(){},e.prototype.getDefaultPadding=function(){return new a.PaddingDefinition},e.prototype.getHasBackground=function(){return!1},e.prototype.getPadding=function(){return this._padding},e.prototype.setPadding=function(t){this._padding=t},e.prototype.shouldSerialize=function(t){return void 0!==t.elementRegistry.findByName(this.getJsonTypeName())},Object.defineProperty(e.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allowCustomPadding",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"separatorOrientation",{get:function(){return s.Orientation.Horizontal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultStyle",{get:function(){return s.ContainerStyle.Default},enumerable:!1,configurable:!0}),e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i||new yt)},e.prototype.asString=function(){return""},e.prototype.isBleeding=function(){return!1},e.prototype.getEffectiveStyle=function(){return this.parent?this.parent.getEffectiveStyle():this.defaultStyle},e.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())},e.prototype.getForbiddenActionTypes=function(){return[]},e.prototype.getImmediateSurroundingPadding=function(t,e,i,n,r){if(void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),this.parent){var o=e&&this.parent.isTopElement(this),a=i&&this.parent.isRightMostElement(this),l=n&&this.parent.isBottomElement(this),u=r&&this.parent.isLeftMostElement(this),p=this.parent.getEffectivePadding();p&&(o&&p.top!=s.Spacing.None&&(t.top=p.top,o=!1),a&&p.right!=s.Spacing.None&&(t.right=p.right,a=!1),l&&p.bottom!=s.Spacing.None&&(t.bottom=p.bottom,l=!1),u&&p.left!=s.Spacing.None&&(t.left=p.left,u=!1)),(o||a||l||u)&&this.parent.getImmediateSurroundingPadding(t,o,a,l,u)}},e.prototype.getActionCount=function(){return 0},e.prototype.getActionAt=function(t){throw new Error(f.Strings.errors.indexOutOfRange(t))},e.prototype.remove=function(){return!!(this.parent&&this.parent instanceof P)&&this.parent.removeItem(this)},e.prototype.render=function(){return this._renderedElement=this.overrideInternalRender(),this._separatorElement=this.internalRenderSeparator(),this._renderedElement?(this.id&&(this._renderedElement.id=this.id),this.customCssSelector&&this._renderedElement.classList.add(this.customCssSelector),this._renderedElement.style.boxSizing="border-box",this._defaultRenderedElementDisplayMode=this._renderedElement.style.display?this._renderedElement.style.display:void 0,this.adjustRenderedElementSize(this._renderedElement),this.updateLayout(!1)):this.isDesignMode()&&(this._renderedElement=this.createPlaceholderElement()),this._renderedElement},e.prototype.updateLayout=function(t){void 0===t&&(t=!0),this.updateRenderedElementVisibility(),this.applyPadding()},e.prototype.indexOf=function(t){return-1},e.prototype.isDesignMode=function(){var t=this.getRootElement();return t instanceof ht&&t.designMode},e.prototype.isFirstElement=function(t){return!0},e.prototype.isLastElement=function(t){return!0},e.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},e.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},e.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},e.prototype.isAtTheVeryBottom=function(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()},e.prototype.isBleedingAtTop=function(){return!1},e.prototype.isBleedingAtBottom=function(){return!1},e.prototype.isLeftMostElement=function(t){return!0},e.prototype.isRightMostElement=function(t){return!0},e.prototype.isTopElement=function(t){return this.isFirstElement(t)},e.prototype.isBottomElement=function(t){return this.isLastElement(t)},e.prototype.isHiddenDueToOverflow=function(){return void 0!==this._renderedElement&&"hidden"==this._renderedElement.style.visibility},e.prototype.getRootElement=function(){return this.getRootObject()},e.prototype.getParentContainer=function(){for(var t=this.parent;t;){if(t instanceof Q)return t;t=t.parent}},e.prototype.getAllInputs=function(t){return void 0===t&&(t=!0),[]},e.prototype.getResourceInformation=function(){return[]},e.prototype.getElementById=function(t){return this.id===t?this:void 0},e.prototype.getActionById=function(t){},e.prototype.getEffectivePadding=function(){var t=this.getPadding();return t&&this.allowCustomPadding?t:this.getDefaultPadding()},Object.defineProperty(e.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:u.defaultHostConfig},set:function(t){this._hostConfig=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.parent?this.parent.indexOf(this):0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInteractive",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isStandalone",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInline",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasVisibleSeparator",{get:function(){return!(!this.parent||!this.separatorElement)&&(!this.parent.isFirstElement(this)&&(this.isVisible||this.isDesignMode()))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"separatorElement",{get:function(){return this._separatorElement},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),e.langProperty=new h.StringProperty(h.Versions.v1_1,"lang",!0,/^[a-z]{2,3}$/gi),e.isVisibleProperty=new h.BoolProperty(h.Versions.v1_2,"isVisible",!0),e.separatorProperty=new h.BoolProperty(h.Versions.v1_0,"separator",!1),e.heightProperty=new h.ValueSetProperty(h.Versions.v1_1,"height",[{value:"auto"},{value:"stretch"}],"auto"),e.horizontalAlignmentProperty=new h.EnumProperty(h.Versions.v1_0,"horizontalAlignment",s.HorizontalAlignment,s.HorizontalAlignment.Left),e.spacingProperty=new h.EnumProperty(h.Versions.v1_0,"spacing",s.Spacing,s.Spacing.Default),o([h.property(e.horizontalAlignmentProperty)],e.prototype,"horizontalAlignment",void 0),o([h.property(e.spacingProperty)],e.prototype,"spacing",void 0),o([h.property(e.separatorProperty)],e.prototype,"separator",void 0),o([h.property(e.heightProperty)],e.prototype,"height",void 0),o([h.property(e.langProperty)],e.prototype,"lang",null),o([h.property(e.isVisibleProperty)],e.prototype,"isVisible",null),e}(c.CardObject);e.CardElement=y;var g=function(t){function e(e,i,n){void 0===n&&(n=[]);var r=t.call(this,e,i,void 0)||this;return r.targetVersion=e,r.name=i,r.forbiddenActionTypes=n,r}return r(e,t),e.prototype.parse=function(t,e,i){var n=t;return i.parseAction(n,e[this.name],this.forbiddenActionTypes,n.isDesignMode())},e.prototype.toJSON=function(t,e,i,n){n.serializeValue(e,this.name,i?i.toJSON(n):void 0,void 0,!0)},e}(h.PropertyDefinition);e.ActionProperty=g;var m=function(t){function e(e){var i=t.call(this)||this;return i.size=s.TextSize.Default,i.weight=s.TextWeight.Default,i.color=s.TextColor.Default,i.isSubtle=!1,i.ariaHidden=!1,e&&(i.text=e),i}return r(e,t),e.prototype.populateSchema=function(i){t.prototype.populateSchema.call(this,i),i.remove(e.selectActionProperty)},Object.defineProperty(e.prototype,"text",{get:function(){return this.getValue(e.textProperty)},set:function(t){this.setText(t)},enumerable:!1,configurable:!0}),e.prototype.getFontSize=function(t){switch(this.size){case s.TextSize.Small:return t.fontSizes.small;case s.TextSize.Medium:return t.fontSizes.medium;case s.TextSize.Large:return t.fontSizes.large;case s.TextSize.ExtraLarge:return t.fontSizes.extraLarge;default:return t.fontSizes.default}},e.prototype.getColorDefinition=function(t,e){switch(e){case s.TextColor.Accent:return t.accent;case s.TextColor.Dark:return t.dark;case s.TextColor.Light:return t.light;case s.TextColor.Good:return t.good;case s.TextColor.Warning:return t.warning;case s.TextColor.Attention:return t.attention;default:return t.default}},e.prototype.setText=function(t){this.setValue(e.textProperty,t)},e.prototype.init=function(t){this.size=t.size,this.weight=t.weight,this.color=t.color,this.isSubtle=t.isSubtle},e.prototype.asString=function(){return this.text},e.prototype.applyStylesTo=function(t){var e,i=this.hostConfig.getFontTypeDefinition(this.fontType);switch(i.fontFamily&&(t.style.fontFamily=i.fontFamily),this.size){case s.TextSize.Small:e=i.fontSizes.small;break;case s.TextSize.Medium:e=i.fontSizes.medium;break;case s.TextSize.Large:e=i.fontSizes.large;break;case s.TextSize.ExtraLarge:e=i.fontSizes.extraLarge;break;default:e=i.fontSizes.default}t.style.fontSize=e+"px";var n,r=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);switch(t.style.color=l.stringToCssColor(this.isSubtle?r.subtle:r.default),this.weight){case s.TextWeight.Lighter:n=i.fontWeights.lighter;break;case s.TextWeight.Bolder:n=i.fontWeights.bolder;break;default:n=i.fontWeights.default}t.style.fontWeight=n.toString(),this.ariaHidden&&t.setAttribute("aria-hidden","true")},Object.defineProperty(e.prototype,"effectiveColor",{get:function(){return this.color?this.color:s.TextColor.Default},enumerable:!1,configurable:!0}),e.textProperty=new h.StringProperty(h.Versions.v1_0,"text",!0),e.sizeProperty=new h.EnumProperty(h.Versions.v1_0,"size",s.TextSize,s.TextSize.Default),e.weightProperty=new h.EnumProperty(h.Versions.v1_0,"weight",s.TextWeight,s.TextWeight.Default),e.colorProperty=new h.EnumProperty(h.Versions.v1_0,"color",s.TextColor,s.TextColor.Default),e.isSubtleProperty=new h.BoolProperty(h.Versions.v1_0,"isSubtle",!1),e.fontTypeProperty=new h.EnumProperty(h.Versions.v1_2,"fontType",s.FontType),e.selectActionProperty=new g(h.Versions.v1_1,"selectAction",["Action.ShowCard"]),o([h.property(e.sizeProperty)],e.prototype,"size",void 0),o([h.property(e.weightProperty)],e.prototype,"weight",void 0),o([h.property(e.colorProperty)],e.prototype,"color",void 0),o([h.property(e.fontTypeProperty)],e.prototype,"fontType",void 0),o([h.property(e.isSubtleProperty)],e.prototype,"isSubtle",void 0),o([h.property(e.textProperty)],e.prototype,"text",null),o([h.property(e.selectActionProperty)],e.prototype,"selectAction",void 0),e}(y);e.BaseTextBlock=m;var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.wrap=!1,e._treatAsPlainText=!0,e.useMarkdown=!0,e}return r(e,t),e.prototype.restoreOriginalContent=function(){void 0!==this.renderedElement&&(this.maxLines&&this.maxLines>0&&(this.renderedElement.style.maxHeight=this._computedLineHeight*this.maxLines+"px"),this.renderedElement.innerHTML=this._originalInnerHtml)},e.prototype.truncateIfSupported=function(t){if(void 0!==this.renderedElement){var e=this.renderedElement.children,i=!e.length;if(i||1==e.length&&"p"==e[0].tagName.toLowerCase()){var n=i?this.renderedElement:e[0];return l.truncate(n,t,this._computedLineHeight),!0}}return!1},e.prototype.setText=function(e){t.prototype.setText.call(this,e),this._processedText=void 0},e.prototype.internalRender=function(){var t=this;if(this._processedText=void 0,this.text){var e=this.preProcessPropertyValue(m.textProperty),i=this.hostConfig,n=void 0;if(this.forElementId){var r=document.createElement("label");r.htmlFor=this.forElementId,n=r}else n=document.createElement("div");if(n.classList.add(i.makeCssClassName("ac-textBlock")),n.style.overflow="hidden",this.applyStylesTo(n),this.selectAction&&(n.onclick=function(e){e.preventDefault(),e.cancelBubble=!0,t.selectAction&&t.selectAction.execute()},i.supportsInteractivity&&(n.tabIndex=0,n.setAttribute("role",this.selectAction.getAriaRole()),this.selectAction.title&&(n.setAttribute("aria-label",this.selectAction.title),n.title=this.selectAction.title),n.classList.add(i.makeCssClassName("ac-selectable")))),!this._processedText){this._treatAsPlainText=!0;var o=p.formatText(this.lang,e);if(this.useMarkdown&&o){a.GlobalSettings.allowMarkForTextHighlighting&&(o=o.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/==/"));var s=ht.applyMarkdown(o);if(s.didProcess&&s.outputHtml){if(this._processedText=s.outputHtml,this._treatAsPlainText=!1,a.GlobalSettings.allowMarkForTextHighlighting&&this._processedText){var u="",c=this.getEffectiveStyleDefinition();c.highlightBackgroundColor&&(u+="background-color: "+c.highlightBackgroundColor+";"),c.highlightForegroundColor&&(u+="color: "+c.highlightForegroundColor+";"),u&&(u='style="'+u+'"'),this._processedText=this._processedText.replace(/===/g,"<mark "+u+">").replace(/\/==\//g,"</mark>")}}else this._processedText=o,this._treatAsPlainText=!0}else this._processedText=o,this._treatAsPlainText=!0}if(this._processedText||(this._processedText=""),this._treatAsPlainText?n.innerText=this._processedText:n.innerHTML=this._processedText,n.firstElementChild instanceof HTMLElement){var h=n.firstElementChild;h.style.marginTop="0px",h.style.width="100%",this.wrap||(h.style.overflow="hidden",h.style.textOverflow="ellipsis")}n.lastElementChild instanceof HTMLElement&&(n.lastElementChild.style.marginBottom="0px");for(var d=n.getElementsByTagName("a"),f=0;f<d.length;f++){var y=d[f];y.classList.add(i.makeCssClassName("ac-anchor")),y.target="_blank",y.onclick=function(e){nt(t,e.target,e)&&(e.preventDefault(),e.cancelBubble=!0)},y.oncontextmenu=function(e){return!nt(t,e.target,e)||(e.preventDefault(),e.cancelBubble=!0,!1)}}return this.wrap?(n.style.wordWrap="break-word",this.maxLines&&this.maxLines>0&&(n.style.overflow="hidden",l.isInternetExplorer()||!a.GlobalSettings.useWebkitLineClamp?n.style.maxHeight=this._computedLineHeight*this.maxLines+"px":(n.style.removeProperty("line-height"),n.style.display="-webkit-box",n.style.webkitBoxOrient="vertical",n.style.webkitLineClamp=this.maxLines.toString()))):(n.style.whiteSpace="nowrap",n.style.textOverflow="ellipsis"),(a.GlobalSettings.useAdvancedTextBlockTruncation||a.GlobalSettings.useAdvancedCardBottomTruncation)&&(this._originalInnerHtml=n.innerHTML),n}},e.prototype.truncateOverflow=function(t){return t>=this._computedLineHeight&&this.truncateIfSupported(t)},e.prototype.undoOverflowTruncation=function(){if(this.restoreOriginalContent(),a.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines){var t=this._computedLineHeight*this.maxLines;this.truncateIfSupported(t)}},e.prototype.applyStylesTo=function(e){t.prototype.applyStylesTo.call(this,e);var i=this.getParentContainer(),n=!!i&&i.isRtl();switch(this.horizontalAlignment){case s.HorizontalAlignment.Center:e.style.textAlign="center";break;case s.HorizontalAlignment.Right:e.style.textAlign=n?"left":"right";break;default:e.style.textAlign=n?"right":"left"}var r=this.hostConfig.lineHeights;if(r)switch(this.size){case s.TextSize.Small:this._computedLineHeight=r.small;break;case s.TextSize.Medium:this._computedLineHeight=r.medium;break;case s.TextSize.Large:this._computedLineHeight=r.large;break;case s.TextSize.ExtraLarge:this._computedLineHeight=r.extraLarge;break;default:this._computedLineHeight=r.default}else this._computedLineHeight=1.33*this.getFontSize(this.hostConfig.getFontTypeDefinition(this.fontType));e.style.lineHeight=this._computedLineHeight+"px"},e.prototype.getJsonTypeName=function(){return"TextBlock"},e.prototype.updateLayout=function(e){void 0===e&&(e=!1),t.prototype.updateLayout.call(this,e),a.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines&&this.isDisplayed()&&(this.restoreOriginalContent(),this.truncateIfSupported(this._computedLineHeight*this.maxLines))},e.wrapProperty=new h.BoolProperty(h.Versions.v1_0,"wrap",!1),e.maxLinesProperty=new h.NumProperty(h.Versions.v1_0,"maxLines"),o([h.property(e.wrapProperty)],e.prototype,"wrap",void 0),o([h.property(e.maxLinesProperty)],e.prototype,"maxLines",void 0),e}(m);e.TextBlock=v;var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.italic=!1,e.strikethrough=!1,e.highlight=!1,e.underline=!1,e}return r(e,t),e.prototype.populateSchema=function(e){t.prototype.populateSchema.call(this,e),e.add(m.selectActionProperty)},e.prototype.internalRender=function(){var t=this;if(this.text){var e=this.preProcessPropertyValue(m.textProperty),i=this.hostConfig,n=p.formatText(this.lang,e);n||(n="");var r=document.createElement("span");if(r.classList.add(i.makeCssClassName("ac-textRun")),this.applyStylesTo(r),this.selectAction&&i.supportsInteractivity){var o=document.createElement("a");o.classList.add(i.makeCssClassName("ac-anchor"));var s=this.selectAction.getHref();o.href=s||"",o.target="_blank",o.onclick=function(e){e.preventDefault(),e.cancelBubble=!0,t.selectAction&&t.selectAction.execute()},this.selectAction.title&&(o.setAttribute("aria-label",this.selectAction.title),o.title=this.selectAction.title),o.innerText=n,r.appendChild(o)}else r.innerText=n;return r}},e.prototype.applyStylesTo=function(e){if(t.prototype.applyStylesTo.call(this,e),this.italic&&(e.style.fontStyle="italic"),this.strikethrough&&(e.style.textDecoration="line-through"),this.highlight){var i=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);e.style.backgroundColor=l.stringToCssColor(this.isSubtle?i.highlightColors.subtle:i.highlightColors.default)}this.underline&&(e.style.textDecoration="underline")},e.prototype.getJsonTypeName=function(){return"TextRun"},Object.defineProperty(e.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInline",{get:function(){return!0},enumerable:!1,configurable:!0}),e.italicProperty=new h.BoolProperty(h.Versions.v1_2,"italic",!1),e.strikethroughProperty=new h.BoolProperty(h.Versions.v1_2,"strikethrough",!1),e.highlightProperty=new h.BoolProperty(h.Versions.v1_2,"highlight",!1),e.underlineProperty=new h.BoolProperty(h.Versions.v1_3,"underline",!1),o([h.property(e.italicProperty)],e.prototype,"italic",void 0),o([h.property(e.strikethroughProperty)],e.prototype,"strikethrough",void 0),o([h.property(e.highlightProperty)],e.prototype,"highlight",void 0),o([h.property(e.underlineProperty)],e.prototype,"underline",void 0),e}(m);e.TextRun=b;var C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._inlines=[],e}return r(e,t),e.prototype.internalAddInline=function(t,e){if(void 0===e&&(e=!1),!t.isInline)throw new Error(f.Strings.errors.elementCannotBeUsedAsInline());if(!(void 0===t.parent||e)&&t.parent!=this)throw new Error(f.Strings.errors.inlineAlreadyParented());t.setParent(this),this._inlines.push(t)},e.prototype.internalParse=function(e,i){if(t.prototype.internalParse.call(this,e,i),this._inlines=[],Array.isArray(e.inlines))for(var n=0,r=e.inlines;n<r.length;n++){var o=r[n],s=void 0;if("string"==typeof o){var a=new b;a.text=o,s=a}else s=i.parseElement(this,o,!1);s&&this.internalAddInline(s,!0)}},e.prototype.internalToJSON=function(e,i){if(t.prototype.internalToJSON.call(this,e,i),this._inlines.length>0){for(var n=[],r=0,o=this._inlines;r<o.length;r++){var s=o[r];n.push(s.toJSON(i))}i.serializeValue(e,"inlines",n)}},e.prototype.internalRender=function(){if(this._inlines.length>0){var t=void 0;if(this.forElementId){var e=document.createElement("label");e.htmlFor=this.forElementId,t=e}else t=document.createElement("div");t.className=this.hostConfig.makeCssClassName("ac-richTextBlock");var i=this.getParentContainer(),n=!!i&&i.isRtl();switch(this.horizontalAlignment){case s.HorizontalAlignment.Center:t.style.textAlign="center";break;case s.HorizontalAlignment.Right:t.style.textAlign=n?"left":"right";break;default:t.style.textAlign=n?"right":"left"}for(var r=0,o=0,a=this._inlines;o<a.length;o++){var l=a[o].render();l&&(t.appendChild(l),r++)}if(r>0)return t}},e.prototype.asString=function(){for(var t="",e=0,i=this._inlines;e<i.length;e++){t+=i[e].asString()}return t},e.prototype.getJsonTypeName=function(){return"RichTextBlock"},e.prototype.getInlineCount=function(){return this._inlines.length},e.prototype.getInlineAt=function(t){if(t>=0&&t<this._inlines.length)return this._inlines[t];throw new Error(f.Strings.errors.indexOutOfRange(t))},e.prototype.addInline=function(t){"string"==typeof t?this.internalAddInline(new b(t)):this.internalAddInline(t)},e.prototype.removeInline=function(t){var e=this._inlines.indexOf(t);return e>=0&&(this._inlines[e].setParent(void 0),this._inlines.splice(e,1),!0)},e}(y);e.RichTextBlock=C;var S=function(t){function e(e,i){var n=t.call(this)||this;return n.name=e,n.value=i,n}return r(e,t),e.prototype.getSchemaKey=function(){return"Fact"},e.titleProperty=new h.StringProperty(h.Versions.v1_0,"title"),e.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),o([h.property(e.titleProperty)],e.prototype,"name",void 0),o([h.property(e.valueProperty)],e.prototype,"value",void 0),e}(h.SerializableObject);e.Fact=S;var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.internalRender=function(){var t=void 0,e=this.hostConfig;if(this.facts.length>0){(t=document.createElement("table")).style.borderWidth="0px",t.style.borderSpacing="0px",t.style.borderStyle="none",t.style.borderCollapse="collapse",t.style.display="block",t.style.overflow="hidden",t.classList.add(e.makeCssClassName("ac-factset")),t.setAttribute("role","presentation");for(var i=0;i<this.facts.length;i++){var n=document.createElement("tr");i>0&&(n.style.marginTop=e.factSet.spacing+"px");var r=document.createElement("td");r.style.padding="0",r.classList.add(e.makeCssClassName("ac-fact-title")),e.factSet.title.maxWidth&&(r.style.maxWidth=e.factSet.title.maxWidth+"px"),r.style.verticalAlign="top";var o=new v;o.setParent(this),o.text=!this.facts[i].name&&this.isDesignMode()?"Title":this.facts[i].name,o.size=e.factSet.title.size,o.color=e.factSet.title.color,o.isSubtle=e.factSet.title.isSubtle,o.weight=e.factSet.title.weight,o.wrap=e.factSet.title.wrap,o.spacing=s.Spacing.None,l.appendChild(r,o.render()),l.appendChild(n,r),(r=document.createElement("td")).style.width="10px",l.appendChild(n,r),(r=document.createElement("td")).style.padding="0",r.style.verticalAlign="top",r.classList.add(e.makeCssClassName("ac-fact-value")),(o=new v).setParent(this),o.text=this.facts[i].value,o.size=e.factSet.value.size,o.color=e.factSet.value.color,o.isSubtle=e.factSet.value.isSubtle,o.weight=e.factSet.value.weight,o.wrap=e.factSet.value.wrap,o.spacing=s.Spacing.None,l.appendChild(r,o.render()),l.appendChild(n,r),l.appendChild(t,n)}}return t},e.prototype.getJsonTypeName=function(){return"FactSet"},e.factsProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_0,"facts",S),o([h.property(e.factsProperty)],e.prototype,"facts",void 0),e}(y);e.FactSet=_;var A=function(t){function e(e,i,n,r){var o=t.call(this,e,i)||this;return o.targetVersion=e,o.name=i,o.internalName=n,o.fallbackProperty=r,o}return r(e,t),e.prototype.getInternalName=function(){return this.internalName},e.prototype.parse=function(t,e,i){var n=void 0,r=e[this.name];if(void 0===r)return this.defaultValue;var o=!1;if("string"==typeof r){try{var l=a.SizeAndUnit.parse(r,!0);l.unit==s.SizeUnit.Pixel&&(n=l.physicalSize,o=!0)}catch(t){}!o&&this.fallbackProperty&&(o=this.fallbackProperty.isValidValue(r,i))}return o||i.logParseEvent(t,s.ValidationEvent.InvalidPropertyValue,f.Strings.errors.invalidPropertyValue(r,this.name)),n},e.prototype.toJSON=function(t,e,i,n){n.serializeValue(e,this.name,"number"!=typeof i||isNaN(i)?void 0:i+"px")},e}(h.PropertyDefinition),E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.size=s.Size.Auto,e.style=s.ImageStyle.Default,e}return r(e,t),e.prototype.populateSchema=function(e){t.prototype.populateSchema.call(this,e),e.remove(y.heightProperty)},e.prototype.applySize=function(t){if(this.pixelWidth||this.pixelHeight)this.pixelWidth&&(t.style.width=this.pixelWidth+"px"),this.pixelHeight&&(t.style.height=this.pixelHeight+"px");else if(this.maxHeight){switch(this.size){case s.Size.Small:t.style.height=this.hostConfig.imageSizes.small+"px";break;case s.Size.Large:t.style.height=this.hostConfig.imageSizes.large+"px";break;default:t.style.height=this.hostConfig.imageSizes.medium+"px"}t.style.maxHeight=this.maxHeight+"px"}else{switch(this.size){case s.Size.Stretch:t.style.width="100%";break;case s.Size.Auto:t.style.maxWidth="100%";break;case s.Size.Small:t.style.width=this.hostConfig.imageSizes.small+"px";break;case s.Size.Large:t.style.width=this.hostConfig.imageSizes.large+"px";break;case s.Size.Medium:t.style.width=this.hostConfig.imageSizes.medium+"px"}t.style.maxHeight="100%"}},Object.defineProperty(e.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.internalRender=function(){var t=this,i=void 0;if(this.url){switch((i=document.createElement("div")).style.display="flex",i.style.alignItems="flex-start",i.onkeypress=function(e){!t.selectAction||13!=e.keyCode&&32!=e.keyCode||(e.preventDefault(),e.cancelBubble=!0,t.selectAction.execute())},i.onclick=function(e){t.selectAction&&(e.preventDefault(),e.cancelBubble=!0,t.selectAction.execute())},this.horizontalAlignment){case s.HorizontalAlignment.Center:i.style.justifyContent="center";break;case s.HorizontalAlignment.Right:i.style.justifyContent="flex-end";break;default:i.style.justifyContent="flex-start"}var n=this.hostConfig,r=document.createElement("img");r.onload=function(e){it(t)},r.onerror=function(e){if(t.renderedElement){var i=t.getRootElement();if(t.renderedElement.innerHTML="",i&&i.designMode){var n=document.createElement("div");n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.backgroundColor="#EEEEEE",n.style.color="black",n.innerText=":-(",n.style.padding="10px",t.applySize(n),t.renderedElement.appendChild(n)}}it(t)},r.style.minWidth="0",r.classList.add(n.makeCssClassName("ac-image")),void 0!==this.selectAction&&n.supportsInteractivity&&(r.tabIndex=0,r.setAttribute("role",this.selectAction.getAriaRole()),this.selectAction.title&&(r.setAttribute("aria-label",this.selectAction.title),r.title=this.selectAction.title),r.classList.add(n.makeCssClassName("ac-selectable"))),this.applySize(r),this.style===s.ImageStyle.Person&&(r.style.borderRadius="50%",r.style.backgroundPosition="50% 50%",r.style.backgroundRepeat="no-repeat"),r.style.backgroundColor=l.stringToCssColor(this.backgroundColor),r.src=this.preProcessPropertyValue(e.urlProperty);var o=this.preProcessPropertyValue(e.altTextProperty);o&&(r.alt=o),i.appendChild(r)}return i},e.prototype.getJsonTypeName=function(){return"Image"},e.prototype.getActionById=function(e){var i=t.prototype.getActionById.call(this,e);return!i&&this.selectAction&&(i=this.selectAction.getActionById(e)),i},e.prototype.getResourceInformation=function(){return this.url?[{url:this.url,mimeType:"image"}]:[]},e.urlProperty=new h.StringProperty(h.Versions.v1_0,"url"),e.altTextProperty=new h.StringProperty(h.Versions.v1_0,"altText"),e.backgroundColorProperty=new h.StringProperty(h.Versions.v1_1,"backgroundColor"),e.styleProperty=new h.EnumProperty(h.Versions.v1_0,"style",s.ImageStyle,s.ImageStyle.Default),e.sizeProperty=new h.EnumProperty(h.Versions.v1_0,"size",s.Size,s.Size.Auto),e.pixelWidthProperty=new A(h.Versions.v1_1,"width","pixelWidth"),e.pixelHeightProperty=new A(h.Versions.v1_1,"height","pixelHeight",y.heightProperty),e.selectActionProperty=new g(h.Versions.v1_1,"selectAction",["Action.ShowCard"]),o([h.property(e.urlProperty)],e.prototype,"url",void 0),o([h.property(e.altTextProperty)],e.prototype,"altText",void 0),o([h.property(e.backgroundColorProperty)],e.prototype,"backgroundColor",void 0),o([h.property(e.sizeProperty)],e.prototype,"size",void 0),o([h.property(e.styleProperty)],e.prototype,"style",void 0),o([h.property(e.pixelWidthProperty)],e.prototype,"pixelWidth",void 0),o([h.property(e.pixelHeightProperty)],e.prototype,"pixelHeight",void 0),o([h.property(e.selectActionProperty)],e.prototype,"selectAction",void 0),e}(y);e.Image=E;var P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allowVerticalOverflow=!1,e}return r(e,t),e.prototype.populateSchema=function(i){t.prototype.populateSchema.call(this,i),this.isSelectable||i.remove(e.selectActionProperty)},e.prototype.isElementAllowed=function(t){return this.hostConfig.supportsInteractivity||!t.isInteractive},e.prototype.applyPadding=function(){if(t.prototype.applyPadding.call(this),this.renderedElement){var e=new a.SpacingDefinition;this.getEffectivePadding()&&(e=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=e.top+"px",this.renderedElement.style.paddingRight=e.right+"px",this.renderedElement.style.paddingBottom=e.bottom+"px",this.renderedElement.style.paddingLeft=e.left+"px",this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0"}},Object.defineProperty(e.prototype,"isSelectable",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e);for(var i=0;i<this.getItemCount();i++){var n=this.getItemAt(i);!this.hostConfig.supportsInteractivity&&n.isInteractive&&e.addFailure(this,s.ValidationEvent.InteractivityNotAllowed,f.Strings.errors.interactivityNotAllowed()),this.isElementAllowed(n)||e.addFailure(this,s.ValidationEvent.InteractivityNotAllowed,f.Strings.errors.elementTypeNotAllowed(n.getJsonTypeName())),n.internalValidateProperties(e)}this._selectAction&&this._selectAction.internalValidateProperties(e)},e.prototype.render=function(){var e=this,i=t.prototype.render.call(this);if(i){var n=this.hostConfig;this.allowVerticalOverflow&&(i.style.overflowX="hidden",i.style.overflowY="auto"),i&&this.isSelectable&&this._selectAction&&n.supportsInteractivity&&(i.classList.add(n.makeCssClassName("ac-selectable")),i.tabIndex=0,i.setAttribute("role",this._selectAction.getAriaRole()),this._selectAction.title&&(i.setAttribute("aria-label",this._selectAction.title),i.title=this._selectAction.title),i.onclick=function(t){void 0!==e._selectAction&&(t.preventDefault(),t.cancelBubble=!0,e._selectAction.execute())},i.onkeypress=function(t){void 0===e._selectAction||13!=t.keyCode&&32!=t.keyCode||(t.preventDefault(),t.cancelBubble=!0,e._selectAction.execute())})}return i},e.prototype.updateLayout=function(e){if(void 0===e&&(e=!0),t.prototype.updateLayout.call(this,e),e)for(var i=0;i<this.getItemCount();i++)this.getItemAt(i).updateLayout()},e.prototype.getAllInputs=function(t){void 0===t&&(t=!0);for(var e=[],i=0;i<this.getItemCount();i++)e=e.concat(this.getItemAt(i).getAllInputs(t));return e},e.prototype.getResourceInformation=function(){for(var t=[],e=0;e<this.getItemCount();e++)t=t.concat(this.getItemAt(e).getResourceInformation());return t},e.prototype.getElementById=function(e){var i=t.prototype.getElementById.call(this,e);if(!i)for(var n=0;n<this.getItemCount()&&!(i=this.getItemAt(n).getElementById(e));n++);return i},e.prototype.findDOMNodeOwner=function(e){for(var i=void 0,n=0;n<this.getItemCount();n++)if(i=this.getItemAt(n).findDOMNodeOwner(e))return i;return t.prototype.findDOMNodeOwner.call(this,e)},e.selectActionProperty=new g(h.Versions.v1_1,"selectAction",["Action.ShowCard"]),o([h.property(e.selectActionProperty)],e.prototype,"_selectAction",void 0),e}(y);e.CardElementContainer=P;var x=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._images=[],e.imageSize=s.ImageSize.Medium,e}return r(e,t),e.prototype.internalRender=function(){var t=void 0;if(this._images.length>0){(t=document.createElement("div")).style.display="flex",t.style.flexWrap="wrap";for(var e=0,i=this._images;e<i.length;e++){var n=i[e];switch(this.imageSize){case s.ImageSize.Small:n.size=s.Size.Small;break;case s.ImageSize.Large:n.size=s.Size.Large;break;default:n.size=s.Size.Medium}n.maxHeight=this.hostConfig.imageSet.maxImageHeight;var r=n.render();r&&(r.style.display="inline-flex",r.style.margin="0px",r.style.marginRight="10px",l.appendChild(t,r))}}return t},e.prototype.getItemCount=function(){return this._images.length},e.prototype.getItemAt=function(t){return this._images[t]},e.prototype.getFirstVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[0]:void 0},e.prototype.getLastVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[this._images.length-1]:void 0},e.prototype.removeItem=function(t){if(t instanceof E){var e=this._images.indexOf(t);if(e>=0)return this._images.splice(e,1),t.setParent(void 0),this.updateLayout(),!0}return!1},e.prototype.getJsonTypeName=function(){return"ImageSet"},e.prototype.addImage=function(t){if(t.parent)throw new Error("This image already belongs to another ImageSet");this._images.push(t),t.setParent(this)},e.prototype.indexOf=function(t){return t instanceof E?this._images.indexOf(t):-1},e.imagesProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_0,"images",E,(function(t,e){e.setParent(t)})),e.imageSizeProperty=new h.EnumProperty(h.Versions.v1_0,"imageSize",s.ImageSize,s.ImageSize.Medium),o([h.property(e.imagesProperty)],e.prototype,"_images",void 0),o([h.property(e.imageSizeProperty)],e.prototype,"imageSize",void 0),e}(P);e.ImageSet=x;var w=function(t){function e(e,i){var n=t.call(this)||this;return n.url=e,n.mimeType=i,n}return r(e,t),e.prototype.getSchemaKey=function(){return"MediaSource"},e.prototype.isValid=function(){return!(!this.mimeType||!this.url)},e.prototype.render=function(){var t=void 0;return this.isValid()&&((t=document.createElement("source")).src=this.url,t.type=this.mimeType),t},e.mimeTypeProperty=new h.StringProperty(h.Versions.v1_1,"mimeType"),e.urlProperty=new h.StringProperty(h.Versions.v1_1,"url"),o([h.property(e.mimeTypeProperty)],e.prototype,"mimeType",void 0),o([h.property(e.urlProperty)],e.prototype,"url",void 0),e}(h.SerializableObject);e.MediaSource=w;var I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sources=[],e}return r(e,t),e.prototype.getPosterUrl=function(){return this.poster?this.poster:this.hostConfig.media.defaultPoster},e.prototype.processSources=function(){this._selectedSources=[],this._selectedMediaType=void 0;for(var t=0,i=this.sources;t<i.length;t++){var n=i[t],r=n.mimeType?n.mimeType.split("/"):[];if(2==r.length){if(!this._selectedMediaType){var o=e.supportedMediaTypes.indexOf(r[0]);o>=0&&(this._selectedMediaType=e.supportedMediaTypes[o])}r[0]==this._selectedMediaType&&this._selectedSources.push(n)}}},e.prototype.handlePlayButtonInvoke=function(t){if(this.hostConfig.media.allowInlinePlayback){if(t.preventDefault(),t.cancelBubble=!0,this.renderedElement){var i=this.renderMediaPlayer();this.renderedElement.innerHTML="",this.renderedElement.appendChild(i),i.play(),i.focus()}}else e.onPlay&&(t.preventDefault(),t.cancelBubble=!0,e.onPlay(this))},e.prototype.renderPoster=function(){var t=this,e=document.createElement("div");e.className=this.hostConfig.makeCssClassName("ac-media-poster"),e.setAttribute("role","contentinfo"),e.setAttribute("aria-label",this.altText?this.altText:f.Strings.defaults.mediaPlayerAriaLabel()),e.style.position="relative",e.style.display="flex";var i=this.getPosterUrl();if(i){var n=document.createElement("img");n.style.width="100%",n.style.height="100%",n.setAttribute("role","presentation"),n.onerror=function(t){n.parentNode&&n.parentNode.removeChild(n),e.classList.add("empty"),e.style.minHeight="150px"},n.src=i,e.appendChild(n)}else e.classList.add("empty"),e.style.minHeight="150px";if(this.hostConfig.supportsInteractivity&&this._selectedSources.length>0){var r=document.createElement("div");r.tabIndex=0,r.setAttribute("role","button"),r.setAttribute("aria-label",f.Strings.defaults.mediaPlayerPlayMedia()),r.className=this.hostConfig.makeCssClassName("ac-media-playButton"),r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="center",r.onclick=function(e){t.handlePlayButtonInvoke(e)},r.onkeypress=function(e){13!=e.keyCode&&32!=e.keyCode||t.handlePlayButtonInvoke(e)};var o=document.createElement("div");o.className=this.hostConfig.makeCssClassName("ac-media-playButton-arrow"),o.style.width="12px",o.style.height="15px",o.style.borderTopWidth="7.5px",o.style.borderBottomWidth="7.5px",o.style.borderLeftWidth="12px",o.style.borderRightWidth="0",o.style.borderStyle="solid",o.style.borderTopColor="transparent",o.style.borderRightColor="transparent",o.style.borderBottomColor="transparent",o.style.transform="translate(1.2px,0px)",r.appendChild(o);var s=document.createElement("div");s.style.position="absolute",s.style.left="0",s.style.top="0",s.style.width="100%",s.style.height="100%",s.style.display="flex",s.style.justifyContent="center",s.style.alignItems="center",s.appendChild(r),e.appendChild(s)}return e},e.prototype.renderMediaPlayer=function(){var t;if("video"==this._selectedMediaType){var e=document.createElement("video"),i=this.getPosterUrl();i&&(e.poster=i),t=e}else t=document.createElement("audio");t.setAttribute("aria-label",this.altText?this.altText:f.Strings.defaults.mediaPlayerAriaLabel()),t.setAttribute("webkit-playsinline",""),t.setAttribute("playsinline",""),t.autoplay=!0,t.controls=!0,l.isMobileOS()&&(t.muted=!0),t.preload="none",t.style.width="100%";for(var n=0,r=this.sources;n<r.length;n++){var o=r[n].render();l.appendChild(t,o)}return t},e.prototype.internalRender=function(){var t=document.createElement("div");return t.className=this.hostConfig.makeCssClassName("ac-media"),this.processSources(),t.appendChild(this.renderPoster()),t},e.prototype.getJsonTypeName=function(){return"Media"},e.prototype.getResourceInformation=function(){var t=[],e=this.getPosterUrl();e&&t.push({url:e,mimeType:"image"});for(var i=0,n=this.sources;i<n.length;i++){var r=n[i];r.isValid()&&t.push({url:r.url,mimeType:r.mimeType})}return t},Object.defineProperty(e.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:!1,configurable:!0}),e.sourcesProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_1,"sources",w),e.posterProperty=new h.StringProperty(h.Versions.v1_1,"poster"),e.altTextProperty=new h.StringProperty(h.Versions.v1_1,"altText"),e.supportedMediaTypes=["audio","video"],o([h.property(e.sourcesProperty)],e.prototype,"sources",void 0),o([h.property(e.posterProperty)],e.prototype,"poster",void 0),o([h.property(e.altTextProperty)],e.prototype,"altText",void 0),e}(y);e.Media=I;var T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getAllLabelIds=function(){var t=[];return this._renderedLabelElement&&t.push(this._renderedLabelElement.id),this._renderedErrorMessageElement&&t.push(this._renderedErrorMessageElement.id),t},e.prototype.updateInputControlAriaLabelledBy=function(){if(this._renderedInputControlElement){var t=this.getAllLabelIds();this.labelledBy&&t.push(this.labelledBy),this._renderedLabelElement&&t.push(this._renderedLabelElement.id),this._renderedErrorMessageElement&&t.push(this._renderedErrorMessageElement.id),t.length>0?this._renderedInputControlElement.setAttribute("aria-labelledby",t.join(" ")):this._renderedInputControlElement.removeAttribute("aria-labelledby")}},Object.defineProperty(e.prototype,"isNullable",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderedInputControlElement",{get:function(){return this._renderedInputControlElement},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inputControlContainerElement",{get:function(){return this._inputControlContainerElement},enumerable:!1,configurable:!0}),e.prototype.overrideInternalRender=function(){var t=this.hostConfig;this._outerContainerElement=document.createElement("div"),this._outerContainerElement.style.display="flex",this._outerContainerElement.style.flexDirection="column";var e=l.generateUniqueId();if(this.label){var i=new C;i.setParent(this),i.forElementId=e;var n=new b(this.label);if(i.addInline(n),this.isRequired){n.init(t.inputs.label.requiredInputs);var r=new b(t.inputs.label.requiredInputs.suffix);r.color=t.inputs.label.requiredInputs.suffixColor,r.ariaHidden=!0,i.addInline(r)}else n.init(t.inputs.label.optionalInputs);this._renderedLabelElement=i.render(),this._renderedLabelElement&&(this._renderedLabelElement.id=l.generateUniqueId(),this._renderedLabelElement.style.marginBottom=t.getEffectiveSpacing(t.inputs.label.inputSpacing)+"px",this._outerContainerElement.appendChild(this._renderedLabelElement))}if(this._inputControlContainerElement=document.createElement("div"),this._inputControlContainerElement.className=t.makeCssClassName("ac-input-container"),this._inputControlContainerElement.style.display="flex","stretch"===this.height&&(this._inputControlContainerElement.style.alignItems="stretch",this._inputControlContainerElement.style.flex="1 1 auto"),this._renderedInputControlElement=this.internalRender(),this._renderedInputControlElement)return this._renderedInputControlElement.id=e,this._renderedInputControlElement.style.minWidth="0px",this.isNullable&&this.isRequired&&(this._renderedInputControlElement.setAttribute("aria-required","true"),this._renderedInputControlElement.classList.add(t.makeCssClassName("ac-input-required"))),this._inputControlContainerElement.appendChild(this._renderedInputControlElement),this._outerContainerElement.appendChild(this._inputControlContainerElement),this.updateInputControlAriaLabelledBy(),this._outerContainerElement},e.prototype.valueChanged=function(){var t,e,i;this.isValid()&&this.resetValidationFailureCue(),this.onValueChanged&&this.onValueChanged(this),e=(t=this).getRootElement(),(i=e&&e.onInputValueChanged?e.onInputValueChanged:ht.onInputValueChanged)&&i(t)},e.prototype.resetValidationFailureCue=function(){this.renderedInputControlElement&&(this.renderedInputControlElement.classList.remove(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.updateInputControlAriaLabelledBy(),this._renderedErrorMessageElement&&(this._outerContainerElement.removeChild(this._renderedErrorMessageElement),this._renderedErrorMessageElement=void 0))},e.prototype.showValidationErrorMessage=function(){if(this.renderedElement&&this.errorMessage&&a.GlobalSettings.displayInputValidationErrors){var t=new v;t.setParent(this),t.text=this.errorMessage,t.wrap=!0,t.init(this.hostConfig.inputs.errorMessage),this._renderedErrorMessageElement=t.render(),this._renderedErrorMessageElement&&(this._renderedErrorMessageElement.id=l.generateUniqueId(),this._outerContainerElement.appendChild(this._renderedErrorMessageElement),this.updateInputControlAriaLabelledBy())}},e.prototype.focus=function(){this._renderedInputControlElement&&this._renderedInputControlElement.focus()},e.prototype.isValid=function(){return!0},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e),this.id||e.addFailure(this,s.ValidationEvent.PropertyCantBeNull,f.Strings.errors.inputsMustHaveUniqueId()),this.isRequired&&(this.label||e.addFailure(this,s.ValidationEvent.RequiredInputsShouldHaveLabel,"Required inputs should have a label"),this.errorMessage||e.addFailure(this,s.ValidationEvent.RequiredInputsShouldHaveErrorMessage,"Required inputs should have an error message"))},e.prototype.validateValue=function(){this.resetValidationFailureCue();var t=this.isRequired?this.isSet()&&this.isValid():this.isValid();return!t&&this.renderedInputControlElement&&(this.renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.showValidationErrorMessage()),t},e.prototype.getAllInputs=function(t){return void 0===t&&(t=!0),[this]},Object.defineProperty(e.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),e.labelProperty=new h.StringProperty(h.Versions.v1_3,"label",!0),e.isRequiredProperty=new h.BoolProperty(h.Versions.v1_3,"isRequired",!1),e.errorMessageProperty=new h.StringProperty(h.Versions.v1_3,"errorMessage",!0),o([h.property(e.labelProperty)],e.prototype,"label",void 0),o([h.property(e.isRequiredProperty)],e.prototype,"isRequired",void 0),o([h.property(e.errorMessageProperty)],e.prototype,"errorMessage",void 0),e}(y);e.Input=T;var V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isMultiline=!1,e.style=s.InputTextStyle.Text,e}return r(e,t),e.prototype.setupInput=function(t){var e=this;t.style.flex="1 1 auto",t.tabIndex=0,this.placeholder&&(t.placeholder=this.placeholder,t.setAttribute("aria-label",this.placeholder)),this.defaultValue&&(t.value=this.defaultValue),this.maxLength&&this.maxLength>0&&(t.maxLength=this.maxLength),t.oninput=function(){e.valueChanged()},t.onkeypress=function(t){t.ctrlKey&&"Enter"===t.code&&e.inlineAction&&e.inlineAction.execute()}},e.prototype.internalRender=function(){var t;return this.isMultiline?((t=document.createElement("textarea")).className=this.hostConfig.makeCssClassName("ac-input","ac-textInput","ac-multiline"),"stretch"===this.height&&(t.style.height="initial")):((t=document.createElement("input")).className=this.hostConfig.makeCssClassName("ac-input","ac-textInput"),t.type=s.InputTextStyle[this.style].toLowerCase()),this.setupInput(t),t},e.prototype.overrideInternalRender=function(){var e=this,i=t.prototype.overrideInternalRender.call(this);if(this.inlineAction){var n=document.createElement("button");if(n.className=this.hostConfig.makeCssClassName("ac-inlineActionButton"),n.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,e.inlineAction&&e.inlineAction.execute()},this.inlineAction.iconUrl){n.classList.add("iconOnly");var r=document.createElement("img");r.style.height="100%",r.setAttribute("role","presentation"),r.style.display="none",r.onload=function(){r.style.removeProperty("display")},r.onerror=function(){n.removeChild(r),n.classList.remove("iconOnly"),n.classList.add("textOnly"),n.textContent=e.inlineAction&&e.inlineAction.title?e.inlineAction.title:f.Strings.defaults.inlineActionTitle()},r.src=this.inlineAction.iconUrl,n.appendChild(r),n.title=this.inlineAction.title?this.inlineAction.title:f.Strings.defaults.inlineActionTitle()}else n.classList.add("textOnly"),n.textContent=this.inlineAction.title?this.inlineAction.title:f.Strings.defaults.inlineActionTitle();n.style.marginLeft="8px",this.inputControlContainerElement.appendChild(n)}return i},e.prototype.getJsonTypeName=function(){return"Input.Text"},e.prototype.getActionById=function(e){var i=t.prototype.getActionById.call(this,e);return!i&&this.inlineAction&&(i=this.inlineAction.getActionById(e)),i},e.prototype.isSet=function(){return!!this.value},e.prototype.isValid=function(){return!this.value||(!this.regex||new RegExp(this.regex,"g").test(this.value))},Object.defineProperty(e.prototype,"value",{get:function(){return this.renderedInputControlElement?(this.isMultiline,this.renderedInputControlElement.value):void 0},enumerable:!1,configurable:!0}),e.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),e.maxLengthProperty=new h.NumProperty(h.Versions.v1_0,"maxLength"),e.isMultilineProperty=new h.BoolProperty(h.Versions.v1_0,"isMultiline",!1),e.placeholderProperty=new h.StringProperty(h.Versions.v1_0,"placeholder"),e.styleProperty=new h.EnumProperty(h.Versions.v1_0,"style",s.InputTextStyle,s.InputTextStyle.Text),e.inlineActionProperty=new g(h.Versions.v1_0,"inlineAction",["Action.ShowCard"]),e.regexProperty=new h.StringProperty(h.Versions.v1_3,"regex",!0),o([h.property(e.valueProperty)],e.prototype,"defaultValue",void 0),o([h.property(e.maxLengthProperty)],e.prototype,"maxLength",void 0),o([h.property(e.isMultilineProperty)],e.prototype,"isMultiline",void 0),o([h.property(e.placeholderProperty)],e.prototype,"placeholder",void 0),o([h.property(e.styleProperty)],e.prototype,"style",void 0),o([h.property(e.inlineActionProperty)],e.prototype,"inlineAction",void 0),o([h.property(e.regexProperty)],e.prototype,"regex",void 0),e}(T);e.TextInput=V;var O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.valueOn="true",e.valueOff="false",e.wrap=!1,e}return r(e,t),e.prototype.updateInputControlAriaLabelledBy=function(){if(this._checkboxInputElement){var t=this.getAllLabelIds().join(" ");this._checkboxInputLabelElement&&this._checkboxInputLabelElement.id&&(t+=" "+this._checkboxInputLabelElement.id),t?this._checkboxInputElement.setAttribute("aria-labelledby",t):this._checkboxInputElement.removeAttribute("aria-labelledby")}},e.prototype.internalRender=function(){var t=this,e=document.createElement("div");if(e.className=this.hostConfig.makeCssClassName("ac-input","ac-toggleInput"),e.style.width="100%",e.style.display="flex",e.style.alignItems="center",this._checkboxInputElement=document.createElement("input"),this._checkboxInputElement.id=l.generateUniqueId(),this._checkboxInputElement.type="checkbox",this._checkboxInputElement.style.display="inline-block",this._checkboxInputElement.style.verticalAlign="middle",this._checkboxInputElement.style.margin="0",this._checkboxInputElement.style.flex="0 0 auto",this.title&&this._checkboxInputElement.setAttribute("aria-label",this.title),this.isRequired&&this._checkboxInputElement.setAttribute("aria-required","true"),this._checkboxInputElement.tabIndex=0,this.defaultValue==this.valueOn&&(this._checkboxInputElement.checked=!0),this._checkboxInputElement.onchange=function(){t.valueChanged()},l.appendChild(e,this._checkboxInputElement),this.title||this.isDesignMode()){var i=new v;if(i.setParent(this),i.forElementId=this._checkboxInputElement.id,i.hostConfig=this.hostConfig,i.text=this.title?this.title:this.getJsonTypeName(),i.useMarkdown=a.GlobalSettings.useMarkdownInRadioButtonAndCheckbox,i.wrap=this.wrap,this._checkboxInputLabelElement=i.render(),this._checkboxInputLabelElement){this._checkboxInputLabelElement.id=l.generateUniqueId(),this._checkboxInputLabelElement.style.display="inline-block",this._checkboxInputLabelElement.style.flex="1 1 auto",this._checkboxInputLabelElement.style.marginLeft="6px",this._checkboxInputLabelElement.style.verticalAlign="middle";var n=document.createElement("div");n.style.width="6px",l.appendChild(e,n),l.appendChild(e,this._checkboxInputLabelElement)}}return e},Object.defineProperty(e.prototype,"isNullable",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getJsonTypeName=function(){return"Input.Toggle"},e.prototype.focus=function(){this._checkboxInputElement&&this._checkboxInputElement.focus()},e.prototype.isSet=function(){return this.isRequired?this.value===this.valueOn:!!this.value},Object.defineProperty(e.prototype,"value",{get:function(){return this._checkboxInputElement?this._checkboxInputElement.checked?this.valueOn:this.valueOff:void 0},enumerable:!1,configurable:!0}),e.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),e.titleProperty=new h.StringProperty(h.Versions.v1_0,"title"),e.valueOnProperty=new h.StringProperty(h.Versions.v1_0,"valueOn",!0,void 0,"true",(function(t){return"true"})),e.valueOffProperty=new h.StringProperty(h.Versions.v1_0,"valueOff",!0,void 0,"false",(function(t){return"false"})),e.wrapProperty=new h.BoolProperty(h.Versions.v1_2,"wrap",!1),o([h.property(e.valueProperty)],e.prototype,"defaultValue",void 0),o([h.property(e.titleProperty)],e.prototype,"title",void 0),o([h.property(e.valueOnProperty)],e.prototype,"valueOn",void 0),o([h.property(e.valueOffProperty)],e.prototype,"valueOff",void 0),o([h.property(e.wrapProperty)],e.prototype,"wrap",void 0),e}(T);e.ToggleInput=O;var k=function(t){function e(e,i){var n=t.call(this)||this;return n.title=e,n.value=i,n}return r(e,t),e.prototype.getSchemaKey=function(){return"Choice"},e.titleProperty=new h.StringProperty(h.Versions.v1_0,"title"),e.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),o([h.property(e.titleProperty)],e.prototype,"title",void 0),o([h.property(e.valueProperty)],e.prototype,"value",void 0),e}(h.SerializableObject);e.Choice=k;var N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isMultiSelect=!1,e.wrap=!1,e.choices=[],e}return r(e,t),Object.defineProperty(e.prototype,"isCompact",{get:function(){return"expanded"!==this.style},set:function(t){this.style=t?void 0:"expanded"},enumerable:!1,configurable:!0}),e.getUniqueCategoryName=function(){var t="__ac-category"+e.uniqueCategoryCounter;return e.uniqueCategoryCounter++,t},e.prototype.internalApplyAriaCurrent=function(){var t=this._selectElement.options;if(t)for(var e=0;e<t.length;e++)t[e].selected?t[e].setAttribute("aria-current","true"):t[e].removeAttribute("aria-current")},e.prototype.renderCompoundInput=function(t,e,i){var n=this,r=document.createElement("div");r.className=this.hostConfig.makeCssClassName("ac-input",t),r.style.width="100%",this._toggleInputs=[],this._labels=[];for(var o=0,s=this.choices;o<s.length;o++){var u=s[o],p=document.createElement("input");p.id=l.generateUniqueId(),p.type=e,p.style.margin="0",p.style.display="inline-block",p.style.verticalAlign="middle",p.style.flex="0 0 auto",p.name=this.id?this.id:this._uniqueCategoryName,this.isRequired&&p.setAttribute("aria-required","true"),u.value&&(p.value=u.value),u.title&&p.setAttribute("aria-label",u.title),i&&u.value&&i.indexOf(u.value)>=0&&(p.checked=!0),p.onchange=function(){n.valueChanged()},this._toggleInputs.push(p);var c=document.createElement("div");c.style.display="flex",c.style.alignItems="center",l.appendChild(c,p);var h=new v;h.setParent(this),h.forElementId=p.id,h.hostConfig=this.hostConfig,h.text=u.title?u.title:"Choice "+this._toggleInputs.length,h.useMarkdown=a.GlobalSettings.useMarkdownInRadioButtonAndCheckbox,h.wrap=this.wrap;var d=h.render();if(this._labels.push(d),d){d.id=l.generateUniqueId(),d.style.display="inline-block",d.style.flex="1 1 auto",d.style.marginLeft="6px",d.style.verticalAlign="middle";var f=document.createElement("div");f.style.width="6px",l.appendChild(c,f),l.appendChild(c,d)}l.appendChild(r,c)}return r},e.prototype.updateInputControlAriaLabelledBy=function(){if((this.isMultiSelect||"expanded"===this.style)&&this._toggleInputs&&this._labels)for(var e=this.getAllLabelIds(),i=0;i<this._toggleInputs.length;i++){var n=e.join(" "),r=this._labels[i];r&&r.id&&(n+=" "+r.id),n?this._toggleInputs[i].setAttribute("aria-labelledby",n):this._toggleInputs[i].removeAttribute("aria-labelledby")}else t.prototype.updateInputControlAriaLabelledBy.call(this)},e.prototype.internalRender=function(){var t=this;if(this._uniqueCategoryName=e.getUniqueCategoryName(),this.isMultiSelect)return this.renderCompoundInput("ac-choiceSetInput-multiSelect","checkbox",this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):void 0);if("expanded"===this.style)return this.renderCompoundInput("ac-choiceSetInput-expanded","radio",this.defaultValue?[this.defaultValue]:void 0);this._selectElement=document.createElement("select"),this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-compact"),this._selectElement.style.width="100%";var i=document.createElement("option");i.selected=!0,i.disabled=!0,i.hidden=!0,i.value="",this.placeholder&&(i.text=this.placeholder),l.appendChild(this._selectElement,i);for(var n=0,r=this.choices;n<r.length;n++){var o=r[n],s=document.createElement("option");s.value=o.value,s.text=o.title,s.setAttribute("aria-label",o.title),o.value==this.defaultValue&&(s.selected=!0),l.appendChild(this._selectElement,s)}return this._selectElement.onchange=function(){t.internalApplyAriaCurrent(),t.valueChanged()},this.internalApplyAriaCurrent(),this._selectElement},e.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},e.prototype.focus=function(){this._toggleInputs&&(this.isMultiSelect||"expanded"===this.style)?this._toggleInputs.length>0&&this._toggleInputs[0].focus():t.prototype.focus.call(this)},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e),0==this.choices.length&&e.addFailure(this,s.ValidationEvent.CollectionCantBeEmpty,f.Strings.errors.choiceSetMustHaveAtLeastOneChoice());for(var i=0,n=this.choices;i<n.length;i++){var r=n[i];r.title&&r.value||e.addFailure(this,s.ValidationEvent.PropertyCantBeNull,f.Strings.errors.choiceSetChoicesMustHaveTitleAndValue())}},e.prototype.isSet=function(){return!!this.value},Object.defineProperty(e.prototype,"value",{get:function(){if(this.isMultiSelect){if(!this._toggleInputs||0==this._toggleInputs.length)return;for(var t="",e=0,i=this._toggleInputs;e<i.length;e++){(o=i[e]).checked&&(""!=t&&(t+=this.hostConfig.choiceSetInputValueSeparator),t+=o.value)}return t||void 0}if(this.isCompact)return this._selectElement&&this._selectElement.selectedIndex>0?this._selectElement.value:void 0;if(this._toggleInputs&&0!=this._toggleInputs.length)for(var n=0,r=this._toggleInputs;n<r.length;n++){var o;if((o=r[n]).checked)return o.value}},enumerable:!1,configurable:!0}),e.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),e.choicesProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_0,"choices",k),e.styleProperty=new h.ValueSetProperty(h.Versions.v1_0,"style",[{value:"compact"},{value:"expanded"}],"compact"),e.isMultiSelectProperty=new h.BoolProperty(h.Versions.v1_0,"isMultiSelect",!1),e.placeholderProperty=new h.StringProperty(h.Versions.v1_0,"placeholder"),e.wrapProperty=new h.BoolProperty(h.Versions.v1_2,"wrap",!1),e.uniqueCategoryCounter=0,o([h.property(e.valueProperty)],e.prototype,"defaultValue",void 0),o([h.property(e.styleProperty)],e.prototype,"style",void 0),o([h.property(e.isMultiSelectProperty)],e.prototype,"isMultiSelect",void 0),o([h.property(e.placeholderProperty)],e.prototype,"placeholder",void 0),o([h.property(e.wrapProperty)],e.prototype,"wrap",void 0),o([h.property(e.choicesProperty)],e.prototype,"choices",void 0),e}(T);e.ChoiceSetInput=N;var z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.internalRender=function(){var t=this;return this._numberInputElement=document.createElement("input"),this._numberInputElement.setAttribute("type","number"),void 0!==this.min&&this._numberInputElement.setAttribute("min",this.min.toString()),void 0!==this.max&&this._numberInputElement.setAttribute("max",this.max.toString()),this._numberInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-numberInput"),this._numberInputElement.style.width="100%",this._numberInputElement.tabIndex=0,void 0!==this.defaultValue&&(this._numberInputElement.valueAsNumber=this.defaultValue),this.placeholder&&(this._numberInputElement.placeholder=this.placeholder,this._numberInputElement.setAttribute("aria-label",this.placeholder)),this._numberInputElement.oninput=function(){t.valueChanged()},this._numberInputElement},e.prototype.getJsonTypeName=function(){return"Input.Number"},e.prototype.isSet=function(){return void 0!==this.value&&!isNaN(this.value)},e.prototype.isValid=function(){if(void 0===this.value)return!this.isRequired;var t=!0;return void 0!==this.min&&(t=t&&this.value>=this.min),void 0!==this.max&&(t=t&&this.value<=this.max),t},Object.defineProperty(e.prototype,"value",{get:function(){return this._numberInputElement?this._numberInputElement.valueAsNumber:void 0},enumerable:!1,configurable:!0}),e.valueProperty=new h.NumProperty(h.Versions.v1_0,"value"),e.placeholderProperty=new h.StringProperty(h.Versions.v1_0,"placeholder"),e.minProperty=new h.NumProperty(h.Versions.v1_0,"min"),e.maxProperty=new h.NumProperty(h.Versions.v1_0,"max"),o([h.property(e.valueProperty)],e.prototype,"defaultValue",void 0),o([h.property(e.minProperty)],e.prototype,"min",void 0),o([h.property(e.maxProperty)],e.prototype,"max",void 0),o([h.property(e.placeholderProperty)],e.prototype,"placeholder",void 0),e}(T);e.NumberInput=z;var D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.internalRender=function(){var t=this;return this._dateInputElement=document.createElement("input"),this._dateInputElement.setAttribute("type","date"),this.min&&this._dateInputElement.setAttribute("min",this.min),this.max&&this._dateInputElement.setAttribute("max",this.max),this.placeholder&&(this._dateInputElement.placeholder=this.placeholder,this._dateInputElement.setAttribute("aria-label",this.placeholder)),this._dateInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dateInput"),this._dateInputElement.style.width="100%",this._dateInputElement.oninput=function(){t.valueChanged()},this.defaultValue&&(this._dateInputElement.value=this.defaultValue),this._dateInputElement},e.prototype.getJsonTypeName=function(){return"Input.Date"},e.prototype.isSet=function(){return!!this.value},e.prototype.isValid=function(){if(!this.value)return!this.isRequired;var t=new Date(this.value),e=!0;if(this.min){var i=new Date(this.min);e=e&&t>=i}if(this.max){var n=new Date(this.max);e=e&&t<=n}return e},Object.defineProperty(e.prototype,"value",{get:function(){return this._dateInputElement?this._dateInputElement.value:void 0},enumerable:!1,configurable:!0}),e.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),e.placeholderProperty=new h.StringProperty(h.Versions.v1_0,"placeholder"),e.minProperty=new h.StringProperty(h.Versions.v1_0,"min"),e.maxProperty=new h.StringProperty(h.Versions.v1_0,"max"),o([h.property(e.valueProperty)],e.prototype,"defaultValue",void 0),o([h.property(e.minProperty)],e.prototype,"min",void 0),o([h.property(e.maxProperty)],e.prototype,"max",void 0),o([h.property(e.placeholderProperty)],e.prototype,"placeholder",void 0),e}(T);e.DateInput=D;var R=function(t){function e(e,i){var n=t.call(this,e,i,(function(t,e,i,n){var r=i[e.name];if("string"==typeof r&&r&&/^[0-9]{2}:[0-9]{2}$/.test(r))return r}),(function(t,e,i,n,r){r.serializeValue(i,e.name,n)}))||this;return n.targetVersion=e,n.name=i,n}return r(e,t),e}(h.CustomProperty);e.TimeProperty=R;var L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.convertTimeStringToDate=function(t){return new Date("1973-09-04T"+t+":00Z")},e.prototype.internalRender=function(){var t=this;return this._timeInputElement=document.createElement("input"),this._timeInputElement.setAttribute("type","time"),this._timeInputElement.setAttribute("min",this.min),this._timeInputElement.setAttribute("max",this.max),this._timeInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-timeInput"),this._timeInputElement.style.width="100%",this._timeInputElement.oninput=function(){t.valueChanged()},this.placeholder&&(this._timeInputElement.placeholder=this.placeholder,this._timeInputElement.setAttribute("aria-label",this.placeholder)),this.defaultValue&&(this._timeInputElement.value=this.defaultValue),this._timeInputElement},e.prototype.getJsonTypeName=function(){return"Input.Time"},e.prototype.isSet=function(){return!!this.value},e.prototype.isValid=function(){if(!this.value)return!this.isRequired;var t=e.convertTimeStringToDate(this.value),i=!0;if(this.min){var n=e.convertTimeStringToDate(this.min);i=i&&t>=n}if(this.max){var r=e.convertTimeStringToDate(this.max);i=i&&t<=r}return i},Object.defineProperty(e.prototype,"value",{get:function(){return this._timeInputElement?this._timeInputElement.value:void 0},enumerable:!1,configurable:!0}),e.valueProperty=new R(h.Versions.v1_0,"value"),e.placeholderProperty=new h.StringProperty(h.Versions.v1_0,"placeholder"),e.minProperty=new R(h.Versions.v1_0,"min"),e.maxProperty=new R(h.Versions.v1_0,"max"),o([h.property(e.valueProperty)],e.prototype,"defaultValue",void 0),o([h.property(e.minProperty)],e.prototype,"min",void 0),o([h.property(e.maxProperty)],e.prototype,"max",void 0),o([h.property(e.placeholderProperty)],e.prototype,"placeholder",void 0),e}(T);e.TimeInput=L;var B=function(){function t(t,e){this._state=0,this.action=t,this._parentContainerStyle=e}return t.prototype.updateCssStyle=function(){var t,e;if(this.action.parent&&this.action.renderedElement){var i=this.action.parent.hostConfig;switch(this.action.renderedElement.className=i.makeCssClassName("ac-pushButton"),this._parentContainerStyle&&this.action.renderedElement.classList.add("style-"+this._parentContainerStyle),this.action.updateActionButtonCssStyle(this.action.renderedElement,this._state),this.action.renderedElement.classList.remove(i.makeCssClassName("expanded")),this.action.renderedElement.classList.remove(i.makeCssClassName("subdued")),this._state){case 1:this.action.renderedElement.classList.add(i.makeCssClassName("expanded"));break;case 2:this.action.renderedElement.classList.add(i.makeCssClassName("subdued"))}this.action.style&&(this.action.style===s.ActionStyle.Positive?(t=this.action.renderedElement.classList).add.apply(t,i.makeCssClassNames("primary","style-positive")):(e=this.action.renderedElement.classList).add.apply(e,i.makeCssClassNames("style-"+this.action.style.toLowerCase())))}},t.prototype.render=function(){var t=this;this.action.render(),this.action.renderedElement&&(this.action.renderedElement.onclick=function(e){e.preventDefault(),e.cancelBubble=!0,t.click()},this.updateCssStyle())},t.prototype.click=function(){void 0!==this.onClick&&this.onClick(this)},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(t){this._state=t,this.updateCssStyle()},enumerable:!1,configurable:!0}),t}(),M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.style=s.ActionStyle.Default,e}return r(e,t),e.prototype.getDefaultSerializationContext=function(){return new yt},e.prototype.addCssClasses=function(t){},e.prototype.internalGetReferencedInputs=function(){return{}},e.prototype.internalPrepareForExecution=function(t){},e.prototype.internalValidateInputs=function(t){var e=[];if(t)for(var i=0,n=Object.keys(t);i<n.length;i++){var r=t[n[i]];r.validateValue()||e.push(r)}return e},e.prototype.shouldSerialize=function(t){return void 0!==t.actionRegistry.findByName(this.getJsonTypeName())},e.prototype.raiseExecuteActionEvent=function(){var t,e,i;this.onExecute&&this.onExecute(this),e=(t=this).parent?t.parent.getRootElement():void 0,i=e&&e.onExecuteAction?e.onExecuteAction:ht.onExecuteAction,t.prepareForExecution()&&i&&i(t)},e.prototype.getHref=function(){return""},e.prototype.getAriaRole=function(){return"button"},e.prototype.updateActionButtonCssStyle=function(t,e){void 0===e&&(e=0)},e.prototype.parse=function(e,i){return t.prototype.parse.call(this,e,i||new yt)},e.prototype.render=function(t){void 0===t&&(t="ac-pushButton");var e=this.hostConfig,i=document.createElement("button");this.addCssClasses(i),this.accessibleTitle?i.setAttribute("aria-label",this.accessibleTitle):this.title&&i.setAttribute("aria-label",this.title),null!=this.expanded&&i.setAttribute("aria-expanded",this.expanded.toString()),i.type="button",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.setAttribute("role",this.getAriaRole());var n=document.createElement("div");if(n.style.overflow="hidden",n.style.textOverflow="ellipsis",e.actions.iconPlacement==s.ActionIconPlacement.AboveTitle||e.actions.allowTitleToWrap||(n.style.whiteSpace="nowrap"),this.title&&(n.innerText=this.title),this.iconUrl){var r=document.createElement("img");r.src=this.iconUrl,r.style.width=e.actions.iconSize+"px",r.style.height=e.actions.iconSize+"px",r.style.flex="0 0 auto",e.actions.iconPlacement==s.ActionIconPlacement.AboveTitle?(i.classList.add("iconAbove"),i.style.flexDirection="column",this.title&&(r.style.marginBottom="6px")):(i.classList.add("iconLeft"),r.style.maxHeight="100%",this.title&&(r.style.marginRight="6px")),i.appendChild(r),i.appendChild(n)}else i.classList.add("noIcon"),i.appendChild(n);this._renderedElement=i},e.prototype.execute=function(){this._actionCollection&&this._actionCollection.actionExecuted(this),this.raiseExecuteActionEvent()},e.prototype.prepareForExecution=function(){var t=this.getReferencedInputs(),e=this.internalValidateInputs(t);return e.length>0?(e[0].focus(),!1):(this.internalPrepareForExecution(t),!0)},e.prototype.remove=function(){return!!this._actionCollection&&this._actionCollection.removeAction(this)},e.prototype.getAllInputs=function(t){return void 0===t&&(t=!0),[]},e.prototype.getResourceInformation=function(){return this.iconUrl?[{url:this.iconUrl,mimeType:"image"}]:[]},e.prototype.getActionById=function(t){return this.id===t?this:void 0},e.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs()},e.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())},Object.defineProperty(e.prototype,"isPrimary",{get:function(){return this.style==s.ActionStyle.Positive},set:function(t){t?this.style=s.ActionStyle.Positive:this.style==s.ActionStyle.Positive&&(this.style=s.ActionStyle.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostConfig",{get:function(){return this.parent?this.parent.hostConfig:u.defaultHostConfig},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),e.titleProperty=new h.StringProperty(h.Versions.v1_0,"title"),e.iconUrlProperty=new h.StringProperty(h.Versions.v1_1,"iconUrl"),e.styleProperty=new h.ValueSetProperty(h.Versions.v1_2,"style",[{value:s.ActionStyle.Default},{value:s.ActionStyle.Positive},{value:s.ActionStyle.Destructive}],s.ActionStyle.Default),o([h.property(e.titleProperty)],e.prototype,"title",void 0),o([h.property(e.iconUrlProperty)],e.prototype,"iconUrl",void 0),o([h.property(e.styleProperty)],e.prototype,"style",void 0),e}(c.CardObject);e.Action=M;var F=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isPrepared=!1,e}return r(e,t),e.prototype.internalGetReferencedInputs=function(){var t={};if("none"!==this.associatedInputs){for(var e=this.parent,i=[];e;)i=i.concat(e.getAllInputs(!1)),e=e.parent;for(var n=0,r=i;n<r.length;n++){var o=r[n];o.id&&(t[o.id]=o)}}return t},e.prototype.internalPrepareForExecution=function(t){if(this._originalData?this._processedData=JSON.parse(JSON.stringify(this._originalData)):this._processedData={},this._processedData&&t)for(var e=0,i=Object.keys(t);e<i.length;e++){var n=t[i[e]];n.id&&n.isSet()&&(this._processedData[n.id]="string"==typeof n.value?n.value:n.value.toString())}this._isPrepared=!0},Object.defineProperty(e.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(t){this._originalData=t,this._isPrepared=!1},enumerable:!1,configurable:!0}),e.dataProperty=new h.PropertyDefinition(h.Versions.v1_0,"data"),e.associatedInputsProperty=new h.CustomProperty(h.Versions.v1_3,"associatedInputs",(function(t,e,i,n){var r=i[e.name];if(void 0!==r&&"string"==typeof r)return"none"===r.toLowerCase()?"none":"auto"}),(function(t,e,i,n,r){r.serializeValue(i,e.name,n)})),o([h.property(e.dataProperty)],e.prototype,"_originalData",void 0),o([h.property(e.associatedInputsProperty)],e.prototype,"associatedInputs",void 0),e}(M);e.SubmitActionBase=F;var j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getJsonTypeName=function(){return e.JsonTypeName},e.JsonTypeName="Action.Submit",e}(F);e.SubmitAction=j;var H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getJsonTypeName=function(){return e.JsonTypeName},e.JsonTypeName="Action.Execute",e.verbProperty=new h.StringProperty(h.Versions.v1_4,"verb"),o([h.property(e.verbProperty)],e.prototype,"verb",void 0),e}(F);e.ExecuteAction=H;var J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getJsonTypeName=function(){return e.JsonTypeName},e.prototype.getAriaRole=function(){return"link"},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e),this.url||e.addFailure(this,s.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("url"))},e.prototype.getHref=function(){return this.url},e.urlProperty=new h.StringProperty(h.Versions.v1_0,"url"),e.JsonTypeName="Action.OpenUrl",o([h.property(e.urlProperty)],e.prototype,"url",void 0),e}(M);e.OpenUrlAction=J;var W=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.targetElements={},e}return r(e,t),e.prototype.updateAriaControlsAttribute=function(){if(this.targetElements){var t=Object.keys(this.targetElements);this._renderedElement&&(t.length>0?this._renderedElement.setAttribute("aria-controls",t.join(" ")):this._renderedElement.removeAttribute("aria-controls"))}},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e),this.targetElements||e.addFailure(this,s.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("targetElements"))},e.prototype.getJsonTypeName=function(){return e.JsonTypeName},e.prototype.render=function(e){void 0===e&&(e="ac-pushButton"),t.prototype.render.call(this,e),this.updateAriaControlsAttribute()},e.prototype.execute=function(){if(this.parent)for(var t=0,e=Object.keys(this.targetElements);t<e.length;t++){var i=e[t],n=this.parent.getRootElement().getElementById(i);n&&("boolean"==typeof this.targetElements[i]?n.isVisible=this.targetElements[i]:n.isVisible=!n.isVisible)}},e.prototype.addTargetElement=function(t,e){void 0===e&&(e=void 0),this.targetElements[t]=e,this.updateAriaControlsAttribute()},e.prototype.removeTargetElement=function(t){delete this.targetElements[t],this.updateAriaControlsAttribute()},e.targetElementsProperty=new h.CustomProperty(h.Versions.v1_2,"targetElements",(function(t,e,i,n){var r={};if(Array.isArray(i[e.name]))for(var o=0,s=i[e.name];o<s.length;o++){var a=s[o];if("string"==typeof a)r[a]=void 0;else if("object"==typeof a){var u=a.elementId;"string"==typeof u&&(r[u]=l.parseBool(a.isVisible))}}return r}),(function(t,e,i,n,r){for(var o=[],s=0,a=Object.keys(n);s<a.length;s++){var l=a[s];"boolean"==typeof n[l]?o.push({elementId:l,isVisible:n[l]}):o.push(l)}r.serializeArray(i,e.name,o)}),{},(function(t){return{}})),e.JsonTypeName="Action.ToggleVisibility",o([h.property(e.targetElementsProperty)],e.prototype,"targetElements",void 0),e}(M);e.ToggleVisibilityAction=W;var U=function(t){function e(e,i){var n=t.call(this,e,i,void 0,(function(){return new a.StringWithSubstitutions}))||this;return n.targetVersion=e,n.name=i,n}return r(e,t),e.prototype.parse=function(t,e,i){var n=new a.StringWithSubstitutions;return n.set(l.parseString(e[this.name])),n},e.prototype.toJSON=function(t,e,i,n){n.serializeValue(e,this.name,i.getOriginal())},e}(h.PropertyDefinition),q=function(t){function e(e,i){void 0===e&&(e=""),void 0===i&&(i="");var n=t.call(this)||this;return n.name=e,n.value=i,n}return r(e,t),e.prototype.getSchemaKey=function(){return"HttpHeader"},e.prototype.getReferencedInputs=function(t,e){this._value.getReferencedInputs(t,e)},e.prototype.prepareForExecution=function(t){this._value.substituteInputValues(t,a.ContentTypes.applicationXWwwFormUrlencoded)},Object.defineProperty(e.prototype,"value",{get:function(){return this._value.get()},set:function(t){this._value.set(t)},enumerable:!1,configurable:!0}),e.nameProperty=new h.StringProperty(h.Versions.v1_0,"name"),e.valueProperty=new U(h.Versions.v1_0,"value"),o([h.property(e.nameProperty)],e.prototype,"name",void 0),o([h.property(e.valueProperty)],e.prototype,"_value",void 0),e}(h.SerializableObject);e.HttpHeader=q;var G=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._ignoreInputValidation=!1,e}return r(e,t),e.prototype.internalGetReferencedInputs=function(){var t=this.parent?this.parent.getRootElement().getAllInputs():[],e={};this._url.getReferencedInputs(t,e);for(var i=0,n=this.headers;i<n.length;i++){n[i].getReferencedInputs(t,e)}return this._body.getReferencedInputs(t,e),e},e.prototype.internalPrepareForExecution=function(t){if(t){this._url.substituteInputValues(t,a.ContentTypes.applicationXWwwFormUrlencoded);for(var e=a.ContentTypes.applicationJson,i=0,n=this.headers;i<n.length;i++){var r=n[i];r.prepareForExecution(t),r.name&&"content-type"==r.name.toLowerCase()&&(e=r.value)}this._body.substituteInputValues(t,e)}},e.prototype.getJsonTypeName=function(){return e.JsonTypeName},e.prototype.internalValidateProperties=function(e){if(t.prototype.internalValidateProperties.call(this,e),this.url||e.addFailure(this,s.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("url")),this.headers.length>0)for(var i=0,n=this.headers;i<n.length;i++){n[i].name||e.addFailure(this,s.ValidationEvent.PropertyCantBeNull,f.Strings.errors.actionHttpHeadersMustHaveNameAndValue())}},Object.defineProperty(e.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(t){this._ignoreInputValidation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._url.get()},set:function(t){this._url.set(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return this._body.get()},set:function(t){this._body.set(t)},enumerable:!1,configurable:!0}),e.urlProperty=new U(h.Versions.v1_0,"url"),e.bodyProperty=new U(h.Versions.v1_0,"body"),e.methodProperty=new h.StringProperty(h.Versions.v1_0,"method"),e.headersProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_0,"headers",q),e.ignoreInputValidationProperty=new h.BoolProperty(h.Versions.v1_3,"ignoreInputValidation",!1),e.JsonTypeName="Action.Http",o([h.property(e.urlProperty)],e.prototype,"_url",void 0),o([h.property(e.bodyProperty)],e.prototype,"_body",void 0),o([h.property(e.methodProperty)],e.prototype,"method",void 0),o([h.property(e.headersProperty)],e.prototype,"headers",void 0),o([h.property(e.ignoreInputValidationProperty)],e.prototype,"_ignoreInputValidation",void 0),e}(M);e.HttpAction=G;var K=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.card=new dt,e}return r(e,t),e.prototype.internalParse=function(e,i){t.prototype.internalParse.call(this,e,i);var n=e.card;n?this.card.parse(n,i):i.logParseEvent(this,s.ValidationEvent.PropertyCantBeNull,f.Strings.errors.showCardMustHaveCard())},e.prototype.internalToJSON=function(e,i){t.prototype.internalToJSON.call(this,e,i),this.card&&i.serializeValue(e,"card",this.card.toJSON(i))},e.prototype.addCssClasses=function(e){t.prototype.addCssClasses.call(this,e),this.parent&&e.classList.add(this.parent.hostConfig.makeCssClassName("expandable"))},e.prototype.raiseExecuteActionEvent=function(){this.hostConfig.actions.showCard.actionMode===s.ShowCardActionMode.Popup&&t.prototype.raiseExecuteActionEvent.call(this)},e.prototype.getJsonTypeName=function(){return e.JsonTypeName},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e),this.card.internalValidateProperties(e)},e.prototype.updateActionButtonCssStyle=function(e,i){void 0===i&&(i=0),t.prototype.updateActionButtonCssStyle.call(this,e),this.parent&&(e.classList.add(this.parent.hostConfig.makeCssClassName("expandable")),e.setAttribute("aria-expanded",(1===i).toString()))},e.prototype.setParent=function(e){t.prototype.setParent.call(this,e),this.card.setParent(e)},e.prototype.getAllInputs=function(t){return void 0===t&&(t=!0),this.card.getAllInputs(t)},e.prototype.getResourceInformation=function(){return t.prototype.getResourceInformation.call(this).concat(this.card.getResourceInformation())},e.prototype.getActionById=function(e){var i=t.prototype.getActionById.call(this,e);return i||(i=this.card.getActionById(e)),i},e.JsonTypeName="Action.ShowCard",e}(M);e.ShowCardAction=K;var X=function(){function t(t){this._renderedActionCount=0,this.items=[],this.buttons=[],this._owner=t}return t.prototype.isActionAllowed=function(t){var e=this._owner.getForbiddenActionTypes();if(e)for(var i=0,n=e;i<n.length;i++){var r=n[i];if(t.constructor===r)return!1}return!0},t.prototype.refreshContainer=function(){if(this._actionCardContainer.innerHTML="",this._actionCard){this._actionCardContainer.style.marginTop=this._renderedActionCount>0?this._owner.hostConfig.actions.showCard.inlineTopMargin+"px":"0px";var t=this._owner.getEffectivePadding();this._owner.getImmediateSurroundingPadding(t);var e=this._owner.hostConfig.paddingDefinitionToSpacingDefinition(t);this._actionCard&&(this._actionCard.style.paddingLeft=e.left+"px",this._actionCard.style.paddingRight=e.right+"px",this._actionCard.style.marginLeft="-"+e.left+"px",this._actionCard.style.marginRight="-"+e.right+"px",0==e.bottom||this._owner.isDesignMode()||(this._actionCard.style.paddingBottom=e.bottom+"px",this._actionCard.style.marginBottom="-"+e.bottom+"px"),l.appendChild(this._actionCardContainer,this._actionCard))}else this._actionCardContainer.style.marginTop="0px"},t.prototype.layoutChanged=function(){this._owner.getRootElement().updateLayout()},t.prototype.showActionCard=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!0),t.card.suppressStyle=e;var n=t.card.renderedElement&&!this._owner.isDesignMode()?t.card.renderedElement:t.card.render();this._actionCard=n,this._expandedAction=t,this.refreshContainer(),i&&(this.layoutChanged(),rt(t,!0))},t.prototype.collapseExpandedAction=function(){for(var t=0,e=this.buttons;t<e.length;t++){e[t].state=0}var i=this._expandedAction;this._expandedAction=void 0,this._actionCard=void 0,this.refreshContainer(),i&&(this.layoutChanged(),rt(i,!1))},t.prototype.expandShowCardAction=function(t,e){for(var i=0,n=this.buttons;i<n.length;i++){var r=n[i];r.action!==t?r.state=2:r.state=1}this.showActionCard(t,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),e)},t.prototype.getParentContainer=function(){return this._owner instanceof Q?this._owner:this._owner.getParentContainer()},t.prototype.findActionButton=function(t){for(var e=0,i=this.buttons;e<i.length;e++){var n=i[e];if(n.action==t)return n}},t.prototype.actionExecuted=function(t){t instanceof K?t===this._expandedAction?this.collapseExpandedAction():this.expandShowCardAction(t,!0):this.collapseExpandedAction()},t.prototype.parse=function(t,e){if(this.clear(),Array.isArray(t))for(var i=0,n=t;i<n.length;i++){var r=n[i],o=e.parseAction(this._owner,r,[],!this._owner.isDesignMode());o&&this.addAction(o)}},t.prototype.toJSON=function(t,e,i){i.serializeArray(t,e,this.items)},t.prototype.getActionById=function(t){for(var e=void 0,i=0,n=this.items;i<n.length;i++){if(e=n[i].getActionById(t))break}return e},t.prototype.validateProperties=function(t){this._owner.hostConfig.actions.maxActions&&this.items.length>this._owner.hostConfig.actions.maxActions&&t.addFailure(this._owner,s.ValidationEvent.TooManyActions,f.Strings.errors.tooManyActions(this._owner.hostConfig.actions.maxActions)),this.items.length>0&&!this._owner.hostConfig.supportsInteractivity&&t.addFailure(this._owner,s.ValidationEvent.InteractivityNotAllowed,f.Strings.errors.interactivityNotAllowed());for(var e=0,i=this.items;e<i.length;e++){var n=i[e];this.isActionAllowed(n)||t.addFailure(this._owner,s.ValidationEvent.ActionTypeNotAllowed,f.Strings.errors.actionTypeNotAllowed(n.getJsonTypeName())),n.internalValidateProperties(t)}},t.prototype.render=function(t,e){var i=this._owner.hostConfig;if(i.supportsInteractivity){var n=document.createElement("div"),r=i.actions.maxActions?Math.min(i.actions.maxActions,this.items.length):this.items.length;if(this._actionCardContainer=document.createElement("div"),this._renderedActionCount=0,i.actions.preExpandSingleShowCardAction&&1==r&&this.items[0]instanceof K&&this.isActionAllowed(this.items[0]))this.showActionCard(this.items[0],!0),this._renderedActionCount=1;else{var o=document.createElement("div");if(o.className=i.makeCssClassName("ac-actionSet"),o.style.display="flex",o.setAttribute("role","menubar"),t==s.Orientation.Horizontal)if(o.style.flexDirection="row",this._owner.horizontalAlignment&&i.actions.actionAlignment!=s.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case s.HorizontalAlignment.Center:o.style.justifyContent="center";break;case s.HorizontalAlignment.Right:o.style.justifyContent="flex-end";break;default:o.style.justifyContent="flex-start"}else switch(i.actions.actionAlignment){case s.ActionAlignment.Center:o.style.justifyContent="center";break;case s.ActionAlignment.Right:o.style.justifyContent="flex-end";break;default:o.style.justifyContent="flex-start"}else if(o.style.flexDirection="column",this._owner.horizontalAlignment&&i.actions.actionAlignment!=s.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case s.HorizontalAlignment.Center:o.style.alignItems="center";break;case s.HorizontalAlignment.Right:o.style.alignItems="flex-end";break;default:o.style.alignItems="flex-start"}else switch(i.actions.actionAlignment){case s.ActionAlignment.Center:o.style.alignItems="center";break;case s.ActionAlignment.Right:o.style.alignItems="flex-end";break;case s.ActionAlignment.Stretch:o.style.alignItems="stretch";break;default:o.style.alignItems="flex-start"}var a=this.getParentContainer();if(a)for(var u=a.getEffectiveStyle(),p=this.items.filter(this.isActionAllowed.bind(this)),c=0;c<p.length;c++){var h=this.findActionButton(p[c]);if(h||((h=new B(p[c],u)).onClick=function(t){t.action.execute()},this.buttons.push(h)),h.render(),h.action.renderedElement){if(p.length>1&&(h.action.renderedElement.setAttribute("aria-posinset",(c+1).toString()),h.action.renderedElement.setAttribute("aria-setsize",p.length.toString()),h.action.renderedElement.setAttribute("role","menuitem")),i.actions.actionsOrientation==s.Orientation.Horizontal&&i.actions.actionAlignment==s.ActionAlignment.Stretch?h.action.renderedElement.style.flex="0 1 100%":h.action.renderedElement.style.flex="0 1 auto",o.appendChild(h.action.renderedElement),this._renderedActionCount++,this._renderedActionCount>=i.actions.maxActions||c==this.items.length-1)break;if(i.actions.buttonSpacing>0){var d=document.createElement("div");t===s.Orientation.Horizontal?(d.style.flex="0 0 auto",d.style.width=i.actions.buttonSpacing+"px"):d.style.height=i.actions.buttonSpacing+"px",l.appendChild(o,d)}}}var f=document.createElement("div");f.style.overflow="hidden",f.appendChild(o),l.appendChild(n,f)}l.appendChild(n,this._actionCardContainer);for(var y=0,g=this.buttons;y<g.length;y++){var m=g[y];if(1==m.state){this.expandShowCardAction(m.action,!1);break}}return this._renderedActionCount>0?n:void 0}},t.prototype.addAction=function(t){if(!t)throw new Error("The action parameter cannot be null.");if(t.parent&&t.parent!==this._owner||!(this.items.indexOf(t)<0))throw new Error(f.Strings.errors.actionAlreadyParented());this.items.push(t),t.parent||t.setParent(this._owner),t._actionCollection=this},t.prototype.removeAction=function(t){this.expandedAction&&this._expandedAction==t&&this.collapseExpandedAction();var e=this.items.indexOf(t);if(e>=0){this.items.splice(e,1),t.setParent(void 0),t._actionCollection=void 0;for(var i=0;i<this.buttons.length;i++)if(this.buttons[i].action==t){this.buttons.splice(i,1);break}return!0}return!1},t.prototype.clear=function(){this.items=[],this.buttons=[],this._expandedAction=void 0,this._renderedActionCount=0},t.prototype.getAllInputs=function(t){void 0===t&&(t=!0);var e=[];if(t)for(var i=0,n=this.items;i<n.length;i++){var r=n[i];e=e.concat(r.getAllInputs())}return e},t.prototype.getResourceInformation=function(){for(var t=[],e=0,i=this.items;e<i.length;e++){var n=i[e];t=t.concat(n.getResourceInformation())}return t},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return this._renderedActionCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:!1,configurable:!0}),t}(),$=function(t){function e(){var e=t.call(this)||this;return e._actionCollection=new X(e),e}return r(e,t),e.prototype.internalParse=function(e,i){t.prototype.internalParse.call(this,e,i),this._actionCollection.parse(e.actions,i)},e.prototype.internalToJSON=function(e,i){t.prototype.internalToJSON.call(this,e,i),this._actionCollection.toJSON(e,"actions",i)},e.prototype.internalRender=function(){return this._actionCollection.render(void 0!==this.orientation?this.orientation:this.hostConfig.actions.actionsOrientation,this.isDesignMode())},e.prototype.isBleedingAtBottom=function(){return 0==this._actionCollection.renderedActionCount?t.prototype.isBleedingAtBottom.call(this):1==this._actionCollection.items.length?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},e.prototype.getJsonTypeName=function(){return"ActionSet"},e.prototype.getActionCount=function(){return this._actionCollection.items.length},e.prototype.getActionAt=function(e){return e>=0&&e<this.getActionCount()?this._actionCollection.items[e]:t.prototype.getActionAt.call(this,e)},e.prototype.getActionById=function(e){var i=this._actionCollection.getActionById(e);return i||t.prototype.getActionById.call(this,e)},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e),this._actionCollection.validateProperties(e)},e.prototype.addAction=function(t){this._actionCollection.addAction(t)},e.prototype.getAllInputs=function(t){return void 0===t&&(t=!0),t?this._actionCollection.getAllInputs():[]},e.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()},e.prototype.findDOMNodeOwner=function(e){for(var i=void 0,n=0,r=this._actionCollection.items;n<r.length;n++){if(i=r[n].findDOMNodeOwner(e))return i}return t.prototype.findDOMNodeOwner.call(this,e)},Object.defineProperty(e.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),e.orientationProperty=new h.EnumProperty(h.Versions.v1_1,"orientation",s.Orientation),o([h.property(e.orientationProperty)],e.prototype,"orientation",void 0),e}(y);e.ActionSet=$;var Y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._bleed=!1,e}return r(e,t),Object.defineProperty(e.prototype,"style",{get:function(){if(this.allowCustomStyle){var t=this.getValue(e.styleProperty);if(t&&this.hostConfig.containerStyles.getStyleByName(t))return t}},set:function(t){this.setValue(e.styleProperty,t)},enumerable:!1,configurable:!0}),e.prototype.adjustRenderedElementSize=function(e){t.prototype.adjustRenderedElementSize.call(this,e),this.minPixelHeight&&(e.style.minHeight=this.minPixelHeight+"px")},e.prototype.applyBackground=function(){if(this.renderedElement){var t=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(t.backgroundColor){var e=l.stringToCssColor(t.backgroundColor);this.renderedElement.style.backgroundColor=e,this.renderedElement.style.border="1px solid "+e}}},e.prototype.applyPadding=function(){if(t.prototype.applyPadding.call(this),this.renderedElement){var e=new a.SpacingDefinition;if(this.getEffectivePadding()&&(e=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=e.top+"px",this.renderedElement.style.paddingRight=e.right+"px",this.renderedElement.style.paddingBottom=e.bottom+"px",this.renderedElement.style.paddingLeft=e.left+"px",this.isBleeding()){var i=new a.PaddingDefinition;this.getImmediateSurroundingPadding(i);var n=this.hostConfig.paddingDefinitionToSpacingDefinition(i);this.renderedElement.style.marginRight="-"+n.right+"px",this.renderedElement.style.marginLeft="-"+n.left+"px",this.isDesignMode()||(this.renderedElement.style.marginTop="-"+n.top+"px",this.renderedElement.style.marginBottom="-"+n.bottom+"px"),this.separatorElement&&this.separatorOrientation==s.Orientation.Horizontal&&(this.separatorElement.style.marginLeft="-"+n.left+"px",this.separatorElement.style.marginRight="-"+n.right+"px")}else this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0",this.renderedElement.style.marginTop="0",this.renderedElement.style.marginBottom="0",this.separatorElement&&this.separatorOrientation===s.Orientation.Horizontal&&(this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0")}},e.prototype.getHasBackground=function(){for(var t=this.parent;t;){var i=t instanceof Q&&t.backgroundImage.isValid();if(t instanceof e&&this.hasExplicitStyle&&(t.getEffectiveStyle()!=this.getEffectiveStyle()||i))return!0;t=t.parent}return!1},e.prototype.getDefaultPadding=function(){return this.getHasBackground()?new a.PaddingDefinition(s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding):t.prototype.getDefaultPadding.call(this)},e.prototype.getHasExpandedAction=function(){return!1},e.prototype.getBleed=function(){return this._bleed},e.prototype.setBleed=function(t){this._bleed=t},Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasExplicitStyle",{get:function(){return void 0!==this.getValue(e.styleProperty)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allowCustomStyle",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isBleeding=function(){return(this.getHasBackground()||this.hostConfig.alwaysAllowBleed)&&this.getBleed()},e.prototype.internalValidateProperties=function(i){t.prototype.internalValidateProperties.call(this,i);var n=this.getValue(e.styleProperty);void 0!==n&&(this.hostConfig.containerStyles.getStyleByName(n)||i.addFailure(this,s.ValidationEvent.InvalidPropertyValue,f.Strings.errors.invalidPropertyValue(n,"style")))},e.prototype.render=function(){var e=t.prototype.render.call(this);return e&&this.getHasBackground()&&this.applyBackground(),e},e.prototype.getEffectiveStyle=function(){var e=this.style;return e||t.prototype.getEffectiveStyle.call(this)},e.styleProperty=new h.ValueSetProperty(h.Versions.v1_0,"style",[{value:s.ContainerStyle.Default},{value:s.ContainerStyle.Emphasis},{targetVersion:h.Versions.v1_2,value:s.ContainerStyle.Accent},{targetVersion:h.Versions.v1_2,value:s.ContainerStyle.Good},{targetVersion:h.Versions.v1_2,value:s.ContainerStyle.Attention},{targetVersion:h.Versions.v1_2,value:s.ContainerStyle.Warning}]),e.bleedProperty=new h.BoolProperty(h.Versions.v1_2,"bleed",!1),e.minHeightProperty=new h.PixelSizeProperty(h.Versions.v1_2,"minHeight"),o([h.property(e.styleProperty)],e.prototype,"style",null),o([h.property(e.bleedProperty)],e.prototype,"_bleed",void 0),o([h.property(e.minHeightProperty)],e.prototype,"minPixelHeight",void 0),e}(P);e.StylableCardElementContainer=Y;var Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getSchemaKey=function(){return"BackgroundImage"},e.prototype.internalParse=function(e,i){if("string"!=typeof e)return t.prototype.internalParse.call(this,e,i);this.resetDefaultValues(),this.url=e},e.prototype.apply=function(t){if(this.url&&t.renderedElement){switch(t.renderedElement.style.backgroundImage="url('"+t.preProcessPropertyValue(e.urlProperty,this.url)+"')",this.fillMode){case s.FillMode.Repeat:t.renderedElement.style.backgroundRepeat="repeat";break;case s.FillMode.RepeatHorizontally:t.renderedElement.style.backgroundRepeat="repeat-x";break;case s.FillMode.RepeatVertically:t.renderedElement.style.backgroundRepeat="repeat-y";break;case s.FillMode.Cover:default:t.renderedElement.style.backgroundRepeat="no-repeat",t.renderedElement.style.backgroundSize="cover"}switch(this.horizontalAlignment){case s.HorizontalAlignment.Center:t.renderedElement.style.backgroundPositionX="center";break;case s.HorizontalAlignment.Right:t.renderedElement.style.backgroundPositionX="right"}switch(this.verticalAlignment){case s.VerticalAlignment.Center:t.renderedElement.style.backgroundPositionY="center";break;case s.VerticalAlignment.Bottom:t.renderedElement.style.backgroundPositionY="bottom"}}},e.prototype.isValid=function(){return!!this.url},e.urlProperty=new h.StringProperty(h.Versions.v1_0,"url"),e.fillModeProperty=new h.EnumProperty(h.Versions.v1_2,"fillMode",s.FillMode,s.FillMode.Cover),e.horizontalAlignmentProperty=new h.EnumProperty(h.Versions.v1_2,"horizontalAlignment",s.HorizontalAlignment,s.HorizontalAlignment.Left),e.verticalAlignmentProperty=new h.EnumProperty(h.Versions.v1_2,"verticalAlignment",s.VerticalAlignment,s.VerticalAlignment.Top),o([h.property(e.urlProperty)],e.prototype,"url",void 0),o([h.property(e.fillModeProperty)],e.prototype,"fillMode",void 0),o([h.property(e.horizontalAlignmentProperty)],e.prototype,"horizontalAlignment",void 0),o([h.property(e.verticalAlignmentProperty)],e.prototype,"verticalAlignment",void 0),e}(h.SerializableObject);e.BackgroundImage=Z;var Q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.verticalContentAlignment=s.VerticalAlignment.Top,e._items=[],e._renderedItems=[],e}return r(e,t),Object.defineProperty(e.prototype,"backgroundImage",{get:function(){return this.getValue(e.backgroundImageProperty)},enumerable:!1,configurable:!0}),e.prototype.insertItemAt=function(t,e,i){if(t.parent&&!i)throw new Error(f.Strings.errors.elementAlreadyParented());if(!t.isStandalone)throw new Error(f.Strings.errors.elementTypeNotStandalone(t.getJsonTypeName()));e<0||e>=this._items.length?this._items.push(t):this._items.splice(e,0,t),t.setParent(this)},e.prototype.supportsExcplitiHeight=function(){return!0},e.prototype.getItemsCollectionPropertyName=function(){return"items"},e.prototype.applyBackground=function(){this.backgroundImage.isValid()&&this.renderedElement&&this.backgroundImage.apply(this),t.prototype.applyBackground.call(this)},e.prototype.internalRender=function(){this._renderedItems=[];var t=this.hostConfig,e=document.createElement("div");switch(void 0!==this.rtl&&this.rtl&&(e.dir="rtl"),e.classList.add(t.makeCssClassName("ac-container")),e.style.display="flex",e.style.flexDirection="column",a.GlobalSettings.useAdvancedCardBottomTruncation&&(e.style.minHeight="-webkit-min-content"),this.verticalContentAlignment){case s.VerticalAlignment.Center:e.style.justifyContent="center";break;case s.VerticalAlignment.Bottom:e.style.justifyContent="flex-end";break;default:e.style.justifyContent="flex-start"}if(this._items.length>0)for(var i=0,n=this._items;i<n.length;i++){var r=n[i],o=this.isElementAllowed(r)?r.render():void 0;o&&(this._renderedItems.length>0&&r.separatorElement&&(r.separatorElement.style.flex="0 0 auto",l.appendChild(e,r.separatorElement)),l.appendChild(e,o),this._renderedItems.push(r))}else if(this.isDesignMode()){var u=this.createPlaceholderElement();u.style.width="100%",u.style.height="100%",e.appendChild(u)}return e},e.prototype.truncateOverflow=function(t){if(this.renderedElement){for(var e=this.renderedElement.offsetTop+t+1,i=function(t){var n=t.renderedElement;if(n)switch(l.getFitStatus(n,e)){case s.ContainerFitStatus.FullyInContainer:t.resetOverflow()&&i(t);break;case s.ContainerFitStatus.Overflowing:var r=e-n.offsetTop;t.handleOverflow(r);break;case s.ContainerFitStatus.FullyOutOfContainer:t.handleOverflow(0)}},n=0,r=this._items;n<r.length;n++){var o=r[n];i(o)}return!0}return!1},e.prototype.undoOverflowTruncation=function(){for(var t=0,e=this._items;t<e.length;t++){e[t].resetOverflow()}},e.prototype.getHasBackground=function(){return this.backgroundImage.isValid()||t.prototype.getHasBackground.call(this)},e.prototype.internalParse=function(e,i){t.prototype.internalParse.call(this,e,i),this.clear(),this.setShouldFallback(!1);var n=e[this.getItemsCollectionPropertyName()];if(Array.isArray(n))for(var r=0,o=n;r<o.length;r++){var s=o[r],a=i.parseElement(this,s,!this.isDesignMode());a&&this.insertItemAt(a,-1,!0)}},e.prototype.internalToJSON=function(e,i){t.prototype.internalToJSON.call(this,e,i),i.serializeArray(e,this.getItemsCollectionPropertyName(),this._items)},Object.defineProperty(e.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.getItemCount=function(){return this._items.length},e.prototype.getItemAt=function(t){return this._items[t]},e.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var t=0,e=this._renderedItems;t<e.length;t++){var i=e[t];if(i.isVisible)return i}},e.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var t=this._renderedItems.length-1;t>=0;t--)if(this._renderedItems[t].isVisible)return this._renderedItems[t]},e.prototype.getJsonTypeName=function(){return"Container"},e.prototype.isFirstElement=function(t){for(var e=this.isDesignMode(),i=0,n=this._items;i<n.length;i++){var r=n[i];if(r.isVisible||e)return r==t}return!1},e.prototype.isLastElement=function(t){for(var e=this.isDesignMode(),i=this._items.length-1;i>=0;i--)if(this._items[i].isVisible||e)return this._items[i]==t;return!1},e.prototype.isRtl=function(){if(void 0!==this.rtl)return this.rtl;var t=this.getParentContainer();return!!t&&t.isRtl()},e.prototype.isBleedingAtTop=function(){var t=this.getFirstVisibleRenderedItem();return this.isBleeding()||!!t&&t.isBleedingAtTop()},e.prototype.isBleedingAtBottom=function(){var t=this.getLastVisibleRenderedItem();return this.isBleeding()||!!t&&(t.isBleedingAtBottom()&&t.getEffectiveStyle()==this.getEffectiveStyle())},e.prototype.indexOf=function(t){return this._items.indexOf(t)},e.prototype.addItem=function(t){this.insertItemAt(t,-1,!1)},e.prototype.insertItemBefore=function(t,e){this.insertItemAt(t,this._items.indexOf(e),!1)},e.prototype.insertItemAfter=function(t,e){this.insertItemAt(t,this._items.indexOf(e)+1,!1)},e.prototype.removeItem=function(t){var e=this._items.indexOf(t);return e>=0&&(this._items.splice(e,1),t.setParent(void 0),this.updateLayout(),!0)},e.prototype.clear=function(){this._items=[],this._renderedItems=[]},e.prototype.getResourceInformation=function(){var e=t.prototype.getResourceInformation.call(this);return this.backgroundImage.isValid()&&e.push({url:this.backgroundImage.url,mimeType:"image"}),e},e.prototype.getActionById=function(e){var i=t.prototype.getActionById.call(this,e);if(!i&&(this.selectAction&&(i=this.selectAction.getActionById(e)),!i))for(var n=0,r=this._items;n<r.length;n++){if(i=r[n].getActionById(e))break}return i},Object.defineProperty(e.prototype,"padding",{get:function(){return this.getPadding()},set:function(t){this.setPadding(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectAction",{get:function(){return this._selectAction},set:function(t){this._selectAction=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bleed",{get:function(){return this.getBleed()},set:function(t){this.setBleed(t)},enumerable:!1,configurable:!0}),e.backgroundImageProperty=new h.SerializableObjectProperty(h.Versions.v1_0,"backgroundImage",Z),e.verticalContentAlignmentProperty=new h.EnumProperty(h.Versions.v1_1,"verticalContentAlignment",s.VerticalAlignment,s.VerticalAlignment.Top),e.rtlProperty=new h.BoolProperty(h.Versions.v1_0,"rtl"),o([h.property(e.backgroundImageProperty)],e.prototype,"backgroundImage",null),o([h.property(e.verticalContentAlignmentProperty)],e.prototype,"verticalContentAlignment",void 0),o([h.property(e.rtlProperty)],e.prototype,"rtl",void 0),e}(Y);e.Container=Q;var tt=function(t){function e(e){void 0===e&&(e="stretch");var i=t.call(this)||this;return i.width="stretch",i._computedWeight=0,i.width=e,i}return r(e,t),e.prototype.adjustRenderedElementSize=function(t){this.isDesignMode()?(t.style.minWidth="20px",t.style.minHeight=(this.minPixelHeight?Math.max(this.minPixelHeight,20):20)+"px"):(t.style.minWidth="0",this.minPixelHeight&&(t.style.minHeight=this.minPixelHeight+"px")),"auto"===this.width?t.style.flex="0 1 auto":"stretch"===this.width?t.style.flex="1 1 50px":this.width instanceof a.SizeAndUnit&&(this.width.unit==s.SizeUnit.Pixel?(t.style.flex="0 0 auto",t.style.width=this.width.physicalSize+"px"):t.style.flex="1 1 "+(this._computedWeight>0?this._computedWeight:this.width.physicalSize)+"%")},e.prototype.shouldSerialize=function(t){return!0},Object.defineProperty(e.prototype,"separatorOrientation",{get:function(){return s.Orientation.Vertical},enumerable:!1,configurable:!0}),e.prototype.getJsonTypeName=function(){return"Column"},Object.defineProperty(e.prototype,"hasVisibleSeparator",{get:function(){return!!(this.parent&&this.parent instanceof et)&&(void 0!==this.separatorElement&&!this.parent.isLeftMostElement(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),e.widthProperty=new h.CustomProperty(h.Versions.v1_0,"width",(function(t,e,i,n){var r=e.defaultValue,o=i[e.name],l=!1;if("number"!=typeof o||isNaN(o))if("auto"===o||"stretch"===o)r=o;else if("string"==typeof o)try{(r=a.SizeAndUnit.parse(o)).unit===s.SizeUnit.Pixel&&e.targetVersion.compareTo(n.targetVersion)>0&&(l=!0)}catch(t){l=!0}else l=!0;else r=new a.SizeAndUnit(o,s.SizeUnit.Weight);return l&&(n.logParseEvent(t,s.ValidationEvent.InvalidPropertyValue,f.Strings.errors.invalidColumnWidth(o)),r="auto"),r}),(function(t,e,i,n,r){n instanceof a.SizeAndUnit?n.unit===s.SizeUnit.Pixel?r.serializeValue(i,"width",n.physicalSize+"px"):r.serializeNumber(i,"width",n.physicalSize):r.serializeValue(i,"width",n)}),"stretch"),o([h.property(e.widthProperty)],e.prototype,"width",void 0),e}(Q);e.Column=tt;var et=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._columns=[],e}return r(e,t),e.prototype.createColumnInstance=function(t,e){return e.parseCardObject(this,t,[],!this.isDesignMode(),(function(t){return t&&"Column"!==t?void 0:new tt}),(function(t,i){e.logParseEvent(void 0,s.ValidationEvent.ElementTypeNotAllowed,f.Strings.errors.elementTypeNotAllowed(t))}))},e.prototype.internalRender=function(){if(this._renderedColumns=[],this._columns.length>0){var t=this.hostConfig,e=document.createElement("div");switch(e.className=t.makeCssClassName("ac-columnSet"),e.style.display="flex",a.GlobalSettings.useAdvancedCardBottomTruncation&&(e.style.minHeight="-webkit-min-content"),this.horizontalAlignment){case s.HorizontalAlignment.Center:e.style.justifyContent="center";break;case s.HorizontalAlignment.Right:e.style.justifyContent="flex-end";break;default:e.style.justifyContent="flex-start"}for(var i=0,n=0,r=this._columns;n<r.length;n++){(p=r[n]).width instanceof a.SizeAndUnit&&p.width.unit==s.SizeUnit.Weight&&(i+=p.width.physicalSize)}for(var o=0,u=this._columns;o<u.length;o++){var p;if((p=u[o]).width instanceof a.SizeAndUnit&&p.width.unit==s.SizeUnit.Weight&&i>0){var c=100/i*p.width.physicalSize;p._computedWeight=c}var h=p.render();h&&(this._renderedColumns.length>0&&p.separatorElement&&(p.separatorElement.style.flex="0 0 auto",l.appendChild(e,p.separatorElement)),l.appendChild(e,h),this._renderedColumns.push(p))}return this._renderedColumns.length>0?e:void 0}},e.prototype.truncateOverflow=function(t){for(var e=0,i=this._columns;e<i.length;e++){i[e].handleOverflow(t)}return!0},e.prototype.undoOverflowTruncation=function(){for(var t=0,e=this._columns;t<e.length;t++){e[t].resetOverflow()}},Object.defineProperty(e.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.internalParse=function(e,i){t.prototype.internalParse.call(this,e,i),this._columns=[],this._renderedColumns=[];var n=e.columns;if(Array.isArray(n))for(var r=0,o=n;r<o.length;r++){var s=o[r],a=this.createColumnInstance(s,i);a&&this._columns.push(a)}},e.prototype.internalToJSON=function(e,i){t.prototype.internalToJSON.call(this,e,i),i.serializeArray(e,"columns",this._columns)},e.prototype.isFirstElement=function(t){for(var e=0,i=this._columns;e<i.length;e++){var n=i[e];if(n.isVisible)return n==t}return!1},e.prototype.isBleedingAtTop=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var t=0,e=this._columns;t<e.length;t++){if(e[t].isBleedingAtTop())return!0}return!1},e.prototype.isBleedingAtBottom=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var t=0,e=this._columns;t<e.length;t++){if(e[t].isBleedingAtBottom())return!0}return!1},e.prototype.getItemCount=function(){return this._columns.length},e.prototype.getFirstVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[0]:void 0},e.prototype.getLastVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[this._renderedColumns.length-1]:void 0},e.prototype.getColumnAt=function(t){return this._columns[t]},e.prototype.getItemAt=function(t){return this.getColumnAt(t)},e.prototype.getJsonTypeName=function(){return"ColumnSet"},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e);for(var i=0,n=0,r=0,o=this._columns;r<o.length;r++){var a=o[r];"number"==typeof a.width?i++:"stretch"===a.width&&n++}i>0&&n>0&&e.addFailure(this,s.ValidationEvent.Hint,f.Strings.hints.dontUseWeightedAndStrecthedColumnsInSameSet())},e.prototype.addColumn=function(t){if(t.parent)throw new Error(f.Strings.errors.columnAlreadyBelongsToAnotherSet());this._columns.push(t),t.setParent(this)},e.prototype.removeItem=function(t){if(t instanceof tt){var e=this._columns.indexOf(t);if(e>=0)return this._columns.splice(e,1),t.setParent(void 0),this.updateLayout(),!0}return!1},e.prototype.indexOf=function(t){return t instanceof tt?this._columns.indexOf(t):-1},e.prototype.isLeftMostElement=function(t){return 0==this._columns.indexOf(t)},e.prototype.isRightMostElement=function(t){return this._columns.indexOf(t)==this._columns.length-1},e.prototype.isTopElement=function(t){return this._columns.indexOf(t)>=0},e.prototype.isBottomElement=function(t){return this._columns.indexOf(t)>=0},e.prototype.getActionById=function(t){for(var e=void 0,i=0,n=this._columns;i<n.length;i++){if(e=n[i].getActionById(t))break}return e},Object.defineProperty(e.prototype,"bleed",{get:function(){return this.getBleed()},set:function(t){this.setBleed(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return this.getPadding()},set:function(t){this.setPadding(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectAction",{get:function(){return this._selectAction},set:function(t){this._selectAction=t},enumerable:!1,configurable:!0}),e}(Y);function it(t){var e=t.getRootElement(),i=e&&e.onImageLoaded?e.onImageLoaded:ht.onImageLoaded;i&&i(t)}function nt(t,e,i){var n=t.getRootElement(),r=n&&n.onAnchorClicked?n.onAnchorClicked:ht.onAnchorClicked;return void 0!==r&&r(t,e,i)}function rt(t,e){var i=t.parent?t.parent.getRootElement():void 0,n=i&&i.onInlineCardExpanded?i.onInlineCardExpanded:ht.onInlineCardExpanded;n&&n(t,e)}function ot(t,e){void 0===e&&(e=!0);var i=t.getRootElement();e&&i.updateLayout();var n=i,r=n&&n.onElementVisibilityChanged?n.onElementVisibilityChanged:ht.onElementVisibilityChanged;void 0!==r&&r(t)}e.ColumnSet=et;var st=function(t){function e(){var e=t.call(this)||this;return e._actionCollection=new X(e),e}return r(e,t),e.prototype.internalParse=function(e,i){t.prototype.internalParse.call(this,e,i),this._actionCollection.parse(e.actions,i)},e.prototype.internalToJSON=function(e,i){t.prototype.internalToJSON.call(this,e,i),this._actionCollection.toJSON(e,"actions",i)},e.prototype.internalRender=function(){var e=t.prototype.internalRender.call(this);if(e){var i=this._actionCollection.render(this.hostConfig.actions.actionsOrientation,!1);return i&&(l.appendChild(e,l.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing)},s.Orientation.Horizontal)),l.appendChild(e,i)),this.renderIfEmpty?e:e.children.length>0?e:void 0}},e.prototype.getHasExpandedAction=function(){return 0!=this.renderedActionCount&&(1==this.renderedActionCount?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction)},Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderIfEmpty",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getActionCount=function(){return this._actionCollection.items.length},e.prototype.getActionAt=function(e){return e>=0&&e<this.getActionCount()?this._actionCollection.items[e]:t.prototype.getActionAt.call(this,e)},e.prototype.getActionById=function(e){var i=this._actionCollection.getActionById(e);return i||t.prototype.getActionById.call(this,e)},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e),this._actionCollection&&this._actionCollection.validateProperties(e)},e.prototype.isLastElement=function(e){return t.prototype.isLastElement.call(this,e)&&0==this._actionCollection.items.length},e.prototype.addAction=function(t){this._actionCollection.addAction(t)},e.prototype.clear=function(){t.prototype.clear.call(this),this._actionCollection.clear()},e.prototype.getAllInputs=function(e){void 0===e&&(e=!0);var i=t.prototype.getAllInputs.call(this,e);return e&&(i=i.concat(this._actionCollection.getAllInputs(e))),i},e.prototype.getResourceInformation=function(){return t.prototype.getResourceInformation.call(this).concat(this._actionCollection.getResourceInformation())},e.prototype.isBleedingAtBottom=function(){return 0==this._actionCollection.renderedActionCount?t.prototype.isBleedingAtBottom.call(this):1==this._actionCollection.items.length?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},Object.defineProperty(e.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),e}(Q);e.ContainerWithActions=st;var at=function(t){function e(e,i){var n=t.call(this,e,i,void 0)||this;return n.targetVersion=e,n.name=i,n}return r(e,t),e.prototype.parse=function(t,e,i){var n=i.parseAction(t.parent,e[this.name],[],!1);if(void 0!==n){if(n instanceof H)return n;i.logParseEvent(t,s.ValidationEvent.ActionTypeNotAllowed,f.Strings.errors.actionTypeNotAllowed(n.getJsonTypeName()))}i.logParseEvent(t,s.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("action"))},e.prototype.toJSON=function(t,e,i,n){n.serializeValue(e,this.name,i?i.toJSON(n):void 0,void 0,!0)},e}(h.PropertyDefinition);e.RefreshActionProperty=at;var lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"action",{get:function(){return this.getValue(e.actionProperty)},set:function(t){this.setValue(e.actionProperty,t),t&&t.setParent(this.parent)},enumerable:!1,configurable:!0}),e.prototype.getSchemaKey=function(){return"RefreshDefinition"},e.actionProperty=new at(h.Versions.v1_4,"action"),e.userIdsProperty=new h.StringArrayProperty(h.Versions.v1_4,"userIds"),o([h.property(e.actionProperty)],e.prototype,"action",null),o([h.property(e.userIdsProperty)],e.prototype,"userIds",void 0),e}(h.SerializableObject);e.RefreshDefinition=lt;var ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getSchemaKey=function(){return"AuthCardButton"},e.typeProperty=new h.StringProperty(h.Versions.v1_4,"type"),e.titleProperty=new h.StringProperty(h.Versions.v1_4,"title"),e.imageProperty=new h.StringProperty(h.Versions.v1_4,"image"),e.valueProperty=new h.StringProperty(h.Versions.v1_4,"value"),o([h.property(e.typeProperty)],e.prototype,"type",void 0),o([h.property(e.titleProperty)],e.prototype,"title",void 0),o([h.property(e.imageProperty)],e.prototype,"image",void 0),o([h.property(e.valueProperty)],e.prototype,"value",void 0),e}(h.SerializableObject);e.AuthCardButton=ut;var pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getSchemaKey=function(){return"TokenExchangeResource"},e.idProperty=new h.StringProperty(h.Versions.v1_4,"id"),e.uriProperty=new h.StringProperty(h.Versions.v1_4,"uri"),e.providerIdProperty=new h.StringProperty(h.Versions.v1_4,"providerId"),o([h.property(e.idProperty)],e.prototype,"id",void 0),o([h.property(e.uriProperty)],e.prototype,"uri",void 0),o([h.property(e.providerIdProperty)],e.prototype,"providerId",void 0),e}(h.SerializableObject);e.TokenExchangeResource=pt;var ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getSchemaKey=function(){return"Authentication"},e.textProperty=new h.StringProperty(h.Versions.v1_4,"text"),e.connectionNameProperty=new h.StringProperty(h.Versions.v1_4,"connectionName"),e.buttonsProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_4,"buttons",ut),e.tokenExchangeResourceProperty=new h.SerializableObjectProperty(h.Versions.v1_4,"tokenExchangeResource",pt,!0),o([h.property(e.textProperty)],e.prototype,"text",void 0),o([h.property(e.connectionNameProperty)],e.prototype,"connectionName",void 0),o([h.property(e.buttonsProperty)],e.prototype,"buttons",void 0),o([h.property(e.tokenExchangeResourceProperty)],e.prototype,"tokenExchangeResource",void 0),e}(h.SerializableObject);e.Authentication=ct;var ht=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.designMode=!1,e}return r(e,t),Object.defineProperty(e.prototype,"refresh",{get:function(){return this.getValue(e.refreshProperty)},set:function(t){this.setValue(e.refreshProperty,t),t&&(t.parent=this)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"processMarkdown",{get:function(){throw new Error(f.Strings.errors.processMarkdownEventRemoved())},set:function(t){throw new Error(f.Strings.errors.processMarkdownEventRemoved())},enumerable:!1,configurable:!0}),e.applyMarkdown=function(t){var i={didProcess:!1};if(e.onProcessMarkdown)e.onProcessMarkdown(t,i);else if(window.markdownit){var n=window.markdownit;i.outputHtml=n().render(t),i.didProcess=!0}return i},e.prototype.isVersionSupported=function(){return!!this.bypassVersionCheck||!(!this.version||!this.version.isValid||this.maxVersion.major<this.version.major||this.maxVersion.major==this.version.major&&this.maxVersion.minor<this.version.minor)},e.prototype.getDefaultSerializationContext=function(){return new yt(this.version)},e.prototype.getItemsCollectionPropertyName=function(){return"body"},e.prototype.internalParse=function(i,n){this._fallbackCard=void 0;var r=n.parseElement(void 0,i.fallback,!this.isDesignMode());r&&(this._fallbackCard=new e,this._fallbackCard.addItem(r)),t.prototype.internalParse.call(this,i,n)},e.prototype.internalToJSON=function(i,n){this.setValue(e.versionProperty,n.targetVersion),t.prototype.internalToJSON.call(this,i,n)},e.prototype.internalRender=function(){var e=t.prototype.internalRender.call(this);return a.GlobalSettings.useAdvancedCardBottomTruncation&&e&&e.style.removeProperty("minHeight"),e},e.prototype.getHasBackground=function(){return!0},e.prototype.getDefaultPadding=function(){return new a.PaddingDefinition(s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding)},e.prototype.shouldSerialize=function(t){return!0},Object.defineProperty(e.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bypassVersionCheck",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasBackground",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.getJsonTypeName=function(){return"AdaptiveCard"},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e),"AdaptiveCard"!==this.getValue(y.typeNameProperty)&&e.addFailure(this,s.ValidationEvent.MissingCardType,f.Strings.errors.invalidCardType()),this.bypassVersionCheck||this.version?this.isVersionSupported()||e.addFailure(this,s.ValidationEvent.UnsupportedCardVersion,f.Strings.errors.unsupportedCardVersion(this.version.toString(),this.maxVersion.toString())):e.addFailure(this,s.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("version"))},e.prototype.render=function(e){var i;return this.shouldFallback()&&this._fallbackCard?(this._fallbackCard.hostConfig=this.hostConfig,i=this._fallbackCard.render()):(i=t.prototype.render.call(this))&&(i.classList.add(this.hostConfig.makeCssClassName("ac-adaptiveCard")),a.GlobalSettings.setTabIndexAtCardRoot&&(i.tabIndex=0),this.speak&&i.setAttribute("aria-label",this.speak)),e&&(l.appendChild(e,i),this.updateLayout()),i},e.prototype.updateLayout=function(e){if(void 0===e&&(e=!0),t.prototype.updateLayout.call(this,e),a.GlobalSettings.useAdvancedCardBottomTruncation&&this.isDisplayed()){var i=this.hostConfig.getEffectiveSpacing(s.Spacing.Default);this.handleOverflow(this.renderedElement.offsetHeight-i)}},e.prototype.shouldFallback=function(){return t.prototype.shouldFallback.call(this)||!this.isVersionSupported()},Object.defineProperty(e.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),e.schemaUrl="http://adaptivecards.io/schemas/adaptive-card.json",e.$schemaProperty=new h.CustomProperty(h.Versions.v1_0,"$schema",(function(t,i,n,r){return e.schemaUrl}),(function(t,i,n,r,o){o.serializeValue(n,i.name,e.schemaUrl)})),e.versionProperty=new h.CustomProperty(h.Versions.v1_0,"version",(function(t,e,i,n){var r=h.Version.parse(i[e.name],n);return void 0===r&&(r=h.Versions.latest,n.logParseEvent(t,s.ValidationEvent.InvalidPropertyValue,f.Strings.errors.invalidCardVersion(r.toString()))),r}),(function(t,e,i,n,r){void 0!==n&&r.serializeValue(i,e.name,n.toString())}),h.Versions.v1_0),e.fallbackTextProperty=new h.StringProperty(h.Versions.v1_0,"fallbackText"),e.speakProperty=new h.StringProperty(h.Versions.v1_0,"speak"),e.refreshProperty=new h.SerializableObjectProperty(h.Versions.v1_4,"refresh",lt,!0),e.authenticationProperty=new h.SerializableObjectProperty(h.Versions.v1_4,"authentication",ct,!0),o([h.property(e.versionProperty)],e.prototype,"version",void 0),o([h.property(e.fallbackTextProperty)],e.prototype,"fallbackText",void 0),o([h.property(e.speakProperty)],e.prototype,"speak",void 0),o([h.property(e.refreshProperty)],e.prototype,"refresh",null),o([h.property(e.authenticationProperty)],e.prototype,"authentication",void 0),e}(st);e.AdaptiveCard=ht;var dt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.suppressStyle=!1,e}return r(e,t),e.prototype.getSchemaKey=function(){return"InlineAdaptiveCard"},e.prototype.populateSchema=function(e){t.prototype.populateSchema.call(this,e),e.remove(ht.$schemaProperty,ht.versionProperty)},e.prototype.getDefaultPadding=function(){return new a.PaddingDefinition(this.suppressStyle?s.Spacing.None:s.Spacing.Padding,s.Spacing.Padding,this.suppressStyle?s.Spacing.None:s.Spacing.Padding,s.Spacing.Padding)},Object.defineProperty(e.prototype,"bypassVersionCheck",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultStyle",{get:function(){return this.suppressStyle?s.ContainerStyle.Default:this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:s.ContainerStyle.Emphasis},enumerable:!1,configurable:!0}),e.prototype.render=function(e){var i=t.prototype.render.call(this,e);return i&&(i.setAttribute("aria-live","polite"),i.removeAttribute("tabindex")),i},e}(ht),ft=function(){function t(){}return t.populateWithDefaultElements=function(t){t.clear(),t.register("Container",Q),t.register("TextBlock",v),t.register("RichTextBlock",C,h.Versions.v1_2),t.register("TextRun",b,h.Versions.v1_2),t.register("Image",E),t.register("ImageSet",x),t.register("Media",I,h.Versions.v1_1),t.register("FactSet",_),t.register("ColumnSet",et),t.register("ActionSet",$,h.Versions.v1_2),t.register("Input.Text",V),t.register("Input.Date",D),t.register("Input.Time",L),t.register("Input.Number",z),t.register("Input.ChoiceSet",N),t.register("Input.Toggle",O)},t.populateWithDefaultActions=function(t){t.clear(),t.register(J.JsonTypeName,J),t.register(j.JsonTypeName,j),t.register(K.JsonTypeName,K),t.register(W.JsonTypeName,W,h.Versions.v1_2),t.register(H.JsonTypeName,H,h.Versions.v1_4)},t.reset=function(){t.populateWithDefaultElements(t.elements),t.populateWithDefaultActions(t.actions)},t.elements=new d.CardObjectRegistry,t.actions=new d.CardObjectRegistry,t}();e.GlobalRegistry=ft,ft.reset();var yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.internalParseCardObject=function(t,e,i,n,r,o){var s=void 0;if(e&&"object"==typeof e){var u=l.parseString(e.type);if(u)if(i.indexOf(u)>=0)o(u,1);else{var p=!1;if((s=r(u))?(s.setParent(t),s.parse(e,this),p=a.GlobalSettings.enableFallback&&n&&s.shouldFallback()):(p=a.GlobalSettings.enableFallback&&n,o(u,0)),p){var c=e.fallback;!c&&t&&t.setShouldFallback(!0),"string"==typeof c&&"drop"===c.toLowerCase()?s=void 0:"object"==typeof c&&(s=this.internalParseCardObject(t,c,i,!0,r,o))}}}return s},e.prototype.cardObjectParsed=function(t,e){t instanceof M&&this.onParseAction?this.onParseAction(t,e,this):t instanceof y&&this.onParseElement&&this.onParseElement(t,e,this)},e.prototype.shouldSerialize=function(t){return t instanceof M?void 0!==this.actionRegistry.findByName(t.getJsonTypeName()):!(t instanceof y)||void 0!==this.elementRegistry.findByName(t.getJsonTypeName())},e.prototype.parseCardObject=function(t,e,i,n,r,o){var s=this.internalParseCardObject(t,e,i,n,r,o);return void 0!==s&&this.cardObjectParsed(s,e),s},e.prototype.parseElement=function(t,e,i){var n=this;return this.parseCardObject(t,e,[],i,(function(t){return n.elementRegistry.createInstance(t,n.targetVersion)}),(function(t,e){0===e?n.logParseEvent(void 0,s.ValidationEvent.UnknownElementType,f.Strings.errors.unknownElementType(t)):n.logParseEvent(void 0,s.ValidationEvent.ElementTypeNotAllowed,f.Strings.errors.elementTypeNotAllowed(t))}))},e.prototype.parseAction=function(t,e,i,n){var r=this;return this.parseCardObject(t,e,i,n,(function(t){return r.actionRegistry.createInstance(t,r.targetVersion)}),(function(t,e){0==e?r.logParseEvent(void 0,s.ValidationEvent.UnknownActionType,f.Strings.errors.unknownActionType(t)):r.logParseEvent(void 0,s.ValidationEvent.ActionTypeNotAllowed,f.Strings.errors.actionTypeNotAllowed(t))}))},Object.defineProperty(e.prototype,"elementRegistry",{get:function(){return this._elementRegistry?this._elementRegistry:ft.elements},enumerable:!1,configurable:!0}),e.prototype.setElementRegistry=function(t){this._elementRegistry=t},Object.defineProperty(e.prototype,"actionRegistry",{get:function(){return this._actionRegistry?this._actionRegistry:ft.actions},enumerable:!1,configurable:!0}),e.prototype.setActionRegistry=function(t){this._actionRegistry=t},e}(h.BaseSerializationContext);e.SerializationContext=yt},11972:function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.defaultHostConfig=e.HostConfig=e.FontTypeSet=e.FontTypeDefinition=e.ContainerStyleSet=e.ContainerStyleDefinition=e.ColorSetDefinition=e.ActionsConfig=e.ShowCardActionConfig=e.FactSetConfig=e.FactTitleDefinition=e.FactTextDefinition=e.InputConfig=e.InputLabelConfig=e.RequiredInputLabelTextDefinition=e.BaseTextDefinition=e.MediaConfig=e.ImageSetConfig=e.AdaptiveCardConfig=e.TextColorDefinition=e.ColorDefinition=void 0;var o=i(5699),s=i(7631),a=i(6286),l=i(11970);function u(t,e,i){if("string"==typeof e){var n=s.parseEnum(t,e,i);return void 0!==n?n:i}return"number"==typeof e?e:i}var p=function(){function t(t,e){this.default="#000000",this.subtle="#666666",t&&(this.default=t),e&&(this.subtle=e)}return t.prototype.parse=function(t){t&&(this.default=t.default||this.default,this.subtle=t.subtle||this.subtle)},t}();e.ColorDefinition=p;var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.highlightColors=new p("#22000000","#11000000"),e}return r(e,t),e.prototype.parse=function(e){t.prototype.parse.call(this,e),e&&this.highlightColors.parse(e.highlightColors)},e}(p);e.TextColorDefinition=c;var h=function(t){this.allowCustomStyle=!1,t&&(this.allowCustomStyle=t.allowCustomStyle||this.allowCustomStyle)};e.AdaptiveCardConfig=h;var d=function(){function t(t){this.imageSize=o.Size.Medium,this.maxImageHeight=100,t&&(this.imageSize=null!=t.imageSize?t.imageSize:this.imageSize,this.maxImageHeight=s.parseNumber(t.maxImageHeight,100))}return t.prototype.toJSON=function(){return{imageSize:o.Size[this.imageSize],maxImageHeight:this.maxImageHeight}},t}();e.ImageSetConfig=d;var f=function(){function t(t){this.allowInlinePlayback=!0,t&&(this.defaultPoster=t.defaultPoster,this.allowInlinePlayback=t.allowInlinePlayback||this.allowInlinePlayback)}return t.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}},t}();e.MediaConfig=f;var y=function(){function t(t){this.size=o.TextSize.Default,this.color=o.TextColor.Default,this.isSubtle=!1,this.weight=o.TextWeight.Default,t&&(this.size=u(o.TextSize,t.size,this.size),this.color=u(o.TextColor,t.color,this.color),this.isSubtle=t.isSubtle||this.isSubtle,this.weight=u(o.TextWeight,t.weight,this.getDefaultWeight()))}return t.prototype.getDefaultWeight=function(){return o.TextWeight.Default},t.prototype.toJSON=function(){return{size:o.TextSize[this.size],color:o.TextColor[this.color],isSubtle:this.isSubtle,weight:o.TextWeight[this.weight]}},t}();e.BaseTextDefinition=y;var g=function(t){function e(e){var i=t.call(this,e)||this;return i.suffix=" *",i.suffixColor=o.TextColor.Attention,e&&(i.suffix=e.suffix||i.suffix,i.suffixColor=u(o.TextColor,e.suffixColor,i.suffixColor)),i}return r(e,t),e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.suffix=this.suffix,e.suffixColor=o.TextColor[this.suffixColor],e},e}(y);e.RequiredInputLabelTextDefinition=g;var m=function(t){this.inputSpacing=o.Spacing.Small,this.requiredInputs=new g,this.optionalInputs=new y,t&&(this.inputSpacing=u(o.Spacing,t.inputSpacing,this.inputSpacing),this.requiredInputs=new g(t.requiredInputs),this.optionalInputs=new y(t.optionalInputs))};e.InputLabelConfig=m;var v=function(t){this.label=new m,this.errorMessage=new y({color:o.TextColor.Attention}),t&&(this.label=new m(t.label),this.errorMessage=new y(t.errorMessage))};e.InputConfig=v;var b=function(t){function e(e){var i=t.call(this,e)||this;return i.wrap=!0,e&&(i.wrap=null!=e.wrap?e.wrap:i.wrap),i}return r(e,t),e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.wrap=this.wrap,e},e}(y);e.FactTextDefinition=b;var C=function(t){function e(e){var i=t.call(this,e)||this;return i.maxWidth=150,i.weight=o.TextWeight.Bolder,e&&(i.maxWidth=null!=e.maxWidth?e.maxWidth:i.maxWidth,i.weight=u(o.TextWeight,e.weight,o.TextWeight.Bolder)),i}return r(e,t),e.prototype.getDefaultWeight=function(){return o.TextWeight.Bolder},e}(b);e.FactTitleDefinition=C;var S=function(t){this.title=new C,this.value=new b,this.spacing=10,t&&(this.title=new C(t.title),this.value=new b(t.value),this.spacing=t.spacing&&null!=t.spacing?t.spacing&&t.spacing:this.spacing)};e.FactSetConfig=S;var _=function(){function t(t){this.actionMode=o.ShowCardActionMode.Inline,this.inlineTopMargin=16,this.style=o.ContainerStyle.Emphasis,t&&(this.actionMode=u(o.ShowCardActionMode,t.actionMode,o.ShowCardActionMode.Inline),this.inlineTopMargin=null!=t.inlineTopMargin?t.inlineTopMargin:this.inlineTopMargin,this.style=t.style&&"string"==typeof t.style?t.style:o.ContainerStyle.Emphasis)}return t.prototype.toJSON=function(){return{actionMode:o.ShowCardActionMode[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},t}();e.ShowCardActionConfig=_;var A=function(){function t(t){if(this.maxActions=5,this.spacing=o.Spacing.Default,this.buttonSpacing=20,this.showCard=new _,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=o.Orientation.Horizontal,this.actionAlignment=o.ActionAlignment.Left,this.iconPlacement=o.ActionIconPlacement.LeftOfTitle,this.allowTitleToWrap=!1,this.iconSize=16,t){this.maxActions=null!=t.maxActions?t.maxActions:this.maxActions,this.spacing=u(o.Spacing,t.spacing&&t.spacing,o.Spacing.Default),this.buttonSpacing=null!=t.buttonSpacing?t.buttonSpacing:this.buttonSpacing,this.showCard=new _(t.showCard),this.preExpandSingleShowCardAction=s.parseBool(t.preExpandSingleShowCardAction,!1),this.actionsOrientation=u(o.Orientation,t.actionsOrientation,o.Orientation.Horizontal),this.actionAlignment=u(o.ActionAlignment,t.actionAlignment,o.ActionAlignment.Left),this.iconPlacement=u(o.ActionIconPlacement,t.iconPlacement,o.ActionIconPlacement.LeftOfTitle),this.allowTitleToWrap=null!=t.allowTitleToWrap?t.allowTitleToWrap:this.allowTitleToWrap;try{var e=a.SizeAndUnit.parse(t.iconSize);e.unit==o.SizeUnit.Pixel&&(this.iconSize=e.physicalSize)}catch(t){}}}return t.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:o.Spacing[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:o.Orientation[this.actionsOrientation],actionAlignment:o.ActionAlignment[this.actionAlignment]}},t}();e.ActionsConfig=A;var E=function(){function t(t){this.default=new c,this.dark=new c,this.light=new c,this.accent=new c,this.good=new c,this.warning=new c,this.attention=new c,this.parse(t)}return t.prototype.parseSingleColor=function(t,e){t&&this[e].parse(t[e])},t.prototype.parse=function(t){t&&(this.parseSingleColor(t,"default"),this.parseSingleColor(t,"dark"),this.parseSingleColor(t,"light"),this.parseSingleColor(t,"accent"),this.parseSingleColor(t,"good"),this.parseSingleColor(t,"warning"),this.parseSingleColor(t,"attention"))},t}();e.ColorSetDefinition=E;var P=function(){function t(t){this.foregroundColors=new E({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}}),this.parse(t)}return t.prototype.parse=function(t){t&&(this.backgroundColor=t.backgroundColor,this.foregroundColors.parse(t.foregroundColors),this.highlightBackgroundColor=t.highlightBackgroundColor,this.highlightForegroundColor=t.highlightForegroundColor)},Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!1,configurable:!0}),t}();e.ContainerStyleDefinition=P;var x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!1,configurable:!0}),e}(P),w=function(){function t(t){if(this._allStyles={},this._allStyles[o.ContainerStyle.Default]=new x,this._allStyles[o.ContainerStyle.Emphasis]=new x,this._allStyles[o.ContainerStyle.Accent]=new x,this._allStyles[o.ContainerStyle.Good]=new x,this._allStyles[o.ContainerStyle.Attention]=new x,this._allStyles[o.ContainerStyle.Warning]=new x,t){this._allStyles[o.ContainerStyle.Default].parse(t[o.ContainerStyle.Default]),this._allStyles[o.ContainerStyle.Emphasis].parse(t[o.ContainerStyle.Emphasis]),this._allStyles[o.ContainerStyle.Accent].parse(t[o.ContainerStyle.Accent]),this._allStyles[o.ContainerStyle.Good].parse(t[o.ContainerStyle.Good]),this._allStyles[o.ContainerStyle.Attention].parse(t[o.ContainerStyle.Attention]),this._allStyles[o.ContainerStyle.Warning].parse(t[o.ContainerStyle.Warning]);var e=t.customStyles;if(e&&Array.isArray(e))for(var i=0,n=e;i<n.length;i++){var r=n[i];if(r){var s=r.name;s&&"string"==typeof s&&(this._allStyles.hasOwnProperty(s)?this._allStyles[s].parse(r.style):this._allStyles[s]=new P(r.style))}}}}return t.prototype.toJSON=function(){var t=this,e=[];Object.keys(this._allStyles).forEach((function(i){t._allStyles[i].isBuiltIn||e.push({name:i,style:t._allStyles[i]})}));var i={default:this.default,emphasis:this.emphasis};return e.length>0&&(i.customStyles=e),i},t.prototype.getStyleByName=function(t,e){return t&&this._allStyles.hasOwnProperty(t)?this._allStyles[t]:e||this._allStyles[o.ContainerStyle.Default]},Object.defineProperty(t.prototype,"default",{get:function(){return this._allStyles[o.ContainerStyle.Default]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"emphasis",{get:function(){return this._allStyles[o.ContainerStyle.Emphasis]},enumerable:!1,configurable:!0}),t}();e.ContainerStyleSet=w;var I=function(){function t(t){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},t&&(this.fontFamily=t)}return t.prototype.parse=function(t){this.fontFamily=t.fontFamily||this.fontFamily,this.fontSizes={small:t.fontSizes&&t.fontSizes.small||this.fontSizes.small,default:t.fontSizes&&t.fontSizes.default||this.fontSizes.default,medium:t.fontSizes&&t.fontSizes.medium||this.fontSizes.medium,large:t.fontSizes&&t.fontSizes.large||this.fontSizes.large,extraLarge:t.fontSizes&&t.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:t.fontWeights&&t.fontWeights.lighter||this.fontWeights.lighter,default:t.fontWeights&&t.fontWeights.default||this.fontWeights.default,bolder:t.fontWeights&&t.fontWeights.bolder||this.fontWeights.bolder}},t.monospace=new t("'Courier New', Courier, monospace"),t}();e.FontTypeDefinition=I;var T=function(){function t(t){this.default=new I,this.monospace=new I("'Courier New', Courier, monospace"),t&&(this.default.parse(t.default),this.monospace.parse(t.monospace))}return t.prototype.getStyleDefinition=function(t){switch(t){case o.FontType.Monospace:return this.monospace;case o.FontType.Default:default:return this.default}},t}();e.FontTypeSet=T;var V=function(){function t(t){this.hostCapabilities=new l.HostCapabilities,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new w,this.inputs=new v,this.actions=new A,this.adaptiveCard=new h,this.imageSet=new d,this.media=new f,this.factSet=new S,this.alwaysAllowBleed=!1,t&&(("string"==typeof t||t instanceof String)&&(t=JSON.parse(t)),this.choiceSetInputValueSeparator=t&&"string"==typeof t.choiceSetInputValueSeparator?t.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=t&&"boolean"==typeof t.supportsInteractivity?t.supportsInteractivity:this.supportsInteractivity,this._legacyFontType=new I,this._legacyFontType.parse(t),t.fontTypes&&(this.fontTypes=new T(t.fontTypes)),t.lineHeights&&(this.lineHeights={small:t.lineHeights.small,default:t.lineHeights.default,medium:t.lineHeights.medium,large:t.lineHeights.large,extraLarge:t.lineHeights.extraLarge}),this.imageSizes={small:t.imageSizes&&t.imageSizes.small||this.imageSizes.small,medium:t.imageSizes&&t.imageSizes.medium||this.imageSizes.medium,large:t.imageSizes&&t.imageSizes.large||this.imageSizes.large},this.containerStyles=new w(t.containerStyles),this.spacing={small:t.spacing&&t.spacing.small||this.spacing.small,default:t.spacing&&t.spacing.default||this.spacing.default,medium:t.spacing&&t.spacing.medium||this.spacing.medium,large:t.spacing&&t.spacing.large||this.spacing.large,extraLarge:t.spacing&&t.spacing.extraLarge||this.spacing.extraLarge,padding:t.spacing&&t.spacing.padding||this.spacing.padding},this.separator={lineThickness:t.separator&&t.separator.lineThickness||this.separator.lineThickness,lineColor:t.separator&&t.separator.lineColor||this.separator.lineColor},this.inputs=new v(t.inputs||this.inputs),this.actions=new A(t.actions||this.actions),this.adaptiveCard=new h(t.adaptiveCard||this.adaptiveCard),this.imageSet=new d(t.imageSet),this.factSet=new S(t.factSet))}return t.prototype.getFontTypeDefinition=function(t){return this.fontTypes?this.fontTypes.getStyleDefinition(t):t==o.FontType.Monospace?I.monospace:this._legacyFontType},t.prototype.getEffectiveSpacing=function(t){switch(t){case o.Spacing.Small:return this.spacing.small;case o.Spacing.Default:return this.spacing.default;case o.Spacing.Medium:return this.spacing.medium;case o.Spacing.Large:return this.spacing.large;case o.Spacing.ExtraLarge:return this.spacing.extraLarge;case o.Spacing.Padding:return this.spacing.padding;default:return 0}},t.prototype.paddingDefinitionToSpacingDefinition=function(t){return new a.SpacingDefinition(this.getEffectiveSpacing(t.top),this.getEffectiveSpacing(t.right),this.getEffectiveSpacing(t.bottom),this.getEffectiveSpacing(t.left))},t.prototype.makeCssClassNames=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=[],n=0,r=t;n<r.length;n++){var o=r[n];i.push((this.cssClassNamePrefix?this.cssClassNamePrefix+"-":"")+o)}return i},t.prototype.makeCssClassName=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.makeCssClassNames.apply(this,t).join(" ");return i||""},Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(t){this._legacyFontType.fontFamily=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:!1,configurable:!0}),t}();e.HostConfig=V,e.defaultHostConfig=new V({supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},inputs:{label:{requiredInputs:{color:o.TextColor.Accent,size:o.TextSize.ExtraLarge,weight:o.TextWeight.Bolder,isSubtle:!0,suffix:" (required)",suffixColor:o.TextColor.Good},optionalInputs:{color:o.TextColor.Warning,size:o.TextSize.Medium,weight:o.TextWeight.Lighter,isSubtle:!1}},errorMessage:{color:o.TextColor.Accent,size:o.TextSize.Small,weight:o.TextWeight.Bolder}},actions:{maxActions:5,spacing:o.Spacing.Default,buttonSpacing:10,showCard:{actionMode:o.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:o.Orientation.Horizontal,actionAlignment:o.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:o.Size.Medium,maxImageHeight:100},factSet:{title:{color:o.TextColor.Default,size:o.TextSize.Default,isSubtle:!1,weight:o.TextWeight.Bolder,wrap:!0,maxWidth:150},value:{color:o.TextColor.Default,size:o.TextSize.Default,isSubtle:!1,weight:o.TextWeight.Default,wrap:!0},spacing:10}})},11973:function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.LoginRequestResponse=e.ErrorResponse=e.SuccessResponse=e.ActivityResponse=e.ActivityRequestError=e.ActivityRequestTrigger=void 0,function(t){t.Automatic="automatic",t.Manual="manual"}(e.ActivityRequestTrigger||(e.ActivityRequestTrigger={}));var o=function(t,e){this.code=t,this.message=e};e.ActivityRequestError=o;var s=function(t){this.request=t};e.ActivityResponse=s;var a=function(t){function e(e,i){var n=t.call(this,e)||this;return n.request=e,n.rawContent=i,n}return r(e,t),e}(s);e.SuccessResponse=a;var l=function(t){function e(e,i){var n=t.call(this,e)||this;return n.request=e,n.error=i,n}return r(e,t),e}(s);e.ErrorResponse=l;var u=function(t){function e(e,i){var n=t.call(this,e)||this;n.request=e,n._auth=i;for(var r=0,o=n._auth.buttons;r<o.length;r++){var s=o[r];if("signin"===s.type&&void 0!==s.value)try{new URL(s.value),n.signinButton=s;break}catch(t){}}return n}return r(e,t),Object.defineProperty(e.prototype,"tokenExchangeResource",{get:function(){return this._auth.tokenExchangeResource},enumerable:!1,configurable:!0}),e}(s);e.LoginRequestResponse=u},11974:function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(7633),s=i(10126),a=i(8361),l=function(){function t(t,e){this.default="#000000",this.subtle="#666666",t&&(this.default=t),e&&(this.subtle=e)}return t.prototype.parse=function(t){t&&(this.default=t.default||this.default,this.subtle=t.subtle||this.subtle)},t}();e.ColorDefinition=l;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.highlightColors=new l("#22000000","#11000000"),e}return r(e,t),e.prototype.parse=function(e){t.prototype.parse.call(this,e),e&&this.highlightColors.parse(e.highlightColors)},e}(l);e.TextColorDefinition=u;var p=function(t){this.allowCustomStyle=!1,t&&(this.allowCustomStyle=t.allowCustomStyle||this.allowCustomStyle)};e.AdaptiveCardConfig=p;var c=function(){function t(t){this.imageSize=o.Size.Medium,this.maxImageHeight=100,t&&(this.imageSize=null!=t.imageSize?t.imageSize:this.imageSize,this.maxImageHeight=s.getValueOrDefault(t.maxImageHeight,100))}return t.prototype.toJSON=function(){return{imageSize:o.Size[this.imageSize],maxImageHeight:this.maxImageHeight}},t}();e.ImageSetConfig=c;var h=function(){function t(t){this.allowInlinePlayback=!0,t&&(this.defaultPoster=t.defaultPoster,this.allowInlinePlayback=t.allowInlinePlayback||this.allowInlinePlayback)}return t.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}},t}();e.MediaConfig=h;var d=function(){function t(t){this.size=o.TextSize.Default,this.color=o.TextColor.Default,this.isSubtle=!1,this.weight=o.TextWeight.Default,this.wrap=!0,t&&(this.size=s.parseHostConfigEnum(o.TextSize,t.size,o.TextSize.Default),this.color=s.parseHostConfigEnum(o.TextColor,t.color,o.TextColor.Default),this.isSubtle=t.isSubtle||this.isSubtle,this.weight=s.parseHostConfigEnum(o.TextWeight,t.weight,this.getDefaultWeight()),this.wrap=null!=t.wrap?t.wrap:this.wrap)}return t.prototype.getDefaultWeight=function(){return o.TextWeight.Default},t.prototype.toJSON=function(){return{size:o.TextSize[this.size],color:o.TextColor[this.color],isSubtle:this.isSubtle,weight:o.TextWeight[this.weight],wrap:this.wrap}},t}();e.FactTextDefinition=d;var f=function(t){function e(e){var i=t.call(this,e)||this;return i.maxWidth=150,i.weight=o.TextWeight.Bolder,e&&(i.maxWidth=null!=e.maxWidth?e.maxWidth:i.maxWidth,i.weight=s.parseHostConfigEnum(o.TextWeight,e.weight,o.TextWeight.Bolder)),i}return r(e,t),e.prototype.getDefaultWeight=function(){return o.TextWeight.Bolder},e}(d);e.FactTitleDefinition=f;var y=function(t){this.title=new f,this.value=new d,this.spacing=10,t&&(this.title=new f(t.title),this.value=new d(t.value),this.spacing=t.spacing&&null!=t.spacing?t.spacing&&t.spacing:this.spacing)};e.FactSetConfig=y;var g=function(){function t(t){this.actionMode=o.ShowCardActionMode.Inline,this.inlineTopMargin=16,this.style=o.ContainerStyle.Emphasis,t&&(this.actionMode=s.parseHostConfigEnum(o.ShowCardActionMode,t.actionMode,o.ShowCardActionMode.Inline),this.inlineTopMargin=null!=t.inlineTopMargin?t.inlineTopMargin:this.inlineTopMargin,this.style=t.style&&"string"==typeof t.style?t.style:o.ContainerStyle.Emphasis)}return t.prototype.toJSON=function(){return{actionMode:o.ShowCardActionMode[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},t}();e.ShowCardActionConfig=g;var m=function(){function t(t){if(this.maxActions=5,this.spacing=o.Spacing.Default,this.buttonSpacing=20,this.showCard=new g,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=o.Orientation.Horizontal,this.actionAlignment=o.ActionAlignment.Left,this.iconPlacement=o.ActionIconPlacement.LeftOfTitle,this.allowTitleToWrap=!1,this.iconSize=24,t){this.maxActions=null!=t.maxActions?t.maxActions:this.maxActions,this.spacing=s.parseHostConfigEnum(o.Spacing,t.spacing&&t.spacing,o.Spacing.Default),this.buttonSpacing=null!=t.buttonSpacing?t.buttonSpacing:this.buttonSpacing,this.showCard=new g(t.showCard),this.preExpandSingleShowCardAction=s.getValueOrDefault(t.preExpandSingleShowCardAction,!1),this.actionsOrientation=s.parseHostConfigEnum(o.Orientation,t.actionsOrientation,o.Orientation.Horizontal),this.actionAlignment=s.parseHostConfigEnum(o.ActionAlignment,t.actionAlignment,o.ActionAlignment.Left),this.iconPlacement=s.parseHostConfigEnum(o.ActionIconPlacement,t.iconPlacement,o.ActionIconPlacement.LeftOfTitle),this.allowTitleToWrap=null!=t.allowTitleToWrap?t.allowTitleToWrap:this.allowTitleToWrap;try{var e=a.SizeAndUnit.parse(t.iconSize);e.unit==o.SizeUnit.Pixel&&(this.iconSize=e.physicalSize)}catch(t){}}}return t.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:o.Spacing[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:o.Orientation[this.actionsOrientation],actionAlignment:o.ActionAlignment[this.actionAlignment]}},t}();e.ActionsConfig=m;var v=function(){function t(t){this.default=new u,this.dark=new u,this.light=new u,this.accent=new u,this.good=new u,this.warning=new u,this.attention=new u,this.parse(t)}return t.prototype.parseSingleColor=function(t,e){t&&this[e].parse(t[e])},t.prototype.parse=function(t){t&&(this.parseSingleColor(t,"default"),this.parseSingleColor(t,"dark"),this.parseSingleColor(t,"light"),this.parseSingleColor(t,"accent"),this.parseSingleColor(t,"good"),this.parseSingleColor(t,"warning"),this.parseSingleColor(t,"attention"))},t}();e.ColorSetDefinition=v;var b=function(){function t(t){this.foregroundColors=new v({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#54A254",subtle:"#DD54A254"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}}),this.parse(t)}return t.prototype.parse=function(t){t&&(this.backgroundColor=t.backgroundColor,this.foregroundColors.parse(t.foregroundColors),this.highlightBackgroundColor=t.highlightBackgroundColor,this.highlightForegroundColor=t.highlightForegroundColor)},Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!0,configurable:!0}),t}();e.ContainerStyleDefinition=b;var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!0,configurable:!0}),e}(b),S=function(){function t(t){if(this._allStyles={},this._allStyles[o.ContainerStyle.Default]=new C,this._allStyles[o.ContainerStyle.Emphasis]=new C,this._allStyles[o.ContainerStyle.Accent]=new C,this._allStyles[o.ContainerStyle.Good]=new C,this._allStyles[o.ContainerStyle.Attention]=new C,this._allStyles[o.ContainerStyle.Warning]=new C,t){this._allStyles[o.ContainerStyle.Default].parse(t[o.ContainerStyle.Default]),this._allStyles[o.ContainerStyle.Emphasis].parse(t[o.ContainerStyle.Emphasis]),this._allStyles[o.ContainerStyle.Accent].parse(t[o.ContainerStyle.Accent]),this._allStyles[o.ContainerStyle.Good].parse(t[o.ContainerStyle.Good]),this._allStyles[o.ContainerStyle.Attention].parse(t[o.ContainerStyle.Attention]),this._allStyles[o.ContainerStyle.Warning].parse(t[o.ContainerStyle.Warning]);var e=t.customStyles;if(e&&Array.isArray(e))for(var i=0,n=e;i<n.length;i++){var r=n[i];if(r){var s=r.name;s&&"string"==typeof s&&(this._allStyles.hasOwnProperty(s)?this._allStyles[s].parse(r.style):this._allStyles[s]=new b(r.style))}}}}return t.prototype.toJSON=function(){var t=this,e=[];Object.keys(this._allStyles).forEach((function(i){t._allStyles[i].isBuiltIn||e.push({name:i,style:t._allStyles[i]})}));var i={default:this.default,emphasis:this.emphasis};return e.length>0&&(i.customStyles=e),i},t.prototype.getStyleByName=function(t,e){return void 0===e&&(e=null),this._allStyles.hasOwnProperty(t)?this._allStyles[t]:e},Object.defineProperty(t.prototype,"default",{get:function(){return this._allStyles[o.ContainerStyle.Default]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"emphasis",{get:function(){return this._allStyles[o.ContainerStyle.Emphasis]},enumerable:!0,configurable:!0}),t}();e.ContainerStyleSet=S;var _=function(){function t(t,e){void 0===t&&(t=1),void 0===e&&(e=1),this._isValid=!0,this._major=t,this._minor=e}return t.parse=function(e,i){if(!e)return null;var n=new t;n._versionString=e;var r=/(\d+).(\d+)/gi.exec(e);return null!=r&&3==r.length?(n._major=parseInt(r[1]),n._minor=parseInt(r[2])):n._isValid=!1,!n._isValid&&i&&i.push({error:o.ValidationError.InvalidPropertyValue,message:"Invalid version string: "+n._versionString}),n},t.prototype.toString=function(){return this._isValid?this._major+"."+this._minor:this._versionString},t.prototype.compareTo=function(t){if(!this.isValid||!t.isValid)throw new Error("Cannot compare invalid version.");return this.major>t.major?1:this.major<t.major?-1:this.minor>t.minor?1:this.minor<t.minor?-1:0},Object.defineProperty(t.prototype,"major",{get:function(){return this._major},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minor",{get:function(){return this._minor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isValid",{get:function(){return this._isValid},enumerable:!0,configurable:!0}),t}();e.Version=_;var A=function(){function t(){this.capabilities=null}return t.prototype.setCapability=function(t,e){this.capabilities||(this.capabilities={}),this.capabilities[t]=e},t.prototype.parse=function(t,e){if(t)for(var i in t){var n=t[i];if("string"==typeof n)if("*"==n)this.setCapability(i,"*");else{var r=_.parse(n,e);r.isValid&&this.setCapability(i,r)}}},t.prototype.hasCapability=function(t,e){return!(!this.capabilities||!this.capabilities.hasOwnProperty(t))&&("*"==e||"*"==this.capabilities[t]||e.compareTo(this.capabilities[t])<=0)},t.prototype.areAllMet=function(t){if(this.capabilities)for(var e in this.capabilities)if(!t.hasCapability(e,this.capabilities[e]))return!1;return!0},t}();e.HostCapabilities=A;var E=function(){function t(t){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},t&&(this.fontFamily=t)}return t.prototype.parse=function(t){this.fontFamily=t.fontFamily||this.fontFamily,this.fontSizes={small:t.fontSizes&&t.fontSizes.small||this.fontSizes.small,default:t.fontSizes&&t.fontSizes.default||this.fontSizes.default,medium:t.fontSizes&&t.fontSizes.medium||this.fontSizes.medium,large:t.fontSizes&&t.fontSizes.large||this.fontSizes.large,extraLarge:t.fontSizes&&t.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:t.fontWeights&&t.fontWeights.lighter||this.fontWeights.lighter,default:t.fontWeights&&t.fontWeights.default||this.fontWeights.default,bolder:t.fontWeights&&t.fontWeights.bolder||this.fontWeights.bolder}},t.monospace=new t("'Courier New', Courier, monospace"),t}();e.FontTypeDefinition=E;var P=function(){function t(t){this.default=new E,this.monospace=new E("'Courier New', Courier, monospace"),t&&(this.default.parse(t.default),this.monospace.parse(t.monospace))}return t.prototype.getStyleDefinition=function(t){switch(t){case o.FontType.Monospace:return this.monospace;case o.FontType.Default:default:return this.default}},t}();e.FontTypeSet=P;var x=function(){function t(t){this.hostCapabilities=new A,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.fontTypes=null,this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new S,this.actions=new m,this.adaptiveCard=new p,this.imageSet=new c,this.media=new h,this.factSet=new y,this.cssClassNamePrefix=null,t&&(("string"==typeof t||t instanceof String)&&(t=JSON.parse(t)),this.choiceSetInputValueSeparator=t&&"string"==typeof t.choiceSetInputValueSeparator?t.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=t&&"boolean"==typeof t.supportsInteractivity?t.supportsInteractivity:this.supportsInteractivity,this._legacyFontType=new E,this._legacyFontType.parse(t),t.fontTypes&&(this.fontTypes=new P(t.fontTypes)),t.lineHeights&&(this.lineHeights={small:t.lineHeights.small,default:t.lineHeights.default,medium:t.lineHeights.medium,large:t.lineHeights.large,extraLarge:t.lineHeights.extraLarge}),this.imageSizes={small:t.imageSizes&&t.imageSizes.small||this.imageSizes.small,medium:t.imageSizes&&t.imageSizes.medium||this.imageSizes.medium,large:t.imageSizes&&t.imageSizes.large||this.imageSizes.large},this.containerStyles=new S(t.containerStyles),this.spacing={small:t.spacing&&t.spacing.small||this.spacing.small,default:t.spacing&&t.spacing.default||this.spacing.default,medium:t.spacing&&t.spacing.medium||this.spacing.medium,large:t.spacing&&t.spacing.large||this.spacing.large,extraLarge:t.spacing&&t.spacing.extraLarge||this.spacing.extraLarge,padding:t.spacing&&t.spacing.padding||this.spacing.padding},this.separator={lineThickness:t.separator&&t.separator.lineThickness||this.separator.lineThickness,lineColor:t.separator&&t.separator.lineColor||this.separator.lineColor},this.actions=new m(t.actions||this.actions),this.adaptiveCard=new p(t.adaptiveCard||this.adaptiveCard),this.imageSet=new c(t.imageSet),this.factSet=new y(t.factSet))}return t.prototype.getFontTypeDefinition=function(t){return this.fontTypes?this.fontTypes.getStyleDefinition(t):t==o.FontType.Monospace?E.monospace:this._legacyFontType},t.prototype.getEffectiveSpacing=function(t){switch(t){case o.Spacing.Small:return this.spacing.small;case o.Spacing.Default:return this.spacing.default;case o.Spacing.Medium:return this.spacing.medium;case o.Spacing.Large:return this.spacing.large;case o.Spacing.ExtraLarge:return this.spacing.extraLarge;case o.Spacing.Padding:return this.spacing.padding;default:return 0}},t.prototype.paddingDefinitionToSpacingDefinition=function(t){return new a.SpacingDefinition(this.getEffectiveSpacing(t.top),this.getEffectiveSpacing(t.right),this.getEffectiveSpacing(t.bottom),this.getEffectiveSpacing(t.left))},t.prototype.makeCssClassNames=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=[],n=0,r=t;n<r.length;n++){var o=r[n];i.push((this.cssClassNamePrefix?this.cssClassNamePrefix+"-":"")+o)}return i},t.prototype.makeCssClassName=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.makeCssClassNames.apply(this,t).join(" ");return i||""},Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(t){this._legacyFontType.fontFamily=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:!0,configurable:!0}),t}();e.HostConfig=x},16980:function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.formatText=void 0;var o=function(){function t(t){this._regularExpression=t}return t.prototype.format=function(t,e){var i;if(e){for(var n=e;null!=(i=this._regularExpression.exec(e));)n=n.replace(i[0],this.internalFormat(t,i));return n}return e},t}(),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.internalFormat=function(t,e){var i=new Date(Date.parse(e[1])),n=null!=e[2]?e[2].toLowerCase():"compact";return"compact"!=n?i.toLocaleDateString(t,{day:"numeric",weekday:n,month:n,year:"numeric"}):i.toLocaleDateString()},e}(o),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.internalFormat=function(t,e){return new Date(Date.parse(e[1])).toLocaleTimeString(t,{hour:"numeric",minute:"2-digit"})},e}(o);e.formatText=function(t,e){for(var i=e,n=0,r=[new s(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new a(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)];n<r.length;n++){i=r[n].format(t,i)}return i}},16981:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChannelAdapter=void 0;var n=function(){};e.ChannelAdapter=n},16982:function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{l(n.next(t))}catch(t){o(t)}}function a(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}l((n=n.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.AdaptiveApplet=void 0;var o=i(5699),s=i(7631),a=i(6286),l=i(11973),u=i(7632),p=i(11971),c=i(6721);function h(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(a.GlobalSettings.applets.logEnabled)if(a.GlobalSettings.applets.onLogEvent)a.GlobalSettings.applets.onLogEvent(t,e,i);else switch(t){case o.LogLevel.Warning:case o.LogLevel.Error:}}var d=function(){function t(t,e,i){this.action=t,this.trigger=e,this.consecutiveRefreshes=i,this.attemptNumber=0}return t.prototype.retryAsync=function(){return n(this,void 0,void 0,(function(){return r(this,(function(t){return this.onSend&&this.onSend(this),[2]}))}))},t}(),f=function(){function t(){this._allowAutomaticCardUpdate=!1,this.renderedElement=document.createElement("div"),this.renderedElement.className="aaf-cardHost",this.renderedElement.style.position="relative",this.renderedElement.style.display="flex",this.renderedElement.style.flexDirection="column",this._cardHostElement=document.createElement("div"),this._refreshButtonHostElement=document.createElement("div"),this._refreshButtonHostElement.className="aaf-refreshButtonHost",this._refreshButtonHostElement.style.display="none",this.renderedElement.appendChild(this._cardHostElement),this.renderedElement.appendChild(this._refreshButtonHostElement)}return t.prototype.displayCard=function(t){if(!t.renderedElement)throw new Error("displayCard: undefined card.");s.clearElementChildren(this._cardHostElement),this._refreshButtonHostElement.style.display="none",this._cardHostElement.appendChild(t.renderedElement)},t.prototype.showManualRefreshButton=function(t){var e=this;if(!this.onShowManualRefreshButton||this.onShowManualRefreshButton(this)){this._refreshButtonHostElement.style.display="none";var i=void 0;if(this.onRenderManualRefreshButton)i=this.onRenderManualRefreshButton(this);else{var n=u.Strings.runtime.refreshThisCard();if(a.GlobalSettings.applets.refresh.mode===o.RefreshMode.Automatic){var r=u.Strings.runtime.automaticRefreshPaused();" "!==r[r.length-1]&&(r+=" "),n=u.Strings.runtime.clckToRestartAutomaticRefresh()}var h={type:"AdaptiveCard",version:"1.2",body:[{type:"RichTextBlock",horizontalAlignment:"right",inlines:[{type:"TextRun",text:n,selectAction:{type:"Action.Submit",id:"refreshCard"}}]}]},d=new p.AdaptiveCard;d.parse(h,new p.SerializationContext(c.Versions.v1_2)),d.onExecuteAction=function(i){"refreshCard"===i.id&&(s.clearElementChildren(e._refreshButtonHostElement),e.internalExecuteAction(t,l.ActivityRequestTrigger.Automatic,0))},i=d.render()}i&&(s.clearElementChildren(this._refreshButtonHostElement),this._refreshButtonHostElement.appendChild(i),this._refreshButtonHostElement.style.removeProperty("display"))}},t.prototype.createActivityRequest=function(t,e,i){var n=this;if(this.card){var r=new d(t,e,i);return r.onSend=function(t){t.attemptNumber++,n.internalSendActivityRequestAsync(r)},!!this.onPrepareActivityRequest&&!this.onPrepareActivityRequest(this,r,t)?void 0:r}throw new Error("createActivityRequest: no card has been set.")},t.prototype.createMagicCodeInputCard=function(e){var i={type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",color:"attention",text:1===e?void 0:"That didn't work... let's try again.",wrap:!0,horizontalAlignment:"center"},{type:"TextBlock",text:'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"',wrap:!0,horizontalAlignment:"center"},{type:"Input.Text",id:"magicCode",placeholder:"Enter magic code"},{type:"ActionSet",horizontalAlignment:"center",actions:[{type:"Action.Submit",id:t.submitMagicCodeActionId,title:"Submit"},{type:"Action.Submit",id:t.cancelMagicCodeAuthActionId,title:"Cancel"}]}]},n=new p.AdaptiveCard;return n.parse(i),n},t.prototype.cancelAutomaticRefresh=function(){this._allowAutomaticCardUpdate&&h(o.LogLevel.Warning,"Automatic card refresh has been cancelled as a result of the user interacting with the card."),this._allowAutomaticCardUpdate=!1},t.prototype.createSerializationContext=function(){return this.onCreateSerializationContext?this.onCreateSerializationContext(this):new p.SerializationContext},t.prototype.internalSetCard=function(t,e){var i=this;if("object"==typeof t&&"AdaptiveCard"===t.type&&(this._cardPayload=t),this._cardPayload)try{var n=new p.AdaptiveCard;this.hostConfig&&(n.hostConfig=this.hostConfig);var r=this.createSerializationContext();if(n.parse(this._cardPayload,r),(!this.onCardChanging||this.onCardChanging(this,this._cardPayload))&&(this._card=n,this._card.authentication&&this._card.authentication.tokenExchangeResource&&this.onPrefetchSSOToken&&this.onPrefetchSSOToken(this,this._card.authentication.tokenExchangeResource),this._card.onExecuteAction=function(t){i.cancelAutomaticRefresh(),i.internalExecuteAction(t,l.ActivityRequestTrigger.Manual,0)},this._card.onInputValueChanged=function(t){i.cancelAutomaticRefresh()},this._card.render(),this._card.renderedElement&&(this.displayCard(this._card),this.onCardChanged&&this.onCardChanged(this),this._card.refresh)))if(a.GlobalSettings.applets.refresh.mode===o.RefreshMode.Automatic&&e<a.GlobalSettings.applets.refresh.maximumConsecutiveAutomaticRefreshes)if(a.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes<=0)h(o.LogLevel.Info,"Triggering automatic card refresh number "+(e+1)),this.internalExecuteAction(this._card.refresh.action,l.ActivityRequestTrigger.Automatic,e+1);else{h(o.LogLevel.Info,"Scheduling automatic card refresh number "+(e+1)+" in "+a.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes+"ms");var s=this._card.refresh.action;this._allowAutomaticCardUpdate=!0,window.setTimeout((function(){i._allowAutomaticCardUpdate&&i.internalExecuteAction(s,l.ActivityRequestTrigger.Automatic,e+1)}),a.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes)}else a.GlobalSettings.applets.refresh.mode!==o.RefreshMode.Disabled&&(h(o.LogLevel.Warning,e>0?"Stopping automatic refreshes after "+e+" consecutive refreshes.":"The card has a refresh section, but automatic refreshes are disabled."),(a.GlobalSettings.applets.refresh.allowManualRefreshesAfterAutomaticRefreshes||a.GlobalSettings.applets.refresh.mode===o.RefreshMode.Manual)&&(h(o.LogLevel.Info,"Showing manual refresh button."),this.showManualRefreshButton(this._card.refresh.action)))}catch(t){h(o.LogLevel.Error,"setCard: "+t)}},t.prototype.internalExecuteAction=function(t,e,i){if(t instanceof p.ExecuteAction){if(!this.channelAdapter)throw new Error("internalExecuteAction: No channel adapter set.");var n=this.createActivityRequest(t,e,i);n&&n.retryAsync()}this.onAction&&this.onAction(this,t)},t.prototype.createProgressOverlay=function(t){if(!this._progressOverlay)if(this.onCreateProgressOverlay)this._progressOverlay=this.onCreateProgressOverlay(this,t);else{this._progressOverlay=document.createElement("div"),this._progressOverlay.className="aaf-progress-overlay";var e=document.createElement("div");e.className="aaf-spinner",e.style.width="28px",e.style.height="28px",this._progressOverlay.appendChild(e)}return this._progressOverlay},t.prototype.removeProgressOverlay=function(t){this.onRemoveProgressOverlay&&this.onRemoveProgressOverlay(this,t),void 0!==this._progressOverlay&&(this.renderedElement.removeChild(this._progressOverlay),this._progressOverlay=void 0)},t.prototype.activityRequestSucceeded=function(t,e){this.onActivityRequestSucceeded&&this.onActivityRequestSucceeded(this,t,e)},t.prototype.activityRequestFailed=function(t){return this.onActivityRequestFailed?this.onActivityRequestFailed(this,t):a.GlobalSettings.applets.defaultTimeBetweenRetryAttempts},t.prototype.showAuthCodeInputDialog=function(e){var i=this;if(!this.onShowAuthCodeInputDialog||this.onShowAuthCodeInputDialog(this,e)){var n=this.createMagicCodeInputCard(e.attemptNumber);n.render(),n.onExecuteAction=function(n){if(i.card&&n instanceof p.SubmitAction)switch(n.id){case t.submitMagicCodeActionId:var r=void 0;n.data&&"string"==typeof n.data.magicCode&&(r=n.data.magicCode),r?(i.displayCard(i.card),e.authCode=r,e.retryAsync()):alert("Please enter the magic code you received.");break;case t.cancelMagicCodeAuthActionId:h(o.LogLevel.Warning,"Authentication cancelled by user."),i.displayCard(i.card);break;default:h(o.LogLevel.Error,"Unespected action taken from magic code input card (id = "+n.id+")"),alert(u.Strings.magicCodeInputCard.somethingWentWrong())}},this.displayCard(n)}},t.prototype.internalSendActivityRequestAsync=function(t){return n(this,void 0,void 0,(function(){var e,i,n,s;return r(this,(function(p){switch(p.label){case 0:if(!this.channelAdapter)throw new Error("internalSendActivityRequestAsync: channelAdapter is not set.");void 0!==(e=this.createProgressOverlay(t))&&this.renderedElement.appendChild(e),i=!1,n=function(){var e,n,p,c,d,f,y;return r(this,(function(r){switch(r.label){case 0:e=void 0,1===t.attemptNumber?h(o.LogLevel.Info,"Sending activity request to channel (attempt "+t.attemptNumber+")"):h(o.LogLevel.Info,"Re-sending activity request to channel (attempt "+t.attemptNumber+")"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s.channelAdapter.sendRequestAsync(t)];case 2:return e=r.sent(),[3,4];case 3:return n=r.sent(),h(o.LogLevel.Error,"Activity request failed: "+n),s.removeProgressOverlay(t),i=!0,[3,4];case 4:if(!e)return[3,10];if(!(e instanceof l.SuccessResponse))return[3,5];if(s.removeProgressOverlay(t),void 0===e.rawContent)throw new Error("internalSendActivityRequestAsync: Action.Execute result is undefined");p=e.rawContent;try{p=JSON.parse(e.rawContent)}catch(t){}if("string"==typeof p)h(o.LogLevel.Info,"The activity request returned a string after "+t.attemptNumber+" attempt(s)."),s.activityRequestSucceeded(e,p);else{if("object"!=typeof p||"AdaptiveCard"!==p.type)throw new Error("internalSendActivityRequestAsync: Action.Execute result is of unsupported type ("+typeof e.rawContent+")");h(o.LogLevel.Info,"The activity request returned an Adaptive Card after "+t.attemptNumber+" attempt(s)."),s.internalSetCard(p,t.consecutiveRefreshes),s.activityRequestSucceeded(e,s.card)}return i=!0,[3,10];case 5:return e instanceof l.ErrorResponse?(c=s.activityRequestFailed(e))>=0&&t.attemptNumber<a.GlobalSettings.applets.maximumRetryAttempts?(h(o.LogLevel.Warning,"Activity request failed: "+e.error.message+". Retrying in "+c+"ms"),t.attemptNumber++,[4,new Promise((function(t,e){window.setTimeout((function(){t()}),c)}))]):[3,7]:[3,9];case 6:return r.sent(),[3,8];case 7:h(o.LogLevel.Error,"Activity request failed: "+e.error.message+". Giving up after "+t.attemptNumber+" attempt(s)"),s.removeProgressOverlay(t),i=!0,r.label=8;case 8:return[3,10];case 9:if(e instanceof l.LoginRequestResponse){if(h(o.LogLevel.Info,"The activity request returned a LoginRequestResponse after "+t.attemptNumber+" attempt(s)."),t.attemptNumber<=a.GlobalSettings.applets.maximumRetryAttempts){if(d=!0,e.tokenExchangeResource&&s.onSSOTokenNeeded&&(d=!s.onSSOTokenNeeded(s,t,e.tokenExchangeResource)),d){if(s.removeProgressOverlay(t),void 0===e.signinButton)throw new Error("internalSendActivityRequestAsync: the login request doesn't contain a valid signin URL.");h(o.LogLevel.Info,"Login required at "+e.signinButton.value),s.onShowSigninPrompt?s.onShowSigninPrompt(s,t,e.signinButton):(s.showAuthCodeInputDialog(t),f=window.screenX+(window.outerWidth-a.GlobalSettings.applets.authPromptWidth)/2,y=window.screenY+(window.outerHeight-a.GlobalSettings.applets.authPromptHeight)/2,window.open(e.signinButton.value,e.signinButton.title?e.signinButton.title:"Sign in","width="+a.GlobalSettings.applets.authPromptWidth+",height="+a.GlobalSettings.applets.authPromptHeight+",left="+f+",top="+y))}}else h(o.LogLevel.Error,"Authentication failed. Giving up after "+t.attemptNumber+" attempt(s)"),alert(u.Strings.magicCodeInputCard.authenticationFailed());return[2,"break"]}throw new Error("Unhandled response type: "+e.toString());case 10:return[2]}}))},s=this,p.label=1;case 1:return i?[3,3]:[5,n()];case 2:return"break"===p.sent()?[3,3]:[3,1];case 3:return[2]}}))}))},t.prototype.refreshCard=function(){this._card&&this._card.refresh&&this.internalExecuteAction(this._card.refresh.action,l.ActivityRequestTrigger.Manual,0)},t.prototype.setCard=function(t){this.internalSetCard(t,0)},Object.defineProperty(t.prototype,"card",{get:function(){return this._card},enumerable:!1,configurable:!0}),t.submitMagicCodeActionId="submitMagicCode",t.cancelMagicCodeAuthActionId="cancelMagicCodeAuth",t}();e.AdaptiveApplet=f},16983:function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o,s=i(7633),a=i(8361),l=i(10126),u=i(11974),p=i(16984);function c(t,e){t&&t.setCollection(e)}function h(t,e){if(e)for(var i=0;i<e.length;i++)if(t.getJsonTypeName()===e[i])return!1;return!0}function d(t,e,i,n,r,s,a){var u=null;if(e&&"object"==typeof e){var p=!1,c=l.getStringValue(e.type);if(i&&i.indexOf(c)>=0)lt(s(c,o.ForbiddenType),a);else if((u=r(c))?(u.setParent(t),u.parse(e,a),p=u.shouldFallback()&&n):(p=n,lt(s(c,o.UnknownType),a)),p){var h=e.fallback;h||t.setShouldFallback(!0),"string"==typeof h&&"drop"===h.toLowerCase()?u=null:"object"==typeof h&&(u=d(t,h,i,!0,r,s,a))}}return u}function f(t,e,i,n,r){return d(t,e,i,n,(function(t){return dt.actionTypeRegistry.createInstance(t)}),(function(t,e){return e==o.UnknownType?{error:s.ValidationError.UnknownActionType,message:"Unknown action type: "+t+". Fallback will be used if present."}:{error:s.ValidationError.ActionTypeNotAllowed,message:"Action type "+t+" is not allowed in this context."}}),r)}function y(t,e,i,n){return d(t,e,[],i,(function(t){return dt.elementTypeRegistry.createInstance(t)}),(function(t,e){return e==o.UnknownType?{error:s.ValidationError.UnknownElementType,message:"Unknown element type: "+t+". Fallback will be used if present."}:{error:s.ValidationError.ElementTypeNotAllowed,message:"Element type "+t+" is not allowed in this context."}}),n)}!function(t){t[t.UnknownType=0]="UnknownType",t[t.ForbiddenType=1]="ForbiddenType"}(o||(o={})),e.createActionInstance=f,e.createElementInstance=y;var g=function(){function t(){this._rawProperties={}}return t.prototype.parse=function(t,e){this._rawProperties=dt.enableFullJsonRoundTrip?t:{}},t.prototype.toJSON=function(){return dt.enableFullJsonRoundTrip&&this._rawProperties&&"object"==typeof this._rawProperties?this._rawProperties:{}},t.prototype.setCustomProperty=function(t,e){this._rawProperties[t]=e},t.prototype.getCustomProperty=function(t){return this._rawProperties[t]},t}();e.SerializableObject=g;var m=function(t){this.cardObject=t,this.errors=[]};e.ValidationFailure=m;var v=function(){function t(){this.allIds={},this.failures=[]}return t.prototype.getFailureIndex=function(t){for(var e=0;e<this.failures.length;e++)if(this.failures[e].cardObject===t)return e;return-1},t.prototype.addFailure=function(t,e){var i,n=this.getFailureIndex(t);n<0?(i=new m(t),this.failures.push(i)):i=this.failures[n],i.errors.push(e)},t}();e.ValidationResults=v;var b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.internalValidateProperties=function(t){l.isNullOrEmpty(this.id)||(t.allIds.hasOwnProperty(this.id)?(1==t.allIds[this.id]&&t.addFailure(this,{error:s.ValidationError.DuplicateId,message:"Duplicate Id: "+this.id}),t.allIds[this.id]+=1):t.allIds[this.id]=1)},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this.id=l.getStringValue(e.id)},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"type",this.getJsonTypeName()),l.setProperty(e,"id",this.id),e},e.prototype.validateProperties=function(){var t=new v;return this.internalValidateProperties(t),t},e}(g);e.CardObject=b;var C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._shouldFallback=!1,e._lang=void 0,e._hostConfig=null,e._parent=null,e._renderedElement=null,e._separatorElement=null,e._isVisible=!0,e._truncatedDueToOverflow=!1,e._defaultRenderedElementDisplayMode=null,e._padding=null,e.requires=new u.HostCapabilities,e.horizontalAlignment=null,e.spacing=s.Spacing.Default,e.separator=!1,e.customCssSelector=null,e.height="auto",e.minPixelHeight=null,e}return r(e,t),e.prototype.internalRenderSeparator=function(){return l.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:null,lineColor:this.separator?this.hostConfig.separator.lineColor:null},this.separatorOrientation)},e.prototype.updateRenderedElementVisibility=function(){var t=this.isDesignMode()||this.isVisible?this._defaultRenderedElementDisplayMode:"none";this._renderedElement&&(this._renderedElement.style.display=t),this._separatorElement&&(this.parent&&this.parent.isFirstElement(this)?this._separatorElement.style.display="none":this._separatorElement.style.display=t)},e.prototype.hideElementDueToOverflow=function(){this._renderedElement&&this.isVisible&&(this._renderedElement.style.visibility="hidden",this.isVisible=!1,at(this,!1))},e.prototype.showElementHiddenDueToOverflow=function(){this._renderedElement&&!this.isVisible&&(this._renderedElement.style.visibility=null,this.isVisible=!0,at(this,!1))},e.prototype.handleOverflow=function(t){if(this.isVisible||this.isHiddenDueToOverflow()){var e=this.truncateOverflow(t);this._truncatedDueToOverflow=e||this._truncatedDueToOverflow,e?e&&!this.isVisible&&this.showElementHiddenDueToOverflow():this.hideElementDueToOverflow()}},e.prototype.resetOverflow=function(){var t=!1;return this._truncatedDueToOverflow&&(this.undoOverflowTruncation(),this._truncatedDueToOverflow=!1,t=!0),this.isHiddenDueToOverflow&&this.showElementHiddenDueToOverflow(),t},e.prototype.createPlaceholderElement=function(){var t=document.createElement("div");return t.style.border="1px dashed #DDDDDD",t.style.padding="4px",t.style.minHeight="32px",t.style.fontSize="10px",t.innerText="Empty "+this.getJsonTypeName(),t},e.prototype.adjustRenderedElementSize=function(t){"auto"===this.height?t.style.flex="0 0 auto":t.style.flex="1 1 auto",this.minPixelHeight&&(t.style.minHeight=this.minPixelHeight+"px")},e.prototype.overrideInternalRender=function(){return this.internalRender()},e.prototype.applyPadding=function(){if(this.separatorElement)if(dt.alwaysBleedSeparators&&this.separatorOrientation==s.Orientation.Horizontal&&!this.isBleeding()){var t=new a.PaddingDefinition;this.getImmediateSurroundingPadding(t);var e=this.hostConfig.paddingDefinitionToSpacingDefinition(t);this.separatorElement.style.marginLeft="-"+e.left+"px",this.separatorElement.style.marginRight="-"+e.right+"px"}else this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0"},e.prototype.truncateOverflow=function(t){return!1},e.prototype.undoOverflowTruncation=function(){},e.prototype.getDefaultPadding=function(){return new a.PaddingDefinition},e.prototype.getHasBackground=function(){return!1},e.prototype.getPadding=function(){return this._padding},e.prototype.setPadding=function(t){this._padding=t},Object.defineProperty(e.prototype,"supportsMinHeight",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowCustomPadding",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"separatorOrientation",{get:function(){return s.Orientation.Horizontal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultStyle",{get:function(){return s.ContainerStyle.Default},enumerable:!0,configurable:!0}),e.prototype.asString=function(){return""},e.prototype.isBleeding=function(){return!1},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"isVisible",this.isVisible,!0),null!==this.horizontalAlignment&&l.setEnumProperty(s.HorizontalAlignment,e,"horizontalAlignment",this.horizontalAlignment),l.setEnumProperty(s.Spacing,e,"spacing",this.spacing,s.Spacing.Default),l.setProperty(e,"separator",this.separator,!1),l.setProperty(e,"height",this.height,"auto"),this.minPixelHeight&&l.setProperty(e,"minHeight",this.minPixelHeight+"px"),e},e.prototype.setParent=function(t){this._parent=t},e.prototype.getEffectiveStyle=function(){return this.parent?this.parent.getEffectiveStyle():this.defaultStyle},e.prototype.getForbiddenElementTypes=function(){return null},e.prototype.getForbiddenActionTypes=function(){return null},e.prototype.getImmediateSurroundingPadding=function(t,e,i,n,r){if(void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),this.parent){var o=e&&this.parent.isTopElement(this),a=i&&this.parent.isRightMostElement(this),l=n&&this.parent.isBottomElement(this),u=r&&this.parent.isLeftMostElement(this),p=this.parent.getEffectivePadding();p&&(o&&p.top!=s.Spacing.None&&(t.top=p.top,o=!1),a&&p.right!=s.Spacing.None&&(t.right=p.right,a=!1),l&&p.bottom!=s.Spacing.None&&(t.bottom=p.bottom,l=!1),u&&p.left!=s.Spacing.None&&(t.left=p.left,u=!1)),(o||a||l||u)&&this.parent.getImmediateSurroundingPadding(t,o,a,l,u)}},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),function(t,e,i){var n=t.getRootElement(),r=n&&n.onParseElement?n.onParseElement:dt.onParseElement;null!=r&&r(t,e,i)}(this,e,i),this.requires.parse(e.requires,i),this.isVisible=l.getBoolValue(e.isVisible,this.isVisible),this.horizontalAlignment=l.getEnumValue(s.HorizontalAlignment,e.horizontalAlignment,this.horizontalAlignment),this.spacing=l.getEnumValue(s.Spacing,e.spacing,s.Spacing.Default),this.separator=l.getBoolValue(e.separator,this.separator);var n=e.separation;void 0!==n&&("none"===n?(this.spacing=s.Spacing.None,this.separator=!1):"strong"===n?(this.spacing=s.Spacing.Large,this.separator=!0):"default"===n&&(this.spacing=s.Spacing.Default,this.separator=!1),lt({error:s.ValidationError.Deprecated,message:'The "separation" property is deprecated and will be removed. Use the "spacing" and "separator" properties instead.'},i));var r=e.height;if("auto"!==r&&"stretch"!==r||(this.height=r),this.supportsMinHeight){var o=e.minHeight;if(o&&"string"==typeof o){var u=!1;try{var p=a.SizeAndUnit.parse(o,!0);p.unit==s.SizeUnit.Pixel&&(this.minPixelHeight=p.physicalSize,u=!0)}catch(t){}u||lt({error:s.ValidationError.InvalidPropertyValue,message:'Invalid "minHeight" value: '+o},i)}}},e.prototype.getActionCount=function(){return 0},e.prototype.getActionAt=function(t){throw new Error("Index out of range.")},e.prototype.remove=function(){return!!(this.parent&&this.parent instanceof T)&&this.parent.removeItem(this)},e.prototype.render=function(){return this._renderedElement=this.overrideInternalRender(),this._separatorElement=this.internalRenderSeparator(),this._renderedElement?(this.customCssSelector&&this._renderedElement.classList.add(this.customCssSelector),this._renderedElement.style.boxSizing="border-box",this._defaultRenderedElementDisplayMode=this._renderedElement.style.display,this.adjustRenderedElementSize(this._renderedElement),this.updateLayout(!1)):this.isDesignMode()&&(this._renderedElement=this.createPlaceholderElement()),this._renderedElement},e.prototype.updateLayout=function(t){void 0===t&&(t=!0),this.updateRenderedElementVisibility(),this.applyPadding()},e.prototype.indexOf=function(t){return-1},e.prototype.isDesignMode=function(){var t=this.getRootElement();return t instanceof dt&&t.designMode},e.prototype.isRendered=function(){return this._renderedElement&&this._renderedElement.offsetHeight>0},e.prototype.isFirstElement=function(t){return!0},e.prototype.isLastElement=function(t){return!0},e.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},e.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},e.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},e.prototype.isAtTheVeryBottom=function(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()},e.prototype.isBleedingAtTop=function(){return!1},e.prototype.isBleedingAtBottom=function(){return!1},e.prototype.isLeftMostElement=function(t){return!0},e.prototype.isRightMostElement=function(t){return!0},e.prototype.isTopElement=function(t){return this.isFirstElement(t)},e.prototype.isBottomElement=function(t){return this.isLastElement(t)},e.prototype.isHiddenDueToOverflow=function(){return this._renderedElement&&"hidden"==this._renderedElement.style.visibility},e.prototype.getRootElement=function(){for(var t=this;t.parent;)t=t.parent;return t},e.prototype.getParentContainer=function(){for(var t=this.parent;t;){if(t instanceof et)return t;t=t.parent}return null},e.prototype.getAllInputs=function(){return[]},e.prototype.getResourceInformation=function(){return[]},e.prototype.getElementById=function(t){return this.id===t?this:null},e.prototype.getActionById=function(t){return null},e.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)},e.prototype.setShouldFallback=function(t){this._shouldFallback=t},e.prototype.getEffectivePadding=function(){var t=this.getPadding();return t&&this.allowCustomPadding?t:this.getDefaultPadding()},Object.defineProperty(e.prototype,"lang",{get:function(){return this._lang?this._lang:this.parent?this.parent.lang:void 0},set:function(t){if(t&&""!=t){if(!/^[a-z]{2,3}$/gi.exec(t))throw new Error("Invalid language identifier: "+t)}this._lang=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:yt},set:function(t){this._hostConfig=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.parent?this.parent.indexOf(this):0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInteractive",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isStandalone",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInline",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return this._isVisible},set:function(t){dt.useAdvancedCardBottomTruncation&&!t&&this.undoOverflowTruncation(),this._isVisible!=t&&(this._isVisible=t,this.updateRenderedElementVisibility(),this._renderedElement&&at(this))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasVisibleSeparator",{get:function(){return!(!this.parent||!this.separatorElement)&&(!this.parent.isFirstElement(this)&&(this.isVisible||this.isDesignMode()))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"separatorElement",{get:function(){return this._separatorElement},enumerable:!0,configurable:!0}),e}(b);e.CardElement=C;var S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._selectAction=null,e.size=s.TextSize.Default,e.weight=s.TextWeight.Default,e.color=s.TextColor.Default,e.isSubtle=!1,e.fontType=null,e}return r(e,t),e.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())},e.prototype.getFontSize=function(t){switch(this.size){case s.TextSize.Small:return t.fontSizes.small;case s.TextSize.Medium:return t.fontSizes.medium;case s.TextSize.Large:return t.fontSizes.large;case s.TextSize.ExtraLarge:return t.fontSizes.extraLarge;default:return t.fontSizes.default}},e.prototype.getColorDefinition=function(t,e){switch(e){case s.TextColor.Accent:return t.accent;case s.TextColor.Dark:return t.dark;case s.TextColor.Light:return t.light;case s.TextColor.Good:return t.good;case s.TextColor.Warning:return t.warning;case s.TextColor.Attention:return t.attention;default:return t.default}},e.prototype.setText=function(t){this._text=t},e.prototype.asString=function(){return this.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setEnumProperty(s.TextSize,e,"size",this.size,s.TextSize.Default),l.setEnumProperty(s.TextWeight,e,"weight",this.weight,s.TextWeight.Default),l.setEnumProperty(s.TextColor,e,"color",this.color,s.TextColor.Default),l.setProperty(e,"text",this.text),l.setProperty(e,"isSubtle",this.isSubtle,!1),l.setEnumProperty(s.FontType,e,"fontType",this.fontType,s.FontType.Default),e},e.prototype.applyStylesTo=function(t){var e,i=this.hostConfig.getFontTypeDefinition(this.fontType);switch(i.fontFamily&&(t.style.fontFamily=i.fontFamily),this.size){case s.TextSize.Small:e=i.fontSizes.small;break;case s.TextSize.Medium:e=i.fontSizes.medium;break;case s.TextSize.Large:e=i.fontSizes.large;break;case s.TextSize.ExtraLarge:e=i.fontSizes.extraLarge;break;default:e=i.fontSizes.default}t.style.fontSize=e+"px";var n,r=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);switch(t.style.color=l.stringToCssColor(this.isSubtle?r.subtle:r.default),this.weight){case s.TextWeight.Lighter:n=i.fontWeights.lighter;break;case s.TextWeight.Bolder:n=i.fontWeights.bolder;break;default:n=i.fontWeights.default}t.style.fontWeight=n.toString()},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this.text=l.getStringValue(e.text);var n=l.getStringValue(e.size);n&&"normal"===n.toLowerCase()?(this.size=s.TextSize.Default,lt({error:s.ValidationError.Deprecated,message:'The TextBlock.size value "normal" is deprecated and will be removed. Use "default" instead.'},i)):this.size=l.getEnumValue(s.TextSize,n,this.size);var r=l.getStringValue(e.weight);r&&"normal"===r.toLowerCase()?(this.weight=s.TextWeight.Default,lt({error:s.ValidationError.Deprecated,message:'The TextBlock.weight value "normal" is deprecated and will be removed. Use "default" instead.'},i)):this.weight=l.getEnumValue(s.TextWeight,r,this.weight),this.color=l.getEnumValue(s.TextColor,e.color,this.color),this.isSubtle=l.getBoolValue(e.isSubtle,this.isSubtle),this.fontType=l.getEnumValue(s.FontType,e.fontType,this.fontType)},Object.defineProperty(e.prototype,"effectiveColor",{get:function(){return this.color?this.color:s.TextColor.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){this.setText(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectAction",{get:function(){return this._selectAction},set:function(t){this._selectAction=t,this._selectAction&&this._selectAction.setParent(this)},enumerable:!0,configurable:!0}),e}(C);e.BaseTextBlock=S;var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._processedText=null,e._treatAsPlainText=!0,e.wrap=!1,e.useMarkdown=!0,e}return r(e,t),e.prototype.restoreOriginalContent=function(){var t=this.maxLines?this._computedLineHeight*this.maxLines+"px":null;this.renderedElement.style.maxHeight=t,this.renderedElement.innerHTML=this._originalInnerHtml},e.prototype.truncateIfSupported=function(t){var e=this.renderedElement.children,i=!e.length;if(i||1==e.length&&"p"==e[0].tagName.toLowerCase()){var n=i?this.renderedElement:e[0];return l.truncate(n,t,this._computedLineHeight),!0}return!1},e.prototype.setText=function(e){t.prototype.setText.call(this,e),this._processedText=null},e.prototype.getRenderedDomElementType=function(){return"div"},e.prototype.internalRender=function(){var t=this;if(this._processedText=null,l.isNullOrEmpty(this.text))return null;var e=this.hostConfig,i=document.createElement(this.getRenderedDomElementType());if(i.classList.add(e.makeCssClassName("ac-textBlock")),i.style.overflow="hidden",this.applyStylesTo(i),this.selectAction&&(i.onclick=function(e){e.preventDefault(),e.cancelBubble=!0,t.selectAction.execute()},e.supportsInteractivity&&(i.tabIndex=0,i.setAttribute("role","button"),i.setAttribute("aria-label",this.selectAction.title),i.classList.add(e.makeCssClassName("ac-selectable")))),!this._processedText){this._treatAsPlainText=!0;var n=p.formatText(this.lang,this.text);if(this.useMarkdown){dt.allowMarkForTextHighlighting&&(n=n.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/=="));var r=dt.applyMarkdown(n);if(r.didProcess&&r.outputHtml){if(this._processedText=r.outputHtml,this._treatAsPlainText=!1,dt.allowMarkForTextHighlighting){var o="",s=this.getEffectiveStyleDefinition();s.highlightBackgroundColor&&(o+="background-color: "+s.highlightBackgroundColor+";"),s.highlightForegroundColor&&(o+="color: "+s.highlightForegroundColor+";"),l.isNullOrEmpty(o)||(o='style="'+o+'"'),this._processedText=this._processedText.replace(/===/g,"<mark "+o+">").replace(/\/==/g,"</mark>")}}else this._processedText=n,this._treatAsPlainText=!0}else this._processedText=n,this._treatAsPlainText=!0}if(this._treatAsPlainText?i.innerText=this._processedText:i.innerHTML=this._processedText,i.firstElementChild instanceof HTMLElement){var a=i.firstElementChild;a.style.marginTop="0px",a.style.width="100%",this.wrap||(a.style.overflow="hidden",a.style.textOverflow="ellipsis")}i.lastElementChild instanceof HTMLElement&&(i.lastElementChild.style.marginBottom="0px");for(var u=i.getElementsByTagName("a"),c=0;c<u.length;c++){var h=u[c];h.classList.add(e.makeCssClassName("ac-anchor")),h.target="_blank",h.onclick=function(e){ot(t,e.target)&&(e.preventDefault(),e.cancelBubble=!0)}}return this.wrap?(i.style.wordWrap="break-word",this.maxLines>0&&(i.style.maxHeight=this._computedLineHeight*this.maxLines+"px",i.style.overflow="hidden")):(i.style.whiteSpace="nowrap",i.style.textOverflow="ellipsis"),(dt.useAdvancedTextBlockTruncation||dt.useAdvancedCardBottomTruncation)&&(this._originalInnerHtml=i.innerHTML),i},e.prototype.truncateOverflow=function(t){return t>=this._computedLineHeight&&this.truncateIfSupported(t)},e.prototype.undoOverflowTruncation=function(){if(this.restoreOriginalContent(),dt.useAdvancedTextBlockTruncation&&this.maxLines){var t=this._computedLineHeight*this.maxLines;this.truncateIfSupported(t)}},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"wrap",this.wrap,!1),l.setProperty(e,"maxLines",this.maxLines,0),e},e.prototype.applyStylesTo=function(e){t.prototype.applyStylesTo.call(this,e);var i=this.getParentContainer(),n=!!i&&i.isRtl();switch(this.horizontalAlignment){case s.HorizontalAlignment.Center:e.style.textAlign="center";break;case s.HorizontalAlignment.Right:e.style.textAlign=n?"left":"right";break;default:e.style.textAlign=n?"right":"left"}var r=this.hostConfig.lineHeights;if(r)switch(this.size){case s.TextSize.Small:this._computedLineHeight=r.small;break;case s.TextSize.Medium:this._computedLineHeight=r.medium;break;case s.TextSize.Large:this._computedLineHeight=r.large;break;case s.TextSize.ExtraLarge:this._computedLineHeight=r.extraLarge;break;default:this._computedLineHeight=r.default}else this._computedLineHeight=1.33*this.getFontSize(this.hostConfig.getFontTypeDefinition(this.fontType));e.style.lineHeight=this._computedLineHeight+"px"},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this.wrap=l.getBoolValue(e.wrap,this.wrap),"number"==typeof e.maxLines&&(this.maxLines=e.maxLines)},e.prototype.getJsonTypeName=function(){return"TextBlock"},e.prototype.updateLayout=function(e){void 0===e&&(e=!1),t.prototype.updateLayout.call(this,e),dt.useAdvancedTextBlockTruncation&&this.maxLines&&this.isRendered()&&(this.restoreOriginalContent(),this.truncateIfSupported(this._computedLineHeight*this.maxLines))},e}(S);e.TextBlock=_;var A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getRenderedDomElementType=function(){return"label"},e.prototype.internalRender=function(){var e=t.prototype.internalRender.call(this);return l.isNullOrEmpty(this.forElementId)||(e.htmlFor=this.forElementId),e},e}(_),E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.italic=!1,e.strikethrough=!1,e.highlight=!1,e}return r(e,t),e.prototype.internalRender=function(){var t=this;if(l.isNullOrEmpty(this.text))return null;var e=this.hostConfig,i=p.formatText(this.lang,this.text),n=document.createElement("span");if(n.classList.add(e.makeCssClassName("ac-textRun")),this.applyStylesTo(n),this.selectAction&&e.supportsInteractivity){var r=document.createElement("a");r.classList.add(e.makeCssClassName("ac-anchor")),r.href=this.selectAction.getHref(),r.target="_blank",r.onclick=function(e){e.preventDefault(),e.cancelBubble=!0,t.selectAction.execute()},r.innerText=i,n.appendChild(r)}else n.innerText=i;return n},e.prototype.applyStylesTo=function(e){if(t.prototype.applyStylesTo.call(this,e),this.italic&&(e.style.fontStyle="italic"),this.strikethrough&&(e.style.textDecoration="line-through"),this.highlight){var i=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);e.style.backgroundColor=l.stringToCssColor(this.isSubtle?i.highlightColors.subtle:i.highlightColors.default)}},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"italic",this.italic,!1),l.setProperty(e,"strikethrough",this.strikethrough,!1),l.setProperty(e,"highlight",this.highlight,!1),this.selectAction&&l.setProperty(e,"selectAction",this.selectAction.toJSON()),e},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this.italic=l.getBoolValue(e.italic,this.italic),this.strikethrough=l.getBoolValue(e.strikethrough,this.strikethrough),this.highlight=l.getBoolValue(e.highlight,this.highlight),this.selectAction=f(this,e.selectAction,[$.JsonTypeName],!this.isDesignMode(),i)},e.prototype.getJsonTypeName=function(){return"TextRun"},Object.defineProperty(e.prototype,"isStandalone",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInline",{get:function(){return!0},enumerable:!0,configurable:!0}),e}(S);e.TextRun=E;var P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._inlines=[],e}return r(e,t),e.prototype.internalAddInline=function(t,e){if(void 0===e&&(e=!1),!t.isInline)throw new Error("RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline.");if(!(null==t.parent||e)&&t.parent!=this)throw new Error("RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock.");t.setParent(this),this._inlines.push(t)},e.prototype.internalRender=function(){if(this._inlines.length>0){var t=document.createElement("div");t.className=this.hostConfig.makeCssClassName("ac-richTextBlock");var e=this.getParentContainer(),i=!!e&&e.isRtl();switch(this.horizontalAlignment){case s.HorizontalAlignment.Center:t.style.textAlign="center";break;case s.HorizontalAlignment.Right:t.style.textAlign=i?"left":"right";break;default:t.style.textAlign=i?"right":"left"}for(var n=0,r=this._inlines;n<r.length;n++){var o=r[n];t.appendChild(o.render())}return t}return null},e.prototype.asString=function(){for(var t="",e=0,i=this._inlines;e<i.length;e++){t+=i[e].asString()}return t},e.prototype.parse=function(e,i){if(t.prototype.parse.call(this,e,i),this._inlines=[],Array.isArray(e.inlines))for(var n=0,r=e.inlines;n<r.length;n++){var o=r[n],s=void 0;if("string"==typeof o){var a=new E;a.text=o,s=a}else s=y(this,o,!1,i);s&&this.internalAddInline(s,!0)}},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);if(this._inlines.length>0){for(var i=[],n=0,r=this._inlines;n<r.length;n++){var o=r[n];i.push(o.toJSON())}l.setProperty(e,"inlines",i)}return e},e.prototype.getJsonTypeName=function(){return"RichTextBlock"},e.prototype.getInlineCount=function(){return this._inlines.length},e.prototype.getInlineAt=function(t){if(t>=0&&t<this._inlines.length)return this._inlines[t];throw new Error("RichTextBlock.getInlineAt: Index out of range ("+t+")")},e.prototype.addInline=function(t){this.internalAddInline(t)},e.prototype.removeInline=function(t){var e=this._inlines.indexOf(t);return e>=0&&(this._inlines[e].setParent(null),this._inlines.splice(e,1),!0)},e}(C);e.RichTextBlock=P;var x=function(){function t(t,e){void 0===t&&(t=void 0),void 0===e&&(e=void 0),this.name=t,this.value=e}return t.prototype.parse=function(t){this.name=l.getStringValue(t.title),this.value=l.getStringValue(t.value)},t.prototype.toJSON=function(){return{title:this.name,value:this.value}},t}();e.Fact=x;var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.facts=[],e}return r(e,t),Object.defineProperty(e.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.internalRender=function(){var t=null,e=this.hostConfig;if(this.facts.length>0){(t=document.createElement("table")).style.borderWidth="0px",t.style.borderSpacing="0px",t.style.borderStyle="none",t.style.borderCollapse="collapse",t.style.display="block",t.style.overflow="hidden",t.classList.add(e.makeCssClassName("ac-factset"));for(var i=0;i<this.facts.length;i++){var n=document.createElement("tr");i>0&&(n.style.marginTop=e.factSet.spacing+"px");var r=document.createElement("td");r.style.padding="0",r.classList.add(e.makeCssClassName("ac-fact-title")),e.factSet.title.maxWidth&&(r.style.maxWidth=e.factSet.title.maxWidth+"px"),r.style.verticalAlign="top";var o=new _;o.setParent(this),o.text=l.isNullOrEmpty(this.facts[i].name)?"Title":this.facts[i].name,o.size=e.factSet.title.size,o.color=e.factSet.title.color,o.isSubtle=e.factSet.title.isSubtle,o.weight=e.factSet.title.weight,o.wrap=e.factSet.title.wrap,o.spacing=s.Spacing.None,l.appendChild(r,o.render()),l.appendChild(n,r),(r=document.createElement("td")).style.width="10px",l.appendChild(n,r),(r=document.createElement("td")).style.padding="0",r.style.verticalAlign="top",r.classList.add(e.makeCssClassName("ac-fact-value")),(o=new _).setParent(this),o.text=this.facts[i].value,o.size=e.factSet.value.size,o.color=e.factSet.value.color,o.isSubtle=e.factSet.value.isSubtle,o.weight=e.factSet.value.weight,o.wrap=e.factSet.value.wrap,o.spacing=s.Spacing.None,l.appendChild(r,o.render()),l.appendChild(n,r),l.appendChild(t,n)}}return t},e.prototype.getJsonTypeName=function(){return"FactSet"},e.prototype.toJSON=function(){for(var e=t.prototype.toJSON.call(this),i=[],n=0,r=this.facts;n<r.length;n++){var o=r[n];i.push(o.toJSON())}return l.setProperty(e,"facts",i),e},e.prototype.parse=function(e,i){if(t.prototype.parse.call(this,e,i),this.facts=[],null!=e.facts){var n=e.facts;this.facts=[];for(var r=0;r<n.length;r++){var o=new x;o.parse(n[r]),this.facts.push(o)}}},e}(C);e.FactSet=w;var I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.style=s.ImageStyle.Default,e.size=s.Size.Auto,e.pixelWidth=null,e.pixelHeight=null,e.altText="",e}return r(e,t),e.prototype.parseDimension=function(t,e,i){if(e){if("string"==typeof e)try{var n=a.SizeAndUnit.parse(e);if(n.unit==s.SizeUnit.Pixel)return n.physicalSize}catch(t){}lt({error:s.ValidationError.InvalidPropertyValue,message:"Invalid image "+t+": "+e},i)}return 0},e.prototype.applySize=function(t){if(this.pixelWidth||this.pixelHeight)this.pixelWidth&&(t.style.width=this.pixelWidth+"px"),this.pixelHeight&&(t.style.height=this.pixelHeight+"px");else switch(this.size){case s.Size.Stretch:t.style.width="100%";break;case s.Size.Auto:t.style.maxWidth="100%";break;case s.Size.Small:t.style.width=this.hostConfig.imageSizes.small+"px";break;case s.Size.Large:t.style.width=this.hostConfig.imageSizes.large+"px";break;case s.Size.Medium:t.style.width=this.hostConfig.imageSizes.medium+"px"}},Object.defineProperty(e.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.internalRender=function(){var t=this,e=null;if(!l.isNullOrEmpty(this.url)){switch((e=document.createElement("div")).style.display="flex",e.style.alignItems="flex-start",e.onkeypress=function(e){!t.selectAction||13!=e.keyCode&&32!=e.keyCode||(e.preventDefault(),e.cancelBubble=!0,t.selectAction.execute())},e.onclick=function(e){t.selectAction&&(e.preventDefault(),e.cancelBubble=!0,t.selectAction.execute())},this.horizontalAlignment){case s.HorizontalAlignment.Center:e.style.justifyContent="center";break;case s.HorizontalAlignment.Right:e.style.justifyContent="flex-end";break;default:e.style.justifyContent="flex-start"}var i=this.hostConfig,n=document.createElement("img");n.onload=function(e){rt(t)},n.onerror=function(e){var i=t.getRootElement();if(t.renderedElement.innerHTML="",i&&i.designMode){var n=document.createElement("div");n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.backgroundColor="#EEEEEE",n.style.color="black",n.innerText=":-(",n.style.padding="10px",t.applySize(n),t.renderedElement.appendChild(n)}rt(t)},n.style.maxHeight="100%",n.style.minWidth="0",n.classList.add(i.makeCssClassName("ac-image")),null!=this.selectAction&&i.supportsInteractivity&&(n.tabIndex=0,n.setAttribute("role","button"),n.setAttribute("aria-label",this.selectAction.title),n.classList.add(i.makeCssClassName("ac-selectable"))),this.applySize(n),this.style===s.ImageStyle.Person&&(n.style.borderRadius="50%",n.style.backgroundPosition="50% 50%",n.style.backgroundRepeat="no-repeat"),l.isNullOrEmpty(this.backgroundColor)||(n.style.backgroundColor=l.stringToCssColor(this.backgroundColor)),n.src=this.url,n.alt=this.altText,e.appendChild(n)}return e},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return this._selectAction&&l.setProperty(e,"selectAction",this._selectAction.toJSON()),l.setEnumProperty(s.ImageStyle,e,"style",this.style,s.ImageStyle.Default),l.setProperty(e,"backgroundColor",this.backgroundColor),l.setProperty(e,"url",this.url),l.setEnumProperty(s.Size,e,"size",this.size,s.Size.Auto),this.pixelWidth&&l.setProperty(e,"width",this.pixelWidth+"px"),this.pixelHeight&&l.setProperty(e,"height",this.pixelHeight+"px"),l.setProperty(e,"altText",this.altText),e},e.prototype.getJsonTypeName=function(){return"Image"},e.prototype.getActionById=function(e){var i=t.prototype.getActionById.call(this,e);return!i&&this.selectAction&&(i=this.selectAction.getActionById(e)),i},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this.url=l.getStringValue(e.url),this.backgroundColor=l.getStringValue(e.backgroundColor);var n=l.getStringValue(e.style);n&&"normal"===n.toLowerCase()?(this.style=s.ImageStyle.Default,lt({error:s.ValidationError.Deprecated,message:'The Image.style value "normal" is deprecated and will be removed. Use "default" instead.'},i)):this.style=l.getEnumValue(s.ImageStyle,n,this.style),this.size=l.getEnumValue(s.Size,e.size,this.size),this.altText=e.altText,e.pixelWidth&&"number"==typeof e.pixelWidth&&(this.pixelWidth=e.pixelWidth,lt({error:s.ValidationError.Deprecated,message:"The pixelWidth property is deprecated and will be removed. Use the width property instead."},i)),e.pixelHeight&&"number"==typeof e.pixelHeight&&(this.pixelHeight=e.pixelHeight,lt({error:s.ValidationError.Deprecated,message:"The pixelHeight property is deprecated and will be removed. Use the height property instead."},i));var r=this.parseDimension("width",e.width,i);r>0&&(this.pixelWidth=r),(r=this.parseDimension("height",e.height,i))>0&&(this.pixelHeight=r),this.selectAction=f(this,e.selectAction,[$.JsonTypeName],!this.isDesignMode(),i)},e.prototype.getResourceInformation=function(){return l.isNullOrEmpty(this.url)?[]:[{url:this.url,mimeType:"image"}]},Object.defineProperty(e.prototype,"selectAction",{get:function(){return this._selectAction},set:function(t){this._selectAction=t,this._selectAction&&this._selectAction.setParent(this)},enumerable:!0,configurable:!0}),e}(C);e.Image=I;var T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._selectAction=null,e}return r(e,t),e.prototype.isElementAllowed=function(t,e){if(!this.hostConfig.supportsInteractivity&&t.isInteractive)return!1;if(e)for(var i=0,n=e;i<n.length;i++){var r=n[i];if(t.getJsonTypeName()===r)return!1}return!0},e.prototype.applyPadding=function(){if(t.prototype.applyPadding.call(this),this.renderedElement){var e=new a.SpacingDefinition;this.getEffectivePadding()&&(e=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=e.top+"px",this.renderedElement.style.paddingRight=e.right+"px",this.renderedElement.style.paddingBottom=e.bottom+"px",this.renderedElement.style.paddingLeft=e.left+"px",this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0"}},e.prototype.getSelectAction=function(){return this._selectAction},e.prototype.setSelectAction=function(t){this._selectAction=t,this._selectAction&&this._selectAction.setParent(this)},Object.defineProperty(e.prototype,"isSelectable",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this.isSelectable&&(this._selectAction=f(this,e.selectAction,[$.JsonTypeName],!this.isDesignMode(),i))},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return this._selectAction&&this.isSelectable&&l.setProperty(e,"selectAction",this._selectAction.toJSON()),e},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e);for(var i=0;i<this.getItemCount();i++){var n=this.getItemAt(i);!this.hostConfig.supportsInteractivity&&n.isInteractive&&e.addFailure(this,{error:s.ValidationError.InteractivityNotAllowed,message:"Interactivity is not allowed."}),this.isElementAllowed(n,this.getForbiddenElementTypes())||e.addFailure(this,{error:s.ValidationError.InteractivityNotAllowed,message:"Elements of type "+n.getJsonTypeName()+" are not allowed in this container."}),n.internalValidateProperties(e)}this._selectAction&&this._selectAction.internalValidateProperties(e)},e.prototype.render=function(){var e=this,i=t.prototype.render.call(this),n=this.hostConfig;return i&&this.isSelectable&&this._selectAction&&n.supportsInteractivity&&(i.classList.add(n.makeCssClassName("ac-selectable")),i.tabIndex=0,i.setAttribute("role","button"),i.setAttribute("aria-label",this._selectAction.title),i.onclick=function(t){null!=e._selectAction&&(t.preventDefault(),t.cancelBubble=!0,e._selectAction.execute())},i.onkeypress=function(t){null==e._selectAction||13!=t.keyCode&&32!=t.keyCode||(t.preventDefault(),t.cancelBubble=!0,e._selectAction.execute())}),i},e.prototype.updateLayout=function(e){if(void 0===e&&(e=!0),t.prototype.updateLayout.call(this,e),e)for(var i=0;i<this.getItemCount();i++)this.getItemAt(i).updateLayout()},e.prototype.getAllInputs=function(){for(var t=[],e=0;e<this.getItemCount();e++)t=t.concat(this.getItemAt(e).getAllInputs());return t},e.prototype.getResourceInformation=function(){for(var t=[],e=0;e<this.getItemCount();e++)t=t.concat(this.getItemAt(e).getResourceInformation());return t},e.prototype.getElementById=function(e){var i=t.prototype.getElementById.call(this,e);if(!i)for(var n=0;n<this.getItemCount()&&!(i=this.getItemAt(n).getElementById(e));n++);return i},e}(C);e.CardElementContainer=T;var V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._images=[],e.imageSize=s.Size.Medium,e}return r(e,t),e.prototype.internalRender=function(){var t=null;if(this._images.length>0){(t=document.createElement("div")).style.display="flex",t.style.flexWrap="wrap";for(var e=0;e<this._images.length;e++){this._images[e].size=this.imageSize;var i=this._images[e].render();i.style.display="inline-flex",i.style.margin="0px",i.style.marginRight="10px",i.style.maxHeight=this.hostConfig.imageSet.maxImageHeight+"px",l.appendChild(t,i)}}return t},e.prototype.getItemCount=function(){return this._images.length},e.prototype.getItemAt=function(t){return this._images[t]},e.prototype.getFirstVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[0]:null},e.prototype.getLastVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[this._images.length-1]:null},e.prototype.removeItem=function(t){if(t instanceof I){var e=this._images.indexOf(t);if(e>=0)return this._images.splice(e,1),t.setParent(null),this.updateLayout(),!0}return!1},e.prototype.getJsonTypeName=function(){return"ImageSet"},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);if(l.setEnumProperty(s.Size,e,"imageSize",this.imageSize,s.Size.Medium),this._images.length>0){for(var i=[],n=0,r=this._images;n<r.length;n++){var o=r[n];i.push(o.toJSON())}l.setProperty(e,"images",i)}return e},e.prototype.parse=function(e,i){if(t.prototype.parse.call(this,e,i),this.imageSize=l.getEnumValue(s.Size,e.imageSize,s.Size.Medium),null!=e.images){var n=e.images;this._images=[];for(var r=0;r<n.length;r++){var o=new I;o.parse(n[r],i),this.addImage(o)}}},e.prototype.addImage=function(t){if(t.parent)throw new Error("This image already belongs to another ImageSet");this._images.push(t),t.setParent(this)},e.prototype.indexOf=function(t){return t instanceof I?this._images.indexOf(t):-1},e}(T);e.ImageSet=V;var O=function(){function t(t,e){void 0===t&&(t=void 0),void 0===e&&(e=void 0),this.url=t,this.mimeType=e}return t.prototype.parse=function(t,e){this.mimeType=l.getStringValue(t.mimeType),this.url=l.getStringValue(t.url)},t.prototype.toJSON=function(){return{mimeType:this.mimeType,url:this.url}},t}();e.MediaSource=O;var k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sources=[],e}return r(e,t),e.prototype.getPosterUrl=function(){return this.poster?this.poster:this.hostConfig.media.defaultPoster},e.prototype.processSources=function(){this._selectedSources=[],this._selectedMediaType=void 0;for(var t=0,i=this.sources;t<i.length;t++){var n=i[t],r=n.mimeType.split("/");if(2==r.length){if(!this._selectedMediaType){var o=e.supportedMediaTypes.indexOf(r[0]);o>=0&&(this._selectedMediaType=e.supportedMediaTypes[o])}r[0]==this._selectedMediaType&&this._selectedSources.push(n)}}},e.prototype.renderPoster=function(){var t=this,i=document.createElement("div");i.className=this.hostConfig.makeCssClassName("ac-media-poster"),i.setAttribute("role","contentinfo"),i.setAttribute("aria-label",this.altText?this.altText:"Media content"),i.style.position="relative",i.style.display="flex";var n=this.getPosterUrl();if(n){var r=document.createElement("img");r.style.width="100%",r.style.height="100%",r.onerror=function(t){r.parentNode.removeChild(r),i.classList.add("empty"),i.style.minHeight="150px"},r.src=n,i.appendChild(r)}else i.classList.add("empty"),i.style.minHeight="150px";if(this.hostConfig.supportsInteractivity&&this._selectedSources.length>0){var o=document.createElement("div");o.setAttribute("role","button"),o.setAttribute("aria-label","Play media"),o.className=this.hostConfig.makeCssClassName("ac-media-playButton"),o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center",o.onclick=function(i){if(t.hostConfig.media.allowInlinePlayback){i.preventDefault(),i.cancelBubble=!0;var n=t.renderMediaPlayer();t.renderedElement.innerHTML="",t.renderedElement.appendChild(n),n.play()}else e.onPlay&&(i.preventDefault(),i.cancelBubble=!0,e.onPlay(t))};var s=document.createElement("div");s.className=this.hostConfig.makeCssClassName("ac-media-playButton-arrow"),s.style.width="12px",s.style.height="15px",s.style.borderTopWidth="7.5px",s.style.borderBottomWidth="7.5px",s.style.borderLeftWidth="12px",s.style.borderRightWidth="0",s.style.borderStyle="solid",s.style.borderTopColor="transparent",s.style.borderRightColor="transparent",s.style.borderBottomColor="transparent",s.style.transform="translate(1.2px,0px)",o.appendChild(s);var a=document.createElement("div");a.style.position="absolute",a.style.left="0",a.style.top="0",a.style.width="100%",a.style.height="100%",a.style.display="flex",a.style.justifyContent="center",a.style.alignItems="center",a.appendChild(o),i.appendChild(a)}return i},e.prototype.renderMediaPlayer=function(){var t;if("video"==this._selectedMediaType){var e=document.createElement("video"),i=this.getPosterUrl();i&&(e.poster=i),t=e}else t=document.createElement("audio");t.controls=!0,t.preload="none",t.style.width="100%";for(var n=0,r=this.sources;n<r.length;n++){var o=r[n],s=document.createElement("source");s.src=o.url,s.type=o.mimeType,t.appendChild(s)}return t},e.prototype.internalRender=function(){var t=document.createElement("div");return t.className=this.hostConfig.makeCssClassName("ac-media"),this.processSources(),t.appendChild(this.renderPoster()),t},e.prototype.parse=function(e,i){if(t.prototype.parse.call(this,e,i),this.poster=l.getStringValue(e.poster),this.altText=l.getStringValue(e.altText),null!=e.sources){var n=e.sources;this.sources=[];for(var r=0;r<n.length;r++){var o=new O;o.parse(n[r],i),this.sources.push(o)}}},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);if(l.setProperty(e,"poster",this.poster),l.setProperty(e,"altText",this.altText),this.sources.length>0){for(var i=[],n=0,r=this.sources;n<r.length;n++){var o=r[n];i.push(o.toJSON())}l.setProperty(e,"sources",i)}return e},e.prototype.getJsonTypeName=function(){return"Media"},e.prototype.getResourceInformation=function(){var t=[],e=this.getPosterUrl();l.isNullOrEmpty(e)||t.push({url:e,mimeType:"image"});for(var i=0,n=this.sources;i<n.length;i++){var r=n[i];l.isNullOrEmpty(r.url)||t.push({url:r.url,mimeType:r.mimeType})}return t},Object.defineProperty(e.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:!0,configurable:!0}),e.supportedMediaTypes=["audio","video"],e}(C);e.Media=k;var N=function(){function t(){this.necessity=s.InputValidationNecessity.Optional,this.errorMessage=void 0}return t.prototype.parse=function(t){this.necessity=l.getEnumValue(s.InputValidationNecessity,t.necessity,this.necessity),this.errorMessage=l.getStringValue(t.errorMessage)},t.prototype.toJSON=function(){if(this.necessity==s.InputValidationNecessity.Optional&&l.isNullOrEmpty(this.errorMessage))return null;var t={};return l.setEnumProperty(s.InputValidationNecessity,t,"necessity",this.necessity,s.InputValidationNecessity.Optional),l.setProperty(t,"errorMessage",this.errorMessage),t},t}();e.InputValidationOptions=N;var z=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.validation=new N,e}return r(e,t),Object.defineProperty(e.prototype,"isNullable",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderedInputControlElement",{get:function(){return this._renderedInputControlElement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputControlContainerElement",{get:function(){return this._inputControlContainerElement},enumerable:!0,configurable:!0}),e.prototype.overrideInternalRender=function(){var t=this.hostConfig;return this._outerContainerElement=document.createElement("div"),this._outerContainerElement.style.display="flex",this._outerContainerElement.style.flexDirection="column",this._inputControlContainerElement=document.createElement("div"),this._inputControlContainerElement.className=t.makeCssClassName("ac-input-container"),this._inputControlContainerElement.style.display="flex",this._renderedInputControlElement=this.internalRender(),this._renderedInputControlElement.style.minWidth="0px",this.isNullable&&this.validation.necessity==s.InputValidationNecessity.RequiredWithVisualCue&&this._renderedInputControlElement.classList.add(t.makeCssClassName("ac-input-required")),this._inputControlContainerElement.appendChild(this._renderedInputControlElement),this._outerContainerElement.appendChild(this._inputControlContainerElement),this._outerContainerElement},e.prototype.valueChanged=function(){var t,e,i;this.resetValidationFailureCue(),this.onValueChanged&&this.onValueChanged(this),e=(t=this).getRootElement(),(i=e&&e.onInputValueChanged?e.onInputValueChanged:dt.onInputValueChanged)&&i(t)},e.prototype.resetValidationFailureCue=function(){dt.useBuiltInInputValidation&&this.renderedElement&&(this._renderedInputControlElement.classList.remove(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this._errorMessageElement&&(this._outerContainerElement.removeChild(this._errorMessageElement),this._errorMessageElement=null))},e.prototype.showValidationErrorMessage=function(){this.renderedElement&&dt.useBuiltInInputValidation&&dt.displayInputValidationErrors&&!l.isNullOrEmpty(this.validation.errorMessage)&&(this._errorMessageElement=document.createElement("span"),this._errorMessageElement.className=this.hostConfig.makeCssClassName("ac-input-validation-error-message"),this._errorMessageElement.textContent=this.validation.errorMessage,this._outerContainerElement.appendChild(this._errorMessageElement))},e.prototype.parseInputValue=function(t){return t},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"title",this.title),l.setProperty(e,"value",this.renderedElement&&!l.isNullOrEmpty(this.value)?this.value:this.defaultValue),l.setProperty(e,"validation",this.validation.toJSON()),e},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e),l.isNullOrEmpty(this.id)&&e.addFailure(this,{error:s.ValidationError.PropertyCantBeNull,message:"All inputs must have a unique Id"})},e.prototype.validateValue=function(){if(dt.useBuiltInInputValidation){this.resetValidationFailureCue();var t=this.validation.necessity==s.InputValidationNecessity.Optional||!l.isNullOrEmpty(this.value);return!t&&this.renderedElement&&(this._renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.showValidationErrorMessage()),t}return!0},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this.id=l.getStringValue(e.id),this.defaultValue=l.getStringValue(e.value);var n=e.validation;n&&this.validation.parse(n)},e.prototype.getAllInputs=function(){return[this]},Object.defineProperty(e.prototype,"defaultValue",{get:function(){return this._defaultValue},set:function(t){this._defaultValue=this.parseInputValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInteractive",{get:function(){return!0},enumerable:!0,configurable:!0}),e}(C);e.Input=z;var D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isMultiline=!1,e.style=s.InputTextStyle.Text,e}return r(e,t),e.prototype.internalRender=function(){var t=this;if(this.isMultiline){var e=document.createElement("textarea");return e.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput","ac-multiline"),e.style.flex="1 1 auto",e.tabIndex=0,l.isNullOrEmpty(this.placeholder)||(e.placeholder=this.placeholder,e.setAttribute("aria-label",this.placeholder)),l.isNullOrEmpty(this.defaultValue)||(e.value=this.defaultValue),this.maxLength>0&&(e.maxLength=this.maxLength),e.oninput=function(){t.valueChanged()},e.onkeypress=function(e){10==e.keyCode&&t.inlineAction&&t.inlineAction.execute()},e}var i=document.createElement("input");return i.type=s.InputTextStyle[this.style].toLowerCase(),i.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput"),i.style.flex="1 1 auto",i.tabIndex=0,l.isNullOrEmpty(this.placeholder)||(i.placeholder=this.placeholder,i.setAttribute("aria-label",this.placeholder)),l.isNullOrEmpty(this.defaultValue)||(i.value=this.defaultValue),this.maxLength>0&&(i.maxLength=this.maxLength),i.oninput=function(){t.valueChanged()},i.onkeypress=function(e){13==e.keyCode&&t.inlineAction&&t.inlineAction.execute()},i},e.prototype.overrideInternalRender=function(){var e=this,i=t.prototype.overrideInternalRender.call(this);if(this.inlineAction){var n=document.createElement("button");if(n.className=this.hostConfig.makeCssClassName("ac-inlineActionButton"),n.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,e.inlineAction.execute()},l.isNullOrEmpty(this.inlineAction.iconUrl))n.classList.add("textOnly"),n.textContent=l.isNullOrEmpty(this.inlineAction.title)?"Title":this.inlineAction.title;else{n.classList.add("iconOnly");var r=document.createElement("img");r.style.height="100%",r.style.display="none",r.onload=function(){r.style.removeProperty("display")},r.onerror=function(){n.removeChild(r),n.classList.remove("iconOnly"),n.classList.add("textOnly"),n.textContent=l.isNullOrEmpty(e.inlineAction.title)?"Title":e.inlineAction.title},r.src=this.inlineAction.iconUrl,n.appendChild(r),l.isNullOrEmpty(this.inlineAction.title)||(n.title=this.inlineAction.title)}n.style.marginLeft="8px",this.inputControlContainerElement.appendChild(n)}return i},e.prototype.getJsonTypeName=function(){return"Input.Text"},e.prototype.getActionById=function(e){var i=t.prototype.getActionById.call(this,e);return!i&&this.inlineAction&&(i=this.inlineAction.getActionById(e)),i},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"placeholder",this.placeholder),l.setProperty(e,"maxLength",this.maxLength,0),l.setProperty(e,"isMultiline",this.isMultiline,!1),l.setEnumProperty(s.InputTextStyle,e,"style",this.style,s.InputTextStyle.Text),this._inlineAction&&l.setProperty(e,"inlineAction",this._inlineAction.toJSON()),e},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this.maxLength=e.maxLength,this.isMultiline=l.getBoolValue(e.isMultiline,this.isMultiline),this.placeholder=l.getStringValue(e.placeholder),this.style=l.getEnumValue(s.InputTextStyle,e.style,this.style),this.inlineAction=f(this,e.inlineAction,[$.JsonTypeName],!this.isDesignMode(),i)},Object.defineProperty(e.prototype,"inlineAction",{get:function(){return this._inlineAction},set:function(t){this._inlineAction=t,this._inlineAction&&this._inlineAction.setParent(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.renderedInputControlElement?(this.isMultiline,this.renderedInputControlElement.value):null},enumerable:!0,configurable:!0}),e}(z);e.TextInput=D;var R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.valueOn="true",e.valueOff="false",e.wrap=!1,e}return r(e,t),e.prototype.internalRender=function(){var t=this,e=document.createElement("div");if(e.className=this.hostConfig.makeCssClassName("ac-input","ac-toggleInput"),e.style.width="100%",e.style.display="flex",e.style.alignItems="center",this._checkboxInputElement=document.createElement("input"),this._checkboxInputElement.id=l.generateUniqueId(),this._checkboxInputElement.type="checkbox",this._checkboxInputElement.style.display="inline-block",this._checkboxInputElement.style.verticalAlign="middle",this._checkboxInputElement.style.margin="0",this._checkboxInputElement.style.flex="0 0 auto",this._checkboxInputElement.setAttribute("aria-label",this.title),this._checkboxInputElement.tabIndex=0,this.defaultValue==this.valueOn&&(this._checkboxInputElement.checked=!0),this._checkboxInputElement.onchange=function(){t.valueChanged()},l.appendChild(e,this._checkboxInputElement),!l.isNullOrEmpty(this.title)||this.isDesignMode()){var i=new A;i.setParent(this),i.forElementId=this._checkboxInputElement.id,i.hostConfig=this.hostConfig,i.text=l.isNullOrEmpty(this.title)?this.getJsonTypeName():this.title,i.useMarkdown=dt.useMarkdownInRadioButtonAndCheckbox,i.wrap=this.wrap;var n=i.render();n.style.display="inline-block",n.style.flex="1 1 auto",n.style.marginLeft="6px",n.style.verticalAlign="middle";var r=document.createElement("div");r.style.width="6px",l.appendChild(e,r),l.appendChild(e,n)}return e},Object.defineProperty(e.prototype,"isNullable",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.getJsonTypeName=function(){return"Input.Toggle"},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"valueOn",this.valueOn,"true"),l.setProperty(e,"valueOff",this.valueOff,"false"),l.setProperty(e,"wrap",this.wrap),e},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this.title=l.getStringValue(e.title),this.valueOn=l.getStringValue(e.valueOn,this.valueOn),this.valueOff=l.getStringValue(e.valueOff,this.valueOff),this.wrap=l.getBoolValue(e.wrap,this.wrap)},Object.defineProperty(e.prototype,"value",{get:function(){return this._checkboxInputElement?this._checkboxInputElement.checked?this.valueOn:this.valueOff:null},enumerable:!0,configurable:!0}),e}(z);e.ToggleInput=R;var L=function(){function t(t,e){void 0===t&&(t=void 0),void 0===e&&(e=void 0),this.title=t,this.value=e}return t.prototype.parse=function(t){this.title=l.getStringValue(t.title),this.value=l.getStringValue(t.value)},t.prototype.toJSON=function(){return{title:this.title,value:this.value}},t}();e.Choice=L;var B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.choices=[],e.isCompact=!1,e.isMultiSelect=!1,e.wrap=!1,e}return r(e,t),e.getUniqueCategoryName=function(){var t="__ac-category"+e.uniqueCategoryCounter;return e.uniqueCategoryCounter++,t},e.prototype.internalRender=function(){var t=this;if(this.isMultiSelect){var i=this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):null;(u=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-input","ac-choiceSetInput-multiSelect"),u.style.width="100%",this._toggleInputs=[];for(var n=0;n<this.choices.length;n++){var r=document.createElement("input");r.id=l.generateUniqueId(),r.type="checkbox",r.style.margin="0",r.style.display="inline-block",r.style.verticalAlign="middle",r.value=this.choices[n].value,r.style.flex="0 0 auto",r.setAttribute("aria-label",this.choices[n].title),i&&i.indexOf(this.choices[n].value)>=0&&(r.checked=!0),r.onchange=function(){t.valueChanged()},this._toggleInputs.push(r),(h=new A).setParent(this),h.forElementId=r.id,h.hostConfig=this.hostConfig,h.text=l.isNullOrEmpty(this.choices[n].title)?"Choice "+n:this.choices[n].title,h.useMarkdown=dt.useMarkdownInRadioButtonAndCheckbox,h.wrap=this.wrap,(d=h.render()).style.display="inline-block",d.style.flex="1 1 auto",d.style.marginLeft="6px",d.style.verticalAlign="middle",(f=document.createElement("div")).style.width="6px",(y=document.createElement("div")).style.display="flex",y.style.alignItems="center",l.appendChild(y,r),l.appendChild(y,f),l.appendChild(y,d),l.appendChild(u,y)}return u}if(this.isCompact){this._selectElement=document.createElement("select"),this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-compact"),this._selectElement.style.width="100%";var o=document.createElement("option");o.selected=!0,o.disabled=!0,o.hidden=!0,o.value="",this.placeholder&&(o.text=this.placeholder),l.appendChild(this._selectElement,o);for(var s=0;s<this.choices.length;s++){var a=document.createElement("option");a.value=this.choices[s].value,a.text=this.choices[s].title,a.setAttribute("aria-label",this.choices[s].title),this.choices[s].value==this.defaultValue&&(a.selected=!0),l.appendChild(this._selectElement,a)}return this._selectElement.onchange=function(){t.valueChanged()},this._selectElement}var u,p=e.getUniqueCategoryName();(u=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-input","ac-choiceSetInput-expanded"),u.style.width="100%",this._toggleInputs=[];for(var c=0;c<this.choices.length;c++){var h,d,f,y,g=document.createElement("input");g.id=l.generateUniqueId(),g.type="radio",g.style.margin="0",g.style.display="inline-block",g.style.verticalAlign="middle",g.name=l.isNullOrEmpty(this.id)?p:this.id,g.value=this.choices[c].value,g.style.flex="0 0 auto",g.setAttribute("aria-label",this.choices[c].title),this.choices[c].value==this.defaultValue&&(g.checked=!0),g.onchange=function(){t.valueChanged()},this._toggleInputs.push(g),(h=new A).setParent(this),h.forElementId=g.id,h.hostConfig=this.hostConfig,h.text=l.isNullOrEmpty(this.choices[c].title)?"Choice "+c:this.choices[c].title,h.useMarkdown=dt.useMarkdownInRadioButtonAndCheckbox,h.wrap=this.wrap,(d=h.render()).style.display="inline-block",d.style.flex="1 1 auto",d.style.marginLeft="6px",d.style.verticalAlign="middle",(f=document.createElement("div")).style.width="6px",(y=document.createElement("div")).style.display="flex",y.style.alignItems="center",l.appendChild(y,g),l.appendChild(y,f),l.appendChild(y,d),l.appendChild(u,y)}return u},e.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);if(l.setProperty(e,"placeholder",this.placeholder),this.choices.length>0){for(var i=[],n=0,r=this.choices;n<r.length;n++){var o=r[n];i.push(o.toJSON())}l.setProperty(e,"choices",i)}return this.isCompact||l.setProperty(e,"style","expanded",!1),l.setProperty(e,"isMultiSelect",this.isMultiSelect,!1),l.setProperty(e,"wrap",this.wrap,!1),e},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e),0==this.choices.length&&e.addFailure(this,{error:s.ValidationError.CollectionCantBeEmpty,message:"An Input.ChoiceSet must have at least one choice defined."});for(var i=0,n=this.choices;i<n.length;i++){var r=n[i];r.title&&r.value||e.addFailure(this,{error:s.ValidationError.PropertyCantBeNull,message:"All choices in an Input.ChoiceSet must have their title and value properties set."})}},e.prototype.parse=function(e,i){if(t.prototype.parse.call(this,e,i),this.isCompact=!("expanded"===e.style),this.isMultiSelect=l.getBoolValue(e.isMultiSelect,this.isMultiSelect),this.placeholder=l.getStringValue(e.placeholder),this.choices=[],null!=e.choices)for(var n=e.choices,r=0;r<n.length;r++){var o=new L;o.parse(n[r]),this.choices.push(o)}this.wrap=l.getBoolValue(e.wrap,this.wrap)},Object.defineProperty(e.prototype,"value",{get:function(){if(this.isMultiSelect){if(!this._toggleInputs||0==this._toggleInputs.length)return null;var t="";for(e=0;e<this._toggleInputs.length;e++)this._toggleInputs[e].checked&&(""!=t&&(t+=this.hostConfig.choiceSetInputValueSeparator),t+=this._toggleInputs[e].value);return""==t?null:t}if(this.isCompact)return this._selectElement&&this._selectElement.selectedIndex>0?this._selectElement.value:null;if(!this._toggleInputs||0==this._toggleInputs.length)return null;for(var e=0;e<this._toggleInputs.length;e++)if(this._toggleInputs[e].checked)return this._toggleInputs[e].value;return null},enumerable:!0,configurable:!0}),e.uniqueCategoryCounter=0,e}(z);e.ChoiceSetInput=B;var M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.internalRender=function(){var t=this;return this._numberInputElement=document.createElement("input"),this._numberInputElement.setAttribute("type","number"),this._numberInputElement.setAttribute("min",this.min),this._numberInputElement.setAttribute("max",this.max),this._numberInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-numberInput"),this._numberInputElement.style.width="100%",this._numberInputElement.tabIndex=0,l.isNullOrEmpty(this.defaultValue)||(this._numberInputElement.value=this.defaultValue),l.isNullOrEmpty(this.placeholder)||(this._numberInputElement.placeholder=this.placeholder,this._numberInputElement.setAttribute("aria-label",this.placeholder)),this._numberInputElement.oninput=function(){t.valueChanged()},this._numberInputElement},e.prototype.getJsonTypeName=function(){return"Input.Number"},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"placeholder",this.placeholder),l.setProperty(e,"min",this.min),l.setProperty(e,"max",this.max),e},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this.placeholder=l.getStringValue(e.placeholder),this.min=l.getStringValue(e.min),this.max=l.getStringValue(e.max)},Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(t){this._min=this.parseInputValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(t){this._max=this.parseInputValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._numberInputElement?this._numberInputElement.value:null},enumerable:!0,configurable:!0}),e}(z);e.NumberInput=M;var F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.internalRender=function(){var t=this;return this._dateInputElement=document.createElement("input"),this._dateInputElement.setAttribute("type","date"),this._dateInputElement.setAttribute("min",this.min),this._dateInputElement.setAttribute("max",this.max),this._dateInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dateInput"),this._dateInputElement.style.width="100%",this._dateInputElement.oninput=function(){t.valueChanged()},l.isNullOrEmpty(this.defaultValue)||(this._dateInputElement.value=this.defaultValue),this._dateInputElement},e.prototype.getJsonTypeName=function(){return"Input.Date"},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"min",this.min),l.setProperty(e,"max",this.max),e},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this.min=l.getStringValue(e.min),this.max=l.getStringValue(e.max)},Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(t){this._min=this.parseInputValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(t){this._max=this.parseInputValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._dateInputElement?this._dateInputElement.value:null},enumerable:!0,configurable:!0}),e}(z);e.DateInput=F;var j,H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.internalRender=function(){var t=this;return this._timeInputElement=document.createElement("input"),this._timeInputElement.setAttribute("type","time"),this._timeInputElement.setAttribute("min",this.min),this._timeInputElement.setAttribute("max",this.max),this._timeInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-timeInput"),this._timeInputElement.style.width="100%",this._timeInputElement.oninput=function(){t.valueChanged()},l.isNullOrEmpty(this.defaultValue)||(this._timeInputElement.value=this.defaultValue),this._timeInputElement},e.prototype.parseInputValue=function(t){return/^[0-9]{2}:[0-9]{2}$/.test(t)?t:null},e.prototype.getJsonTypeName=function(){return"Input.Time"},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"min",this.min),l.setProperty(e,"max",this.max),e},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this.min=l.getStringValue(e.min),this.max=l.getStringValue(e.max)},Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(t){this._min=this.parseInputValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(t){this._max=this.parseInputValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._timeInputElement?this._timeInputElement.value:null},enumerable:!0,configurable:!0}),e}(z);e.TimeInput=H,function(t){t[t.Normal=0]="Normal",t[t.Expanded=1]="Expanded",t[t.Subdued=2]="Subdued"}(j||(j={}));var J=function(){function t(t,e){this._state=j.Normal,this.onClick=null,this.action=t,this._parentContainerStyle=e}return t.prototype.updateCssStyle=function(){var t,e,i=this.action.parent.hostConfig;switch(this.action.renderedElement.className=i.makeCssClassName("ac-pushButton"),l.isNullOrEmpty(this._parentContainerStyle)||this.action.renderedElement.classList.add("style-"+this._parentContainerStyle),this.action instanceof $&&this.action.renderedElement.classList.add(i.makeCssClassName("expandable")),this.action.renderedElement.classList.remove(i.makeCssClassName("expanded")),this.action.renderedElement.classList.remove(i.makeCssClassName("subdued")),this._state){case j.Expanded:this.action.renderedElement.classList.add(i.makeCssClassName("expanded"));break;case j.Subdued:this.action.renderedElement.classList.add(i.makeCssClassName("subdued"))}l.isNullOrEmpty(this.action.style)||(this.action.style===s.ActionStyle.Positive?(t=this.action.renderedElement.classList).add.apply(t,i.makeCssClassNames("primary","style-positive")):(e=this.action.renderedElement.classList).add.apply(e,i.makeCssClassNames("style-"+this.action.style.toLowerCase())))},t.prototype.render=function(t){var e=this;this.action.render(),this.action.renderedElement.style.flex=t===s.ActionAlignment.Stretch?"0 1 100%":"0 1 auto",this.action.renderedElement.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,e.click()},this.updateCssStyle()},t.prototype.click=function(){null!=this.onClick&&this.onClick(this)},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(t){this._state=t,this.updateCssStyle()},enumerable:!0,configurable:!0}),t}(),W=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._shouldFallback=!1,e._parent=null,e._actionCollection=null,e._renderedElement=null,e.requires=new u.HostCapabilities,e.style=s.ActionStyle.Default,e}return r(e,t),e.prototype.setCollection=function(t){this._actionCollection=t},e.prototype.addCssClasses=function(t){},e.prototype.internalGetReferencedInputs=function(t){return{}},e.prototype.internalPrepareForExecution=function(t){},e.prototype.internalValidateInputs=function(t){var e=[];if(dt.useBuiltInInputValidation&&!this.ignoreInputValidation)for(var i=0,n=Object.keys(t);i<n.length;i++){var r=t[n[i]];r.validateValue()||e.push(r)}return e},e.prototype.getHref=function(){return""},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"type",this.getJsonTypeName()),l.setProperty(e,"title",this.title),l.setProperty(e,"iconUrl",this.iconUrl),l.setProperty(e,"style",this.style,s.ActionStyle.Default),e},e.prototype.render=function(t){void 0===t&&(t="ac-pushButton");var e=this.parent.hostConfig,i=document.createElement("button");this.addCssClasses(i),i.setAttribute("aria-label",this.title),i.type="button",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center";var n=!l.isNullOrEmpty(this.title),r=document.createElement("div");if(r.style.overflow="hidden",r.style.textOverflow="ellipsis",e.actions.iconPlacement==s.ActionIconPlacement.AboveTitle||e.actions.allowTitleToWrap||(r.style.whiteSpace="nowrap"),n&&(r.innerText=this.title),l.isNullOrEmpty(this.iconUrl))i.classList.add("noIcon"),i.appendChild(r);else{var o=document.createElement("img");o.src=this.iconUrl,o.style.width=e.actions.iconSize+"px",o.style.height=e.actions.iconSize+"px",o.style.flex="0 0 auto",e.actions.iconPlacement==s.ActionIconPlacement.AboveTitle?(i.classList.add("iconAbove"),i.style.flexDirection="column",n&&(o.style.marginBottom="4px")):(i.classList.add("iconLeft"),n&&(o.style.marginRight="4px")),i.appendChild(o),i.appendChild(r)}this._renderedElement=i},e.prototype.setParent=function(t){this._parent=t},e.prototype.execute=function(){var t,e,i;this.onExecute&&this.onExecute(this),e=(t=this).parent.getRootElement(),(i=e&&e.onExecuteAction?e.onExecuteAction:dt.onExecuteAction)&&t.prepareForExecution()&&i(t)},e.prototype.prepareForExecution=function(){var t=this.getReferencedInputs();return!(this.internalValidateInputs(t).length>0)&&(this.internalPrepareForExecution(t),!0)},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),function(t,e,i){var n=t.parent?t.parent.getRootElement():null,r=n&&n.onParseAction?n.onParseAction:dt.onParseAction;null!=r&&r(t,e,i)}(this,e,i),this.requires.parse(e.requires,i),e.title||""===e.title||lt({error:s.ValidationError.PropertyCantBeNull,message:"Actions should always have a title."},i),this.title=l.getStringValue(e.title),this.iconUrl=l.getStringValue(e.iconUrl),this.style=l.getStringValue(e.style,this.style)},e.prototype.remove=function(){return!!this._actionCollection&&this._actionCollection.removeAction(this)},e.prototype.getAllInputs=function(){return[]},e.prototype.getResourceInformation=function(){return l.isNullOrEmpty(this.iconUrl)?[]:[{url:this.iconUrl,mimeType:"image"}]},e.prototype.getActionById=function(t){if(this.id==t)return this},e.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs(this.parent.getRootElement().getAllInputs())},e.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())},e.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.parent.hostConfig.hostCapabilities)},Object.defineProperty(e.prototype,"isPrimary",{get:function(){return this.style==s.ActionStyle.Positive},set:function(t){t?this.style=s.ActionStyle.Positive:this.style==s.ActionStyle.Positive&&(this.style=s.ActionStyle.Default)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignoreInputValidation",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!0,configurable:!0}),e}(b);e.Action=W;var U=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isPrepared=!1,e._ignoreInputValidation=!1,e}return r(e,t),e.prototype.internalGetReferencedInputs=function(t){for(var e={},i=0,n=t;i<n.length;i++){var r=n[i];e[r.id]=r}return e},e.prototype.internalPrepareForExecution=function(t){this._originalData?this._processedData=JSON.parse(JSON.stringify(this._originalData)):this._processedData={};for(var e=0,i=Object.keys(t);e<i.length;e++){var n=t[i[e]];null!=n.value&&(this._processedData[n.id]=n.value)}this._isPrepared=!0},e.prototype.getJsonTypeName=function(){return e.JsonTypeName},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"ignoreInputValidation",this.ignoreInputValidation,!1),l.setProperty(e,"data",this._originalData),e},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this._ignoreInputValidation=l.getBoolValue(e.ignoreInputValidation,this._ignoreInputValidation),this.data=e.data},Object.defineProperty(e.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(t){this._ignoreInputValidation=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(t){this._originalData=t,this._isPrepared=!1},enumerable:!0,configurable:!0}),e.JsonTypeName="Action.Submit",e}(W);e.SubmitAction=U;var q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.getJsonTypeName=function(){return e.JsonTypeName},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"url",this.url),e},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e),l.isNullOrEmpty(this.url)&&e.addFailure(this,{error:s.ValidationError.PropertyCantBeNull,message:"An Action.OpenUrl must have its url property set."})},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this.url=l.getStringValue(e.url)},e.prototype.getHref=function(){return this.url},e.JsonTypeName="Action.OpenUrl",e}(W);e.OpenUrlAction=q;var G=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.targetElements={},e}return r(e,t),e.prototype.getJsonTypeName=function(){return e.JsonTypeName},e.prototype.execute=function(){for(var t=0,e=Object.keys(this.targetElements);t<e.length;t++){var i=e[t],n=this.parent.getRootElement().getElementById(i);n&&("boolean"==typeof this.targetElements[i]?n.isVisible=this.targetElements[i]:n.isVisible=!n.isVisible)}},e.prototype.parse=function(e){t.prototype.parse.call(this,e),this.targetElements={};var i=e.targetElements;if(i&&Array.isArray(i))for(var n=0,r=i;n<r.length;n++){var o=r[n];if("string"==typeof o)this.targetElements[o]=void 0;else if("object"==typeof o){var s=o.elementId;s&&"string"==typeof s&&(this.targetElements[s]=l.getBoolValue(o.isVisible,void 0))}}},e.prototype.toJSON=function(){for(var e=t.prototype.toJSON.call(this),i=[],n=0,r=Object.keys(this.targetElements);n<r.length;n++){var o=r[n];"boolean"==typeof this.targetElements[o]?i.push({elementId:o,isVisible:this.targetElements[o]}):i.push(o)}return e.targetElements=i,e},e.prototype.addTargetElement=function(t,e){void 0===e&&(e=void 0),this.targetElements[t]=e},e.prototype.removeTargetElement=function(t){delete this.targetElements[t]},e.JsonTypeName="Action.ToggleVisibility",e}(W);e.ToggleVisibilityAction=G;var K=function(){function t(t,e){void 0===t&&(t=""),void 0===e&&(e=""),this._value=new a.StringWithSubstitutions,this.name=t,this.value=e}return t.prototype.parse=function(t){this.name=l.getStringValue(t.name),this.value=l.getStringValue(t.value)},t.prototype.toJSON=function(){return{name:this.name,value:this._value.getOriginal()}},t.prototype.getReferencedInputs=function(t,e){this._value.getReferencedInputs(t,e)},t.prototype.prepareForExecution=function(t){this._value.substituteInputValues(t,a.ContentTypes.applicationXWwwFormUrlencoded)},Object.defineProperty(t.prototype,"value",{get:function(){return this._value.get()},set:function(t){this._value.set(t)},enumerable:!0,configurable:!0}),t}();e.HttpHeader=K;var X=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._url=new a.StringWithSubstitutions,e._body=new a.StringWithSubstitutions,e._headers=[],e._ignoreInputValidation=!1,e}return r(e,t),e.prototype.internalGetReferencedInputs=function(t){var e={};this._url.getReferencedInputs(t,e);for(var i=0,n=this._headers;i<n.length;i++){n[i].getReferencedInputs(t,e)}return this._body.getReferencedInputs(t,e),e},e.prototype.internalPrepareForExecution=function(t){this._url.substituteInputValues(t,a.ContentTypes.applicationXWwwFormUrlencoded);for(var e=a.ContentTypes.applicationJson,i=0,n=this._headers;i<n.length;i++){var r=n[i];r.prepareForExecution(t),r.name&&"content-type"==r.name.toLowerCase()&&(e=r.value)}this._body.substituteInputValues(t,e)},e.prototype.getJsonTypeName=function(){return e.JsonTypeName},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);if(l.setProperty(e,"method",this.method),l.setProperty(e,"url",this._url.getOriginal()),l.setProperty(e,"body",this._body.getOriginal()),l.setProperty(e,"ignoreInputValidation",this.ignoreInputValidation,!1),this._headers.length>0){for(var i=[],n=0,r=this._headers;n<r.length;n++){var o=r[n];i.push(o.toJSON())}l.setProperty(e,"headers",i)}return e},e.prototype.internalValidateProperties=function(e){if(t.prototype.internalValidateProperties.call(this,e),l.isNullOrEmpty(this.url)&&e.addFailure(this,{error:s.ValidationError.PropertyCantBeNull,message:"An Action.Http must have its url property set."}),this.headers.length>0)for(var i=0,n=this.headers;i<n.length;i++){n[i].name||e.addFailure(this,{error:s.ValidationError.PropertyCantBeNull,message:"All headers of an Action.Http must have their name and value properties set."})}},e.prototype.parse=function(e,i){if(t.prototype.parse.call(this,e,i),this.url=l.getStringValue(e.url),this.method=l.getStringValue(e.method),this.body=l.getStringValue(e.body),this._ignoreInputValidation=l.getBoolValue(e.ignoreInputValidation,this._ignoreInputValidation),this._headers=[],null!=e.headers)for(var n=e.headers,r=0;r<n.length;r++){var o=new K;o.parse(n[r]),this.headers.push(o)}},Object.defineProperty(e.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(t){this._ignoreInputValidation=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._url.get()},set:function(t){this._url.set(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return this._body.get()},set:function(t){this._body.set(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headers",{get:function(){return this._headers?this._headers:[]},set:function(t){this._headers=t},enumerable:!0,configurable:!0}),e.JsonTypeName="Action.Http",e}(W);e.HttpAction=X;var $=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.card=new ft,e}return r(e,t),e.prototype.addCssClasses=function(e){t.prototype.addCssClasses.call(this,e),e.classList.add(this.parent.hostConfig.makeCssClassName("expandable"))},e.prototype.getJsonTypeName=function(){return e.JsonTypeName},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return this.card&&l.setProperty(e,"card",this.card.toJSON()),e},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e),this.card.internalValidateProperties(e)},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);var n=e.card;n?this.card.parse(n,i):lt({error:s.ValidationError.PropertyCantBeNull,message:'An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},i)},e.prototype.setParent=function(e){t.prototype.setParent.call(this,e),this.card.setParent(e)},e.prototype.getAllInputs=function(){return this.card.getAllInputs()},e.prototype.getResourceInformation=function(){return t.prototype.getResourceInformation.call(this).concat(this.card.getResourceInformation())},e.prototype.getActionById=function(e){var i=t.prototype.getActionById.call(this,e);return i||(i=this.card.getActionById(e)),i},e.JsonTypeName="Action.ShowCard",e}(W);e.ShowCardAction=$;var Y=function(){function t(t){this._expandedAction=null,this._renderedActionCount=0,this._actionCard=null,this.items=[],this.buttons=[],this._owner=t}return t.prototype.refreshContainer=function(){if(this._actionCardContainer.innerHTML="",null!==this._actionCard){this._actionCardContainer.style.marginTop=this._renderedActionCount>0?this._owner.hostConfig.actions.showCard.inlineTopMargin+"px":"0px";var t=this._owner.getEffectivePadding();this._owner.getImmediateSurroundingPadding(t);var e=this._owner.hostConfig.paddingDefinitionToSpacingDefinition(t);null!==this._actionCard&&(this._actionCard.style.paddingLeft=e.left+"px",this._actionCard.style.paddingRight=e.right+"px",this._actionCard.style.marginLeft="-"+e.left+"px",this._actionCard.style.marginRight="-"+e.right+"px",0==e.bottom||this._owner.isDesignMode()||(this._actionCard.style.paddingBottom=e.bottom+"px",this._actionCard.style.marginBottom="-"+e.bottom+"px"),l.appendChild(this._actionCardContainer,this._actionCard))}else this._actionCardContainer.style.marginTop="0px"},t.prototype.layoutChanged=function(){this._owner.getRootElement().updateLayout()},t.prototype.hideActionCard=function(){var t=this._expandedAction;this._expandedAction=null,this._actionCard=null,this.refreshContainer(),t&&(this.layoutChanged(),st(t,!1))},t.prototype.showActionCard=function(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=!0),null!=t.card){t.card.suppressStyle=e;var n=t.card.render();this._actionCard=n,this._expandedAction=t,this.refreshContainer(),i&&(this.layoutChanged(),st(t,!0))}},t.prototype.collapseExpandedAction=function(){for(var t=0;t<this.buttons.length;t++)this.buttons[t].state=j.Normal;this.hideActionCard()},t.prototype.expandShowCardAction=function(t,e){for(var i=0;i<this.buttons.length;i++)this.buttons[i].action!==t?this.buttons[i].state=j.Subdued:this.buttons[i].state=j.Expanded;this.showActionCard(t,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),e)},t.prototype.actionClicked=function(t){if(t.action instanceof $)this._owner.hostConfig.actions.showCard.actionMode===s.ShowCardActionMode.Popup?t.action.execute():t.action===this._expandedAction?this.collapseExpandedAction():this.expandShowCardAction(t.action,!0);else{for(var e=0;e<this.buttons.length;e++)this.buttons[e].state=j.Normal;this.hideActionCard(),t.action.execute()}},t.prototype.getParentContainer=function(){return this._owner instanceof et?this._owner:this._owner.getParentContainer()},t.prototype.findActionButton=function(t){for(var e=0,i=this.buttons;e<i.length;e++){var n=i[e];if(n.action==t)return n}return null},t.prototype.parse=function(t,e){if(this.clear(),t&&t instanceof Array)for(var i=0,n=t;i<n.length;i++){var r=n[i],o=f(this._owner,r,[],!this._owner.isDesignMode(),e);o&&this.addAction(o)}},t.prototype.toJSON=function(){if(this.items.length>0){for(var t=[],e=0,i=this.items;e<i.length;e++){var n=i[e];t.push(n.toJSON())}return t}return null},t.prototype.getActionById=function(t){for(var e=null,i=0;i<this.items.length&&!(e=this.items[i].getActionById(t));i++);return e},t.prototype.validateProperties=function(t){this._owner.hostConfig.actions.maxActions&&this.items.length>this._owner.hostConfig.actions.maxActions&&t.addFailure(this._owner,{error:s.ValidationError.TooManyActions,message:"A maximum of "+this._owner.hostConfig.actions.maxActions+" actions are allowed."}),this.items.length>0&&!this._owner.hostConfig.supportsInteractivity&&t.addFailure(this._owner,{error:s.ValidationError.InteractivityNotAllowed,message:"Interactivity is not allowed."});for(var e=0,i=this.items;e<i.length;e++){var n=i[e];h(n,this._owner.getForbiddenActionTypes())||t.addFailure(this._owner,{error:s.ValidationError.ActionTypeNotAllowed,message:"Actions of type "+n.getJsonTypeName()+" are not allowe."}),n.internalValidateProperties(t)}},t.prototype.render=function(t,e){var i=this;if(!this._owner.hostConfig.supportsInteractivity)return null;var n=document.createElement("div"),r=this._owner.hostConfig.actions.maxActions?Math.min(this._owner.hostConfig.actions.maxActions,this.items.length):this.items.length,o=this._owner.getForbiddenActionTypes();if(this._actionCardContainer=document.createElement("div"),this._renderedActionCount=0,this._owner.hostConfig.actions.preExpandSingleShowCardAction&&1==r&&this.items[0]instanceof $&&h(this.items[0],o))this.showActionCard(this.items[0],!0),this._renderedActionCount=1;else{var a=document.createElement("div");if(a.className=this._owner.hostConfig.makeCssClassName("ac-actionSet"),a.style.display="flex",t==s.Orientation.Horizontal)if(a.style.flexDirection="row",this._owner.horizontalAlignment&&this._owner.hostConfig.actions.actionAlignment!=s.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case s.HorizontalAlignment.Center:a.style.justifyContent="center";break;case s.HorizontalAlignment.Right:a.style.justifyContent="flex-end";break;default:a.style.justifyContent="flex-start"}else switch(this._owner.hostConfig.actions.actionAlignment){case s.ActionAlignment.Center:a.style.justifyContent="center";break;case s.ActionAlignment.Right:a.style.justifyContent="flex-end";break;default:a.style.justifyContent="flex-start"}else if(a.style.flexDirection="column",this._owner.horizontalAlignment&&this._owner.hostConfig.actions.actionAlignment!=s.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case s.HorizontalAlignment.Center:a.style.alignItems="center";break;case s.HorizontalAlignment.Right:a.style.alignItems="flex-end";break;default:a.style.alignItems="flex-start"}else switch(this._owner.hostConfig.actions.actionAlignment){case s.ActionAlignment.Center:a.style.alignItems="center";break;case s.ActionAlignment.Right:a.style.alignItems="flex-end";break;case s.ActionAlignment.Stretch:a.style.alignItems="stretch";break;default:a.style.alignItems="flex-start"}for(var u=this.getParentContainer().getEffectiveStyle(),p=0;p<this.items.length;p++)if(h(this.items[p],o)){var c=this.findActionButton(this.items[p]);if(c||((c=new J(this.items[p],u)).onClick=function(t){i.actionClicked(t)},this.buttons.push(c)),c.render(this._owner.hostConfig.actions.actionAlignment),a.appendChild(c.action.renderedElement),this._renderedActionCount++,this._renderedActionCount>=this._owner.hostConfig.actions.maxActions||p==this.items.length-1)break;if(this._owner.hostConfig.actions.buttonSpacing>0){var d=document.createElement("div");t===s.Orientation.Horizontal?(d.style.flex="0 0 auto",d.style.width=this._owner.hostConfig.actions.buttonSpacing+"px"):d.style.height=this._owner.hostConfig.actions.buttonSpacing+"px",l.appendChild(a,d)}}var f=document.createElement("div");f.style.overflow="hidden",f.appendChild(a),l.appendChild(n,f)}l.appendChild(n,this._actionCardContainer);for(p=0;p<this.buttons.length;p++)if(this.buttons[p].state==j.Expanded){this.expandShowCardAction(this.buttons[p].action,!1);break}return this._renderedActionCount>0?n:null},t.prototype.addAction=function(t){if(!t)throw new Error("The action parameter cannot be null.");if(t.parent&&t.parent!==this._owner||!(this.items.indexOf(t)<0))throw new Error("The action already belongs to another element.");this.items.push(t),t.parent||t.setParent(this._owner),c(t,this)},t.prototype.removeAction=function(t){this.expandedAction&&this._expandedAction==t&&this.collapseExpandedAction();var e=this.items.indexOf(t);if(e>=0){this.items.splice(e,1),t.setParent(null),c(t,null);for(var i=0;i<this.buttons.length;i++)if(this.buttons[i].action==t){this.buttons.splice(i,1);break}return!0}return!1},t.prototype.clear=function(){this.items=[],this.buttons=[],this._expandedAction=null,this._renderedActionCount=0},t.prototype.getAllInputs=function(){for(var t=[],e=0;e<this.items.length;e++){var i=this.items[e];t=t.concat(i.getAllInputs())}return t},t.prototype.getResourceInformation=function(){for(var t=[],e=0;e<this.items.length;e++)t=t.concat(this.items[e].getResourceInformation());return t},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return this._renderedActionCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:!0,configurable:!0}),t}(),Z=function(t){function e(){var e=t.call(this)||this;return e.orientation=null,e._actionCollection=new Y(e),e}return r(e,t),e.prototype.internalRender=function(){return this._actionCollection.render(this.orientation?this.orientation:this.hostConfig.actions.actionsOrientation,this.isDesignMode())},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setEnumProperty(s.Orientation,e,"orientation",this.orientation),l.setProperty(e,"actions",this._actionCollection.toJSON()),e},e.prototype.isBleedingAtBottom=function(){return 0==this._actionCollection.renderedActionCount?t.prototype.isBleedingAtBottom.call(this):1==this._actionCollection.items.length?null!=this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:null!=this._actionCollection.expandedAction},e.prototype.getJsonTypeName=function(){return"ActionSet"},e.prototype.getActionCount=function(){return this._actionCollection.items.length},e.prototype.getActionAt=function(e){if(e>=0&&e<this.getActionCount())return this._actionCollection.items[e];t.prototype.getActionAt.call(this,e)},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e),this._actionCollection.validateProperties(e)},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);var n=e.orientation;n&&(this.orientation=l.getEnumValue(s.Orientation,n,s.Orientation.Horizontal)),this._actionCollection.parse(e.actions,i)},e.prototype.addAction=function(t){this._actionCollection.addAction(t)},e.prototype.getAllInputs=function(){return this._actionCollection.getAllInputs()},e.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()},Object.defineProperty(e.prototype,"isInteractive",{get:function(){return!0},enumerable:!0,configurable:!0}),e}(C);e.ActionSet=Z;var Q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._style=null,e._bleed=!1,e}return r(e,t),e.prototype.applyBackground=function(){var t=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));l.isNullOrEmpty(t.backgroundColor)||(this.renderedElement.style.backgroundColor=l.stringToCssColor(t.backgroundColor))},e.prototype.applyPadding=function(){if(t.prototype.applyPadding.call(this),this.renderedElement){var e=new a.SpacingDefinition;if(this.getEffectivePadding()&&(e=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=e.top+"px",this.renderedElement.style.paddingRight=e.right+"px",this.renderedElement.style.paddingBottom=e.bottom+"px",this.renderedElement.style.paddingLeft=e.left+"px",this.isBleeding()){var i=new a.PaddingDefinition;this.getImmediateSurroundingPadding(i);var n=this.hostConfig.paddingDefinitionToSpacingDefinition(i);this.renderedElement.style.marginRight="-"+n.right+"px",this.renderedElement.style.marginLeft="-"+n.left+"px",this.isDesignMode()||(this.renderedElement.style.marginTop="-"+n.top+"px",this.renderedElement.style.marginBottom="-"+n.bottom+"px"),this.separatorElement&&this.separatorOrientation==s.Orientation.Horizontal&&(this.separatorElement.style.marginLeft="-"+n.left+"px",this.separatorElement.style.marginRight="-"+n.right+"px")}else this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0",this.renderedElement.style.marginTop="0",this.renderedElement.style.marginBottom="0",this.separatorElement&&(this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0")}},e.prototype.getHasBackground=function(){for(var t=this.parent;t;){var i=t instanceof et&&t.backgroundImage.isValid();if(t instanceof e&&this.hasExplicitStyle&&(t.getEffectiveStyle()!=this.getEffectiveStyle()||i))return!0;t=t.parent}return!1},e.prototype.getDefaultPadding=function(){return this.getHasBackground()?new a.PaddingDefinition(s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding):t.prototype.getDefaultPadding.call(this)},e.prototype.getHasExpandedAction=function(){return!1},e.prototype.getBleed=function(){return this._bleed},e.prototype.setBleed=function(t){this._bleed=t},Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasExplicitStyle",{get:function(){return null!=this._style},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowCustomStyle",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsMinHeight",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isBleeding=function(){return this.getHasBackground()&&this.getBleed()},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"style",this.style),e},e.prototype.internalValidateProperties=function(e){(t.prototype.internalValidateProperties.call(this,e),this._style)&&(this.hostConfig.containerStyles.getStyleByName(this._style)||e.addFailure(this,{error:s.ValidationError.InvalidPropertyValue,message:"Unknown container style: "+this._style}))},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this._style=l.getStringValue(e.style)},e.prototype.render=function(){var e=t.prototype.render.call(this);return e&&this.getHasBackground()&&this.applyBackground(),e},e.prototype.getEffectiveStyle=function(){var e=this.style;return e||t.prototype.getEffectiveStyle.call(this)},Object.defineProperty(e.prototype,"style",{get:function(){return this.allowCustomStyle&&this._style&&this.hostConfig.containerStyles.getStyleByName(this._style)?this._style:null},set:function(t){this._style=t},enumerable:!0,configurable:!0}),e}(T);e.StylableCardElementContainer=Q;var tt=function(){function t(){this.fillMode=t.defaultFillMode,this.horizontalAlignment=t.defaultHorizontalAlignment,this.verticalAlignment=t.defaultVerticalAlignment}return t.prototype.reset=function(){this.url=void 0,this.fillMode=t.defaultFillMode,this.horizontalAlignment=t.defaultHorizontalAlignment,this.verticalAlignment=t.defaultVerticalAlignment},t.prototype.parse=function(t,e){this.url=l.getStringValue(t.url),this.fillMode=l.getEnumValue(s.FillMode,t.fillMode,this.fillMode),this.horizontalAlignment=l.getEnumValue(s.HorizontalAlignment,t.horizontalAlignment,this.horizontalAlignment),this.verticalAlignment=l.getEnumValue(s.VerticalAlignment,t.verticalAlignment,this.verticalAlignment)},t.prototype.toJSON=function(){if(!this.isValid())return null;if(this.fillMode==t.defaultFillMode&&this.horizontalAlignment==t.defaultHorizontalAlignment&&this.verticalAlignment==t.defaultVerticalAlignment)return this.url;var e={};return l.setProperty(e,"url",this.url),l.setEnumProperty(s.FillMode,e,"fillMode",this.fillMode,t.defaultFillMode),l.setEnumProperty(s.HorizontalAlignment,e,"horizontalAlignment",this.horizontalAlignment,t.defaultHorizontalAlignment),l.setEnumProperty(s.VerticalAlignment,e,"verticalAlignment",this.verticalAlignment,t.defaultVerticalAlignment),e},t.prototype.apply=function(t){if(this.url){switch(t.style.backgroundImage="url('"+this.url+"')",this.fillMode){case s.FillMode.Repeat:t.style.backgroundRepeat="repeat";break;case s.FillMode.RepeatHorizontally:t.style.backgroundRepeat="repeat-x";break;case s.FillMode.RepeatVertically:t.style.backgroundRepeat="repeat-y";break;case s.FillMode.Cover:default:t.style.backgroundRepeat="no-repeat",t.style.backgroundSize="cover"}switch(this.horizontalAlignment){case s.HorizontalAlignment.Center:t.style.backgroundPositionX="center";break;case s.HorizontalAlignment.Right:t.style.backgroundPositionX="right"}switch(this.verticalAlignment){case s.VerticalAlignment.Center:t.style.backgroundPositionY="center";break;case s.VerticalAlignment.Bottom:t.style.backgroundPositionY="bottom"}}},t.prototype.isValid=function(){return!l.isNullOrEmpty(this.url)},t.defaultFillMode=s.FillMode.Cover,t.defaultHorizontalAlignment=s.HorizontalAlignment.Left,t.defaultVerticalAlignment=s.VerticalAlignment.Top,t}();e.BackgroundImage=tt;var et=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._items=[],e._renderedItems=[],e.backgroundImage=new tt,e.verticalContentAlignment=s.VerticalAlignment.Top,e.rtl=null,e}return r(e,t),e.prototype.insertItemAt=function(t,e,i){if(t.parent&&!i)throw new Error("The element already belongs to another container.");if(!t.isStandalone)throw new Error("Elements of type "+t.getJsonTypeName()+" cannot be used as standalone elements.");e<0||e>=this._items.length?this._items.push(t):this._items.splice(e,0,t),t.setParent(this)},e.prototype.supportsExcplitiHeight=function(){return!0},e.prototype.getItemsCollectionPropertyName=function(){return"items"},e.prototype.applyBackground=function(){this.backgroundImage.isValid()&&this.backgroundImage.apply(this.renderedElement),t.prototype.applyBackground.call(this)},e.prototype.internalRender=function(){this._renderedItems=[];var t=this.hostConfig,e=document.createElement("div");switch(null!=this.rtl&&this.rtl&&(e.dir="rtl"),e.classList.add(t.makeCssClassName("ac-container")),e.style.display="flex",e.style.flexDirection="column",dt.useAdvancedCardBottomTruncation&&(e.style.minHeight="-webkit-min-content"),this.verticalContentAlignment){case s.VerticalAlignment.Center:e.style.justifyContent="center";break;case s.VerticalAlignment.Bottom:e.style.justifyContent="flex-end";break;default:e.style.justifyContent="flex-start"}if(this._items.length>0)for(var i=0;i<this._items.length;i++){var n=this.isElementAllowed(this._items[i],this.getForbiddenElementTypes())?this._items[i].render():null;n&&(this._renderedItems.length>0&&this._items[i].separatorElement&&(this._items[i].separatorElement.style.flex="0 0 auto",l.appendChild(e,this._items[i].separatorElement)),l.appendChild(e,n),this._renderedItems.push(this._items[i]))}else if(this.isDesignMode()){var r=this.createPlaceholderElement();r.style.width="100%",r.style.height="100%",e.appendChild(r)}return e},e.prototype.truncateOverflow=function(t){for(var e=this.renderedElement.offsetTop+t+1,i=function(t){var n=t.renderedElement;if(n)switch(l.getFitStatus(n,e)){case s.ContainerFitStatus.FullyInContainer:t.resetOverflow()&&i(t);break;case s.ContainerFitStatus.Overflowing:var r=e-n.offsetTop;t.handleOverflow(r);break;case s.ContainerFitStatus.FullyOutOfContainer:t.handleOverflow(0)}},n=0,r=this._items;n<r.length;n++){var o=r[n];i(o)}return!0},e.prototype.undoOverflowTruncation=function(){for(var t=0,e=this._items;t<e.length;t++){e[t].resetOverflow()}},e.prototype.getHasBackground=function(){return this.backgroundImage.isValid()||t.prototype.getHasBackground.call(this)},Object.defineProperty(e.prototype,"isSelectable",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);if(l.setProperty(e,"backgroundImage",this.backgroundImage.toJSON()),l.setEnumProperty(s.VerticalAlignment,e,"verticalContentAlignment",this.verticalContentAlignment,s.VerticalAlignment.Top),this._items.length>0){for(var i=[],n=0,r=this._items;n<r.length;n++){var o=r[n];i.push(o.toJSON())}l.setProperty(e,this.getItemsCollectionPropertyName(),i)}return l.setProperty(e,"bleed",this.bleed,!1),e},e.prototype.getItemCount=function(){return this._items.length},e.prototype.getItemAt=function(t){return this._items[t]},e.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var t=0,e=this._renderedItems;t<e.length;t++){var i=e[t];if(i.isVisible)return i}return null},e.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var t=this._renderedItems.length-1;t>=0;t--)if(this._renderedItems[t].isVisible)return this._renderedItems[t];return null},e.prototype.getJsonTypeName=function(){return"Container"},e.prototype.isFirstElement=function(t){for(var e=this.isDesignMode(),i=0;i<this._items.length;i++)if(this._items[i].isVisible||e)return this._items[i]==t;return!1},e.prototype.isLastElement=function(t){for(var e=this.isDesignMode(),i=this._items.length-1;i>=0;i--)if(this._items[i].isVisible||e)return this._items[i]==t;return!1},e.prototype.isRtl=function(){if(null!=this.rtl)return this.rtl;var t=this.getParentContainer();return!!t&&t.isRtl()},e.prototype.isBleedingAtTop=function(){var t=this.getFirstVisibleRenderedItem();return this.isBleeding()||!!t&&t.isBleedingAtTop()},e.prototype.isBleedingAtBottom=function(){var t=this.getLastVisibleRenderedItem();return this.isBleeding()||!!t&&(t.isBleedingAtBottom()&&t.getEffectiveStyle()==this.getEffectiveStyle())},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this.setShouldFallback(!1),this._items=[],this._renderedItems=[],this.backgroundImage.reset();var n=e.backgroundImage;if(n&&("string"==typeof n?(this.backgroundImage.url=n,this.backgroundImage.fillMode=s.FillMode.Cover):"object"==typeof n&&this.backgroundImage.parse(n,i)),this.verticalContentAlignment=l.getEnumValue(s.VerticalAlignment,e.verticalContentAlignment,this.verticalContentAlignment),null!=e[this.getItemsCollectionPropertyName()]){var r=e[this.getItemsCollectionPropertyName()];this.clear();for(var o=0;o<r.length;o++){var a=y(this,r[o],!this.isDesignMode(),i);a&&this.insertItemAt(a,-1,!0)}}this.bleed=l.getBoolValue(e.bleed,this.bleed)},e.prototype.indexOf=function(t){return this._items.indexOf(t)},e.prototype.addItem=function(t){this.insertItemAt(t,-1,!1)},e.prototype.insertItemBefore=function(t,e){this.insertItemAt(t,this._items.indexOf(e),!1)},e.prototype.insertItemAfter=function(t,e){this.insertItemAt(t,this._items.indexOf(e)+1,!1)},e.prototype.removeItem=function(t){var e=this._items.indexOf(t);return e>=0&&(this._items.splice(e,1),t.setParent(null),this.updateLayout(),!0)},e.prototype.clear=function(){this._items=[]},e.prototype.getResourceInformation=function(){var e=t.prototype.getResourceInformation.call(this);return this.backgroundImage.isValid()&&e.push({url:this.backgroundImage.url,mimeType:"image"}),e},e.prototype.getActionById=function(e){var i=t.prototype.getActionById.call(this,e);if(!i&&(this.selectAction&&(i=this.selectAction.getActionById(e)),!i))for(var n=0;n<this._items.length&&!(i=this._items[n].getActionById(e));n++);return i},Object.defineProperty(e.prototype,"padding",{get:function(){return this.getPadding()},set:function(t){this.setPadding(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectAction",{get:function(){return this.getSelectAction()},set:function(t){this.setSelectAction(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bleed",{get:function(){return this.getBleed()},set:function(t){this.setBleed(t)},enumerable:!0,configurable:!0}),e}(Q);e.Container=et;var it=function(t){function e(e){void 0===e&&(e="auto");var i=t.call(this)||this;return i._computedWeight=0,i.width="auto",i.width=e,i}return r(e,t),e.prototype.adjustRenderedElementSize=function(t){if(this.isDesignMode()?(t.style.minWidth="20px",t.style.minHeight=(this.minPixelHeight?Math.max(this.minPixelHeight,20):20)+"px"):(t.style.minWidth="0",this.minPixelHeight&&(t.style.minHeight=this.minPixelHeight+"px")),"auto"===this.width)t.style.flex="0 1 auto";else if("stretch"===this.width)t.style.flex="1 1 50px";else{var e=this.width;e.unit==s.SizeUnit.Pixel?(t.style.flex="0 0 auto",t.style.width=e.physicalSize+"px"):t.style.flex="1 1 "+(this._computedWeight>0?this._computedWeight:e.physicalSize)+"%"}},Object.defineProperty(e.prototype,"separatorOrientation",{get:function(){return s.Orientation.Vertical},enumerable:!0,configurable:!0}),e.prototype.getJsonTypeName=function(){return"Column"},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return this.width instanceof a.SizeAndUnit?this.width.unit==s.SizeUnit.Pixel?l.setProperty(e,"width",this.width.physicalSize+"px"):l.setProperty(e,"width",this.width.physicalSize):l.setProperty(e,"width",this.width),e},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i);var n=e.width;void 0===n&&void 0!==(n=e.size)&&lt({error:s.ValidationError.Deprecated,message:'The "Column.size" property is deprecated and will be removed. Use the "Column.width" property instead.'},i);var r=!1;try{this.width=a.SizeAndUnit.parse(n)}catch(t){"string"!=typeof n||"auto"!==n&&"stretch"!==n?r=!0:this.width=n}r&&lt({error:s.ValidationError.InvalidPropertyValue,message:"Invalid column width:"+n+' - defaulting to "auto"'},i)},Object.defineProperty(e.prototype,"hasVisibleSeparator",{get:function(){return!!(this.parent&&this.parent instanceof nt)&&(this.separatorElement&&!this.parent.isLeftMostElement(this))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isStandalone",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(et);e.Column=it;var nt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._columns=[],e}return r(e,t),e.prototype.createColumnInstance=function(t,e){return d(this,t,[],!this.isDesignMode(),(function(t){return t&&"Column"!==t?null:new it}),(function(t,e){return e==o.UnknownType?{error:s.ValidationError.UnknownElementType,message:"Unknown element type: "+t+". Fallback will be used if present."}:{error:s.ValidationError.ElementTypeNotAllowed,message:"Element type "+t+" isn't allowed in a ColumnSet."}}),e)},e.prototype.internalRender=function(){if(this._renderedColumns=[],this._columns.length>0){var t=this.hostConfig,e=document.createElement("div");switch(e.className=t.makeCssClassName("ac-columnSet"),e.style.display="flex",e.style.overflowX="hidden",dt.useAdvancedCardBottomTruncation&&(e.style.minHeight="-webkit-min-content"),this.horizontalAlignment){case s.HorizontalAlignment.Center:e.style.justifyContent="center";break;case s.HorizontalAlignment.Right:e.style.justifyContent="flex-end";break;default:e.style.justifyContent="flex-start"}for(var i=0,n=0,r=this._columns;n<r.length;n++){(p=r[n]).width instanceof a.SizeAndUnit&&p.width.unit==s.SizeUnit.Weight&&(i+=p.width.physicalSize)}for(var o=0,u=this._columns;o<u.length;o++){var p;if((p=u[o]).width instanceof a.SizeAndUnit&&p.width.unit==s.SizeUnit.Weight&&i>0){var c=100/i*p.width.physicalSize;p._computedWeight=c}var h=p.render();h&&(this._renderedColumns.length>0&&p.separatorElement&&(p.separatorElement.style.flex="0 0 auto",l.appendChild(e,p.separatorElement)),l.appendChild(e,h),this._renderedColumns.push(p))}return this._renderedColumns.length>0?e:null}return null},e.prototype.truncateOverflow=function(t){for(var e=0,i=this._columns;e<i.length;e++){i[e].handleOverflow(t)}return!0},e.prototype.undoOverflowTruncation=function(){for(var t=0,e=this._columns;t<e.length;t++){e[t].resetOverflow()}},Object.defineProperty(e.prototype,"isSelectable",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);if(this._columns.length>0){for(var i=[],n=0,r=this._columns;n<r.length;n++){var o=r[n];i.push(o.toJSON())}l.setProperty(e,"columns",i)}return l.setProperty(e,"bleed",this.bleed,!1),e},e.prototype.isFirstElement=function(t){for(var e=0;e<this._columns.length;e++)if(this._columns[e].isVisible)return this._columns[e]==t;return!1},e.prototype.isBleedingAtTop=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var t=0,e=this._columns;t<e.length;t++){if(e[t].isBleedingAtTop())return!0}return!1},e.prototype.isBleedingAtBottom=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var t=0,e=this._columns;t<e.length;t++){if(e[t].isBleedingAtBottom())return!0}return!1},e.prototype.getCount=function(){return this._columns.length},e.prototype.getItemCount=function(){return this.getCount()},e.prototype.getFirstVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[0]:null},e.prototype.getLastVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[this._renderedColumns.length-1]:null},e.prototype.getColumnAt=function(t){return this._columns[t]},e.prototype.getItemAt=function(t){return this.getColumnAt(t)},e.prototype.getJsonTypeName=function(){return"ColumnSet"},e.prototype.parse=function(e,i){if(t.prototype.parse.call(this,e,i),null!=e.columns){var n=e.columns;this._columns=[];for(var r=0;r<n.length;r++){var o=this.createColumnInstance(n[r],i);this._columns.push(o)}}this.bleed=l.getBoolValue(e.bleed,this.bleed)},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e);for(var i=0,n=0,r=0,o=this._columns;r<o.length;r++){var a=o[r];"number"==typeof a.width?i++:"stretch"===a.width&&n++}i>0&&n>0&&e.addFailure(this,{error:s.ValidationError.Hint,message:"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."})},e.prototype.addColumn=function(t){if(t.parent)throw new Error("This column already belongs to another ColumnSet.");this._columns.push(t),t.setParent(this)},e.prototype.removeItem=function(t){if(t instanceof it){var e=this._columns.indexOf(t);if(e>=0)return this._columns.splice(e,1),t.setParent(null),this.updateLayout(),!0}return!1},e.prototype.indexOf=function(t){return t instanceof it?this._columns.indexOf(t):-1},e.prototype.isLeftMostElement=function(t){return 0==this._columns.indexOf(t)},e.prototype.isRightMostElement=function(t){return this._columns.indexOf(t)==this._columns.length-1},e.prototype.isTopElement=function(t){return this._columns.indexOf(t)>=0},e.prototype.isBottomElement=function(t){return this._columns.indexOf(t)>=0},e.prototype.getActionById=function(t){for(var e=null,i=0;i<this._columns.length&&!(e=this._columns[i].getActionById(t));i++);return e},Object.defineProperty(e.prototype,"bleed",{get:function(){return this.getBleed()},set:function(t){this.setBleed(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return this.getPadding()},set:function(t){this.setPadding(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectAction",{get:function(){return this.getSelectAction()},set:function(t){this.setSelectAction(t)},enumerable:!0,configurable:!0}),e}(Q);function rt(t){var e=t.getRootElement(),i=e&&e.onImageLoaded?e.onImageLoaded:dt.onImageLoaded;i&&i(t)}function ot(t,e){var i=t.getRootElement(),n=i&&i.onAnchorClicked?i.onAnchorClicked:dt.onAnchorClicked;return null!=n&&n(t,e)}function st(t,e){var i=t.parent.getRootElement(),n=i&&i.onInlineCardExpanded?i.onInlineCardExpanded:dt.onInlineCardExpanded;n&&n(t,e)}function at(t,e){void 0===e&&(e=!0);var i=t.getRootElement();e&&i.updateLayout();var n=i,r=n&&n.onElementVisibilityChanged?n.onElementVisibilityChanged:dt.onElementVisibilityChanged;null!=r&&r(t)}function lt(t,e){e&&e.push(t),null!=dt.onParseError&&dt.onParseError(t)}e.ColumnSet=nt;var ut=function(t){function e(){var e=t.call(this)||this;return e._actionCollection=new Y(e),e}return r(e,t),e.prototype.internalRender=function(){var e=t.prototype.internalRender.call(this),i=this._actionCollection.render(this.hostConfig.actions.actionsOrientation,!1);return i&&(l.appendChild(e,l.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing),lineThickness:null,lineColor:null},s.Orientation.Horizontal)),l.appendChild(e,i)),this.renderIfEmpty?e:e.children.length>0?e:null},e.prototype.getHasExpandedAction=function(){return 0!=this.renderedActionCount&&(1==this.renderedActionCount?null!=this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:null!=this._actionCollection.expandedAction)},Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderIfEmpty",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"actions",this._actionCollection.toJSON()),e},e.prototype.getActionCount=function(){return this._actionCollection.items.length},e.prototype.getActionAt=function(e){if(e>=0&&e<this.getActionCount())return this._actionCollection.items[e];t.prototype.getActionAt.call(this,e)},e.prototype.getActionById=function(e){var i=this._actionCollection.getActionById(e);return i||t.prototype.getActionById.call(this,e)},e.prototype.parse=function(e,i){t.prototype.parse.call(this,e,i),this._actionCollection.parse(e.actions,i)},e.prototype.internalValidateProperties=function(e){t.prototype.internalValidateProperties.call(this,e),this._actionCollection&&this._actionCollection.validateProperties(e)},e.prototype.isLastElement=function(e){return t.prototype.isLastElement.call(this,e)&&0==this._actionCollection.items.length},e.prototype.addAction=function(t){this._actionCollection.addAction(t)},e.prototype.clear=function(){t.prototype.clear.call(this),this._actionCollection.clear()},e.prototype.getAllInputs=function(){return t.prototype.getAllInputs.call(this).concat(this._actionCollection.getAllInputs())},e.prototype.getResourceInformation=function(){return t.prototype.getResourceInformation.call(this).concat(this._actionCollection.getResourceInformation())},e.prototype.isBleedingAtBottom=function(){return 0==this._actionCollection.renderedActionCount?t.prototype.isBleedingAtBottom.call(this):1==this._actionCollection.items.length?null!=this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:null!=this._actionCollection.expandedAction},Object.defineProperty(e.prototype,"isStandalone",{get:function(){return!1},enumerable:!0,configurable:!0}),e}(et);e.ContainerWithActions=ut;var pt=function(){function t(){this._items=[],this.reset()}return t.prototype.findTypeRegistration=function(t){for(var e=0;e<this._items.length;e++)if(this._items[e].typeName===t)return this._items[e];return null},t.prototype.clear=function(){this._items=[]},t.prototype.registerType=function(t,e){var i=this.findTypeRegistration(t);null!=i?i.createInstance=e:(i={typeName:t,createInstance:e},this._items.push(i))},t.prototype.unregisterType=function(t){for(var e=0;e<this._items.length;e++)if(this._items[e].typeName===t)return void this._items.splice(e,1)},t.prototype.createInstance=function(t){var e=this.findTypeRegistration(t);return e?e.createInstance():null},t.prototype.getItemCount=function(){return this._items.length},t.prototype.getItemAt=function(t){return this._items[t]},t}();e.TypeRegistry=pt;var ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.reset=function(){this.clear(),this.registerType("Container",(function(){return new et})),this.registerType("TextBlock",(function(){return new _})),this.registerType("RichTextBlock",(function(){return new P})),this.registerType("TextRun",(function(){return new E})),this.registerType("Image",(function(){return new I})),this.registerType("ImageSet",(function(){return new V})),this.registerType("Media",(function(){return new k})),this.registerType("FactSet",(function(){return new w})),this.registerType("ColumnSet",(function(){return new nt})),this.registerType("ActionSet",(function(){return new Z})),this.registerType("Input.Text",(function(){return new D})),this.registerType("Input.Date",(function(){return new F})),this.registerType("Input.Time",(function(){return new H})),this.registerType("Input.Number",(function(){return new M})),this.registerType("Input.ChoiceSet",(function(){return new B})),this.registerType("Input.Toggle",(function(){return new R}))},e}(pt);e.ElementTypeRegistry=ct;var ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.reset=function(){this.clear(),this.registerType(q.JsonTypeName,(function(){return new q})),this.registerType(U.JsonTypeName,(function(){return new U})),this.registerType($.JsonTypeName,(function(){return new $})),this.registerType(G.JsonTypeName,(function(){return new G}))},e}(pt);e.ActionTypeRegistry=ht;var dt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._cardTypeName="AdaptiveCard",e._fallbackCard=null,e.onAnchorClicked=null,e.onExecuteAction=null,e.onElementVisibilityChanged=null,e.onImageLoaded=null,e.onInlineCardExpanded=null,e.onInputValueChanged=null,e.onParseElement=null,e.onParseAction=null,e.version=new u.Version(1,0),e.designMode=!1,e}return r(e,t),Object.defineProperty(e,"processMarkdown",{get:function(){throw new Error("The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.")},set:function(t){throw new Error("The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.")},enumerable:!0,configurable:!0}),e.applyMarkdown=function(t){var i={didProcess:!1};return e.onProcessMarkdown?e.onProcessMarkdown(t,i):window.markdownit&&(i.outputHtml=window.markdownit().render(t),i.didProcess=!0),i},e.prototype.isVersionSupported=function(){return!!this.bypassVersionCheck||!(!this.version||!this.version.isValid||e.currentVersion.major<this.version.major||e.currentVersion.major==this.version.major&&e.currentVersion.minor<this.version.minor)},e.prototype.getItemsCollectionPropertyName=function(){return"body"},e.prototype.internalRender=function(){var i=t.prototype.internalRender.call(this);return e.useAdvancedCardBottomTruncation&&(i.style.minHeight=null),i},e.prototype.getHasBackground=function(){return!0},e.prototype.getDefaultPadding=function(){return new a.PaddingDefinition(s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding)},Object.defineProperty(e.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bypassVersionCheck",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasBackground",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.getJsonTypeName=function(){return"AdaptiveCard"},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return l.setProperty(e,"$schema","http://adaptivecards.io/schemas/adaptive-card.json"),!this.bypassVersionCheck&&this.version&&l.setProperty(e,"version",this.version.toString()),l.setProperty(e,"fallbackText",this.fallbackText),l.setProperty(e,"lang",this.lang),l.setProperty(e,"speak",this.speak),e},e.prototype.internalValidateProperties=function(i){t.prototype.internalValidateProperties.call(this,i),"AdaptiveCard"!=this._cardTypeName&&i.addFailure(this,{error:s.ValidationError.MissingCardType,message:'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'}),this.bypassVersionCheck||this.version?this.isVersionSupported()||i.addFailure(this,{error:s.ValidationError.UnsupportedCardVersion,message:"The specified card version ("+this.version+") is not supported. The maximum supported card version is "+e.currentVersion}):i.addFailure(this,{error:s.ValidationError.PropertyCantBeNull,message:"The version property must be specified."})},e.prototype.parse=function(i,n){this._fallbackCard=null,this._cardTypeName=l.getStringValue(i.type),this.speak=l.getStringValue(i.speak);var r=i.lang;if(r&&"string"==typeof r)try{this.lang=r}catch(t){lt({error:s.ValidationError.InvalidPropertyValue,message:t.message},n)}this.version=u.Version.parse(i.version,n),this.fallbackText=l.getStringValue(i.fallbackText);var o=y(null,i.fallback,!this.isDesignMode(),n);o&&(this._fallbackCard=new e,this._fallbackCard.addItem(o)),t.prototype.parse.call(this,i,n)},e.prototype.render=function(e){var i;return this.shouldFallback()&&this._fallbackCard?(this._fallbackCard.hostConfig=this.hostConfig,i=this._fallbackCard.render()):(i=t.prototype.render.call(this))&&(i.classList.add(this.hostConfig.makeCssClassName("ac-adaptiveCard")),i.tabIndex=0,l.isNullOrEmpty(this.speak)||i.setAttribute("aria-label",this.speak)),e&&(e.appendChild(i),this.updateLayout()),i},e.prototype.updateLayout=function(i){if(void 0===i&&(i=!0),t.prototype.updateLayout.call(this,i),e.useAdvancedCardBottomTruncation&&this.isRendered()){var n=this.renderedElement,r=this.hostConfig.getEffectiveSpacing(s.Spacing.Default);this.handleOverflow(n.offsetHeight-r)}},e.prototype.shouldFallback=function(){return t.prototype.shouldFallback.call(this)||!this.isVersionSupported()},Object.defineProperty(e.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!0,configurable:!0}),e.currentVersion=new u.Version(1,2),e.useAdvancedTextBlockTruncation=!0,e.useAdvancedCardBottomTruncation=!1,e.useMarkdownInRadioButtonAndCheckbox=!0,e.allowMarkForTextHighlighting=!1,e.alwaysBleedSeparators=!1,e.enableFullJsonRoundTrip=!1,e.useBuiltInInputValidation=!1,e.displayInputValidationErrors=!0,e.elementTypeRegistry=new ct,e.actionTypeRegistry=new ht,e.onAnchorClicked=null,e.onExecuteAction=null,e.onElementVisibilityChanged=null,e.onImageLoaded=null,e.onInlineCardExpanded=null,e.onInputValueChanged=null,e.onParseElement=null,e.onParseAction=null,e.onParseError=null,e.onProcessMarkdown=null,e}(ut);e.AdaptiveCard=dt;var ft=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.suppressStyle=!1,e}return r(e,t),e.prototype.getDefaultPadding=function(){return new a.PaddingDefinition(this.suppressStyle?s.Spacing.None:s.Spacing.Padding,s.Spacing.Padding,this.suppressStyle?s.Spacing.None:s.Spacing.Padding,s.Spacing.Padding)},Object.defineProperty(e.prototype,"bypassVersionCheck",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultStyle",{get:function(){return this.suppressStyle?s.ContainerStyle.Default:this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:s.ContainerStyle.Emphasis},enumerable:!0,configurable:!0}),e.prototype.render=function(e){var i=t.prototype.render.call(this,e);return i.setAttribute("aria-live","polite"),i.removeAttribute("tabindex"),i},e.prototype.getForbiddenActionTypes=function(){return[$]},e}(dt),yt=new u.HostConfig({supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},actions:{maxActions:5,spacing:s.Spacing.Default,buttonSpacing:10,showCard:{actionMode:s.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:s.Orientation.Horizontal,actionAlignment:s.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:s.Size.Medium,maxImageHeight:100},factSet:{title:{color:s.TextColor.Default,size:s.TextSize.Default,isSubtle:!1,weight:s.TextWeight.Bolder,wrap:!0,maxWidth:150},value:{color:s.TextColor.Default,size:s.TextSize.Default,isSubtle:!1,weight:s.TextWeight.Default,wrap:!0},spacing:10}})},16984:function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t){this._regularExpression=t}return t.prototype.format=function(t,e){for(var i,n=e;null!=(i=this._regularExpression.exec(e));)n=n.replace(i[0],this.internalFormat(t,i));return n},t}(),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.internalFormat=function(t,e){var i=new Date(Date.parse(e[1])),n=null!=e[2]?e[2].toLowerCase():"compact";return"compact"!=n?i.toLocaleDateString(t,{day:"numeric",weekday:n,month:n,year:"numeric"}):i.toLocaleDateString()},e}(o),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.internalFormat=function(t,e){return new Date(Date.parse(e[1])).toLocaleTimeString(t,{hour:"numeric",minute:"2-digit"})},e}(o);e.formatText=function(t,e){for(var i=[new s(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new a(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)],n=e,r=0;r<i.length;r++)n=i[r].format(t,n);return n}},2547:function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(16983)),n(i(7633)),n(i(11974)),n(i(8361)),n(i(10126))},3596:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||e.hasOwnProperty(i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(6721),e),r(i(11968),e),r(i(11969),e),r(i(11971),e),r(i(5699),e),r(i(11972),e),r(i(6286),e),r(i(7631),e),r(i(7632),e),r(i(16981),e),r(i(11973),e),r(i(16982),e)},5699:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LogLevel=e.RefreshMode=e.ContainerFitStatus=e.ValidationEvent=e.ValidationPhase=e.ContainerStyle=e.InputTextStyle=e.ActionIconPlacement=e.FillMode=e.Orientation=e.ShowCardActionMode=e.ImageStyle=e.ActionAlignment=e.VerticalAlignment=e.HorizontalAlignment=e.TextColor=e.Spacing=e.FontType=e.TextWeight=e.TextSize=e.SizeUnit=e.ImageSize=e.Size=e.ActionStyle=void 0;var n=function(){function t(){}return t.Default="default",t.Positive="positive",t.Destructive="destructive",t}();e.ActionStyle=n,function(t){t[t.Auto=0]="Auto",t[t.Stretch=1]="Stretch",t[t.Small=2]="Small",t[t.Medium=3]="Medium",t[t.Large=4]="Large"}(e.Size||(e.Size={})),function(t){t[t.Small=0]="Small",t[t.Medium=1]="Medium",t[t.Large=2]="Large"}(e.ImageSize||(e.ImageSize={})),function(t){t[t.Weight=0]="Weight",t[t.Pixel=1]="Pixel"}(e.SizeUnit||(e.SizeUnit={})),function(t){t[t.Small=0]="Small",t[t.Default=1]="Default",t[t.Medium=2]="Medium",t[t.Large=3]="Large",t[t.ExtraLarge=4]="ExtraLarge"}(e.TextSize||(e.TextSize={})),function(t){t[t.Lighter=0]="Lighter",t[t.Default=1]="Default",t[t.Bolder=2]="Bolder"}(e.TextWeight||(e.TextWeight={})),function(t){t[t.Default=0]="Default",t[t.Monospace=1]="Monospace"}(e.FontType||(e.FontType={})),function(t){t[t.None=0]="None",t[t.Small=1]="Small",t[t.Default=2]="Default",t[t.Medium=3]="Medium",t[t.Large=4]="Large",t[t.ExtraLarge=5]="ExtraLarge",t[t.Padding=6]="Padding"}(e.Spacing||(e.Spacing={})),function(t){t[t.Default=0]="Default",t[t.Dark=1]="Dark",t[t.Light=2]="Light",t[t.Accent=3]="Accent",t[t.Good=4]="Good",t[t.Warning=5]="Warning",t[t.Attention=6]="Attention"}(e.TextColor||(e.TextColor={})),function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right"}(e.HorizontalAlignment||(e.HorizontalAlignment={})),function(t){t[t.Top=0]="Top",t[t.Center=1]="Center",t[t.Bottom=2]="Bottom"}(e.VerticalAlignment||(e.VerticalAlignment={})),function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right",t[t.Stretch=3]="Stretch"}(e.ActionAlignment||(e.ActionAlignment={})),function(t){t[t.Default=0]="Default",t[t.Person=1]="Person"}(e.ImageStyle||(e.ImageStyle={})),function(t){t[t.Inline=0]="Inline",t[t.Popup=1]="Popup"}(e.ShowCardActionMode||(e.ShowCardActionMode={})),function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical"}(e.Orientation||(e.Orientation={})),function(t){t[t.Cover=0]="Cover",t[t.RepeatHorizontally=1]="RepeatHorizontally",t[t.RepeatVertically=2]="RepeatVertically",t[t.Repeat=3]="Repeat"}(e.FillMode||(e.FillMode={})),function(t){t[t.LeftOfTitle=0]="LeftOfTitle",t[t.AboveTitle=1]="AboveTitle"}(e.ActionIconPlacement||(e.ActionIconPlacement={})),function(t){t[t.Text=0]="Text",t[t.Tel=1]="Tel",t[t.Url=2]="Url",t[t.Email=3]="Email"}(e.InputTextStyle||(e.InputTextStyle={}));var r=function(){function t(){}return t.Default="default",t.Emphasis="emphasis",t.Accent="accent",t.Good="good",t.Attention="attention",t.Warning="warning",t}();e.ContainerStyle=r,function(t){t[t.Parse=0]="Parse",t[t.ToJSON=1]="ToJSON",t[t.Validation=2]="Validation"}(e.ValidationPhase||(e.ValidationPhase={})),function(t){t[t.Hint=0]="Hint",t[t.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",t[t.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",t[t.Deprecated=3]="Deprecated",t[t.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",t[t.InteractivityNotAllowed=5]="InteractivityNotAllowed",t[t.InvalidPropertyValue=6]="InvalidPropertyValue",t[t.MissingCardType=7]="MissingCardType",t[t.PropertyCantBeNull=8]="PropertyCantBeNull",t[t.TooManyActions=9]="TooManyActions",t[t.UnknownActionType=10]="UnknownActionType",t[t.UnknownElementType=11]="UnknownElementType",t[t.UnsupportedCardVersion=12]="UnsupportedCardVersion",t[t.DuplicateId=13]="DuplicateId",t[t.UnsupportedProperty=14]="UnsupportedProperty",t[t.RequiredInputsShouldHaveLabel=15]="RequiredInputsShouldHaveLabel",t[t.RequiredInputsShouldHaveErrorMessage=16]="RequiredInputsShouldHaveErrorMessage",t[t.Other=17]="Other"}(e.ValidationEvent||(e.ValidationEvent={})),function(t){t[t.FullyInContainer=0]="FullyInContainer",t[t.Overflowing=1]="Overflowing",t[t.FullyOutOfContainer=2]="FullyOutOfContainer"}(e.ContainerFitStatus||(e.ContainerFitStatus={})),function(t){t[t.Disabled=0]="Disabled",t[t.Manual=1]="Manual",t[t.Automatic=2]="Automatic"}(e.RefreshMode||(e.RefreshMode={})),function(t){t[t.Info=0]="Info",t[t.Warning=1]="Warning",t[t.Error=2]="Error"}(e.LogLevel||(e.LogLevel={}))},6286:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UUID=e.SizeAndUnit=e.PaddingDefinition=e.SpacingDefinition=e.StringWithSubstitutions=e.ContentTypes=e.GlobalSettings=void 0;var n=i(5699),r=function(){function t(){}return t.useAdvancedTextBlockTruncation=!0,t.useAdvancedCardBottomTruncation=!1,t.useMarkdownInRadioButtonAndCheckbox=!0,t.allowMarkForTextHighlighting=!1,t.alwaysBleedSeparators=!1,t.enableFullJsonRoundTrip=!1,t.displayInputValidationErrors=!0,t.allowPreProcessingPropertyValues=!1,t.setTabIndexAtCardRoot=!0,t.enableFallback=!0,t.useWebkitLineClamp=!0,t.applets={logEnabled:!0,logLevel:n.LogLevel.Error,maximumRetryAttempts:3,defaultTimeBetweenRetryAttempts:3e3,authPromptWidth:400,authPromptHeight:600,refresh:{mode:n.RefreshMode.Manual,timeBetweenAutomaticRefreshes:3e3,maximumConsecutiveAutomaticRefreshes:3,allowManualRefreshesAfterAutomaticRefreshes:!0}},t}();e.GlobalSettings=r,e.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"};var o=function(){function t(){this._isProcessed=!1}return t.prototype.getReferencedInputs=function(t,e){if(!e)throw new Error("The referencedInputs parameter cannot be null.");for(var i=0,n=t;i<n.length;i++){var r=n[i];null!=new RegExp("\\{{2}("+r.id+").value\\}{2}","gi").exec(this._original)&&r.id&&(e[r.id]=r)}},t.prototype.substituteInputValues=function(t,i){if(this._processed=this._original,this._original)for(var n=/\{{2}([a-z0-9_$@]+).value\}{2}/gi,r=void 0;null!==(r=n.exec(this._original));)for(var o=0,s=Object.keys(t);o<s.length;o++){var a=s[o];if(a.toLowerCase()==r[1].toLowerCase()){var l=t[a],u="";l.value&&(u=l.value),i===e.ContentTypes.applicationJson?u=(u=JSON.stringify(u)).slice(1,-1):i===e.ContentTypes.applicationXWwwFormUrlencoded&&(u=encodeURIComponent(u)),this._processed=this._processed.replace(r[0],u);break}}this._isProcessed=!0},t.prototype.getOriginal=function(){return this._original},t.prototype.get=function(){return this._isProcessed?this._processed:this._original},t.prototype.set=function(t){this._original=t,this._isProcessed=!1},t}();e.StringWithSubstitutions=o;var s=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=t,this.right=e,this.bottom=i,this.left=n};e.SpacingDefinition=s;var a=function(t,e,i,r){void 0===t&&(t=n.Spacing.None),void 0===e&&(e=n.Spacing.None),void 0===i&&(i=n.Spacing.None),void 0===r&&(r=n.Spacing.None),this.top=n.Spacing.None,this.right=n.Spacing.None,this.bottom=n.Spacing.None,this.left=n.Spacing.None,this.top=t,this.right=e,this.bottom=i,this.left=r};e.PaddingDefinition=a;var l=function(){function t(t,e){this.physicalSize=t,this.unit=e}return t.parse=function(e,i){void 0===i&&(i=!1);var r=new t(0,n.SizeUnit.Weight);if("number"==typeof e)return r.physicalSize=e,r;if("string"==typeof e){var o=/^([0-9]+)(px|\*)?$/g.exec(e),s=i?3:2;if(o&&o.length>=s)return r.physicalSize=parseInt(o[1]),3==o.length&&"px"==o[2]&&(r.unit=n.SizeUnit.Pixel),r}throw new Error("Invalid size: "+e)},t}();e.SizeAndUnit=l;
/**
 * Fast UUID generator, RFC4122 version 4 compliant.
 * @author Jeff Ward (jcward.com).
 * @license MIT license
 * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
 **/
var u=function(){function t(){}return t.generate=function(){var e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return t.lut[255&e]+t.lut[e>>8&255]+t.lut[e>>16&255]+t.lut[e>>24&255]+"-"+t.lut[255&i]+t.lut[i>>8&255]+"-"+t.lut[i>>16&15|64]+t.lut[i>>24&255]+"-"+t.lut[63&n|128]+t.lut[n>>8&255]+"-"+t.lut[n>>16&255]+t.lut[n>>24&255]+t.lut[255&r]+t.lut[r>>8&255]+t.lut[r>>16&255]+t.lut[r>>24&255]},t.initialize=function(){for(var e=0;e<256;e++)t.lut[e]=(e<16?"0":"")+e.toString(16)},t.lut=[],t}();e.UUID=u,u.initialize()},6721:function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableObject=e.property=e.SerializableObjectSchema=e.CustomProperty=e.SerializableObjectCollectionProperty=e.SerializableObjectProperty=e.EnumProperty=e.ValueSetProperty=e.StringArrayProperty=e.PixelSizeProperty=e.NumProperty=e.BoolProperty=e.StringProperty=e.PropertyDefinition=e.BaseSerializationContext=e.isVersionLessOrEqual=e.Versions=e.Version=void 0;var o=i(6286),s=i(7631),a=i(5699),l=i(7632),u=function(){function t(t,e,i){void 0===t&&(t=1),void 0===e&&(e=1),this._isValid=!0,this._major=t,this._minor=e,this._label=i}return t.parse=function(e,i){if(e){var n=new t;n._versionString=e;var r=/(\d+).(\d+)/gi.exec(e);return null!=r&&3==r.length?(n._major=parseInt(r[1]),n._minor=parseInt(r[2])):n._isValid=!1,n._isValid||i.logParseEvent(void 0,a.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidVersionString(n._versionString)),n}},t.prototype.toString=function(){return this._isValid?this._major+"."+this._minor:this._versionString},t.prototype.toJSON=function(){return this.toString()},t.prototype.compareTo=function(t){if(!this.isValid||!t.isValid)throw new Error("Cannot compare invalid version.");return this.major>t.major?1:this.major<t.major?-1:this.minor>t.minor?1:this.minor<t.minor?-1:0},Object.defineProperty(t.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"major",{get:function(){return this._major},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minor",{get:function(){return this._minor},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isValid",{get:function(){return this._isValid},enumerable:!1,configurable:!0}),t}();e.Version=u;var p=function(){function t(){}return t.v1_0=new u(1,0),t.v1_1=new u(1,1),t.v1_2=new u(1,2),t.v1_3=new u(1,3),t.v1_4=new u(1,4),t.latest=t.v1_4,t}();e.Versions=p,e.isVersionLessOrEqual=function(t,e){return!(t instanceof u)||(!(e instanceof u)||e.compareTo(t)>=0)};var c=function(){function t(t){void 0===t&&(t=p.latest),this.targetVersion=t,this._validationEvents=[]}return t.prototype.serializeValue=function(t,e,i,n,r){void 0===n&&(n=void 0),void 0===r&&(r=!1),null==i||i===n?o.GlobalSettings.enableFullJsonRoundTrip&&!r||delete t[e]:t[e]=i},t.prototype.serializeString=function(t,e,i,n){null==i||i===n?delete t[e]:t[e]=i},t.prototype.serializeBool=function(t,e,i,n){null==i||i===n?delete t[e]:t[e]=i},t.prototype.serializeNumber=function(t,e,i,n){null==i||i===n||isNaN(i)?delete t[e]:t[e]=i},t.prototype.serializeEnum=function(t,e,i,n,r){void 0===r&&(r=void 0);var o=e[i],s=null==o||void 0!==t[o];n==r?s&&delete e[i]:null==n?s&&delete e[i]:e[i]=t[n]},t.prototype.serializeArray=function(t,e,i){var n=[];if(i)for(var r=0,o=i;r<o.length;r++){var s=o[r],a=void 0;void 0!==(a=s instanceof P?s.toJSON(this):s.toJSON?s.toJSON():s)&&n.push(a)}0==n.length?t.hasOwnProperty(e)&&Array.isArray(t[e])&&delete t[e]:this.serializeValue(t,e,n)},t.prototype.clearEvents=function(){this._validationEvents=[]},t.prototype.logEvent=function(t,e,i,n){this._validationEvents.push({source:t,phase:e,event:i,message:n})},t.prototype.logParseEvent=function(t,e,i){this.logEvent(t,a.ValidationPhase.Parse,e,i)},t.prototype.getEventAt=function(t){return this._validationEvents[t]},Object.defineProperty(t.prototype,"eventCount",{get:function(){return this._validationEvents.length},enumerable:!1,configurable:!0}),t}();e.BaseSerializationContext=c;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(c),d=function(){function t(e,i,n,r){this.targetVersion=e,this.name=i,this.defaultValue=n,this.onGetInitialValue=r,this.isSerializationEnabled=!0,this.sequentialNumber=t._sequentialNumber,t._sequentialNumber++}return t.prototype.getInternalName=function(){return this.name},t.prototype.parse=function(t,e,i){return e[this.name]},t.prototype.toJSON=function(t,e,i,n){n.serializeValue(e,this.name,i,this.defaultValue)},t._sequentialNumber=0,t}();e.PropertyDefinition=d;var f=function(t){function e(e,i,n,r,o,s){void 0===n&&(n=!0);var a=t.call(this,e,i,o,s)||this;return a.targetVersion=e,a.name=i,a.treatEmptyAsUndefined=n,a.regEx=r,a.defaultValue=o,a.onGetInitialValue=s,a}return r(e,t),e.prototype.parse=function(t,e,i){var n=s.parseString(e[this.name],this.defaultValue);if(!(void 0===n||""===n&&this.treatEmptyAsUndefined)&&void 0!==this.regEx&&!this.regEx.exec(n))return void i.logParseEvent(t,a.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(n,this.name));return n},e.prototype.toJSON=function(t,e,i,n){n.serializeString(e,this.name,""===i&&this.treatEmptyAsUndefined?void 0:i,this.defaultValue)},e}(d);e.StringProperty=f;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.parse=function(t,e,i){return s.parseBool(e[this.name],this.defaultValue)},e.prototype.toJSON=function(t,e,i,n){n.serializeBool(e,this.name,i,this.defaultValue)},e}(d);e.BoolProperty=y;var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.parse=function(t,e,i){return s.parseNumber(e[this.name],this.defaultValue)},e.prototype.toJSON=function(t,e,i,n){n.serializeNumber(e,this.name,i,this.defaultValue)},e}(d);e.NumProperty=g;var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.parse=function(t,e,i){var n=void 0,r=e[this.name];if("string"==typeof r){var s=!1;try{var u=o.SizeAndUnit.parse(r,!0);u.unit==a.SizeUnit.Pixel&&(n=u.physicalSize,s=!0)}catch(t){}s||i.logParseEvent(t,a.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(e[this.name],"minHeight"))}return n},e.prototype.toJSON=function(t,e,i,n){n.serializeValue(e,this.name,"number"!=typeof i||isNaN(i)?void 0:i+"px")},e}(d);e.PixelSizeProperty=m;var v=function(t){function e(e,i,n,r){var o=t.call(this,e,i,n,r)||this;return o.targetVersion=e,o.name=i,o.defaultValue=n,o.onGetInitialValue=r,o}return r(e,t),e.prototype.parse=function(t,e,i){var n=e[this.name];if(void 0===n||!Array.isArray(n))return this.defaultValue;for(var r=[],o=0,s=n;o<s.length;o++){var l=s[o];"string"==typeof l?r.push(l):i.logParseEvent(t,a.ValidationEvent.InvalidPropertyValue,'Invalid array value "'+l+'" of type "'+typeof l+'" ignored for "'+this.name+'".')}return r},e.prototype.toJSON=function(t,e,i,n){n.serializeArray(e,this.name,i)},e}(d);e.StringArrayProperty=v;var b=function(t){function e(e,i,n,r,o){var s=t.call(this,e,i,r,o)||this;return s.targetVersion=e,s.name=i,s.values=n,s.defaultValue=r,s.onGetInitialValue=o,s}return r(e,t),e.prototype.isValidValue=function(t,e){for(var i=0,n=this.values;i<n.length;i++){var r=n[i];if(t.toLowerCase()===r.value.toLowerCase())return(r.targetVersion?r.targetVersion:this.targetVersion).compareTo(e.targetVersion)<=0}return!1},e.prototype.parse=function(t,e,i){var n=e[this.name];if(void 0===n)return this.defaultValue;if("string"==typeof n)for(var r=0,o=this.values;r<o.length;r++){var s=o[r];if(n.toLowerCase()===s.value.toLowerCase()){var u=s.targetVersion?s.targetVersion:this.targetVersion;return u.compareTo(i.targetVersion)<=0?s.value:(i.logParseEvent(t,a.ValidationEvent.InvalidPropertyValue,l.Strings.errors.propertyValueNotSupported(n,this.name,u.toString(),i.targetVersion.toString())),this.defaultValue)}}return i.logParseEvent(t,a.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(n,this.name)),this.defaultValue},e.prototype.toJSON=function(t,e,i,n){for(var r=!1,o=0,s=this.values;o<s.length;o++){var u=s[o];if(u.value===i){var p=u.targetVersion?u.targetVersion:this.targetVersion;if(p.compareTo(n.targetVersion)<=0){r=!0;break}n.logEvent(t,a.ValidationPhase.ToJSON,a.ValidationEvent.InvalidPropertyValue,l.Strings.errors.propertyValueNotSupported(i,this.name,p.toString(),n.targetVersion.toString()))}}r&&n.serializeValue(e,this.name,i,this.defaultValue)},e}(d);e.ValueSetProperty=b;var C=function(t){function e(e,i,n,r,o,s){var a=t.call(this,e,i,r,s)||this;if(a.targetVersion=e,a.name=i,a.enumType=n,a.defaultValue=r,a.onGetInitialValue=s,a._values=[],o)a._values=o;else for(var l in n){var u=parseInt(l,10);u>=0&&a._values.push({value:u})}return a}return r(e,t),e.prototype.parse=function(t,e,i){var n=e[this.name];if("string"!=typeof n)return this.defaultValue;var r=s.getEnumValueByName(this.enumType,n);if(void 0!==r)for(var o=0,u=this.values;o<u.length;o++){var p=u[o];if(p.value===r){var c=p.targetVersion?p.targetVersion:this.targetVersion;return c.compareTo(i.targetVersion)<=0?r:(i.logParseEvent(t,a.ValidationEvent.InvalidPropertyValue,l.Strings.errors.propertyValueNotSupported(n,this.name,c.toString(),i.targetVersion.toString())),this.defaultValue)}}return i.logParseEvent(t,a.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(n,this.name)),this.defaultValue},e.prototype.toJSON=function(t,e,i,n){if(void 0!==i){for(var r=!1,o=0,s=this.values;o<s.length;o++){var u=s[o];if(u.value===i){if((u.targetVersion?u.targetVersion:this.targetVersion).compareTo(n.targetVersion)<=0){r=!0;break}n.logEvent(t,a.ValidationPhase.ToJSON,a.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(i,this.name))}}r&&n.serializeEnum(this.enumType,e,this.name,i,this.defaultValue)}},Object.defineProperty(e.prototype,"values",{get:function(){return this._values},enumerable:!1,configurable:!0}),e}(d);e.EnumProperty=C;var S=function(t){function e(e,i,n,r,o){void 0===r&&(r=!1);var s=t.call(this,e,i,o,(function(t){return s.nullable?void 0:new s.objectType}))||this;return s.targetVersion=e,s.name=i,s.objectType=n,s.nullable=r,s}return r(e,t),e.prototype.parse=function(t,e,i){var n=e[this.name];if(void 0===n)return this.onGetInitialValue?this.onGetInitialValue(t):this.defaultValue;var r=new this.objectType;return r.parse(n,i),r},e.prototype.toJSON=function(t,e,i,n){var r=void 0;void 0===i||i.hasAllDefaultValues()||(r=i.toJSON(n)),"object"==typeof r&&0===Object.keys(r).length&&(r=void 0),n.serializeValue(e,this.name,r,this.defaultValue,!0)},e}(d);e.SerializableObjectProperty=S;var _=function(t){function e(e,i,n,r){var o=t.call(this,e,i,void 0,(function(t){return[]}))||this;return o.targetVersion=e,o.name=i,o.objectType=n,o.onItemAdded=r,o}return r(e,t),e.prototype.parse=function(t,e,i){var n=[],r=e[this.name];if(Array.isArray(r))for(var o=0,s=r;o<s.length;o++){var a=s[o],l=new this.objectType;l.parse(a,i),n.push(l),this.onItemAdded&&this.onItemAdded(t,l)}return n.length>0?n:this.onGetInitialValue?this.onGetInitialValue(t):void 0},e.prototype.toJSON=function(t,e,i,n){n.serializeArray(e,this.name,i)},e}(d);e.SerializableObjectCollectionProperty=_;var A=function(t){function e(e,i,n,r,o,s){var a=t.call(this,e,i,o,s)||this;if(a.targetVersion=e,a.name=i,a.onParse=n,a.onToJSON=r,a.defaultValue=o,a.onGetInitialValue=s,!a.onParse)throw new Error("CustomPropertyDefinition instances must have an onParse handler.");if(!a.onToJSON)throw new Error("CustomPropertyDefinition instances must have an onToJSON handler.");return a}return r(e,t),e.prototype.parse=function(t,e,i){return this.onParse(t,this,e,i)},e.prototype.toJSON=function(t,e,i,n){this.onToJSON(t,this,e,i,n)},e}(d);e.CustomProperty=A;var E=function(){function t(){this._properties=[]}return t.prototype.indexOf=function(t){for(var e=0;e<this._properties.length;e++)if(this._properties[e]===t)return e;return-1},t.prototype.add=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<t.length;i++)-1===this.indexOf(t[i])&&this._properties.push(t[i])},t.prototype.remove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,n=t;i<n.length;i++)for(var r=n[i];;){var o=this.indexOf(r);if(!(o>=0))break;this._properties.splice(o,1)}},t.prototype.getItemAt=function(t){return this._properties[t]},t.prototype.getCount=function(){return this._properties.length},t}();e.SerializableObjectSchema=E,e.property=function(t){return function(e,i){var n=Object.getOwnPropertyDescriptor(e,i)||{};n.get||n.set||(n.get=function(){return this.getValue(t)},n.set=function(e){this.setValue(t,e)},Object.defineProperty(e,i,n))}};var P=function(){function t(){this._propertyBag={},this._rawProperties={},this.maxVersion=t.defaultMaxVersion;for(var e=this.getSchema(),i=0;i<e.getCount();i++){var n=e.getItemAt(i);n.onGetInitialValue&&this.setValue(n,n.onGetInitialValue(this))}}return t.prototype.getDefaultSerializationContext=function(){return new h},t.prototype.populateSchema=function(e){var i=this.constructor,n=[];for(var r in i)try{var o=i[r];o instanceof d&&n.push(o)}catch(t){}if(n.length>0){var s=n.sort((function(t,e){return t.sequentialNumber>e.sequentialNumber?1:t.sequentialNumber<e.sequentialNumber?-1:0}));e.add.apply(e,s)}t.onRegisterCustomProperties&&t.onRegisterCustomProperties(this,e)},t.prototype.getValue=function(t){return this._propertyBag.hasOwnProperty(t.getInternalName())?this._propertyBag[t.getInternalName()]:t.defaultValue},t.prototype.setValue=function(t,e){null==e?delete this._propertyBag[t.getInternalName()]:this._propertyBag[t.getInternalName()]=e},t.prototype.internalParse=function(t,e){if(this._propertyBag={},this._rawProperties=o.GlobalSettings.enableFullJsonRoundTrip&&t||{},t)for(var i=this.getSchema(),n=0;n<i.getCount();n++){var r=i.getItemAt(n);if(r.isSerializationEnabled){var s=r.onGetInitialValue?r.onGetInitialValue(this):void 0;t.hasOwnProperty(r.name)&&(r.targetVersion.compareTo(e.targetVersion)<=0?s=r.parse(this,t,e):e.logParseEvent(this,a.ValidationEvent.UnsupportedProperty,l.Strings.errors.propertyNotSupported(r.name,r.targetVersion.toString(),e.targetVersion.toString()))),this.setValue(r,s)}}else this.resetDefaultValues()},t.prototype.internalToJSON=function(t,e){for(var i=this.getSchema(),n=[],r=0;r<i.getCount();r++){var o=i.getItemAt(r);o.isSerializationEnabled&&o.targetVersion.compareTo(e.targetVersion)<=0&&-1===n.indexOf(o.name)&&(o.toJSON(this,t,this.getValue(o),e),n.push(o.name))}},t.prototype.shouldSerialize=function(t){return!0},t.prototype.parse=function(t,e){this.internalParse(t,e||new h)},t.prototype.toJSON=function(t){var e;if(t&&t instanceof c?e=t:(e=this.getDefaultSerializationContext()).toJSONOriginalParam=t,this.shouldSerialize(e)){var i=void 0;return i=o.GlobalSettings.enableFullJsonRoundTrip&&this._rawProperties&&"object"==typeof this._rawProperties?this._rawProperties:{},this.internalToJSON(i,e),i}},t.prototype.hasDefaultValue=function(t){return this.getValue(t)===t.defaultValue},t.prototype.hasAllDefaultValues=function(){for(var t=this.getSchema(),e=0;e<t.getCount();e++){var i=t.getItemAt(e);if(!this.hasDefaultValue(i))return!1}return!0},t.prototype.resetDefaultValues=function(){for(var t=this.getSchema(),e=0;e<t.getCount();e++){var i=t.getItemAt(e);this.setValue(i,i.defaultValue)}},t.prototype.setCustomProperty=function(t,e){"string"==typeof e&&!e||null==e?delete this._rawProperties[t]:this._rawProperties[t]=e},t.prototype.getCustomProperty=function(t){return this._rawProperties[t]},t.prototype.getSchema=function(){var e=t._schemaCache[this.getSchemaKey()];return e||(e=new E,this.populateSchema(e),t._schemaCache[this.getSchemaKey()]=e),e},t.defaultMaxVersion=p.v1_3,t._schemaCache={},t}();e.SerializableObject=P},7631:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.clearElementChildren=e.getFitStatus=e.truncate=e.stringToCssColor=e.renderSeparation=e.parseEnum=e.getEnumValueByName=e.parseBool=e.parseNumber=e.parseString=e.appendChild=e.generateUniqueId=e.isMobileOS=e.isInternetExplorer=void 0;var n=i(5699),r=i(6286);function o(t,e){for(var i in t){var n=parseInt(i,10);if(n>=0){var r=t[i];if(r&&"string"==typeof r&&r.toLowerCase()===e.toLowerCase())return n}}}function s(t){if(t){var e=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(t);if(e&&e[4]){var i=parseInt(e[1],16)/255;return"rgba("+parseInt(e[2],16)+","+parseInt(e[3],16)+","+parseInt(e[4],16)+","+i+")"}}return t}function a(t,e){for(e+=1;e<t.length&&"<"==t[e];)for(;e<t.length&&">"!=t[e++];);return e}e.isInternetExplorer=function(){return void 0!==window.document.documentMode},e.isMobileOS=function(){var t=window.navigator.userAgent;return!!t.match(/Android/i)||!!t.match(/iPad/i)||!!t.match(/iPhone/i)},e.generateUniqueId=function(){return"__ac-"+r.UUID.generate()},e.appendChild=function(t,e){e&&t.appendChild(e)},e.parseString=function(t,e){return"string"==typeof t?t:e},e.parseNumber=function(t,e){return"number"==typeof t?t:e},e.parseBool=function(t,e){if("boolean"==typeof t)return t;if("string"==typeof t)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;default:return e}return e},e.getEnumValueByName=o,e.parseEnum=function(t,e,i){if(!e)return i;var n=o(t,e);return void 0!==n?n:i},e.renderSeparation=function(t,e,i){if(e.spacing>0||e.lineThickness&&e.lineThickness>0){var r=document.createElement("div");r.className=t.makeCssClassName("ac-"+(i==n.Orientation.Horizontal?"horizontal":"vertical")+"-separator"),r.setAttribute("aria-hidden","true");var o=e.lineColor?s(e.lineColor):"";return i==n.Orientation.Horizontal?e.lineThickness?(r.style.paddingTop=e.spacing/2+"px",r.style.marginBottom=e.spacing/2+"px",r.style.borderBottom=e.lineThickness+"px solid "+o):r.style.height=e.spacing+"px":e.lineThickness?(r.style.paddingLeft=e.spacing/2+"px",r.style.marginRight=e.spacing/2+"px",r.style.borderRight=e.lineThickness+"px solid "+o):r.style.width=e.spacing+"px",r.style.overflow="hidden",r.style.flex="0 0 auto",r}},e.stringToCssColor=s,e.truncate=function(t,e,i){var n=function(){return e-t.scrollHeight>=-1};if(!n()){for(var r=t.innerHTML,o=function(e){t.innerHTML=r.substring(0,e)+"..."},s=function(t){var e=[],i=a(t,-1);for(;i<t.length;)" "==t[i]&&e.push(i),i=a(t,i);return e}(r),l=0,u=s.length,p=0;l<u;){var c=Math.floor((l+u)/2);o(s[c]),n()?(p=s[c],l=c+1):u=c}if(o(p),i&&e-t.scrollHeight>=i-1){for(var h=a(r,p);h<r.length&&(o(h),n());)p=h,h=a(r,h);o(p)}}},e.getFitStatus=function(t,e){var i=t.offsetTop;return i+t.clientHeight<=e?n.ContainerFitStatus.FullyInContainer:i<e?n.ContainerFitStatus.Overflowing:n.ContainerFitStatus.FullyOutOfContainer},e.clearElementChildren=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}},7632:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Strings=void 0;var n=function(){function t(){}return t.errors={unknownElementType:function(t){return'Unknown element type "'+t+'". Fallback will be used if present.'},unknownActionType:function(t){return'Unknown action type "'+t+'". Fallback will be used if present.'},elementTypeNotAllowed:function(t){return'Element type "'+t+'" is not allowed in this context.'},actionTypeNotAllowed:function(t){return'Action type "'+t+'" is not allowed in this context.'},invalidPropertyValue:function(t,e){return'Invalid value "'+t+'" for property "'+e+'".'},showCardMustHaveCard:function(){return'"An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},invalidColumnWidth:function(t){return'Invalid column width "'+t+'" - defaulting to "auto".'},invalidCardVersion:function(t){return'Invalid card version. Defaulting to "'+t+'".'},invalidVersionString:function(t){return'Invalid version string "'+t+'".'},propertyValueNotSupported:function(t,e,i,n){return'Value "'+t+'" for property "'+e+'" is supported in version '+i+", but you are using version "+n+"."},propertyNotSupported:function(t,e,i){return'Property "'+t+'" is supported in version '+e+", but you are using version "+i+"."},indexOutOfRange:function(t){return"Index out of range ("+t+")."},elementCannotBeUsedAsInline:function(){return"RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline."},inlineAlreadyParented:function(){return"RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock."},interactivityNotAllowed:function(){return"Interactivity is not allowed."},inputsMustHaveUniqueId:function(){return"All inputs must have a unique Id."},choiceSetMustHaveAtLeastOneChoice:function(){return"An Input.ChoiceSet must have at least one choice defined."},choiceSetChoicesMustHaveTitleAndValue:function(){return"All choices in an Input.ChoiceSet must have their title and value properties set."},propertyMustBeSet:function(t){return'Property "'+t+'" must be set.'},actionHttpHeadersMustHaveNameAndValue:function(){return"All headers of an Action.Http must have their name and value properties set."},tooManyActions:function(t){return"Maximum number of actions exceeded ("+t+")."},columnAlreadyBelongsToAnotherSet:function(){return"This column already belongs to another ColumnSet."},invalidCardType:function(){return'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'},unsupportedCardVersion:function(t,e){return"The specified card version ("+t+") is not supported. The maximum supported card version is "+e+"."},duplicateId:function(t){return'Duplicate Id "'+t+'".'},markdownProcessingNotEnabled:function(){return"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"},processMarkdownEventRemoved:function(){return"The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead."},elementAlreadyParented:function(){return"The element already belongs to another container."},actionAlreadyParented:function(){return"The action already belongs to another element."},elementTypeNotStandalone:function(t){return"Elements of type "+t+" cannot be used as standalone elements."}},t.magicCodeInputCard={tryAgain:function(){return"That didn't work... let's try again."},pleaseLogin:function(){return'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"'},enterMagicCode:function(){return"Enter magic code"},pleaseEnterMagicCodeYouReceived:function(){return"Please enter the magic code you received."},submit:function(){return"Submit"},cancel:function(){return"Cancel"},somethingWentWrong:function(){return"Something went wrong. This action can't be handled."},authenticationFailed:function(){return"Authentication failed."}},t.runtime={automaticRefreshPaused:function(){return"Automatic refresh paused."},clckToRestartAutomaticRefresh:function(){return"Click to restart."},refreshThisCard:function(){return"Refresh this card"}},t.hints={dontUseWeightedAndStrecthedColumnsInSameSet:function(){return"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."}},t.defaults={inlineActionTitle:function(){return"Inline Action"},mediaPlayerAriaLabel:function(){return"Media content"},mediaPlayerPlayMedia:function(){return"Play media"}},t}();e.Strings=n},7633:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.Default="default",t.Positive="positive",t.Destructive="destructive",t}();e.ActionStyle=n,function(t){t[t.Auto=0]="Auto",t[t.Stretch=1]="Stretch",t[t.Small=2]="Small",t[t.Medium=3]="Medium",t[t.Large=4]="Large"}(e.Size||(e.Size={})),function(t){t[t.Weight=0]="Weight",t[t.Pixel=1]="Pixel"}(e.SizeUnit||(e.SizeUnit={})),function(t){t[t.Small=0]="Small",t[t.Default=1]="Default",t[t.Medium=2]="Medium",t[t.Large=3]="Large",t[t.ExtraLarge=4]="ExtraLarge"}(e.TextSize||(e.TextSize={})),function(t){t[t.Lighter=0]="Lighter",t[t.Default=1]="Default",t[t.Bolder=2]="Bolder"}(e.TextWeight||(e.TextWeight={})),function(t){t[t.Default=0]="Default",t[t.Monospace=1]="Monospace"}(e.FontType||(e.FontType={})),function(t){t[t.None=0]="None",t[t.Small=1]="Small",t[t.Default=2]="Default",t[t.Medium=3]="Medium",t[t.Large=4]="Large",t[t.ExtraLarge=5]="ExtraLarge",t[t.Padding=6]="Padding"}(e.Spacing||(e.Spacing={})),function(t){t[t.Default=0]="Default",t[t.Dark=1]="Dark",t[t.Light=2]="Light",t[t.Accent=3]="Accent",t[t.Good=4]="Good",t[t.Warning=5]="Warning",t[t.Attention=6]="Attention"}(e.TextColor||(e.TextColor={})),function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right"}(e.HorizontalAlignment||(e.HorizontalAlignment={})),function(t){t[t.Top=0]="Top",t[t.Center=1]="Center",t[t.Bottom=2]="Bottom"}(e.VerticalAlignment||(e.VerticalAlignment={})),function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right",t[t.Stretch=3]="Stretch"}(e.ActionAlignment||(e.ActionAlignment={})),function(t){t[t.Default=0]="Default",t[t.Person=1]="Person"}(e.ImageStyle||(e.ImageStyle={})),function(t){t[t.Inline=0]="Inline",t[t.Popup=1]="Popup"}(e.ShowCardActionMode||(e.ShowCardActionMode={})),function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical"}(e.Orientation||(e.Orientation={})),function(t){t[t.Cover=0]="Cover",t[t.RepeatHorizontally=1]="RepeatHorizontally",t[t.RepeatVertically=2]="RepeatVertically",t[t.Repeat=3]="Repeat"}(e.FillMode||(e.FillMode={})),function(t){t[t.LeftOfTitle=0]="LeftOfTitle",t[t.AboveTitle=1]="AboveTitle"}(e.ActionIconPlacement||(e.ActionIconPlacement={})),function(t){t[t.Text=0]="Text",t[t.Tel=1]="Tel",t[t.Url=2]="Url",t[t.Email=3]="Email"}(e.InputTextStyle||(e.InputTextStyle={})),function(t){t[t.Optional=0]="Optional",t[t.Required=1]="Required",t[t.RequiredWithVisualCue=2]="RequiredWithVisualCue"}(e.InputValidationNecessity||(e.InputValidationNecessity={}));var r=function(){function t(){}return t.Default="default",t.Emphasis="emphasis",t.Accent="accent",t.Good="good",t.Attention="attention",t.Warning="warning",t}();e.ContainerStyle=r,function(t){t[t.Hint=0]="Hint",t[t.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",t[t.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",t[t.Deprecated=3]="Deprecated",t[t.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",t[t.InteractivityNotAllowed=5]="InteractivityNotAllowed",t[t.InvalidPropertyValue=6]="InvalidPropertyValue",t[t.MissingCardType=7]="MissingCardType",t[t.PropertyCantBeNull=8]="PropertyCantBeNull",t[t.TooManyActions=9]="TooManyActions",t[t.UnknownActionType=10]="UnknownActionType",t[t.UnknownElementType=11]="UnknownElementType",t[t.UnsupportedCardVersion=12]="UnsupportedCardVersion",t[t.DuplicateId=13]="DuplicateId"}(e.ValidationError||(e.ValidationError={})),function(t){t[t.FullyInContainer=0]="FullyInContainer",t[t.Overflowing=1]="Overflowing",t[t.FullyOutOfContainer=2]="FullyOutOfContainer"}(e.ContainerFitStatus||(e.ContainerFitStatus={}))},8361:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(7633);e.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"};var r=function(){function t(){this._isProcessed=!1,this._original=null,this._processed=null}return t.prototype.getReferencedInputs=function(t,e){if(!e)throw new Error("The referencedInputs parameter cannot be null.");for(var i=0,n=t;i<n.length;i++){var r=n[i];null!=new RegExp("\\{{2}("+r.id+").value\\}{2}","gi").exec(this._original)&&(e[r.id]=r)}},t.prototype.substituteInputValues=function(t,i){this._processed=this._original;for(var n,r=/\{{2}([a-z0-9_$@]+).value\}{2}/gi;null!=(n=r.exec(this._original));){for(var o=null,s=0,a=Object.keys(t);s<a.length;s++){var l=a[s];if(l.toLowerCase()==n[1].toLowerCase()){o=t[l];break}}if(o){var u="";o.value&&(u=o.value),i===e.ContentTypes.applicationJson?u=(u=JSON.stringify(u)).slice(1,-1):i===e.ContentTypes.applicationXWwwFormUrlencoded&&(u=encodeURIComponent(u)),this._processed=this._processed.replace(n[0],u)}}this._isProcessed=!0},t.prototype.getOriginal=function(){return this._original},t.prototype.get=function(){return this._isProcessed?this._processed:this._original},t.prototype.set=function(t){this._original=t,this._isProcessed=!1},t}();e.StringWithSubstitutions=r;var o=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=t,this.right=e,this.bottom=i,this.left=n};e.SpacingDefinition=o;var s=function(t,e,i,r){void 0===t&&(t=n.Spacing.None),void 0===e&&(e=n.Spacing.None),void 0===i&&(i=n.Spacing.None),void 0===r&&(r=n.Spacing.None),this.top=n.Spacing.None,this.right=n.Spacing.None,this.bottom=n.Spacing.None,this.left=n.Spacing.None,this.top=t,this.right=e,this.bottom=i,this.left=r};e.PaddingDefinition=s;var a=function(){function t(t,e){this.physicalSize=t,this.unit=e}return t.parse=function(e,i){void 0===i&&(i=!1);var r=new t(0,n.SizeUnit.Weight),o=/^([0-9]+)(px|\*)?$/g.exec(e),s=i?3:2;if(o&&o.length>=s)return r.physicalSize=parseInt(o[1]),3==o.length&&"px"==o[2]&&(r.unit=n.SizeUnit.Pixel),r;throw new Error("Invalid size: "+e)},t}();e.SizeAndUnit=a;
/**
 * Fast UUID generator, RFC4122 version 4 compliant.
 * @author Jeff Ward (jcward.com).
 * @license MIT license
 * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
 **/
var l=function(){function t(){}return t.generate=function(){var e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return t.lut[255&e]+t.lut[e>>8&255]+t.lut[e>>16&255]+t.lut[e>>24&255]+"-"+t.lut[255&i]+t.lut[i>>8&255]+"-"+t.lut[i>>16&15|64]+t.lut[i>>24&255]+"-"+t.lut[63&n|128]+t.lut[n>>8&255]+"-"+t.lut[n>>16&255]+t.lut[n>>24&255]+t.lut[255&r]+t.lut[r>>8&255]+t.lut[r>>16&255]+t.lut[r>>24&255]},t.initialize=function(){for(var e=0;e<256;e++)t.lut[e]=(e<16?"0":"")+e.toString(16)},t.lut=[],t}();e.UUID=l,l.initialize()}}]);
//# sourceMappingURL=owa.MailBoot~ActionableMessageCardWrapper~ActionableMessageMail~OwaBotConversation.js.map
self.scriptsLoaded['owa.MailBoot~ActionableMessageCardWrapper~ActionableMessageMail~OwaBotConversation.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ActionableMessageCardWrapper~ActionableMessageMail~OwaBotConversation.js'] = (new Date()).getTime();