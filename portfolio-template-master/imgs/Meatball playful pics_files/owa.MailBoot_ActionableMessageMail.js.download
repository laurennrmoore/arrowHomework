self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ActionableMessageMail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[522],{10098:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(31),a=new r.c((function(){return Promise.all([n.e(9),n.e(10),n.e(164),n.e(224),n.e(217),n.e(751)]).then(n.bind(null,12136))})),o=new r.b(a,(function(e){return e.openBotConversation})),i=new r.b(a,(function(e){return e.openCortanaConversation}));new r.a(a,(function(e){return e.setEditorInterface}))},1083:function(e,t,n){"use strict";var r=n(1),a=n(20),o=n(642),i=n(0),c=n.n(i);function s(e,t){var n=function(t,n){return c.a.createElement(u,Object(r.a)({},t),c.a.createElement(e,Object(r.a)({},t)))};return n.displayName=e.displayName,t?c.a.forwardRef(n):n}var u=Object(a.a)((function(e){var t=e.lid,n=e.when,r=e.series,a=e.children,i=e.disposeOnUnmount,s=void 0===i||i;return c.a.useEffect((function(){return Object(o.b)(t,n,r),function(){s&&o.c.importAndExecute(t)}}),[]),a&&d(t)?c.a.createElement(c.a.Fragment,null,a):null}));function l(e,t){o.c.importAndExecute(e,t)}function d(e){if(o.d.unseenItems){var t=o.d.unseenItems.get(e);if(null==t?void 0:t.visible)return!0}return!1}function b(e){var t;return null===(t=o.d.unseenItems)||void 0===t?void 0:t.has(e)}n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return o.a}))},1261:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(3),a=n(0),o=n(513),i=n(609),c=n(700),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){return a.createElement(c.a,Object(r.__assign)({},this.props,{primary:!0,onRenderDescription:o.b}))},t=Object(r.__decorate)([Object(i.a)("PrimaryButton",["theme","styles"],!0)],t)}(a.Component)},1294:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(44),a=n(873);function o(e,t){Object.keys(a.a).some((function(n){return a.a[n]==t&&(Object(r.h)(e,{key:n,id:t},{isCore:!0}),!0)}))}},16985:function(e,t,n){var r=n(16986),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},16986:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._2pRM5MH2wQSL6KJYv7DZjH{width:calc(100% - 25px);position:absolute;height:calc(100% - 64px)}html[dir=ltr] ._2pRM5MH2wQSL6KJYv7DZjH{margin-left:-20px;margin-right:-35px}html[dir=rtl] ._2pRM5MH2wQSL6KJYv7DZjH{margin-right:-20px;margin-left:-35px}._36_sivvBA_3QDLOOHcFq0k{width:100%;height:100%}html[dir] ._36_sivvBA_3QDLOOHcFq0k{border-width:0}._3CW7BF2coKNui2HaKAh3Zw{font-size:21px;font-weight:100;font-weight:300;color:"[theme:neutralPrimary, default:#323130]"}',""]),t.locals={opayFlexPaneContainer:"_2pRM5MH2wQSL6KJYv7DZjH",opayAppIFrameStyle:"_36_sivvBA_3QDLOOHcFq0k",flexPaneHeader:"_3CW7BF2coKNui2HaKAh3Zw"}},16987:function(e){e.exports=JSON.parse('{"a":"KAc","c":"LAc","b":"MAc","g":"NAc","f":"OAc","e":"PAc","d":"QAc","h":"RAc","i":"SAc"}')},16988:function(e){e.exports=JSON.parse('{"a":"HAc","b":"IAc","c":"JAc"}')},16989:function(e){e.exports=JSON.parse('{"a":"GAc"}')},16990:function(e){e.exports=JSON.parse('{"d":"CAc","c":"DAc","a":"EAc","b":"FAc"}')},16991:function(e,t,n){var r=n(16992),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},16992:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,"html[dir] ._3uEvU5UAdRqP1z24N4hRkz{margin-top:12px}html[dir=ltr] ._3uEvU5UAdRqP1z24N4hRkz{margin-left:52px}html[dir=rtl] ._3uEvU5UAdRqP1z24N4hRkz{margin-right:52px}.cmC6MemIKYrJJ77Z_ZD4n{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}._3FcySUHYRo6OeOulzvvAzX{-ms-flex-item-align:center;align-self:center;height:16px;line-height:16px}html[dir] ._3FcySUHYRo6OeOulzvvAzX{margin-top:8px}._3FcySUHYRo6OeOulzvvAzX ._36SOH4LiYsn62sG0PC93OB{font-size:8px}",""]),t.locals={container:"_3uEvU5UAdRqP1z24N4hRkz",cardArea:"cmC6MemIKYrJJ77Z_ZD4n",bodyToggleButton:"_3FcySUHYRo6OeOulzvvAzX",icon:"_36SOH4LiYsn62sG0PC93OB"}},18167:function(e,t,n){"use strict";n.r(t);var r=n(4766),a=n(23),o=n(6328),i="CardLinkInteraction";function c(e,t,n,c){a.g.info("[logAdaptiveCardLinkInteraction] Log event captured for link interaction on an adaptive card");var s=Object(r.e)(n);n.card&&s?o.c.logTelemetry({cardDetails:n,eventName:i+"_"+s,messageContext:c}):a.g.warn("[ActionableMessageDebug] logAdaptiveCardLinkInteraction: Cannot log link interaction - message card context is undefined")}var s=n(1),u="00000000-0000-0000-0000-000000000000",l="Highlight_";function d(e){return Object(s.c)(this,void 0,void 0,(function(){var t,n,o,i,c,l,d,p,f,g,h;return Object(s.f)(this,(function(s){switch(s.label){case 0:try{t=JSON.parse(e)}catch(t){throw new Error("[ActionableMessageCard] parseCardProperty: unable to parse card data: "+e)}return n={smtpAddressesSerialized:t.SmtpAddressesSerialized,providerAccountUniqueId:t.ProviderAccountUniqueId,messageCardExtensionContext:t.MessageCardExtensionContext},o=[],t.AdaptiveCardV2Serialized?(c=(i=o).push,[4,r.f.import().then((function(e){return e(n,t.ConnectorSenderGuidV2?t.ConnectorSenderGuidV2:u,t.AdaptiveCardSerializedV2,t.AdaptiveCardSignatureV2,!0)}))]):[3,2];case 1:c.apply(i,[s.sent()]),s.label=2;case 2:return t.AdaptiveCardSerialized?(d=(l=o).push,[4,r.f.import().then((function(e){return e(n,t.ConnectorSenderGuid?t.ConnectorSenderGuid:u,t.AdaptiveCardSerialized,t.AdaptiveCardSignature,!0)}))]):[3,4];case 3:return d.apply(l,[s.sent()]),[3,7];case 4:return t.MessageCardSerialized?(f=(p=o).push,[4,r.f.import().then((function(e){return e(n,t.ConnectorSenderGuid?t.ConnectorSenderGuid:u,t.MessageCardSerialized,t.MessageCardSignature,!1)}))]):[3,6];case 5:return f.apply(p,[s.sent()]),[3,7];case 6:return a.g.info("[ActionableMessageCard] parseCardProperty: No serialized card present"),[2,[]];case 7:return h=(g=o).concat,[4,b(t,n)];case 8:return[2,h.apply(g,[s.sent()])]}}))}))}function b(e,t){return Object(s.c)(this,void 0,void 0,(function(){var n,o=this;return Object(s.f)(this,(function(i){switch(i.label){case 0:return n=[],[4,Promise.all(Object.keys(e).map((function(i){return Object(s.c)(o,void 0,void 0,(function(){var o,c,d,b;return Object(s.f)(this,(function(s){switch(s.label){case 0:if(!e.hasOwnProperty(i)||0!==i.indexOf(l))return[3,4];o=e[i],s.label=1;case 1:return s.trys.push([1,3,,4]),c=JSON.parse(o),[4,r.f.import().then((function(n){return n(t,e.ConnectorSenderGuid?e.ConnectorSenderGuid:u,c.card,null)}))];case 2:return(d=s.sent()).isContextual=!0,d.key=c.id,d.highlightTerm=c.text,n.push(d),[3,4];case 3:return b=s.sent(),a.g.warn("[ActionableMessageDebug] RenderCard: unable to render hightlight card: "+b.message),[3,4];case 4:return[2]}}))}))})))];case 1:return i.sent(),[2,n]}}))}))}var p=n(2045),f=n(3681),g=n(981),h=n(180),m="IOpenTypedFacet.Com.Microsoft.Graph.MessageCard",v="E550B918-9859-47B9-8095-97E4E72F1926";function y(e){return Object(s.c)(this,void 0,void 0,(function(){var t,n,r;return Object(s.f)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),t=Object(g.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(h.a)(v,m,"String")]}),[4,Object(p.a)(e.ItemId.Id,t)];case 1:return!(n=o.sent())||n instanceof Error?[3,3]:(r=Object(f.a)(n,null,m))?[4,d(r)]:[3,3];case 2:return[2,o.sent()];case 3:return[3,5];case 4:return o.sent(),[3,5];case 5:return a.g.info("[loadCardDetailsForItem] extendedProperty could not be retrieved"),[2,null]}}))}))}function O(e){return Object(s.c)(this,void 0,void 0,(function(){return Object(s.f)(this,(function(t){switch(t.label){case 0:return e.adaptiveCardDetails?[2,e.adaptiveCardDetails]:[4,y(e)];case 1:return[2,t.sent()||[]]}}))}))}var C,j,A=n(0),S=n(20),x=n(121),I=n(5),w=n(24),k=n(3292),M=n(2547),T=function(e){function t(t){var n=e.call(this)||this;return n.preserveBody=t,n}return Object(s.e)(t,e),t.prototype.internalPrepareForExecution=function(t){var n=this.body;e.prototype.internalPrepareForExecution.call(this,t),this.preserveBody&&(this.body=n)},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t}(M.HttpAction),E=n(2);!function(e){e[e.UnResolved=0]="UnResolved",e[e.InProgress=1]="InProgress",e[e.Resolved=2]="Resolved"}(C||(C={})),function(e){e[e.Empty=0]="Empty",e[e.Success=1]="Success",e[e.Error=2]="Error"}(j||(j={}));var D,P,B={cache:{data:null,state:j.Empty,time:null},requestState:C.UnResolved},N=Object(E.createStore)("amClientConfigurationStore",B)(),R=function(){var e,t,n=null;return(null===(t=null===(e=N.cache.data)||void 0===e?void 0:e.clientTimeouts)||void 0===t?void 0:t.default)&&(n=N.cache.data.clientTimeouts.default),n},F=n(6),H=n(8362),U=n(10127),_=n(65),L=n(93),q=n(19),z=n(11);!function(e){e[e.Empty=0]="Empty",e[e.Success=1]="Success",e[e.Error=2]="Error"}(D||(D={})),function(e){e[e.UnResolved=0]="UnResolved",e[e.InProgress=1]="InProgress",e[e.Resolved=2]="Resolved"}(P||(P={}));var J={cache:{data:{Url:"/actions"},state:D.Empty,time:null},requestState:P.UnResolved},W=Object(E.createStore)("amActionEndpointStore",J)(),G=function(){return!!Object(z.c)(window)&&!!Object(z.a)(window,"ActionableMessages.ActionEndpoint")},V=function(){return Object(w.i)("rp-actionableMessagesAutoD")?W.cache.data.Url:"/actions"},Y=function(e,t,n,r,a){var i=e["@id"]?e["@id"]:e.id,c={"@type":"HttpPOST",name:e.title,target:e.url,body:e.body,"@id":i,hideCardOnInvoke:e.hideCardOnInvoke,isPrimaryAction:!!e.isPrimary&&e.isPrimary};e.headers&&e.headers.length>0&&(c.headers=e.headers);var u=Object(q.a)(),l=[];if(t)for(var d=0;d<t.length;d++){var b=t[d],p=new M.ValidationResults;if(b.internalValidateProperties(p),p.failures.length>0)return Promise.resolve({success:!1,displayMessage:p.failures[0].errors[0].message});if(b){var f=void 0;f="Input.Date"===b.getJsonTypeName()?{id:b.id,value:b.value,usertimezone:u.UserOptions.TimeZone}:{id:b.id,value:b.value},l.push(f)}}var g,h={type:M.HttpAction.JsonTypeName,url:e.url,body:e.body,method:e.method,id:e.id?e.id:"30d2f5e2-6e6f-43b0-a2bd-c9d87a5cd6fd",headers:e.headers},m=u.SessionSettings.UserCulture,v={type:e.getJsonTypeName(),id:e.id},y={eventName:K(e,a),messageContext:r,cardDetails:n,elementDetails:v,actionContext:e.actionContext},O=Object(o.b)(y);if(O.messageCardContext)try{O.messageCardContext=JSON.parse(O.messageCardContext)}catch(e){}if(O.messageCardExtensionContext)try{O.messageCardExtensionContext=JSON.parse(O.messageCardExtensionContext)}catch(e){}if(O.actionContext)try{O.actionContext=JSON.parse(O.actionContext)}catch(e){}return n.isAdaptiveCard?g={httpAction:h,inputParameters:l,connectorSenderGuid:n.connectorSenderGuid,SmtpAddressesSerialized:n.smtpAddressesSerialized,adaptiveCardSignature:n.cardSignature,providerAccountUniqueId:n.providerAccountUniqueId,clientTelemetry:O,adaptiveCardHash:n.cardHash,senderAddress:r.senderAddress}:(c=Object(s.a)(Object(s.a)({},e.originalJsonPayload),c),g={inputParameters:l,connectorSenderGuid:n.connectorSenderGuid,potentialAction:JSON.stringify(c),SmtpAddressesSerialized:n.smtpAddressesSerialized,messageCardSignature:n.cardSignature,providerAccountUniqueId:n.providerAccountUniqueId,clientTelemetry:O,tenantObjectId:u.SessionSettings.ExternalDirectoryTenantGuid,messageCardHash:n.cardHash,senderAddress:r.senderAddress,culture:m,uiCulture:m}),X(Q(r,m,n.isAdaptiveCard),JSON.stringify(g),"HttpAction",null,te(n),a)},K=function(e,t){return t?"AutoInvokeActionClicked":e.parent&&"InlineAdaptiveCard"===e.parent.constructor.name?"ActionCardHttpPostActionClicked":"SingleClickHttpPostActionClicked"},Q=function(e,t,n){var r="UserMailbox"===e.mailboxInfo.type?"userid":e.mailboxInfo.mailboxSmtpAddress,a=e.odataItemId,o=e.odataConversationId,i=V();switch(e.mailboxInfo.type){case"UserMailbox":return n?Object(F.c)("{0}/{1}/messages/{2}/adaptiveCard/executeAction?culture={3}",i,r,a,t):Object(F.c)("{0}/{1}/messages/{2}/executeAction?culture={3}",i,r,a,t);case"GroupMailbox":case"TeamsMailbox":return n?Object(F.c)("{0}/{1}/threads/{2}/posts/{3}/adaptiveCard/executeAction?culture={4}",i,r,o,a,t):Object(F.c)("{0}/{1}/threads/{2}/posts/{3}/executeAction?culture={4}",i,r,o,a,t);case"PublicMailbox":case"SharedMailbox":case"ArchiveMailbox":return null}},X=function(e,t,n,r,o,i){return void 0===i&&(i=!1),Object(s.c)(void 0,void 0,void 0,(function(){var c,u,l,d;return Object(s.f)(this,(function(s){switch(s.label){case 0:c=r||Object(L.b)(),u={correlationVector:c,cardCorrelationId:o,requestType:n},s.label=1;case 1:return s.trys.push([1,5,,6]),[4,Object(k.a)()];case 2:return(l=s.sent())?[3,4]:(a.g.warn("[ActionableMessageDebug] makePostRequest: Unable to get the client Auth token possibly AAD token"),[4,Object(k.b)()]);case 3:l=s.sent(),s.label=4;case 4:if(!l)throw new Error("Token is empty: "+l);return[3,6];case 5:return d=s.sent(),a.g.warn("[ActionableMessageDebug] makePostRequest: Error while getting token, error: "+d),Object(x.q)("ActionableMessageConnectorsPostRequestErrorGettingToken",void 0,void 0,d,u,{isCore:!0}),[2,{success:!1,displayMessage:Object(F.b)(H.a)}];case 6:return[2,Z(e,l,t,i,c,u)]}}))}))},Z=function(e,t,n,r,a,o){return new Promise((function(i){var c=new XMLHttpRequest;c.onreadystatechange=function(){4===c.readyState&&i($(200===c.status,c.responseText))},c.ontimeout=function(){i({success:!1,displayMessage:Object(F.b)(H.a)}),Object(x.q)("ActionableMessageConnectorsPostRequestTimeout",void 0,void 0,void 0,o,{isCore:!0})},c.open("POST",e,!0),c.timeout=function(e){var t=e?6e3:1e4,n=R();return e&&(null==n?void 0:n.AutoInvokedActionTimeoutInMsec)?t=n.AutoInvokedActionTimeoutInMsec:!e&&(null==n?void 0:n.HttpActionTimeoutInMsec)&&(t=n.HttpActionTimeoutInMsec),t}(r),c.setRequestHeader("MS-CV",a),c.setRequestHeader("X-OWA-CANARY",Object(_.a)()),c.setRequestHeader("Authorization","Bearer "+t),c.send(n)}))},$=function(e,t){try{var n=JSON.parse(t),r=!!e&&ee(n.status);return{success:r,status:n.status,displayMessage:n.displayMessage?n.displayMessage:r?Object(F.b)(U.a):Object(F.b)(H.a),performedAt:n.performedAt,newCardPayload:n.refreshCardSerialized,newCardSignature:n.refreshCardSignature,removeCard:n.removeCard,showOriginalCard:n.showOriginalCard,hideCard:n.hideCard,authenticationUrl:n.authenticationUrl,cardUpdates:n.cardUpdates,errors:n.errors}}catch(e){return{success:!1,displayMessage:Object(F.b)(H.a)}}},ee=function(e){return e&&"completed"===e.toLowerCase()},te=function(e){try{return e.card.messageCardContext.correlationId}catch(e){return""}};function ne(e){var t=new T(!0);return t.method="POST",t.body=e.body,t.title=e.name,t.originalJsonPayload=e,e.headers&&e.headers.length>0&&(t.headers=[],e.headers.forEach((function(e){t.headers.push(new M.HttpHeader(e.name,e.value))}))),t.url=e.target,t["@id"]=e["@id"],t.hideCardOnInvoke=e.hideCardOnInvoke,t}var re="HttpPOST";var ae=n(197);var oe="{0}{1}/theme";function ie(e){return void 0===e&&(e="default"),Object(s.c)(this,void 0,void 0,(function(){var t,n,r,a,i,c,u;return Object(s.f)(this,(function(s){switch(s.label){case 0:return[4,Object(k.b)()];case 1:t=s.sent(),n=function(e,t){var n={},r=Object(o.a)();return r=r.replace(/[^\d]/g,""),n.method="GET",n.headers=new Headers,n.headers.set("X-ClientType","owa"),n.headers.set("X-ClientVersion","16."+r.substr(0,4)+"."+r.substr(4,4)+"."+r.substr(8)),n.headers.set("X-ClientColorScheme",t),n.headers.set("Authorization","Bearer "+e),n}(t,e),r=Object(F.c)(oe,window.location.origin,V()),a=void 0,s.label=2;case 2:return s.trys.push([2,7,,8]),[4,fetch(r,n)];case 3:return(i=s.sent())&&200==i.status?(c=ce,[4,i.text()]):[3,5];case 4:return[2,c.apply(void 0,[s.sent()])];case 5:a=i?i.status+"-"+i.statusText:"No response",s.label=6;case 6:return[3,8];case 7:return u=s.sent(),a=u.message,[3,8];case 8:throw a}}))}))}function ce(e){var t={};try{var n=JSON.parse(e).connectors;Object.keys(n).forEach((function(e){var r={themeConfigUrl:n[e],hostConfig:null,stylesheetUrl:null,isResolved:!1};t[e]=r}))}catch(e){a.g.warn("[ActionableMessageDebug] downloadThemeDefinition: error parsing response: "+e)}return t}var se=function(){return!!Object(z.c)(window)&&!!Object(z.a)(window,"ActionableMessages.ClientConfiguration")},ue=function(){return N.cache.state!==j.Empty},le=function(){var e,t,n,r=Date.now()-N.cache.time;return N.cache.state===j.Success&&r>=432e6||N.cache.state===j.Error&&r>=864e5||(n=null===(t=null===(e=N.cache.data)||void 0===e?void 0:e.themeMappings)||void 0===t?void 0:t.connectors,Object(w.i)("rp-actionableMessagesThemeConfig")&&N.cache.state===j.Success&&null===n)},de=Object(E.mutatorAction)("updateRequestState",(function(e){N.requestState=e})),be=n(209),pe=function(){return Object(s.c)(void 0,void 0,void 0,(function(){var e,t,n,r;return Object(s.f)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),i=Object(be.c)(),c=Object(o.a)(),e=V()+"/v1.0/"+i+"/clientConfigs/WAC_Outlook_React?clientVersion="+c+"&clientColorScheme=default&$expand=providerConfigs",[4,Object(s.c)(void 0,void 0,void 0,(function(){var e,t;return Object(s.f)(this,(function(n){switch(n.label){case 0:return e=new Headers,[4,Object(k.a)()];case 1:return t=n.sent(),e.set("Authorization",function(e){return"Bearer "+e}(t)),e.set("MS-CV",Object(L.b)()),[2,e]}}))}))];case 1:return t=a.sent(),n=new Request(e,{method:"GET",headers:t}),[4,fetch(n)];case 2:return(r=a.sent()).ok?[4,r.json()]:[3,4];case 3:return[2,a.sent()];case 4:throw r;case 5:return[3,7];case 6:throw a.sent();case 7:return[2]}var i,c}))}))},fe=Object(E.mutatorAction)("setClientConfiguration",(function(e){N.cache=e})),ge=function(){return N.cache},he=function(e){var t,n,r,a;void 0===e&&(e=!1);var o,i=ge();if(o=e?null===(n=null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.themeMappingsDarkMode)||void 0===n?void 0:n.connectors:null===(a=null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.themeMappings)||void 0===a?void 0:a.connectors){var c={};return Object.keys(o).forEach((function(e){var t={themeConfigUrl:o[e],hostConfig:null,stylesheetUrl:null,isResolved:!1};c[e]=t})),c}return null},me=function(e,t){void 0===t&&(t=null);var n={data:t,state:e,time:Date.now()};if(null===t){var r=ge();n.data=r.data}return n},ve=Object(E.action)("loadClientConfiguration");Object(E.orchestrator)(ve,(function(){return Object(s.c)(void 0,void 0,void 0,(function(){var e,t,n;return Object(s.f)(this,(function(o){switch(o.label){case 0:de(C.InProgress),e=null,o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,pe()];case 2:return t=o.sent(),e=me(j.Success,t),[3,5];case 3:return o.sent(),e=me(j.Error),[3,5];case 4:return fe(e),function(e){if(Object(z.c)(window))try{Object(z.e)(window,"ActionableMessages.ClientConfiguration",JSON.stringify(e))}catch(e){a.g.info("[ActionableMessageDebug] owa-actionable-message-connectors loadClientConfiguration setClientConfigurationInLocalStorage Exception on setItem|JSON.stringify "+e.toString())}}(e),de(C.Resolved),Object(w.i)("rp-actionableMessagesThemeConfig")&&(n=he(),Object(r.g)(n)),[7];case 5:return[2]}}))}))}));var ye=ve,Oe=function(){N.requestState!==C.InProgress&&ye()},Ce=function(){return se()?JSON.parse(Object(z.a)(window,"ActionableMessages.ClientConfiguration")):null},je=function(){return W.cache.state!==D.Empty},Ae=function(){var e=Date.now()-W.cache.time;return W.cache.state===D.Success&&e>=432e6||W.cache.state===D.Error&&e>=864e5},Se=Object(E.mutatorAction)("updateActionEndpointRequestState",(function(e){W.requestState=e})),xe=function(){return Object(s.c)(void 0,void 0,void 0,(function(){var e,t,n;return Object(s.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),e="/autodiscover/autodiscover.json/v1.0/"+Object(be.c)()+"?Protocol=Actions",t=new Request(e,{method:"GET"}),[4,fetch(t)];case 1:return(n=r.sent()).ok?[4,n.json()]:[3,3];case 2:return[2,r.sent()];case 3:throw n;case 4:return[3,6];case 5:throw r.sent();case 6:return[2]}}))}))},Ie=Object(E.mutatorAction)("setActionEndpoint",(function(e){W.cache=e})),we=function(e,t){void 0===t&&(t=null);var n=W.cache.data;return(null==t?void 0:t.Url)?n.Url="/"+t.Url.split("/").pop():e=D.Error,{data:n,state:e,time:Date.now()}},ke=Object(E.action)("loadActionEndpoint");Object(E.orchestrator)(ke,(function(){return Object(s.c)(void 0,void 0,void 0,(function(){var e,t;return Object(s.f)(this,(function(n){switch(n.label){case 0:Se(P.InProgress),e=null,n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,xe()];case 2:return t=n.sent(),e=we(D.Success,t),[3,5];case 3:return n.sent(),e=we(D.Error),[3,5];case 4:return Ie(e),function(e){if(Object(z.c)(window))try{Object(z.e)(window,"ActionableMessages.ActionEndpoint",JSON.stringify(e))}catch(e){a.g.info("[ActionableMessageDebug] owa-actionable-message-connectors loadActionEndpoint setActionEndpointInLocalStorage Exception on setItem|JSON.stringify "+e.toString())}}(e),Se(P.Resolved),[7];case 5:return[2]}}))}))}));var Me=ke,Te=function(){W.requestState!==P.InProgress&&Me()},Ee=function(){je()?Ae()&&Te():G()?(Ie(G()?JSON.parse(Object(z.a)(window,"ActionableMessages.ActionEndpoint")):null),Se(P.Resolved),Ae()&&Te()):Te()},De=function(){return null!==ge().data},Pe=function(){if(Object(w.i)("rp-actionableMessagesAutoD")&&Ee(),ue())return le()&&Oe(),De();if(se()){if(fe(Ce()),de(C.Resolved),le()&&Oe(),Object(w.i)("rp-actionableMessagesThemeConfig")){var e=he();Object(r.g)(e)}return De()}return Oe(),!1},Be=function(){var e,t,n=!1;if(Pe()){var r=ge();(null===(t=null===(e=null==r?void 0:r.data)||void 0===e?void 0:e.organizationConfigs)||void 0===t?void 0:t.SmtpActionableMessagesEnabled)&&(n=!0)}return n},Ne=function(e,t){var n,r,a=!1;try{for(var o=Object(s.k)(e),i=o.next();!i.done;i=o.next()){if(i.value.originator===t){a=!0;break}}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a},Re=function(e,t){var n,r,a=!1;if(Pe()){var o=ge();!t&&(null===(n=null==o?void 0:o.data)||void 0===n?void 0:n.providerConfigs)?a=Ne(o.data.providerConfigs,e):t&&(null===(r=null==o?void 0:o.data)||void 0===r?void 0:r.providerConfigsDarkMode)&&(a=Ne(o.data.providerConfigsDarkMode,e))}return a},Fe="data:",He="blob:";function Ue(e,t,n){var r=e.querySelectorAll('img:not([src^="cid:"])');if(r)for(var a=0;a<r.length;a++)0!==r[a].src.indexOf(Fe)&&0!==r[a].src.indexOf(He)&&_e(r[a],t.mailboxSmtpAddress,n)}function _e(e,t,n){return Object(s.c)(this,void 0,void 0,(function(){var r,o;return Object(s.f)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Le(V()+"/"+t+"/th?u="+encodeURIComponent(e.src),t,n)];case 1:return r=i.sent(),e.src=r,[3,3];case 2:return o=i.sent(),a.g.warn("[ActionableMessageDebug] fixSrcForExternalImage: Error setting src value. Exception: "+o.message),[3,3];case 3:return[2]}}))}))}function Le(e,t,n){return Object(s.c)(this,void 0,void 0,(function(){var r=this;return Object(s.f)(this,(function(a){return[2,new Promise((function(a,o){return Object(s.c)(r,void 0,void 0,(function(){var r,i;return Object(s.f)(this,(function(c){switch(c.label){case 0:return[4,Object(k.b)()];case 1:return(r=c.sent())?((i=new XMLHttpRequest).open("GET",e),i.responseType="blob",i.setRequestHeader("Authorization","Bearer "+r),i.setRequestHeader("X-AnchorMailbox",t),n&&i.setRequestHeader("X-OriginatorId",n),i.onreadystatechange=function(){if(4===i.readyState)try{var e=function(e){try{if(200==e.status){var t=e.response,n=e.getResponseHeader("Content-Type");if(n&&0===n.toLowerCase().indexOf("image")&&t instanceof Blob)return URL.createObjectURL(t)}}catch(e){throw e}return null}(i);a(e)}catch(e){o(e)}},i.send()):o(new Error("token not generated")),[2]}}))}))}))]}))}))}var qe=function(e){return["https://outlook.office365.com","https://outlook.office.com","https://outlook-sdf.office.com","https://outlook-sdf.office365.com","https://emea.mail.microsoft.com","https://outlook-sdf.live.com","https://outlook.live.com"].includes(e)},ze=function(e){var t,n,r=V(),a="UserMailbox"!==(null===(t=e.mailboxInfo)||void 0===t?void 0:t.type)?null===(n=e.mailboxInfo)||void 0===n?void 0:n.mailboxSmtpAddress:"userid",o=e.odataItemId;return Object(F.c)("{0}/{1}/messages/{2}/adaptiveCardV2/action",r,a,o)},Je=function(){var e,t,n,r=null;return(null===(n=null===(t=null===(e=N.cache.data)||void 0===e?void 0:e.clientTimeouts)||void 0===t?void 0:t.default)||void 0===n?void 0:n.SnackBarTimeoutInMsec)&&(r=N.cache.data.clientTimeouts.default.SnackBarTimeoutInMsec),null!==r?r:8e3},We=function(){var e,t,n,r=null;return(null===(n=null===(t=null===(e=N.cache.data)||void 0===e?void 0:e.clientTimeoutsACv2)||void 0===t?void 0:t.default)||void 0===n?void 0:n.SnackBarTimeoutInMsec)&&(r=N.cache.data.clientTimeoutsACv2.default.SnackBarTimeoutInMsec),null!==r?r:8e3},Ge=function(){var e,t,n=null;return(null===(t=null===(e=N.cache.data)||void 0===e?void 0:e.clientTimeoutsACv2)||void 0===t?void 0:t.default)&&(n=N.cache.data.clientTimeoutsACv2.default),n},Ve={registerActions:function(){M.AdaptiveCard.actionTypeRegistry.unregisterType(M.SubmitAction.JsonTypeName),M.AdaptiveCard.actionTypeRegistry.registerType(M.HttpAction.JsonTypeName,(function(){return new T(!1)}))},executeAction:function(e,t,n,r,o,i,c){return e instanceof T&&(Y(e,n,t,o,c).then((function(e){a.g.info("[ActionableMessageDebug] onExecuteAction: executeHttpAction response: "+e),r(e)})),!0)},parseLegacyMessageCardAction:function(e,t){switch(e["@type"]){case"HttpPOST":return ne(e)}return null},processAutoInvokeAction:function(e,t){if(e.type===M.HttpAction.JsonTypeName||e["@type"]===re){var n=void 0;return t.isAdaptiveCard?((n=new T(!1)).parse(e),n.hideCardOnInvoke=e.hideCardOnInvoke):n=ne(e),n}return null},registerHostCapabilities:function(e){Object(w.i)("rp-actionableMessages-aad-token")&&!Object(ae.a)()&&(e.AADAuthentication="*")}},Ye="TransactionCardDisabled",Ke="messageCardContext";var Qe="Action.Transaction",Xe=n(2494),Ze=n(2954),$e=n(16985),et={PPE:"https://interactive-ppe.outlook.com/ux/app",PROD:"https://interactive.outlook.com/ux/app",DEV:"https://opay-dev-wc-svc.cloudapp.net/ux/app"},tt=function(e){function t(){var t=e.call(this)||this;return t.environment="prod",t.triggerContext=null,t.intent="",t.merchantId="",t.displayId="",t}return Object(s.e)(t,e),t.prototype.getJsonTypeName=function(){return Qe},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,t.initializationContext?(this.intent=t.initializationContext.intent,this.merchantId=t.initializationContext.merchantId,this.displayId=t.initializationContext.displayId,this.productContext=t.initializationContext.productContext,this.environment=t.initializationContext.environment):(this.intent=t.intent,this.merchantId=t.merchantId,this.displayId=t.displayId,this.productContext=t.productContext,this.environment=t.environment),this.triggerContext={MerchantId:this.merchantId,DisplayId:this.displayId,CorrelationId:Object(L.b)(),Culture:Object(q.a)().SessionSettings.UserCulture,Market:Object(Xe.f)(),Environment:this.environment},Ze.set("DefaultAnchorMailbox",Ze.get("DefaultAnchorMailbox"),{path:"/actions/"}),Object(w.i)("ring-dogfood")&&Ze.set("DefaultAnchorMailbox",Ze.get("DefaultAnchorMailbox"),{path:"/opay/"})},t.prototype.execute=function(){e.prototype.execute.call(this),this.triggerContext.CorrelationId=Object(L.b)()},t.prototype.getIFrameElement=function(){var e=Object(w.i)("rp-opay-modelb-endpoint")?window.location.origin+"/opay":this.getSvcEndpoint(),t=encodeURIComponent(JSON.stringify(this.productContext)),n=e+"/?triggerContext="+encodeURIComponent(JSON.stringify(this.triggerContext))+"&productContext="+t;return A.createElement("div",{className:$e.opayFlexPaneContainer},A.createElement("iframe",{id:"opay_iframe",className:$e.opayAppIFrameStyle,src:n}))},t.prototype.getSvcEndpoint=function(){return this.environment?0===this.environment.indexOf("dev")?et.DEV:"ppe"===this.environment.toLowerCase()?et.PPE:et.PROD:et.PROD},t}(M.Action),nt={shouldShowModalFlexPane:!1,modalFlexPaneContent:void 0},rt=Object(E.createStore)("OPayPanel",nt)(),at=Object(E.mutatorAction)("SHOW_OPAY_PANEL",(function(e){rt.shouldShowModalFlexPane=!0,rt.modalFlexPaneContent=e})),ot="TransactionActionEvent",it="actionContext";var ct={registerActions:function(){M.AdaptiveCard.actionTypeRegistry.registerType(Qe,(function(){return new tt}))},executeAction:function(e,t,n,r,o,i,c){if(!(e instanceof tt))return!1;a.g.info("[ActionableMessageDebug] Transaction executed");var s=e,u={id:s.id,type:s.getJsonTypeName()};return i.logTelemetry({cardDetails:t,elementDetails:u,eventName:ot,actionContext:e[it],messageContext:o}),at(s.getIFrameElement()),!0},parseLegacyMessageCardAction:function(e,t){switch(e["@type"]){case"Transaction":return n=e,(r=new tt).parse(n),r.title=n.name,r}var n,r;return null},registerHostCapabilities:function(e){e.Transaction="*",e["Transaction.MSA"]="*"}},st=n(3977),ut=n(1937),lt=n(446),dt=n(2188),bt=Object(E.mutatorAction)("HIDE_OPAY_PANEL",(function(){rt.shouldShowModalFlexPane=!1,rt.modalFlexPaneContent=void 0})),pt=Object(S.a)((function(e){return Object(dt.a)("message",(function(t){var n=t.origin.toLowerCase();if(Object.keys(et).some((function(e){return 0!==et[e].indexOf(n)}))){var r=null;try{r=JSON.parse(t.data)}catch(e){a.g.warn("Unable to parse post message data: "+t.data)}if(r){var o=r.action;if(o)switch(o){case"close":bt();break;case"token":Object(k.a)().then((function(t){var r=document.querySelector("#opay_iframe");r&&r.contentWindow.postMessage(JSON.stringify({action:"token",token:t,messageContext:{messageId:e.odataItemId,smtpAddressesSerialized:e.smtpAddressesSerialized},result:"Success"}),n)})).catch((function(){window.postMessage(JSON.stringify({action:"token",result:"Failed"}),n)}))}}}})),A.createElement(ut.a,{key:"modalFlexPane",onDismiss:function(){bt()},isOpen:rt.shouldShowModalFlexPane,type:lt.a.smallFixedFar,closeButtonAriaLabel:Object(F.b)(st.a)},rt.modalFlexPaneContent)})),ft=Object(E.mutatorAction)("addCardDetailsOnItem",(function(e,t){e.adaptiveCardDetails&&e.adaptiveCardDetails.length>0?a.g.info("[ActionableMessageDebug] addCardDetailsOnItem - item already has a card details"+e.adaptiveCardDetails):e.adaptiveCardDetails=t})),gt=Object(E.mutatorAction)("updateCardDetailsOnItem",(function(e,t){e.adaptiveCardDetails=t})),ht=Object(E.mutatorAction)("SET_SHOW_BODY_WITH_MESSAGE_CARD",(function(e,t){e?e.showBodyWithMessageCard=t:a.g.warn("[ActionableMessageDebug] setShowBodyWithMessageCard: viewState undefined")})),mt=Object(E.action)("showCardLoading",(function(e,t){return{viewState:e,showCardLoading:t}})),vt=(Object(E.mutator)(mt,(function(e){e.viewState.showCardLoading=e.showCardLoading})),n(2704)),yt=n(1992),Ot=n(8995),Ct=/url\("(.*)"\)/g,jt=new Ot.a(5,5e3),At=function(e,t,n){var r=e.querySelectorAll('img[src^="cid:"]');if(r)for(var a=0;a<r.length;a++)St(r[a],t,n);var o=e.querySelectorAll("div[style*='background-image: url(\"cid:']");if(o)for(a=0;a<o.length;a++)xt(o[a],t,n)},St=function(e,t,n){if(e.src&&0===e.src.indexOf("cid:")){e.classList.add("ac-hidden");var r=It(e.src,t,n);if(r){e.onload=function(t){e.classList.remove("ac-hidden"),jt.processNextRequest()},e.onerror=function(t){var n=t.target;0===n.src.indexOf("cid:")?a.g.info("[ActionableMessageDebug] imageSrcChangePending: image src has not been changed for cid: "+n.src):(e.classList.remove("ac-hidden"),jt.processNextRequest(),a.g.info("[ActionableMessageDebug] imageSrcError: image cannot be loaded for src: "+n.src))},jt.registerCallback((function(t){t||(e.src=r)}))}}},xt=function(e,t,n){var r=e.style.backgroundImage,a=Ct.exec(r);if(a&&a.length>1&&a[1]){var o=It(a[1],t,n);o&&(e.style.backgroundImage=Object(F.c)('url("{0}")',o))}},It=function(e,t,n){if(!t.Attachments)return null;for(var r,o=wt(e.substring("cid:".length)),i=0;i<t.Attachments.length;i++){var c=t.Attachments[i];if(o===wt(c.Name)||o===wt(c.ContentId)){r=c.AttachmentId;break}}if(!r)return a.g.warn("[ActionableMessageDebug] fixSrcForImage: attachment id not found for cid: "+o),null;var u=Object(vt.b)(Object(s.a)(Object(s.a)({},r),{mailboxInfo:n}),1);return u||(a.g.warn("[ActionableMessageDebug] fixSrcForImage: could not create attachment url for image with cid: "+o+" and attachment id: "+r),null)},wt=function(e){if(Object(yt.g)(e)){var t=Object(yt.b)(e);return e.substring(0,e.length-t.length)}return e},kt=n(9567),Mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.e)(t,e),t.prototype.getJsonTypeName=function(){return"DisplayAppointmentForm"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.itemId=t.itemId,this.isPrimary=t.isPrimary},t}(M.Action),Tt="Action.InvokeAddInCommand",Et="Action.PinAddInCommand",Dt="Action.DisplayReplyAllForm",Pt="Action.DisplayAppointmentForm",Bt="Action.DisplayMessageForm",Nt="Action.StartBotConversation",Rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.e)(t,e),t.prototype.getJsonTypeName=function(){return Bt},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.itemId=t.itemId,this.isPrimary=t.isPrimary},t}(M.Action),Ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.e)(t,e),t.prototype.getJsonTypeName=function(){return"DisplayReplyAllForm"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary},t}(M.Action),Ht=function(e){function t(){var t=e.call(this)||this;return t.addinId="",t.desktopCommandId="",t.initializationContext="",t}return Object(s.e)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.addinId=t.addInId?t.addInId:t.addinid,this.desktopCommandId=t.desktopCommandId?t.desktopCommandId:t.desktopcommandid,this.initializationContext=t.initializationContext?JSON.stringify(t.initializationContext):JSON.stringify(t.initializationcontext)},t.prototype.getJsonTypeName=function(){return Tt},t}(M.Action),Ut=function(e){function t(){var t=e.call(this)||this;return t.productId="",t.newPinnedStatus=!1,t}return Object(s.e)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.productId=t.productId,this.newPinnedStatus=t.newPinnedStatus},t.prototype.getJsonTypeName=function(){return Et},t}(M.Action),_t=function(e){function t(){var t=e.call(this)||this;return t.botId="",t.initialMessage="",t.botName="",t}return Object(s.e)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isPrimary=t.isPrimary,this.botId=t.botId,this.botName=t.botName,this.initialMessage=t.initialMessage},t.prototype.getJsonTypeName=function(){return Nt},t}(M.Action),Lt=n(2018),qt=n(2083),zt=n(1080),Jt=n(10098),Wt=n(2112),Gt=n(3697),Vt=n(8574),Yt=n(2001),Kt=n(2063),Qt="MessageCardInvokeAddinCommandClicked",Xt="MessageCardPinAddinCommandClicked",Zt="DisplayAppointmentFormClicked",$t="DisplayMessageFormClicked",en="actionContext";var tn={registerActions:function(){M.AdaptiveCard.actionTypeRegistry.registerType(Tt,(function(){return new Ht})),M.AdaptiveCard.actionTypeRegistry.registerType(Et,(function(){return new Ut})),M.AdaptiveCard.actionTypeRegistry.registerType(Dt,(function(){return new Ft})),M.AdaptiveCard.actionTypeRegistry.registerType(Pt,(function(){return new Mt})),M.AdaptiveCard.actionTypeRegistry.registerType(Bt,(function(){return new Rt})),Object(w.i)("mc-botConversation")&&M.AdaptiveCard.actionTypeRegistry.registerType(Nt,(function(){return new _t}))},executeAction:function(e,t,n,r,o,i,c){var u={id:e.id,type:e.getJsonTypeName()},l={cardDetails:t,elementDetails:u,messageContext:o,actionContext:e[en],eventName:void 0};if(e instanceof Ft){a.g.info("[ActionableMessageDebug] onExecuteAction: reply all with: "+e.title);var d=Yt.HtmlSanitizer.sanitizeHtml(e.title);Wt.p.importAndExecute({referenceItemId:{Id:o.itemId,mailboxInfo:o.mailboxInfo},isReplyAll:!0,useFullCompose:!1,actionSource:"Link",instrumentationContexts:null,conversationId:o.conversationId,body:d})}else if(e instanceof Mt){a.g.info("[ActionableMessageDebug] onExecuteAction: display appointment form for itemId: "+e.itemId),l.eventName=Zt,i.logTelemetry(l);var b="/calendar/item/"+encodeURIComponent(e.itemId);window.open(b,"_blank")}else if(e instanceof Rt)a.g.info("[AdaptiveCard] DisplayMessageFormAction executed"),l.eventName=$t,i.logTelemetry(l),Object(Gt.a)(e.itemId);else if(e instanceof Ut&&Object(w.i)("addin-pinThroughAM")){a.g.info("[AdaptiveCard] PinAddinCommandAction executed"),l.eventName=Xt,i.logTelemetry(l),function(e){var t,n,r=Object(Kt.r)().Extensions;try{for(var a=Object(s.k)(r),o=a.next();!o.done;o=a.next()){var i=o.value;if(i.Id===e.productId){var c={readMode:null!=i.ExtensionPointCollection.MessageReadCommandSurface,composeMode:null!=i.ExtensionPointCollection.MessageComposeCommandSurface,calendarMode:null!=i.ExtensionPointCollection.AppointmentOrganizerCommandSurface&&null!=i.ExtensionPointCollection.AppointmentAttendeeCommandSurface};zt.k.importAndExecute(e.productId.toLowerCase(),e.newPinnedStatus,c);break}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}(e)}else if(e instanceof Ht){a.g.info("[AdaptiveCard] InvokeAddinCommandAction executed"),l.eventName=Qt,i.logTelemetry(l);var p=e,f=Object(Lt.q)(o.itemId);Lt.A.import().then((function(e){e(f,p.addinId.toLowerCase(),p.desktopCommandId,qt.a.MessageRead,p.initializationContext)}))}else if(e instanceof _t){var g=e,h=g.botId,m=g.botName,v=function(e){if(null==e?void 0:e.$data)return e.$data;return}(t.card);a.g.info("[ActionableMessageDebug] StartBotConversation executed with message: "+h),Jt.a.import().then((function(e){return e(o.mailboxInfo,{friendlyBotName:m,botId:h,botData:v,connectorSenderGuid:t.connectorSenderGuid,smtpAddressSerialized:t.smtpAddressesSerialized},"help")})),i.logTelemetry(l)}else{if(!(e instanceof M.OpenUrlAction))return!1;if("mailto:"===(b=new URL(e.url)).protocol.toLowerCase()){var y=Object(Vt.a)(b.href).composeInitProps;Wt.m.importAndExecute(y,2)}}return!0},parseLegacyMessageCardAction:function(e,t){switch(e["@type"].toLowerCase()){case"displayreplyallform":return n=e,(r=new Ft).title=n.name,r.htmlBody=n.htmlBody,r;case"invokeaddincommand":return function(e){var t=new Ht;return t.title=e.name,t.addinId=e.addInId,t.desktopCommandId=e.desktopCommandId,t.initializationContext=JSON.stringify(e.initializationContext),t}(e);case"pinaddincommand":return function(e){var t=new Ut;return t.title=e.name,t.productId=e.productId,t.newPinnedStatus=e.newPinnedStatus,t}(e)}var n,r;return null},processAutoInvokeAction:function(e,t){if(Object(w.i)("mc-botConversation")&&e.type===Nt){var n=new _t;return n.parse(e),n}return null},registerHostCapabilities:null},nn=n(16987),rn=n(16988),an=n(16989),on=n(380);var cn,sn={ComponentDidMount:"11",ComponentWillUnMount:"12",ComponentDidUpdate:"13",FetchInProgress:"14",CardDetailsPresent:"15",FetchInitiated:"16",NotUpdatingCardDetailsAsItAlreadyPresent:"17",FetchSuccess:"18",CardId:"19",ItemId:"110",FetchError:"111",FetchException:"112",RenderCard:"113",NoCard:"114",ShowMessage:"115",UpdateOnItem:"116",UpdateLoadingState:"117",FinishLoading:"118",Render:"119"},un=function(){return Object(w.i)("rp-actionableMessages-ACv2-support")},ln=n(3596),dn=n(57),bn=function(e){var t=e?6e3:1e4,n=Ge();return e&&(null==n?void 0:n.AutoInvokedActionTimeoutInMsec)?t=n.AutoInvokedActionTimeoutInMsec:!e&&(null==n?void 0:n.HttpActionTimeoutInMsec)&&(t=n.HttpActionTimeoutInMsec),t},pn=function(e,t,n){return new Promise((function(r,a){var o;"AbortController"in window&&(o=new AbortController,t.signal=o.signal);var i=window.setTimeout((function(){o?o.abort():a()}),n);fetch(e,t).then((function(e){window.clearTimeout(i),r(e)})).catch((function(e){window.clearTimeout(i),a(e)}))}))};!function(e){e.Completed="Completed",e.Failed="Failed"}(cn||(cn={}));var fn,gn=function(e){function t(t,n,a,o,i){var c=e.call(this)||this;return c.url=t,c.parseCardFromStringOrObject=function(e){return r.f.import().then((function(t){return t(c.cardDetails,c.cardDetails.connectorSenderGuid,e.newCardPayload,e.newCardSignature,!0,c.cardDetails.cardId)}))},c.cardDetails=n,c.messageContext=a,c.onCardDetailsUpdated=o,c.telemetryHandler=i,c}return Object(s.e)(t,e),t.prototype.parseResponse=function(e,t){var n,r=t&&e.status===cn.Completed;return n=e.displayMessage?e.displayMessage:e.errorMessage?e.errorMessage:r?Object(F.b)(U.a):Object(F.b)(H.a),{status:r?cn.Completed:cn.Failed,displayMessage:n,newCardPayload:e.refreshCardSerialized,newCardSignature:e.refreshCardSignature,loginUrl:e.loginUrl}},t.prototype.getActionTelemetryEventName=function(e){return e.trigger===ln.ActivityRequestTrigger.Automatic?"AutoInvokeActionClicked":"SingleClickHttpPostActionClicked"},t.prototype.getTelemetrydataFromAnalytics=function(e,t,n){var r=Object(o.b)(this.telemetryHandler.getTelemetryDetailsForEvent(this.cardDetails,e,t,n));if(r.messageCardContext)try{r.messageCardContext=JSON.parse(r.messageCardContext)}catch(e){}if(r.messageCardExtensionContext)try{r.messageCardExtensionContext=JSON.parse(r.messageCardExtensionContext)}catch(e){}if(r.actionContext)try{r.actionContext=JSON.parse(r.actionContext)}catch(e){}return r},t.prototype.getInvokeActivityRequestData=function(e,t){var n=this.getActionTelemetryEventName(e),r=e.action,a={id:r.id,type:r.getJsonTypeName()};this.telemetryHandler.logTelemetryProvider(this.cardDetails,n,null,a);var o={connectorSenderGuid:this.cardDetails.connectorSenderGuid,inputParameters:[],senderAddress:this.messageContext.senderAddress,smtpAddressesSerialized:this.cardDetails.smtpAddressesSerialized,adaptiveCardSignature:this.cardDetails.cardSignature,adaptiveCardHash:this.cardDetails.cardHash,clientTelemetry:this.getTelemetrydataFromAnalytics(n,null,a)},i={type:"invoke",name:"adaptiveCard/action",localTimezone:"",localTimestamp:"",value:{action:{type:"Action.Execute",id:r.id,verb:r.verb,data:r.data},trigger:e.trigger},from:{id:t},channelData:o};return e.authCode&&(i.value.state=e.authCode),i},t.prototype.getAuthProperty=function(e){var t={buttons:[{type:"signin",value:e}]},n=new ln.Authentication;return n.parse(t),n},t.prototype.sendRequestAsync=function(e){var t,n;return Object(s.c)(this,void 0,void 0,(function(){var r,a,o,i,c,u,l,d,b,p,f,g;return Object(s.f)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,6,,7]),r=Object(dn.h)(),a=null===(t=r.SessionSettings)||void 0===t?void 0:t.UserPrincipalName,o=null===(n=r.SessionSettings)||void 0===n?void 0:n.UserEmailAddress,[4,Object(k.a)()];case 1:if(!(i=s.sent()))throw(c=new Error("Token is empty: "+i)).name="EmptyTokenError",c;return u=this.getInvokeActivityRequestData(e,a||o),l=e.trigger===ln.ActivityRequestTrigger.Automatic,d=bn(l),[4,pn(this.url,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+i},body:JSON.stringify(u)},d)];case 2:return[4,(b=s.sent()).json()];case 3:return p=s.sent(),(f=this.parseResponse(p,b.ok)).newCardPayload?[4,this.parseCardFromStringOrObject(f)]:[3,5];case 4:g=s.sent(),this.cardDetails=g,this.onCardDetailsUpdated([g]),s.label=5;case 5:return void 0,[2,b.ok&&f.status===cn.Completed?new ln.SuccessResponse(e,f.newCardPayload?f.newCardPayload:f.displayMessage):f.loginUrl?new ln.LoginRequestResponse(e,this.getAuthProperty(f.loginUrl)):new ln.ErrorResponse(e,new ln.ActivityRequestError(cn.Failed,f.displayMessage))];case 6:return s.sent(),[2,new ln.ErrorResponse(e,new ln.ActivityRequestError(cn.Failed,Object(F.b)(H.a)))];case 7:return[2]}}))}))},t}(ln.ChannelAdapter),hn=n(16990),mn=n(1886),vn=n(60),yn=n(1083),On=n(2081),Cn=n(4),jn="ActionableMessageTeachingUI",An=""+jn,Sn={CLICK:An+"_BtnClicked",GOTITCUSTOM:An+"_GotItClicked",LEARN:An+"_LearnMoreClicked",TRIGGERED:An+"_Triggered",DISMISSED:{BTNSCT:An+"_DismisByAction",UNMNT:An+"_DismissByUnmount"},SCOPE:{MOUNTED:An+"_Mounted",UNMNTED:An+"_Unmounted"},DISABLED:An+"_FlightDisabled",RENDERED:An+"_Rendered"},xn={Transaction:"https://support.office.com/en-us/article/pay-bills-and-invoices-in-outlook-using-microsoft-pay-1196e7e6-c096-44f1-a18a-9df3af832a48"};function In(e,t){Object(x.s)(e,t)}function wn(e){if(e)try{a.g.info("[ActionableMessageTeachingUI] Corelation telemetry trace function called"),function(e){fn=fn||{correlationVector:"",adaptiveCardCorrelationId:"",owaVersion:"",messageId:"",lightningAction:"",tuiType:""},Object(On.a)(fn,e)}(e)}catch(e){a.g.warn("[ActionableMessageDebug] teachingUITrace: Failed complete the logging of the telemetry - "+e.message)}return fn&&(fn.correlationVector=fn?Object(L.b)():void 0),fn}var kn=Object(yn.d)(Object(S.a)((function(e){e=Object(s.a)({hasSmallIcon:!0,hasSmallHeadline:!0,hasCloseIcon:!0,isWide:!0},e);var t=Object(s.g)(A.useState(!0),2),n=t[0],r=t[1];A.useEffect((function(){return a.g.info("[ActionableMessageTeachingUI:TeachingBubble] Teaching Bubble DidMount"),In("TeachingBubble_"+Sn.SCOPE.MOUNTED,wn()),function(){a.g.info("[ActionableMessageTeachingUI:TeachingBubble] Teaching Bubble WillUnmountMount"),In("TeachingBubble_"+Sn.SCOPE.UNMNTED,wn())}}),[]);var o=function(t){void 0===t&&(t="Primary"),"Secondary"==t?(a.g.info("[ActionableMessageTeachingUI:TeachingBubble] teacing bubble dismissed by user interaction"),In("TeachingBubble_"+Sn.CLICK,wn({lightningAction:t}))):(a.g.info("[ActionableMessageTeachingUI:TeachingBubble] teaching bubble passively dismissed"),In("TeachingBubble_"+Sn.DISMISSED.UNMNT,wn({lightningAction:t}))),Object(yn.e)(e.lid,t),r(!1)};return n&&(a.g.info("[ActionableMessageTeachingUI:TeachingBubble] Using TeachingBubble for ActionableMessageTeachingUI"),In("TeachingBubble_"+Sn.RENDERED,wn())),n&&A.createElement(mn.a,Object(s.a)({calloutProps:{beakWidth:15,directionalHint:vn.a.leftCenter,minPagePadding:50},targetElement:e.target(),primaryButtonProps:Object(s.a)(Object(s.a)({},e.gotItBtn),{onClick:function(){In("TeachingBubble_"+Sn.GOTITCUSTOM,wn({lightningAction:"Secondary"})),o("Secondary")}}),secondaryButtonProps:Object(s.a)(Object(s.a)({},e.learnMoreBtn),{onClick:function(){In("TeachingBubble_"+Sn.LEARN,wn({lightningAction:"Secondary"})),window.open(e.learnMoreBtnUri,"_blank"),o("Secondary")}}),onDismiss:function(){return e.onClose||o("Primary")}},e,{target:void 0}),e.bodyText)}))),Mn=n(3698),Tn=(n(287),Object(S.a)((function(e){A.useEffect((function(){var t;t={adaptiveCardCorrelationId:e.acCorrelationId,messageId:e.messageId,tuiType:e.actionType},An=jn+"_",wn({adaptiveCardCorrelationId:t.adaptiveCardCorrelationId,messageId:t.messageId,owaVersion:Object(Cn.r)(),lightningAction:"",tuiType:t.tuiType})}),[]);var t;return"Transaction"==e.actionType&&A.createElement(kn,{target:e.target,when:function(e){In(Sn.TRIGGERED,wn()),e()},gotItBtn:(t="TeachingBubble",{buttonType:Mn.a.primary,children:Object(F.b)(hn.a),onClick:t}),learnMoreBtn:En("TeachingBubble"),learnMoreBtnUri:xn[e.actionType]||void 0,headline:Object(F.b)(hn.d),bodyText:Object(F.b)(hn.c),hasSmallHeadline:!0,lid:yn.b.ActionableMessageTeachingUiTeachingBubblePolicy})})));function En(e){return{buttonType:Mn.a.normal,children:Object(F.b)(hn.b),onClick:e}}var Dn=n(16991),Pn=Object(S.a)((function(e){var t,n,i=this,c=e.actionableMessageLoggingHandler;A.useEffect((function(){return c.log(sn.ComponentDidMount),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper mount"),function(){jt.clearQueue(),c.log(sn.ComponentWillUnMount),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper unmount")}}),[]),A.useEffect((function(){c.log(sn.ComponentDidUpdate),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper update"),j()})),A.useEffect((function(){return p.current=setTimeout((function(){a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper card load timed out"),Object(x.s)("actionableMessageContentLoadTimeout"),f.current=!0,U(!0)}),4e3),function(){return clearTimeout(p.current)}}),[]);var u=A.useRef(Object(kt.a)(e.item)),l=A.useRef({loadStartTime:Object(I.Sb)()}),d=A.useRef([]),b=A.useRef(),p=A.useRef(),f=A.useRef(),g=Object(s.g)(A.useState(!1),2),h=g[0],m=g[1],v=Object(s.g)(A.useState(null),2),y=v[0],C=v[1],j=function(){return Object(s.c)(i,void 0,void 0,(function(){var t,n,r,o,i,u,d,p,f;return Object(s.f)(this,(function(s){switch(s.label){case 0:if(b.current)return c.log(sn.FetchInProgress),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties fetch already in process. Aborting this attempt"),[2];if(t=e.item,l.current.fetchStartTime=Object(I.Sb)(),(n=t.adaptiveCardDetails)&&n.length>0)return c.log(sn.CardDetailsPresent+":"+(null===(d=n[0].cardId)||void 0===d?void 0:d.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties already had cardDetails on the item. cardId: "+n[0].cardId),l.current.fetchEndTime=Object(I.Sb)(),[2];r=new x.b("MCActionableCardGetProperty"),s.label=1;case 1:return s.trys.push([1,3,4,5]),b.current=!0,c.log(sn.FetchInitiated),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties fetching cardDetails from the server"),[4,O(t)];case 2:return o=s.sent(),(i=t.adaptiveCardDetails)&&i.length>0?(c.log(sn.NotUpdatingCardDetailsAsItAlreadyPresent+":"+(null===(p=i[0].cardId)||void 0===p?void 0:p.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties not updating the details as its already present"+o[0].cardId)):o&&o.length>0?(r.end(),l.current.fetchEndTime=Object(I.Sb)(),c.log(sn.FetchSuccess),c.log(sn.CardId+":"+(null===(f=o[0].cardId)||void 0===f?void 0:f.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties got card details from the server. cardId: "+o[0].cardId),ft(t,o)):(c.log(sn.FetchError),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),U(!0),r.endWithError("ServerError")),[3,5];case 3:return u=s.sent(),c.log(sn.FetchException),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),a.g.warn("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties: exception during getCardDetails: "+u.message),U(!0),r.endWithError("ClientError"),[3,5];case 4:return b.current=!1,[7];case 5:return[2]}}))}))},S=function(e){return e.filter((function(e){return!e.isContextual}))},M=function(t){var n,i,b=S(t),p={onUndo:function(){return t=e.darkModeContentHandler,n=e.undoDarkMode,void(t&&n&&(a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: undoing dark mode"),t.undoHandler(d.current),d.current=[]));var t,n},onApply:function(t){return function(t){var n=e.undoDarkMode,r=e.darkModeContentHandler;if(t&&r&&!n)if(a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: applying dark mode to card elements"),r.cssSelector){r.handler(t),d.current.push(t);var o=t.querySelectorAll(r.cssSelector);if(o)for(var i=0;i<o.length;i++){var c=o.item(i);r.handler(c),d.current.push(c)}}else a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: no cssSelector specified by DarkMode handler")}(t)}},f=new r.b(o.c,u.current,l.current);if(b&&b.length>0&&(i=un()?b[0]:b[b.length-1]),i&&function(t){var n,r=!0,a=null===(n=null==t?void 0:t.card)||void 0===n?void 0:n.originator;return a||(a=null==t?void 0:t.connectorSenderGuid),a&&(r=!Re(a,e.isDarkMode)),r}(i)){c.log(sn.RenderCard+":"+(null===(n=i.cardId)||void 0===n?void 0:n.slice(0,8))),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper renderCardFromDetails. cardId: "+i.cardId);var g=new gn(ze(u.current),i,u.current,E,f);return A.createElement("div",{className:Dn.container},A.createElement(r.a,{key:i.cardId,cardDetails:i,isActionableMessageV2Enabled:un(),snackBarTimeout:Je(),v2SnackBarTimeout:We(),showMessageBodyCallback:T,contentHandlerUndoMode:e.undoDarkMode,actionProviders:[tn,Ve,ct],adjustCardElementBeforeRenderCallback:P,fixImagesBeforeRenderCallback:B,onCardRendered:N,downloadThemeCallback:ie,onCardDetailsUpdated:E,getClientAuthToken:k.a,actionableMessageContentHandler:p,actionableMessageCardStrings:{format:F.c,placeholder:{textInput:Object(F.b)(nn.g),numberInput:Object(F.b)(nn.f),dateInput:Object(F.b)(nn.e),choiceSetInput:Object(F.b)(nn.d)},error:{generic:Object(F.b)(H.a)},warning:{invalidInput:Object(F.b)(nn.h),missingRequiredInput:Object(F.b)(nn.i),inputNumberNotNumeric:Object(F.b)(rn.c),inputNumberLessThanMin:Object(F.b)(rn.a),inputNumberMoreThanMax:Object(F.b)(rn.b),requiredField:Object(F.b)(an.a)},information:{actionInProgress:Object(F.b)(nn.a),authenticationFlowAcknowledgeMessage:Object(F.b)(nn.c),authenticationFlowAcknowledgeButtonText:Object(F.b)(nn.b)},datePicker:Object(s.a)(Object(s.a)({},Object(on.a)()),{isRequiredErrorMessage:an.a})},telemetryHandler:f,loggingHandler:c,httpChannelAdapter:g,isTrustedDomain:qe}))}return c.log(sn.NoCard),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper renderCardFromDetails - Did not find expected number of cards on the message"),T(!0),A.createElement("div",null)},T=function(t){c.log(sn.ShowMessage),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper setShowMessageBody: "+t),ht(e.viewState,t),t&&mt(e.viewState,!1),U(t)},E=function(t){c.log(sn.UpdateOnItem),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper updateCardOnItem"),gt(e.item,t)},D=function(){var t=e.item.adaptiveCardDetails;if(t&&t.length>0){var n=t[0].card.messageCardContext;return n?{acCorrelationId:n.correlationId,actionType:Object(r.e)(t[0]),messageId:e.item.ItemId.Id,target:function(){return y}}:{acCorrelationId:"",actionType:void 0,messageId:null,target:function(){return y}}}return null},P=function(t,n){a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper fixInlineImages"),Ue(t,e.item.MailboxInfo,n),At(t,e.item,e.item.MailboxInfo)},B=function(t,n){Ue(t,e.item.MailboxInfo,n)},N=function(t){c.log(sn.UpdateLoadingState),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper  onCardRendered. Updating loading state"),y!==t&&(m(!0),C(t),U(!1)),e.viewState.showCardLoading&&mt(e.viewState,!1)},R=function(e){return(null==e?void 0:e.actionType)&&null!=e.target?(a.g.info("[ActionableMessageCard] TeachingUI triggered"),A.createElement(Tn,Object(s.a)({},e))):null},U=function(t){c.log(sn.FinishLoading),a.g.info("[ActionableMessageDebug] Finish Loading - forceShowMessageBody:"+t),p.current&&(clearTimeout(p.current),p.current=null);var n=e.viewState;mt(n,!1),t&&ht(n,!0)},_=e.item.adaptiveCardDetails;return c.log(sn.Render),c.log(sn.CardId+":"+((null==_?void 0:_[0])?null===(n=null===(t=_[0])||void 0===t?void 0:t.cardId)||void 0===n?void 0:n.slice(0,8):" ")),a.g.info("[ActionableMessageDebug] ActionableMessageMailWrapper render. itemId: "+e.item.ItemId.Id+". CardDetails: "+((null==_?void 0:_[0])?_[0].cardId:"undefined")),_&&_.length>0?0!==function(t){var n=S(t);return n=n.filter((function(t){return function(e,t,n,a,o){var i=e.card;if(i&&i.hasOwnProperty(Ke)){if(!i.messageCardContext)return!1;var c=Object(r.e)(e)===r.c.XeroOpay&&n;return c&&o.logTelemetry({messageContext:a,eventName:Ye,cardDetails:e}),c}return!1}(t,e.item.MailboxInfo,Object(w.i)("rp-acDisableTransactionCard"),u.current,o.c)}))}(_).length?(U(!0),null):function(e){return f.current&&U(!0),!f.current&&A.createElement(A.Fragment,null,A.createElement("div",{className:Dn.cardArea},M(e)),A.createElement(pt,{odataItemId:u.current.odataItemId,smtpAddressesSerialized:e[0].smtpAddressesSerialized}),h&&R(e?D():null))}(_):null}));n.d(t,"logAdaptiveCardLinkInteraction",(function(){return c})),n.d(t,"getCardDetails",(function(){return O})),n.d(t,"ActionableMessageMailWrapper",(function(){return Pn})),n.d(t,"doesActionableMessageEnabled",(function(){return Be}))},1886:function(e,t,n){"use strict";var r=n(768),a=n(3),o=n(0),i=n(713),c=n(66),s=n(700),u=n(1261),l=n(1260),d=n(1714),b=n(1545),p=n(421),f=n(604),g=n(411),h=n(381),m=Object(i.a)(),v=o.forwardRef((function(e,t){var n,r,i,v,y,O=o.useRef(null),C=Object(h.c)(),j=Object(f.a)(O,t),A=e.illustrationImage,S=e.primaryButtonProps,x=e.secondaryButtonProps,I=e.headline,w=e.hasCondensedHeadline,k=e.hasCloseButton,M=void 0===k?e.hasCloseIcon:k,T=e.onDismiss,E=e.closeButtonAriaLabel,D=e.hasSmallHeadline,P=e.isWide,B=e.styles,N=e.theme,R=e.ariaDescribedBy,F=e.ariaLabelledBy,H=e.footerContent,U=e.focusTrapZoneProps,_=m(B,{theme:N,hasCondensedHeadline:w,hasSmallHeadline:D,hasCloseButton:M,hasHeadline:!!I,isWide:P,primaryButtonClassName:S?S.className:void 0,secondaryButtonClassName:x?x.className:void 0}),L=o.useCallback((function(e){T&&e.which===c.a.escape&&T(e)}),[T]);if(Object(g.a)(C,"keydown",L),A&&A.src&&(n=o.createElement("div",{className:_.imageContent},o.createElement(p.a,Object(a.__assign)({},A)))),I){var q="string"==typeof I?"p":"div";r=o.createElement("div",{className:_.header},o.createElement(q,{role:"heading",className:_.headline,id:F},I))}if(e.children){var z="string"==typeof e.children?"p":"div";i=o.createElement("div",{className:_.body},o.createElement(z,{className:_.subText,id:R},e.children))}return(S||x||H)&&(v=o.createElement(d.a,{className:_.footer,horizontal:!0,horizontalAlign:H?"space-between":"end"},o.createElement(d.a.Item,{align:"center"},o.createElement("span",null,H)),o.createElement(d.a.Item,null,x&&o.createElement(s.a,Object(a.__assign)({},x,{className:_.secondaryButton})),S&&o.createElement(u.a,Object(a.__assign)({},S,{className:_.primaryButton}))))),M&&(y=o.createElement(l.a,{className:_.closeButton,iconProps:{iconName:"Cancel"},title:E,ariaLabel:E,onClick:T})),function(e,t){o.useImperativeHandle(e,(function(){return{focus:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.focus()}}}),[t])}(e.componentRef,O),o.createElement("div",{className:_.content,ref:j,role:"dialog",tabIndex:-1,"aria-labelledby":F,"aria-describedby":R,"data-is-focusable":!0},n,o.createElement(b.a,Object(a.__assign)({isClickableOutsideFocusTrap:!0},U),o.createElement("div",{className:_.bodyContent},r,i,v,y)))})),y=n(7),O=n(138),C={root:"ms-TeachingBubble",body:"ms-TeachingBubble-body",bodyContent:"ms-TeachingBubble-bodycontent",closeButton:"ms-TeachingBubble-closebutton",content:"ms-TeachingBubble-content",footer:"ms-TeachingBubble-footer",header:"ms-TeachingBubble-header",headerIsCondensed:"ms-TeachingBubble-header--condensed",headerIsSmall:"ms-TeachingBubble-header--small",headerIsLarge:"ms-TeachingBubble-header--large",headline:"ms-TeachingBubble-headline",image:"ms-TeachingBubble-image",primaryButton:"ms-TeachingBubble-primaryButton",secondaryButton:"ms-TeachingBubble-secondaryButton",subText:"ms-TeachingBubble-subText",button:"ms-Button",buttonLabel:"ms-Button-label"},j=Object(O.c)((function(){return Object(y.keyframes)({"0%":{opacity:0,animationTimingFunction:y.AnimationVariables.easeFunction1,transform:"scale3d(.90,.90,.90)"},"100%":{opacity:1,transform:"scale3d(1,1,1)"}})})),A=function(e,t){var n=t||{},r=n.calloutWidth,a=n.calloutMaxWidth;return[{display:"block",maxWidth:364,border:0,outline:"transparent",width:r||"calc(100% + 1px)",animationName:""+j(),animationDuration:"300ms",animationTimingFunction:"linear",animationFillMode:"both"},e&&{maxWidth:a||456}]},S=function(e,t,n){return t?[e.headerIsCondensed,{marginBottom:14}]:[n&&e.headerIsSmall,!n&&e.headerIsLarge,{selectors:{":not(:last-child)":{marginBottom:14}}}]},x=function(e){var t,n,r,o=e.hasCondensedHeadline,i=e.hasSmallHeadline,c=e.hasCloseButton,s=e.hasHeadline,u=e.isWide,l=e.primaryButtonClassName,d=e.secondaryButtonClassName,b=e.theme,p=e.calloutProps,f=void 0===p?{className:void 0,theme:b}:p,g=!o&&!i,h=b.palette,m=b.semanticColors,v=b.fonts,O=Object(y.getGlobalClassNames)(C,b),j=Object(y.getFocusStyle)(b,{outlineColor:"transparent",borderColor:"transparent"});return{root:[O.root,v.medium,f.className],body:[O.body,c&&!s&&{marginRight:24},{selectors:{":not(:last-child)":{marginBottom:20}}}],bodyContent:[O.bodyContent,{padding:"20px 24px 20px 24px"}],closeButton:[O.closeButton,{position:"absolute",right:0,top:0,margin:"15px 15px 0 0",borderRadius:0,color:h.white,fontSize:v.small.fontSize,selectors:{":hover":{background:h.themeDarkAlt,color:h.white},":active":{background:h.themeDark,color:h.white},":focus":{border:"1px solid "+m.variantBorder}}}],content:Object(a.__spreadArrays)([O.content],A(u),[u&&{display:"flex"}]),footer:[O.footer,{display:"flex",flex:"auto",alignItems:"center",color:h.white,selectors:(t={},t["."+O.button+":not(:first-child)"]={marginLeft:10},t)}],header:Object(a.__spreadArrays)([O.header],S(O,o,i),[c&&{marginRight:24},(o||i)&&[v.medium,{fontWeight:y.FontWeights.semibold}]]),headline:[O.headline,{margin:0,color:h.white,fontWeight:y.FontWeights.semibold},g&&[{fontSize:v.xLarge.fontSize}]],imageContent:[O.header,O.image,u&&{display:"flex",alignItems:"center",maxWidth:154}],primaryButton:[O.primaryButton,l,j,{backgroundColor:h.white,borderColor:h.white,color:h.themePrimary,whiteSpace:"nowrap",selectors:(n={},n["."+O.buttonLabel]=v.medium,n[":hover"]={backgroundColor:h.themeLighter,borderColor:h.themeLighter,color:h.themePrimary},n[":focus"]={backgroundColor:h.themeLighter,border:"1px solid "+h.black,outline:"1px solid "+h.white,outlineOffset:"-2px"},n[":active"]={backgroundColor:h.white,borderColor:h.white,color:h.themePrimary},n)}],secondaryButton:[O.secondaryButton,d,j,{backgroundColor:h.themePrimary,borderColor:h.white,whiteSpace:"nowrap",selectors:(r={},r["."+O.buttonLabel]=[v.medium,{color:h.white}],r[":hover"]={backgroundColor:h.themeDarkAlt,borderColor:h.white},r[":focus"]={backgroundColor:h.themeDark,border:"1px solid "+h.black,outline:"1px solid "+h.white,outlineOffset:"-2px"},r[":active"]={backgroundColor:h.themePrimary,borderColor:h.white},r)}],subText:[O.subText,{margin:0,fontSize:v.medium.fontSize,color:h.white,fontWeight:y.FontWeights.regular}],subComponentStyles:{callout:{root:Object(a.__spreadArrays)(A(u,f),[v.medium]),beak:[{background:h.themePrimary}],calloutMain:[{background:h.themePrimary}]}}}},I=Object(r.a)(v,x,void 0,{scope:"TeachingBubbleContent"}),w=n(1115),k={beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:n(60).a.rightCenter},M=Object(i.a)(),T=o.forwardRef((function(e,t){var n=o.useRef(null),r=Object(f.a)(n,t),i=e.calloutProps,c=e.targetElement,s=e.onDismiss,u=e.hasCloseButton,l=void 0===u?e.hasCloseIcon:u,d=e.isWide,b=e.styles,p=e.theme,g=e.target,h=o.useMemo((function(){return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},k),i),{theme:p})}),[i,p]),m=M(b,{theme:p,isWide:d,calloutProps:h,hasCloseButton:l}),v=m.subComponentStyles?m.subComponentStyles.callout:void 0;return function(e,t){o.useImperativeHandle(e,(function(){return{focus:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.focus()}}}),[t])}(e.componentRef,n),o.createElement(w.a,Object(a.__assign)({target:g||c,onDismiss:s},h,{className:m.root,styles:v,hideOverflow:!0}),o.createElement("div",{ref:r},o.createElement(I,Object(a.__assign)({},e))))}));T.displayName="TeachingBubble",n.d(t,"a",(function(){return E}));var E=Object(r.a)(T,x,void 0,{scope:"TeachingBubble"})},193:function(e){e.exports=JSON.parse('{"l":"dra","i":"era","n":"fra","k":"gra","m":"hra","j":"ira","d":"jra","b":"kra","f":"lra","g":"mra","e":"nra","a":"ora","c":"pra","o":"qra","s":"rra","r":"sra","p":"tra","q":"ura","h":"vra"}')},1975:function(e,t,n){"use strict";n.d(t,"l",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return y})),n.d(t,"g",(function(){return O}));var r,a,o=n(42),i=n(19),c=n(57),s=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],u=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],l={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function d(){return Object(c.u)()}function b(){return Object(i.a)().IsConsumerChild}function p(){return Object(i.a)().SessionSettings.IsShadowMailbox}function f(){return void 0!==a?a:a=function(){var e=Object(i.a)(),t=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return t?t.toLowerCase():"en-us";var n=e.AdMarket.toLowerCase();return s.indexOf(n)>-1?n:l[n.split("-")[1]]||n}()}function g(e){return null!=e?e.toUpperCase().split("-"):[]}function h(e){return g(e)[1]||"US"}function m(){return Object(o.a)("ANON")}function v(){return Object(o.a)("MUID")}function y(){return!!Object(o.a)("TOptOut")}function O(){return r||(r="https://acdn.adnxs.com/ast/static/0.36.0/ast.js")}},2081:function(e,t,n){"use strict";var r=n(775),a=n(536),o=n(896),i=n(448),c=n(537),s=n(479),u=Object.prototype.hasOwnProperty,l=Object(o.a)((function(e,t){if(Object(c.a)(t)||Object(i.a)(t))Object(a.a)(t,Object(s.a)(t),e);else for(var n in t)u.call(t,n)&&Object(r.a)(e,n,t[n])}));t.a=l},2188:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),a={};function o(e){var t;null===(t=a[e.type])||void 0===t||t.forEach((function(t){return t(e)}))}function i(e){var t;return a[e]=null!==(t=a[e])&&void 0!==t?t:new Map}function c(e,t,n){var a=r.useRef();r.useEffect((function(){return function(e,t,n){var r=i(e);0===r.size&&window.addEventListener(e,o),r.set(t,n)}(e,a,t),function(){return function(e,t){var n=i(e);n.delete(t),0===n.size&&window.removeEventListener(e,o)}(e,a)}}),n)}},2494:function(e,t,n){"use strict";var r=n(1975),a=["AT","BE","BG","CH","CY","CZ","DE","DK","EE","ES","FI","FR","GB","GR","HR","HU","IE","IS","IT","LI","LT","LU","LV","MT","NL","NO","PL","PT","RO","SE","SI","SK"];function o(){var e=Object(r.h)(Object(r.e)());return a.indexOf(e)>=0}var i,c={};function s(e,t){return void 0===t&&(t=!0),c[e]&&i&&-1!=i.indexOf(e)||(c[e]=new Promise((function(n,r){var a=window.document.createElement("script");a.src=e,a.type="text/javascript",t&&(a.crossOrigin="anonymous"),a.onload=function(){i?i.push(e):i=[e],n()},a.onerror=function(){r("OnError "+e)},window.document.head.appendChild(a)}))),c[e]}var u=n(57);function l(e){u.w.importAndExecute([{key:"ConsumerAdsExperimentMode",valuetype:"Integer32",value:[String(e)]}])}var d,b,p,f=n(24),g=n(19),h=["en-us","en-gb","en-ca","en-au","fr-fr","de-de","en-de"];function m(){if(!b)if(v())if(Object(g.a)().UserOptions.IsFocusedInboxEnabled)b=1;else{var e=function(){if(Object(f.i)("adsExp-NativeInbox-e2-NoDisplayAd"))return 2;if(Object(f.i)("adsExp-NativeInbox-e3-NoDisplayAd")||Object(f.i)("adsExp-NativeInbox-e3-DisplayAd"))return 3;if(Object(f.i)("adsExp-NativeInbox-e4-NoDisplayAd"))return 4;return-1}();if(-1!=e){var t=function(e){switch(e){case"DisplayOffNativeOff":return 1;case"DisplayOffNativeOther":return 2;case"DisplayOffNativeInbox":return 3;case"DisplayOnNativeOff":return 4;case"DisplayOnNativeOther":return 5;case"DisplayOnNativeInbox":return 6;case"NoExperiment":default:return 0}}(Object(g.a)().UserOptions.ConsumerAdsExperimentMode);if(0==t||t>=e)l(1),b=2;else if(t<e){l(t+1==e?0:t+1),b=1}}else b=1}else b=0;return b}function v(){return void 0!==d?d:(d=!1,Object(u.s)()?(p=Object(r.e)(),Object(f.i)("fwk-nativeAds-bingOneClickOtherInboxOnly")||Object(f.i)("fwk-nativeAds-prebidOneClickOtherInboxOnly")||Object(f.i)("fwk-nativeAds-appNexusOneClickOtherInboxOnly")?Object(r.b)()?d:Object(r.c)()?d:Object(r.a)()?d:r.d.indexOf(p)>-1?d:d=!0:d):d)}n.d(t,"o",(function(){return o})),n.d(t,"p",(function(){return s})),n.d(t,"l",(function(){return v})),n.d(t,"m",(function(){return m})),n.d(t,"a",(function(){return h})),n.d(t,"e",(function(){return r.d})),n.d(t,"f",(function(){return r.e})),n.d(t,"g",(function(){return r.f})),n.d(t,"i",(function(){return r.h})),n.d(t,"j",(function(){return r.i})),n.d(t,"k",(function(){return r.j})),n.d(t,"n",(function(){return r.k})),n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"q",(function(){return r.l})),n.d(t,"h",(function(){return r.g}))},293:function(e,t,n){"use strict";var r,a=n(576),o=n(184).a["__core-js_shared__"],i=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var c=function(e){return!!i&&i in e},s=n(216),u=n(423),l=/^\[object .+?Constructor\]$/,d=Function.prototype,b=Object.prototype,p=d.toString,f=b.hasOwnProperty,g=RegExp("^"+p.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var h=function(e){return!(!Object(s.a)(e)||c(e))&&(Object(a.a)(e)?g:l).test(Object(u.a)(e))};var m=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var n=m(e,t);return h(n)?n:void 0}},3697:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),a=n(2091),o=n(982);function i(e,t,n,i){var c=Object(o.e)(n,e,null,t),s=Object(r.a)(Object(r.a)({},i),{includeFluidOnPopout:Object(a.d)(7)});Object(o.c)("mail",c,s,{resizable:!0})}},3698:function(e,t,n){"use strict";var r,a;n.d(t,"a",(function(){return a})),function(e){e[e.button=0]="button",e[e.anchor=1]="anchor"}(r||(r={})),function(e){e[e.normal=0]="normal",e[e.primary=1]="primary",e[e.hero=2]="hero",e[e.compound=3]="compound",e[e.command=4]="command",e[e.icon=5]="icon",e[e.default=6]="default"}(a||(a={}))},380:function(e,t,n){"use strict";var r=n(746),a=n(747),o=n(748),i=n(749),c=n(750),s=n(751),u=n(752),l=n(646),d=n(647),b=n(648),p=n(649),f=n(650),g=n(651),h=n(652),m=n(653),v=n(654),y=n(655),O=n(656),C=n(657),j=n(193),A=n(886),S=n(755),x=n(756),I=n(757),w=n(758),k=n(759),M=n(760),T=n(761),E=n(762),D=n(763),P=n(764),B=n(765),N=n(766),R=n(6),F=n(14),H=function(){return U.get()},U=Object(F.computed)((function(){return{months:[Object(R.b)(C.a),Object(R.b)(O.a),Object(R.b)(y.a),Object(R.b)(v.a),Object(R.b)(m.a),Object(R.b)(h.a),Object(R.b)(g.a),Object(R.b)(f.a),Object(R.b)(p.a),Object(R.b)(b.a),Object(R.b)(d.a),Object(R.b)(l.a)],shortMonths:[Object(R.b)(N.a),Object(R.b)(B.a),Object(R.b)(P.a),Object(R.b)(D.a),Object(R.b)(E.a),Object(R.b)(T.a),Object(R.b)(M.a),Object(R.b)(k.a),Object(R.b)(w.a),Object(R.b)(I.a),Object(R.b)(x.a),Object(R.b)(S.a)],days:[Object(R.b)(u.a),Object(R.b)(s.a),Object(R.b)(c.a),Object(R.b)(i.a),Object(R.b)(o.a),Object(R.b)(a.a),Object(R.b)(r.a)],shortDays:[Object(R.b)(j.d),Object(R.b)(j.b),Object(R.b)(j.f),Object(R.b)(j.g),Object(R.b)(j.e),Object(R.b)(j.a),Object(R.b)(j.c)],goToToday:Object(R.b)(A.a),prevMonthAriaLabel:Object(R.b)(j.l),nextMonthAriaLabel:Object(R.b)(j.i),prevYearAriaLabel:Object(R.b)(j.n),nextYearAriaLabel:Object(R.b)(j.k),prevYearRangeAriaLabel:Object(R.b)(j.m),nextYearRangeAriaLabel:Object(R.b)(j.j),monthPickerHeaderAriaLabel:Object(R.b)(j.o),yearPickerHeaderAriaLabel:Object(R.b)(j.s),weekNumberFormatString:Object(R.b)(j.r),selectedDateFormatString:Object(R.b)(j.p),todayDateFormatString:Object(R.b)(j.q),dayMarkedAriaLabel:Object(R.b)(j.h)}})),_=n(57),L=function(e,t){return e?e.tz:t||Object(_.p)()},q=n(5),z=function(e,t){return Object(q.Sb)(e,t.getFullYear(),t.getMonth(),t.getDate())};n.d(t,"a",(function(){return H})),n.d(t,"c",(function(){return L})),n.d(t,"b",(function(){return z}))},3977:function(e){e.exports=JSON.parse('{"a":"G5b"}')},413:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(2),a=n(14),o=Object(r.createStore)("lightningState",{unseenItems:new a.ObservableMap,lightedCount:0,lastShownId:null}),i=o()},423:function(e,t,n){"use strict";var r=Function.prototype.toString;t.a=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},448:function(e,t,n){"use strict";var r=n(576),a=n(580);t.a=function(e){return null!=e&&Object(a.a)(e.length)&&!Object(r.a)(e)}},450:function(e,t,n){"use strict";t.a=function(e,t){return e===t||e!=e&&t!=t}},479:function(e,t,n){"use strict";var r=n(658),a=n(879),o=n(448);t.a=function(e){return Object(o.a)(e)?Object(r.a)(e):Object(a.a)(e)}},534:function(e,t,n){"use strict";var r=n(293),a=function(){try{var e=Object(r.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.a=a},536:function(e,t,n){"use strict";var r=n(775),a=n(590);t.a=function(e,t,n,o){var i=!n;n||(n={});for(var c=-1,s=t.length;++c<s;){var u=t[c],l=o?o(n[u],e[u],u,n,e):void 0;void 0===l&&(l=e[u]),i?Object(a.a)(n,u,l):Object(r.a)(n,u,l)}return n}},537:function(e,t,n){"use strict";var r=Object.prototype;t.a=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},540:function(e,t,n){"use strict";(function(e){var r=n(644),a="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=a&&"object"==typeof e&&e&&!e.nodeType&&e,i=o&&o.exports===a&&r.a.process,c=function(){try{var e=o&&o.require&&o.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();t.a=c}).call(this,n(708)(e))},562:function(e,t,n){"use strict";(function(e){var r=n(184),a=n(915),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,c=i&&i.exports===o?r.a.Buffer:void 0,s=(c?c.isBuffer:void 0)||a.a;t.a=s}).call(this,n(708)(e))},571:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n(3),a=n(7),o=n(283),i=function(){return{position:"absolute",width:1,right:31,top:8,bottom:8}};function c(e){var t,n,o,c,s,u=e.semanticColors,l=e.palette,d=u.buttonBackground,b=u.buttonBackgroundPressed,p=u.buttonBackgroundHovered,f=u.buttonBackgroundDisabled,g=u.buttonText,h=u.buttonTextHovered,m=u.buttonTextDisabled,v=u.buttonTextChecked,y=u.buttonTextCheckedHovered;return{root:{backgroundColor:d,color:g},rootHovered:{backgroundColor:p,color:h,selectors:(t={},t[a.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},t)},rootPressed:{backgroundColor:b,color:v},rootExpanded:{backgroundColor:b,color:v},rootChecked:{backgroundColor:b,color:v},rootCheckedHovered:{backgroundColor:b,color:y},rootDisabled:{color:m,backgroundColor:f,selectors:(n={},n[a.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},n)},splitButtonContainer:{selectors:(o={},o[a.HighContrastSelector]={border:"none"},o)},splitButtonMenuButton:{color:l.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:l.neutralLight,selectors:(c={},c[a.HighContrastSelector]={color:"Highlight"},c)}}},splitButtonMenuButtonDisabled:{backgroundColor:u.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:u.buttonBackgroundDisabled}}},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},i()),{backgroundColor:l.neutralTertiaryAlt,selectors:(s={},s[a.HighContrastSelector]={backgroundColor:"WindowText"},s)}),splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:l.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:l.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:l.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:l.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:u.buttonText},splitButtonMenuIconDisabled:{color:u.buttonTextDisabled}}}function s(e){var t,n,c,s,u,l,d,b,p,f=e.palette,g=e.semanticColors;return{root:{backgroundColor:g.primaryButtonBackground,border:"1px solid "+g.primaryButtonBackground,color:g.primaryButtonText,selectors:(t={},t[a.HighContrastSelector]=Object(r.__assign)({color:"Window",backgroundColor:"WindowText",borderColor:"WindowText"},Object(a.getHighContrastNoAdjustStyle)()),t["."+o.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:f.white}}},t)},rootHovered:{backgroundColor:g.primaryButtonBackgroundHovered,border:"1px solid "+g.primaryButtonBackgroundHovered,color:g.primaryButtonTextHovered,selectors:(n={},n[a.HighContrastSelector]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},n)},rootPressed:{backgroundColor:g.primaryButtonBackgroundPressed,border:"1px solid "+g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed,selectors:(c={},c[a.HighContrastSelector]=Object(r.__assign)({color:"Window",backgroundColor:"WindowText",borderColor:"WindowText"},Object(a.getHighContrastNoAdjustStyle)()),c)},rootExpanded:{backgroundColor:g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed},rootChecked:{backgroundColor:g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed},rootDisabled:{color:g.primaryButtonTextDisabled,backgroundColor:g.primaryButtonBackgroundDisabled,selectors:(s={},s[a.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},s)},splitButtonContainer:{selectors:(u={},u[a.HighContrastSelector]={border:"none"},u)},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},i()),{backgroundColor:f.white,selectors:(l={},l[a.HighContrastSelector]={backgroundColor:"Window"},l)}),splitButtonMenuButton:{backgroundColor:g.primaryButtonBackground,color:g.primaryButtonText,selectors:(d={},d[a.HighContrastSelector]={backgroundColor:"WindowText"},d[":hover"]={backgroundColor:g.primaryButtonBackgroundHovered,selectors:(b={},b[a.HighContrastSelector]={color:"Highlight"},b)},d)},splitButtonMenuButtonDisabled:{backgroundColor:g.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:g.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:g.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:g.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:g.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:g.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:g.primaryButtonText},splitButtonMenuIconDisabled:{color:f.neutralTertiary,selectors:(p={},p[a.HighContrastSelector]={color:"GrayText"},p)}}}},576:function(e,t,n){"use strict";var r=n(311),a=n(216),o="[object AsyncFunction]",i="[object Function]",c="[object GeneratorFunction]",s="[object Proxy]";t.a=function(e){if(!Object(a.a)(e))return!1;var t=Object(r.a)(e);return t==i||t==c||t==o||t==s}},577:function(e,t,n){"use strict";t.a=function(e){return e}},580:function(e,t,n){"use strict";var r=9007199254740991;t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},583:function(e,t,n){"use strict";var r=9007199254740991,a=/^(?:0|[1-9]\d*)$/;t.a=function(e,t){var n=typeof e;return!!(t=null==t?r:t)&&("number"==n||"symbol"!=n&&a.test(e))&&e>-1&&e%1==0&&e<t}},590:function(e,t,n){"use strict";var r=n(534);t.a=function(e,t,n){"__proto__"==t&&r.a?Object(r.a)(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},625:function(e,t,n){"use strict";var r=n(311),a=n(303),o="[object Arguments]";var i=function(e){return Object(a.a)(e)&&Object(r.a)(e)==o},c=Object.prototype,s=c.hasOwnProperty,u=c.propertyIsEnumerable,l=i(function(){return arguments}())?i:function(e){return Object(a.a)(e)&&s.call(e,"callee")&&!u.call(e,"callee")};t.a=l},642:function(e,t,n){"use strict";var r=n(31),a=n(413),o=n(23),i=n(1),c=n(8),s=n(14),u=n(2),l=Object(u.mutatorAction)("initializeLightning",(function(e){var t,n;if(o.g.info("initialize lightning store"),Object(a.a)().lastShownId=null,Object(a.a)().lightedCount=0,Object(a.a)().unseenItems=new s.ObservableMap,e)try{for(var r=Object(i.k)(e),c=r.next();!c.done;c=r.next()){var u=c.value;Object(a.a)().unseenItems.set(u.identity,u)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}));var d=n(151),b="ows/v1.0/lightning/items/unseen";function p(){return o.g.info("initialize lightning from server"),Object(d.b)(b).then((function(e){var t=e.map(f);l(t)}))}function f(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var g,h=n(19),m=n(24),v="lightning",y="UnseenLightening";function O(){var e,t,n;if(!g){var r=Object(c.a)(v);if(r)g=function(e){o.g.info("initialize lightning from override query parameter");var t=e.split(",").map((function(e){return{identity:e,visible:!1}}));return l(t),Promise.resolve()}(r);else{var a=Object(h.a)().PrimeSettings;if(Object(m.i)("lightning-initFromSD")&&a&&a.Items)try{for(var s=Object(i.k)(a.Items),u=s.next();!u.done;u=s.next()){var d=u.value;if(d.Id===y&&d.Value){n=d.Value,o.g.info("initialize lightning from session data"),l(n.map((function(e){return{identity:e.id,visible:!1,category:e.category}}))),g=Promise.resolve();break}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}g||(g=p())}}return g}var C=n(1294),j=Object(u.action)("lightup",(function(e){return{id:e}})),A=j;Object(u.mutator)(j,(function(e){o.g.info("lightup - id:"+e.id),Object(a.a)().lastShownId=e.id,Object(a.a)().lightedCount++;var t=Object(a.a)().unseenItems.get(e.id);t&&(t.visible=!0)})),Object(u.orchestrator)(j,(function(e){Object(C.a)("LIGHTUP",e.id)}));var S,x=n(514);function I(e,t){(o.g.info("lightupOrReject - id:"+e+", recurrenceCount:"+t+", lightedCount:"+Object(a.a)().lightedCount+", lastShown:"+Object(a.a)().lastShownId),Object(x.w)())?o.g.info("lightning is disabled for deeplink"):Object(a.a)().unseenItems.has(e)&&(!Object(a.a)().lastShownId||function(e,t){var n=!1,r=Object(a.a)().lastShownId;if(r&&t&&!function(){var e=Object(a.a)(),t=e.lastShownId,n=e.unseenItems;return t&&n.has(t)&&n.get(t).visible}()){var o=t.indexOf(r),i=t.indexOf(e);o>=0&&o+1==i&&(n=!0)}return n}(e,t)||function(e){var t=Object(a.a)().unseenItems.get(e);return!!t&&t.category==S.UIFeatureDiscovery}(e)||function(e){var t=Object(a.a)().unseenItems.get(e);return!!t&&t.category==S.Compliance}(e))&&A(e)}function w(e,t,n){o.g.info("beginLightning - id:"+e),t((function(){O().then((function(){return I(e,n)})).catch((function(t){o.g.warn("something is wrong, lightning id:"+e+", reason:"+t)}))}))}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(S||(S={}));var k=n(873);n.d(t,"c",(function(){return T})),n.d(t,"d",(function(){return a.b})),n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return k.a}));var M=new r.c((function(){return n.e(506).then(n.bind(null,18524))})),T=new r.a(M,(function(e){return e.endLightningImp}))},646:function(e){e.exports=JSON.parse('{"a":"Era"}')},647:function(e){e.exports=JSON.parse('{"a":"Dra"}')},648:function(e){e.exports=JSON.parse('{"a":"Cra"}')},649:function(e){e.exports=JSON.parse('{"a":"Bra"}')},650:function(e){e.exports=JSON.parse('{"a":"Ara"}')},651:function(e){e.exports=JSON.parse('{"a":"zra"}')},652:function(e){e.exports=JSON.parse('{"a":"yra"}')},653:function(e){e.exports=JSON.parse('{"a":"xra"}')},654:function(e){e.exports=JSON.parse('{"a":"wra"}')},655:function(e){e.exports=JSON.parse('{"a":"caa"}')},656:function(e){e.exports=JSON.parse('{"a":"baa"}')},657:function(e){e.exports=JSON.parse('{"a":"aaa"}')},658:function(e,t,n){"use strict";var r=n(887),a=n(625),o=n(292),i=n(562),c=n(583),s=n(661),u=Object.prototype.hasOwnProperty;t.a=function(e,t){var n=Object(o.a)(e),l=!n&&Object(a.a)(e),d=!n&&!l&&Object(i.a)(e),b=!n&&!l&&!d&&Object(s.a)(e),p=n||l||d||b,f=p?Object(r.a)(e.length,String):[],g=f.length;for(var h in e)!t&&!u.call(e,h)||p&&("length"==h||d&&("offset"==h||"parent"==h)||b&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||Object(c.a)(h,g))||f.push(h);return f}},659:function(e,t,n){"use strict";t.a=function(e,t){return function(n){return e(t(n))}}},660:function(e,t,n){"use strict";t.a=function(e){return function(t){return e(t)}}},661:function(e,t,n){"use strict";var r=n(311),a=n(580),o=n(303),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1;var c=function(e){return Object(o.a)(e)&&Object(a.a)(e.length)&&!!i[Object(r.a)(e)]},s=n(660),u=n(540),l=u.a&&u.a.isTypedArray,d=l?Object(s.a)(l):c;t.a=d},700:function(e,t,n){"use strict";var r=n(3),a=n(0),o=n(324),i=n(513),c=n(609),s=n(7),u=n(138),l=n(323),d=n(447),b=n(571),p=Object(u.c)((function(e,t,n){var r=Object(l.a)(e),a=Object(d.a)(e),o={root:{minWidth:"80px",height:"32px"},label:{fontWeight:s.FontWeights.semibold}};return Object(s.concatStyleSets)(r,o,n?Object(b.a)(e):Object(b.b)(e),a,t)}));n.d(t,"a",(function(){return f}));var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,n=void 0!==t&&t,c=e.styles,s=e.theme;return a.createElement(o.a,Object(r.__assign)({},this.props,{variantClassName:n?"ms-Button--primary":"ms-Button--default",styles:p(s,c,n),onRenderDescription:i.b}))},t=Object(r.__decorate)([Object(c.a)("DefaultButton",["theme","styles"],!0)],t)}(a.Component)},708:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},746:function(e){e.exports=JSON.parse('{"a":"Rqa"}')},747:function(e){e.exports=JSON.parse('{"a":"Kra"}')},748:function(e){e.exports=JSON.parse('{"a":"Jra"}')},749:function(e){e.exports=JSON.parse('{"a":"Ira"}')},750:function(e){e.exports=JSON.parse('{"a":"Hra"}')},751:function(e){e.exports=JSON.parse('{"a":"Gra"}')},752:function(e){e.exports=JSON.parse('{"a":"Fra"}')},755:function(e){e.exports=JSON.parse('{"a":"bra"}')},756:function(e){e.exports=JSON.parse('{"a":"ara"}')},757:function(e){e.exports=JSON.parse('{"a":"$qa"}')},758:function(e){e.exports=JSON.parse('{"a":"_qa"}')},759:function(e){e.exports=JSON.parse('{"a":"Zqa"}')},760:function(e){e.exports=JSON.parse('{"a":"Yqa"}')},761:function(e){e.exports=JSON.parse('{"a":"Xqa"}')},762:function(e){e.exports=JSON.parse('{"a":"Wqa"}')},763:function(e){e.exports=JSON.parse('{"a":"Vqa"}')},764:function(e){e.exports=JSON.parse('{"a":"Uqa"}')},765:function(e){e.exports=JSON.parse('{"a":"Tqa"}')},766:function(e){e.exports=JSON.parse('{"a":"Sqa"}')},775:function(e,t,n){"use strict";var r=n(590),a=n(450),o=Object.prototype.hasOwnProperty;t.a=function(e,t,n){var i=e[t];o.call(e,t)&&Object(a.a)(i,n)&&(void 0!==n||t in e)||Object(r.a)(e,t,n)}},873:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33",e.InboxPlusEasyOn="34",e.InboxRulesFromDL="35",e.GdprAdsV2="36",e.TimePanelCombinedDndFRE="47",e.UaeEduPrivacyNotification="48",e.OutlookSpacesFRE="49",e.TodoFlaggedEmailList="50",e.DynamicLayoutFolderPaneCollapse="51",e.EdgeUpsell="56",e.OutlookSpacesCapturedPaneFRE="57",e.ProofingTeachingFreeUserFRE="58",e.ProofingTeachingPremiumUserFRE="59",e.OutlookSpacesNotePaneFRE="60",e.OutlookSpacesTasksPaneFRE="61",e.OutlookSpacesGoalsPaneFRE="62",e.DefaultOnlineMeetingSetting="63",e.QuickUseFRE="64",e.GdprAdsV3="65",e.SpeedyMeetingsEndEarlySetting="66",e.InboxPlusEasyOff="67",e.ShortenEventsDurationSetting="70",e.HoneybeeClipboard="71",e.AttachmentSaveToCloudOpenAndEdit="72",e.GdprAdsEPrivacy="73",e.AdminInstalledNewAddinsFRE="75",e.InsertLinkFREOpenCompose="76",e.InsertLinkFREAfterAttach="77",e.SpotlightFre="78",e.OverlayFolderPaneFre="79",e.SpotlightPropertyIcon="80",e.GdprAdsV3ClearNull="81",e.OptionsPaneLaunch="82",e.ThemeOfTheDay="83",e.SpeedyMeetingsTenant="84",e.MailtoProtocolHandler="85",e.UnpinnedAdminAddinsFRE="86"}(r||(r={}))},874:function(e,t,n){"use strict";var r=n(577),a=n(881),o=n(880);t.a=function(e,t){return Object(o.a)(Object(a.a)(e,t,r.a),e+"")}},878:function(e,t,n){"use strict";var r=n(450),a=n(448),o=n(583),i=n(216);t.a=function(e,t,n){if(!Object(i.a)(n))return!1;var c=typeof t;return!!("number"==c?Object(a.a)(n)&&Object(o.a)(t,n.length):"string"==c&&t in n)&&Object(r.a)(n[t],e)}},879:function(e,t,n){"use strict";var r=n(537),a=n(659),o=Object(a.a)(Object.keys,Object),i=Object.prototype.hasOwnProperty;t.a=function(e){if(!Object(r.a)(e))return o(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},880:function(e,t,n){"use strict";var r=function(e){return function(){return e}},a=n(534),o=n(577),i=a.a?function(e,t){return Object(a.a)(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:o.a,c=800,s=16,u=Date.now;var l=function(e){var t=0,n=0;return function(){var r=u(),a=s-(r-n);if(n=r,a>0){if(++t>=c)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(i);t.a=l},881:function(e,t,n){"use strict";var r=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},a=Math.max;t.a=function(e,t,n){return t=a(void 0===t?e.length-1:t,0),function(){for(var o=arguments,i=-1,c=a(o.length-t,0),s=Array(c);++i<c;)s[i]=o[t+i];i=-1;for(var u=Array(t+1);++i<t;)u[i]=o[i];return u[t]=n(s),r(e,this,u)}}},886:function(e){e.exports=JSON.parse('{"a":"cra"}')},887:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},896:function(e,t,n){"use strict";var r=n(874),a=n(878);t.a=function(e){return Object(r.a)((function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,c=o>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,c&&Object(a.a)(n[0],n[1],c)&&(i=o<3?void 0:i,o=1),t=Object(t);++r<o;){var s=n[r];s&&e(t,s,r,i)}return t}))}},8995:function(e,t,n){"use strict";var r=n(23),a=function(){function e(e,t){var n=this;void 0===e&&(e=5),void 0===t&&(t=5e3),this.throttleCallbacks=[],this.activeRequests=0,this.processedRequests=0,this.lastProcessedRequests=0,this.watchDogTimer=null,this.clearQueue=function(){n.throttleCallbacks.length=0,n.activeRequests=0},this.maxConcurrentRequests=e,this.watchDogTimerInterval=t}return e.prototype.watchDogAction=function(){this.throttleCallbacks.length>0?this.processedRequests===this.lastProcessedRequests?(this.activeRequests=0,this.traceInfo("Watch dog is processing the queue."),this.processNextRequest()):(this.traceInfo("Watch dog is watching."),this.lastProcessedRequests=this.processedRequests):(window.clearInterval(this.watchDogTimer),this.watchDogTimer=null,this.traceInfo("Stop watch dog."))},e.prototype.traceInfo=function(e){r.g.info("ThrottleRequests:active="+this.activeRequests+";throttled="+this.throttleCallbacks.length+";processed="+this.processedRequests+";lastProcessed="+this.lastProcessedRequests+";info="+e)},e.prototype.processNextRequest=function(){(this.processedRequests++,0===this.throttleCallbacks.length)?(this.activeRequests>0&&this.activeRequests--,this.traceInfo("Queue is empty.")):(this.throttleCallbacks.shift()(!1),this.traceInfo("Process next."))},e.prototype.registerCallback=function(e){var t=this;if(null==e)throw new Error("A null callback is registered to Throttle Thumbnails queue.");this.activeRequests<this.maxConcurrentRequests?(e(!1),this.activeRequests++,this.processedRequests++,this.traceInfo("Process now.")):(e(!0),this.throttleCallbacks.push(e),this.traceInfo("Pushes to queue."),this.watchDogTimer||(this.watchDogTimer=window.setInterval((function(){t.watchDogAction()}),this.watchDogTimerInterval),this.traceInfo("Start watch dog.")))},e.prototype.unregisterCallback=function(e){var t=this.throttleCallbacks.indexOf(e);this.throttleCallbacks.splice(t,1),this.activeRequests=0,this.traceInfo("unregisterComponent:"+t)},e}();t.a=a},915:function(e,t,n){"use strict";t.a=function(){return!1}}}]);
//# sourceMappingURL=owa.MailBoot~ActionableMessageMail.js.map
self.scriptsLoaded['owa.MailBoot~ActionableMessageMail.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ActionableMessageMail.js'] = (new Date()).getTime();