self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ActionableMessageMail~OwaBotConversation.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[217],{10127:function(e){e.exports=JSON.parse('{"a":"Bwc"}')},6328:function(e,t,r){"use strict";var n,i,o=r(1);!function(e){e[e.Elemental=0]="Elemental",e[e.Action=1]="Action",e[e.HttpAction=2]="HttpAction",e[e.ExtendedAction=3]="ExtendedAction",e[e.Render=4]="Render"}(i||(i={}));var a,s=((n={})[i.Elemental]=["ActionCardExpanded","ActionCardCollapsed","MessageCardHidden","MessageCardRemoved","MessageCardViewActionClicked","TransactionCardDisabled"],n[i.Action]=["ToggleVisibilityActionClick","DisplayAppointmentFormClicked","DisplayMessageFormClicked","MessageCardPinAddinCommandClicked","MessageCardInvokeAddinCommandClicked","TransactionActionEvent"],n[i.HttpAction]=["ActionCardHttpPostActionClicked","SingleClickHttpPostActionClicked","AutoInvokeActionClicked"],n[i.ExtendedAction]=["HttpPostActionExecuted"],n[i.Render]=["MessageCardRendered"],n),d=function(e){return s[i.Render].includes(e)?i.Render:s[i.ExtendedAction].includes(e)?i.ExtendedAction:s[i.HttpAction].includes(e)?i.HttpAction:s[i.Action].includes(e)?i.Action:i.Elemental},c="WAC_Outlook_React",l=r(4),p=function(){var e="20000101001",t=Object(l.r)();return t&&(e=t),e="16."+(e=e.replace(/[^\d]/g,"")).substr(0,4)+"."+e.substr(4,4)+"."+e.substr(8)},u=r(57),C=r(12),v=function(e){function t(t,r){var n=e.call(this)||this;return n.setElementalProperties(t,r),n}return Object(o.e)(t,e),t.prototype.setElementalProperties=function(e,t){this.setProperty("eventName",e),(null==t?void 0:t.itemId)&&this.setProperty("messageId",t.itemId)},t}(function(){function e(){this.properties={};var e=Object(u.h)().SessionSettings||{};this.properties.clientType=c,this.properties.clientVersion=p(),this.properties.forest=Object(l.u)(),this.properties["UserInfo.Id"]=e.UserPuid,this.properties["UserInfo.PrimaryIdentityHash"]=e.ExternalDirectoryUserGuid,this.properties.clientId=Object(l.q)(),this.properties.tenantGuid=e.ExternalDirectoryTenantGuid,this.properties.sessionId=Object(l.H)(),this.properties.physicalRing=Object(C.f)()}return e.prototype.setProperty=function(e,t){this.properties[e]=t},e.prototype.getProperties=function(){return this.properties},e}()),g=function(e){function t(t,r,n){var i=e.call(this,t,r)||this;return i.setActionProperties(n),i}return Object(o.e)(t,e),t.prototype.setActionProperties=function(e){var t="30d2f5e2-6e6f-43b0-a2bd-c9d87a5cd6fd";(null==e?void 0:e.id)&&(t=e.id),this.setProperty("actionId",t)},t}(v);!function(e){e.ExplicitMessageCard="explicitMessageCard",e.AdaptiveCard="adaptiveCard",e.AdaptiveCardV2="adaptiveCardV2"}(a||(a={}));var f=a,y=r(93),h=r(23),x=function(e){function t(t,r,n,i,o){var a=e.call(this,t,r,i)||this;return a.setHttpActionProperties(r,n,o),a}return Object(o.e)(t,e),t.prototype.setHttpActionProperties=function(e,t,r){var n,i,o,a=Object(u.h)().SessionSettings||{};if(null==a?void 0:a.UserCulture){var s=a.UserCulture;this.setProperty("culture",s),this.setProperty("uiCulture",s)}if((null==a?void 0:a.ExternalDirectoryUserGuid)&&this.setProperty("externalDirectoryUserGuid",a.ExternalDirectoryUserGuid),(null==a?void 0:a.ExternalDirectoryTenantGuid)&&this.setProperty("externalDirectoryTenantGuid",a.ExternalDirectoryTenantGuid),this.setProperty("messageType",t.isAdaptiveCard?f.AdaptiveCard:f.ExplicitMessageCard),this.setProperty("correlationVector",Object(y.b)()),null===(n=null==e?void 0:e.mailboxInfo)||void 0===n?void 0:n.type){var d="GroupMailbox"===e.mailboxInfo.type;this.setProperty("mailboxType",d?"Group":"User")}if((null==e?void 0:e.senderAddress)&&this.setProperty("senderAddress",e.senderAddress),(null==e?void 0:e.isGroupEscalationMessage)&&this.setProperty("isGroupEscalationMessage",e.isGroupEscalationMessage),(null==e?void 0:e.conversationId)&&this.setProperty("conversationId",e.conversationId),(null===(i=null==t?void 0:t.card)||void 0===i?void 0:i.originator)&&this.setProperty("originator",t.card.originator),(null==t?void 0:t.connectorSenderGuid)&&this.setProperty("connectorSenderGuid",t.connectorSenderGuid),(null==t?void 0:t.providerAccountUniqueId)&&this.setProperty("providerAccountUniqueId",t.providerAccountUniqueId),null===(o=null==t?void 0:t.card)||void 0===o?void 0:o.messageCardContext)try{var c="string"==typeof t.card.messageCardContext?t.card.messageCardContext:JSON.stringify(t.card.messageCardContext);this.setProperty("messageCardContext",c)}catch(e){h.g.info("[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify messageCardContext: "+e)}if(null==t?void 0:t.messageCardExtensionContext)try{var l="string"==typeof t.messageCardExtensionContext?t.messageCardExtensionContext:JSON.stringify(t.messageCardExtensionContext);this.setProperty("messageCardExtensionContext",l)}catch(e){h.g.info("[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify messageCardExtensionContext: "+e)}if(r)try{this.setProperty("actionContext","string"==typeof r?r:JSON.stringify(r))}catch(e){h.g.info("[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify actionContext: "+e)}},t}(g),b=function(e){var t="[";return Object.keys(e).forEach((function(r,n){0!==n&&(t+=", "),t+='"'+r+'": "'+e[r]+'"'})),t+="]"},E=r(5);function A(e){return 0===Object.keys(e).length}var m=function(e){function t(t,r,n,i){var o=e.call(this,t,r,n)||this;return o.setExtendedActionProperties(i),o}return Object(o.e)(t,e),t.prototype.setExtendedActionProperties=function(e){if(e){var t=function(e){var t=[],r=e.previousCardCheckpoints&&!A(e.previousCardCheckpoints)?e.previousCardCheckpoints:e.currentCardCheckpoints,n=null;e.previousCardCheckpoints&&!A(e.previousCardCheckpoints)&&(n=e.currentCardCheckpoints);var i=Object(E.w)(r.cardCreateEnd,r.cardCreateStart);t.ICPT=i;var o=Object(E.w)(r.cardRenderEnd,r.cardRenderStart);t.ICRT=o;var a=Object(E.w)(r.themeLoadTotalEnd,r.themeLoadTotalStart);t.ICTT=a;var s=r.totalFetchTime;t.ICFT=s;var d=Object(E.w)(r.cardLibraryRenderEnd,r.cardLibraryRenderStart);t.ICHT=d;var c=Object(E.w)(r.prepareCardEnd,r.prepareCardStart);if(t.IPPT=c,n){var l=Object(E.w)(n.cardCreateEnd,n.cardCreateStart);t.FCPT=l;var p=Object(E.w)(n.cardRenderEnd,n.cardRenderStart);t.FCRT=p;var u=Object(E.w)(n.themeLoadTotalEnd,n.themeLoadTotalStart);if(t.FCTT=u,n.totalFetchTime){var C=n.totalFetchTime;t.FCFT=C}var v=Object(E.w)(n.cardLibraryRenderEnd,n.cardLibraryRenderStart);t.FCHT=v;var g=Object(E.w)(n.prepareCardEnd,n.prepareCardStart);t.FPPT=g}if(e.autoInvokeActionStart&&e.autoInvokeActionEnd){var f=Object(E.w)(e.autoInvokeActionEnd,e.autoInvokeActionStart);t.AIT=f}var y=Object(E.w)(n?n.cardRenderEnd:r.cardRenderEnd,e.loadStart);return t.TCRT=y,b(t)}(e);this.setProperty("genericInfo",t)}},t}(g),P=r(3596),O=function(e){function t(t,r,n,i,o,a){var s=e.call(this,t,r,i,a)||this;return s.setRenderProperties(r,n,o),s}return Object(o.e)(t,e),t.prototype.isACv2Card=function(e){var t=!1;if(e){var r=new P.SerializationContext,n=P.Version.parse(e,r),i=P.Version.parse("1.4",r);try{t=n.compareTo(i)>=0}catch(e){}}return t},t.prototype.setRenderProperties=function(e,t,r){var n,i,o,a;if((null==e?void 0:e.isGroupEscalationMessage)&&this.setProperty("isGroupEscalationMessage",e.isGroupEscalationMessage),(null==e?void 0:e.conversationId)&&this.setProperty("conversationId",e.conversationId),this.setProperty("messageType",t.isAdaptiveCard?this.isACv2Card(null===(n=null==t?void 0:t.card)||void 0===n?void 0:n.version)?f.AdaptiveCardV2:f.AdaptiveCard:f.ExplicitMessageCard),(null===(i=null==e?void 0:e.mailboxInfo)||void 0===i?void 0:i.type)&&this.setProperty("isGroupMailbox","GroupMailbox"===e.mailboxInfo.type),(null===(o=null==t?void 0:t.card)||void 0===o?void 0:o.originator)&&this.setProperty("originator",t.card.originator),(null==t?void 0:t.connectorSenderGuid)&&this.setProperty("connectorSenderGuid",t.connectorSenderGuid),null===(a=null==t?void 0:t.card)||void 0===a?void 0:a.messageCardContext)try{var s="string"==typeof t.card.messageCardContext?t.card.messageCardContext:JSON.stringify(t.card.messageCardContext);this.setProperty("messageCardContext",s)}catch(e){h.g.info("[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify messageCardContext: "+e)}if(null==t?void 0:t.messageCardExtensionContext)try{var d="string"==typeof t.messageCardExtensionContext?t.messageCardExtensionContext:JSON.stringify(t.messageCardExtensionContext);this.setProperty("messageCardExtensionContext",d)}catch(e){h.g.info("[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify messageCardExtensionContext: "+e)}if(r)try{this.setProperty("actionContext","string"==typeof r?r:JSON.stringify(r))}catch(e){h.g.info("[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify actionContext: "+e)}},t}(m),S=function(e){var t=e.eventName,r=e.messageContext,n=e.cardDetails,o=e.elementDetails,a=e.actionContext,s=e.perfCheckpoints;if(void 0!==t){var c;switch(d(t)){case i.Elemental:c=new v(t,r);break;case i.Action:c=new g(t,r,o);break;case i.HttpAction:c=new x(t,r,n,o,a);break;case i.ExtendedAction:c=new m(t,r,o,s);break;case i.Render:c=new O(t,r,n,o,a,s)}return c.getProperties()}},I=r(8),T=function(){return I.e||Object(l.K)()},w=r(121),j=function(e){return Object(o.c)(void 0,void 0,void 0,(function(){var t,r,n;return Object(o.f)(this,(function(i){switch(i.label){case 0:return T()?[2]:(t=S(e),[4,Object(w.h)()]);case 1:return r=i.sent(),n={name:"client_event",properties:t||{}},r.logEvent(n),[2]}}))}))};r.d(t,"c",(function(){return k})),r.d(t,"b",(function(){return S})),r.d(t,"a",(function(){return p}));var k={logTelemetry:j}},8362:function(e){e.exports=JSON.parse('{"a":"Awc"}')}}]);
//# sourceMappingURL=owa.MailBoot~ActionableMessageMail~OwaBotConversation.js.map
self.scriptsLoaded['owa.MailBoot~ActionableMessageMail~OwaBotConversation.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ActionableMessageMail~OwaBotConversation.js'] = (new Date()).getTime();