self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AddinsExpUI~FilesHubPersonaList~GroupAddMemberV2~GroupAddMembersV2Opx~GroupEditV2Opx~MailDe~87408052.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[65],{1985:function(e,t,r){"use strict";r.r(t);var n=r(31),o=r(2),a=r(2960),i=r(7893),u=r(7894),c=r(7895);Object(o.mutator)(a.a,(function(e){var t=e.temporaryData,r=e.favoriteData,n=e.newIndex;Object(u.a)(t),Object(c.b)(t),Object(i.a)(r,n)})),Object(o.mutator)(a.c,(function(e){var t=e.favoriteData,r=e.newIndex;Object(i.a)(t,r),Object(c.a)(t)})),Object(o.mutator)(a.d,(function(e){var t=e.favoriteData;Object(i.a)(t)})),Object(o.mutator)(a.b,(function(e){var t=e.favoriteData;Object(c.b)(t),Object(u.a)(t)})),Object(o.mutator)(a.e,(function(e){var t=e.temporaryFavorites,r=e.favoritesData;t.forEach((function(e){Object(u.a)(e)})),r.forEach((function(e){Object(i.a)(e)}))})),Object(o.mutator)(a.f,(function(e){e.favoritesData.forEach((function(e){Object(i.a)(e)}))}));var d=r(2422),s=Object(o.action)("ADD_TO_ORDERED_FAVORITE_ID_LIST",(function(e){return{favoriteId:e}})),l=(Object(o.mutator)(s,(function(e){d.a.orderedOutlookFavoritesIds.push(e.favoriteId)})),r(5871)),f=(Object(o.mutator)(l.a,(function(e){d.a.favoritesLoaded=!0})),r(1)),v=Object(o.action)("ADD_NEW_MAILBOX_DEFAULT_FAVORITES"),b=r(1244),p=r(1951),O=r(3450);function F(e,t,r){return{folderId:t.FolderId.Id,treeType:"favorites",type:"folder",favoriteId:e,displayName:Object(p.i)(t),client:r?"MigrateDefault":"OWA"}}function j(e,t){return{Type:"folder",DisplayName:Object(p.i)(e),SingleValueSettings:[{Key:"FolderId",Value:Object(de.a)(e.FolderId.Id)}],Client:t?"MigrateDefault":"OWA"}}var y=r(203),m=r(4387),g=r(151),I=r(4823);function h(e){return Object(I.a)((function(){return Object(g.e)(m.a+"/Create",e,void 0,!0,null,!0)}))}Object(o.orchestrator)(v,(function(e){return Object(f.c)(void 0,void 0,void 0,(function(){var e,t,r,n,o,i,u,c,d,s,l,v,m,g,I;return Object(f.f)(this,(function(S){switch(S.label){case 0:e=[Object(b.a)("inbox"),Object(b.a)("drafts"),Object(b.a)("archive")],t=[],r=[];try{for(n=Object(f.k)(e),o=n.next();!o.done;o=n.next())i=o.value,u=Object(y.a)(),c=p.d.folderTable.get(i),d=j(c,!0),s=F(u,c,!0),t.push(d),r.push(s)}catch(e){g={error:e}}finally{try{o&&!o.done&&(I=n.return)&&I.call(n)}finally{if(g)throw g.error}}S.label=1;case 1:return S.trys.push([1,3,,4]),[4,h(t)];case 2:return l=S.sent(),v=(l.value||[]).map((function(e){return Object(O.a)(e,"folder")})),Object(a.e)(r,v),[3,4];case 3:return m=S.sent(),r.forEach((function(e){return Object(a.b)(m,e)})),[3,4];case 4:return[2]}}))}))}));var S=r(2715),A=r(5470),w=r(19),N=r(3451),D=r(6954),T=r(44),C=Object(o.action)("MIGRATE_OUTLOOK_FAVORITES",(function(){return Object(T.c)(D.a.MigrateOutlookFavorites)})),E=r(1085),V=r(24),M=r(121),k=r(4388);var P=36e5;function L(){return Object(f.c)(this,void 0,void 0,(function(){var e;return Object(f.f)(this,(function(t){switch(t.label){case 0:return d.a.favoritesLoaded?[2]:(0===p.d.folderTable.size&&Object(p.w)(),[4,R()]);case 1:return t.sent(),e=Object(k.a)(2),Object(k.a)(16)||C(),e||(0==d.a.orderedOutlookFavoritesIds.length&&(O=new Date(Object(w.a)().MailboxCreateDate),Date.now()-O.getTime()<P)&&v(),Me.importAndExecute(2)),Object(l.a)(),r=Object(f.j)([],Object(f.g)(d.a.outlookFavorites.values())),n=r.filter((function(e){return"folder"===e.type})),o=n.filter((function(e){return"Migration"===e.client})),a=r.filter((function(e){return"category"===e.type})),i=a.filter((function(e){return"Migration"==e.client})),u=r.filter((function(e){return"persona"===e.type})),c=u.filter((function(e){return"Migration"==e.client})),s=r.filter((function(e){return"group"===e.type})),b=r.filter((function(e){return"privatedistributionlist"===e.type})),Object(M.s)("LoadOutlookFavorites",[n.length,s.length,a.length,u.length,b.length,o.length,i.length,c.length]),[2]}var r,n,o,a,i,u,c,s,b,O}))}))}function R(){var e,t;return Object(f.c)(this,void 0,void 0,(function(){var r,n,o,i,u;return Object(f.f)(this,(function(c){switch(c.label){case 0:if(r=Object(w.a)(),n=null===(e=Object(N.a)())||void 0===e?void 0:e.value,o=null===(t=null==r?void 0:r.SessionSettings)||void 0===t?void 0:t.IsExplicitLogon,n||o)return[3,5];i=void 0,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,Object(g.b)(m.a,void 0,!1,void 0,!0)];case 2:return i=c.sent(),[3,4];case 3:return u=c.sent(),Object(M.s)("GetOutlookFavoritesRetryFailed",{errorMessage:u.toString()}),[2];case 4:if(!(n=null==i?void 0:i.value))return[2];Object(M.s)("FavoritesRetrySuccess"),c.label=5;case 5:return null==n||n.forEach((function(e){var t=e.Type.toLocaleLowerCase(),r=null;try{switch(r=Object(O.a)(e,t),t){case"folder":!function(e,t){(function(e,t){if(0===p.d.folderTable.size)return!1;return!d.a.outlookFavorites.has(e)&&p.d.folderTable.has(t)})(t,e.folderId)&&Object(a.d)(e)}(r,e.SingleValueSettings[0].Value);break;case"persona":Object(a.d)(r);break;case"group":!function(e){Object(K.d)(e.groupId)||Object(a.d)(e)}(r);break;case"category":!function(e){(function(e){return Object(E.q)(e.categoryId)&&!d.a.outlookFavorites.has(e.favoriteId)})(e)&&(Object(a.d)(e),E.z.importAndExecute())}(r);break;case"privatedistributionlist":Object(V.i)("peo-favoritePdls")&&Object(a.d)(r);break;default:s(r.favoriteId)}}catch(e){Object(M.s)("AddFavoriteToStoreInitialFailed",{favoriteType:t,errorMessage:e.toString()})}})),[2]}}))}))}Object(o.orchestrator)(S.a,(function(e){Object(V.i)("tri-favorites-roaming")?L():Object(A.b)()}));var z=r(3935),K=r(3077),x=r(3672);function U(){var e=Object(d.b)();return Object(V.i)("tri-favorites-roaming")?Object(f.j)([],Object(f.g)(e.outlookFavorites.entries())).filter((function(e){var t=Object(f.g)(e,2);t[0];return"persona"===t[1].type})).map((function(e){var t=Object(f.g)(e,2),r=t[0];t[1];return r})):Object(f.j)([],Object(f.g)(e.favoritesPersonaNodes.keys()))}function _(e){var t=Object(d.b)();return Object(V.i)("tri-favorites-roaming")?t.outlookFavorites.get(e):t.favoritesPersonaNodes.get(e)}function W(e){var t=_(e);return t?t.mainEmailAddress:null}function G(e){var t=_(e);return t?t.displayName:null}var J=r(5474),B=r(4825),q=r(6956),Y=r(6957),$=r(6),Q=r(2625),H=r(20),X=r(0),Z=Object(H.a)((function(e){var t,r=e.isInFavorites,n=e.isClickDisabled,o=e.animate,a=e.iconStyles,i=e.buttonStyles,u=e.spinnerStyles,c=e.tooltipStyles,d=e.onClick,s=e.isCategory,l=Object(w.a)();if(null===(t=null==l?void 0:l.SessionSettings)||void 0===t?void 0:t.IsExplicitLogon)return null;var f=s?Object($.b)(Y.a):Object($.b)(B.a),v=s?Object($.b)(q.a):Object($.b)(J.a);return X.createElement(Q.a,{isStarred:r,onClick:d,isClickDisabled:n,animate:o,iconStyles:a,buttonStyles:i,spinnerStyles:u,tooltipStyles:c,ariaLabelText:r?f:v,tooltip:{starred:f,unstarred:v}})})),ee=r(4824),te=r(5403),re=r(5471),ne=r(6426),oe=r(4389),ae=r(4826),ie=r(5473);function ue(e){return Object(V.i)("tri-favorites-roaming")?Object(f.j)([],Object(f.g)(d.a.outlookFavorites.values())).filter((function(e){return"persona"===e.type})).some((function(t){return t.searchFolderId&&t.searchFolderId===e})):Object(f.j)([],Object(f.g)(d.a.favoritesPersonaNodes.values())).some((function(t){return t.searchFolderId&&t.searchFolderId===e}))}function ce(e){return!!Object(V.i)("tri-favorites-roaming")&&Object(f.j)([],Object(f.g)(d.a.outlookFavorites.values())).filter((function(e){return"privatedistributionlist"===e.type})).some((function(t){return t.searchFolderId&&t.searchFolderId===e}))}var de=r(4208),se=r(5472),le=r(5475),fe=r(6427),ve=r(5037),be=r(6428),pe=r(5872),Oe=r(6955);function Fe(e,t){return function(e){var t=Object(f.j)([],Object(f.g)(d.a.outlookFavorites.values())).filter((function(t){return"privatedistributionlist"===t.type&&t.pdlId===e}));return t.length>0?t[0].favoriteId:void 0}(e)||function(e){var t=Object(f.j)([],Object(f.g)(d.a.outlookFavorites.values())).filter((function(t){return"privatedistributionlist"===t.type&&Object(Oe.a)(t.members,e)}));return t.length>0?t[0].favoriteId:void 0}(t)}r.d(t,"lazyMigrateFavorites",(function(){return ye})),r.d(t,"lazyMoveFavoriteUpDown",(function(){return me})),r.d(t,"lazyUpdateFavoritePosition",(function(){return ge})),r.d(t,"lazyAddFavoriteCategory",(function(){return Ie})),r.d(t,"lazyRemoveFavoriteCategory",(function(){return he})),r.d(t,"lazyRemoveFavoritePersonaV2",(function(){return Se})),r.d(t,"lazyAddFavoritePersonaV2",(function(){return Ae})),r.d(t,"lazyRemoveFavoriteGroup",(function(){return we})),r.d(t,"lazyAddFavoriteGroup",(function(){return Ne})),r.d(t,"lazyRemoveFavoriteFolderV2",(function(){return De})),r.d(t,"lazyAddFavoriteFolderV2",(function(){return Te})),r.d(t,"lazyRemoveFavoritePrivateDistributionList",(function(){return Ce})),r.d(t,"lazyAddFavoritePrivateDistributionList",(function(){return Ee})),r.d(t,"lazyEditFavoritePrivateDistributionList",(function(){return Ve})),r.d(t,"lazySetOutlookFavoritesBitFlag",(function(){return Me})),r.d(t,"lazyAddFavoriteToStore",(function(){return ke})),r.d(t,"lazyAddFavoriteCompleted",(function(){return Pe})),r.d(t,"lazyAddFavoriteFailed",(function(){return Le})),r.d(t,"lazyAddMultipleFavoritesToStore",(function(){return Re})),r.d(t,"lazyAddMultipleFavoritesCompleted",(function(){return ze})),r.d(t,"lazyRemoveFavoriteFromStore",(function(){return Ke})),r.d(t,"lazyRemoveFavoriteCompleted",(function(){return xe})),r.d(t,"lazyRemoveFavoriteFailed",(function(){return Ue})),r.d(t,"addFavoriteFailed",(function(){return a.b})),r.d(t,"addFavoriteToStoreInitial",(function(){return a.d})),r.d(t,"removeFavoriteFailed",(function(){return z.b})),r.d(t,"getStore",(function(){return d.b})),r.d(t,"favoritesStore",(function(){return d.a})),r.d(t,"loadFavorites",(function(){return S.a})),r.d(t,"isFolderInFavorites",(function(){return K.c})),r.d(t,"isGroupInFavorites",(function(){return K.d})),r.d(t,"isPersonaInFavorites",(function(){return K.e})),r.d(t,"isSearchInFavorites",(function(){return K.h})),r.d(t,"isCategoryInFavorites",(function(){return K.b})),r.d(t,"isPublicFolderInFavorites",(function(){return K.g})),r.d(t,"isPrivateDLInFavorites",(function(){return K.f})),r.d(t,"getPersonaFromPersonIdOrEmailAddress",(function(){return K.a})),r.d(t,"isOutlookFavoritingInProgress",(function(){return x.a})),r.d(t,"getFavoriteIdsForPersonaFavorites",(function(){return U})),r.d(t,"getFavoritePersonaEmail",(function(){return W})),r.d(t,"getFavoritePersonaDisplayName",(function(){return G})),r.d(t,"ToggleFavoriteButton",(function(){return Z})),r.d(t,"parseFavoriteNode",(function(){return ee.a})),r.d(t,"updateFavoritesUserOption",(function(){return te.a})),r.d(t,"addFavoriteToStoreV1",(function(){return A.a})),r.d(t,"getIsBitEnabled",(function(){return k.a})),r.d(t,"getFavoriteIdFromGroupId",(function(){return re.a})),r.d(t,"editOutlookFavoriteService",(function(){return ne.a})),r.d(t,"createOutlookFavoriteService",(function(){return oe.a})),r.d(t,"deleteOutlookFavoriteService",(function(){return ae.a})),r.d(t,"getFavoriteIdFromFolderId",(function(){return ie.a})),r.d(t,"isFolderPersonaFavoriteSearchFolder",(function(){return ue})),r.d(t,"isFolderPrivateDLFavoriteSearchFolder",(function(){return ce})),r.d(t,"convertEWSFolderIdToRestFolderId",(function(){return de.a})),r.d(t,"convertRestFolderIdToEWSFolderId",(function(){return de.b})),r.d(t,"getFavoriteIdFromCategoryId",(function(){return se.a})),r.d(t,"createMultipleOutlookFavoritesService",(function(){return h})),r.d(t,"createClientFavoriteCategoryData",(function(){return le.a})),r.d(t,"createOwsFavoriteCategoryData",(function(){return le.b})),r.d(t,"createOwsFavoriteFolderData",(function(){return fe.a})),r.d(t,"migrateOutlookFavorites",(function(){return C})),r.d(t,"onCategoryFavorited",(function(){return ve.a})),r.d(t,"onCategoryUnfavorited",(function(){return ve.b})),r.d(t,"convertFavoritePersonaDataToFavoritePersonaNode",(function(){return be.a})),r.d(t,"convertFavoritePdlDataToFavoritePdlNode",(function(){return pe.a})),r.d(t,"convertServiceResponseToFavoriteData",(function(){return O.a})),r.d(t,"getSingleValueSettingValueForKey",(function(){return O.b})),r.d(t,"getFavoriteIdForPDL",(function(){return Fe}));var je=new n.c((function(){return r.e(631).then(r.bind(null,18190))})),ye=new n.a(je,(function(e){return e.migrateFavorites})),me=new n.b(je,(function(e){return e.moveFavoriteUpDown})),ge=new n.b(je,(function(e){return e.updateFavoritePosition})),Ie=new n.b(je,(function(e){return e.addFavoriteCategory})),he=new n.b(je,(function(e){return e.removeFavoriteCategory})),Se=new n.b(je,(function(e){return e.removeFavoritePersonaV2})),Ae=new n.b(je,(function(e){return e.addFavoritePersonaV2})),we=new n.b(je,(function(e){return e.removeFavoriteGroup})),Ne=new n.b(je,(function(e){return e.addFavoriteGroup})),De=new n.b(je,(function(e){return e.removeFavoriteFolderV2})),Te=new n.b(je,(function(e){return e.addFavoriteFolderV2})),Ce=new n.b(je,(function(e){return e.removeFavoritePrivateDistributionList})),Ee=new n.b(je,(function(e){return e.addFavoritePrivateDistributionList})),Ve=new n.b(je,(function(e){return e.editFavoritePrivateDistributionList})),Me=new n.a(je,(function(e){return e.setOutlookFavoritesBitFlag})),ke=new n.b(je,(function(e){return e.addFavoriteToStore})),Pe=new n.b(je,(function(e){return e.addFavoriteCompleted})),Le=new n.b(je,(function(e){return e.addFavoriteFailed})),Re=new n.b(je,(function(e){return e.addMultipleFavoritesToStore})),ze=new n.b(je,(function(e){return e.addMultipleFavoritesCompleted})),Ke=new n.b(je,(function(e){return e.removeFavoriteFromStore})),xe=new n.b(je,(function(e){return e.removeFavoriteCompleted})),Ue=new n.b(je,(function(e){return e.removeFavoriteFailed}))},2422:function(e,t,r){"use strict";r.d(t,"b",(function(){return i}));var n=r(14),o=r(2),a={favoritesFolderNodes:new n.ObservableMap,favoritesPersonaNodes:new n.ObservableMap,favoriteSearches:new n.ObservableMap,favoriteCategories:new n.ObservableMap,orderedFavoritesNodeIds:[],orderedOutlookFavoritesIds:[],outlookFavorites:new n.ObservableMap,favoriteSecondaryKeyMap:new n.ObservableMap,favoritingInProgressMap:new n.ObservableMap,favoritesLoaded:!1},i=Object(o.createStore)("favorites",a);t.a=i()},2960:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"e",(function(){return i})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return d})),r.d(t,"f",(function(){return s}));var n=r(2),o=r(44),a=Object(n.action)("addFavoriteCompleted",(function(e,t,r){return Object(o.c)({name:"AddFavoriteCompleted",customData:{temporaryFavoriteId:e.favoriteId,favoriteId:t.favoriteId,favoriteKind:t.type}},{temporaryData:e,favoriteData:t,newIndex:r})})),i=Object(n.action)("addMultipleFavoritesCompleted",(function(e,t){return Object(o.c)({name:"AddMultipleFavoritesCompleted"},{temporaryFavorites:e,favoritesData:t})})),u=Object(n.action)("addFavoriteFailed",(function(e,t){return Object(o.c)({name:"AddFavoriteFailed",customData:{errorMessage:e?e.message:"Undefined error",cV:e?e.correlationVector:"Undefined error",favoriteId:t.favoriteId,favoriteKind:t.type}},{error:e,favoriteData:t,favoriteKind:t.type})})),c=Object(n.action)("addFavoriteToStore",(function(e,t){return Object(o.c)({name:"AddFavoriteToStore",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e,newIndex:t})})),d=Object(n.action)("addFavoriteToStoreInitial",(function(e){return Object(o.c)({name:"AddFavoriteToStoreInitial",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})})),s=Object(n.action)("addMultipleFavoritesToStore",(function(e){return Object(o.c)({name:"AddMultipleFavoritesToStore"},{favoritesData:e})}))},3077:function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return l})),r.d(t,"h",(function(){return f})),r.d(t,"b",(function(){return v})),r.d(t,"e",(function(){return b})),r.d(t,"f",(function(){return p})),r.d(t,"g",(function(){return O})),r.d(t,"a",(function(){return F}));var n=r(1),o=r(2422),a=r(24),i=r(6955),u=r(5471),c=r(5472),d=r(5473);function s(e){return Object(a.i)("tri-favorites-roaming")?!!Object(d.a)(e):Object(o.b)().favoritesFolderNodes.has(e)}function l(e){return!!Object(u.a)(e)}function f(e){return Object(a.i)("tri-favorites-roaming")?Object(n.j)([],Object(n.g)(Object(o.b)().outlookFavorites.values())).filter((function(e){return"search"===e.type})).some((function(t){return t.searchQuery===e})):Object(o.b)().favoriteSearches.has(e)}function v(e){return Object(a.i)("tri-favorites-roaming")?!!Object(c.a)(e):Object(o.b)().favoriteCategories.has(e)}function b(e,t){return null!==F(e,t)}function p(e,t){return Object(n.j)([],Object(n.g)(Object(o.b)().outlookFavorites.values())).filter((function(e){return"privatedistributionlist"===e.type})).some((function(r){return r.pdlId===e||Object(i.a)(r.members,t)}))}function O(e){return Object(o.b)().favoriteSecondaryKeyMap.has(e)}function F(e,t){var r=Object(o.b)(),i=null;Object(a.i)("tri-favorites-roaming")?i=Object(n.j)([],Object(n.g)(r.outlookFavorites.values())).filter((function(r){return"persona"===r.type&&j(r,e,t)})):i=Object(n.j)([],Object(n.g)(r.favoritesPersonaNodes.values())).filter((function(r){return j(r,e,t)}));return i&&i.length>0?i[0]:null}function j(e,t,r){return t&&e.personaId===t||r&&e.allEmailAddresses&&e.allEmailAddresses.some((function(e){return e&&e.toLocaleLowerCase()===r.toLocaleLowerCase()}))}},3450:function(e,t,r){"use strict";r.d(t,"b",(function(){return b})),r.d(t,"a",(function(){return O}));var n=r(4208),o="SearchFolderId",a="PersonaId",i="MainEmailAddress",u="EmailAddresses",c="ContactDisplayName",d="ContactMainEmailAddress",s="PdlId",l="MemberNames",f="EmailAddress",v="ExtDirId";function b(e,t){var r=e.SingleValueSettings&&e.SingleValueSettings.filter((function(e){return e.Key==t}));return r&&1===r.length?r[0].Value:void 0}function p(e,t){var r=e.MultiValueSettings&&e.MultiValueSettings.filter((function(e){return e.Key==t}));return r&&1===r.length?r[0].Values:[]}function O(e,t){var r;switch(t){case"folder":r={type:"folder",folderId:Object(n.b)(e.SingleValueSettings[0].Value)};break;case"persona":var O=b(e,o),F=O?Object(n.b)(O):null;r={type:"persona",searchFolderId:F,allEmailAddresses:p(e,u),mainEmailAddress:b(e,i),isSearchFolderPopulated:!!F,personaId:b(e,a),contactDisplayName:b(e,c),contactMainEmailAddress:b(e,d),isSyncUpdateDone:!1};break;case"privatedistributionlist":for(var j=b(e,o),y=j?Object(n.b)(j):null,m=b(e,s),g=b(e,"PersonaId"),I=g?Object(n.b)(g):null,h=p(e,u),S=p(e,l),A=[],w=0;w<h.length;w++)A.push({name:S[w],emailAddress:h[w]});r={type:"privatedistributionlist",searchFolderId:y,isSearchFolderPopulated:!!y,pdlId:m,members:A,owsPersonaId:I};break;case"group":r={type:"group",groupId:e.SingleValueSettings[0].Value.toLowerCase(),groupSmtp:b(e,f).toLowerCase(),groupExternalDirectoryObjectId:b(e,v)};break;case"category":r={type:"category",categoryId:e.SingleValueSettings[0].Value};break;case"search":r={type:"search",searchQuery:e.SingleValueSettings[0].Value};break;case"publicFolder":r={type:"publicFolder",publicFolderId:b(e,"FolderId")};break;default:r={type:e.Type}}return r.treeType="favorites",r.favoriteId=e.Id,r.displayName=e.DisplayName,r.client=e.Client,r.lastModifiedTime=e.LastModifiedTime,r}},3672:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(2422),o=r(5036);function a(e){if(!e)return!1;var t=n.a.favoritingInProgressMap;return"string"==typeof e?t.has(e):t.has(Object(o.a)(e))}},3935:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return u}));var n=r(2),o=r(44),a=Object(n.action)("removeFavoriteCompleted",(function(e){return Object(o.c)({name:"RemoveFavoriteCompleted",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})})),i=Object(n.action)("removeFavoriteFailed",(function(e,t){return Object(o.c)({name:"RemoveFavoriteFailed",customData:{errorMessage:e?e.message:"Undefined error",cV:e?e.correlationVector:"Undefined error",favoriteId:t.favoriteId,favoriteKind:t.type}},{error:e,favoriteData:t,favoriteKind:t.type})})),u=Object(n.action)("removeFavoriteFromStore",(function(e){return Object(o.c)({name:"RemoveFavoriteFromStore",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})}))},4208:function(e,t,r){"use strict";function n(e){return a(a(e,"/","-"),"+","_")}function o(e){return a(a(e,"-","/"),"_","+")}function a(e,t,r){return e.split(t).join(r)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}))},4387:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n="ows/api/beta/outlookfavorites"},4388:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(19),o=r(296);function a(e){return!!(e&Object(n.a)().UserOptions.FavoritesBitFlags)}function i(e,t){Object(o.a)((function(r){e?r.UserOptions.FavoritesBitFlags|=t:r.UserOptions.FavoritesBitFlags&=~t}))}},4389:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(4387),o=r(151),a=r(4823);function i(e){return Object(a.a)((function(){return Object(o.e)(n.a,e,void 0,!0,null,!0)}))}},4823:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(1),o=r(217),a=/cv=([^&]+)&?.*$/;function i(e){var t;return Object(n.c)(this,void 0,void 0,(function(){var r,i,u,c;return Object(n.f)(this,(function(n){switch(n.label){case 0:r=!1,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,e()];case 2:return[4,(i=n.sent()).text().then((function(e){return e?JSON.parse(e):{}}))];case 3:if(u=n.sent(),Object(o.a)(i.status))return[2,u];throw r=!0,f=i.status,v=i.url,b=null===(t=null==u?void 0:u.error)||void 0===t?void 0:t.code,F=(O=v)&&O.match(a),p=F&&2===F.length?decodeURIComponent(F[1]):"No CV was found",{message:"Request failed with Status Code: "+f+" - Error Code: "+b+" --- cV: "+p,statusCode:f,correlationVector:p};case 4:if(c=n.sent(),r)throw c;throw s=(d=c)?d.message:"No error message",l=d?d.stack:"No error stack",{message:"Request failed with a network error - ErrorMessage: "+s+" - ErrorStack: "+l,statusCode:void 0,correlationVector:d.correlationVector};case 5:return[2]}var d,s,l,f,v,b,p,O,F}))}))}},4824:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(1984),o=r(23);function a(e){var t;try{t=JSON.parse(e)}catch(t){return void o.g.warn("Cannot parse folderForestNode: "+e)}if(void 0!==t.id)switch(t.type){case 6:case 0:return{id:t.id,type:t.type,treeType:"favorites"};case 3:case 4:return{id:t.id,type:t.type,treeType:"favorites",dropViewState:Object(n.a)()};case 1:var r={id:t.id,type:t.type,treeType:"favorites",displayName:t.displayName,mainEmailAddress:t.personaEmail,allEmailAddresses:t.personaAllEmails||[],searchFolderId:t.personaSearchFolderId,isJustAdded:!1,isSearchFolderPopulated:!0,isSyncUpdateDone:!1,dropViewState:Object(n.a)()};return t.personaId&&(r.personaId=t.personaId),r;default:return void o.g.warn("Non supported FolderForestNodeType: "+t.type)}}function i(e,t,r,n,a){return e.map((function(e){var i;return t.has(e)?i=t.get(e):r.has(e)?i=r.get(e):n.has(e)?i=n.get(e):a.has(e)?i=a.get(e):o.g.warn("Favorites not found. favoriteType: "+i.type),function(e){var t={id:e.id,type:e.type};if(1===e.type){var r=e;t.displayName=r.displayName,t.personaSearchFolderId=r.searchFolderId,t.personaEmail=r.mainEmailAddress,t.personaAllEmails=r.allEmailAddresses,t.personaId=r.personaId}return JSON.stringify(t)}(i)}))}},4825:function(e){e.exports=JSON.parse('{"a":"cFa"}')},4826:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(151),o=r(4387),a=r(4823);function i(e){return Object(a.a)((function(){return Object(n.a)(o.a+"/"+e,null,null,!0,null,!0)}))}},5036:function(e,t,r){"use strict";function n(e){switch(e.type){case"folder":return e.folderId;case"group":return e.groupId.toLowerCase();case"category":return e.categoryId;case"persona":var t=e;return t.personaId||t.mainEmailAddress;case"privatedistributionlist":return"FavoritePdl";case"publicFolder":return e.publicFolderId;default:return}}r.d(t,"a",(function(){return n}))},5037:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a}));var n=r(2),o=Object(n.action)("ON_CATEGORY_FAVORITED",(function(e){return{categoryId:e}})),a=Object(n.action)("ON_CATEGORY_UNFAVORITED",(function(e){return{categoryId:e}}))},5403:function(e,t,r){"use strict";var n=r(4824),o=r(57);var a=r(2422),i=r(183);t.a=Object(i.action)("updateFavoritesUserOption")((function(e){void 0===e&&(e={favoritesFolderNodes:a.a.favoritesFolderNodes,favoritesPersonaNodes:a.a.favoritesPersonaNodes,favoriteSearches:a.a.favoriteSearches,favoriteCategories:a.a.favoriteCategories,orderedFavoritesNodeIds:a.a.orderedFavoritesNodeIds});var t,r=n.b(e.orderedFavoritesNodeIds,e.favoritesFolderNodes,e.favoritesPersonaNodes,e.favoriteSearches,e.favoriteCategories);return Object(o.z)((function(e){e.UserOptions.FavoriteNodes=r})),t=r,o.w.importAndExecute([{key:"FavoriteNodes",valuetype:"StringArray",value:t}]).then((function(e){var t=e.Body.ResponseMessages.Items[0];return"Success"==t.ResponseClass?Promise.resolve():Promise.reject("updateUserConfiguration failed: "+t.ResponseClass)}))}))},5470:function(e,t,r){"use strict";r.d(t,"d",(function(){return O})),r.d(t,"c",(function(){return j})),r.d(t,"a",(function(){return y}));var n=r(1),o=r(4824),a=r(4388),i=r(2422),u=r(121),c=r(1085),d=r(1985),s=r(1951),l=r(19),f=r(23),v=r(183),b=r(5871),p=function(e,t){return void 0===t&&(t={favoritesStore:i.a,folderTable:s.d.folderTable}),!(t.folderTable.size>0)||!t.favoritesStore.favoritesFolderNodes.has(e)&&t.folderTable.has(e)};function O(e){p(e.id)&&(i.a.orderedFavoritesNodeIds.push(e.id),i.a.favoritesFolderNodes.set(e.id,e))}function F(e){var t;t=e.id,Object(c.q)(t)&&!i.a.favoriteCategories.get(t)&&(i.a.orderedFavoritesNodeIds.push(e.id),i.a.favoriteCategories.set(e.id,e))}var j=Object(v.action)("loadFavoriteNodesToStore")((function(e,t){var r=Object(l.a)().UserOptions;if(r.FavoriteNodes){r.FavoriteNodes.forEach((function(t){var r,n,a=o.a(t);if(a)switch(a.type){case 0:O(a);break;case 3:n=a,i.a.orderedFavoritesNodeIds.push(n.id),i.a.favoriteSearches.set(n.id,n);break;case 1:r=a.id,i.a.favoritesPersonaNodes.has(r)||(e.orderedFavoritesNodeIds.push(a.id),e.favoritesPersonaNodes.set(a.id,a));break;case 4:F(a);break;default:f.g.warn("Non supported FolderForestNodeType: "+a.id)}}));var a=Object(n.j)([],Object(n.g)(e.favoritesPersonaNodes.values())).filter((function(e){return e.personaId}));Object(u.s)("LoadFavorites",[e.favoritesFolderNodes.size,e.favoritesPersonaNodes.size,e.favoriteSearches.size,e.favoriteCategories.size,a.length])}}));t.b=Object(v.action)("loadFavoritesV1")((function(e){(void 0===e&&(e={favoritesStore:i.a}),i.a.favoritesLoaded)||(0===s.d.folderTable.size&&Object(s.w)(),Object(a.a)(2)?j(e.favoritesStore):d.lazyMigrateFavorites.importAndExecute(),Object(b.a)())}));var y=Object(v.action)("addFavoriteToStoreV1")((function(e){i.a.favoritesFolderNodes.has(e.id)||(i.a.orderedFavoritesNodeIds.push(e.id),i.a.favoritesFolderNodes.set(e.id,e))}))},5471:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1985);function o(e){return Object(n.getStore)().favoriteSecondaryKeyMap.get(e.toLowerCase())}},5472:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1985);function o(e){return Object(n.getStore)().favoriteSecondaryKeyMap.get(e)}},5473:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1985);function o(e){return Object(n.getStore)().favoriteSecondaryKeyMap.get(e)}},5474:function(e){e.exports=JSON.parse('{"a":"bFa"}')},5475:function(e,t,r){"use strict";r.d(t,"b",(function(){return v})),r.d(t,"a",(function(){return b}));var n=r(1),o=r(2),a=r(7896),i=r(2960),u=r(3077),c=r(4389),d=r(1085),s=r(203),l=r(3450),f=r(3672);Object(o.orchestrator)(a.a,(function(e){return Object(n.c)(void 0,void 0,void 0,(function(){var t,r,o,a,p,O,F,j;return Object(n.f)(this,(function(n){switch(n.label){case 0:if(t=e.categoryId,r=Object(d.o)().filter((function(e){return e.Id===t}))[0],o=Object(s.a)(),a=b(o,r,!1),Object(f.a)(t))return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),Object(u.b)(t)?[2]:(Object(i.c)(a),p=v(r,!1),[4,Object(c.a)(p)]);case 2:return O=n.sent(),F=Object(l.a)(O,"category"),d.z.importAndExecute(),Object(i.a)(a,F),[3,4];case 3:return j=n.sent(),Object(i.b)(j,a),[3,4];case 4:return[2]}}))}))}));function v(e,t){return{Type:"category",DisplayName:e.Name,SingleValueSettings:[{Key:"CategoryId",Value:e.Id}],Client:t?"Migration":"OWA"}}function b(e,t,r){return{treeType:"favorites",type:"category",favoriteId:e,displayName:t.Name,categoryId:t.Id,client:r?"Migration":"OWA"}}},5871:function(e,t,r){"use strict";var n=r(2);t.a=Object(n.action)("SET_FAVORITES_LOADED")},5872:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"e",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return c}));var n=r(4208);function o(e){return{id:e.favoriteId,treeType:"favorites",type:5,data:e}}function a(e,t,r,n,o){return{treeType:"favorites",type:"privatedistributionlist",favoriteId:e,displayName:t,members:r,pdlId:n,searchFolderId:void 0,client:"OWA",isSearchFolderPopulated:!1,owsPersonaId:o}}function i(e,t){return{Type:"privatedistributionlist",DisplayName:e,MultiValueSettings:[{Key:"EmailAddresses",Values:t.map((function(e){return e.emailAddress}))},{Key:"MemberNames",Values:t.map((function(e){return e.name}))}],Client:"OWA"}}function u(e,t,r){return{Type:"privatedistributionlist",DisplayName:e,SingleValueSettings:[{Key:"PdlId",Value:Object(n.a)(t)},{Key:"PersonaId",Value:r}],Client:"OWA"}}function c(e,t){var r={Type:"privatedistributionlist",Client:"OWA"};if(e&&(r.DisplayName=e),t){var n=[{Key:"EmailAddresses",Values:t.map((function(e){return e.emailAddress}))},{Key:"MemberNames",Values:t.map((function(e){return e.name}))}];r.MultiValueSettings=n}return r}},6426:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(4387),o=r(151),a=r(4823);function i(e,t){return Object(a.a)((function(){return Object(o.d)(n.a+"/"+e,t,void 0,!0,null,!0)}))}},6427:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(1),o=r(6958),a=r(1951),i=r(203),u=r(2),c=r(4389),d=r(4208),s=r(3450),l=r(2960),f=r(3672);Object(u.orchestrator)(o.a,(function(e){return Object(n.c)(void 0,void 0,void 0,(function(){var t,r,o,u,d,b;return Object(n.f)(this,(function(n){return t=e.folderIdToAdd,r=e.newIndex,o=a.d.folderTable.get(t),u=Object(i.a)(),d=function(e,t,r){return{treeType:"favorites",type:"folder",favoriteId:e,displayName:Object(a.i)(t),folderId:t.FolderId.Id,client:r?"Migration":"OWA"}}(u,o,!1),Object(f.a)(t)?[2]:(Object(l.c)(d,r),b=v(o,!1,r),Object(c.a)(b).then((function(e){var t=Object(s.a)(e,"folder");Object(l.a)(d,t,r)})).catch((function(e){Object(l.b)(e,d)})),[2])}))}))}));function v(e,t,r){return{Type:"folder",DisplayName:Object(a.i)(e),SingleValueSettings:[{Key:"FolderId",Value:Object(d.a)(e.FolderId.Id)},{Key:"ChangeKey",Value:e.FolderId.ChangeKey}],Client:t?"Migration":"OWA",Index:r}}},6428:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return a}));r(1985);function n(e){return{id:e.favoriteId,treeType:"favorites",type:1,allEmailAddresses:e.allEmailAddresses,displayName:e.displayName,mainEmailAddress:e.mainEmailAddress,searchFolderId:e.searchFolderId,isSyncUpdateDone:!0,isJustAdded:!1,isSearchFolderPopulated:e.isSearchFolderPopulated,markedForDeletion:!1,dropViewState:null,personaId:e.personaId}}function o(e,t,r){return{treeType:"favorites",type:"persona",favoriteId:e,displayName:t,searchFolderId:void 0,client:"OWA",allEmailAddresses:[r],personaId:void 0,mainEmailAddress:r,isSearchFolderPopulated:!1,isSyncUpdateDone:!0}}function a(e,t){return{Type:"persona",DisplayName:e,SingleValueSettings:[{Key:"MainEmailAddress",Value:t}],Client:"OWA"}}},6954:function(e,t,r){"use strict";t.a={MigrateOutlookFavorites:{name:"MigrateOutlookFavorites",options:{isCore:!0}},UpdateFavoriteNode:{name:"UpdateFavoriteNode"}}},6955:function(e,t,r){"use strict";function n(e,t){if(e.length!==t.length)return!1;var r=e.map((function(e){return e.emailAddress.toLocaleLowerCase()})),n=t.map((function(e){return e.emailAddress.toLocaleLowerCase()}));return r.filter((function(e){return n.includes(e)})).length===r.length}r.d(t,"a",(function(){return n}))},6956:function(e){e.exports=JSON.parse('{"a":"Ida","b":"Jda"}')},6957:function(e){e.exports=JSON.parse('{"a":"Hda"}')},6958:function(e,t,r){"use strict";var n=r(2);t.a=Object(n.action)("ADD_FAVORITE_FOLDER_V2",(function(e,t){return{folderIdToAdd:e,newIndex:t}}))},7893:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(1),o=r(2422),a=r(5036);function i(e,t){var r=o.a.favoriteSecondaryKeyMap,i=o.a.orderedOutlookFavoritesIds,u=o.a.outlookFavorites;i.some((function(t){return t===e.favoriteId}))||(void 0!==t?i.splice(t,0,e.favoriteId):i.push(e.favoriteId),u.set(e.favoriteId,Object(n.a)({treeType:"favorites"},e)),r.set(Object(a.a)(e),e.favoriteId))}},7894:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(5036),o=r(2422);function a(e){var t=o.a.favoriteSecondaryKeyMap,r=o.a.orderedOutlookFavoritesIds,a=o.a.outlookFavorites;o.a.orderedOutlookFavoritesIds=r.filter((function(t){return t!==e.favoriteId})),a.delete(e.favoriteId),t.delete(Object(n.a)(e))}},7895:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(2422),o=r(5036);function a(e){n.a.favoritingInProgressMap.set(Object(o.a)(e),!0)}function i(e){n.a.favoritingInProgressMap.delete(Object(o.a)(e))}},7896:function(e,t,r){"use strict";var n=r(2);t.a=Object(n.action)("ADD_FAVORITE_CATEGORY_V2",(function(e){return{categoryId:e}}))}}]);
//# sourceMappingURL=owa.MailBoot~AddinsExpUI~FilesHubPersonaList~GroupAddMemberV2~GroupAddMembersV2Opx~GroupEditV2Opx~MailDe~87408052.js.map
self.scriptsLoaded['owa.MailBoot~AddinsExpUI~FilesHubPersonaList~GroupAddMemberV2~GroupAddMembersV2Opx~GroupEditV2Opx~MailDe~87408052.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AddinsExpUI~FilesHubPersonaList~GroupAddMemberV2~GroupAddMembersV2Opx~GroupEditV2Opx~MailDe~87408052.js'] = (new Date()).getTime();