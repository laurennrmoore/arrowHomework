self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Addins~Editor~MailComposeActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[166],{1110:function(e,t,n){"use strict";var r=n(536),i=n(896),a=n(479),o=Object(i.a)((function(e,t,n,i){Object(r.a)(t,Object(a.a)(t),e,i)}));t.a=o},1270:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"GetItemRequest:#Exchange"},e)}},1273:function(e,t,n){"use strict";var r=n(33),i=n(1);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.a)({__type:"GetItemJsonRequest:#Exchange"},n)),Object(r.a)("GetItem",e,t)}n.d(t,"a",(function(){return a}))},1290:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1255);function i(e){return Object(r.a)(e.EmailAddress)||e.ItemId&&"PrivateDL"==e.MailboxType}},1955:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(14),i=n(2),a={conversationNodes:new r.ObservableMap({}),conversations:new r.ObservableMap({}),items:new r.ObservableMap({}),searchFolderDisplayName:null,typeOfItemBeingDragged:null,triageAnnouncement:{message:null,politenessSetting:"off"}},o=Object(i.createStore)("mail",a),c=o();t.a=c},1956:function(e,t,n){"use strict";var r=n(31),i=n(1955),a=n(2138),o=n(2048),c=n(2045),s="ChronologicalNewestOnBottom";function u(e,t){return e[t==s?0:e.length-1]}var d=n(981),l=n(979);function m(e){return Object(c.a)(e,Object(d.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(l.a)({FieldURI:"TailoredXpEntities"}),Object(l.a)({FieldURI:"TailoredXpCalendarEventIds"}),Object(l.a)({FieldURI:"TailoredXpEntitiesStatus"}),Object(l.a)({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then((function(e){if(e&&!(e instanceof Error)){var t=e;return{TailoredXpEntities:t.TailoredXpEntities,TailoredXpCalendarEventIds:t.TailoredXpCalendarEventIds,TailoredXpEntitiesStatus:t.TailoredXpEntitiesStatus,EntityNamesMap:t.EntityNamesMap}}return{}}))}var f=n(2163),p=n(19);function b(e){var t=i.a.conversations.get(e);if(t){var n=Object(p.a)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==n}return!1}var v=n(2066),O=n(1951);function g(e,t){return void 0===t&&(t={folderTable:O.d.folderTable}),!!t.folderTable.get(e)}var y=n(1959);function I(e,t){var n=O.d.folderTable.get(e);return!!n&&(Object(O.H)(n,y.d,t)||n.DistinguishedFolderId===y.b)}function j(e){return I(e)||function(e){var t=O.d.folderTable.get(e);return t&&t.DistinguishedFolderId===y.d}(e)}function S(e,t,n){return void 0===n&&(n={folderTable:O.d.folderTable}),Object(O.H)(e,t,n)}var h=n(2167),E=n(2100);function k(e){return e&&(Object(E.a)(e,y.h)||Object(E.a)(e,y.b))}function M(e){return e&&(S(e,y.g)||S(e,y.a))}var R=n(2109);function T(e,t){try{return C(e,t)}catch(e){return null}}function C(e,t){if(!e||!t)return null;var n=Object(O.n)().get(e).PermissionSet.Permissions.filter((function(e){return e.UserId.PrimarySmtpAddress===t}));return null==n?void 0:n[0]}var P=n(197),x="OneOff",w="Unknown";function N(e,t,n){return!Object(P.a)()&&(n==x||n==w)&&(null==e?void 0:e.indexOf(t))<0}var D=n(2),A=Object(D.mutatorAction)("setIsDraftQueuedForSubmission",(function(e,t){var n=Object(i.b)().items.get(null==e?void 0:e.Id);n&&(n.isDraftQueuedForSubmission=t)}));n(2054);n.d(t,"s",(function(){return L})),n.d(t,"u",(function(){return i.a})),n.d(t,"g",(function(){return i.b})),n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return o.a})),n.d(t,"e",(function(){return c.a})),n.d(t,"d",(function(){return u})),n.d(t,"t",(function(){return m})),n.d(t,"v",(function(){return f.a})),n.d(t,"q",(function(){return b})),n.d(t,"c",(function(){return v.a})),n.d(t,"r",(function(){return g})),n.d(t,"m",(function(){return I})),n.d(t,"l",(function(){return j})),n.d(t,"n",(function(){return S})),n.d(t,"j",(function(){return h.a})),n.d(t,"k",(function(){return k})),n.d(t,"p",(function(){return M})),n.d(t,"f",(function(){return R.a})),n.d(t,"h",(function(){return T})),n.d(t,"i",(function(){return C})),n.d(t,"o",(function(){return N})),n.d(t,"w",(function(){return A}));var F=new r.c((function(){return n.e(1275).then(n.bind(null,18578))})),L=new r.a(F,(function(e){return e.setTriageActionAnnouncement}))},1959:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"j",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"l",(function(){return d})),n.d(t,"k",(function(){return l})),n.d(t,"i",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return p}));var r=["journal","outbox","syncissues"],i="archivemsgfolderroot",a="msgfolderroot",o="archivedeleteditems",c="deleteditems",s="archiverecoverableitemsdeletions",u="recoverableitemsdeletions",d="msgfolderroot",l="sharedFolderTree",m="primaryFolderTree",f="archiveFolderTree",p="favorites"},1964:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(32);function i(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(e)||"none"}},1996:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2143);function i(e){return Object(r.a)().attachments.get(e.Id)}},2003:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(2),i=n(14),a=Object(r.createStore)("folderStore",{folderTable:new i.ObservableMap,mailboxFolderTreeData:new i.ObservableMap}),o=a();t.a=a},2007:function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(i||(i={}))},2008:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2125);function i(e,t){var n=Object(r.a)(t),i=n&&n.get(e);return null==i?void 0:i.rootFolder}},2028:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1),i=n(2032),a=n(2033);function o(e){var t,n;if(!e)return Promise.reject(Object(i.a)("500","Server returned a null response!",null));var o=Array.isArray(e)?e:[e];try{for(var c=Object(r.k)(o),s=c.next();!s.done;s=c.next()){var u=s.value;if(u&&!Object(a.a)(u))return Promise.reject(Object(i.a)(u.ResponseCode,u.StackTrace,u.MessageText))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return Promise.resolve()}},2031:function(e,t,n){"use strict";var r=n(2),i=Object(r.createStore)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}}),a=i();function o(){return a.selectedNode}function c(){var e=o();switch(e.type){case 1:return e.searchFolderId;case 5:return e.data.searchFolderId;case 3:return null;default:return e.id}}n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return a}))},2032:function(e,t,n){"use strict";function r(e,t,n){var r="ResponseCode="+e;t&&(r+=", Stacktrace="+t);var i=new Error(r);return i.responseCode=e,i.fetchErrorType="ServerFailure",n&&(i.diagnosticInfo="MessageText= "+n),i}n.d(t,"a",(function(){return r}))},2033:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r="Success";function i(e){return e&&e.ResponseClass==r}},2045:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2305),i=n(24),a=new(n(9).d)((function(){return Promise.all([n.e(15),n.e(17),n.e(16),n.e(286),n.e(891)]).then(n.bind(null,3004))}));function o(e,t,n,o,c,s,u,d){return Object(i.i)("mon-rp-loadItemViaGql")?a.import().then((function(r){return r.getItemViaGraphQL(e,t,n,o,c,s,u,d)})):Object(r.a)(e,t,n,o,s,u,d)}},2048:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.KeyboardCtrlSpace=5]="KeyboardCtrlSpace",e[e.MailListItemBody=6]="MailListItemBody",e[e.MailListItemBodyDoubleClick=7]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=8]="MailListItemCheckbox",e[e.MailListItemContextMenu=9]="MailListItemContextMenu",e[e.MailListItemExpansion=10]="MailListItemExpansion",e[e.MailListItemRichPreview=11]="MailListItemRichPreview",e[e.MailListItemTwisty=12]="MailListItemTwisty",e[e.NewConversation=13]="NewConversation",e[e.Reset=14]="Reset",e[e.RowRemoval=15]="RowRemoval",e[e.ImmersiveReadingPaneDelete=16]="ImmersiveReadingPaneDelete",e[e.RouteHandler=17]="RouteHandler",e[e.ToggleCheckAll=18]="ToggleCheckAll",e[e.MessageAd=19]="MessageAd",e[e.SearchSuggestionClick=20]="SearchSuggestionClick",e[e.SingleLineClearSelection=21]="SingleLineClearSelection",e[e.KeyboardHome=22]="KeyboardHome",e[e.KeyboardEnd=23]="KeyboardEnd"}(r||(r={})),t.a=r},2054:function(e,t,n){"use strict";var r=n(24),i=n(210),a=n(57),o=n(31),c=new o.c((function(){return n.e(1276).then(n.bind(null,18595))})),s=new o.b(c,(function(e){return e.isReadingPaneConversationEnabled}));function u(){var e,t;return!!Object(r.i)("mon-rp-unstackedConversation")&&(0==(null===(t=null===(e=Object(a.h)())||void 0===e?void 0:e.UserOptions)||void 0===t?void 0:t.GlobalListViewTypeReact)&&!function(){var e=s.tryImportForRender(),t=e?e():null;if(null==t){var n=Object(i.a)("useNativeHostRPConversationOption");t=!n}return t}())}n.d(t,"a",(function(){return u}))},2057:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(197),i=n(24);function a(){var e=Object(r.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(i.i)("notes-folder-view")&&e.push("notes"),e}},2066:function(e,t,n){"use strict";var r=new(n(1258).a)(50);t.a=r},2071:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(1),i=n(2204);function a(e){var t=Object(i.b)(e.EmailAddress,e.DisplayName);return Object(r.a)(Object(r.a)({},t),{isPendingResolution:!1,persona:e})}t.a=a},2100:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(32);function i(e,t){if(!e||!t)throw new Error("Input parameters to doesFolderIdEqualName must not be null.");return r.a.defaultFolderNameToIdMap.get(t)==e}},2103:function(e,t,n){"use strict";function r(e){var t;if("SMTP"===e.RoutingType||void 0===e.RoutingType)return e.EmailAddress;var n="MAPIPDL"===e.RoutingType&&(null===(t=e.ItemId)||void 0===t?void 0:t.Id)||e.EmailAddress;return e.RoutingType+":"+n}n.d(t,"a",(function(){return r}))},2104:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2462),i=n(2129);function a(e){var t=Object(r.a)(),n=Object(i.b)(e);return t.sharingLinks.get(n)}},2107:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2003);function i(){return Object(r.a)().folderTable}},2109:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1951),i=n(2031);function a(){var e=Object(i.c)(),t=null;return null==(t=1===e.type?e.searchFolderId:5===e.type?e.data.searchFolderId:e.id)?null:r.d.folderTable.get(t)}},2125:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(2003),i=n(57);function a(e){return o(e).folderTreeTable}function o(e){return e||(e=Object(i.b)()),Object(r.a)().mailboxFolderTreeData.get(e)}},2129:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(24),i="_ODSPPSL";function a(e){return Object(r.i)("doc-link-savePermission")&&e&&-1!==e.indexOf(i)?e.substring(0,e.length-i.length):e}function o(e){return!!Object(r.i)("doc-link-savePermission")&&e.lastIndexOf(i)===e.length-i.length}function c(e,t){return!Object(r.i)("doc-link-savePermission")||2!==t&&1!==t?e:e+i}},2138:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(r||(r={}))},2146:function(e,t,n){"use strict";var r=n(2),i=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{},usedFindPeopleFallback:!1})();t.a=i},2163:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1955);function i(e){return r.a.items.get(e)}},2164:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(9),i=n(2057);n.d(t,"a",(function(){return i.a}));var a=new r.b((function(){return Promise.all([n.e(9),n.e(11),n.e(12),n.e(15),n.e(17),n.e(16),n.e(755)]).then(n.bind(null,2570))})),o=new r.a(a,(function(e){return e.bootstrapFolderHierarchyCache}))},2165:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s}));var r=n(31),i=new r.c((function(){return n.e(519).then(n.bind(null,2900))})),a=new r.b(i,(function(e){return e.searchCacheTrie})),o=new r.b(i,(function(e){return e.compareFeatureData})),c=new r.a(i,(function(e){return e.initializeSuggestionTrie})),s=new r.a(i,(function(e){return e.isSuggestionTrieEmpty}))},2167:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2100),i=n(1959);function a(e){return e&&(Object(r.a)(e,i.g)||Object(r.a)(e,i.a))}},2170:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2008),i=n(1959);function a(e){return Object(r.a)(i.d,e)}},2171:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2008),i=n(1959);function a(e){return Object(r.a)(i.j,e)}},2172:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2008);function i(e){return Object(r.a)(e)}},2204:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(1),i=n(2277),a=n(2246),o={isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:i.a.None,members:[]};function c(e,t){return Object(r.a)(Object(r.a)({},o),{isValid:!0,displayText:Object(a.a)(e,t)})}},2215:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return d}));var r=n(2146),i=n(2165);function a(e,t,n,r){return s(d(e),t,n,r)}function o(e,t,n,r){return i.d.import().then((function(i){return i(e,t,(function(e){return u(n,e,r)}))}))}function c(e,t,n,r){return s(e,t,n,r)}function s(e,t,n,i){for(var a=[],o=0;a.length<t&&r.a.recipientCache&&o<r.a.recipientCache.length;){var c=r.a.recipientCache[o];if(e(c))u(n,c.EmailAddress,i)||a.push(c);o++}return a}function u(e,t,n){var r=!1;return e&&function(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}(t,e)&&(r=!0),n&&n.indexOf(t.MailboxType)>=0&&(r=!0),r}var d=function(e){return function(t){var n=t.EmailAddress;if(n.EmailAddress&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;for(var r=n.Name.toLowerCase().split(" "),i=0;i<r.length;i++)if(0==r[i].indexOf(e))return!0}return!1}}},2222:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return f}));var r=n(1244),i=n(1964),a=n(2003),o=n(2171),c=n(2107),s=n(2170),u=n(2172),d=n(2164);function l(e){var t=Object(c.a)(),n=Object(r.a)(e);return n?t.get(n):void 0}function m(e,t){if("SharedMailbox"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");var n,r=[];switch(e){case"ArchiveMailbox":n=Object(s.a)();break;case"SharedMailbox":n=Object(u.a)(t);break;default:n=Object(o.a)()}var c=Object(d.a)();"UserMailbox"==e&&n.DistinguishedFolderId==Object(o.a)().DistinguishedFolderId&&n.FolderId&&c.forEach((function(e){var t=l(e);(null==t?void 0:t.ParentFolderId.Id)===n.FolderId.Id&&r.push(t.FolderId.Id)}));for(var m=function(e){var t=[];(null==e?void 0:e.childFolderIds)&&e.childFolderIds.map((function(e){var n=a.b.folderTable.get(e);t.push(n.FolderId.Id)}));return t}(n),f=0;f<m.length;f++)-1==c.indexOf(Object(i.a)(m[f]))&&r.push(m[f]);return r}function f(e,t){var n=Object(c.a)().get(e);return(null==n?void 0:n.mailboxInfo.type)===t}},2239:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"Message:#Exchange"},e)}},2246:function(e,t,n){"use strict";var r=n(2186),i=n(2103),a=n(197);var o=function(e,t){var n=t||e.Name;if(!n)return!0;var i,o,c=Object(r.a)(n),s=(i=n,o=e.EmailAddress,i==o||i&&o&&i.toLowerCase()==o.toLowerCase()),u=-1!==n.indexOf("@"),d=!Object(a.a)()&&("ExternalMailbox"===e.MailboxType||"LinkedIn"===e.MailboxType),l="OneOff"===e.MailboxType||"Unknown"===e.MailboxType;return e.EmailAddress&&!("SMTP"===e.RoutingType&&s)&&(c||u||d||l)};t.a=function(e,t){var n=t||e.Name,a=!n||Object(r.a)(n);return o(e,t)?a?Object(i.a)(e):n+" <"+Object(i.a)(e)+">":n}},2277:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={})),t.b=r},2305:function(e,t,n){"use strict";var r=n(1270),i=n(439),a=n(1);var o=n(1273),c=n(180),s=n(23),u=n(2028);function d(e,t,n,d,l,m,f){var p,b=Object(c.b)();return d&&(b.RequestServerVersion=d),m&&(b.ManagementRole=(p={UserRoles:["MailboxSearch"]},Object(a.a)({__type:"ManagementRoleType:#Exchange"},p))),Object(o.a)({Header:b,Body:Object(r.a)({ItemShape:t,ItemIds:Array.isArray(e)?e.map((function(e){return Object(i.a)({Id:e})})):e?[Object(i.a)({Id:e})]:[],ShapeName:null!=n?n:void 0,InternetMessageId:f})},l).then((function(e){var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items})).then((function(e){return Object(u.a)(e).then((function(){return e}))})).then((function(t){if(!(null==t?void 0:t.length))return null;var n=[];return t.forEach((function(e){n=n.concat(e.Items)})),n.length?Array.isArray(e)||void 0!==f?n:n[0]:null})).catch((function(e){return s.g.warn("GetItem:"+e.message),e}))}n.d(t,"a",(function(){return d}))},2366:function(e,t,n){"use strict";function r(){return{isSuggesting:!1,bufferZone:0,targetPoint:null}}n.d(t,"a",(function(){return r}))},2381:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1963),i=n(24);function a(e){var t=(Object(r.a)(e)||"").toLowerCase();return!!e&&(Object(i.i)("cmp-prague")&&(".fluid"===t||".note"===t))}},2389:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"ItemChange:#Exchange"},e)}},2419:function(e,t,n){"use strict";var r=n(1984),i=n(2007),a=n(1),o=n(2366);function c(e){return Object(a.a)(Object(a.a)({},Object(o.a)()),{queryString:"",wordBeforeCursor:"",findResultSet:[],isSearching:!1,directorySearchType:i.a.None,selectedRecipientIndex:-1,findResultType:i.b.None,findPeopleFeedbackManager:e,currentRenderedQueryString:"",numberOfCacheResults:0})}var s=0;function u(e,t,n){return void 0===e&&(e=""),void 0===t&&(t=!1),{editorId:(s++).toString(),content:e,isDirty:t,textDirection:null,recipientPickerPluginViewState:c(n)}}n.d(t,"a",(function(){return l}));var d=0;function l(e,t){return{userIdentity:t,recipientWellId:"rw-"+ ++d,queryString:"",recipients:[],isDirty:!1,shouldShowContactPicker:!1,findResultSet:[],findResultType:i.b.None,isSearching:!1,directorySearchType:i.a.None,dropViewState:Object(r.a)(),findPeopleFeedbackManager:e,numberOfCacheResults:0,recipientEditorViewState:u("",!1,e)}}},2421:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"SetItemField:#Exchange"},e)}},2428:function(e,t,n){"use strict";var r=n(24),i=n(2071),a=n(2215),o=function(e){var t=Object(a.c)((function(t){return"SMTP"===t.EmailAddress.RoutingType&&t.EmailAddress.EmailAddress&&t.EmailAddress.EmailAddress.toLowerCase()===e.toLowerCase()}),1);return t.length?t[0]:null},c=n(23),s=function(e){var t=void 0!==e.EmailAddress;return t||c.g.warn("Recipient cache contained a persona that had no EmailAddress"),t};function u(e){if(Object(r.i)("cmp-resolveRecipsFromCache")&&"SMTP"===e.RoutingType&&e.EmailAddress){var t=o(e.EmailAddress);if(t&&s(t))return Object(i.b)(t)}return null}n.d(t,"a",(function(){return u}))},2462:function(e,t,n){"use strict";var r=n(14),i=n(2),a={sharingLinks:new r.ObservableMap({})},o=Object(i.createStore)("sharingLinkStore",a);t.a=o},2463:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(121),i={};function a(e,t,n){var a,o=null===(a=i[e.editorId])||void 0===a?void 0:a.htmlEditor;if(t&&o){var c=o.getDocument().defaultView,s=t.getDocument().defaultView,u=c==s,d=window==c,l=window==s;Object(r.s)("DebugEditor108089",{eventName:"DuplicatedEditor",inSameWindow:u,OriginalInProjection:d,NewInProjection:l,editorId:e.editorId})}i[e.editorId]={htmlEditor:t,plainTextEditor:n}}function o(e,t,n){var a=i[e.editorId],o=!1;a&&(a.htmlEditor==t&&(a.htmlEditor=null,o=!0),a.plainTextEditor==n&&(a.plainTextEditor=null,o=!0),a.htmlEditor||a.plainTextEditor||delete i[e.editorId]),!o&&t&&Object(r.s)("DebugEditor108089",{eventName:"NoEditorToRemove",hasOperator:!!a,hasOriginalEditor:!!(null==a?void 0:a.htmlEditor),removingEditorId:e.editorId})}function c(e,t,n,r){if(e){var a=e.bodyType,o=void 0===a||"HTML"===a,c="Text"===a,s=i[e.editorId]||{},u=s.htmlEditor,d=s.plainTextEditor;o&&t&&(u&&!u.isDisposed()||r)?t(u):c&&n&&(d||r)&&n(d)}}},2532:function(e,t,n){"use strict";var r=n(33),i=n(1);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.a)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return a}))},2539:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"UpdateItemRequest:#Exchange"},e)}},2556:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);function i(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},2582:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),i=n(2633),a=n(2419),o=n(14),c=n(1290);function s(e,t,n,i){var c,s,d=Object(a.a)(e,n);if(i&&(d.recipients=Object(o.toJS)(i)),t)try{for(var l=Object(r.k)(t),m=l.next();!m.done;m=l.next()){var f=m.value;d.recipients.push(u(f))}}catch(e){c={error:e}}finally{try{m&&!m.done&&(s=l.return)&&s.call(l)}finally{if(c)throw c.error}}return d}function u(e){var t=Object(i.a)(e);return Object(r.a)(Object(r.a)({},t),{isValid:Object(c.a)(e)})}},2633:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1),i=n(2204),a=n(2428);function o(e){var t=Object(a.a)(e);if(t)return t;var n=Object(i.b)(e);return Object(r.a)(Object(r.a)({},n),{isPendingResolution:!0,persona:{EmailAddress:e,PersonaId:e.ItemId}})}},2783:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(212),a=n(623),o=0;function c(e,t){var n=(t||window).document,c=n.createElement("div");c.id="owa-modal-"+o++,n.body.appendChild(c);var s,u=!1,d=function(){u||(u=!0,i.unmountComponentAtNode(c),n.body.removeChild(c))};return[new Promise((function(t,n){s=n,i.render(r.createElement(a.a,{type:a.b.None,onError:function(){d(),n()}},r.createElement(e,{onDismiss:function(e){d(),t(e)}})),c)})),function(){d(),s()}]}},2805:function(e,t,n){"use strict";n.d(t,"c",(function(){return I})),n.d(t,"e",(function(){return S})),n.d(t,"f",(function(){return h})),n.d(t,"d",(function(){return E})),n.d(t,"a",(function(){return k}));var r=n(1),i=n(2151),a=n(2211),o=n(4356),c=n(3699),s=n(5107),u=n(6017),d=n(6324),l=n(3480),m=n(4428),f=n(19),p=n(44),b=n(3700),v=n(3463),O=n(24),g={};function y(e){var t=g[e.composeId];return t||(t={activeSaveAction:null,hasPendingSaveAction:!1},g[e.composeId]=t),t}function I(e){var t=g[e.composeId];return t&&!!t.activeSaveAction}function j(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return(t=y(e)).activeSaveAction?[3,1]:[2,Promise.resolve(!0)];case 1:return t.hasPendingSaveAction?[4,t.activeSaveAction]:[3,3];case 2:return n.sent(),[2,Promise.resolve(!1)];case 3:return t.hasPendingSaveAction=!0,[4,t.activeSaveAction];case 4:return n.sent(),t.hasPendingSaveAction=!1,[2,Promise.resolve(!0)]}}))}))}function S(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n;return Object(r.f)(this,(function(r){switch(r.label){case 0:return(n=y(e)).activeSaveAction=t,[4,t.then((function(e){return n.activeSaveAction=null,Promise.resolve(e)})).catch((function(e){return n.activeSaveAction=null,Promise.reject(e)}))];case 1:return r.sent(),[2]}}))}))}function h(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return(null==(t=g[e.composeId])?void 0:t.activeSaveAction)?[4,t.activeSaveAction]:[3,2];case 1:return n.sent(),[2,Promise.resolve(!0)];case 2:return[2,Promise.resolve(!1)]}}))}))}function E(e){var t=g[e.composeId];return t&&!!t.activeSaveAction}function k(e){g[e.composeId]&&delete g[e.composeId]}t.b=Object(p.d)("trySaveMessage",c.b.MailComposeSave)((function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,j(e)];case 1:return r.sent()?e?e.isSending||E(e)?[2,Promise.resolve()]:(t||(Object(a.a)(e,s.a),e.isManuallySaved=!0),Object(a.a)(e,"warningMessageMaxRecipientsExceed"),function(e){return Object(l.a)(e)<=Object(f.a)().MaxRecipientsPerMessage}(e)?[2,S(e,Object(d.b)(e).then((function(n){return e.isSending||(Object(d.a)(n,e),Object(m.a)()&&Object(o.a)(e,t?2:4),Object(b.a)()&&Object(O.i)("cmp-clp-auto-labeling")&&v.g.import().then((function(t){t(e,e.protectionViewState.clpViewState,e.itemId,e.content)}))),Promise.resolve()})).catch((function(r){if(!t&&!e.isSending){var a=Object(u.a)(r?r.message:null,!1);Object(i.a)(e,a)}return n&&!e.isSending?Promise.reject(r):Promise.resolve()})))]:(Object(i.a)(e,"warningMessageMaxRecipientsExceed"),[2,Promise.resolve()])):[2,Promise.reject("could not save message if view state does not exist")]:[2,Promise.resolve()]}}))}))}))},2806:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2463),i=n(2984);function a(e){Object(r.b)(e,(function(t){Object(i.a)(e,t.getContent())}),(function(t){Object(i.a)(e,t.value)}))}},2841:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19),i=n(24);function a(){var e;return(null===(e=Object(r.a)().UserOptions)||void 0===e?void 0:e.SendFromAliasEnabled)&&Object(i.i)("cmp-proxy-address")}},2842:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(14),i=n(2),a={legacySignature:{html:null,txt:null},roamingSignatureMap:new r.ObservableMap,defaultSignatureName:"",defaultReplySignatureName:""},o=Object(i.createStore)("signature",a),c=o()},2904:function(e,t,n){"use strict";var r=n(2783);n.d(t,"a",(function(){return r.a}))},2950:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"CreateItemJsonRequest:#Exchange"},e)}},2951:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"CreateItemRequest:#Exchange"},e)}},2984:function(e,t,n){"use strict";var r=n(2),i=n(3484),a=n(121);t.a=function(e,t,n){if(e.content!=t&&(o(e,t),n||Object(i.a)(e,!0),(null==t?void 0:t.indexOf("data-ogsc="))>0)){var r=new Error,s=e.isDarkMode,u=c(e)?e.bodyType:"",d=c(e)?e.preferredEditors[u]:"";Object(a.s)("DebugEditor108089",{eventName:"NoColorTransform",editorId:e.editorId,callstack:r.stack,length:t.length,isInitializing:n,isDarkMode:s,bodyType:u,activeEditor:d})}};var o=Object(r.mutatorAction)("Editor_UpdateContent",(function(e,t){e.content=t}));function c(e){return!!e.preferredEditors}},3053:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=n(6015),i=function(e){return[e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell]},a=function(e){var t=i(e);return Object(r.a)(t).map((function(e){return e.persona.EmailAddress.EmailAddress}))},o=function(e){var t=i(e);return Object(r.a)(t).map((function(e){return e.persona.EmailAddress}))}},3138:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"DeleteItemField:#Exchange"},e)}},3269:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var r="X-OWA-SmimeInstalled",i="1",a="SmimeWithoutActiveX",o="message/rfc822",c="ErrorSmimeSendCancelled"},3270:function(e,t,n){"use strict";t.a=function(e){if(e){var t=e.shouldEncryptMessageAsSmime,n=e.shouldSignMessageAsSmime;return t||n}return!1}},3384:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(33),i=n(2950);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("CreateItem",e,t)}},3464:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19),i=n(24);function a(){var e;return Object(i.i)("cmp-roaming-signature")&&!(null===(e=Object(r.a)().SessionSettings)||void 0===e?void 0:e.IsExplicitLogon)}},3479:function(e,t,n){"use strict";function r(e){return void 0!==e.publicFolderId}n.d(t,"a",(function(){return r}))},3480:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(6021);function i(e){var t,n,r;return e.isDirty||(null===(t=e.toRecipientWell)||void 0===t?void 0:t.isDirty)||(null===(n=e.ccRecipientWell)||void 0===n?void 0:n.isDirty)||(null===(r=e.bccRecipientWell)||void 0===r?void 0:r.isDirty)}function a(e){return Object(r.a)(e.toRecipientWell)+Object(r.a)(e.ccRecipientWell)+Object(r.a)(e.bccRecipientWell)}},3484:function(e,t,n){"use strict";var r=n(183);t.a=Object(r.action)("setIsDirty")((function(e,t){e.isDirty=t}))},3565:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"SingleRecipientType:#Exchange"},e)}},3699:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(5106),i=n(6016),a=n(3839),o="MailComposeSend";t.b={MailComposeReply:{name:"MailComposeReply",options:{},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeReplyAll:{name:"MailComposeReplyAll",options:{},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeForward:{name:"MailComposeForward",options:{},customData:function(e,t,n,r){return[t]},actionSource:function(e,t,n,r){return t},cosmosOnlyData:function(e,t,n,r){return e&&e.toString()}},MailComposeSendE2E:{name:"MailComposeSendE2E",customData:function(e){return{composeTraceId:e.logTraceId,operation:e.operation,isGroupScenario:Object(a.b)(e)}}},MailComposeSave:{name:"MailComposeSave"},MailComposeUpConvert:{name:"MailComposeUpConvert"},ComposeCommandDiscardCompose:{name:"ComposeCommandDiscardCompose",customData:function(e){return{composeTraceId:e.logTraceId,messageLanguage:Object(i.a)(e)}},options:{isCore:!0},cosmosOnlyData:function(e){return JSON.stringify({smartReplyExtractionId:Object(r.a)(e,"smartReply"),smartDocExtractionId:Object(r.a)(e,"smartDoc")})}},ComposeCommandShowFrom:{name:"ComposeCommandShowFrom"},ComposeCommandSetImportance:{name:"ComposeCommmandSetImportance",customData:function(e,t){return[t]}}}},3839:function(e,t,n){"use strict";function r(e){return i(e)&&(2==(t=e).operation||t.toRecipientWell.recipients.some((function(e){return e.persona.EmailAddress.EmailAddress.toLowerCase()===t.groupId.toLowerCase()})));var t}function i(e){return!!e.groupId}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},3978:function(e,t,n){"use strict";n.d(t,"f",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return m})),n.d(t,"g",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"k",(function(){return b})),n.d(t,"i",(function(){return v})),n.d(t,"j",(function(){return O}));var r=n(1),i=n(121),a=n(5),o=n(19);function c(e,t){var n=g(e.selectedCLPLabel,"Change"),a=e.originalCLPLabel,o=e.selectedCLPLabel,c=Object(r.a)(Object(r.a)({},n),{IsLabelChanged:!0,LabelIdBefore:a?a.id:null,IsProtectionChanged:!(!a||!o)&&a.isEncryptingLabel!=o.isEncryptingLabel,ProtectedBefore:null==a?void 0:a.isEncryptingLabel,UserJustification:t});i.n.importAndExecute(c)}function s(e){var t=g(e,"Discover");i.n.importAndExecute(t)}function u(e){(null==e?void 0:e.value)&&e.value.length>0&&Object(i.s)("LoadCLPLabelOnBoot",{labelCount:e.value.length})}function d(e){e&&Object(i.s)("LoadCLPLabelComposeUsage",{isDefaultLabel:e.isDefault,isEncryptingLabel:e.isEncryptingLabel})}function l(e,t){t&&e?Object(i.s)("LoadCLPLabelChange",{isDowngrade:e.settingOrder>t.settingOrder,isOriginalLabelDefault:e.isDefault}):e&&Object(i.s)("LoadCLPLabelUnselect",{isOriginalLabelDefault:e.isDefault,isOriginalLabelEncrypting:e.isEncryptingLabel})}function m(e){401!=e.status&&Object(i.s)("CLPAutoLabelEnabled")}function f(){Object(i.s)("CLPMandatoryLabelDialogShown")}function p(){Object(i.s)("CLPAutoLabelAutomaticApplied")}function b(){Object(i.s)("CLPAutoLabelRecommendedShown")}function v(){Object(i.s)("CLPAutoLabelRecommendedApplied")}function O(){Object(i.s)("CLPAutoLabelRecommendedDismissed")}function g(e,t){var n=Object(o.a)().SessionSettings,r=n.ExternalDirectoryTenantGuid,i=n.UserEmailAddress;return{CreationTime:Object(a.ub)(Object(a.Rb)()),Version:"1.1",Operation:t,OrganizationId:r,UserId:i,ApplicationId:"00000002-0000-0ff1-ce00-000000000000",ApplicationName:"Outlook Web",DataState:"Use",LabelId:e?e.id:null,Protected:e?e.isEncryptingLabel:null}}},3979:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2239),i=n(979),a=n(2421);function o(e,t){var n;return Object(a.a)({Path:Object(i.a)({FieldURI:e}),Item:Object(r.a)((n={},n[e]=t,n))})}},4085:function(e,t,n){"use strict";function r(e){return e.policyMatchDetails.slice().sort((function(e,t){var n=i(t.Action)-i(e.Action);return 0==n?null==e.MatchPriority?null==t.MatchPriority?n:1:null==t.MatchPriority?-1:e.MatchPriority-t.MatchPriority:n}))[0]}function i(e){switch(e){case 1:return 0;case 4:case 2:case 3:return 1;case 5:return 2;default:return 3}}n.d(t,"a",(function(){return r}))},4086:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);function i(){return Object(r.a)().SessionSettings.UserEmailAddress}},4259:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2104),i=n(2381),a=n(24);function o(e){var t=[];return null==e||e.forEach((function(e){var n=Object(r.a)(e);if(n){var o=function(e){switch(e){case 4:return 4;case 3:return 3;case 6:return 6;case 5:return 5;case 2:return 2;case 1:return 1;default:return 0}}(n.permissionLevel),c=Object(a.i)("cmp-prague")&&function(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}(o)&&Object(i.a)(n.fileName);if(1===o||2===o||c){var s={ProviderType:"OneDrivePro",Url:n.url,PermissionType:o};t.push(s)}}})),t}},4260:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Manual="manual",e.Automatic="automatic",e.Default="default"}(r||(r={}))},4261:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);function i(e){return e===Object(r.a)().SessionSettings.UserEmailAddress}},4356:function(e,t,n){"use strict";var r=n(6),i=n(6014),a=n(2151),o=n(1110),c=n(33),s=n(1);function u(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(s.a)({__type:"GetDlpPolicyTipsRequest:#Exchange"},n)),Object(c.a)("GetDlpPolicyTips",e,t)}var d=n(197),l=n(2211),m=n(183),f=n(3053),p=n(4085),b=n(23);n.d(t,"b",(function(){return y}));var v=Object(m.action)("triggerPolicyTips")((function(e,t,n,r,a){var o,c=e.policyTipsViewState;if(!(c.handlerDisabled||(null===(o=e.protectionViewState)||void 0===o?void 0:o.IRMData))){var s,d=c.inProgressPolicyMatch,m=c.succeededPolicyMatch,p=c.pendingPolicyMatch;if(n||(n=I(e.subject)),r||(r=I(e.content)),a||(a=Object(i.a)(e)),c.isRequestInProgress)c.pendingRequests=!0,p.itemId=e.itemId,p.subjectChecksum=n,p.contentChecksum=r,p.eventTrigger=t,p.attachmentIds=a;else{if(c.pendingRequests=!1,d.itemId=e.itemId,d.subjectChecksum=n,d.contentChecksum=r,d.eventTrigger=t,d.attachmentIds=a,0==(s=d).subjectChecksum&&0==s.contentChecksum&&0==s.attachmentIds.length)return m.policyMatchDetails=[],m.subjectChecksum=0,m.contentChecksum=0,m.attachmentIds=[],void Object(l.a)(e,"dlpPolicyTips");(j(d,m)||function(e,t){if(e.attachmentIds.length!=t.attachmentIds.length)return!0;for(var n=0;n<e.attachmentIds.length;n++)if(null!=e.attachmentIds[n]&&null!=t.attachmentIds[n]&&e.attachmentIds[n].Id!=t.attachmentIds[n].Id)return!0;return!1}(d,m)||1==t)&&function(e){var t=e.policyTipsViewState,n=t.succeededPolicyMatch,r=t.inProgressPolicyMatch,i=e.itemId;if(null==i?void 0:i.Id){var a={ItemId:i,ClientSupportsScanResultData:!0,ScanResultData:n.scanResultData,ScanResultMetadata:n.scanResultMetaData,BodyOrSubjectChanged:j(r,n),NeedToReclassify:!n.itemId,CustomizedStringsNeeded:!0,Recipients:Object(f.a)(e),EventTrigger:r.eventTrigger};e.policyTipsViewState.isRequestInProgress=!0,u(a).then((function(t){!function(e,t,n,r){var i=t.policyTipsViewState,a=i.pendingPolicyMatch;i.isRequestInProgress=!1,i.pendingRequests&&a&&v(t,a.eventTrigger,a.subjectChecksum,a.contentChecksum,a.attachmentIds);0==e.EvaluationResult||1==e.OptimizationResult||2==e.EvaluationResult?n(t,e):r(t,e)}(t,e,O,g)}))}}(e)}}}));t.a=v;function O(e,t){var n=e.policyTipsViewState,r=n.succeededPolicyMatch,i=n.inProgressPolicyMatch;r.itemId=i.itemId,r.attachmentIds=i.attachmentIds,r.subjectChecksum=i.subjectChecksum,r.contentChecksum=i.contentChecksum,r.policyMatchDetails=t.Matches,t.ScanResultData&&(r.scanResultData=t.ScanResultData),t.ScanResultMetadata&&(r.scanResultMetaData=t.ScanResultMetadata),1==t.OptimizationResult&&(n.handlerDisabled=!0),function(e,t){if(t){var n=e.policyTipsViewState,r={complianceUrl:t.ComplianceURL,blockString:t.PolicyTipMessageBlockString,notifyString:t.PolicyTipMessageNotifyString,overrideString:t.PolicyTipMessageOverrideString};Object(o.a)(n,r,(function(e,t){return t||e}))}}(e,t.CustomizedStrings),y(e)}function g(e,t){var n=e.policyTipsViewState;t?(b.g.warn(Object(r.c)("PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult)+" Diagnostic: "+t.DiagnosticData),4!=t.EvaluationResult&&7!=t.EvaluationResult&&1!=t.EvaluationResult&&6!=t.EvaluationResult&&8!=t.EvaluationResult||(b.g.warn("Disabling further PolicyTips requests because of the failure"),n.handlerDisabled=!0)):(b.g.warn("PolicyTipsResponse is null (PolicyTipsRequest is timed out)"),n.handlerDisabled=!0),Object(l.a)(e,"dlpPolicyTips")}function y(e){Object(l.a)(e,["consumerDlpPolicyTips","enterpriseDlpPolicyTips"]),Object(p.a)(e.policyTipsViewState.succeededPolicyMatch)&&(Object(d.a)()?Object(a.a)(e,"consumerDlpPolicyTips"):Object(a.a)(e,"enterpriseDlpPolicyTips"))}function I(e){var t=0;if(e)for(var n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}function j(e,t){return e.subjectChecksum!=t.subjectChecksum||e.contentChecksum!=t.contentChecksum}},4427:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(981),i=n(1087),a=n(979),o=n(1262),c=n(1100),s=n(24),u=n(5110);function d(e){var t=Object(r.a)({BaseShape:"IdOnly",ClientSupportsIrm:!0,FilterHtmlContent:!0,InlineImageCustomDataTemplate:i.e,InlineImageUrlOnLoadTemplate:"",InlineImageUrlTemplate:i.f,AdditionalProperties:[Object(a.a)({FieldURI:"ItemLastModifiedTime"})]});return Object(u.a)(t),e&&(t.BodyType=e),t.ImageProxyCapability=Object(s.i)("rp-replyImageProxy")&&Object(o.a)()?c.a.OwaConnectorsProxyAndCompose:c.a.None,t}},4428:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);function i(){return Object(r.a)().PolicyTipsEnabled}},4508:function(e,t,n){"use strict";var r=n(5108),i=n(4086),a=n(1255),o=n(19),c=n(197);var s=n(5549);function u(){var e,t,n=(e=Object(o.a)(),t=Object(c.a)()?e.SessionSettings.DefaultFromAddress:e.UserOptions.SendAddressDefault,Object(a.c)(t)?t:Object(i.a)()),u=Object(i.a)();if(u===n&&Object(s.a)(n)){var d=Object(r.b)(u,!0);if(d&&d.length>0)return d[0]}return n}var d=n(6501),l=n(1956);function m(e){var t;if(e){var n=Object(l.g)(),r=null==n?void 0:n.items,i=r&&r.has(e.Id)&&r.get(e.Id);t=i&&Object(d.a)(i.ToRecipients,i.CcRecipients)}return{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:t||u(),Name:Object(o.a)().SessionSettings.UserDisplayName}}n.d(t,"a",(function(){return m}))},4611:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r={Name:{id:34230,propertyType:"String"},Description:{id:34231,propertyType:"String"},Id:{id:34232,propertyType:"String"},IsClassified:{id:34229,propertyType:"Boolean"}},i="messageClassification"},4613:function(e,t,n){"use strict";var r=n(183);t.a=Object(r.action)("setIsDirty")((function(e,t){void 0===t&&(t=!0),e.isDirty=t}))},479:function(e,t,n){"use strict";var r=n(658),i=n(879),a=n(448);t.a=function(e){return Object(a.a)(e)?Object(r.a)(e):Object(i.a)(e)}},4871:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r="<div id=appendonsend></div>";function i(e){var t="";return"HTML"==e&&(t+=r),t}},4872:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return c}));var r="msip_labels",i="X-MS-Exchange-Organization-ModifySensitivityLabel",a="00000000-0000-0000-0000-000000000000",o="Standard",c="Privileged"},5106:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1956);function i(e,t){var n,i,a,o="";if(e){var c=r.u.items.get(null===(n=e.referenceItemId)||void 0===n?void 0:n.Id);switch(t){case"smartReply":(null===(i=null==c?void 0:c.SmartReplyData)||void 0===i?void 0:i.ExtractionID)&&(o=c.SmartReplyData.ExtractionID);break;case"smartDoc":(null===(a=null==c?void 0:c.SmartDocData)||void 0===a?void 0:a.EntityId)&&(o=c.SmartDocData.EntityId)}}return o}},5107:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade","errorMessageExceededHourlyMessageLimit","errorMessageExceededMaxRecipientLimit","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimit","errorMessageExceededMessageLimitShowTierUpgrade","errorMessageMessageSubmissionBlocked","errorMessageMessageBlocked","errorMessageTimeout","errorMessageThrottled","errorMessageTransientError","errorMessageItemNoLongerExistToSave","errorMessageItemNoLongerExistToSend","errorMessageQuotaExceededMessageCanNotBeSaved","errorMessageQuotaExceededMessageCanNotBeSent","errorMessageSubmissionQuotaExceededMessageCanNotBeSent","errorMessageMessageCanNotBeSaved","errorMessageMessageCanNotBeSent","errorMessageNoPermissionToSendAs","errorMessageNoRecipentsMailCanNotBeSend","errorMessageInvalidSenderMailCanNotBeSend","warningMessageNoPermissionToPerformAction","error500","error503","errorFailedToFetch","errorSessionTimeout","errorMailboxStoreUnavailable","errorMessageErrorWithDetail","smimeEncodeError","smimeBccForkingFailedError"]},5108:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(4086),i=n(5549),a=n(19),o=n(197);function c(e){var t=[],n=Object(r.a)();Object(i.a)(n)||t.push(n);var o=s(n,e);return t=function(e){var t=Object(a.a)().SessionSettings.ConnectedAccountInfos;t&&t.length>0&&t.forEach((function(t){-1==e.lastIndexOf(t.EmailAddress)&&e.push(t.EmailAddress)}));return e}(t=t.concat(o))}function s(e,t){var n=[];if(Object(o.a)()||t){var r=function(e){return u(e,Object(a.a)().SessionSettings.UserProxyAddresses)}(e);n=n.concat(r)}if(Object(o.a)()){var i=function(e){return u(e,Object(a.a)().SessionSettings.NotManagedEmailAddresses)}(e);n=n.concat(i)}return n}function u(e,t){var n=[];return t&&t.length>0&&t.forEach((function(t){e==t||Object(i.a)(t)||n.push(t)})),n}},5109:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r=function(e,t,n){return void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===n&&(n=0),{shouldEncryptMessageAsSmime:e,shouldSignMessageAsSmime:t,signingCertRawData:null,errorCode:n,errorContext:0,smimeBccForkingMode:0,currentBccRecipientIndex:-1}};function i(e){switch(e){case 6:return r(!0,!1);case 10:case 11:return r(!1,!0);case 12:case 13:case 14:return r(!0,!0);case-1:case 0:default:return r()}}},5110:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(24),i=n(449);function a(e){var t;Object(r.i)("cmp-clp")&&(null===(t=e.AdditionalProperties)||void 0===t||t.push(Object(i.a)({PropertyName:"msip_labels",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})))}},5111:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(819),i=n(449),a=n(2239),o=n(2421);function c(e){return Object(o.a)({Path:Object(i.a)(e.ExtendedFieldURI),Item:Object(a.a)({ExtendedProperty:[Object(r.a)(e)]})})}},5549:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19),i=n(197);function a(e){var t=!1;if(Object(i.a)()){var n=Object(r.a)();t=0==(e=e.toLowerCase()).indexOf("outlook_"+n.HexCID)||-1!=e.indexOf("@shadow.outlook.com")}return t}},5550:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(2169),i=n(31),a=new i.c((function(){return Promise.all([n.e(0),n.e(7),n.e(26),n.e(43),n.e(47),n.e(673)]).then(n.bind(null,8491))})),o=Object(r.a)(a,(function(e){return e.AtMentionPickerPlugin}),"AtMentionsPicker",(function(e){return 11==e.eventType})),c=new i.b(a,(function(e){return e.loadAtMentionsData}))},5781:function(e,t,n){"use strict";var r=n(1),i=n(4427),a=n(24),o=n(2209),c=n(2124),s=n(19),u=n(2951),d=n(613),l=n(981),m=n(979),f=n(984),p=n(3384),b=n(180),v=n(2556),O=n(419);function g(e,t,n,g,y,I,j,S,h){var E,k,M=function(e,t,n,o,c,s,p,b,O){var g="PostItem:#Exchange"==e.__type?"newPost":"newMail",y=p?Object(f.a)({BaseFolderId:Object(d.a)({Id:p})}):null,I=Object(u.a)(Object(r.a)({ClientSupportsIrm:!0,ComposeOperation:g,MessageDisposition:n?"SendAndSaveCopy":"SaveOnly",Items:[e],TimeFormat:o,SendOnNotFoundError:!0,RemoteExecute:b,ItemShape:Object(l.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(m.a)({FieldURI:"ItemLastModifiedTime"})]}),SavedItemFolderId:null!=y?y:void 0,SuppressMarkAsReadOnReplyOrForward:Object(a.i)("tri-suppressMarkReadBehaviorOnRF")&&O},Object(v.a)()));return(null==s?void 0:s.IsOwner)&&(I.ComplianceId=s.RmsTemplateId?s.RmsTemplateId.toUpperCase():"0"),n?c&&I.ItemShape&&(I.ItemShape.ReturnOnlyInternetMessageId=!0):(I.ItemShape=Object(i.a)(t),I.ShapeName="MailCompose"),I}(e,t,n,g,y,I,j,S,h);if("PostItem:#Exchange"==e.__type&&j){var R=c.a.folderTable.get(j);if(R){var T=R.ReplicaList?R.ReplicaList[0]:null===(E=Object(s.a)().SessionSettings)||void 0===E?void 0:E.DefaultPublicFolderMailbox;if(T){var C=Object(o.a)(T);k=Object(O.a)(C)}}}return Object(p.a)({Header:Object(b.b)(),Body:M},k).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}n.d(t,"a",(function(){return g}))},6014:function(e,t,n){"use strict";function r(e){var t=[],n=e.attachmentWell;return n&&(n.docViewAttachments.forEach((function(e){t.push(e.attachmentId)})),n.inlineAttachments.forEach((function(e){t.push(e.attachmentId)})),n.imageViewAttachments.forEach((function(e){t.push(e.attachmentId)}))),t}n.d(t,"a",(function(){return r}))},6015:function(e,t,n){"use strict";var r=n(1);t.a=function(e){return e&&0!==e.length?e.filter((function(e){return!!e})).reduce((function(e,t){return Object(r.j)(Object(r.j)([],Object(r.g)(e)),Object(r.g)((null==(n=t)?void 0:n.recipients)?n.recipients.slice():[]));var n}),[]):[]}},6016:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1956);function i(e){var t,n;if(e){var i=r.u.items.get(null===(t=e.referenceItemId)||void 0===t?void 0:t.Id);if(i){var a=null===(n=null==i?void 0:i.stampedLanguage)||void 0===n?void 0:n.language;return a||""}}return""}},6017:function(e,t,n){"use strict";function r(e,t){if(e){if(e.indexOf("500")>=0)return"error500";if(e.indexOf("503")>=0)return"error503";if(e.indexOf("Failed to fetch")>=0)return"errorFailedToFetch"}switch(e){case"ErrorSessionTimeout":return"errorSessionTimeout";case"ErrorMailboxStoreUnavaiable":return"errorMailboxStoreUnavailable";case"ErrorSendAsDenied":return"errorMessageNoPermissionToSendAs";case"ErrorRightsManagementPermanentException":return null;case"ErrorSubmissionQuotaExceeded":return"errorMessageSubmissionQuotaExceededMessageCanNotBeSent";case"ErrorAccountSuspend":return"errorMessageAccountSuspend";case"ErrorExceededMaxRecipientLimit":return"errorMessageExceededMaxRecipientLimit";case"ErrorExceededMessageLimit":return"errorMessageExceededMessageLimit";case"ErrorExceededHourlyMessageLimit":return"errorMessageExceededHourlyMessageLimit";case"ErrorMessageBlocked":return"errorMessageMessageBlocked";case"ErrorMessageSubmissionBlocked":return"errorMessageMessageSubmissionBlocked";case"ErrorAccountSuspendShowTierUpgrade":return"errorMessageAccountSuspendShowTierUpgrade";case"ErrorExceededMaxRecipientLimitShowTierUpgrade":return"errorMessageExceededMaxRecipientLimitShowTierUpgrade";case"ErrorExceededMessageLimitShowTierUpgrade":return"errorMessageExceededMessageLimitShowTierUpgrade";case"ErrorMessageTimeout":return"errorMessageTimeout";case"ErrorMessageThrottled":return"errorMessageThrottled";case"ErrorMessageTransientError":return"errorMessageTransientError";case"ErrorItemNotFound":return t?"errorMessageItemNoLongerExistToSend":"errorMessageItemNoLongerExistToSave";case"ErrorAccessDenied":return"warningMessageNoPermissionToPerformAction";case"SmimeEncodeError":return"smimeEncodeError";case"ErrorQuotaExceeded":return t?"errorMessageQuotaExceededMessageCanNotBeSent":"errorMessageQuotaExceededMessageCanNotBeSaved";default:return t?"errorMessageMessageCanNotBeSent":"errorMessageMessageCanNotBeSaved"}}n.d(t,"a",(function(){return r}))},6018:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(439);function i(e){return e?Object(r.a)({Id:e.Id,ChangeKey:e.ChangeKey}):null}},6019:function(e,t,n){"use strict";function r(e){if(e.smimeBccForkingMode){var t=e.smimeBccForkingMode;return 2===t||3===t}return!1}n.d(t,"a",(function(){return r}))},6020:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(31),i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(5),n.e(756)]).then(n.bind(null,10335))})),a=Object(r.d)(i,(function(e){return e.HipCheckModal}))},6021:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.recipients)?e.recipients.length:0}n.d(t,"a",(function(){return r}))},6026:function(e,t,n){"use strict";var r=n(2582),i=n(2);t.a=Object(i.mutatorAction)("showCcWell",(function(e){e.ccRecipientWell||(e.ccRecipientWell=Object(r.a)(e.toRecipientWell.findPeopleFeedbackManager,[]))}))},623:function(e,t,n){"use strict";var r,i=n(1),a=n(0),o=n(858),c=n(23);!function(e){e[e.Full=0]="Full",e[e.Simple=1]="Simple",e[e.None=2]="None"}(r||(r={}));var s=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return Object(i.e)(t,e),t.prototype.componentDidCatch=function(e,t){var n,r;null===(r=(n=this.props).onError)||void 0===r||r.call(n,e,t),this.props.suppressErrorReport||(e.component=!0,e.diagnosticInfo=(e.diagnosticInfo||"")+t.componentStack,Object(c.d)(e)),this.setState({error:e})},t.prototype.render=function(){var e=this.state.error,t=this.props,n=t.children,o=t.type,c=t.windowIcons;if(e){if(o==r.None)return null;if(o==r.Simple||!this.props.fullErrorComponent)return a.createElement("div",null,e);var s=this.props.fullErrorComponent;return a.createElement(s,Object(i.a)({error:e,windowIcons:c},this.props.fullErrorComponentProps))}return n},t=Object(i.d)([o.observer],t)}(a.Component);n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r}))},6324:function(e,t,n){"use strict";var r=n(1),i=n(6018),a=n(2841),o=n(4508),c=n(4426),s=n(5109),u=n(6019);var d=new RegExp("<img[^>]*\\s+src=[\"']data:image\\/[^<]+;base64,\\s*[a-zA-Z0-9+\\/=&#;]+[\"'][^>]*>","gi");function l(e){var t=0;if(e){var n=e.match(d);t=n?n.length:0}return t}var m=new RegExp('<IMG[^>]+?ORIGINALSRC\\s*=\\s*"[\\s\\S]+?"[\\s\\S]*?>',"gim"),f=new RegExp('\\sSRC\\s*=\\s*"DATA:[\\s\\S]+?"',"im"),p=new RegExp('\\sORIGINALSRC\\s*=\\s*"',"im");function b(e,t){return e?e.replace(m,(function(e){return e=e.replace(f,""),t&&(e=e.replace(p,' src="')),e})):e}var v=n(19),O=n(3565),g=n(819),y=n(449),I=35356;var j=n(5),S="0x3FEF";function h(e,t){if(t.ExtendedProperty)for(var n=e.length;n--&&t.ExtendedProperty.length>0;)for(var r=t.ExtendedProperty.length;r--;)if(e[n]===t.ExtendedProperty[r].ExtendedFieldURI.PropertyName){t.ExtendedProperty.splice(r,1);break}}function E(e,t,n){var r,i;n?h(["AppendOnSend"],t):e.appendOnSend&&e.appendOnSend.length>0&&(r=e.appendOnSend,(i=t).ExtendedProperty||(i.ExtendedProperty=[]),i.ExtendedProperty.push(Object(g.a)({Value:JSON.stringify(r),ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"Common",PropertyName:"AppendOnSend",PropertyType:"String"})})))}function k(e,t){e.internetHeaders.size>0&&function(e,t){var n,i;t.ExtendedProperty||(t.ExtendedProperty=[]);try{for(var a=Object(r.k)(e.keys()),o=a.next();!o.done;o=a.next()){var c=o.value;t.ExtendedProperty.push(Object(g.a)({Value:e.get(c),ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"InternetHeaders",PropertyName:c,PropertyType:"String"})}))}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}(e.internetHeaders,t),e.keysOfInternetHeadersToBeRemoved.length>0&&h(e.keysOfInternetHeadersToBeRemoved,t)}function M(e,t,n){n?h(["ComposeType"],t):null!==e.draftComposeType&&function(e,t){t.ExtendedProperty||(t.ExtendedProperty=[]);t.ExtendedProperty.push(Object(g.a)({Value:e,ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"Common",PropertyName:"ComposeType",PropertyType:"String"})}))}(e.draftComposeType,t)}var R=n(3839),T=n(6502),C=n(2),P=Object(C.mutatorAction)("clearKeysOfInternetHeadersToBeRemoved",(function(e){e.keysOfInternetHeadersToBeRemoved=[]})),x=n(439),w=n(183);function N(e){e&&(e.isDirty=!1)}var D=Object(w.action)("updateComposeItemId")((function(e,t,n,r){e&&(e.itemId?e.itemId.ChangeKey=n:e.itemId=Object(x.a)({Id:t,ChangeKey:n}),r&&(e.lastSaveTimeStamp=r,e.isDirty=!1,N(e.toRecipientWell),N(e.ccRecipientWell),N(e.bccRecipientWell)))})),A=n(2626),F=n(4871),L=n(2128),V=n(24),B=n(1959),U=n(2273),_=n(4259),W=n(6),q=n(4260),G=n(4872),H=function(e){switch(e.labelApplyMethod){case q.a.Manual:return G.d;case q.a.Default:case q.a.Automatic:default:return G.e}},K=n(3978),X="MSIP_Label";function J(e){var t=e.selectedCLPLabel,n=e.nonTenantLabelString,r=Object(v.a)().SessionSettings.ExternalDirectoryTenantGuid,i="";t&&(i=function(e,t){return Object.keys(e).map((function(n){return X+"_"+t.id+"_"+n+"="+e[n]+";"})).join("")}({Enabled:"True",SiteId:r,SetDate:Object(j.ub)(Object(j.Rb)()),Name:t.displayName,ContentBits:0,Method:H(e)},t));return n?n+i:i}function z(e){var t=e.selectedCLPLabel,n=e.originalCLPLabel;if(t||n){var r=t&&!n&&t.isDefault;return(n&&!r?n.id:G.a)+";"+(t?t.id:G.a)}}function Q(e,t,n){var r=Object(g.a)({ExtendedFieldURI:Object(y.a)({PropertyName:e,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:t});n.ExtendedProperty?n.ExtendedProperty.push(r):n.ExtendedProperty=[r]}var Z=n(3479),$=n(2031),Y=n(4611);var ee=n(5781),te=n(6797),ne=n(2030),re=n(981);var ie=n(979),ae=n(33);function oe(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.a)({__type:"PostGroupItemJsonRequest:#Exchange"},n)),Object(ae.a)("PostGroupItem",e,t)}var ce=n(180),se=n(2556);function ue(e,t,n,i,a,o){var c,s=(c=Object(r.a)({ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:"SendAndSaveCopy",Items:[t],TimeFormat:i,ItemShape:Object(re.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ie.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(se.a)()),Object(r.a)({__type:"PostGroupItemRequest:#Exchange"},c));return o&&(s.ItemShape.ReturnOnlyInternetMessageId=!0),(null==a?void 0:a.IsOwner)&&(s.ComplianceId=a.RmsTemplateId?a.RmsTemplateId.toUpperCase():"0"),s}function de(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.a)({__type:"PostUnifiedGroupItemJsonRequest:#Exchange"},n)),Object(ae.a)("PostUnifiedGroupItem",e,t)}function le(e,t,n,i,a){var o,c=(o={ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},SkipGroupSyncDelivery:!0,ClientSupportsIrm:!0,Item:t,ItemShape:Object(re.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ie.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(r.a)({__type:"PostUnifiedGroupItemRequest:#Exchange"},o));return a&&(c.ItemShape.ReturnOnlyInternetMessageId=!0),c}var me=n(5111),fe=n(3979),pe=n(3138);function be(e,t){return Object(pe.a)({Path:Object(y.a)({DistinguishedPropertySetId:e,PropertyName:t,PropertyType:"String"})})}var ve=n(2389),Oe=n(2539),ge=n(2532);function ye(e,t,n,i){var a=function(e,t,n,i){var a,o=[];e.MimeContent&&o.push(Object(fe.a)("MimeContent",e.MimeContent));var c=[Object(fe.a)("ToRecipients",e.ToRecipients),Object(fe.a)("CcRecipients",e.CcRecipients),Object(fe.a)("BccRecipients",e.BccRecipients),Object(fe.a)("Subject",e.Subject),Object(fe.a)("Body",e.Body),Object(fe.a)("Importance",e.Importance),Object(fe.a)("IsReadReceiptRequested",e.IsReadReceiptRequested),Object(fe.a)("IsDeliveryReceiptRequested",e.IsDeliveryReceiptRequested)];(null===(a=e.Attachments)||void 0===a?void 0:a.length)&&c.push(Object(fe.a)("Attachments",e.Attachments)),e.ItemClass&&c.push(Object(fe.a)("ItemClass",e.ItemClass)),e.From&&c.push(Object(fe.a)("From",e.From)),i.length>0&&i.map((function(e){c.push(be("InternetHeaders",e))})),t&&c.push(be("Common","AppendOnSend")),e.MentionsEx&&c.push(Object(fe.a)("MentionsEx",e.MentionsEx)),e.PendingSocialActivityTagIds&&c.push(Object(fe.a)("PendingSocialActivityTagIds",e.PendingSocialActivityTagIds)),e.Sensitivity&&c.push(Object(fe.a)("Sensitivity",e.Sensitivity)),e.ExtendedProperty&&e.ExtendedProperty.map((function(e){c.push(Object(me.a)(e))})),t&&e.DocLinks&&e.DocLinks.length>0&&c.push(Object(fe.a)("DocLinks",e.DocLinks));var s=Object(ve.a)({Updates:Object(r.j)(Object(r.j)([],Object(r.g)(o)),Object(r.g)(c)),ItemId:Object(x.a)({Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey})}),u=Object(Oe.a)(Object(r.a)({ItemChanges:[s],ConflictResolution:"AlwaysOverwrite",ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone",MessageDisposition:t?"SendAndSaveCopy":"SaveOnly",SuppressReadReceipts:!1,ComposeOperation:"newMail",PromoteInlineAttachments:!1,SendOnNotFoundError:!0,ItemShape:Object(re.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ie.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(se.a)()));return(null==n?void 0:n.IsOwner)&&(u.ComplianceId=n.RmsTemplateId?n.RmsTemplateId.toUpperCase():"0"),u}(e,t,n,i);return Object(ge.a)({Header:Object(ce.b)(),Body:a}).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}var Ie=n(2033),je=n(1955),Se="InternetHeaders",he="X-Ms-Exchange-Organization-Dlp-SenderOverrideJustification",Ee="X-Ms-Exchange-Organization-Dlp-FalsePositive";var ke=n(2584);function Me(e){if(!e)return null;var t=e.IRMData;return!t||t.RmsTemplateId&&!ke.b.rmsTemplates.get(t.RmsTemplateId)?null:t}function Re(e){return Object(r.a)({__type:"ApproveRequestItem:#Exchange"},e)}var Te=n(2255),Ce=n(2239);function Pe(e){return Object(r.a)({__type:"RejectRequestItem:#Exchange"},e)}var xe=n(6503),we=n(6504),Ne=n(197),De=n(3269),Ae=n(3270),Fe=n(2391),Le=n(5550),Ve=n(4261),Be="X-MS-Exchange-Organization-ClientSubmitSmtp-OriginalFrom";var Ue=n(2603),_e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CreateDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isSend"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"isSend"},value:{kind:"Variable",name:{kind:"Name",value:"isSend"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"Body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"}}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"}}]}}]}}]}}]},We=n(1250),qe=n(94),Ge=n(14);function He(e,t){return{ToRecipients:e.ToRecipients,CcRecipients:e.CcRecipients,BccRecipients:e.BccRecipients,Subject:e.Subject,Body:e.Body?{Value:e.Body.Value,DataUriCount:e.Body.DataUriCount,BodyType:e.Body.BodyType}:void 0,NewBodyContent:e.NewBodyContent?{Value:e.NewBodyContent.Value,DataUriCount:e.NewBodyContent.DataUriCount,BodyType:e.NewBodyContent.BodyType}:void 0,Importance:e.Importance,IsReadReceiptRequested:e.IsReadReceiptRequested,IsDeliveryReceiptRequested:e.IsDeliveryReceiptRequested,UpdateResponseItemId:e.UpdateResponseItemId,ReferenceItemId:e.ReferenceItemId,ReferenceItemDocumentId:e.ReferenceItemDocumentId,atMentionedRecipients:Xe(t),recipientsAddedViaAtMention:t.mentionsPicker.mentionsAddedRecipients?Object(Ge.toJS)(t.mentionsPicker.mentionsAddedRecipients):void 0,connectedAccountSharingGuid:Je(t),deferredSendTime:t.deferredSendTime?Object(j.ub)(t.deferredSendTime):void 0,clpLabelModifificationHeader:z(t.protectionViewState.clpViewState),clpLabelProperty:J(t.protectionViewState.clpViewState),messageClassification:Qe(t),originalSmtpFromAddress:Ze(t),operation:Ke(t.operation),sendAs:$e(t)}}function Ke(e){switch(e){case 0:return"New";case 1:return"Reply";case 2:return"ReplyAll";case 3:return"Forward";case 4:return"EditDraft";case 5:case 6:return Object(qe.a)(e)}}function Xe(e){var t=e.mentionsPicker.atMentionTuples;return t?Object.keys(t).map((function(e){return{key:e,emailAddress:t[e].EmailAddress}})):[]}function Je(e){var t,n,r,i=null===(r=null===(n=null===(t=e.fromViewState)||void 0===t?void 0:t.from)||void 0===n?void 0:n.email)||void 0===r?void 0:r.EmailAddress;if(i){var a=ze(i);return null==a?void 0:a.SubscriptionGuid}}function ze(e){var t=Object(v.a)().SessionSettings.ConnectedAccountInfos;if(t)for(var n=0;n<t.length;n++){var r=t[n];if(r.EmailAddress==e)return r}}function Qe(e){var t=e.protectionViewState.classificationViewState;return t.messageClassification?Object(r.a)(Object(r.a)({},t.messageClassification),{isClassified:!0}):void 0}function Ze(e){var t,n,r,i=null===(r=null===(n=null===(t=e.fromViewState)||void 0===t?void 0:t.from)||void 0===n?void 0:n.email)||void 0===r?void 0:r.EmailAddress;if(i&&!Object(Ve.a)(i))return i}function $e(e){var t,n,r=null===(n=null===(t=e.fromViewState)||void 0===t?void 0:t.from)||void 0===n?void 0:n.email;if(r){var i=ze(r.EmailAddress);return i?{MailboxType:r.MailboxType,RoutingType:"SMTP",EmailAddress:r.EmailAddress,Name:i.DisplayName}:r}}var Ye={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SaveDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemId"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"saveDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemId"},value:{kind:"Variable",name:{kind:"Name",value:"itemId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"Body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"}}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"}}]}}]}}]}}]},et={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SaveSmartReply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemId"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"saveSmartReply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemId"},value:{kind:"Variable",name:{kind:"Name",value:"itemId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"Body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"}}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"}}]}}]}}]}}]},tt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SendDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemId"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemId"},value:{kind:"Variable",name:{kind:"Name",value:"itemId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"Body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"}}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"}}]}}]}}]}}]},nt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SendSmartReply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemId"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendSmartReply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemId"},value:{kind:"Variable",name:{kind:"Name",value:"itemId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"Body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"}}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"}}]}}]}}]}}]};function rt(e,t){return e?t?nt:tt:t?et:Ye}var it=n(419);n.d(t,"c",(function(){return mt})),n.d(t,"b",(function(){return ft})),n.d(t,"a",(function(){return pt}));var at='<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css" style="display:none;"> P {{margin-top:0;margin-bottom:0;}} </style></head><body dir="{0}">{1}</body></html>',ot="IPM.Note";function ct(e){var t=e.content,n=0;if("HTML"==e.bodyType){var i=bt(e);n=l(t=b(t)),t=Object(W.c)(at,i,t)}var a,o=Object(Te.a)({BodyType:e.bodyType,Value:t});o.DataUriCount=n;var c,s={Subject:e.subject||"",Importance:e.importance,Sensitivity:e.sensitivity};return c=Object(r.a)(Object(r.a)({},s),{Body:o}),a=Object(r.a)({__type:"PostItem:#Exchange"},c),e.itemId&&(a.ItemId=e.itemId),e.fromViewState&&function(e,t){var n=e.from;t.From=Object(O.a)({Mailbox:n.email})}(e.fromViewState,a),a}var st=function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n;return Object(r.f)(this,(function(r){switch(r.label){case 0:return Object(Ae.a)(e.smimeViewState)?[2,null]:[4,L.h.import()];case 1:return(null==(t=r.sent()(e.attachmentWell,e.content,e.bodyType,!0))?void 0:t.length)?[4,Ue.i.import()]:[3,3];case 2:return n=r.sent()(t),[3,4];case 3:n=null,r.label=4;case 4:return[2,n]}}))}))};function ut(e){var t=e.content,n=0,a=Object(Ae.a)(e.smimeViewState);if(e.useSmartResponse&&(t+=Object(F.a)(e.bodyType)),"HTML"==e.bodyType){var o=bt(e);n=l(t=b(t,a)),t=Object(W.c)(at,o,t)}var s=Object(Te.a)({BodyType:e.bodyType,Value:t});s.DataUriCount=n;var u,d=Object(i.a)(e.itemId),m=Object(i.a)(e.referenceItemId),f=[],p=[],h=[];if(e.smimeViewState&&0!=e.smimeViewState.smimeBccForkingMode)switch(e.smimeViewState.smimeBccForkingMode){case 1:f=Object(c.a)(e.toRecipientWell),p=Object(c.a)(e.ccRecipientWell);break;case 2:if(e.bccRecipientWell){var E=e.smimeViewState.currentBccRecipientIndex;h=[Object(c.a)(e.bccRecipientWell)[E]]}break;case 3:e.bccRecipientWell&&(h=Object(c.a)(e.bccRecipientWell))}else f=Object(c.a)(e.toRecipientWell),p=Object(c.a)(e.ccRecipientWell),h=Object(c.a)(e.bccRecipientWell);var k={Subject:e.subject||"",Importance:e.importance,IsReadReceiptRequested:e.isReadReceiptRequested,IsDeliveryReceiptRequested:e.isDeliveryReceiptRequested,ToRecipients:f,CcRecipients:p,BccRecipients:h,Sensitivity:e.sensitivity};return e.useSmartResponse?u=(2==e.operation?xe.a:we.a)(Object(r.a)(Object(r.a)({},k),{UpdateResponseItemId:d,ReferenceItemId:m,ReferenceItemDocumentId:e.referenceItemDocumentId||0,NewBodyContent:s})):5==e.operation||6==e.operation?u=(5==e.operation?Re:Pe)(Object(r.a)(Object(r.a)({},k),{ReferenceItemId:m,ItemId:d,Body:s})):(u=Object(Ce.a)(Object(r.a)(Object(r.a)({},k),{Body:s})),e.itemId&&(u.ItemId=e.itemId)),e.fromViewState&&function(e,t){var n=e.from;if(n){var r=!1,i=Object(v.a)().SessionSettings.ConnectedAccountInfos;if(i)for(var a=0;a<i.length;a++){var o=i[a];if(o.EmailAddress==n.email.EmailAddress){r=!0;var c=Object(g.a)({Value:o.SubscriptionGuid,ExtendedFieldURI:Object(y.a)({PropertyId:I,DistinguishedPropertySetId:"Sharing",PropertyType:"CLSID"})});t.ExtendedProperty?t.ExtendedProperty.push(c):t.ExtendedProperty=[c],t.From=Object(O.a)({Mailbox:{MailboxType:n.email.MailboxType,RoutingType:"SMTP",EmailAddress:n.email.EmailAddress,Name:o.DisplayName}});break}}r||(t.From=Object(O.a)({Mailbox:n.email}))}}(e.fromViewState,u),e.deferredSendTime&&function(e,t){if(e){var n=Object(g.a)({Value:Object(j.ub)(e),ExtendedFieldURI:Object(y.a)({PropertyTag:S,PropertyType:"SystemTime"})});t.ExtendedProperty?t.ExtendedProperty.push(n):t.ExtendedProperty=[n]}}(e.deferredSendTime,u),u}function dt(e,t){var n,i;return Object(r.c)(this,void 0,void 0,(function(){var d,l,m,f,p,b,O,I,j,S,h,C,x;return Object(r.f)(this,(function(w){switch(w.label){case 0:return m=Object(v.a)().UserOptions.TimeFormat,Object(Z.a)(e)?(f=e,d=ct(e),[4,Object(ee.a)(d,e.bodyType,t,m,e.isInlineCompose,Me(e.protectionViewState),f.publicFolderId)]):[3,2];case 1:return l=w.sent(),[3,14];case 2:return d=ut(e),p=d,[4,st(e)];case 3:return p.Attachments=w.sent(),k(e.addin,d),E(e.addin,d,t),M(e.addin,d,t),b=e.protectionViewState,Object(V.i)("cmp-clp")&&!Object(R.a)(e)&&function(e,t){var n=e.selectedCLPLabel,r=e.nonTenantLabelString,i=z(e);if(i&&Q(G.b,i,t),n||r){var a=J(e);Q(G.c,a,t),Object(K.c)(n)}}(b.clpViewState,d),(null==b?void 0:b.classificationViewState)&&function(e,t){var n=e.messageClassification;if(n){t.ExtendedProperty||(t.ExtendedProperty=[]),Object.keys(n).forEach((function(e){var r=Y.b[e];r&&t.ExtendedProperty.push(Object(g.a)({ExtendedFieldURI:Object(y.a)({PropertyId:r.id,DistinguishedPropertySetId:"Common",PropertyType:r.propertyType}),Value:n[e]}))}));var r=Y.b.IsClassified;t.ExtendedProperty.push(Object(g.a)({ExtendedFieldURI:Object(y.a)({PropertyId:r.id,DistinguishedPropertySetId:"Common",PropertyType:r.propertyType}),Value:"true"}))}}(b.classificationViewState,d),Object(a.a)()&&function(e,t){var n,r,i=null===(r=null===(n=null==e?void 0:e.from)||void 0===n?void 0:n.email)||void 0===r?void 0:r.EmailAddress;if(i&&!Object(Ve.a)(i)){var a=Object(g.a)({ExtendedFieldURI:Object(y.a)({PropertyName:Be,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:i});t.ExtendedProperty?t.ExtendedProperty.push(a):t.ExtendedProperty=[a]}}(e.fromViewState,d),(null===(n=e.mentionsPicker)||void 0===n?void 0:n.atMentionTuples)&&Object.keys(e.mentionsPicker.atMentionTuples).length>0?[4,Le.b.import()]:[3,5];case 4:return I=w.sent(),[3,6];case 5:I=null,w.label=6;case 6:if(null==(O=I)||O(e.mentionsPicker,t,d),!Object(Ae.a)(e.smimeViewState))return[3,11];w.label=7;case 7:return w.trys.push([7,9,,10]),j=function(e,t,n){var i,a=e.smimeViewState||Object(s.a)(),d=e.attachmentWell,l=d.docViewAttachments,m=d.inlineAttachments,f=Object(u.a)(a);return(i=l.slice(0)).push.apply(i,Object(r.j)([],Object(r.g)(m))),{smimeViewState:a,message:t,fromAddress:Object(o.a)(),isSend:n,composeId:e.composeId,toRecipients:f?Object(c.a)(e.toRecipientWell):[],ccRecipients:f?Object(c.a)(e.ccRecipientWell):[],attachments:i}}(e,d,t),[4,Ue.p.import().then((function(e){return e(j)}))];case 8:return w.sent(),[3,10];case 9:return S=w.sent(),(x=new Error).message=S.message==De.a?De.a:"SmimeEncodeError: "+S.message,[2,Promise.reject(x)];case 10:return[3,12];case 11:e.itemId&&(h=Object(je.b)().items.get(e.itemId.Id))&&Object(Fe.b)(h.ItemClass)&&(d.ItemClass=ot),w.label=12;case 12:return t&&function(e){var t=[];if(e.isReportedFalsePositive){var n={ExtendedFieldURI:{PropertyName:Ee,PropertyType:"String",DistinguishedPropertySetId:Se},Value:""};t.push(n)}if(e.isOverridden){n={ExtendedFieldURI:{PropertyName:he,PropertyType:"String",DistinguishedPropertySetId:Se},Value:e.overrideJustification};t.push(n)}return t}(e.policyTipsViewState).map((function(e){return function(e,t){null==e.ExtendedProperty?e.ExtendedProperty=[t]:e.ExtendedProperty.push(t)}(d,e)})),[4,lt(e,d,m,t)];case 13:l=w.sent(),w.label=14;case 14:return P(e.addin),(C=(null===(i=null==l?void 0:l.ResponseMessages)||void 0===i?void 0:i.Items)?l.ResponseMessages.Items[0]:l&&!l.ResponseMessages?l:null)&&"Success"==C.ResponseClass?[2,Promise.resolve(C)]:(Object(T.d)(l,e),x=void 0,C?(x=new Error(C.ResponseCode)).messageText=C.MessageText:x=new Error("Unrecognized response"),[2,Promise.reject(x)])}}))}))}function lt(e,t,n,i){var a,o,c,s,u,d,l;if(Object(R.a)(e)){if(i&&3!=e.operation){if(Object(Ne.a)()||e.itemId||t.RightsManagementLicenseData||(null===(a=e.protectionViewState)||void 0===a?void 0:a.IRMData))return function(e,t,n,r,i,a){var o=ue(e,t,0,r,i,a),c={headers:Object(ne.e)(null,"GroupMailbox")};return oe({Header:Object(ce.b)(),Body:o},c).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}(e.groupId,t,e.bodyType,n,Me(e.protectionViewState),e.isInlineCompose);var m=Object(U.n)(e.groupId);return c=e.groupId,s=t,e.bodyType,u=Object(it.a)(m),d=e.isInlineCompose,l=le(c,s,0,0,d),de({Header:Object(ce.b)(),Body:l},u).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}var f=1==e.operation||2==e.operation;if(!e.itemId&&f||e.useSmartResponse)return Object(te.a)(e.groupId,t,e.bodyType,!1,n,e.isInlineCompose)}var p,b=Object($.c)(),v=!(!b||b.treeType!==B.k&&b.treeType!==B.c);if(i){var O=Object(_.a)(null===(o=e.attachmentWell)||void 0===o?void 0:o.sharingLinkIds);O&&O.length>0&&(t.DocLinks=O)}return Object(V.i)("mon-cmp-experimentalGraphQLCompose")&&function(e){switch(e){case 0:case 1:case 2:case 3:case 4:return!0;case 5:case 6:return!1}}(e.operation)&&(p=e.itemId?function(e,t,n){return Object(r.c)(this,void 0,void 0,(function(){var i,a,o,c;return Object(r.f)(this,(function(s){switch(s.label){case 0:return[4,Object(We.a)()];case 1:return i=s.sent(),a=He(e,n),[4,i.mutate({variables:{draft:a,itemId:n.itemId},mutation:rt(t,n.useSmartResponse)})];case 2:return o=s.sent(),c=function(e,t,n){return t?n?e.sendSmartReply:e.sendDraft:n?e.saveSmartReply:e.saveDraft}(o.data,t,n.useSmartResponse),[2,{ResponseMessages:{Items:[{Items:c.draft?[Object(r.a)({},c.draft)]:null,ResponseClass:"Success"}]}}]}}))}))}(t,i,e):function(e,t,n){return Object(r.c)(this,void 0,void 0,(function(){var i,a,o;return Object(r.f)(this,(function(c){switch(c.label){case 0:return[4,Object(We.a)()];case 1:return i=c.sent(),a=He(e,n),[4,i.mutate({variables:{draft:a,isSend:t},mutation:_e})];case 2:return o=c.sent(),[2,{ResponseMessages:{Items:[{Items:[Object(r.a)({},o.data.createDraft.draft)],ResponseClass:"Success"}]}}]}}))}))}(t,i,e)),p||(p=e.useSmartResponse||!e.itemId?Object(ee.a)(t,e.bodyType,i,n,e.isInlineCompose,Me(e.protectionViewState),null,v):ye(t,i,Me(e.protectionViewState),e.addin.keysOfInternetHeadersToBeRemoved)),p}function mt(e){return dt(e,!0)}function ft(e){return dt(e,!1)}function pt(e,t){if(Object(Ie.a)(e)){var n=function(e){var t;if(null==e?void 0:e.Items)return e.Items[0];if(null===(t=e)||void 0===t?void 0:t.Item)return e.Item;return null}(e);return n&&(Object(Ae.a)(t.smimeViewState)||L.h.import().then((function(e){var r=e(t.attachmentWell,t.content,t.bodyType,!0);r.length&&Ue.r.import().then((function(e){return e(r,n.Attachments,Object(x.a)({Id:t.composeId}))}))})),n.ItemId&&(D(t,n.ItemId.Id,n.ItemId.ChangeKey,n.LastModifiedTime),n.Body&&Object(R.a)(t)&&(t.lastSavedMessageBody=n.Body.Value)),n.InternetMessageId&&Object(A.a)(t.conversationId,t.itemId?t.itemId.Id:null,n.InternetMessageId)),!0}return!1}function bt(e){return e.textDirection||(Object(v.a)().SessionSettings.IsUserCultureRightToLeft?"rtl":"ltr")}},6501:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1),i=n(5108),a=n(4870);function o(e,t){return function(e,t){for(var n=0;n<t.length;n++)if(c(t[n],e))return t[n];return null}((e||[]).concat(t||[]),Object(i.a)(!0))}function c(e,t){var n,i;if(t&&t.length>0)try{for(var o=Object(r.k)(t),c=o.next();!c.done;c=o.next()){var s=c.value;if(s&&Object(a.a)(e,s.EmailAddress))return!0}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return!1}},6502:function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return v}));var r=n(1),i=n(7132),a=n(6),o=n(2211),c=n(2805),s=n(6020),u=n(2904),d="",l="";function m(e,t){var n;if(e){e.WasclUpgradeToPremiumUrl&&(d=e.WasclUpgradeToPremiumUrl),e.AccountRecoveryFlowUrl&&(l=e.AccountRecoveryFlowUrl);var r=(null===(n=e.ResponseMessages)||void 0===n?void 0:n.Items)?e.ResponseMessages.Items[0]:null;!r||"ErrorExceededMessageLimit"!=r.ResponseCode&&"ErrorExceededHourlyMessageLimit"!=r.ResponseCode&&"ErrorExceededMessageLimitShowTierUpgrade"!=r.ResponseCode||Object(c.b)(t,!0)}}function f(e){return{text:Object(a.b)(i.a),action:function(){Object(o.a)(e,["errorMessageExceededMessageLimit","errorMessageExceededMaxRecipientLimit"]),window.open(d)}}}var p=null;function b(e,t){return{text:Object(a.b)(i.b),action:function(){var n;null===p&&(n=Object(r.g)(Object(u.a)(s.a,t),1),(p=n[0]).then((function(t){var n=t.success;p=null,n&&function(e){Object(o.a)(e,["errorMessageMessageSubmissionBlocked","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimitShowTierUpgrade"])}(e)}),(function(e){p=null})))}}}function v(e){return{text:Object(a.b)(i.b),action:function(){Object(o.a)(e,["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade"]),window.open(l)}}}},6503:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"ReplyAllToItem:#Exchange"},e)}},6504:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"ReplyToItem:#Exchange"},e)}},6797:function(e,t,n){"use strict";var r=n(1),i=n(4427);var a=n(981),o=n(979),c=n(33);function s(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.a)({__type:"CreateResponseFromModernGroupJsonRequest:#Exchange"},n)),Object(c.a)("CreateResponseFromModernGroup",e,t)}var u=n(180),d=n(2556);function l(e,t,n,c,s,u){var l,m=(l=Object(r.a)({ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:c?"SendAndSaveCopy":"SaveOnly",Items:[t],TimeFormat:s,ItemShape:Object(a.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(o.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(d.a)()),Object(r.a)({__type:"CreateResponseFromModernGroupRequest:#Exchange"},l));return c?u&&(m.ItemShape.ReturnOnlyInternetMessageId=!0):(m.ItemShape=Object(i.a)(n),m.ShapeName="MailCompose"),m.GroupSmtpAddress=e,m}function m(e,t,n,r,i,a){var o=l(e,t,n,r,i,a);return s({Header:Object(u.b)(),Body:o}).then((function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))}))}n.d(t,"a",(function(){return m}))},7132:function(e){e.exports=JSON.parse('{"a":"I7a","b":"J7a"}')},819:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"ExtendedPropertyType:#Exchange"},e)}},878:function(e,t,n){"use strict";var r=n(450),i=n(448),a=n(583),o=n(216);t.a=function(e,t,n){if(!Object(o.a)(n))return!1;var c=typeof t;return!!("number"==c?Object(i.a)(n)&&Object(a.a)(t,n.length):"string"==c&&t in n)&&Object(r.a)(n[t],e)}},879:function(e,t,n){"use strict";var r=n(537),i=n(659),a=Object(i.a)(Object.keys,Object),o=Object.prototype.hasOwnProperty;t.a=function(e){if(!Object(r.a)(e))return a(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},896:function(e,t,n){"use strict";var r=n(874),i=n(878);t.a=function(e){return Object(r.a)((function(t,n){var r=-1,a=n.length,o=a>1?n[a-1]:void 0,c=a>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(a--,o):void 0,c&&Object(i.a)(n[0],n[1],c)&&(o=a<3?void 0:o,a=1),t=Object(t);++r<a;){var s=n[r];s&&e(t,s,r,o)}return t}))}}}]);
//# sourceMappingURL=owa.MailBoot~Addins~Editor~MailComposeActions.js.map
self.scriptsLoaded['owa.MailBoot~Addins~Editor~MailComposeActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Addins~Editor~MailComposeActions.js'] = (new Date()).getTime();