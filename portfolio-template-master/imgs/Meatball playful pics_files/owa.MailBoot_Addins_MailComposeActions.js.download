self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Addins~MailComposeActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[221],{1303:function(t,n,e){"use strict";var r=e(448),u=e(303);n.a=function(t){return Object(u.a)(t)&&Object(r.a)(t)}},1969:function(t,n,e){"use strict";var r;e.d(n,"a",(function(){return r})),function(t){t[t.Base64InlineImage=0]="Base64InlineImage",t[t.Cloud=1]="Cloud",t[t.Local=2]="Local",t[t.MailItem=3]="MailItem",t[t.Uri=4]="Uri",t[t.AttachmentItem=5]="AttachmentItem",t[t.CloudSuggestion=6]="CloudSuggestion",t[t.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",t[t.Inline=8]="Inline",t[t.Smime=9]="Smime",t[t.FilesHub=10]="FilesHub",t[t.GroupFilesHub=11]="GroupFilesHub",t[t.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",t[t.Unknown=13]="Unknown",t[t.ContextualSuggestion=14]="ContextualSuggestion",t[t.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",t[t.SmartDoc=16]="SmartDoc",t[t.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1992:function(t,n,e){"use strict";var r=e(1963),u=e(2210),c=e(6);function o(t){var n;return t>=1073741824?(t/=1073741824,n=Object(c.b)(u.b)):t>=1048576?(t/=1048576,n=Object(c.b)(u.d)):t>=1024?(t/=1024,n=Object(c.b)(u.c)):n=Object(c.b)(u.a),Object(c.c)(n,Math.round(t))}var i,a=e(2061),s=e(24),f=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function l(t){if(!Object(s.i)("doc-attachment-documentThumbnail"))return!1;var n=Object(r.a)(t);return!!n&&f.indexOf(n.toLowerCase())>=0}function d(t){switch(t){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return i.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return i.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return i.PowerPoint;default:return null}}!function(t){t[t.Word=0]="Word",t[t.Excel=1]="Excel",t[t.PowerPoint=2]="PowerPoint"}(i||(i={}));var b=e(2019);e.d(n,"b",(function(){return r.a})),e.d(n,"c",(function(){return r.b})),e.d(n,"d",(function(){return r.c})),e.d(n,"i",(function(){return o})),e.d(n,"g",(function(){return a.a})),e.d(n,"h",(function(){return l})),e.d(n,"f",(function(){return d})),e.d(n,"e",(function(){return b.b})),e.d(n,"a",(function(){return i}))},2019:function(t,n,e){"use strict";function r(t){return n=t||"",(e=c.exec(n))&&e.length>1&&u[e[1].toLowerCase()];var n,e}e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return o}));var u={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},c=/^\s*([^;\s]*)(?:;|\s|$)/;function o(t){var n="";return Object.entries(u).forEach((function(e){e[1]===t&&(n=e[0])})),n}},2027:function(t,n,e){"use strict";var r=e(31),u=e(1947);function c(){return o(Object(u.J)())}function o(t){return t&&2==t.tableQuery.type?t.tableQuery.folderId:null}function i(){var t=Object(u.J)();return t&&2==t.tableQuery.type}function a(t){return!!t&&(2==t.type||s(t))}function s(t){return!(!t||1!=t.type)&&"Group"==t.searchScope.kind}function f(t){return 2==t.type?t.folderId:s(t)?t.searchScope.groupId:null}function l(){var t=Object(u.J)();return t&&a(t.tableQuery)}e.d(n,"g",(function(){return b})),e.d(n,"h",(function(){return p})),e.d(n,"m",(function(){return m})),e.d(n,"l",(function(){return O})),e.d(n,"j",(function(){return h})),e.d(n,"i",(function(){return v})),e.d(n,"k",(function(){return j})),e.d(n,"c",(function(){return c})),e.d(n,"a",(function(){return o})),e.d(n,"d",(function(){return i})),e.d(n,"e",(function(){return a})),e.d(n,"b",(function(){return f})),e.d(n,"f",(function(){return l}));var d=new r.c((function(){return Promise.all([e.e(0),e.e(1),e.e(2),e.e(3),e.e(19),e.e(22),e.e(65),e.e(116),e.e(754)]).then(e.bind(null,18440))})),b=new r.b(d,(function(t){return t.getGroupDisplayName})),p=new r.b(d,(function(t){return t.getGroupDisplayNameFromTableView})),m=new r.b(d,(function(t){return t.isPrivateUnjoinedGroup})),O=new r.b(d,(function(t){return t.isJoinedGroup})),h=new r.b(d,(function(t){return t.getRetentionPolicyTagsForGroup})),v=new r.b(d,(function(t){return t.getRetentionPolicyTagListForGroupTableQuery})),j=new r.b(d,(function(t){return t.isGroupOwner}))},2049:function(t,n,e){"use strict";e.d(n,"a",(function(){return c})),e.d(n,"b",(function(){return o}));var r=e(19),u=e(57);function c(t){return!!(t&Object(r.a)().ViewStateConfiguration.ListViewBitFlags)}function o(t,n){c(n)!==t&&Object(u.z)((function(e){t?e.ViewStateConfiguration.ListViewBitFlags|=n:e.ViewStateConfiguration.ListViewBitFlags&=~n}))}},2061:function(t,n,e){"use strict";e.d(n,"a",(function(){return a})),e.d(n,"b",(function(){return s}));var r=e(1963),u=e(2019),c=e(102),o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],i=[".tiff",".tif"];function a(t,n,e){return void 0===e&&(e=!0),s(Object(r.a)(t)||Object(u.a)(n),e)}function s(t,n){return void 0===n&&(n=!0),!!t&&(o.indexOf(t.toLowerCase())>=0||n&&i.indexOf(t.toLowerCase())>=0&&(Object(c.e)()||Object(c.d)()||Object(c.h)()||Object(c.g)()&&!Object(c.l)()))}},2065:function(t,n,e){"use strict";var r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function u(t){var n=null,e=r.exec(t);if(e){var u=e[1],c=e[2],o=null;try{o=atob(c)}catch(t){}if(o){for(var i=new ArrayBuffer(o.length),a=new Uint8Array(i),s=0;s<o.length;s++)a[s]=o.charCodeAt(s);n=new File([i],"image.png",{type:u})}}return n}var c=e(1969),o=e(1992);function i(t){return t.map((function(t){return{fileType:c.a.Uri,name:t.name,type:Object(o.b)(t.url)||"",size:0,uri:t.url}}))}var a=e(23);function s(t,n,e){if(t.length!=n.length)return a.d("The sizes of subjects and latestItemIds are different"),null;for(var r=[],u=0;u<t.length;u++){var o={fileType:c.a.MailItem,name:t[u],size:(null==e?void 0:e[u])||0,itemId:n[u]};r.push(o)}return r}function f(t,n,e){var r=[],u={fileType:c.a.MailItem,name:t,size:e||0,mimeContent:n};return r.push(u),r}function l(t){if(!t)return null;for(var n=[],e=0;e<t.length;e++){var r=t[e],u={fileType:c.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};n.push(u)}return n}function d(t){if(!t)return null;for(var n=[],e=0;e<t.length;e++){var r=t[e],u={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};n.push(u)}return n}function b(t){var n,e;return null===t?null:{fileType:c.a.Cloud,name:t.Name,size:t.Size,providerId:t.AttachmentProviderId,providerType:t.ProviderType,location:t.Location,providerEndpointUrl:t.ProviderEndpointUrl,isFolder:1===t.Type,fileId:t.Id,fileParentId:t.ParentId,thumbnailUrl:(null===(n=t.Thumbnail)||void 0===n?void 0:n.Url)||"",previewUrl:(null===(e=t.Preview)||void 0===e?void 0:e.Url)||"",type:t.MimeType}}function p(t){return null===t?null:{attachmentItemId:t.Id,name:t.Name,size:t.Size,fileType:c.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var m={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function O(t){switch(t?t.toLowerCase():null){case m.ONE_DRIVE_PRO.toLowerCase():return 0;case m.GDRIVE.toLowerCase():return 5;case m.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case m.DROPBOX.toLowerCase():return 2;case m.BOX.toLowerCase():return 3;case m.WOPI_BOX.toLowerCase():return 7;case m.WOPI_EGNYTE.toLowerCase():return 8;case m.MAILBOX.toLowerCase():return 4;case m.FACEBOOK.toLowerCase():return 6;default:return null}}e.d(n,"f",(function(){return u})),e.d(n,"j",(function(){return i})),e.d(n,"i",(function(){return s})),e.d(n,"h",(function(){return f})),e.d(n,"g",(function(){return l})),e.d(n,"d",(function(){return d})),e.d(n,"e",(function(){return b})),e.d(n,"c",(function(){return p})),e.d(n,"b",(function(){return O})),e.d(n,"a",(function(){return c.a}))},2210:function(t){t.exports=JSON.parse('{"b":"Nea","d":"Oea","c":"Pea","a":"Qea"}')},2224:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(2030);function u(t,n){return{headers:Object(r.e)(t,"GroupMailbox",!1,n)}}},2306:function(t,n,e){"use strict";var r=e(31),u=e(1262),c=e(2390);function o(){return 0==Object.keys(c.a.inlineImages).length}e.d(n,"d",(function(){return a})),e.d(n,"k",(function(){return s})),e.d(n,"c",(function(){return f})),e.d(n,"j",(function(){return l})),e.d(n,"i",(function(){return d})),e.d(n,"f",(function(){return b})),e.d(n,"e",(function(){return p})),e.d(n,"h",(function(){return m})),e.d(n,"g",(function(){return O})),e.d(n,"a",(function(){return u.a})),e.d(n,"b",(function(){return o}));var i=new r.c((function(){return Promise.all([e.e(4),e.e(24),e.e(685)]).then(e.bind(null,18216))})),a=new r.a(i,(function(t){return t.clearInlineImageStore})),s=new r.b(i,(function(t){return t.tryCreateDataURIFromImage})),f=new r.b(i,(function(t){return t.cacheInlineImage})),l=new r.b(i,(function(t){return t.logImageUpload})),d=new r.b(i,(function(t){return t.logImageLoadError})),b=new r.b(i,(function(t){return t.loadFromAttachmentServiceUrl})),p=new r.b(i,(function(t){return t.loadFromAttachment})),m=new r.b(i,(function(t){return t.loadFromProxy})),O=new r.b(i,(function(t){return t.loadFromImageTag}))},2390:function(t,n,e){"use strict";var r=e(2),u=Object(r.createStore)("inlineimages",{inlineImages:{}})();n.a=u},293:function(t,n,e){"use strict";var r,u=e(576),c=e(184).a["__core-js_shared__"],o=(r=/[^.]+$/.exec(c&&c.keys&&c.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var i=function(t){return!!o&&o in t},a=e(216),s=e(423),f=/^\[object .+?Constructor\]$/,l=Function.prototype,d=Object.prototype,b=l.toString,p=d.hasOwnProperty,m=RegExp("^"+b.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var O=function(t){return!(!Object(a.a)(t)||i(t))&&(Object(u.a)(t)?m:f).test(Object(s.a)(t))};var h=function(t,n){return null==t?void 0:t[n]};n.a=function(t,n){var e=h(t,n);return O(e)?e:void 0}},3274:function(t,n,e){"use strict";e.d(n,"a",(function(){return a}));var r=e(1),u=e(2306),c=e(1996),o="cid:",i="MoveFromAttachmentWell";function a(t,n,e){var a=function(e){null==t||t.queryElements('img[src^="'+o+'"]',(function(t){var u=t.src.substr(o.length),a=function(t,n){var e,u;if(t.inlineAttachments)try{for(var o=Object(r.k)(t.inlineAttachments),i=o.next();!i.done;i=o.next()){var a=i.value,s=Object(c.a)(a.attachmentId);if((null==s?void 0:s.thumbnailImage)&&s.model&&(s.model.ContentId==n||s.model.Name==n))return{url:s.thumbnailImage.url,contentId:s.model.ContentId}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(u=o.return)&&u.call(o)}finally{if(e)throw e.error}}return null}(n,u);a&&(t.setAttribute("originalsrc",o+a.contentId),e(t,a.url,i))}))};e?a(e):u.f.import().then(a)}},3409:function(t,n,e){"use strict";e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return u})),e.d(n,"d",(function(){return c})),e.d(n,"f",(function(){return o})),e.d(n,"i",(function(){return i})),e.d(n,"g",(function(){return a})),e.d(n,"h",(function(){return s})),e.d(n,"c",(function(){return f})),e.d(n,"e",(function(){return l}));var r="cid:",u="Upload",c="InsertInlineImageFinished",o="InsertInlineImagePlaceholder",i="data-loadPending",a="pastedImage",s=".png",f="Attachment",l={position:3,updateCursor:!0,replaceSelection:!0,insertOnNewLine:!1}},374:function(t,n,e){"use strict";var r,u=e(2);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var c,o=e(44),i=Object(u.action)("addAccount",(function(t){return{userIdentity:t.userIdentity,account:t}})),a=Object(u.action)("removeAccount",(function(t){return{userIdentity:t}})),s=Object(u.action)("updateAccount",(function(t,n,e){return{userIdentity:t,accountToken:n,accountTokenExpiresIn:e}})),f=Object(u.action)("updateOWAConnectedAccountStatus",(function(t,n){return{userIdentity:t,accountState:n}})),l=Object(u.action)("accountIsInErrorState",(function(t,n){return Object(o.c)({name:"accountIsInErrorState",customData:{accountState_1:r[t],accountProvider_2:n}},{accountState:t})})),d=Object(u.action)("retryAccountUpdateToken",(function(t,n,e){return{accountId:t,userIdentity:n,currentToken:e}})),b=Object(u.action)("connectedAccountsListRequested",(function(t){return{isSuccess:t}})),p=Object(u.action)("setAccountsStoreState",(function(t){return{state:t}})),m=e(1),O=e(14);!function(t){t[t.None=0]="None",t[t.Loading=1]="Loading",t[t.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",t[t.AccountsLoadError=3]="AccountsLoadError"}(c||(c={}));var h=Object(u.createStore)("OWAAccountsStore",{accountsMap:new O.ObservableMap({}),accountsLoadedState:c.None}),v=e(94),j=e(57);function g(t){return t!=Object(j.b)()&&void 0!==y(t)}function I(){return Object(m.j)([],Object(m.g)(h().accountsMap.values()))}function y(t){return h().accountsMap.get(t)}function w(){var t;return(null===(t=I())||void 0===t?void 0:t.length)>0?I()[0]:null}function T(){return I().filter((function(t){return t.accountState!=r.Valid}))}function S(t){return I().filter((function(n){return t.includes(n.accountState)}))}function x(t){return I().filter((function(n){return n.accountProviderType==t}))}function A(t){return g(t)?y(t).accountProviderType:null}function k(t){return"Outlook"==t.accountProviderType?'MSAuth1.0 usertoken="'+t.token+'", type="MSACT"':"Google"==t.accountProviderType||"ICloud"==t.accountProviderType?"Bearer "+t.token:Object(v.a)(t.accountProviderType)}function C(t,n){return function(e){var r=y(e);return r?r[t]:n}}C("accountUniqueId","0");var E=C("accountState",r.Valid),P=function(){return I().some((function(t){return!R(t.userIdentity)}))},L=C("accountProviderType",null),F=function(t){return"Outlook"==L(t)},R=function(t){return E(t)==r.Valid},M=function(){return I().length>0};function U(){return h().accountsLoadedState}var _=e(5),D=e(121);Object(u.mutator)(i,(function(t){var n=t.account;Object(D.s)("owaAccountAdded",{accountStatus_1:r[n.accountState]}),h().accountsMap.set(n.userIdentity,n)})),Object(u.mutator)(a,(function(t){var n=t.userIdentity;h().accountsMap.delete(n)})),Object(u.mutator)(s,(function(t){var n=t.userIdentity,e=t.accountToken,r=t.accountTokenExpiresIn,u=h().accountsMap.get(n);u.token=e,u.tokenExpiry=Object(_.j)(Object(_.Rb)(),parseInt(r))})),Object(u.mutator)(f,(function(t){var n=t.userIdentity,e=t.accountState,u=h().accountsMap.get(n);u.accountState==r.Valid&&e!=r.Valid&&Object(D.s)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[e]}),u.accountState=e})),Object(u.mutator)(b,(function(t){var n=t.isSuccess?c.AccountsLoadSuccessful:c.AccountsLoadError;h().accountsLoadedState=n})),Object(u.mutator)(p,(function(t){h().accountsLoadedState=t.state})),e.d(n,"d",(function(){return i})),e.d(n,"u",(function(){return a})),e.d(n,"y",(function(){return s})),e.d(n,"x",(function(){return f})),e.d(n,"c",(function(){return l})),e.d(n,"v",(function(){return d})),e.d(n,"e",(function(){return b})),e.d(n,"w",(function(){return p})),e.d(n,"n",(function(){return I})),e.d(n,"k",(function(){return y})),e.d(n,"i",(function(){return w})),e.d(n,"f",(function(){return T})),e.d(n,"g",(function(){return S})),e.d(n,"o",(function(){return x})),e.d(n,"j",(function(){return A})),e.d(n,"m",(function(){return k})),e.d(n,"l",(function(){return E})),e.d(n,"q",(function(){return P})),e.d(n,"t",(function(){return F})),e.d(n,"s",(function(){return R})),e.d(n,"p",(function(){return M})),e.d(n,"h",(function(){return U})),e.d(n,"r",(function(){return g})),e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return c}))},3853:function(t,n,e){"use strict";e.d(n,"d",(function(){return o})),e.d(n,"e",(function(){return i})),e.d(n,"b",(function(){return a})),e.d(n,"c",(function(){return s}));var r=e(31),u=e(3274);e.d(n,"a",(function(){return u.a}));var c=new r.c((function(){return Promise.all([e.e(0),e.e(1),e.e(2),e.e(3),e.e(24),e.e(25),e.e(683)]).then(e.bind(null,6332))})),o=new r.b(c,(function(t){return t.processInlineImageBeforeUpload})),i=new r.b(c,(function(t){return t.setOriginalSrcForSmime})),a=new r.b(c,(function(t){return t.getExpirableImageBase64Src})),s=new r.b(c,(function(t){return t.onImageError}))},4029:function(t,n,e){"use strict";var r=e(1),u=e(183),c=Object(u.action)("setNumberOfWaitingAttachments")((function(t,n){n<0||(t.numberOfWaitingAttachments=n)})),o=e(2805),i=e(121),a=e(2065),s=e(209),f=e(4356),l=e(4428),d=e(2603),b=e(3270),p=e(23),m=e(3853),O=e(3409),h=e(2128),v=e(2306),j=e(24);e.d(n,"a",(function(){return T}));var g="ExpirableImageLoadingFail",I=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function y(t,n,e,u,c,o,f){var l=this,j=function(t){for(var n=[],e=[],r=0;r<t.length;r++)t[r].fileType===a.a.ExpirableBase64InlineImage?n.push(t[r]):e.push(t[r]);return{nonExpirableFiles:e,expirableFiles:n}}(t),y=j.nonExpirableFiles,T=j.expirableFiles;Object(b.a)(n.smimeViewState)?d.c.import().then((function(t){return Object(r.c)(l,void 0,void 0,(function(){var u,c;return Object(r.f)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t(y,Object(r.a)(Object(r.a)({},n.itemId),{mailboxInfo:Object(s.d)()}),n.attachmentWell,e,n)];case 1:return u=o.sent(),w(e,u,n),[3,3];case 2:return c=o.sent(),Object(i.s)("CreateSmimeAttachmentsFromFilesErrorDatapoint",{errorMessage:c.message},{isCore:!0}),p.g.warn(c),[3,3];case 3:return[2]}}))}))})):(T.length>0&&Promise.all([m.b.import(),h.f.import(),m.d.import(),m.c.import()]).then((function(t){var i=Object(r.g)(t,4),a=i[0],l=i[1],d=i[2],b=i[3];T.forEach((function(t){a(t.imageSrc).then((function(i){var a=i.match(I);t.type=a[1],t.dataUri=a[2],l(n.attachmentWell,Object(r.a)(Object(r.a)({},n.itemId),{mailboxInfo:e.mailboxInfo?e.mailboxInfo:Object(s.d)()}),[t],n,e,u,c,o,f)})).catch((function(){v.i.import().then((function(t){t(O.c,"",g,"",O.b)})),b(n.inlineImage,n,t.tempId)})),d(n.inlineImage,n,t.tempId,t)}))})),y.length>0&&h.f.import().then((function(t){var i=t(n.attachmentWell,Object(r.a)(Object(r.a)({},n.itemId),{mailboxInfo:e.mailboxInfo?e.mailboxInfo:Object(s.d)()}),y,n,e,u,c,o,f);w(e,i,n)})))}function w(t,n,e){if(t.isInline&&!Object(j.i)("cmp-inlineImageV2")){var r=n.length,u=e.attachmentWell.inlineAttachments.length;m.d.import().then((function(t){for(var c=0;c<r;c++){var o=e.attachmentWell.inlineAttachments[u-r+c];t(e.inlineImage,e,o.placeholderId,n[c])}}))}}function T(t,n,e,u,i,a,s){return Object(r.c)(this,void 0,void 0,(function(){var d,p,m;return Object(r.f)(this,(function(r){switch(r.label){case 0:d=!1,p=Object(b.a)(n.smimeViewState),n.itemId||p||(d=!0,c(n,n.numberOfWaitingAttachments+1)),r.label=1;case 1:return r.trys.push([1,,6,7]),(m=!n.itemId&&!p)?[4,Object(o.f)(n)]:[3,3];case 2:m=!r.sent(),r.label=3;case 3:return m?[4,Object(o.b)(n)]:[3,5];case 4:r.sent(),r.label=5;case 5:return y(t,n,e,(function(t){u&&u(t),Object(l.a)()&&Object(f.a)(n,8)}),i,a,s),[3,7];case 6:return d&&c(n,n.numberOfWaitingAttachments-1),[7];case 7:return[2]}}))}))}},419:function(t,n,e){"use strict";var r=e(1);function u(t,n){return t?Object(r.a)({mailboxInfo:t},n):null!=n?n:void 0}e.d(n,"a",(function(){return u}))},423:function(t,n,e){"use strict";var r=Function.prototype.toString;n.a=function(t){if(null!=t){try{return r.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},448:function(t,n,e){"use strict";var r=e(576),u=e(580);n.a=function(t){return null!=t&&Object(u.a)(t.length)&&!Object(r.a)(t)}},518:function(t,n,e){"use strict";var r=function(){function t(t,n,e){this.maxParallelTasks=t,this.taskCallback=n,this.taskDelay=e,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var n=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(n).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();e.d(n,"a",(function(){return r}))},534:function(t,n,e){"use strict";var r=e(293),u=function(){try{var t=Object(r.a)(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();n.a=u},576:function(t,n,e){"use strict";var r=e(311),u=e(216),c="[object AsyncFunction]",o="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";n.a=function(t){if(!Object(u.a)(t))return!1;var n=Object(r.a)(t);return n==o||n==i||n==c||n==a}},577:function(t,n,e){"use strict";n.a=function(t){return t}},580:function(t,n,e){"use strict";var r=9007199254740991;n.a=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}},6608:function(t,n,e){"use strict";var r=e(183);n.a=Object(r.action)("switchToReadWriteRecipient")((function(t){t.showCompactRecipientWell=!1}))},708:function(t,n){t.exports=function(t){if(!t.webpackPolyfill){var n=Object.create(t);n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),Object.defineProperty(n,"exports",{enumerable:!0}),n.webpackPolyfill=1}return n}},730:function(t,n,e){"use strict";var r=e(2),u=Object(r.action)("initializeOwaObservableDateTime"),c=Object(r.action)("observableNowChanged"),o=Object(r.action)("observableTodayChanged"),i=e(5),a=e(14),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),f=Object(a.computed)((function(){return Object(i.nc)(s().now)})),l=function(){return f.get()},d=Object(a.computed)((function(){return Object(i.nc)(s().today)})),b=function(){return d.get()},p=function(t){return Object(i.Hb)(t,l())},m=function(t){return Object(i.Fb)(t,l())},O=function(t){return v(t,i.Hb)},h=function(t){return v(t,i.Ib)},v=function(t,n){return n(Object(i.Yb)(Object(i.nc)(t)),b())};function j(t){if(!t)return"";var n=Object(i.nc)(t);return function(t,n){var e=Object(i.Yb)(t);if(Object(i.Jb)(e,n))return i.ab;var r=function(t){return Object(i.Ob)(e,Object(i.e)(n,-t),n)};if(r(3))return i.ib;if(r(30))return i.hb;return i.Y}(n,b())(n)}function g(t){if(!t)return"";var n=Object(i.nc)(t);return function(t,n){var e=Object(i.Yb)(t);if(Object(i.Jb)(e,n))return i.T;return i.U}(n,b())(n)}function I(t){return t?function(t,n){var e=Object(i.Yb)(t);return Object(i.Jb)(e,n)?Object(i.ab)(t):y(e,n,2)?Object(i.lb)(t):y(e,n,7)?Object(i.H)(Object(i.bb)(t),Object(i.ab)(t)):Object(i.H)(Object(i.J)(t),Object(i.ab)(t))}(Object(i.nc)(t),b()):""}function y(t,n,e){return Object(i.Ob)(t,Object(i.e)(n,-e),n)}var w=Object(r.action)("updateTimes"),T=Object(r.action)("setNow"),S=Object(r.action)("setToday",(function(t){return{today:t}}));Object(r.mutator)(T,(function(){s().now=Object(i.lc)()})),Object(r.mutator)(S,(function(t){var n=t.today;s().today=n}));var x=e(21),A=e(79),k=!1;Object(r.orchestrator)(u,(function(){if(w(),!k){var t=Object(i.Rb)(),n=Object(i.ac)(Object(i.h)(t,1)),e=Object(i.w)(n,t);setTimeout((function(){return setInterval(w,x.g)}),e),document&&document.addEventListener("visibilitychange",w),k=!0}})),Object(r.orchestrator)(A.l,(function(){w()})),Object(r.orchestrator)(w,(function(){T();var t=Object(i.Ab)(Object(i.mc)()),n=s().today!=t;n&&S(t),c(),n&&o()})),e.d(n,"d",(function(){return u})),e.d(n,"j",(function(){return c})),e.d(n,"l",(function(){return o})),e.d(n,"i",(function(){return l})),e.d(n,"k",(function(){return b})),e.d(n,"g",(function(){return p})),e.d(n,"e",(function(){return m})),e.d(n,"f",(function(){return O})),e.d(n,"h",(function(){return h})),e.d(n,"a",(function(){return j})),e.d(n,"b",(function(){return g})),e.d(n,"c",(function(){return I}))},823:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(56),u=e(0),c=function(t){function n(n){var e=t.call(this,n)||this;return e.state={isRendered:!1},e}return Object(r.b)(n,t),n.prototype.componentDidMount=function(){var t=this,n=this.props.delay;this._timeoutId=window.setTimeout((function(){t.setState({isRendered:!0})}),n)},n.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},n.prototype.render=function(){return this.state.isRendered?u.Children.only(this.props.children):null},n.defaultProps={delay:0},n}(u.Component)},874:function(t,n,e){"use strict";var r=e(577),u=e(881),c=e(880);n.a=function(t,n){return Object(c.a)(Object(u.a)(t,n,r.a),t+"")}},880:function(t,n,e){"use strict";var r=function(t){return function(){return t}},u=e(534),c=e(577),o=u.a?function(t,n){return Object(u.a)(t,"toString",{configurable:!0,enumerable:!1,value:r(n),writable:!0})}:c.a,i=800,a=16,s=Date.now;var f=function(t){var n=0,e=0;return function(){var r=s(),u=a-(r-e);if(e=r,u>0){if(++n>=i)return arguments[0]}else n=0;return t.apply(void 0,arguments)}}(o);n.a=f},881:function(t,n,e){"use strict";var r=function(t,n,e){switch(e.length){case 0:return t.call(n);case 1:return t.call(n,e[0]);case 2:return t.call(n,e[0],e[1]);case 3:return t.call(n,e[0],e[1],e[2])}return t.apply(n,e)},u=Math.max;n.a=function(t,n,e){return n=u(void 0===n?t.length-1:n,0),function(){for(var c=arguments,o=-1,i=u(c.length-n,0),a=Array(i);++o<i;)a[o]=c[n+o];o=-1;for(var s=Array(n+1);++o<n;)s[o]=c[o];return s[n]=e(a),r(t,this,s)}}},887:function(t,n,e){"use strict";n.a=function(t,n){for(var e=-1,r=Array(t);++e<t;)r[e]=n(e);return r}},910:function(t,n,e){"use strict";e.d(n,"a",(function(){return u})),e.d(n,"b",(function(){return c}));var r=e(9),u=new r.a(new r.b((function(){return Promise.all([e.e(38),e.e(45),e.e(49),e.e(1021)]).then(e.bind(null,1564))})),(function(t){return t.stashSessionDataResponses})),c=new r.a(new r.b((function(){return Promise.all([e.e(38),e.e(45),e.e(49),e.e(830)]).then(e.bind(null,1563))})),(function(t){return t.tryGetConversationRowsFromResponse}))},984:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(1);function u(t){return Object(r.a)({__type:"TargetFolderId:#Exchange"},t)}}}]);
//# sourceMappingURL=owa.MailBoot~Addins~MailComposeActions.js.map
self.scriptsLoaded['owa.MailBoot~Addins~MailComposeActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Addins~MailComposeActions.js'] = (new Date()).getTime();