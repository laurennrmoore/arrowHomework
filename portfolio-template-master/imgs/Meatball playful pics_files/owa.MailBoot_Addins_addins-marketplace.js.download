self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Addins~addins-marketplace.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[222],{10309:function(e,t,n){"use strict";n(4008);var r=n(4322),a=n(4930),o=n(1);function i(e){return Object(o.a)({__type:"InstallExtensionJsonRequest:#Exchange"},e)}var s=n(33);function c(e,t){return void 0===e||e.__type||(e=i(e)),Object(s.a)("InstallExtension",e,t)}var l=n(4),u=n(180);function d(e){e.registerMethod("InstallOutlookWebExt",(function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:e[1],MarketplaceContentMarket:e[0],Client:"WAC_Outlook",ClientVersion:Object(l.r)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:null},n=i({Header:Object(u.b)(a.f()),Body:t});return Object(r.b)().then((function(e){return c(n,e)}))})(e).then((function(n){if("Error"==n.Body.ResponseClass.toString())t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1);else{var r=n.Body.Extension?n.Body.Extension.MarketplaceAssetID:e[1],o=!!n.Body.WasFirstInstall;t([r,o],0),a.g()}}))}),Microsoft.Office.Common.InvokeType.async,!1)}var f=n(19),p=n(197),m=n(2063);function g(e){return Object(o.a)({__type:"DisableExtensionJsonRequest:#Exchange"},e)}function h(e){e.registerMethod("DisableOutlookWebExt",(function(e,t){(function(e){var t={__type:"DisableAppRequest:#Exchange",ID:e.toString(),DisableReason:"NoReason"},n=g({Header:Object(u.b)(a.f()),Body:t});return Object(r.b)().then((function(e){return r=e,void 0===(t=n)||t.__type||(t=g(t)),Object(s.a)("DisableExtension",t,r);var t,r}))})(e).then((function(n){"Error"==n.Body.ResponseClass.toString()?t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1):t([e.toString()],0),a.g()}))}),Microsoft.Office.Common.InvokeType.async,!1)}function v(e){return Object(o.a)({__type:"UninstallExtensionJsonRequest:#Exchange"},e)}function y(e){e.registerMethod("UninstallOutlookWebExt",(function(e,t){(function(e){var t={__type:"UninstallAppRequest:#Exchange",ID:e.toString()},n=v({Header:Object(u.b)(a.f()),Body:t});return Object(r.b)().then((function(e){return r=e,void 0===(t=n)||t.__type||(t=v(t)),Object(s.a)("UninstallExtension",t,r);var t,r}))})(e).then((function(n){"Error"==n.Body.ResponseClass.toString()?t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1):(t([e.toString()],0),a.g())}))}),Microsoft.Office.Common.InvokeType.async,!1)}function b(e){e.registerMethod("InstallOutlookWebExtByManifest",(function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(l.r)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:e[0],Id:null};t.Manifest=a.b(t.Manifest);var n=i({Header:Object(u.b)(a.f()),Body:t});return Object(r.b)().then((function(e){return c(n,e)}))})(e).then((function(e){"Error"==e.Body.ResponseClass.toString()?t([e.Body.MessageText.toString(),e.Body.ResponseCode.toString()],-1):(t([!!e.Body.WasFirstInstall,e.Body.Extension?e.Body.Extension.Id:null,e.Body.Extension?e.Body.Extension.Enabled.toString():"false",e.Body.Extension?e.Body.Extension.ConsentState.toString():null,e.Body.Extension?e.Body.Extension.TypeString.toString():null,e.Body.Extension?e.Body.Extension.LicenseStatus.toString():null,e.Body.Extension?e.Body.Extension.TrialExpirationDate:null,e.Body.Extension?e.Body.Extension.Description:null,e.Body.Extension?e.Body.Extension.ProviderName:null,e.Body.Extension?e.Body.Extension.IconUrl:null,e.Body.Extension?e.Body.Extension.HighResolutionIconUrl:null,e.Body.Extension?e.Body.Extension.DisplayName:null,e.Body.Extension?e.Body.Extension.Requirements.toString():null,e.Body.Extension?e.Body.Extension.Version:null],0),a.g())}))}),Microsoft.Office.Common.InvokeType.async,!1)}function C(e){e.registerMethod("InstallOutlookWebExtByManifestUrl",(function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(l.r)(),SendWelcomeEmail:!0,ManifestUrl:e[0],Manifest:null,Id:null},n=i({Header:Object(u.b)(a.f()),Body:t});return Object(r.b)().then((function(e){return c(n,e)}))})(e).then((function(e){"Error"==e.Body.ResponseClass.toString()?t([e.Body.MessageText.toString(),e.Body.ResponseCode.toString()],-1):(t([!!e.Body.WasFirstInstall,e.Body.Extension?e.Body.Extension.Id:null,!!e.Body.Extension&&e.Body.Extension.Enabled.toString(),e.Body.Extension?e.Body.Extension.ConsentState.toString():null,e.Body.Extension?e.Body.Extension.TypeString.toString():null,e.Body.Extension?e.Body.Extension.LicenseStatus.toString():null,e.Body.Extension?e.Body.Extension.TrialExpirationDate:null,e.Body.Extension?e.Body.Extension.Description:null,e.Body.Extension?e.Body.Extension.ProviderName:null,e.Body.Extension?e.Body.Extension.IconUrl:null,e.Body.Extension?e.Body.Extension.HighResolutionIconUrl:null,e.Body.Extension?e.Body.Extension.DisplayName:null,e.Body.Extension?e.Body.Extension.Requirements.toString():null,e.Body.Extension?e.Body.Extension.Version:null],0),a.g())}))}),Microsoft.Office.Common.InvokeType.async,!1)}function A(e){e.registerMethod("InstallOutlookWebExtByProductId",(function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(l.r)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:null,Id:e},n=i({Header:Object(u.b)(a.f()),Body:t});return Object(r.b)().then((function(e){return c(n,e)}))})(e).then((function(n){if("Error"==n.Body.ResponseClass.toString())t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1);else{t([e,!1],0)}a.g()}))}),Microsoft.Office.Common.InvokeType.async,!1)}function S(e){return Object(o.a)({__type:"EnableAppDataRequest:#Exchange"},e)}var _=n(8297);function O(e){e.registerMethod("EnableApp",(function(e,t){(function(e){var t={DisplayName:e[0],RawIdentity:e[1]},n=S({Header:Object(u.b)(a.f()),Identity:t});return Object(r.b)().then((function(e){return r=e,void 0===(t=n)||t.__type||(t=S(t)),Object(s.a)("EnableApp",t,r);var t,r}))})(e).then((function(e){t([e.WasSuccessful],0),Object(_.b)().then((function(e){Object(m.Y)(e),Object(m.Z)(!0)}))})).catch((function(e){e.ErrorMessage?t([e.ErrorMessage],-1):t([],-1)}))}),Microsoft.Office.Common.InvokeType.async,!1)}var I=n(1080);function x(e,t){!function(e){e.registerMethod("GetTelemetryInfoFromOutlook",(function(e,t){var n=Object(m.r)(),r=Object(f.a)(),o=!r.SessionSettings.IsSPOnPrem,i=Object(p.a)(),s=o?i?"Consumer":"Business":"OnPremise";t([Object(l.H)(),r.SessionSettings.UserCulture,"16.2130.0.9999",a.c(),s,o,i,n.MarketplaceUrl,r.SessionSettings.ExternalDirectoryUserGuid,r.SessionSettings.OrganizationDomain,a.e(),"other","OWA_REACT",n.GenericInfo],0)}),Microsoft.Office.Common.InvokeType.async,!1)}(e),function(e){e.registerMethod("GetAllInstalledAddIns",(function(e,t){var n=Object(m.r)(),a=[];n.Extensions.forEach((function(e){"Private"!==e.TypeString&&"Default"!==e.TypeString&&a.push([e.Id,e.MarketplaceAssetID,e.Enabled.toString(),Object(r.e)(e.ConsentState),e.TypeString,e.LicenseStatus.toString(),e.TrialExpirationDate,e.IsMandatory.toString(),e.OriginString])})),t(a,0)}),Microsoft.Office.Common.InvokeType.async,!1)}(e),function(e){e.registerMethod("GetAllPrivateAddIns",(function(e,t){var n=Object(m.r)().Extensions,a=[];n.forEach((function(e){"Private"!==e.TypeString&&"Default"!==e.TypeString||a.push([e.Id,e.Enabled.toString(),Object(r.e)(e.ConsentState),e.TypeString.toString(),e.LicenseStatus.toString(),e.TrialExpirationDate,e.Description,e.ProviderName,e.IconUrl,e.HighResolutionIconUrl,e.DisplayName,e.RequestedCapabilities.toString(),e.Version,e.OriginString,e.IsMandatory.toString()])})),t(a,0)}),Microsoft.Office.Common.InvokeType.async,!1)}(e),d(e),h(e),y(e),b(e),C(e),A(e),O(e),function(e){e.registerMethod("LaunchUrl",(function(e){var t=e;return window.open(t),null}),Microsoft.Office.Common.InvokeType.sync,!1)}(e),function(e){e.registerMethod("UpdateAddinPinOptions",(function(e){var t={readMode:e[2],composeMode:e[3],calendarMode:e[4]};I.k.importAndExecute(e[0],e[1],t)}),Microsoft.Office.Common.InvokeType.async,!1)}(e),e.registerConversation(r.d(),t,null,null)}t.a=function(){var e=r.c();return Object(_.a)().then((function(){var t=r.a();return x(e,t),t}))}},10333:function(e,t,n){"use strict";var r=n(0),a=n(20),o=n(15568),i=n(6),s=n(158),c=n.n(s),l=n(6674),u=n(15569),d=n(424),f=n(15570),p=Object(a.a)((function(e){var t=function(e){switch(e){case 1:return{title:Object(i.b)(u.d),description:Object(i.b)(u.e)};case 2:return{title:Object(i.b)(l.d),description:Object(i.b)(l.e)};case 3:return{title:Object(i.b)(u.a),description:Object(i.b)(u.b)};case 4:return{title:Object(i.b)(u.a),description:Object(i.b)(u.c)};default:return{title:null,description:null}}}(e.errorType);return r.createElement("div",{className:f.errorContainer},r.createElement("div",{className:f.errorContent},r.createElement(d.a,{className:f.errorIcon,iconName:"OfficeAddinsLogo"}),r.createElement("span",{className:c()([f.errorTextCommon,f.errorTextTitle])},t.title),r.createElement("span",{className:c()([f.errorTextCommon,f.errorTextDescription])},t.description)))}));var m=n(15572),g=n(1),h=n(481),v=n(54),y=n(421),b=n(9857),C=Object(a.a)((function(e){var t=Object(g.g)(r.useState(!1),2),n=t[0],a=t[1];return n?r.createElement(d.a,{iconName:"Photo2",iconType:h.a.default,className:c()([b.fallbackIcon,e.className])}):r.createElement(y.a,{onLoadingStateChange:function(e){e==v.c.error?a(!0):a(!1)},src:e.src,width:e.width,height:e.height,imageFit:v.b.contain,className:e.className})})),A=n(1260),S=n(9857),_=Object(a.a)((function(e){var t,n=e.isPersisted?"Pinned":"Pin",a=(t=e.isPersisted?Object(i.b)(l.g):Object(i.b)(l.f),Object(i.c)(t,e.displayName)),o=e.isDarkTheme?S.persistIconDark:S.persistIcon;return r.createElement(A.a,{className:o,onClick:e.togglePersist,title:a,ariaLabel:a,iconProps:{iconName:n}})})),O=n(6349),I=n(132),x=n(9857),T=Object(a.a)((function(e,t){var n=r.useRef();r.useImperativeHandle(t,(function(){return{focusCloseButton:function(){n.current&&n.current.focus()}}}),[]);var a=e.isCalendar,o=Object(I.e)(),s=o?c()(x.addinPaneHeaderDark,a&&x.addinPaneHeaderCalendarDark):c()(x.addinPaneHeader,a&&x.addinPaneHeaderCalendar),l=c()([o?x.addinPaneLabelTextDark:x.addinPaneLabelText,x.ellipsis]),u=o?x.closeButtonDark:x.closeButton;return r.createElement("div",{className:s},r.createElement(C,{src:e.iconUrl,width:32,height:32,className:x.addinPaneIcon}),r.createElement("div",{className:l},e.displayName),r.createElement("div",{className:x.rightButtons},Object(O.b)()&&e.isPersistable&&!a&&r.createElement(_,{displayName:e.displayName,isPersisted:e.isPersisted,isDarkTheme:o,togglePersist:e.togglePersist}),r.createElement(A.a,{componentRef:function(e){return n.current=e},className:u,onClick:e.closeOnClick,ariaLabel:Object(i.b)(m.a),iconProps:{iconName:"Cancel"}})))}),{forwardRef:!0}),E=n(7743),M=n(1545),P=n(1937),k=n(2086),R=n(2444),N=n(15574),w=function(e){var t=r.useContext(R.a),n=c()(N.taskPane,t!==window&&N.taskPaneInPopout,e.isDeepLink&&N.taskPaneNoHeader,{isShyHeaderMode:Object(k.b)()});return e.renderInPanel?r.createElement(P.a,{focusTrapZoneProps:{forceFocusInsideTrap:!1,disableFirstFocus:e.disableFirstFocus,isClickableOutsideFocusTrap:!0},hasCloseButton:!1,isOpen:!0,onDismiss:e.onDismiss,className:n,isBlocking:!1,isFooterAtBottom:!0,isLightDismiss:!0},e.children):r.createElement(M.a,{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,className:N.taskPane},e.children)},D=n(4493),U=n(2083),F=n(514),L=n(8298),j=(n(4008),n(2063)),B=n(5377),H=n(6242),V=n(15576),W=Object(a.a)((function(e){var t=r.useRef(),n=function(){t.current&&t.current.focusCloseButton()},a=function(){return e.instance.mode===U.a.AppointmentAttendee||e.instance.mode===U.a.AppointmentOrganizer},s=function(){return"Persistent"===e.type},l=function(){return 0!==e.instance.errorType},u=function(){var t=e.instance,n=t.mode,r=t.controlId;s()&&Object(B.h)(n,null),Object(D.d)(r)},d=e.instance,f=void 0===e.renderInPanel||e.renderInPanel;if(!d)return r.createElement("div",{className:V.divContainer});var m,g=d.addinCommand;return r.createElement(w,{renderInPanel:f,onDismiss:u,isDeepLink:Object(F.w)(),disableFirstFocus:s()},r.createElement(T,{iconUrl:g.extension.IconUrl,displayName:g.extension.DisplayName,closeOnClick:u,ref:t,isCalendar:a(),isPersistable:Object(B.a)(e.instance.addinCommand),isPersisted:s(),togglePersist:function(){var t=s()?null:Object(B.b)(e.instance.addinCommand);Object(B.h)(e.instance.mode,t),"Persistent"==e.type?Object(H.b)():Object(H.c)({hostItemIndex:e.instance.hostItemIndex,mode:e.instance.mode}),Object(j.ib)(e.type,e.instance.hostItemIndex)}}),r.createElement("div",{tabIndex:0,className:c()(V.extensionContainer,a()&&V.extensionContainerCalendar),"aria-label":Object(i.c)(Object(i.b)(o.a),g.extension.DisplayName),role:"complementary"},(m=e.instance.errorType,l()&&r.createElement(p,{errorType:m})),function(){var t=e.instance,a=t.hostItemIndex,o=t.controlId,i=t.addinCommand,s={};return s[15]=n,s[14]=n,s[13]=n,r.createElement(L.a,{addinCommand:i,controlId:o,className:c()([V.extensionHost,l()&&V.hide]),hostItemIndex:a,manifestCacheProvider:E.a,notifyHostActions:s})}()))})),G=n(4532),X=n(3563),q=n(2202),z="addinTaskPane";var K=n(4),J=n(2269),Q=n(2748),Y=n(9856);t.a=Object(a.a)((function(e){var t=r.useContext(R.a),n=Object(j.s)(),a=n.taskPanes,o=n.frameworkComponentHostItemIndexMap,i=Object(Y.a)(t),s=o.get(i),c=function(t){var n=Object(j.B)(t,s);return n&&r.createElement(W,{key:n.controlId,type:t,instance:n,renderInPanel:e.renderTaskPaneInPanel})};!function(){if("Mail"===Object(K.j)()){var e=Object(J.a)(t),n=null==e?void 0:e.underlay,r=a.get(s),o=Object(Q.a)(n);!o&&(null==r?void 0:r.size)?(i=n,Object(G.a)(z,!0,!1,i),q.b.importAndExecute(),X.a.importAndExecute()):o&&!(null==r?void 0:r.size)&&function(e){Object(G.a)(z,!1,!1,e),q.b.importAndExecute()}(n)}var i}();var l=Object(O.b)()&&c("Persistent"),u=c("NonPersistent");return r.createElement(r.Fragment,null,[l,u])}))},10390:function(e,t,n){"use strict";var r=n(1),a=n(4141),o=n(2063),i=function(e){var t,n,i=Object(o.s)().activeDialogs;try{for(var s=Object(r.k)(i.values()),c=s.next();!c.done;c=s.next()){c.value.parentControlId==e&&Object(a.j)({eventDispId:a.a.DISPLAY_DIALOG_DISPID,controlId:e})}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}};function s(e){Object(o.s)().runningUILessExtendedAddinCommands.has(e)&&Object(r.j)([],Object(r.g)(Object(o.s)().runningUILessExtendedAddinCommands.get(e).keys())).forEach((function(t,n){!function(e,t,n){i(e),Object(o.gb)(e,t,n)}(t,e,o.d.NavigatedBeforeCompleted)}))}function c(e){s(e),Object(o.g)(e)}n.d(t,"a",(function(){return c}))},10453:function(e,t,n){"use strict";var r=n(19);function a(){return function(){var e=Object(r.a)().SessionSettings.WebSessionType;if(1===e)return"outlookCom";if(2===e)return"gmail";if(0==e)return"office365";return"unknown"}()}n.d(t,"a",(function(){return a}))},11744:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"u",(function(){return s})),n.d(t,"c",(function(){return g})),n.d(t,"p",(function(){return h})),n.d(t,"l",(function(){return v})),n.d(t,"m",(function(){return y})),n.d(t,"i",(function(){return A})),n.d(t,"t",(function(){return S})),n.d(t,"o",(function(){return _})),n.d(t,"n",(function(){return O})),n.d(t,"g",(function(){return I})),n.d(t,"j",(function(){return x})),n.d(t,"k",(function(){return T})),n.d(t,"q",(function(){return E})),n.d(t,"f",(function(){return M})),n.d(t,"v",(function(){return P})),n.d(t,"e",(function(){return k})),n.d(t,"r",(function(){return N})),n.d(t,"d",(function(){return w})),n.d(t,"h",(function(){return D})),n.d(t,"b",(function(){return F})),n.d(t,"s",(function(){return L}));var r=n(8296),a=n(4044),o=n(3620),i="1DS-Web-JS-2.4.6",s="undefined",c=r.b,l=null;var u=a.a.isUndefined,d=a.a.isNullOrUndefined;function f(e){return!u(e)}a.a.hasOwnProperty;var p,m=null,g=a.a.arrForEach,h=(a.a.arrIndexOf,a.a.arrMap,a.a.arrReduce,a.a.objKeys),v=(a.a.toISOString,o.n),y=a.a.isString,b=a.a.isNumber,C=a.a.isBoolean,A=(a.a.isFunction,a.a.isArray),S=(a.a.isObject,a.a.strTrim),_=(Boolean(Object(o.c)()),Boolean(Object(o.k)()));function O(e){return!(d(e)||""===e)}function I(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}function x(){return null===m&&(m=Object(o.m)()&&Boolean(Object(o.i)().sendBeacon)),m}function T(e){return!!(e&&b(e)&&e>=1&&e<=3)}function E(e,t,n){if(!y(e)||d(t)||""===t)return null;if(y(t)||b(t)||C(t)||A(t))t={value:t};else if("object"!=typeof t||t.hasOwnProperty("value")){if(d(t.value)||""===t.value||!y(t.value)&&!b(t.value)&&!C(t.value)&&!A(t.value))return null}else t={value:n?JSON.stringify(t):t};if(A(t.value)&&!(t.value.length>0))return null;if(f(t.kind)){if(A(t.value)||!function(e){if(b(e)&&(e>=0&&e<=13||32===e))return!0;return!1}(t.kind))return null;t.value=t.value.toString()}return t}function M(e){return e.getUTCFullYear()+"-"+U(e.getUTCMonth()+1)+"-"+U(e.getUTCDate())+"T"+U(e.getUTCHours())+":"+U(e.getUTCMinutes())+":"+U(e.getUTCSeconds())+"."+function(e){if(e<10)return"00"+e;if(e<100)return"0"+e;return e.toString()}(e.getUTCMilliseconds())+"Z"}function P(){if(void 0!==typeof XMLHttpRequest){var e=Object(o.e)("XMLHttpRequest");if(e){var t=new e;return Boolean(u(t.withCredentials)&&void 0!==typeof XDomainRequest)}}}function k(e,t,n){var r=-1;return u(e)?r:(t&&t>0&&(32===t?r=1<<13:t<=13&&(r=t<<5)),f(n)&&function(e){if(b(e)&&e>=0&&e<=9)return!0;return!1}(n)?(-1===r&&(r=0),r|n):(A(e)&&(e=e[0]),-1!==r?r|function(e){if(u(e))return-1;if(b(e))return c.Double;if(y(e))return c.String;if(C(e))return c.Bool;return-1}(e):b(e)?c.Double:r))}function R(){if(void 0===p){p=!1;try{var e=Object(o.c)(),t=Object(o.i)();e&&!u(e.cookie)&&t&&t.cookieEnabled&&(p=!0)}catch(e){}}return p}function N(e,t,n){if(R()){var r="",a=Object(o.g)();a&&"https:"===a.protocol&&(r=";secure",null===l&&(l=function(e){return!!y(e)&&(-1!==e.indexOf("CPU iPhone OS 12")||-1!==e.indexOf("iPad; CPU OS 12")||(-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&-1!==e.indexOf("Version/")&&-1!==e.indexOf("Safari")||(-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&(n="AppleWebKit/605.1.15 (KHTML, like Gecko)",r=(t=e).length,a=r-n.length,t.substring(a>=0?a:0,r)===n)||(-1!==e.indexOf("Chrome/5")||-1!==e.indexOf("Chrome/6")||(-1!==e.indexOf("UnrealEngine")&&-1===e.indexOf("Chrome")||(-1!==e.indexOf("UCBrowser/12")||-1!==e.indexOf("UCBrowser/11")))))));var t,n,r,a}((Object(o.i)()||{}).userAgent)),l||(t+=";SameSite=None"));var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var s="; expires="+i.toUTCString();Object(o.c)().cookie=e+"="+t+s+"; path=/"+r}}function w(e){void 0===e&&(e="D");var t=a.a.newGuid();return"B"===e?t="{"+t+"}":"P"==e?t="("+t+")":"N"==e&&(t=t.replace(/-/g,"")),t}var D=a.a.perfNow;function U(e){return e<10?"0"+e:e.toString()}function F(e){var t=j("beforeunload",e);return t=j("unload",e)||t,t=j("pagehide",e)||t}function L(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=D()}var j=a.a.addEventHandler},11745:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2063);function a(e,t){var n=Object(r.y)();Object(r.W)(n,e,t)}},11746:function(e,t,n){"use strict";var r=n(0),a=n(481),o=n(424),i=n(54),s=n(15583);t.a=function(e){return{iconType:a.a.Image,imageProps:{src:e,width:16,height:16,imageFit:i.b.contain,shouldFadeIn:!1},styles:{root:{width:"16px !important",height:"16px !important"}},imageErrorAs:function(e){return r.createElement(o.a,{className:s.fallbackIcon,iconName:"Photo2",iconType:a.a.Default})}}}},11747:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n(15585),a=n(6),o=n(9853),i=n(481),s=n(143);function c(){return{key:"AddinMarketplace",name:Object(a.b)(r.a),title:Object(a.b)(r.a),ariaLabel:Object(a.b)(r.a),iconProps:{iconName:"AddIn",iconType:i.a.default},itemType:s.a.Normal,onClick:function(){Object(o.a)()}}}function l(){return{key:"AddinMarketplaceDivider",displayName:"-",itemType:s.a.Divider,iconProps:{iconName:"AddIn",iconType:i.a.default},onClick:null}}},12195:function(e,t,n){"use strict";var r=n(203),a=n(151),o="/ows/api/beta/PersistedAddins";function i(e,t,n){var i=Object(r.a)();Object(a.d)(o,{Addin:{mode:e,addinId:t,commandId:n}},i)}var s=n(1),c=n(217);function l(){return Object(s.c)(this,void 0,void 0,(function(){var e,t;return Object(s.f)(this,(function(n){switch(n.label){case 0:return e=Object(r.a)(),[4,Object(a.b)(o,e,!0)];case 1:return t=n.sent(),Object(c.a)(t.status)?[2,t.text()]:[2,"{}"]}}))}))}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return l}))},12243:function(e,t,n){"use strict";var r;!function(e){e.MailRead="MailRead",e.MailCompose="MailCompose",e.NoEndpoint=""}(r||(r={}));var a=r,o=n(2083);function i(e){switch(e){case o.a.MessageRead:case o.a.MeetingRequest:return a.MailRead;case o.a.MessageCompose:return a.MailCompose;default:return a.NoEndpoint}}n.d(t,"a",(function(){return i}))},1254:function(e,t,n){"use strict";var r=n(768),a=n(3),o=n(0),i=n(713),s=n(470),c=Object(i.a)(),l=function(e){function t(t){var n=e.call(this,t)||this;return Object(s.a)(n),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,r=e.theme;return this._classNames=c(n,{theme:r,className:t}),o.createElement("div",{className:this._classNames.actions},o.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return o.Children.map(this.props.children,(function(t){return t?o.createElement("span",{className:e._classNames.action},t):null}))},t}(o.Component),u=n(7),d={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"};n.d(t,"a",(function(){return f}));var f=Object(r.a)(l,(function(e){var t=e.className,n=e.theme,r=Object(u.getGlobalClassNames)(d,n);return{actions:[r.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},t],action:[r.action,{margin:"0 4px"}],actionsRight:[r.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0"}]}}),void 0,{scope:"DialogFooter"})},1268:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),a=n(218),o=function(){var e=Object(a.a)({});return r.useEffect((function(){return function(){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];clearTimeout(r)}}}),[e]),Object(a.a)({setTimeout:function(t,n){var r=setTimeout(t,n);return e[r]=1,r},clearTimeout:function(t){delete e[t],clearTimeout(t)}})}},1435:function(e,t,n){"use strict";function r(e){throw new Error("Unexpected object: "+e)}n.d(t,"a",(function(){return r}))},1551:function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},15555:function(e,t){
/*!
    Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.

    This file also contains the following Promise implementation (with a few small modifications):
        * @overview es6-promise - a tiny implementation of Promises/A+.
        * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
        * @license   Licensed under MIT license
        *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
        * @version   2.3.0
*/
var n,r;n=d||(d={}),r=function(){var e=!0;function t(){}return t.prototype.isMsAjaxLoaded=function(){var t="function",n="undefined";return!!(typeof Sys!==n&&typeof Type!==n&&Sys.StringBuilder&&typeof Sys.StringBuilder===t&&Type.registerNamespace&&typeof Type.registerNamespace===t&&Type.registerClass&&typeof Type.registerClass===t&&typeof Function._validateParams===t&&Sys.Serialization&&Sys.Serialization.JavaScriptSerializer&&typeof Sys.Serialization.JavaScriptSerializer.serialize===t)&&e},t.prototype.loadMsAjaxFull=function(e){var t=("https:"===window.location.protocol.toLowerCase()?"https:":"http:")+"//ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js";o.OUtil.loadScript(t,e)},Object.defineProperty(t.prototype,"msAjaxError",{get:function(){var e=this;return null==e._msAjaxError&&e.isMsAjaxLoaded()&&(e._msAjaxError=Error),e._msAjaxError},set:function(e){this._msAjaxError=e},enumerable:e,configurable:e}),Object.defineProperty(t.prototype,"msAjaxString",{get:function(){var e=this;return null==e._msAjaxString&&e.isMsAjaxLoaded()&&(e._msAjaxString=String),e._msAjaxString},set:function(e){this._msAjaxString=e},enumerable:e,configurable:e}),Object.defineProperty(t.prototype,"msAjaxDebug",{get:function(){var e=this;return null==e._msAjaxDebug&&e.isMsAjaxLoaded()&&(e._msAjaxDebug=Sys.Debug),e._msAjaxDebug},set:function(e){this._msAjaxDebug=e},enumerable:e,configurable:e}),t}(),n.MicrosoftAjaxFactory=r;var a=new d.MicrosoftAjaxFactory,o=o||{};!function(e){var t=function(){function e(e){this._internalStorage=e}return e.prototype.getItem=function(e){try{return this._internalStorage&&this._internalStorage.getItem(e)}catch(e){return null}},e.prototype.setItem=function(e,t){try{this._internalStorage&&this._internalStorage.setItem(e,t)}catch(e){}},e.prototype.clear=function(){try{this._internalStorage&&this._internalStorage.clear()}catch(e){}},e.prototype.removeItem=function(e){try{this._internalStorage&&this._internalStorage.removeItem(e)}catch(e){}},e.prototype.getKeysWithPrefix=function(e){var t=[];try{for(var n=this._internalStorage&&this._internalStorage.length||0,r=0;r<n;r++){var a=this._internalStorage.key(r);0===a.indexOf(e)&&t.push(a)}}catch(e){}return t},e}();e.SafeStorage=t}(d||(d={})),o.XdmFieldName={ConversationUrl:"ConversationUrl",AppId:"AppId"},o.TestFlightStart=1e3,o.TestFlightEnd=1009,o.FlightNames={UseOriginNotUrl:0,CheckReceiverOrigin:1,AddinEnforceHttps:2,FirstPartyAnonymousProxyReadyCheckTimeout:6,SdxOnWacCDNIsEnabled:7,AddinRibbonIdAllowUnknown:9,IgnoreWindowName:11,DialogPromptCleanDisplay:14,ManifestParserDevConsoleLog:15,AddInsInSupportedIrmDocsIsEnabled:17,AddinActionDefinitionHybridMode:18,NotifyHostOnlyWithOrigin:19,UseActionIdForUILessCommand:20,OSFTestFlight1000:o.TestFlightStart,OSFTestFlight1001:o.TestFlightStart+1,OSFTestFlight1002:o.TestFlightStart+2,OSFTestFlight1003:o.TestFlightStart+3,OSFTestFlight1004:o.TestFlightStart+4,OSFTestFlight1005:o.TestFlightStart+5,OSFTestFlight1006:o.TestFlightStart+6,OSFTestFlight1007:o.TestFlightStart+7,OSFTestFlight1008:o.TestFlightStart+8,OSFTestFlight1009:o.TestFlightEnd},o.Flights=[],o.Settings={},o.WindowNameItemKeys={BaseFrameName:"baseFrameName",HostInfo:"hostInfo",XdmInfo:"xdmInfo",SerializerVersion:"serializerVersion",AppContext:"appContext",Flights:"flights"},o.OUtil=function(){var e="focus",t="https:",n="on",r="configurable",i="writable",s="enumerable",c="",l="undefined",u=!1,f=!0,p="string",m=2147483647,g=null,h="#",v=-1,y=v,b="&_xdm_Info=",C="&_serializer_version=",A="&_flights=",S="_xdm_",_=h,O="class",I={},x=g,T=g,E=(new Date).getTime();function M(){var e=m*Math.random();return(e^=E^(new Date).getMilliseconds()<<Math.floor(21*Math.random())).toString(16)}function P(){if(!x){try{var e=window.sessionStorage}catch(t){e=g}x=new d.SafeStorage(e)}return x}function k(e){for(var t,n=[],r=[],a=e.length,o=0;o<a;o++)(t=e[o]).tabIndex?t.tabIndex>0?r.push(t):0===t.tabIndex&&n.push(t):n.push(t);return r=r.sort((function(e,t){var n=e.tabIndex-t.tabIndex;return 0===n&&(n=r.indexOf(e)-r.indexOf(t)),n})),[].concat(r,n)}return{set_entropy:function(e){if(typeof e==p)for(var t=0;t<e.length;t+=4){for(var n=0,r=0;r<4&&t+r<e.length;r++)n=(n<<8)+e.charCodeAt(t+r);E^=n}else E^="number"==typeof e?e:m*Math.random();E&=m},extend:function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.uber=t.prototype,t.prototype.constructor===Object.prototype.constructor&&(t.prototype.constructor=t)},setNamespace:function(e,t){t&&e&&!t[e]&&(t[e]={})},unsetNamespace:function(e,t){t&&e&&t[e]&&delete t[e]},serializeSettings:function(e){var t={};for(var n in e){var r=e[n];try{r=JSON?JSON.stringify(r,(function(e,t){return o.OUtil.isDate(this[e])?o.DDA.SettingsManager.DateJSONPrefix+this[e].getTime()+o.DDA.SettingsManager.DataJSONSuffix:t})):Sys.Serialization.JavaScriptSerializer.serialize(r),t[n]=r}catch(e){}}return t},deserializeSettings:function(e){var t={};for(var n in e=e||{}){var r=e[n];try{r=JSON?JSON.parse(r,(function(e,t){var n;return typeof t===p&&t&&t.length>6&&t.slice(0,5)===o.DDA.SettingsManager.DateJSONPrefix&&t.slice(v)===o.DDA.SettingsManager.DataJSONSuffix&&(n=new Date(parseInt(t.slice(5,v))))?n:t})):Sys.Serialization.JavaScriptSerializer.deserialize(r,f),t[n]=r}catch(e){}}return t},loadScript:function(e,t,n){if(e&&t){var r=window.document,a=I[e];if(a)a.loaded?t():a.pendingCallbacks.push(t);else{var o=r.createElement("script");o.type="text/javascript",a={loaded:u,pendingCallbacks:[t],timer:g},I[e]=a;var i=function(){a.timer!=g&&(clearTimeout(a.timer),delete a.timer),a.loaded=f;for(var e=a.pendingCallbacks.length,t=0;t<e;t++){a.pendingCallbacks.shift()()}},s=function(){delete I[e],a.timer!=g&&(clearTimeout(a.timer),delete a.timer);for(var t=a.pendingCallbacks.length,n=0;n<t;n++){a.pendingCallbacks.shift()()}};o.readyState?o.onreadystatechange=function(){"loaded"!=o.readyState&&"complete"!=o.readyState||(o.onreadystatechange=g,i())}:o.onload=i,o.onerror=s,n=n||3e4,a.timer=setTimeout(s,n),o.setAttribute("crossOrigin","anonymous"),o.src=e,r.getElementsByTagName("head")[0].appendChild(o)}}},loadCSS:function(e){if(e){var t=window.document,n=t.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)}},parseEnum:function(e,t){var n=t[e.trim()];if(typeof n==l)throw a.msAjaxDebug.trace("invalid enumeration string:"+e),a.msAjaxError.argument("str");return n},delayExecutionAndCache:function(){var e={calc:arguments[0]};return function(){return e.calc&&(e.val=e.calc.apply(this,arguments),delete e.calc),e.val}},getUniqueId:function(){return(y+=1).toString()},formatString:function(){var e=arguments,t=e[0];return t.replace(/{(\d+)}/gm,(function(t,n){var r=parseInt(n,10)+1;return void 0===e[r]?"{"+n+"}":e[r]}))},generateConversationId:function(){return[M(),M(),(new Date).getTime().toString()].join("_")},getFrameName:function(e){return S+e+this.generateConversationId()},addXdmInfoAsHash:function(e,t){return o.OUtil.addInfoAsHash(e,b,t,u)},addSerializerVersionAsHash:function(e,t){return o.OUtil.addInfoAsHash(e,C,t,f)},addFlightsAsHash:function(e,t){return o.OUtil.addInfoAsHash(e,A,t,f)},addInfoAsHash:function(e,t,n,r){var a,o=(e=e.trim()||c).split(_),i=o.shift(),s=o.join(_);return a=r?[t,encodeURIComponent(n),s].join(c):[s,t,n].join(c),[i,_,a].join(c)},parseHostInfoFromWindowName:function(e,t){return o.OUtil.parseInfoFromWindowName(e,t,o.WindowNameItemKeys.HostInfo)},parseXdmInfo:function(e){var t=o.OUtil.parseXdmInfoWithGivenFragment(e,window.location.hash);return t||(t=o.OUtil.parseXdmInfoFromWindowName(e,window.name)),t},parseXdmInfoFromWindowName:function(e,t){return o.OUtil.parseInfoFromWindowName(e,t,o.WindowNameItemKeys.XdmInfo)},parseXdmInfoWithGivenFragment:function(e,t){return o.OUtil.parseInfoWithGivenFragment(b,S,u,e,t)},parseSerializerVersion:function(e){var t=o.OUtil.parseSerializerVersionWithGivenFragment(e,window.location.hash);return isNaN(t)&&(t=o.OUtil.parseSerializerVersionFromWindowName(e,window.name)),t},parseSerializerVersionFromWindowName:function(e,t){return parseInt(o.OUtil.parseInfoFromWindowName(e,t,o.WindowNameItemKeys.SerializerVersion))},parseSerializerVersionWithGivenFragment:function(e,t){return parseInt(o.OUtil.parseInfoWithGivenFragment(C,"_serializer_version=",f,e,t))},parseFlights:function(e){var t=o.OUtil.parseFlightsWithGivenFragment(e,window.location.hash);return 0==t.length&&(t=o.OUtil.parseFlightsFromWindowName(e,window.name)),t},checkFlight:function(e){return o.Flights&&o.Flights.indexOf(e)>=0},pushFlight:function(e){return o.Flights.indexOf(e)<0?(o.Flights.push(e),f):u},getBooleanSetting:function(e){return o.OUtil.getBooleanFromDictionary(o.Settings,e)},getBooleanFromDictionary:function(e,t){var n=e&&t&&void 0!==e[t]&&e[t]&&(typeof e[t]===p&&"TRUE"===e[t].toUpperCase()||"boolean"==typeof e[t]&&e[t]);return void 0!==n?n:u},parseFlightsFromWindowName:function(e,t){return o.OUtil.parseArrayWithDefault(o.OUtil.parseInfoFromWindowName(e,t,o.WindowNameItemKeys.Flights))},parseFlightsWithGivenFragment:function(e,t){return o.OUtil.parseArrayWithDefault(o.OUtil.parseInfoWithGivenFragment(A,"_flights=",f,e,t))},parseArrayWithDefault:function(e){var t=[];try{t=JSON.parse(e)}catch(e){}return Array.isArray(t)||(t=[]),t},parseInfoFromWindowName:function(e,t,n){try{var r=JSON.parse(t),a=r!=g?r[n]:g,i=P();if(!e&&i&&r!=g){var s=r[o.WindowNameItemKeys.BaseFrameName]+n;a?i.setItem(s,a):a=i.getItem(s)}return a}catch(e){return g}},parseInfoWithGivenFragment:function(e,t,n,r,a){var o=a.split(e),i=o.length>1?o[o.length-1]:g;n&&i!=g&&(i.indexOf("&")>=0&&(i=i.split("&")[0]),i=decodeURIComponent(i));var s=P();if(!r&&s){var c=window.name.indexOf(t);if(c>v){var l=window.name.indexOf(";",c);l==v&&(l=window.name.length);var u=window.name.substring(c,l);i?s.setItem(u,i):i=s.getItem(u)}}return i},getConversationId:function(){var e=window.location.search,t=g;if(e){var n=e.indexOf("&");(t=n>0?e.substring(1,n):e.substr(1))&&"="===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1))&&(t=decodeURIComponent(t))}return t},getInfoItems:function(e){var t=e.split("$");return typeof t[1]==l&&(t=e.split("|")),typeof t[1]==l&&(t=e.split("%7C")),t},getXdmFieldValue:function(e,t){var n=c,r=o.OUtil.parseXdmInfo(t);if(r){var a=o.OUtil.getInfoItems(r);if(null!=a&&a.length>=3)switch(e){case o.XdmFieldName.ConversationUrl:n=a[2];break;case o.XdmFieldName.AppId:n=a[1]}}return n},validateParamObject:function(e,t){var n=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:u},{name:"expectedProperties",type:Object,mayBeNull:u},{name:"callback",type:Function,mayBeNull:f}]);if(n)throw n;for(var r in t)if(n=Function._validateParameter(e[r],t[r],r))throw n},writeProfilerMark:function(e){window.msWriteProfilerMark&&(window.msWriteProfilerMark(e),a.msAjaxDebug.trace(e))},outputDebug:function(e){typeof a!==l&&a.msAjaxDebug&&a.msAjaxDebug.trace&&a.msAjaxDebug.trace(e)},defineNondefaultProperty:function(e,t,n,r){for(var a in n=n||{},r){var o=r[a];null==n[o]&&(n[o]=f)}return Object.defineProperty(e,t,n),e},defineNondefaultProperties:function(e,t,n){for(var r in t=t||{})o.OUtil.defineNondefaultProperty(e,r,t[r],n);return e},defineEnumerableProperty:function(e,t,n){return o.OUtil.defineNondefaultProperty(e,t,n,[s])},defineEnumerableProperties:function(e,t){return o.OUtil.defineNondefaultProperties(e,t,[s])},defineMutableProperty:function(e,t,n){return o.OUtil.defineNondefaultProperty(e,t,n,[i,s,r])},defineMutableProperties:function(e,t){return o.OUtil.defineNondefaultProperties(e,t,[i,s,r])},finalizeProperties:function(e,t){t=t||{};for(var n=Object.getOwnPropertyNames(e),r=n.length,a=0;a<r;a++){var o=n[a],i=Object.getOwnPropertyDescriptor(e,o);i.get||i.set||(i.writable=t.writable||u),i.configurable=t.configurable||u,i.enumerable=t.enumerable||f,Object.defineProperty(e,o,i)}return e},mapList:function(e,t){var n=[];if(e)for(var r in e)n.push(t(e[r]));return n},listContainsKey:function(e,t){for(var n in e)if(t==n)return f;return u},listContainsValue:function(e,t){for(var n in e)if(t==e[n])return f;return u},augmentList:function(e,t){var n=e.push?function(t,n){e.push(n)}:function(t,n){e[t]=n};for(var r in t)n(r,t[r])},redefineList:function(e,t){for(var n in e)delete e[n];for(var r in t)e[r]=t[r]},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.apply(e)},isDate:function(e){return"[object Date]"===Object.prototype.toString.apply(e)},addEventListener:function(e,t,r){e.addEventListener?e.addEventListener(t,r,u):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.attachEvent?e.attachEvent(n+t,r):e[n+t]=r},removeEventListener:function(e,t,r){e.removeEventListener?e.removeEventListener(t,r,u):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.detachEvent?e.detachEvent(n+t,r):e[n+t]=g},getCookieValue:function(e){return RegExp(e+"[^;]+").exec(document.cookie).toString().replace(/^[^=]+./,c)},xhrGet:function(e,t,n){var r;try{(r=new XMLHttpRequest).onreadystatechange=function(){4==r.readyState&&(200==r.status?t(r.responseText):n(r.status))},r.open("GET",e,f),r.send()}catch(e){n(e)}},xhrGetFull:function(e,t,n,r){var a,o=t;try{(a=new XMLHttpRequest).onreadystatechange=function(){4==a.readyState&&(200==a.status?n(a,o):r(a.status))},a.open("GET",e,f),a.send()}catch(e){r(e)}},encodeBase64:function(e){if(!e)return e;var t,n,r,a,o,i,s,l=[],u=[],d=0,f=e.length;do{t=e.charCodeAt(d++),n=e.charCodeAt(d++),r=e.charCodeAt(d++),s=0,a=255&t,o=t>>8,i=255&n,u[s++]=a>>2,u[s++]=(3&a)<<4|o>>4,u[s++]=(15&o)<<2|i>>6,u[s++]=63&i,isNaN(n)||(a=n>>8,o=255&r,i=r>>8,u[s++]=a>>2,u[s++]=(3&a)<<4|o>>4,u[s++]=(15&o)<<2|i>>6,u[s++]=63&i),isNaN(n)?u[s-1]=64:isNaN(r)&&(u[s-2]=64,u[s-1]=64);for(var p=0;p<s;p++)l.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(u[p]))}while(d<f);return l.join(c)},getSessionStorage:function(){return P()},getLocalStorage:function(){if(!T){try{var e=window.localStorage}catch(t){e=g}T=new d.SafeStorage(e)}return T},convertIntToCssHexColor:function(e){return h+(Number(e)+16777216).toString(16).slice(-6)},attachClickHandler:function(e,t){e.onclick=function(){t()},e.ontouchend=function(e){t(),e.preventDefault()}},getQueryStringParamValue:function(e,t){var n=Function._validateParams(arguments,[{name:"queryString",type:String,mayBeNull:u},{name:"paramName",type:String,mayBeNull:u}]);if(n)return a.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: Parameters cannot be null."),c;var r=new RegExp("[\\?&]"+t+"=([^&#]*)","i");return r.test(e)?r.exec(e)[1]:(a.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: The parameter is not found."),c)},getHostnamePortionForLogging:function(e){var t=Function._validateParams(arguments,[{name:"hostname",type:String,mayBeNull:u}]);if(t)return c;var n=e.split("."),r=n.length;return r>=2?n[r-2]+"."+n[r-1]:1==r?n[0]:void 0},isiOS:function(){return window.navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?f:u},isChrome:function(){return window.navigator.userAgent.indexOf("Chrome")>0&&!o.OUtil.isEdge()},isEdge:function(){return window.navigator.userAgent.indexOf("Edge")>0},isIE:function(){return window.navigator.userAgent.indexOf("Trident")>0},isFirefox:function(){return window.navigator.userAgent.indexOf("Firefox")>0},startsWith:function(e,t,n){return n?e.substr(0,t.length)===t:e.startsWith(t)},containsPort:function(e,t,n,r){return this.startsWith(e,t+"//"+n+":"+r,f)||this.startsWith(e,n+":"+r,f)},getRedundandPortString:function(e,n){return e&&n?n.protocol==t&&this.containsPort(e,t,n.hostname,"443")?":443":"http:"==n.protocol&&this.containsPort(e,"http:",n.hostname,"80")?":80":c:c},removeChar:function(e,t){return t<e.length-1?e.substring(0,t)+e.substring(t+1):t==e.length-1?e.substring(0,e.length-1):e},cleanUrlOfChar:function(e,t){for(var n=0;n<e.length;n++)if(e.charAt(n)===t){if(n+1>=e.length)return this.removeChar(e,n);if("/"===t){if("?"===e.charAt(n+1)||e.charAt(n+1)===h)return this.removeChar(e,n)}else if("?"===t&&e.charAt(n+1)===h)return this.removeChar(e,n)}return e},cleanUrl:function(e){if(e=this.cleanUrlOfChar(e,"/"),e=this.cleanUrlOfChar(e,"?"),"https://"==(e=this.cleanUrlOfChar(e,h)).substr(0,8))(t=e.indexOf(":443"))!=v&&(t!=e.length-4&&"/"!=e.charAt(t+4)&&"?"!=e.charAt(t+4)&&e.charAt(t+4)!=h||(e=e.substring(0,t)+e.substring(t+4)));else if("http://"==e.substr(0,7)){var t;(t=e.indexOf(":80"))!=v&&(t!=e.length-3&&"/"!=e.charAt(t+3)&&"?"!=e.charAt(t+3)&&e.charAt(t+3)!=h||(e=e.substring(0,t)+e.substring(t+3)))}return e},parseUrl:function(e,n){var r=this;if(void 0===n&&(n=u),typeof e!==l&&e){var a="NotHttps",i=r.isIE(),s={protocol:void 0,hostname:void 0,host:void 0,port:void 0,pathname:void 0,search:void 0,hash:void 0,isPortPartOfUrl:void 0};try{if(i){var d=document.createElement("a");if(d.href=e,!(d&&d.protocol&&d.host&&d.hostname&&d.href&&r.cleanUrl(d.href).toLowerCase()===r.cleanUrl(e).toLowerCase()))throw"InvalidUrl";if(o.OUtil.checkFlight(o.FlightNames.AddinEnforceHttps)&&n&&d.protocol!=t)throw new Error(a);var f=r.getRedundandPortString(e,d);s.protocol=d.protocol,s.hostname=d.hostname,s.port=f==c?d.port:c,s.host=f!=c?d.hostname:d.host,s.pathname=(i?"/":c)+d.pathname,s.search=d.search,s.hash=d.hash,s.isPortPartOfUrl=r.containsPort(e,d.protocol,d.hostname,d.port)}else{var p=new URL(e);if(p&&p.protocol&&p.host&&p.hostname){if(o.OUtil.checkFlight(o.FlightNames.AddinEnforceHttps)&&n&&p.protocol!=t)throw new Error(a);s.protocol=p.protocol,s.hostname=p.hostname,s.port=p.port,s.host=p.host,s.pathname=p.pathname,s.search=p.search,s.hash=p.hash,s.isPortPartOfUrl=p.host.lastIndexOf(":"+p.port)==p.host.length-p.port.length-1}}}catch(e){if(e.message===a)throw e}return s}},shallowCopy:function(e){if(e==g)return g;if(e instanceof Object){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}var r=e.constructor();for(var a in e)e.hasOwnProperty(a)&&(r[a]=e[a]);return r}return e},createObject:function(e){var t=g;if(e){t={};for(var n=e.length,r=0;r<n;r++)t[e[r].name]=e[r].value}return t},addClass:function(e,t){if(!o.OUtil.hasClass(e,t)){var n=e.getAttribute(O);n?e.setAttribute(O,n+" "+t):e.setAttribute(O,t)}},removeClass:function(e,t){if(o.OUtil.hasClass(e,t)){var n=e.getAttribute(O),r=new RegExp("(\\s|^)"+t+"(\\s|$)");n=n.replace(r,c),e.setAttribute(O,n)}},hasClass:function(e,t){var n=e.getAttribute(O);return n&&n.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},focusToFirstTabbable:function(t,n){var r,a,o=u,i=function(){o=f},s=function(e,t,n){return t<0||t>e?v:0===t&&n?v:t!==e-1||n?n?t-1:t+1:v};if(t=k(t),r=n?t.length-1:0,0===t.length)return g;for(;!o&&r>=0&&r<t.length;)a=t[r],window.focus(),a.addEventListener(e,i),a.focus(),a.removeEventListener(e,i),r=s(t.length,r,n),o||a!==document.activeElement||(o=f);return o?a:g},focusToNextTabbable:function(t,n,r){var a,o,i,s=u,c=function(){s=f},l=function(e,t,n){return t<0||t>e?v:0===t&&n?v:t!==e-1||n?n?t-1:t+1:v};if(a=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return v}(t=k(t),n),(o=l(t.length,a,r))<0)return g;for(;!s&&o>=0&&o<t.length;)(i=t[o]).addEventListener(e,c),i.focus(),i.removeEventListener(e,c),o=l(t.length,o,r),s||i!==document.activeElement||(s=f);return s?i:g},isNullOrUndefined:function(e){return typeof e===l?f:e===g?f:u},stringEndsWith:function(e,t){if(!o.OUtil.isNullOrUndefined(e)&&!o.OUtil.isNullOrUndefined(t)){if(t.length>e.length)return u;if(e.substr(e.length-t.length)===t)return f}return u},hashCode:function(e){var t=0;if(!o.OUtil.isNullOrUndefined(e))for(var n=0,r=e.length;n<r;)t=(t<<5)-t+e.charCodeAt(n++)|0;return t},getValue:function(e,t){return o.OUtil.isNullOrUndefined(e)?t:e},externalNativeFunctionExists:function(e){return"unknown"===e||e!==l}}}(),o.OUtil.Guid=function(){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return{generateNewGuid:function(){for(var t="",n=(new Date).getTime(),r=0;r<32&&n>0;r++)8!=r&&12!=r&&16!=r&&20!=r||(t+="-"),t+=e[n%16],n=Math.floor(n/16);for(;r<32;r++)8!=r&&12!=r&&16!=r&&20!=r||(t+="-"),t+=e[Math.floor(16*Math.random())];return t}}}();try{o.Flights=o.OUtil.parseFlights(!0)}catch(e){}window.OSF=o,function(e){var t="\n",n=!0,r=null,o="undefined",i=function(){function e(){}return e.isInstanceOfType=function(e,t){if(typeof t===o||t===r)return!1;if(t instanceof e)return n;var a=t.constructor;return a&&"function"==typeof a&&a.__typeName&&"Object"!==a.__typeName||(a=Object),!(a!==e)||a.__typeName&&e.__typeName&&a.__typeName===e.__typeName},e}();e.MsAjaxTypeHelper=i;var s=function(){var e="Parameter name: {0}";function n(){}return n.create=function(e,t){var n=new Error(e);if(n.message=e,t)for(var r in t)n[r]=t[r];return n.popStackFrame(),n},n.parameterCount=function(e){var t="Sys.ParameterCountException: "+(e||"Parameter count mismatch."),r=n.create(t,{name:"Sys.ParameterCountException"});return r.popStackFrame(),r},n.argument=function(r,a){var o="Sys.ArgumentException: "+(a||"Value does not fall within the expected range.");r&&(o+=t+c.format(e,r));var i=n.create(o,{name:"Sys.ArgumentException",paramName:r});return i.popStackFrame(),i},n.argumentNull=function(r,a){var o="Sys.ArgumentNullException: "+(a||"Value cannot be null.");r&&(o+=t+c.format(e,r));var i=n.create(o,{name:"Sys.ArgumentNullException",paramName:r});return i.popStackFrame(),i},n.argumentOutOfRange=function(a,i,s){var l="Sys.ArgumentOutOfRangeException: "+(s||"Specified argument was out of the range of valid values.");a&&(l+=t+c.format(e,a)),typeof i!==o&&i!==r&&(l+=t+c.format("Actual value was {0}.",i));var u=n.create(l,{name:"Sys.ArgumentOutOfRangeException",paramName:a,actualValue:i});return u.popStackFrame(),u},n.argumentType=function(r,a,o,i){var s="Sys.ArgumentTypeException: ";s+=i||(a&&o?c.format("Object of type '{0}' cannot be converted to type '{1}'.",a.getName?a.getName():a,o.getName?o.getName():o):"Object cannot be converted to the required type."),r&&(s+=t+c.format(e,r));var l=n.create(s,{name:"Sys.ArgumentTypeException",paramName:r,actualType:a,expectedType:o});return l.popStackFrame(),l},n.argumentUndefined=function(r,a){var o="Sys.ArgumentUndefinedException: "+(a||"Value cannot be undefined.");r&&(o+=t+c.format(e,r));var i=n.create(o,{name:"Sys.ArgumentUndefinedException",paramName:r});return i.popStackFrame(),i},n.invalidOperation=function(e){var t="Sys.InvalidOperationException: "+(e||"Operation is not valid due to the current state of the object."),r=n.create(t,{name:"Sys.InvalidOperationException"});return r.popStackFrame(),r},n}();e.MsAjaxError=s;var c=function(){function e(){}return e.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=e;return r.replace(/{(\d+)}/gm,(function(e,n){var r=parseInt(n,10);return void 0===t[r]?"{"+n+"}":t[r]}))},e.startsWith=function(e,t){return e.substr(0,t.length)===t},e}();e.MsAjaxString=c;var l=function(){function e(){}return e.trace=function(){},e}();if(e.MsAjaxDebug=l,!a.isMsAjaxLoaded()){var u=function(e,t,n){void 0!==e.__typeName&&e.__typeName!==r||(e.__typeName=t),void 0!==e.__class&&e.__class!==r||(e.__class=n)};u(Function,"Function",n),u(Error,"Error",n),u(Object,"Object",n),u(String,"String",n),u(Boolean,"Boolean",n),u(Date,"Date",n),u(Number,"Number",n),u(RegExp,"RegExp",n),u(Array,"Array",n),Function.createCallback||(Function.createCallback=function(e,t){var r=Function._validateParams(arguments,[{name:"method",type:Function},{name:"context",mayBeNull:n}]);if(r)throw r;return function(){var n=arguments.length;if(n>0){for(var r=[],a=0;a<n;a++)r[a]=arguments[a];return r[n]=t,e.apply(this,r)}return e.call(this,t)}}),Function.createDelegate||(Function.createDelegate=function(e,t){var r=Function._validateParams(arguments,[{name:"instance",mayBeNull:n},{name:"method",type:Function}]);if(r)throw r;return function(){return t.apply(e,arguments)}}),Function._validateParams||(Function._validateParams=function(e,t,n){var a,i=t.length;if(n=n||typeof n===o,a=Function._validateParameterCount(e,t,n))return a.popStackFrame(),a;for(var s=0,c=e.length;s<c;s++){var l=t[Math.min(s,i-1)],u=l.name;if(l.parameterArray)u+="["+(s-i+1)+"]";else if(!n&&s>=i)break;if(a=Function._validateParameter(e[s],l,u))return a.popStackFrame(),a}return r}),Function._validateParameterCount||(Function._validateParameterCount=function(e,t,a){var o,i,c=t.length,l=e.length;if(l<c){var u=c;for(o=0;o<c;o++){var d=t[o];(d.optional||d.parameterArray)&&u--}l<u&&(i=n)}else if(a&&l>c)for(i=n,o=0;o<c;o++)if(t[o].parameterArray){i=!1;break}if(i){var f=s.parameterCount();return f.popStackFrame(),f}return r}),Function._validateParameter||(Function._validateParameter=function(e,t,n){var a,i=t.type,s=!!t.integer,c=!!t.domElement,l=!!t.mayBeNull;if(a=Function._validateParameterType(e,i,s,c,l,n))return a.popStackFrame(),a;var u=t.elementType,d=!!t.elementMayBeNull;if(i===Array&&typeof e!==o&&e!==r&&(u||!d))for(var f=!!t.elementInteger,p=!!t.elementDomElement,m=0;m<e.length;m++){var g=e[m];if(a=Function._validateParameterType(g,u,f,p,d,n+"["+m+"]"))return a.popStackFrame(),a}return r}),Function._validateParameterType||(Function._validateParameterType=function(t,n,a,i,s,c){var l;return typeof t===o?s?r:((l=e.MsAjaxError.argumentUndefined(c)).popStackFrame(),l):t===r?s?r:((l=e.MsAjaxError.argumentNull(c)).popStackFrame(),l):n&&!e.MsAjaxTypeHelper.isInstanceOfType(n,t)?((l=e.MsAjaxError.argumentType(c,typeof t,n)).popStackFrame(),l):r}),window.Type||(window.Type=Function),Type.registerNamespace||(Type.registerNamespace=function(e){for(var t=e.split("."),n=window,r=0;r<t.length;r++)n[t[r]]=n[t[r]]||{},n=n[t[r]]}),Type.prototype.registerClass||(Type.prototype.registerClass=function(e){({})}),typeof Sys===o&&Type.registerNamespace("Sys"),Error.prototype.popStackFrame||(Error.prototype.popStackFrame=function(){var e=this;if(0!==arguments.length)throw s.parameterCount();if(typeof e.stack!==o&&e.stack!==r&&typeof e.fileName!==o&&e.fileName!==r&&typeof e.lineNumber!==o&&e.lineNumber!==r){for(var n=e.stack.split(t),a=n[0],i=e.fileName+":"+e.lineNumber;typeof a!==o&&a!==r&&-1===a.indexOf(i);)n.shift(),a=n[0];var c=n[1];if(typeof c!==o&&c!==r){var l=c.match(/@(.*):(\d+)$/);typeof l!==o&&l!==r&&(e.fileName=l[1],e.lineNumber=parseInt(l[2]),n.shift(),e.stack=n.join(t))}}}),a.msAjaxError=s,a.msAjaxString=c,a.msAjaxDebug=l}}(d||(d={})),o.OUtil.setNamespace("Microsoft",window),o.OUtil.setNamespace("Office",Microsoft),o.OUtil.setNamespace("Common",Microsoft.Office),Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},o.SerializerVersion={MsAjax:0,Browser:1},function(e){e.appSpecificCheckOrigin=function(){return!1}}(d||(d={})),Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},Microsoft.Office.Common.InvokeResultCode={noError:0,errorInRequest:-1,errorHandlingRequest:-2,errorInResponse:-3,errorHandlingResponse:-4,errorHandlingRequestAccessDenied:-5,errorHandlingMethodCallTimedout:-6},Microsoft.Office.Common.MessageType={request:0,response:1},Microsoft.Office.Common.ActionType={invoke:0,registerEvent:1,unregisterEvent:2},Microsoft.Office.Common.ResponseType={forCalling:0,forEventing:1},Microsoft.Office.Common.HostTrustStatus={unknown:0,untrusted:1,nothttps:2,trusted:3},Microsoft.Office.Common.MethodObject=function(e,t,n){this._method=e,this._invokeType=t,this._blockingOthers=n},Microsoft.Office.Common.MethodObject.prototype={getMethod:function(){return this._method},getInvokeType:function(){return this._invokeType},getBlockingFlag:function(){return this._blockingOthers}},Microsoft.Office.Common.EventMethodObject=function(e,t){this._registerMethodObject=e,this._unregisterMethodObject=t},Microsoft.Office.Common.EventMethodObject.prototype={getRegisterMethodObject:function(){return this._registerMethodObject},getUnregisterMethodObject:function(){return this._unregisterMethodObject}},Microsoft.Office.Common.ServiceEndPoint=function(e){var t=this,n=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:!1}]);if(n)throw n;t._methodObjectList={},t._eventHandlerProxyList={},t._Id=e,t._conversations={},t._policyManager=null,t._appDomains={},t._onHandleRequestError=null},Microsoft.Office.Common.ServiceEndPoint.prototype={registerMethod:function(e,t,n,r){var o="invokeType",i=!1,s=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:i},{name:"method",type:Function,mayBeNull:i},{name:o,type:Number,mayBeNull:i},{name:"blockingOthers",type:Boolean,mayBeNull:i}]);if(s)throw s;if(n!==Microsoft.Office.Common.InvokeType.async&&n!==Microsoft.Office.Common.InvokeType.sync)throw a.msAjaxError.argument(o);var c=new Microsoft.Office.Common.MethodObject(t,n,r);this._methodObjectList[e]=c},unregisterMethod:function(e){var t=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:!1}]);if(t)throw t;delete this._methodObjectList[e]},registerEvent:function(e,t,n){var r=!1,a=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:r},{name:"registerMethod",type:Function,mayBeNull:r},{name:"unregisterMethod",type:Function,mayBeNull:r}]);if(a)throw a;var o=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,Microsoft.Office.Common.InvokeType.syncRegisterEvent,r),new Microsoft.Office.Common.MethodObject(n,Microsoft.Office.Common.InvokeType.syncUnregisterEvent,r));this._methodObjectList[e]=o},registerEventEx:function(e,t,n,r,a){var o=!1,i=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:o},{name:"registerMethod",type:Function,mayBeNull:o},{name:"registerMethodInvokeType",type:Number,mayBeNull:o},{name:"unregisterMethod",type:Function,mayBeNull:o},{name:"unregisterMethodInvokeType",type:Number,mayBeNull:o}]);if(i)throw i;var s=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,n,o),new Microsoft.Office.Common.MethodObject(r,a,o));this._methodObjectList[e]=s},unregisterEvent:function(e){var t=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:!1}]);if(t)throw t;this.unregisterMethod(e)},registerConversation:function(e,t,n,r){var o="appDomains",i=!0,s=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1},{name:"conversationUrl",type:String,mayBeNull:!1,optional:i},{name:o,type:Object,mayBeNull:i,optional:i},{name:"serializerVersion",type:Number,mayBeNull:i,optional:i}]);if(s)throw s;if(n){if(!(n instanceof Array))throw a.msAjaxError.argument(o);this._appDomains[e]=n}this._conversations[e]={url:t,serializerVersion:r}},unregisterConversation:function(e){var t=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1}]);if(t)throw t;delete this._conversations[e]},setPolicyManager:function(e){var t="policyManager",n=Function._validateParams(arguments,[{name:t,type:Object,mayBeNull:!1}]);if(n)throw n;if(!e.checkPermission)throw a.msAjaxError.argument(t);this._policyManager=e},getPolicyManager:function(){return this._policyManager},dispose:function(){var e=null,t=this;t._methodObjectList=e,t._eventHandlerProxyList=e,t._Id=e,t._conversations=e,t._policyManager=e,t._appDomains=e,t._onHandleRequestError=e}},Microsoft.Office.Common.ClientEndPoint=function(e,t,n,r){var i="targetWindow",s=!1,c=this,l=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:s},{name:i,mayBeNull:s},{name:"targetUrl",type:String,mayBeNull:s},{name:"serializerVersion",type:Number,mayBeNull:!0,optional:!0}]);if(l)throw l;try{if(!t.postMessage)throw a.msAjaxError.argument(i)}catch(e){if(!Object.prototype.hasOwnProperty.call(t,"postMessage"))throw a.msAjaxError.argument(i)}c._conversationId=e,c._targetWindow=t,c._targetUrl=n,c._callingIndex=0,c._callbackList={},c._eventHandlerList={},c._serializerVersion=null!=r?r:o.SerializerVersion.Browser,c._checkReceiverOriginAndRun=null,c._hostTrustCheckStatus=Microsoft.Office.Common.HostTrustStatus.unknown,c._checkStatusLogged=s},Microsoft.Office.Common.ClientEndPoint.prototype={invoke:function(e,t,n){var r=Function._validateParams(arguments,[{name:"targetMethodName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"param",mayBeNull:!0}]);if(r)throw r;var a=this,o=function(){var r=a._callingIndex++,o=new Date,i={callback:t,createdOn:o.getTime()};n&&"object"==typeof n&&"number"==typeof n.__timeout__&&(i.timeout=n.__timeout__,delete n.__timeout__),a._callbackList[r]=i;try{if(a._hostTrustCheckStatus!==Microsoft.Office.Common.HostTrustStatus.trusted&&"ContextActivationManager_getAppContextAsync"!==e)throw"Access Denied";var s=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.invoke,a._conversationId,r,n),c=Microsoft.Office.Common.MessagePackager.envelope(s,a._serializerVersion);a._targetWindow.postMessage(c,a._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete a._callbackList[r]}}};a._checkReceiverOriginAndRun?a._checkReceiverOriginAndRun(o):(a._hostTrustCheckStatus=Microsoft.Office.Common.HostTrustStatus.trusted,o())},registerForEvent:function(e,t,n,r){var a=this,o=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"eventHandler",type:Function,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(o)throw o;var i=a._callingIndex++,s=new Date;a._callbackList[i]={callback:n,createdOn:s.getTime()};try{var c=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.registerEvent,a._conversationId,i,r),l=Microsoft.Office.Common.MessagePackager.envelope(c,a._serializerVersion);a._targetWindow.postMessage(l,a._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer(),a._eventHandlerList[e]=t}catch(e){try{null!==n&&n(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete a._callbackList[i]}}},unregisterForEvent:function(e,t,n){var r=this,a=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(a)throw a;var o=r._callingIndex++,i=new Date;r._callbackList[o]={callback:t,createdOn:i.getTime()};try{var s=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.unregisterEvent,r._conversationId,o,n),c=Microsoft.Office.Common.MessagePackager.envelope(s,r._serializerVersion);r._targetWindow.postMessage(c,r._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete r._callbackList[o]}}finally{delete r._eventHandlerList[e]}}},Microsoft.Office.Common.XdmCommunicationManager=function(){var e="serviceEndPointId",t=!0,n="a",r="null",i="channel is not ready.",s="conversationId",c="Unknown conversation Id.",l=!1,u=null,f=[],p=u,m=u,g=10,h=l,v=u,y=65e3,b=y,C={},A={},S=l;function _(e){for(var t in C)if(C[t]._conversations[e])return C[t];throw a.msAjaxDebug.trace(c),a.msAjaxError.argument(s)}function O(e){var t=A[e];return!t&&a.msAjaxDebug.trace(c),t}function I(e){f.push(e)}function x(){if(m!==u){if(!h)if(f.length>0){T(f.shift())}else clearInterval(m),m=u}else a.msAjaxDebug.trace(i)}function T(e){h=e.getInvokeBlockingFlag(),e.invoke(),p=(new Date).getTime()}function E(){if(v){var e,t,n=0,r=new Date;for(var o in A)for(var s in(e=A[o])._callbackList){var c=e._callbackList[s];if((t=c.timeout?c.timeout:b)>=0&&Math.abs(r.getTime()-c.createdOn)>=t)try{c.callback&&c.callback(Microsoft.Office.Common.InvokeResultCode.errorHandlingMethodCallTimedout,u)}finally{delete e._callbackList[s]}else n++}0===n&&(clearInterval(v),v=u)}else a.msAjaxDebug.trace(i)}function M(){h=l}function P(e,t){var a,i,s=l;if(!(e&&t&&e!==r&&t!==r&&e.length&&t.length))return s;o.OUtil.checkFlight(o.FlightNames.AddinEnforceHttps)?s=w(e,t):(a=document.createElement(n),i=document.createElement(n),a.href=e,i.href=t,s=D(a,i),delete a);return s}function k(e,t){var a=l;if(!(t&&t!==r&&t.length&&e&&e instanceof Array&&e.length))return a;var i=document.createElement(n),s=document.createElement(n);i.href=t;for(var c=0;c<e.length&&!a;c++)-1!==e[c].indexOf("://")&&(o.OUtil.checkFlight(o.FlightNames.AddinEnforceHttps)?a=w(t,e[c]):(s.href=e[c],a=D(i,s)));return delete i,a}function R(e){if(!e||e===r)return l;var t=["^office-int\\.com$","^officeapps\\.live-int\\.com$","^.*\\.dod\\.online\\.office365\\.us$","^.*\\.gov\\.online\\.office365\\.us$","^.*\\.officeapps\\.live\\.com$","^.*\\.officeapps\\.live-int\\.com$","^.*\\.officeapps-df\\.live\\.com$","^.*\\.online\\.office\\.de$","^.*\\.partner\\.officewebapps\\.cn$","^.*\\.office\\.net$","^"+document.domain.replace(new RegExp("\\.","g"),"\\.")+"$"];return new RegExp(t.join("|")).test(e)}function N(e,a){if(!e||!a||e===r||a===r)return l;var i,s;o.OUtil.checkFlight(o.FlightNames.AddinEnforceHttps)?(i=o.OUtil.parseUrl(e,t),s=o.OUtil.parseUrl(a,t)):((i=document.createElement(n)).href=e,(s=document.createElement(n)).href=a);var c=i.protocol===s.protocol,u=i.port===s.port,d=s.hostname,f=i.hostname,p=d===f,m=l;return!p&&d.length>f.length+1&&(m=d.slice(-(f.length+1))==="."+f),u&&c&&(p||m)}function w(e,n){return D(o.OUtil.parseUrl(e,t),o.OUtil.parseUrl(n,t))}function D(e,t){return e.hostname==t.hostname&&e.protocol==t.protocol&&e.port==t.port}function U(e){var i="Access Denied";if(o&&""!=e.data){var s,c=o.SerializerVersion.Browser,f=e.data;try{c=(s=Microsoft.Office.Common.MessagePackager.unenvelope(f,o.SerializerVersion.Browser))._serializerVersion!=u?s._serializerVersion:c}catch(e){return}if(s._messageType===Microsoft.Office.Common.MessageType.request){var v=e.origin==u||e.origin===r?s._origin:e.origin;try{var y=_(s._conversationId),b=y._conversations[s._conversationId];c=b.serializerVersion!=u?b.serializerVersion:c;var C=[b.url].concat(y._appDomains[s._conversationId]);if(!k(C,e.origin)&&!d.appSpecificCheckOrigin(C,e,s._origin,k))if(!N(b.url,e.origin))throw"Failed origin check";var A=s._data!=u?s._data:{};A.SecurityOrigin=e.origin;var S=y.getPolicyManager();if(S&&!S.checkPermission(s._conversationId,s._actionName,A))throw i;var E=function(e,t){var n=e._methodObjectList[t._actionName];if(!n)throw a.msAjaxDebug.trace("The specified method is not registered on service endpoint:"+t._actionName),a.msAjaxError.argument("messageObject");return t._actionType===Microsoft.Office.Common.ActionType.invoke?n:t._actionType===Microsoft.Office.Common.ActionType.registerEvent?n.getRegisterMethodObject():n.getUnregisterMethodObject()}(y,s),w=new Microsoft.Office.Common.InvokeCompleteCallback(e.source,v,s._actionName,s._conversationId,s._correlationId,M,c),D=new Microsoft.Office.Common.Invoker(E,A,w,y._eventHandlerProxyList,s._conversationId,s._actionName,c),U=t;m==u&&((p==u||(new Date).getTime()-p>g)&&!h?(T(D),U=l):m=setInterval(x,g)),U&&I(D)}catch(a){y&&y._onHandleRequestError&&y._onHandleRequestError(s,a);var F=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequest;a==i&&(F=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied);var L=new Microsoft.Office.Common.Response(s._actionName,s._conversationId,s._correlationId,F,Microsoft.Office.Common.ResponseType.forCalling,a),j=Microsoft.Office.Common.MessagePackager.envelope(L,c),B=l;try{B=!(!e.source||!e.source.postMessage)}catch(e){}var H=l;if(window.location.href&&e.origin&&e.origin!==r&&N(window.location.href,e.origin))H=t;else if(e.origin&&e.origin!==r)if(o.OUtil.checkFlight(o.FlightNames.AddinEnforceHttps)){H=R(o.OUtil.parseUrl(e.origin,t).hostname)}else{var V=document.createElement(n);V.href=e.origin,H=R(V.hostname)}B&&H&&e.source.postMessage(j,v)}}else{if(s._messageType!==Microsoft.Office.Common.MessageType.response)return;var W=O(s._conversationId);if(!W)return;if(W._serializerVersion=c,!P(W._targetUrl,e.origin))throw"Failed orgin check";if(s._responseType===Microsoft.Office.Common.ResponseType.forCalling){var G=W._callbackList[s._correlationId];if(G)try{G.callback&&G.callback(s._errorCode,s._data)}finally{delete W._callbackList[s._correlationId]}}else{var X=W._eventHandlerList[s._actionName];void 0!==X&&X!==u&&X(s._data)}}}}function F(){S||(!function(e){if(window.addEventListener)window.addEventListener("message",e,l);else{if(!(navigator.userAgent.indexOf("MSIE")>-1&&window.attachEvent))throw a.msAjaxDebug.trace("Browser doesn't support the required API."),a.msAjaxError.argument("Browser");window.attachEvent("onmessage",e)}}(U),S=t)}return{connect:function(e,t,n,r){var a=A[e];return a||(F(),a=new Microsoft.Office.Common.ClientEndPoint(e,t,n,r),A[e]=a),a},getClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:s,type:String,mayBeNull:l}]);if(t)throw t;return A[e]},createServiceEndPoint:function(e){F();var t=new Microsoft.Office.Common.ServiceEndPoint(e);return C[e]=t,t},getServiceEndPoint:function(t){var n=Function._validateParams(arguments,[{name:e,type:String,mayBeNull:l}]);if(n)throw n;return C[t]},deleteClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:s,type:String,mayBeNull:l}]);if(t)throw t;delete A[e]},deleteServiceEndPoint:function(t){var n=Function._validateParams(arguments,[{name:e,type:String,mayBeNull:l}]);if(n)throw n;delete C[t]},checkUrlWithAppDomains:function(e,t){return k(e,t)},isTargetSubdomainOfSourceLocation:function(e,t){return N(e,t)},_setMethodTimeout:function(e){var t=Function._validateParams(arguments,[{name:"methodTimeout",type:Number,mayBeNull:l}]);if(t)throw t;b=e<=0?y:e},_startMethodTimeoutTimer:function(){v||(v=setInterval(E,2e3))},isHostNameValidWacDomain:function(e){return R(e)}}}(),Microsoft.Office.Common.Message=function(e,t,n,r,a){var o=!1,i=this,s=Function._validateParams(arguments,[{name:"messageType",type:Number,mayBeNull:o},{name:"actionName",type:String,mayBeNull:o},{name:"conversationId",type:String,mayBeNull:o},{name:"correlationId",mayBeNull:o},{name:"data",mayBeNull:!0,optional:!0}]);if(s)throw s;i._messageType=e,i._actionName=t,i._conversationId=n,i._correlationId=r,i._origin=window.location.origin,i._data=void 0===a?null:a},Microsoft.Office.Common.Message.prototype={getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getOrigin:function(){return this._origin},getData:function(){return this._data},getMessageType:function(){return this._messageType}},Microsoft.Office.Common.Request=function(e,t,n,r,a){Microsoft.Office.Common.Request.uber.constructor.call(this,Microsoft.Office.Common.MessageType.request,e,n,r,a),this._actionType=t},o.OUtil.extend(Microsoft.Office.Common.Request,Microsoft.Office.Common.Message),Microsoft.Office.Common.Request.prototype.getActionType=function(){return this._actionType},Microsoft.Office.Common.Response=function(e,t,n,r,a,o){Microsoft.Office.Common.Response.uber.constructor.call(this,Microsoft.Office.Common.MessageType.response,e,t,n,o),this._errorCode=r,this._responseType=a},o.OUtil.extend(Microsoft.Office.Common.Response,Microsoft.Office.Common.Message),Microsoft.Office.Common.Response.prototype.getErrorCode=function(){return this._errorCode},Microsoft.Office.Common.Response.prototype.getResponseType=function(){return this._responseType},Microsoft.Office.Common.MessagePackager={envelope:function(e){return"object"==typeof e&&(e._serializerVersion=o.SerializerVersion.Browser),JSON.stringify(e)},unenvelope:function(e){return JSON.parse(e)}},Microsoft.Office.Common.ResponseSender=function(e,t,n,r,o,i,s){var c=!1,l=this,u=Function._validateParams(arguments,[{name:"requesterWindow",mayBeNull:c},{name:"requesterUrl",type:String,mayBeNull:c},{name:"actionName",type:String,mayBeNull:c},{name:"conversationId",type:String,mayBeNull:c},{name:"correlationId",mayBeNull:c},{name:"responsetype",type:Number,maybeNull:c},{name:"serializerVersion",type:Number,maybeNull:!0,optional:!0}]);if(u)throw u;l._requesterWindow=e,l._requesterUrl=t,l._actionName=n,l._conversationId=r,l._correlationId=o,l._invokeResultCode=Microsoft.Office.Common.InvokeResultCode.noError,l._responseType=i;var d=l;l._send=function(e){try{var t=new Microsoft.Office.Common.Response(d._actionName,d._conversationId,d._correlationId,d._invokeResultCode,d._responseType,e),n=Microsoft.Office.Common.MessagePackager.envelope(t,s);d._requesterWindow.postMessage(n,d._requesterUrl)}catch(e){a.msAjaxDebug.trace("ResponseSender._send error:"+e.message)}}},Microsoft.Office.Common.ResponseSender.prototype={getRequesterWindow:function(){return this._requesterWindow},getRequesterUrl:function(){return this._requesterUrl},getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getSend:function(){return this._send},setResultCode:function(e){this._invokeResultCode=e}},Microsoft.Office.Common.InvokeCompleteCallback=function(e,t,n,r,o,i,s){var c=this;Microsoft.Office.Common.InvokeCompleteCallback.uber.constructor.call(c,e,t,n,r,o,Microsoft.Office.Common.ResponseType.forCalling,s),c._postCallbackHandler=i;var l=c;c._send=function(e,t){null!=t&&(l._invokeResultCode=t);try{var n=new Microsoft.Office.Common.Response(l._actionName,l._conversationId,l._correlationId,l._invokeResultCode,l._responseType,e),r=Microsoft.Office.Common.MessagePackager.envelope(n,s);l._requesterWindow.postMessage(r,l._requesterUrl),l._postCallbackHandler()}catch(e){a.msAjaxDebug.trace("InvokeCompleteCallback._send error:"+e.message)}}},o.OUtil.extend(Microsoft.Office.Common.InvokeCompleteCallback,Microsoft.Office.Common.ResponseSender),Microsoft.Office.Common.Invoker=function(e,t,n,r,a,o,i){var s=!0,c=!1,l=this,u=Function._validateParams(arguments,[{name:"methodObject",mayBeNull:c},{name:"paramValue",mayBeNull:s},{name:"invokeCompleteCallback",mayBeNull:c},{name:"eventHandlerProxyList",mayBeNull:s},{name:"conversationId",type:String,mayBeNull:c},{name:"eventName",type:String,mayBeNull:c},{name:"serializerVersion",type:Number,mayBeNull:s,optional:s}]);if(u)throw u;l._methodObject=e,l._param=t,l._invokeCompleteCallback=n,l._eventHandlerProxyList=r,l._conversationId=a,l._eventName=o,l._serializerVersion=i},Microsoft.Office.Common.Invoker.prototype={invoke:function(){var e=this;try{var t;switch(e._methodObject.getInvokeType()){case Microsoft.Office.Common.InvokeType.async:e._methodObject.getMethod()(e._param,e._invokeCompleteCallback.getSend());break;case Microsoft.Office.Common.InvokeType.sync:t=e._methodObject.getMethod()(e._param),e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.syncRegisterEvent:var n=e._createEventHandlerProxyObject(e._invokeCompleteCallback);t=e._methodObject.getMethod()(n.getSend(),e._param),e._eventHandlerProxyList[e._conversationId+e._eventName]=n.getSend(),e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.syncUnregisterEvent:var r=e._eventHandlerProxyList[e._conversationId+e._eventName];t=e._methodObject.getMethod()(r,e._param),delete e._eventHandlerProxyList[e._conversationId+e._eventName],e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.asyncRegisterEvent:var a=e._createEventHandlerProxyObject(e._invokeCompleteCallback);e._methodObject.getMethod()(a.getSend(),e._invokeCompleteCallback.getSend(),e._param),e._eventHandlerProxyList[e._callerId+e._eventName]=a.getSend();break;case Microsoft.Office.Common.InvokeType.asyncUnregisterEvent:var o=e._eventHandlerProxyList[e._callerId+e._eventName];e._methodObject.getMethod()(o,e._invokeCompleteCallback.getSend(),e._param),delete e._eventHandlerProxyList[e._callerId+e._eventName]}}catch(t){e._invokeCompleteCallback.setResultCode(Microsoft.Office.Common.InvokeResultCode.errorInResponse),e._invokeCompleteCallback.getSend()(t)}},getInvokeBlockingFlag:function(){return this._methodObject.getBlockingFlag()},_createEventHandlerProxyObject:function(e){return new Microsoft.Office.Common.ResponseSender(e.getRequesterWindow(),e.getRequesterUrl(),e.getActionName(),e.getConversationId(),e.getCorrelationId(),Microsoft.Office.Common.ResponseType.forEventing,this._serializerVersion)}},o.OUtil.setNamespace("OSF",window),o.MessageIDs={FetchBundleUrl:0,LoadReactBundle:1,LoadBundleSuccess:2,LoadBundleError:3},o.AppName={Unsupported:0,Excel:1,Word:2,PowerPoint:4,Outlook:8,ExcelWebApp:16,WordWebApp:32,OutlookWebApp:64,Project:128,AccessWebApp:256,PowerpointWebApp:512,ExcelIOS:1024,Sway:2048,WordIOS:4096,PowerPointIOS:8192,Access:16384,Lync:32768,OutlookIOS:65536,OneNoteWebApp:131072,OneNote:262144,ExcelWinRT:524288,WordWinRT:1048576,PowerpointWinRT:2097152,OutlookAndroid:4194304,OneNoteWinRT:8388608,ExcelAndroid:8388609,VisioWebApp:8388610,OneNoteIOS:8388611,WordAndroid:8388613,PowerpointAndroid:8388614,Visio:8388615,OneNoteAndroid:4194305},o.InternalPerfMarker={DataCoercionBegin:"Agave.HostCall.CoerceDataStart",DataCoercionEnd:"Agave.HostCall.CoerceDataEnd"},o.HostCallPerfMarker={IssueCall:"Agave.HostCall.IssueCall",ReceiveResponse:"Agave.HostCall.ReceiveResponse",RuntimeExceptionRaised:"Agave.HostCall.RuntimeExecptionRaised"},o.AgaveHostAction={Select:0,UnSelect:1,CancelDialog:2,InsertAgave:3,CtrlF6In:4,CtrlF6Exit:5,CtrlF6ExitShift:6,SelectWithError:7,NotifyHostError:8,RefreshAddinCommands:9,PageIsReady:10,TabIn:11,TabInShift:12,TabExit:13,TabExitShift:14,EscExit:15,F2Exit:16,ExitNoFocusable:17,ExitNoFocusableShift:18,MouseEnter:19,MouseLeave:20,UpdateTargetUrl:21,InstallCustomFunctions:22,SendTelemetryEvent:23,UninstallCustomFunctions:24,SendMessage:25,LaunchExtensionComponent:26,StopExtensionComponent:27,RestartExtensionComponent:28,EnableTaskPaneHeaderButton:29,DisableTaskPaneHeaderButton:30,TaskPaneHeaderButtonClicked:31,RemoveAppCommandsAddin:32,RefreshRibbonGallery:33,GetOriginalControlId:34,OfficeJsReady:35,InsertDevManifest:36,InsertDevManifestError:37,SendCustomerContent:38},o.SharedConstants={NotificationConversationIdSuffix:"_ntf"},o.DialogMessageType={DialogMessageReceived:0,DialogParentMessageReceived:1,DialogClosed:12006},o.OfficeAppContext=function(e,t,n,r,a,o,i,s,c,l,u,d,f,p,m,g,h,v,y,b,C,A,S,_,O,I,x){var T=this;T._id=e,T._appName=t,T._appVersion=n,T._appUILocale=r,T._dataLocale=a,T._docUrl=o,T._clientMode=i,T._settings=s,T._reason=c,T._osfControlType=l,T._eToken=u,T._correlationId=d,T._appInstanceId=f,T._touchEnabled=p,T._commerceAllowed=m,T._appMinorVersion=g,T._requirementMatrix=h,T._hostCustomMessage=v,T._hostFullVersion=y,T._isDialog=!1,T._clientWindowHeight=b,T._clientWindowWidth=C,T._addinName=A,T._appDomains=S,T._dialogRequirementMatrix=_,T._featureGates=O,T._officeTheme=I,T._initialDisplayMode=x,T.get_id=function(){return this._id},T.get_appName=function(){return this._appName},T.get_appVersion=function(){return this._appVersion},T.get_appUILocale=function(){return this._appUILocale},T.get_dataLocale=function(){return this._dataLocale},T.get_docUrl=function(){return this._docUrl},T.get_clientMode=function(){return this._clientMode},T.get_bindings=function(){return this._bindings},T.get_settings=function(){return this._settings},T.get_reason=function(){return this._reason},T.get_osfControlType=function(){return this._osfControlType},T.get_eToken=function(){return this._eToken},T.get_correlationId=function(){return this._correlationId},T.get_appInstanceId=function(){return this._appInstanceId},T.get_touchEnabled=function(){return this._touchEnabled},T.get_commerceAllowed=function(){return this._commerceAllowed},T.get_appMinorVersion=function(){return this._appMinorVersion},T.get_requirementMatrix=function(){return this._requirementMatrix},T.get_dialogRequirementMatrix=function(){return this._dialogRequirementMatrix},T.get_hostCustomMessage=function(){return this._hostCustomMessage},T.get_hostFullVersion=function(){return this._hostFullVersion},T.get_isDialog=function(){return this._isDialog},T.get_clientWindowHeight=function(){return this._clientWindowHeight},T.get_clientWindowWidth=function(){return this._clientWindowWidth},T.get_addinName=function(){return this._addinName},T.get_appDomains=function(){return this._appDomains},T.get_featureGates=function(){return this._featureGates},T.get_officeTheme=function(){return this._officeTheme},T.get_initialDisplayMode=function(){return this._initialDisplayMode?this._initialDisplayMode:0}},o.OsfControlType={DocumentLevel:0,ContainerLevel:1},o.ClientMode={ReadOnly:0,ReadWrite:1},o.OUtil.setNamespace("Microsoft",window),o.OUtil.setNamespace("Office",Microsoft),o.OUtil.setNamespace("Client",Microsoft.Office),o.OUtil.setNamespace("WebExtension",Microsoft.Office),Microsoft.Office.WebExtension.InitializationReason={Inserted:"inserted",DocumentOpened:"documentOpened"},Microsoft.Office.WebExtension.ValueFormat={Unformatted:"unformatted",Formatted:"formatted"},Microsoft.Office.WebExtension.FilterType={All:"all"},Microsoft.Office.WebExtension.Parameters={BindingType:"bindingType",CoercionType:"coercionType",ValueFormat:"valueFormat",FilterType:"filterType",Columns:"columns",SampleData:"sampleData",GoToType:"goToType",SelectionMode:"selectionMode",Id:"id",PromptText:"promptText",ItemName:"itemName",FailOnCollision:"failOnCollision",StartRow:"startRow",StartColumn:"startColumn",RowCount:"rowCount",ColumnCount:"columnCount",Callback:"callback",AsyncContext:"asyncContext",Data:"data",Rows:"rows",OverwriteIfStale:"overwriteIfStale",FileType:"fileType",EventType:"eventType",Handler:"handler",SliceSize:"sliceSize",SliceIndex:"sliceIndex",ActiveView:"activeView",Status:"status",PlatformType:"platformType",HostType:"hostType",ForceConsent:"forceConsent",ForceAddAccount:"forceAddAccount",AuthChallenge:"authChallenge",AllowConsentPrompt:"allowConsentPrompt",ForMSGraphAccess:"forMSGraphAccess",AllowSignInPrompt:"allowSignInPrompt",JsonPayload:"jsonPayload",EnableNewHosts:"enableNewHosts",AccountTypeFilter:"accountTypeFilter",Reserved:"reserved",Tcid:"tcid",Xml:"xml",Namespace:"namespace",Prefix:"prefix",XPath:"xPath",Text:"text",ImageLeft:"imageLeft",ImageTop:"imageTop",ImageWidth:"imageWidth",ImageHeight:"imageHeight",TaskId:"taskId",FieldId:"fieldId",FieldValue:"fieldValue",ServerUrl:"serverUrl",ListName:"listName",ResourceId:"resourceId",ViewType:"viewType",ViewName:"viewName",GetRawValue:"getRawValue",CellFormat:"cellFormat",TableOptions:"tableOptions",TaskIndex:"taskIndex",ResourceIndex:"resourceIndex",CustomFieldId:"customFieldId",Url:"url",MessageHandler:"messageHandler",Width:"width",Height:"height",RequireHTTPs:"requireHTTPS",MessageToParent:"messageToParent",DisplayInIframe:"displayInIframe",MessageContent:"messageContent",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen",EnforceAppDomain:"enforceAppDomain",UrlNoHostInfo:"urlNoHostInfo",AppCommandInvocationCompletedData:"appCommandInvocationCompletedData",Base64:"base64",FormId:"formId"},o.OUtil.setNamespace("DDA",o),o.DDA.DocumentMode={ReadOnly:1,ReadWrite:0},o.DDA.PropertyDescriptors={AsyncResultStatus:"AsyncResultStatus"},o.DDA.EventDescriptors={},o.DDA.ListDescriptors={},o.DDA.UI={},o.DDA.getXdmEventName=function(e,t){return t==Microsoft.Office.WebExtension.EventType.BindingSelectionChanged||t==Microsoft.Office.WebExtension.EventType.BindingDataChanged||t==Microsoft.Office.WebExtension.EventType.DataNodeDeleted||t==Microsoft.Office.WebExtension.EventType.DataNodeInserted||t==Microsoft.Office.WebExtension.EventType.DataNodeReplaced?e+"_"+t:t},o.DDA.MethodDispId={dispidMethodMin:64,dispidGetSelectedDataMethod:64,dispidSetSelectedDataMethod:65,dispidAddBindingFromSelectionMethod:66,dispidAddBindingFromPromptMethod:67,dispidGetBindingMethod:68,dispidReleaseBindingMethod:69,dispidGetBindingDataMethod:70,dispidSetBindingDataMethod:71,dispidAddRowsMethod:72,dispidClearAllRowsMethod:73,dispidGetAllBindingsMethod:74,dispidLoadSettingsMethod:75,dispidSaveSettingsMethod:76,dispidGetDocumentCopyMethod:77,dispidAddBindingFromNamedItemMethod:78,dispidAddColumnsMethod:79,dispidGetDocumentCopyChunkMethod:80,dispidReleaseDocumentCopyMethod:81,dispidNavigateToMethod:82,dispidGetActiveViewMethod:83,dispidGetDocumentThemeMethod:84,dispidGetOfficeThemeMethod:85,dispidGetFilePropertiesMethod:86,dispidClearFormatsMethod:87,dispidSetTableOptionsMethod:88,dispidSetFormatsMethod:89,dispidExecuteRichApiRequestMethod:93,dispidAppCommandInvocationCompletedMethod:94,dispidCloseContainerMethod:97,dispidGetAccessTokenMethod:98,dispidGetAuthContextMethod:99,dispidOpenBrowserWindow:102,dispidCreateDocumentMethod:105,dispidInsertFormMethod:106,dispidDisplayRibbonCalloutAsyncMethod:109,dispidGetSelectedTaskMethod:110,dispidGetSelectedResourceMethod:111,dispidGetTaskMethod:112,dispidGetResourceFieldMethod:113,dispidGetWSSUrlMethod:114,dispidGetTaskFieldMethod:115,dispidGetProjectFieldMethod:116,dispidGetSelectedViewMethod:117,dispidGetTaskByIndexMethod:118,dispidGetResourceByIndexMethod:119,dispidSetTaskFieldMethod:120,dispidSetResourceFieldMethod:121,dispidGetMaxTaskIndexMethod:122,dispidGetMaxResourceIndexMethod:123,dispidCreateTaskMethod:124,dispidAddDataPartMethod:128,dispidGetDataPartByIdMethod:129,dispidGetDataPartsByNamespaceMethod:130,dispidGetDataPartXmlMethod:131,dispidGetDataPartNodesMethod:132,dispidDeleteDataPartMethod:133,dispidGetDataNodeValueMethod:134,dispidGetDataNodeXmlMethod:135,dispidGetDataNodesMethod:136,dispidSetDataNodeValueMethod:137,dispidSetDataNodeXmlMethod:138,dispidAddDataNamespaceMethod:139,dispidGetDataUriByPrefixMethod:140,dispidGetDataPrefixByUriMethod:141,dispidGetDataNodeTextMethod:142,dispidSetDataNodeTextMethod:143,dispidMessageParentMethod:144,dispidSendMessageMethod:145,dispidExecuteFeature:146,dispidQueryFeature:147,dispidMethodMax:147},o.DDA.EventDispId={dispidEventMin:0,dispidInitializeEvent:0,dispidSettingsChangedEvent:1,dispidDocumentSelectionChangedEvent:2,dispidBindingSelectionChangedEvent:3,dispidBindingDataChangedEvent:4,dispidDocumentOpenEvent:5,dispidDocumentCloseEvent:6,dispidActiveViewChangedEvent:7,dispidDocumentThemeChangedEvent:8,dispidOfficeThemeChangedEvent:9,dispidDialogMessageReceivedEvent:10,dispidDialogNotificationShownInAddinEvent:11,dispidDialogParentMessageReceivedEvent:12,dispidObjectDeletedEvent:13,dispidObjectSelectionChangedEvent:14,dispidObjectDataChangedEvent:15,dispidContentControlAddedEvent:16,dispidActivationStatusChangedEvent:32,dispidRichApiMessageEvent:33,dispidAppCommandInvokedEvent:39,dispidOlkItemSelectedChangedEvent:46,dispidOlkRecipientsChangedEvent:47,dispidOlkAppointmentTimeChangedEvent:48,dispidOlkRecurrenceChangedEvent:49,dispidOlkAttachmentsChangedEvent:50,dispidOlkEnhancedLocationsChangedEvent:51,dispidOlkInfobarClickedEvent:52,dispidTaskSelectionChangedEvent:56,dispidResourceSelectionChangedEvent:57,dispidViewSelectionChangedEvent:58,dispidDataNodeAddedEvent:60,dispidDataNodeReplacedEvent:61,dispidDataNodeDeletedEvent:62,dispidEventMax:63},o.Constants={FileVersion:"0.0.0.0",ThreePartsFileVersion:"0.0.0",OmexAnonymousServiceName:"__omexExtensionAnonymousProxy",OmexAnonymousServiceExtension:"/anonymousserviceextension.aspx",OmexGatedServiceName:"__omexExtensionGatedProxy",OmexGatedServiceExtension:"/gatedserviceextension.aspx",OmexUnGatedServiceName:"__omexExtensionProxy",OmexUnGatedServiceExtension:"/ungatedserviceextension.aspx",OmexConsentNotificationPage:"/client/consentnotification.aspx",Http:"http",Https:"https",ProtocolSeparator:"://",SignInRedirectUrl:"/logontoliveforwac.aspx?returnurl=",ETokenParameterName:"et",ActivatedCacheKey:"__OSF_RUNTIME_.Activated.{0}.{1}.{2}",AuthenticatedConnectMaxTries:3,IgnoreSandBoxSupport:"Ignore_SandBox_Support",IEUpgradeUrl:"https://office.microsoft.com/redir/HA102789344.aspx",OmexForceAnonymousParamName:"SKAV",OmexForceAnonymousParamValue:"274AE4CD-E50B-4342-970E-1E7F36C70037",EndPointInternalSuffix:"_internal",PreloadOfficeJsId:"OFFICEJSPRELOAD",DisplayLanguageParameterName:"_office.displayLanguage",PreloadOfficeJsUrl:"//appsforoffice.microsoft.com/preloading/preloadoffice.js",StringResourceFile:"osfruntime_strings.js"},function(e){var t=function(){var t="Error: Invalid Parameter keyCode = ";function n(){}return n.init=function(t){return e.ShortcutsMappingTableManager.init(t)},n.getActionFromShortcutKey=function(n,r){if(r<1||r>255)throw t+r;return e.ShortcutsMappingTableManager.getShortcutsInfoDeprecated(n,r)},n.getShortcutInfoArrayFromShortcutKey=function(n,r){if(r<1||r>255)throw t+r;return e.ShortcutsMappingTableManager.getShortcutsInfo(n,r)},n}();e.ActionMetadataManager=t}(d||(d={})),function(e){e.TelemetryProperties={ariaTenantToken:"db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439",nexusTenantToken:1755};var t=function(){var t="object",n="Error: Invalid key combination",r=null;function a(){}return a.getKeyCodeFromVirtualKey=function(e){if(!a.s_stringToKeyCodeMap){a.s_stringToKeyCodeMap={};var t=Object.keys(a.keyCodes);for(var n in t){var r=t[n],o=a.keyCodes[r],i=a.specialCharacters[o];i&&(a.s_stringToKeyCodeMap[i]=r),a.s_stringToKeyCodeMap[o.toUpperCase()]=r}}return a.s_stringToKeyCodeMap[e.toUpperCase()]},a.convertModifierKeyToNumber=function(e){var t=(e=e.trim()).toUpperCase();return a.modifierKeys[t]==r?1==t.length||a.keyCodes[t]?(s.RuntimeTelemetryHelper.LogExceptionTag("Error: Multiple virtual key",r,r,0),r):(s.RuntimeTelemetryHelper.LogExceptionTag("Error: Invalid modifier key",r,r,0),r):a.modifierKeys[t]},a.convertModifierKeys=function(e){for(var t=0,n=0;n<e.length;n++){if(e[n]==r)return-1;t|=a.convertModifierKeyToNumber(e[n])}return t},a.convertStringToKeys=function(e){var t=e.split("+");if(t.length<2)return s.RuntimeTelemetryHelper.LogExceptionTag(n,r,r,r),r;var o=t.splice(0,t.length-1),i=t[t.length-1],c=a.convertModifierKeys(o),l=a.convertVirtualKeyToInt(i);return-1==l||-1==c?(s.RuntimeTelemetryHelper.LogExceptionTag(n,r,r,0),r):{modifierKeys:c,virtualKey:l}},a.convertVirtualKeyToInt=function(e){var t=(e=e.trim()).toUpperCase();if(1==t.length)return t.charCodeAt(0);var n=a.getKeyCodeFromVirtualKey(t);return n||-1},a.getShortcutsInfoDeprecated=function(e,t){if(a.s_shortcutsMappingTable[t]==r)return r;var n=a.s_shortcutsMappingTable[t][e];return n==r?r:{addinId:n[0].addinId,actionId:n[0].actionId,actionName:n[0].actionName}},a.getShortcutsInfo=function(e,t){var n=[];if(a.s_shortcutsMappingTable[t]==r)return n;var o=a.s_shortcutsMappingTable[t][e];if(o==r)return n;for(var i in o)n.push({addinId:o[i].addinId,actionId:o[i].actionId,actionName:o[i].actionName});return n},a.getShortcutText=function(e,t,n){var r=a.keyCodes[t];return r||(r=String.fromCharCode(t)),a.getModifierKeyString(e,n)+"+"+r},a.getModifierKeyString=function(e,t){for(var n=[],r=1;r<=e;){if(e&r){var o=void 0;r==a.modifierKeys[a.s_optionKey.toUpperCase()]?(t||(t=a.s_shortcutPlatformWin32),o=t.toLowerCase()==a.s_shortcutPlatformMac?a.s_optionKey:a.s_altKey):o=a.keyCodesToModifierKeys[r],o&&n.push(o)}r<<=1}return(n=n.sort()).join("+")},a.getShortcutsMappingTableString=function(){return a.s_shortcutsMappingTable==r?r:JSON.stringify(a.s_shortcutsMappingTable)},a.getKeysFromShortcutPlatformAvailability=function(e){return typeof e===t?e[a.s_shortcutPlatformWeb]?e[a.s_shortcutPlatformWeb]:e[a.s_shortcutPlatformDefault]?e[a.s_shortcutPlatformDefault]:r:r},a.validateExtendedManifestShortcutKeys=function(t,o,i){return e.OsfCache.get(e.OsfCache.c_osfCacheTableName,a.s_shortcutsTableCacheKey).then((function(e){var c="Error: Duplicate key combination in the same add-in",l="Error: Cannot parse shortcut table cache",u=t.shortcuts;if(u){var d={},f={};try{e&&(f=JSON.parse(e))}catch(e){if(s.RuntimeTelemetryHelper.LogExceptionTag(l,r,r,0),i)throw l}for(var p=0;p<u.length;p++){var m=a.getKeysFromShortcutPlatformAvailability(u[p].key),g=a.convertStringToKeys(m);if(g==r&&(s.RuntimeTelemetryHelper.LogExceptionTag(n,r,r,0),i))throw n;if(f[g.virtualKey]&&f[g.virtualKey][g.modifierKeys]&&(f[g.virtualKey][g.modifierKeys].push({actionId:u[p].action,addinId:o}),s.RuntimeTelemetryHelper.LogExceptionTag("Warning: Duplicate key combination in existing cache",r,r,0)),d[g.virtualKey]==r&&(d[g.virtualKey]={}),d[g.virtualKey][g.modifierKeys]){for(var h in d[g.virtualKey][g.modifierKeys])if(d[g.virtualKey][g.modifierKeys][h].addinId==o)if(d[g.virtualKey][g.modifierKeys][h].actionId==u[p].action)s.RuntimeTelemetryHelper.LogExceptionTag("Error: Duplicate shortcut entry",r,r,0);else if(s.RuntimeTelemetryHelper.LogExceptionTag(c,r,r,0),i)throw c}else d[g.virtualKey][g.modifierKeys]=[];d[g.virtualKey][g.modifierKeys].push({actionId:u[p].action,addinId:o})}}}))},a.createActionsByIdTable=function(e){var t={};if(e)for(var n=0;n<e.length;n++)t[e[n].id]=e[n].name;return t},a.rebuildMappingTable=function(e){a.s_shortcutsMappingTable={};for(var t=0;t<e.length;t++){var n=e[t].extendedManifest.shortcuts,o=e[t].extendedManifest.actions,i=e[t].addinId,s=a.createActionsByIdTable(o);if(n){for(var c=0;c<n.length;c++){var l=a.getKeysFromShortcutPlatformAvailability(n[c].key),u=a.convertStringToKeys(l);if(u==r)return;var d=s[n[c].action],f={modifierKeys:u.modifierKeys,virtualKey:u.virtualKey,actionId:n[c].action,addinId:i,actionName:d||n[c].action};a.s_shortcutsMappingTable[u.virtualKey]==r&&(a.s_shortcutsMappingTable[u.virtualKey]={}),a.s_shortcutsMappingTable[u.virtualKey][u.modifierKeys]==r&&(a.s_shortcutsMappingTable[u.virtualKey][u.modifierKeys]=[]),a.s_shortcutsMappingTable[u.virtualKey][u.modifierKeys].push(f)}a.sendShortcutTelemetry(i,n.length)}}},a.sendShortcutTelemetry=function(n,a){setTimeout((function(){var o=n.split("|");if(o[1]&&o[4])if(typeof Otel===t&&typeof Otel.Telemetry===t&&"function"==typeof Otel.Telemetry.sendOtelEvent){var i={otelEvent:{eventName:"Office.Extensibility.Shortcuts.InstallationInfo",dataFields:[{name:"solutionId",dataType:1,value:o[1]},{name:"storeType",dataType:1,value:o[4]},{name:"shortcutsCount",dataType:2,value:a}],telemetryProperties:e.TelemetryProperties}};Otel.Telemetry.sendOtelEvent(i)}else s.RuntimeTelemetryHelper.LogCommonMessageTag("The Otel isn't available, couldn't call sendOtelEvent for logging the shortcuts telemetry",r,0);else s.RuntimeTelemetryHelper.LogCommonMessageTag("Couldn't get solutionid or storetype from the addinid",r,0)}),0)},a.getAllExtendedManifestAndBuildMappingTable=function(){return e.OsfExtendedManifestCache.getAll().then((function(t){return a.rebuildMappingTable(t),e.OsfCache.set(e.OsfCache.c_osfCacheTableName,a.s_shortcutsTableCacheKey,e.ShortcutsMappingTableManager.getShortcutsMappingTableString())}))},a.init=function(t){return t?e.OsfCache.get(e.OsfCache.c_osfCacheTableName,a.s_shortcutsTableCacheKey).then((function(e){if(e==r)return a.getAllExtendedManifestAndBuildMappingTable();a.s_shortcutsMappingTable=JSON.parse(e)})):a.getAllExtendedManifestAndBuildMappingTable()},a.s_shortcutPlatformMac="macintosh",a.s_shortcutPlatformWin32="windows",a.s_shortcutsTableCacheKey="shortcutstablecache",a.s_shortcutsMappingTable={},a.s_shortcutPlatformWeb="web",a.s_shortcutPlatformDefault="default",a.s_altKey="Alt",a.s_optionKey="Option",a.s_stringToKeyCodeMap=r,a.keyCodes={18:"Alt",192:"BackQuote",220:"\\",8:"BackSpace",20:"CapsLock",188:",",17:"Ctrl",189:"-",46:"Del",40:"Down",35:"End",13:"Enter",187:"=",27:"Esc",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",36:"Home",45:"Ins",37:"Left",219:"[",91:"Meta",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",96:"NumPad0",97:"NumPad1",98:"NumPad2",99:"NumPad3",100:"NumPad4",101:"NumPad5",102:"NumPad6",103:"NumPad7",104:"NumPad8",105:"NumPad9",111:"NumPadDivide",110:"NumPadDot",109:"NumPadMinus",106:"NumPadMultiply",107:"NumPadPlus",34:"PageDown",33:"PageUp",179:"Pause",190:".",44:"PrintScreen",39:"Right",221:"]",145:"ScrollLock",186:";",222:"'",191:"/",32:"Space",9:"Tab",38:"Up",16:"Shift"},a.specialCharacters={"/":"SLASH","'":"SINGLEQUOTE",";":"SEMICOLON",".":"PERIOD","[":"LEFTBRACKET","]":"RIGHTBRACKET","=":"EQUALSIGN","-":"DASH",",":"COMMA","\\":"BACKSLASH"},a.modifierKeys={SHIFT:4,CTRL:8,CONTROL:8,ALT:32,OPTION:32,COMMAND:256},a.keyCodesToModifierKeys={4:"Shift",8:"Ctrl",32:"Alt",256:"Command"},a}();e.ShortcutsMappingTableManager=t}(d||(d={}));var i,s,c=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)};!function(e){!function(t){var n="IsReactRibbonEnabled",r="ov:SourceLocation",a="resid",i="OfficeGroup",s="ov:Description",l="ov:Title",u=!0,d=!1,f="bt:Image",p="ov:VersionOverrides",m="o:OfficeApp",g=null,h="OfficeControl",v=h,y=function(e){this.name="AddinManifestError",this.message=this.name+": "+e},b=function(e){this.name="AddinInternalError",this.message=e};function C(e,t){if(e==g)throw new y(t)}var A=function(){function e(e){var t="bt:String",n=this;n.Images={},n.Urls={},n.LongStrings={},n.ShortStrings={};var r=e.manifest._xmlProcessor.selectSingleNode(m),a=e.selectSingleNode(r,[p,"ov:Resources"]);n.parseCollection(e,e.selectChildNodes(f,a,["bt:Images"]),n.Images),n.parseCollection(e,e.selectChildNodes("bt:Url",a,["bt:Urls"]),n.Urls),n.parseCollection(e,e.selectChildNodes(t,a,["bt:LongStrings"]),n.LongStrings),n.parseCollection(e,e.selectChildNodes(t,a,["bt:ShortStrings"]),n.ShortStrings)}return e.prototype.parseCollection=function(e,t,n){for(var r=t.length,a=0;a<r;a++){var o=t[a];n[o.getAttribute("id")]=e.parseLocaleAwareSettingsAndGetValue(o)}},e}();t.ManifestResourceManager=A;var S=function(){function e(e,t,n,r){var a=this;a.hostType=e,a.formFactor=t,a.entitlement=n,a.manifest=r,a.resources=new A(a),a.officeGroupCount=0,a.officeControlCount=0}return e.prototype.shouldParseNode=function(e){var t=this.manifest._xmlProcessor.selectSingleNode("ov:OverriddenByRibbonApi",e);return t!=g&&this.manifest._parseBooleanNode(t)?d:u},e.prototype.parseIdRequired=function(e){var t=e.getAttribute("id");return C(t,"Id required"),t},e.prototype.parseLabel=function(e){var t=this.manifest._xmlProcessor.selectSingleNode("ov:Label",e);return t!=g?this.getShortString(t):g},e.prototype.parseLabelRequired=function(e){var t=this.parseLabel(e);return C(t,"Label required"),t},e.prototype.parseRequiredSuperTip=function(e){var t=this.parseSuperTip(e);return C(t,"SuperTip required"),t},e.prototype.parseSuperTip=function(e){var t=this,n=g,r=t.manifest._xmlProcessor.selectSingleNode("ov:Supertip",e);if(r!=g){var a,o=r;C(r=t.manifest._xmlProcessor.selectSingleNode(l,o),"Title is necessary for SuperTip."),a=t.getShortString(r),C(r=t.manifest._xmlProcessor.selectSingleNode(s,o),"Description is necessary for SuperTip."),n={title:a,description:t.getLongString(r)}}return n},e.prototype.parseRequiredIcon=function(e){var t=this.parseIcon(e);return C(t,"Icon required"),t},e.prototype.parseIcon=function(e){var t=this.selectChildNodes(f,e,["ov:Icon"]),n=t.length;if(0==n)return g;for(var r={},a=0;a<n;a++){var o=t[a];r[o.getAttribute("size")]=this.getImageResource(o)}return r},e.prototype.parseMultipleChildControls=function(e,t,n){for(var r=[],a=0;a<t.childNodes.length;a++)-1!==e.indexOf(t.childNodes[a].nodeName)&&r.push(t.childNodes[a]);return this.parseControls(r,n)},e.prototype.parseChildControls=function(e,t,n){var r=this.manifest._xmlProcessor.selectNodes(e,t);return this.parseControls(r,n)},e.prototype.parseControls=function(e,t){for(var n=[],r=e.length,a=0;a<r;a++){var o=e[a];if(this.shouldParseNode(o)){var i=t(this,o);C(i,"parser must return a control."),n.push(i)}}return n},e.prototype.parseGroupUnderTab=function(e){var t;switch(e.nodeName){case i:t=new F,this.officeGroupCount++;break;default:t=new U}return t.parse(this,e),t},e.prototype.parseControlInGroup=function(t){var n,r=t.getAttribute(e.typeAttributeName);switch(r||t.nodeName!==v||(r=h),r){case"Menu":n=new P;break;case"Button":n=new R(r);break;case h:n=new w,this.officeControlCount++;break;default:throw new y("Unsupported control type.")}return n.parse(this,t),n},e.prototype.parseMenuItem=function(e){var t=new N;return t.parse(this,e),t},e.prototype.parseLocaleAwareSettingsAndGetValue=function(e){var t=this,n={},r=e.getAttribute("DefaultValue");n[t.manifest._defaultLocale]=r,n[t.manifest._defaultLocale.toLocaleLowerCase()]=r;var a=t.manifest._xmlProcessor.selectNodes("bt:Override",e);if(a)for(var o=a.length,i=0;i<o;i++){var s=(e=a[i]).getAttribute("Locale"),c=e.getAttribute("Value");n[s]=c,n[s.toLocaleLowerCase()]=c}return t.manifest._getDefaultValue(n)},e.prototype.selectSingleNode=function(e,t){if(t==g)return e;for(var n=0;n<t.length&&(e=this.manifest._xmlProcessor.selectSingleNode(t[n],e))!=g;n++);return e},e.prototype.selectChildNodes=function(e,t,n){return(t=this.selectSingleNode(t,n))==g?[]:this.manifest._xmlProcessor.selectNodes(e,t)},e.prototype.getSingleNodeValue=function(e,t){var n=this.manifest._xmlProcessor.selectSingleNode(e,t);return n?this.manifest._xmlProcessor.getNodeValue(n):""},e.prototype.getResourceByNode=function(e,t){var n=t.getAttribute(a),r=e[n];return C(r,"resid: "+n+" not found"),r},e.prototype.getImageResource=function(e){return this.getResourceByNode(this.resources.Images,e)},e.prototype.getUrlResource=function(e){return this.getResourceByNode(this.resources.Urls,e)},e.prototype.getLongString=function(e){return this.getResourceByNode(this.resources.LongStrings,e)},e.prototype.getShortString=function(e){return this.getResourceByNode(this.resources.ShortStrings,e)},e.typeAttributeName="xsi:type",e}();t.ParsingContext=S;var _=function(){function e(){}return e.buildControls=function(e,t){for(var n=t.length,r=0;r<n;r++){t[r].apply(e)}},e}(),O=function(e,t,n){var r=this;void 0===n&&(n=d),r.multipleCustomTabsEnabled=d,r.functionFile=e,r.builder=t,r.multipleCustomTabsEnabled=n},I=function(){function e(){}return e.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor,r=n.selectSingleNode(l,t);C(r,"Title is necessary for GetStarted."),this.title=e.getShortString(r);var a=n.selectSingleNode(s,t);C(a,"Description is necessary for GetStarted."),this.description=e.getLongString(a);var o=n.selectSingleNode("ov:LearnMoreUrl",t);this.learnMoreUrl=e.getUrlResource(o)},e}(),x=function(){function e(e){this.type=e}return e.prototype.buildAction=function(){},e.prototype.parse=function(){},e}(),T=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.buildAction=function(e){var t=this;return e.actionBuilder.buildShowTaskpane(t.sourceLocation,t.title,t.taskpaneId,t.sourceLocationResid)},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n);var o=t.manifest._xmlProcessor.selectSingleNode("ov:TaskpaneId",n);o!=g&&(r.taskpaneId=o.firstChild.nodeValue),(o=t.manifest._xmlProcessor.selectSingleNode("ov:SourceLocation ",n))!=g&&(r.sourceLocationResid=o.getAttribute(a)),(o=t.manifest._xmlProcessor.selectSingleNode(l,n))!=g&&(r.title=t.getShortString(o))},t}(function(e){function t(){e.apply(this,arguments),this.title=g}return c(t,e),t.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode(r,t);C(n,"SourceLocation is necessary for ShowTaskpane action"),this.sourceLocation=e.getUrlResource(n),e.manifest.addManifestUrl(this.sourceLocation)},t}(x)),E=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.buildAction=function(e){return C(e.functionFile,"Function file source url is necessary for ExecuteFunctionAction."),e.actionBuilder.buildCallFunction(e.functionFile,this.functionName,this.controlId)},t.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("ov:FunctionName",t);C(n,"FunctionName is necessary for ExecuteFunctionAction."),this.functionName=e.manifest._xmlProcessor.getNodeValue(n)},t}(x),M=function(){function e(){}return e.prototype.parse=function(e,t){this.id=e.parseIdRequired(t),this.label=e.parseLabelRequired(t)},e}(),P=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.apply=function(e){e.controlBuilder.startBuildMenu(this),_.buildControls(e,this.children),e.controlBuilder.endBuildMenu()},t.prototype.parse=function(t,n){var r=this;if(t.shouldParseNode(n)){e.prototype.parse.call(r,t,n),r.icon=t.parseRequiredIcon(n),r.superTip=t.parseRequiredSuperTip(n);var a=t.selectChildNodes("ov:Item",n,["ov:Items"]);r.children=t.parseControls(a,(function(e,t){return e.parseMenuItem(t)}))}},t}(M);t.MenuControl=P;var k=function(e){function t(t){e.call(this),this.enabled=u,this.controlType=t}return c(t,e),t.prototype.apply=function(e){var t=this,n=t.action.buildAction(e),r={id:t.id,label:t.label,icon:t.icon,superTip:t.superTip,actionType:t.actionType,action:n,enabled:t.enabled};t.applyControl(e,r)},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n),r.icon=r.parseIcon(t,n),r.superTip=t.parseRequiredSuperTip(n);var a=t.manifest._xmlProcessor.selectSingleNode("ov:Action",n);C(a,"Action is necessary for itemControl.");var o,i=a.getAttribute(S.typeAttributeName);switch(i){case"ShowTaskpane":o=new T(i);break;case"ExecuteFunction":(o=new E(i)).controlId=r.id;break;default:throw new y("Unsupported action type.")}o.parse(t,a),r.actionType=i,r.action=o;var s=t.manifest._xmlProcessor.selectSingleNode("ov:Enabled",n);s!=g&&(r.enabled=t.manifest._parseBooleanNode(s))},t.prototype.applyControl=function(){throw new b("Not implemented method applyControl for ItemControl.")},t.prototype.parseIcon=function(e,t){return e.parseIcon(t)},t}(M),R=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.applyControl=function(e,t){e.controlBuilder.addButton(t)},t.prototype.parseIcon=function(e,t){return e.parseRequiredIcon(t)},t}(k),N=function(e){function t(){e.call(this,"MenuItem")}return c(t,e),t.prototype.applyControl=function(e,t){e.controlBuilder.addMenuItem(t)},t}(k),w=function(e){function t(){var t=this;e.call(t,h),t.label=g,t.icon=g,t.superTip=g,t.actionType=g,t.action=g,t.enabled=u}return c(t,e),t.prototype.apply=function(e){var t=this,n={id:t.id,label:t.label,icon:t.icon,superTip:t.superTip,actionType:t.actionType,action:t.action,enabled:t.enabled};t.applyControl(e,n)},t.prototype.parse=function(e,t){var n=this;try{n.id=e.parseIdRequired(t)}catch(e){throw new y("Required id attribute missing for OfficeControl.")}if(o.RibbonControlIdMap&&o.RibbonControlIdMap[n.id])n.id=o.RibbonControlIdMap[n.id];else if(!o.OUtil.checkFlight(o.FlightNames.AddinRibbonIdAllowUnknown))throw new y("Unsupported control id for OfficeControl.")},t.prototype.applyControl=function(e,t){e.controlBuilder.addNativeControl(t)},t}(k),D=function(){function e(e){var t=this;t.label=g,t.isOfficeTab=d,t.visible=u,t.children=[],t.tabType="default",t.insertBefore="",t.insertAfter="",t.autoFocus=d,t.isOfficeTab=e}return e.prototype.apply=function(e){e.builder.ribbonBuilder.startBuildTab(this);for(var t=this.children.length,n=0;n<t;n++){this.children[n].apply(e)}e.builder.ribbonBuilder.endBuildTab()},e.prototype.parse=function(e,t){var r=this;r.id=e.parseIdRequired(t),r.isOfficeTab||(r.label=e.parseLabelRequired(t),o.Settings[n]&&(r.insertBefore=e.getSingleNodeValue("ov:InsertBefore",t),r.insertAfter=e.getSingleNodeValue("ov:InsertAfter",t),r.insertBefore&&("TabHome"===r.insertBefore&&(r.autoFocus=u),e.insertBefore=r.insertBefore),r.insertAfter&&(e.insertAfter=r.insertAfter))),o.Settings[n]?r.children=e.parseMultipleChildControls(["Group",i],t,(function(e,t){return e.parseGroupUnderTab(t)})):r.children=e.parseMultipleChildControls(["Group"],t,(function(e,t){return e.parseGroupUnderTab(t)}))},e}(),U=function(e){function t(){e.apply(this,arguments),this.groupType="Custom"}return c(t,e),t.prototype.parse=function(t,r){var a=this;t.shouldParseNode(r)&&(e.prototype.parse.call(a,t,r),a.icon=t.parseRequiredIcon(r),o.Settings[n]?a.children=t.parseMultipleChildControls(["Control",h],r,(function(e,t){return e.parseControlInGroup(t)})):a.children=t.parseMultipleChildControls(["Control"],r,(function(e,t){return e.parseControlInGroup(t)})))},t.prototype.apply=function(e){e.builder.ribbonBuilder.startBuildGroup(this),_.buildControls({functionFile:e.functionFile,actionBuilder:e.builder.actionBuilder,controlBuilder:e.builder.ribbonBuilder},this.children),e.builder.ribbonBuilder.endBuildGroup()},t}(M),F=function(e){function t(){var t=this;e.call(t),t.children=g,t.label=g,t.icon=g,t.groupType=i}return c(t,e),t.prototype.parse=function(e,t){var n=this;try{n.id=e.parseIdRequired(t)}catch(e){throw new y("Required id attribute missing for OfficeGroup.")}if(o.RibbonGroupIdMap&&o.RibbonGroupIdMap[n.id])n.id=o.RibbonGroupIdMap[n.id];else if(!o.OUtil.checkFlight(o.FlightNames.AddinRibbonIdAllowUnknown))throw new y("Unsupported id for OfficeGroup.")},t.prototype.apply=function(e){e.builder.ribbonBuilder.addNativeGroup(this)},t}(U),L=function(){function e(e){this.type=e,this.tabs=[]}return e.prototype.apply=function(e){if(this.type==e.builder.commandSurface)for(var t=this.tabs.length,n=0,r=0,a=0;a<t;a++){var i=this.tabs[a];if(o.OUtil.checkFlight(o.FlightNames.OSFTestFlight1001)){if(i.isOfficeTab&&n<1)n++;else{if(i.isOfficeTab||!(r<1||e.multipleCustomTabsEnabled))break;r++}i.apply(e)}else if(i.apply(e),!e.multipleCustomTabsEnabled)break}},e.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("ov:OfficeTab",t);n!=g&&((i=new D(u)).parse(e,n),this.tabs.push(i));var r=e.manifest._xmlProcessor.selectNodes("ov:CustomTab",t);if(r)for(var a=r.length,o=0;o<a;o++){var i;if((n=r[o])!=g)(i=new D(d)).parse(e,n),this.tabs.push(i)}otel&&otel.sendTelemetryEvent&&otel.sendTelemetryEvent({name:"Office.Online.Extensibility.Ribbon.OfficeGroupControlCount",dataFields:[{name:"OfficeControlCount",int64:e.officeControlCount},{name:"OfficeGroupCount",int64:e.officeGroupCount},{name:"InsertBefore",string:JSON.stringify(e.insertBefore)},{name:"InsertAfter",string:JSON.stringify(e.insertAfter)}]})},e}(),j=function(){function e(){}return e.prototype.parse=function(e,t){e.shouldParseNode(t)&&(this.id=e.parseIdRequired(t),this.children=e.parseChildControls("ov:Control",t,(function(e,t){return e.parseControlInGroup(t)})))},e.prototype.apply=function(e){e.controlBuilder.startBuildMenu({id:this.id,label:g,superTip:g}),_.buildControls(e,this.children),e.controlBuilder.endBuildMenu()},e}(),B=function(){function e(e){this.type=e}return e.prototype.apply=function(e){this.type==e.builder.commandSurface&&_.buildControls({functionFile:e.functionFile,actionBuilder:e.builder.actionBuilder,controlBuilder:e.builder.contextMenuBuilder},this.children)},e.prototype.parse=function(e,t){this.children=e.parseChildControls("ov:OfficeMenu",t,(function(e,t){var n=new j;return n.parse(e,t),n}))},e}(),H=function(){function e(e){this.type=e}return e.prototype.apply=function(){},e.prototype.parse=function(e,t){var n=this,r=e.manifest._xmlProcessor.selectSingleNode("ov:Namespace",t);r&&(n.namespaceResId=r.getAttribute(a));var o=e.manifest._xmlProcessor.selectSingleNode("ov:Script",t);if(o&&(n.scriptResId=n._parseSourceLocationResId(e,o)),!n.scriptResId)throw new y("Missing required <Script> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var i=e.manifest._xmlProcessor.selectSingleNode("ov:Page",t);if(i&&(n.pageResId=n._parseSourceLocationResId(e,i)),!n.pageResId)throw new y("Missing required <Page> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var s=e.manifest._xmlProcessor.selectSingleNode("ov:Metadata",t);if(s&&(n.metadataResId=n._parseSourceLocationResId(e,s)),!n.metadataResId)throw new y("Missing required <Metadata> element under element <ExtensionPoint xsi:type='CustomFunctions'>.")},e.prototype._parseSourceLocationResId=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode(r,t);if(n)return n.getAttribute(a)},e}();t.CustomFunctionsExtensionPoint=H;var V=function(){function t(){var e=this;e.getStartedNode=g,e.functionFile=g,e.functionFileResid=g,e.cacheableUrls=[],e.ExtensionPoints=[]}return t.prototype.cacheableResources=function(){return this.cacheableUrls},t.prototype.apply=function(t,n,r){var a=this;void 0===r&&(r=d);try{t.startApplyAddin({entitlement:a.extensionEntitlement,manifest:a.extensionManifest,startedNode:a.getStartedNode,overrides:{type:a.type,description:a.description}});for(var i=new O(a.functionFile,t,r),s=a.ExtensionPoints.length,c=0;c<s;c++){a.ExtensionPoints[c].apply(i)}t.endApplyAddin()}catch(t){throw t instanceof y&&n.setErrorMessageForAddin(a.extensionEntitlement.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),o.OUtil.checkFlight(o.FlightNames.ManifestParserDevConsoleLog)&&e.DevConsole.log(t),t}},t.prototype.parse=function(e,t){var n=this;n.type=t.getAttribute(S.typeAttributeName);var r=e.manifest._xmlProcessor.selectSingleNode(s,t);r!=g&&(n.description=e.getLongString(r));for(var o=e.selectChildNodes("ov:Host",t,["ov:Hosts"]),i=g,c=o.length,l=0;l<c;l++){var u=o[l];if(u.getAttribute(S.typeAttributeName)==e.hostType){(i=e.manifest._xmlProcessor.selectSingleNode("ov:"+e.formFactor,u))==g&&(i=e.manifest._xmlProcessor.selectSingleNode("ov:AllFormFactors",u));break}}var d=e.manifest._xmlProcessor.selectSingleNode("ov:GetStarted",i);d!=g&&(n.getStartedNode=new I,n.getStartedNode.parse(e,d)),(r=e.manifest._xmlProcessor.selectSingleNode("ov:FunctionFile",i))!=g&&(n.functionFileResid=r.getAttribute(a),n.functionFile=e.getUrlResource(r),e.manifest.addManifestUrl(n.functionFile));var f=e.manifest._xmlProcessor.selectNodes("ov:ExtensionPoint",i);c=f.length;for(l=0;l<c;l++){var p,m=f[l],h=m.getAttribute(S.typeAttributeName);switch(h){case"Events":throw"Not Implemented";case"PrimaryCommandSurface":p=new L(h);break;case"ContextMenu":p=new B(h);break;case"CustomFunctions":p=new H(h);break;default:throw new y("Unsupported extension type.")}p.parse(e,m),n.ExtensionPoints.push(p)}var v=e.resources.Images;for(var b in v)n.cacheableUrls.push(v[b]);n.extensionEntitlement=e.entitlement,n.extensionManifest=e.manifest},t}();t.VersionOverrides=V;var W=function(){function e(){}return e.prototype.cacheableResources=function(){return[]},e.prototype.apply=function(){},e}(),G=function(){function t(e,t){this.hostType=e,this.formFactor=t}return t.prototype.parseExtensions=function(t,n,r){try{var a=n._xmlProcessor.selectSingleNode(m),i=n._xmlProcessor.selectSingleNode(p,a);if(i==g)return new W;var s=new V;return s.parse(new S(this.hostType,this.formFactor,t,n),i),s}catch(n){throw n instanceof y&&r.setErrorMessageForAddin(t.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),o.OUtil.checkFlight(o.FlightNames.ManifestParserDevConsoleLog)&&e.DevConsole.log(n),n}},t}();t.AddinCommandsManifestParser=G}(e.Parser||(e.Parser={}))}(d||(d={})),function(e){!function(e){e.log=function(e){o.OUtil.getBooleanSetting("DevConsoleEnabled")}}(e.DevConsole||(e.DevConsole={}))}(d||(d={})),function(e){!function(e){var t,n="Button",r="MenuItem",a=!1,o="ShowTaskpane",i=null;!function(e){var t="LongString",n="ShortString";e[e.Image=0]="Image",e[e.Url=1]="Url",e[e[n]=2]=n,e[e[t]=3]=t}(t||(t={}));var s=function(e){this.name="AddinManifestError",this.message=this.name+": "+e};function l(e,t){if(void 0!==typeof e&&e===i)throw new s(t)}function u(e,t){if(void 0!==typeof e&&e===i&&""===e)throw new s(t)}var d=function(){function e(e,t,n,r,a,o){var i=this;i.hostType=e,i.formFactor=t,i.entitlement=n,i.manifest=r,i.ribbonData=a,i.runtimeId=o,i.actions=i.parseActions(a.actions),l(i.actions,"actions is required")}return e.prototype.parseActions=function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];if(r.id&&r.type){var a;switch(r.type){case o:(a=new p).parse(this,r);break;case"ExecuteFunction":(a=new m).parse(this,r);break;default:throw new s("Unknown action type")}a.runtimeId||(a.runtimeId=this.runtimeId),t[r.id]=a}}return t},e.prototype.parseIdRequired=function(e){var t=e.id?e.id:i;return u(t,"Id required"),t},e.prototype.parseLabelRequired=function(e){var t=this.parseLabel(e);return l(t,"Label required"),t},e.prototype.parseLabel=function(e){return e.label?e.label:i},e.prototype.parseSuperTipRequired=function(e){if(!e.superTip)throw new s("Supertip required");return this.parseSuperTip(e)},e.prototype.parseSuperTip=function(e){var t={title:"",description:""};return e.superTip&&(t.title=e.superTip.title?e.superTip.title:"",t.description=e.superTip.description?e.superTip.description:""),t},e.prototype.parseIconRequired=function(e){if(e.icon)return this.parseIcon(e);throw new s("Icon required")},e.prototype.parseIcon=function(e){var t={};if(e.icon)for(var n=0,r=e.icon;n<r.length;n++){var a=r[n];a.size&&a.sourceLocation&&(t[a.size]=a.sourceLocation)}return t},e.typeAttributeName="xsi:type",e}();e.ParsingContext=d;var f=function(){function e(){}return e.prototype.buildAction=function(){},e.prototype.parse=function(e,t){u(t.type,"Action type required."),this.type=t.type},e}(),p=function(e){function t(){var t=this;e.apply(t,arguments),t.type=o,t.title=i,t.supportsPinning=a}return c(t,e),t.prototype.buildAction=function(e){var t=this;return e.buildShowTaskpane(t.sourceLocation,t.title,t.taskpaneId,t.runtimeId)},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n),u(n.taskpaneId,"Taskpane ID required"),r.taskpaneId=n.taskpaneId,u(n.sourceLocation,"Source Location required"),r.sourceLocation=n.sourceLocation,l(n.title,"Title required"),r.title=n.title,n.supportPinning||(r.supportsPinning=n.supportPinning)},t}(f),m=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.buildAction=function(e){var t=this;return e.buildCallFunction(t.functionFile,t.functionName,t.controlId,t.id)},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.functionFile=n.functionFile,this.functionName=n.functionName},t}(f),g=function(){function e(){}return e.prototype.parse=function(e,t){this.id=e.parseIdRequired(t),this.label=e.parseLabelRequired(t)},e}(),h=function(e){function t(){e.call(this),this.enabled=!0}return c(t,e),t.prototype.apply=function(){},t.prototype.parse=function(t,o){var i=this;if(e.prototype.parse.call(i,t,o),i.icon=t.parseIconRequired(o),i.superTip=t.parseSuperTipRequired(o),i.enabled=!!o.enabled||a,o.type&&(i.controlType=o.type,o.type==r||o.type==n)){if(!(o.actionId&&o.actionId in t.actions))throw new s("Action is required");i.actionParsed=t.actions[o.actionId],i.actionType=t.actions[o.actionId].type,i.actionParsed.controlId=i.id}},t}(g),v=function(e){function t(){e.call(this),this.children=[],this.controlType="Menu"}return c(t,e),t.prototype.apply=function(t,n){e.prototype.apply.call(this,t,n),t.ribbonBuilder.startBuildMenu(this);for(var r=0,a=this.children;r<a.length;r++){a[r].apply(t,n)}t.ribbonBuilder.endBuildMenu()},t.prototype.parse=function(t,n){if(e.prototype.parse.call(this,t,n),!(n.items&&n.items instanceof Array))throw new s("Menu items required.");for(var r=0,a=n.items;r<a.length;r++){var o=a[r],i=new y;i.parse(t,o),this.children.push(i)}},t}(h);e.Menu=v;var y=function(e){function t(){e.call(this),this.controlType=r}return c(t,e),t.prototype.apply=function(t,n){var r=this;e.prototype.apply.call(r,t,n);var a=r.actionParsed.buildAction(t.actionBuilder),o={id:r.id,label:r.label,icon:r.icon,superTip:r.superTip,actionType:r.actionType,action:a,enabled:r.enabled};t.ribbonBuilder.addMenuItem(o)},t}(h),b=function(e){function t(){e.call(this),this.controlType=n}return c(t,e),t.prototype.apply=function(t,n){var r=this;e.prototype.apply.call(r,t,n);var a=r.actionParsed.buildAction(t.actionBuilder),o={id:r.id,label:r.label,icon:r.icon,superTip:r.superTip,actionType:r.actionType,action:a,enabled:r.enabled};t.ribbonBuilder.addButton(o)},t}(h),C=function(e){function t(){e.apply(this,arguments),this.children=[]}return c(t,e),t.prototype.parse=function(t,r){var a=this;e.prototype.parse.call(a,t,r),a.icon=t.parseIconRequired(r);for(var o=0,i=r.controls;o<i.length;o++){var c=i[o];switch(u(c.type,"Control type required."),c.type){case n:var l=new b;l.parse(t,c),a.children.push(l);break;case"Menu":var d=new v;d.parse(t,c),a.children.push(d);break;default:throw new s("Unknown control type.")}}},t.prototype.apply=function(e,t){e.ribbonBuilder.startBuildGroup(this);for(var n=0,r=this.children;n<r.length;n++){r[n].apply(e,t)}e.ribbonBuilder.endBuildGroup()},t}(g),A=function(){function e(){var e=this;e.label=i,e.isOfficeTab=a,e.visible=!0,e.children=[],e.tabType="contextual",e.insertBefore="",e.insertAfter=""}return e.prototype.apply=function(e,t){e.ribbonBuilder.startBuildTab(this);for(var n=0,r=this.children;n<r.length;n++){r[n].apply(e,t)}e.ribbonBuilder.endBuildTab()},e.prototype.parse=function(e,t){var n=this;n.id=t.id,n.visible=t.visible||a,n.label=e.parseLabelRequired(t);for(var r=0,o=t.groups;r<o.length;r++){var i=o[r],s=new C;s.parse(e,i),n.children.push(s)}},e}(),S=function(){function e(e,t,n){this.entitlement=t,this.manifest=n,this.tabs=e}return e.prototype.cacheableResources=function(){return[]},e.prototype.apply=function(e,t){var n={entitlement:this.entitlement,manifest:this.manifest,overrides:i,startedNode:i};e.startApplyAddin(n);for(var r=0,a=this.tabs;r<a.length;r++){a[r].apply(e,t)}e.endApplyAddin()},e}(),_=function(){function e(e,t){var n=this;n.hostType=e,n.formFactor=t,n.tabs=[],n.maxTabCount=20}return e.prototype.parse=function(e,t,n,r,a){var o=[];try{var i=new d(this.hostType,this.formFactor,e,t,n,a);i.parseActions(n.actions);for(var c=0,l=n.tabs.slice(0,this.maxTabCount);c<l.length;c++){var u=l[c],f=new A;f.parse(i,u),o.push(f)}}catch(t){throw t instanceof s&&r.setErrorMessageForAddin(e.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),t}return new S(o,e,t)},e}();e.AddinCommandsJsonParser=_}(e.JsonParser||(e.JsonParser={}))}(d||(d={})),function(e){var t=function(){function e(){}return e.createManifestForAddinAction=function(e,t,n,r){var a=null,i=new o.Manifest.ExtensionSettings,s=(o.FormFactor.Default,{}),c=e._UILocale.toLocaleLowerCase();s[c]=n,i._defaultHeight=a,i._defaultWidth=a,i._sourceLocations={},i._sourceLocations[c]=t;var l=e;return new o.Manifest.Manifest((function(e){e._xmlProcessor=l._xmlProcessor,e._displayNames=n!=a?s:l._displayNames,e._iconUrls=l._iconUrls,e._extensionSettings={formFactor:i},e._highResolutionIconUrls=l._highResolutionIconUrls,e._target=l._target,e._id=r!=a?r:l._id,e._version=l._version,e._providerName=l._providerName,e._idIssuer=l._idIssuer,e._alternateId=l._alternateId,e._defaultLocale=l._defaultLocale,e._signature=l._signature,e._capabilities=l._capabilities,e._hosts=l._hosts,e._descriptions=l._descriptions,e._appDomains=l._appDomains,e._permissions=l._permissions,e._requirements=l._requirements,e._webApplicationResource=l._webApplicationResource,e._webApplicationId=l._webApplicationId,e._webApplicationMsaId=l._webApplicationMsaId,e._webApplicationScopes=l._webApplicationScopes,e._webApplicationAuthorizations=l._webApplicationAuthorizations,e._ribbonExtensionControls=l._ribbonExtensionControls,e._equivalentAddins=l._equivalentAddins,e._versionOverrides=l._versionOverrides}),l._UILocale)},e.cacheManifestForAction=function(e,t,n){o.OsfManifestManager.cacheManifest(t,n,e)},e.purgeManifestForAction=function(e,t){o.OsfManifestManager.purgeManifest(e,t)},e}();e.AddinCommandsManifestManager=t}(d||(d={})),function(e){var t="##UILessContainer##",n=null;e.AddinActionContextMap={},e.AutoShowTaskPaneControlIdMap={};var r={},a={};!function(e){var t="ExclusiveForNew",n="ExclusiveForCur";e[e.Default=1]="Default",e[e[n]=2]=n,e[e[t]=3]=t}(e.CommandInvokeMode||(e.CommandInvokeMode={}));var i,s=e.CommandInvokeMode;!function(e){var t="ooeOperationNotSupported",n="ooeSuccess",r="ooeTimeout";e[e[r]=-1]=r,e[e[n]=0]=n,e[e[t]=5e3]=t}(i||(i={}));var c=function(){function s(e,t,n){this.contextProvider=e,this.manifest=n,this.entitlement=t}return s.prototype.buildShowTaskpane=function(e,t,n,r){return this.CreateManifestAndActivationContextForTaskpaneCommand(e,t,n,r)},s.prototype.buildCallFunction=function(e,t,n,r){return!t&&o.OUtil.checkFlight(o.FlightNames.UseActionIdForUILessCommand)?this.CreateManifestAndActivationContextForUILessCommand(e,r,n):this.CreateManifestAndActivationContextForUILessCommand(e,t,n)},s.prototype.CreateManifestAndActivationContextForTaskpaneCommand=function(e,t,a,o){var s=function(e,t){t==i.ooeSuccess&&a!=n&&(r[a]=e)},c=function(e,t){var a=r[e];if(a==n)return!1;var o=t.getOsfControl(a);return o!=n&&(o._sharedRuntimeId==n&&o._refresh(),!0)};return this.CreateManifestAndActivationContext(e,t,a,o,(function(e,t,r,o){a!=n&&c(a,t),e.showTaskpane(r,o,s)}))},s.prototype.CreateManifestAndActivationContext=function(t,r,i,s,c){var l=this,u=e.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,t,r,n);return function(r){var d=l.contextProvider.createActionContext(r,(function(a,d){var f=l.entitlement.assetId,p={assetId:f+(i||r),appVersion:l.entitlement.appVersion,storeId:l.entitlement.storeId,storeType:o.StoreType.InMemory,targetType:o.OsfControlTarget.TaskPane};u._inMemoryEToken=l.entitlement.eToken;var m=p.assetId,g=d==n?o.ManifestHostType.Workbook:o.getManifestHostType(d._hostType),h=r;if(d!=n){var v={ownerAssetId:f,controlId:r,originalControlId:""};d._notifyHost("0",o.AgaveHostAction.GetOriginalControlId,v),v.originalControlId!=n&&(h=v.originalControlId)}var y=n;o.OUtil.checkFlight(o.FlightNames.AddinActionDefinitionHybridMode)?t!=n?y=u.getSharedRuntimeForTaskpane(g,i||h):(y=u.getSharedRuntimeById(g,s),i=u.getTaskpaneIdByRuntimeId(g,s),p.assetId=f+i):y=u.getSharedRuntimeForTaskpane(g,i||h),y!=n&&y.Resid!=n&&y.Resid.length>0&&(m=o.OsfManifestManager.getSharedRuntimeManifestCacheKey(f,y.Resid)),e.AddinCommandsManifestManager.cacheManifestForAction(u,m,p.appVersion),c(a,d,p,u,i)}));e.AddinActionContextMap[r]=d,e.AutoShowTaskPaneControlIdMap[l.entitlement.assetId]==n&&"Office.AutoShowTaskpaneWithDocument"==i&&(e.AutoShowTaskPaneControlIdMap[l.entitlement.assetId]=r),s&&(a[l.entitlement.assetId]||(a[l.entitlement.assetId]={}),a[l.entitlement.assetId][s]||(a[l.entitlement.assetId][s]=r))}},s.prototype.CreateManifestAndActivationContextForUILessCommand=function(r,a,s){var c=this,l=function(e,t){if(t==i.ooeSuccess){var n={source:{id:s}};f.invokeAppCommand(e,a,n,(function(){}))}},u=e.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,r,n,n);return function(r){var a=c.contextProvider.createActionContext(r,(function(r,a){var s=c.entitlement.assetId,d={assetId:s+t,appVersion:c.entitlement.appVersion,storeId:c.entitlement.storeId,storeType:o.StoreType.InMemory,targetType:o.OsfControlTarget.TaskPane},p=d.assetId,m=a==n?o.ManifestHostType.Workbook:o.getManifestHostType(a._hostType),g=u.getSharedRuntimeForAppCmdsExecuteFunction(m);g!=n&&g.Resid!=n&&g.Resid.length>0&&(p=o.OsfManifestManager.getSharedRuntimeManifestCacheKey(s,g.Resid)),e.AddinCommandsManifestManager.cacheManifestForAction(u,p,d.appVersion),r.createUILessSandbox(d,u,(function(e,t){if(t==i.ooeSuccess)f.ensureOsfHostEntry(e,r);l(e,t)}))}));e.AddinActionContextMap[r]=a}},s}(),l=function(){function n(e,t){this.contextProvider=e,this.entitlement=t}return n.prototype.buildShowTaskpane=function(){var t=this;return function(n){delete e.AddinActionContextMap[n],e.AddinCommandsManifestManager.purgeManifestForAction(t.entitlement.assetId+n,t.entitlement.appVersion)}},n.prototype.buildCallFunction=function(){var n=this;return function(r){delete e.AddinActionContextMap[r],e.AddinCommandsManifestManager.purgeManifestForAction(n.entitlement.assetId+t,n.entitlement.appVersion)}},n}(),u=function(){function t(){}return t.createActionBuilder=function(e,t,n){return new c(e,t,n)},t.createDeleterActionBuilder=function(e,t){return new l(e,t)},t.bindAction=function(e,t){t(e)},t.retrieveActionContext=function(t){return e.AddinActionContextMap[t]},t.retrieveAutoShowTaskPaneControlIdMap=function(){return e.AutoShowTaskPaneControlIdMap},t.getTaskPaneControlIdFromAssetIdRuntimeId=function(e,t){return a[e]?a[e][t]:n},t}();e.DefaultControlActionBinder=u;var d=function(){function e(){this.invocationQueue={}}return e.prototype.invokeAppCommand=function(t,r,a,i,c){var l=this,u={dispid:o.DDA.EventDispId.dispidAppCommandInvokedEvent,controlId:l.osfControlId};u[0]=t,u[1]=r,u[2]=JSON.stringify(a),c=c||e.defaultTimeout;var d=a&&a.commandMode?a.commandMode:s.Default,f={args:u,onComplete:i,timeout:c,timeoutTimer:n},p=l.invocationQueue[r];p==n&&(p=[],l.invocationQueue[r]=p),!(d==s.ExclusiveForCur&&p.length>0)&&!(d==s.ExclusiveForNew&&p.length>1)&&p.push(f),1==p.length&&l.trySendInvocation(f)},e.prototype.invocationCompleted=function(e,t,r){var a=this,o=a;for(var i in a.invocationQueue){var s=a.invocationQueue[i],c=s[0];if(e==c.args[0]){if(s.length>1){s.splice(0,1);var l=s[0];window.setTimeout((function(){o.trySendInvocation(l)}),0)}else delete a.invocationQueue[i];return c.timeoutTimer!=n&&(window.clearTimeout(c.timeoutTimer),c.timeoutTimer=n),void c.onComplete(t,r)}}},e.prototype.sendInvocations=function(e){var t=this;if(t.eventHandler=e,e!=n)for(var r in t.invocationQueue){var a=t.invocationQueue[r][0];t.sendInvocation(e,a)}},e.prototype.trySendInvocation=function(e){var t=this.eventHandler;t!=n&&this.sendInvocation(t,e)},e.prototype.sendInvocation=function(e,t){var n=this,r=t.args;e(r),t.timeoutTimer=window.setTimeout((function(){n.invocationTimeout(r[0])}),t.timeout)},e.prototype.invocationTimeout=function(e){this.invocationCompleted(e,i.ooeTimeout,n)},e.prototype.disposeHost=function(){var e=this;for(var t in e.invocationQueue)return;e.host.disposeHost(e.osfControlId),e.onDisposed!=n&&e.onDisposed(e)},e.defaultTimeout=3e5,e}(),f=function(){var e="targetId",t="controlId",r="eventDispId";function a(){}return a.registerEvent=function(n,o,i){a.registerEventInternal(i[r],i[t],i[e],n,(function(e){o&&o(0==e)}))},a.unregisterEvent=function(n,o,i){a.unregisterEventInternal(i[r],i[t],i[e],n,(function(e){o&&o(0==e)}))},a.invokeAppCommand=function(e,t,n,r){var o=a.getOrCreateOsfHostEntry(e),i=a.getNextAppCommandId();o.invokeAppCommand(i,t,n,r)},a.invocationCompleted=function(e,t){var r=a.getOrCreateOsfHostEntry(e),o=t[0],i=t[1],s=t[2]?JSON.parse(t[2]):n;r.invocationCompleted(o,i,s)},a.ensureOsfHostEntry=function(e,t){var r=a.getOrCreateOsfHostEntry(e);return r.host==n&&(r.host=t),r},a.getNextAppCommandId=function(){return"AppCmd"+a._nextAppCommandId++},a.getOrCreateOsfHostEntry=function(e){var t=a._invocationQueues[e];return t==n&&((t=new d).osfControlId=e,t.onDisposed=function(e){delete a._invocationQueues[e.osfControlId]},a._invocationQueues[e]=t),t},a.registerEventInternal=function(e,t,n,r,s){switch(e){case o.DDA.EventDispId.dispidAppCommandInvokedEvent:var c=a.getOrCreateOsfHostEntry(t);return s(i.ooeSuccess),void c.sendInvocations(r)}s(i.ooeOperationNotSupported)},a.unregisterEventInternal=function(e,t,r,s,c){switch(e){case o.DDA.EventDispId.dispidAppCommandInvokedEvent:var l=a.getOrCreateOsfHostEntry(t);return l.eventHandler==s&&(l.eventHandler=n),void c(i.ooeSuccess)}c(i.ooeOperationNotSupported)},a._nextAppCommandId=0,a._invocationQueues={},a}();e.AddinCommandsRuntimeManager=f}(d||(d={})),o.ShowWindowDialogParameterKeys={Url:"url",Width:"width",Height:"height",DisplayInIframe:"displayInIframe",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen",EnforceAppDomain:"enforceAppDomain",UrlNoHostInfo:"urlNoHostInfo"},o.HostThemeButtonStyleKeys={ButtonBorderColor:"buttonBorderColor",ButtonBackgroundColor:"buttonBackgroundColor"},o.OmexPageParameterKeys={AppName:"client",AppVersion:"cv",AppUILocale:"ui",AppDomain:"appDomain",StoreLocator:"rs",AssetId:"assetid",NotificationType:"notificationType",AppCorrelationId:"corr",AuthType:"authType",AppId:"appid",Scopes:"scopes"},o.AuthType={Anonymous:0,MSA:1,OrgId:2,ADAL:3},o.OmexMessageKeys={MessageType:"messageType",MessageValue:"messageValue"},o.OmexRemoveAddinMessageKeys={RemoveAddinResultCode:"resultCode",RemoveAddinResultValue:"resultValue"},o.OmexRemoveAddinResultCode={Success:0,ClientError:400,ServerError:500,UnknownError:600},function(e){!function(e){var t="undefined",n="^https://[a-z0-9-]+.(officeapps.live|officeapps-df.live|partner.officewebapps).com/";function r(e){if(typeof JSON!==t)try{return JSON.stringify(e)}catch(e){}return""}function i(){try{var e=window.navigator.userAgent;return e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1||e.indexOf("Edge/")>-1}catch(e){return s("Error happens in isInternetExplorer.",e),!1}}function s(e,t){a.msAjaxDebug.trace(e+" Exception details: "+r(t))}e.parseAppContextFromWindowName=function(e,t){return o.OUtil.parseInfoFromWindowName(e,t,o.WindowNameItemKeys.AppContext)},e.serializeObjectToString=r,e.isHostTrusted=function(){return new RegExp(n).test(o.getClientEndPoint()._targetUrl.toLowerCase())},e.addHostInfoAsQueryParam=function(e,t){if(!e)return null;var n,r="#",a=(e=e.trim()||"").split(r),o=a.shift(),i=a.join(r),s=o.split("?");return s.length>1?n=o+"&_host_Info="+t:s.length>0&&(n=o+"?_host_Info="+t),i?[n,r,i].join(""):n},e.getDomainForUrl=function(e){if(!e)return null;var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host},e.shouldUseLocalStorageToPassMessage=function(){try{for(var e=["Windows NT 6.1","Windows NT 6.2","Windows NT 6.3","Windows NT 10.0"],t=window.navigator.userAgent,n=0,r=e.length;n<r;n++)if(t.indexOf(e[n])>-1)return i();return!1}catch(e){return s("Error happens in shouldUseLocalStorageToPassMessage.",e),!1}},e.isInternetExplorer=i,e.removeMatchesFromLocalStorage=function(e){for(var t=o.OUtil.getLocalStorage(),n=t.getKeysWithPrefix(""),r=0,a=n.length;r<a;r++)for(var i=n[r],s=0,c=e.length;s<c;s++)if(e[s].test(i)){t.removeItem(i);break}},e.logExceptionToBrowserConsole=s,e.isTeamsWebView=function(){var e=navigator.userAgent;return/Teams\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+)).* Electron\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+))/.test(e)},e.getHostSecure=function(e){if(typeof e!==t&&e){var n=void 0,r="https:";try{var a=new URL(e);if(a&&(n=a.host),!a.protocol)throw"fallback";if(a.protocol!==r)return}catch(t){try{var o=document.createElement("a");if(o.href=e,o.protocol!==r)return;var i=e.match(new RegExp("^https://[^/?#]+","i")),s=i&&1==i.length?i[0].toLowerCase():"",c=(o.protocol+"//"+o.hostname).toLowerCase();(o.protocol+"//"+o.host).toLowerCase()!==s&&c!=s||(n="443"==o.port?o.hostname:o.host)}catch(e){return}}return n?n.toLowerCase():void 0}};var c=function(){function e(){}return e.GatedCacheKeyPrefix="__OSF_GATED_OMEX.",e.AnonymousCacheKeyPrefix="__OSF_ANONYMOUS_OMEX.",e.UngatedCacheKeyPrefix="__OSF_OMEX.",e.ActivatedCacheKeyPrefix="__OSF_RUNTIME_.Activated.",e.AppinstallAuthenticated="appinstall_authenticated.",e.Entitlement="entitle.",e.AppState="appState.",e.AppDetails="appDetails.",e.AppInstallInfo="appInstallInfo.",e.AuthenticatedAppInstallInfoCacheKey=e.GatedCacheKeyPrefix+e.AppinstallAuthenticated+"{0}.{1}.{2}.{3}",e.EntitlementsKey=e.Entitlement+"{0}.{1}",e.AppStateCacheKey="{0}"+e.AppState+"{1}.{2}",e.AppDetailKey="{0}"+e.AppDetails+"{1}",e.AppInstallInfoKey="{0}"+e.AppInstallInfo+"{1}.{2}",e.ActivatedCacheKey=e.ActivatedCacheKeyPrefix+"{0}.{1}.{2}",e}();e.CacheConstants=c}(e.WACUtils||(e.WACUtils={}))}(d||(d={})),o.XmlConstants={MaxXmlSize:1048576,MaxElementDepth:64},o.Xpath3Provider=function(e,t){var n=this;n._xmldoc=(new DOMParser).parseFromString(e,"text/xml"),n._evaluator=new XPathEvaluator,n._namespaceMapping={},n._defaultNamespace=null;for(var r,a=t.split(" "),o=0;o<a.length;++o)(r=/xmlns="([^"]*)"/g.exec(a[o]))?n._defaultNamespace=r[1]:(r=/xmlns:([^=]*)="([^"]*)"/g.exec(a[o]))&&(n._namespaceMapping[r[1]]=r[2]);n._resolver=n},o.Xpath3Provider.prototype={lookupNamespaceURI:function(e){return this._namespaceMapping[e]||this._defaultNamespace},addNamespaceMapping:function(e,t){return!this._namespaceMapping[e]&&(this._namespaceMapping[e]=t,!0)},selectSingleNode:function(e,t){var n=(t?"./":"/")+e;t=t||this.getDocumentElement();var r=this._evaluator.evaluate(n,t,this._resolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null);return r?r.singleNodeValue:null},selectNodes:function(e,t){var n=(t?"./":"/")+e;t=t||this.getDocumentElement();var r=this._evaluator.evaluate(n,t,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),a=[];if(r)for(var o=r.iterateNext();o;)a.push(o),o=r.iterateNext();return a},selectNodesByXPath:function(e,t){var n=this._evaluator.evaluate(e,t,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=[];if(n)for(var a=n.iterateNext();a;)r.push(a),a=n.iterateNext();return r},getDocumentElement:function(){return this._xmldoc.documentElement}},o.IEXpathProvider=function(e,t){for(var n=null,r=["MSXML2.DOMDocument.6.0"],i=0;i<r.length;i++)try{(n=new ActiveXObject(r[i])).setProperty("ResolveExternals",!1),n.setProperty("ValidateOnParse",!1),n.setProperty("ProhibitDTD",!0),n.setProperty("MaxXMLSize",o.XmlConstants.MaxXmlSize),n.setProperty("MaxElementDepth",o.XmlConstants.MaxElementDepth),n.async=!1,n.loadXML(e),n.setProperty("SelectionLanguage","XPath"),n.setProperty("SelectionNamespaces",t);break}catch(e){a.msAjaxDebug.trace("xml doc creating error:"+e)}this._xmldoc=n},o.IEXpathProvider.prototype={selectSingleNode:function(e,t){var n=(t?"./":"/")+e;return(t=t||this.getDocumentElement()).selectSingleNode(n)},addNamespaceMapping:function(e,t){var n="SelectionNamespaces",r=this._xmldoc.getProperty(n),a="xmlns:"+e+"=",o="xmlns:"+e+'="'+t+'"';return-1==r.indexOf(a)&&(r=r+" "+o,this._xmldoc.setProperty(n,r),!0)},selectNodes:function(e,t){var n=(t?"./":"/")+e;return(t=t||this.getDocumentElement()).selectNodes(n)},selectNodesByXPath:function(e,t){return t.selectNodes(e)},getDocumentElement:function(){return this._xmldoc.documentElement},getActiveXObject:function(){return this._xmldoc}},o.DomParserProvider=function(e,t){var n=this;try{n._xmldoc=(new DOMParser).parseFromString(e,"text/xml")}catch(e){Sys.Debug.trace("xml doc creating error:"+e)}n._namespaceMapping={},n._defaultNamespace=null;for(var r,a=t.split(" "),o=0;o<a.length;++o)(r=/xmlns="([^"]*)"/g.exec(a[o]))?n._defaultNamespace=r[1]:(r=/xmlns:([^=]*)="([^"]*)"/g.exec(a[o]))&&(n._namespaceMapping[r[1]]=r[2])},o.DomParserProvider.prototype={addNamespaceMapping:function(e,t){return!this._namespaceMapping[e]&&(this._namespaceMapping[e]=t,!0)},selectSingleNode:function(e,t){var n=t||this._xmldoc,r=this._selectNodes(e,n);return 0===r.length?null:r[0]},selectNodes:function(e,t){var n=t||this._xmldoc;return this._selectNodes(e,n)},selectNodesByXPath:function(){return null},_selectNodes:function(e,t){var n=[];if(!e)return n;var r,o,i=e.split(":");if(1===i.length)r=null,o=i[0];else{if(2!==i.length)throw a.msAjaxError.argument("name");r=this._namespaceMapping[i[0]],o=i[1]}if(!t.hasChildNodes)return n;for(var s=t.childNodes,c=0;c<s.length;c++)o===this._removeNodePrefix(s[c].nodeName)&&r===s[c].namespaceURI&&n.push(s[c]);return n},_removeNodePrefix:function(e){var t=e.split(":");return 1===t.length?e:t[1]},getDocumentElement:function(){return this._xmldoc.documentElement}},o.XmlProcessor=function(e,t){var n=this,r=Function._validateParams(arguments,[{name:"xml",type:String,mayBeNull:!1},{name:"xmlNamespaces",type:String,mayBeNull:!1}]);if(r)throw r;document.implementation&&document.implementation.hasFeature("XPath","3.0")?n._provider=new o.Xpath3Provider(e,t):(n._provider=new o.IEXpathProvider(e,t),n._provider.getActiveXObject()||(n._provider=new o.DomParserProvider(e,t)))},o.XmlProcessor.prototype={addNamespaceMapping:function(e,t){var n=Function._validateParams(arguments,[{name:"namespacePrefix",type:String,mayBeNull:!1},{name:"namespaceUri",type:String,mayBeNull:!1}]);if(n)throw n;return this._provider.addNamespaceMapping(e,t)},selectSingleNode:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return this._provider.selectSingleNode(e,t)},selectNodes:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return this._provider.selectNodes(e,t)},selectNodesByXPath:function(e,t){var n=Function._validateParams(arguments,[{name:"xpath",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return t=t||this._provider.getDocumentElement(),this._provider.selectNodesByXPath(e,t)},getDocumentElement:function(){return this._provider.getDocumentElement()},getNodeValue:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.text?e.text:e.textContent},getNodeText:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return 9==this.getNodeType(e)?this.getNodeText(this.getDocumentElement()):e.text?e.text:e.textContent},setNodeText:function(e,t){var n=!1,r=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:n},{name:"text",type:String,mayBeNull:n}]);if(r)throw r;if(9==this.getNodeType(e))return n;try{e.text?e.text=t:e.textContent=t}catch(e){return n}return!0},getNodeXml:function(e){var t,n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(n)throw n;return e.xml?t=e.xml:(t=(new XMLSerializer).serializeToString(e),2==this.getNodeType(e)&&(t=this.getNodeBaseName(e)+'="'+t+'"')),t},setNodeXml:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"xml",type:String,mayBeNull:!1}]);if(n)throw n;var r=new o.XmlProcessor(t,"");if(!r.isValidXml())return null;var a=r.getDocumentElement();try{e.parentNode.replaceChild(a,e)}catch(e){return null}return a},getNodeNamespaceURI:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.namespaceURI},getNodePrefix:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.prefix},getNodeBaseName:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return!e.nodeType||1!=e.nodeType&&2!=e.nodeType?e.nodeName:e.baseName?e.baseName:e.localName},getNodeType:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.nodeType},appendChild:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"childXml",type:String,mayBeNull:!1}]);if(n)throw n;var r=new o.XmlProcessor(t,"");if(!r.isValidXml())return null;var a=r.getDocumentElement();return e.appendChild(a),a},_getAttributeLocalName:function(e){return e.localName?e.localName:e.baseName},readAttributes:function(e,t,n){var r=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"attributesToRead",type:Object,mayBeNull:!1},{name:"objectToFill",type:Object,mayBeNull:!1}]);if(r)throw r;for(var a,o,i=0;i<e.attributes.length;i++)for(var s in a=e.attributes[i],o=this._getAttributeLocalName(a),t)o===s&&(n[t[s]]=a.value)},isValidXml:function(){var e="parsererror";if(null==this.getDocumentElement())return!1;if(this._provider._xmldoc.getElementsByTagName(e).length>0){var t=(new DOMParser).parseFromString("<","text/xml").getElementsByTagName(e)[0].namespaceURI;return this._provider._xmldoc.getElementsByTagNameNS(t,e).length<=0}return!0}},function(e){var t=function(){function e(){}return e.prototype.Serialize=function(e){try{return JSON.stringify(e)}catch(e){return null}},e.prototype.Deserialize=function(e){try{return JSON.parse(e)}catch(e){return null}},e}();e.SafeSerializer=t;var n=function(){function e(e,t){this._localStorage=e,this._serializer=t}return e.prototype.GetCacheItem=function(t,n,r,a,o){var i="cacheExpired",s=this;void 0===n&&(n=!0),void 0===o&&(o=!0),s.ValidateCurrentCache();var c=s._localStorage.getItem(t);if(c){var l=s._serializer.Deserialize(c);if(void 0!==a&&a>0&&a-l.createdOn>0)s._localStorage.removeItem(t),r&&(r[i]=!0);else{if(!n)return l.data;var u=new Date;if(Math.abs(u.getTime()-l.createdOn)<e.msPerDay*l.refreshRate)return l.data;o&&(s._localStorage.removeItem(t),r&&(r[i]=!0))}}},e.prototype.SetCacheItem=function(t,n,r){r=r||e.defaultRefreshRateInDays;var a={data:n,createdOn:(new Date).getTime(),refreshRate:r};this._localStorage.setItem(t,this._serializer.Serialize(a))},e.prototype.RemoveCacheItem=function(e){this._localStorage.removeItem(e)},e.prototype.RemoveAll=function(e){for(var t=this._localStorage.getKeysWithPrefix(e),n=0,r=t.length;n<r;n++)this._localStorage.removeItem(t[n])},e.prototype.RemoveMatches=function(e){for(var t=this._localStorage.getKeysWithPrefix(""),n=0,r=t.length;n<r;n++)for(var a=t[n],o=0,i=e.length;o<i;o++)if(e[o].test(a)){this._localStorage.removeItem(a);break}},e.prototype.ValidateCurrentCache=function(){this._localStorage.getItem(e.cacheVersionKey)!=e.currentSchemaVersion&&(this.RemoveMatches([new RegExp("__OSF_(?!.*activated).*$","i")]),this._localStorage.setItem(e.cacheVersionKey,e.currentSchemaVersion))},e.defaultRefreshRateInDays=3,e.msPerDay=864e5,e.currentSchemaVersion="1",e.checkedCache=!1,e.cacheVersionKey="osfCacheVersion",e}();e.AppsDataCacheManager=n;var r=function(e){function t(t,n){e.call(this,t,n)}return c(t,e),t.prototype.GetRefreshToken=function(n,r){var a=o.OUtil.formatString(t._refreshTokenCacheKey,n,r);return e.prototype.GetCacheItem.call(this,a)},t.prototype.AddRefreshToken=function(n,r,a){var i=o.OUtil.formatString(t._refreshTokenCacheKey,r,a);e.prototype.SetCacheItem.call(this,i,n)},t.prototype.RemoveAll=function(){e.prototype.RemoveAll.call(this,t._refreshTokenCachePrefixKey)},t.prototype.RemoveRefreshToken=function(n,r){var a=o.OUtil.formatString(t._refreshTokenCacheKey,n,r);e.prototype.RemoveCacheItem.call(this,a)},t._refreshTokenCacheKey="_OSF_PRIVATECATALOG_REFRESHTOKEN_{0}_{1}",t._refreshTokenCachePrefixKey="_OSF_PRIVATECATALOG_REFRESHTOKEN",t}(n);e.TokenCacheManager=r}(d||(d={})),function(e){var t="Error",n="ResponseTime",r="Result",a="OperationMetadata",o="ErrorResult",i="AssetId",s="CorrelationId",l=!0,u=function(){function e(e){this._table=e,this._fields={}}return Object.defineProperty(e.prototype,"Fields",{get:function(){return this._fields},enumerable:l,configurable:l}),Object.defineProperty(e.prototype,"Table",{get:function(){return this._table},enumerable:l,configurable:l}),e.prototype.SerializeFields=function(){},e.prototype.SetSerializedField=function(e,t){null!=t&&(this._serializedFields[e]=t.toString())},e.prototype.SerializeRow=function(){var e=this;return e._serializedFields={},e.SetSerializedField("Table",e._table),e.SerializeFields(),JSON.stringify(e._serializedFields)},e}();e.BaseUsageData=u;var d=function(e){var t="Stage11Time",n="Stage10Time",r="Stage9Time",a="Stage8Time",u="Stage7Time",d="Stage6Time",f="Stage5Time",p="Stage4Time",m="Stage3Time",g="Stage2Time",h="Stage1Time",v="InstanceId",y="ActivationInfo",b="AppInfo";function C(){e.call(this,"AppLoadTime")}return c(C,e),Object.defineProperty(C.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,b,{get:function(){return this.Fields[b]},set:function(e){this.Fields[b]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,y,{get:function(){return this.Fields[y]},set:function(e){this.Fields[y]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,v,{get:function(){return this.Fields[v]},set:function(e){this.Fields[v]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,h,{get:function(){return this.Fields[h]},set:function(e){this.Fields[h]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,g,{get:function(){return this.Fields[g]},set:function(e){this.Fields[g]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,m,{get:function(){return this.Fields[m]},set:function(e){this.Fields[m]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,p,{get:function(){return this.Fields[p]},set:function(e){this.Fields[p]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,f,{get:function(){return this.Fields[f]},set:function(e){this.Fields[f]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,d,{get:function(){return this.Fields[d]},set:function(e){this.Fields[d]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,u,{get:function(){return this.Fields[u]},set:function(e){this.Fields[u]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),Object.defineProperty(C.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:l,configurable:l}),C.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(b,e.AppInfo),e.SetSerializedField(y,e.ActivationInfo),e.SetSerializedField(v,e.InstanceId),e.SetSerializedField(i,e.AssetId),e.SetSerializedField(h,e.Stage1Time),e.SetSerializedField(g,e.Stage2Time),e.SetSerializedField(m,e.Stage3Time),e.SetSerializedField(p,e.Stage4Time),e.SetSerializedField(f,e.Stage5Time),e.SetSerializedField(d,e.Stage6Time),e.SetSerializedField(u,e.Stage7Time),e.SetSerializedField(a,e.Stage8Time),e.SetSerializedField(r,e.Stage9Time),e.SetSerializedField(n,e.Stage10Time),e.SetSerializedField(t,e.Stage11Time),e.SetSerializedField(o,e.ErrorResult)},C}(u);e.AppLoadTimeUsageData=d;var f=function(e){var t="NotificationClickInfo";function n(){e.call(this,"AppNotification")}return c(n,e),Object.defineProperty(n.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:l,configurable:l}),Object.defineProperty(n.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:l,configurable:l}),Object.defineProperty(n.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),n.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(o,e.ErrorResult),e.SetSerializedField(t,e.NotificationClickInfo)},n}(u);e.AppNotificationUsageData=f;var p=function(e){function t(){e.call(this,"AppManagementMenu")}return c(t,e),Object.defineProperty(t.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:l,configurable:l}),Object.defineProperty(t.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:l,configurable:l}),Object.defineProperty(t.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:l,configurable:l}),t.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(i,e.AssetId),e.SetSerializedField(a,e.OperationMetadata),e.SetSerializedField(o,e.ErrorResult)},t}(u);e.AppManagementMenuUsageData=p;var m=function(e){var t="LastActiveTabCount",n="LastActiveTab",r="DialogState",a="TrustPageSessionTime",o="TotalSessionTime";function s(){e.call(this,"InsertionDialogSession")}return c(s,e),Object.defineProperty(s.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:l,configurable:l}),Object.defineProperty(s.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:l,configurable:l}),Object.defineProperty(s.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:l,configurable:l}),Object.defineProperty(s.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:l,configurable:l}),Object.defineProperty(s.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:l,configurable:l}),Object.defineProperty(s.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),s.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(i,e.AssetId),e.SetSerializedField(o,e.TotalSessionTime),e.SetSerializedField(a,e.TrustPageSessionTime),e.SetSerializedField(r,e.DialogState),e.SetSerializedField(n,e.LastActiveTab),e.SetSerializedField(t,e.LastActiveTabCount)},s}(u);e.InsertionDialogSessionUsageData=m;var g=function(e){function t(){e.call(this,"UploadFileDevCatelog")}return c(t,e),Object.defineProperty(t.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:l,configurable:l}),Object.defineProperty(t.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:l,configurable:l}),Object.defineProperty(t.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:l,configurable:l}),t.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(a,e.OperationMetadata),e.SetSerializedField(o,e.ErrorResult)},t}(u);e.UploadFileDevCatelogUsageData=g;var h=function(e){var t="AppSizeHeight",n="AppSizeWidth",r="IsAppCommand",a="AppTargetType",o="AppVersion",i="AppId",u="StoreType";function d(){e.call(this,"UploadFileDevCatalogUsage")}return c(d,e),Object.defineProperty(d.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:l,configurable:l}),Object.defineProperty(d.prototype,u,{get:function(){return this.Fields[u]},set:function(e){this.Fields[u]=e},enumerable:l,configurable:l}),Object.defineProperty(d.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:l,configurable:l}),Object.defineProperty(d.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:l,configurable:l}),Object.defineProperty(d.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:l,configurable:l}),Object.defineProperty(d.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:l,configurable:l}),Object.defineProperty(d.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:l,configurable:l}),Object.defineProperty(d.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),d.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(u,e.StoreType),e.SetSerializedField(i,e.AppId),e.SetSerializedField(o,e.AppVersion),e.SetSerializedField(a,e.AppTargetType),e.SetSerializedField(r,e.IsAppCommand),e.SetSerializedField(n,e.AppSizeWidth),e.SetSerializedField(t,e.AppSizeHeight)},d}(u);e.UploadFileDevCatalogUsageUsageData=h;var v=function(e){function a(){e.call(this,"OneDriveCatalogGetAccessToken")}return c(a,e),Object.defineProperty(a.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:l,configurable:l}),Object.defineProperty(a.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:l,configurable:l}),Object.defineProperty(a.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),a.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},a}(u);e.OneDriveCatalogGetAccessTokenUsageData=v;var y=function(e){function a(){e.call(this,"OneDriveCatalogGetManifests")}return c(a,e),Object.defineProperty(a.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:l,configurable:l}),Object.defineProperty(a.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:l,configurable:l}),Object.defineProperty(a.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),a.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},a}(u);e.OneDriveCatalogGetManifestsUsageData=y;var b=function(e){var a="id";function o(){e.call(this,"OneDriveCatalogGetManifest")}return c(o,e),Object.defineProperty(o.prototype,a,{get:function(){return this.Fields.id},set:function(e){this.Fields.id=e},enumerable:l,configurable:l}),Object.defineProperty(o.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:l,configurable:l}),Object.defineProperty(o.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:l,configurable:l}),Object.defineProperty(o.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),o.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(a,e.id),e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},o}(u);e.OneDriveCatalogGetManifestUsageData=b;var C=function(e){function a(){e.call(this,"OneDriveCatalogInsertManifest")}return c(a,e),Object.defineProperty(a.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:l,configurable:l}),Object.defineProperty(a.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:l,configurable:l}),Object.defineProperty(a.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),a.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},a}(u);e.OneDriveCatalogInsertManifestUsageData=C}(i||(i={})),function(e){var t=null;!function(e){var t="verboseEx",n="unexpected";e[e[n]=10]=n,e[e.warning=15]="warning",e[e.info=50]="info",e[e.verbose=100]="verbose",e[e[t]=200]=t}(e.ULSTraceLevel||(e.ULSTraceLevel={}));var n=e.ULSTraceLevel;!function(e){var t="msoulscat_Osf_UploadFileDevCatalogUsage",n="msoulscat_Osf_UploadFileDevCatelog",r="msoulscat_Osf_InsertionDialogSession",a="msoulscat_Osf_AppManagementMenu",o="msoulscat_Osf_Runtime",i="msoulscat_Osf_Notification",s="msoulscat_Osf_Latency";e[e[s]=1401]=s,e[e[i]=1402]=i,e[e[o]=1403]=o,e[e[a]=1404]=a,e[e[r]=1405]=r,e[e[n]=1406]=n,e[e[t]=1411]=t}(e.ULSCat||(e.ULSCat={}));var r,a,s=e.ULSCat;!function(e){var t="IsAnonymous",n="InsertionDialogClosed",r="ConfirmationDialogCancel";e[e[r]=256]=r,e[e[n]=512]=n,e[e[t]=1024]=t}(r||(r={})),function(e){var t="TrustPageVisited",n="Canceled",r="Inserted",a="Undefined";e[e[a]=0]=a,e[e[r]=1]=r,e[e[n]=2]=n,e[e.Closed=3]="Closed",e[e[t]=8]=t}(a||(a={}));var c=function(){function e(){this.timeValue=0}return e.prototype.Start=function(){this.timeValue=-(new Date).getTime(),this.finishedMeasurement=!1},e.prototype.Stop=function(){this.timeValue<0&&(this.timeValue+=(new Date).getTime(),this.finishedMeasurement=!0)},Object.defineProperty(e.prototype,"Finished",{get:function(){return this.finishedMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){var e=this.timeValue;return!this.Finished&&e<0&&(e=Math.abs(e)-(new Date).getTime()),e},enumerable:!0,configurable:!0}),e}();e.LatencyStopwatch=c;var l=function(){};e.Context=l;var u=function(){function e(){}return e.SendULSTraceTag=function(e,t,n,r){Microsoft.Office.WebExtension.FULSSupported&&Diag.UULS.trace(r,e,t,n)},e}(),d=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){u.SendULSTraceTag(e.category,e.level,t.SerializeRow(),6062431)},e.category=s.msoulscat_Osf_Notification,e.level=n.info,e}();e.NotificationLogger=d;var f=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){u.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085957)},e.category=s.msoulscat_Osf_AppManagementMenu,e.level=n.info,e}();e.AppManagementMenuLogger=f;var p=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){u.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085958)},e.category=s.msoulscat_Osf_UploadFileDevCatelog,e.level=n.info,e}();e.UploadFileDevCatelogLogger=p;var m=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){u.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17834653)},e.category=s.msoulscat_Osf_UploadFileDevCatalogUsage,e.level=n.info,e}();e.UploadFileDevCatalogUsageLogger=m;var g=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){u.SendULSTraceTag(e.category,e.level,t.SerializeRow(),4748055)},e.category=s.msoulscat_Osf_Latency,e.level=n.info,e}();e.LatencyLogger=g;var h=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){u.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085959)},e.category=s.msoulscat_Osf_InsertionDialogSession,e.level=n.info,e}();e.InsertionDialogSessionLogger=h;var v=function(){function e(){}return e.LogNotification=function(e,t,n){var r=new i.AppNotificationUsageData;r.CorrelationId=e,r.ErrorResult=t,r.NotificationClickInfo=n,d.Instance().LogData(r)},e}();e.AppNotificationHelper=v;var y=function(){function e(){}return e.LogAppManagementMenuAction=function(e,t,n,a,o,s){var c=new i.AppManagementMenuUsageData,l=0===e.toLowerCase().indexOf("wa")?parseInt(e.substring(2),10):parseInt(e,10);a&&(t|=r.InsertionDialogClosed),o&&(t|=r.IsAnonymous),c.AssetId=l,c.OperationMetadata=t,c.ErrorResult=s,f.Instance().LogData(c)},e}();e.AppManagementMenuHelper=y;var b=function(){function e(){}return e.LogUploadFileDevCatelogAction=function(e,t,n,r,a,o){var s=new i.UploadFileDevCatelogUsageData;s.CorrelationId=e,s.OperationMetadata=t,s.ErrorResult=o,p.Instance().LogData(s)},e}();e.UploadFileDevCatelogHelper=b;var C=function(){function e(){}return e.LogUploadFileDevCatalogUsageAction=function(e,t,n,r,a,o,s,c){var l=new i.UploadFileDevCatalogUsageUsageData;l.CorrelationId=e,l.StoreType=t,l.AppId=n,l.AppVersion=r,l.AppTargetType=a,l.IsAppCommand=o,l.AppSizeWidth=s,l.AppSizeHeight=c,m.Instance().LogData(l)},e}();e.UploadFileDevCatalogUsageHelper=C;var A=function(){var e="Stage11Time",r="Stage10Time",a="Stage9Time",o="Stage8Time",l="Stage7Time",d="Stage5Time",f="Stage4Time",p="Stage2Time",m="Stage1Time";function h(){}return h.GenerateActivationMessage=function(e,n){var r="";return e!=t&&(r+="ActivationRuntimeType: "+e.toString()+"|"),n!=t&&(r+="CorrelationId: "+n),r},h.ActivationStart=function(t,g,v,y,b,C){h.activatingNumber++,t.LoadTime=new i.AppLoadTimeUsageData,t.Timers={},t.LoadTime.CorrelationId=y,t.LoadTime.AppInfo=g,t.LoadTime.ActivationInfo=0,t.LoadTime.InstanceId=b,t.LoadTime.AssetId=v,t.LoadTime.Stage1Time=0,t.Timers[m]=new c,t.LoadTime.Stage2Time=0,t.Timers[p]=new c,t.LoadTime.Stage3Time=0,t.LoadTime.Stage4Time=0,t.Timers[f]=new c,t.LoadTime.Stage5Time=0,t.Timers[d]=new c,t.LoadTime.Stage6Time=h.activatingNumber,t.LoadTime.Stage7Time=0,t.Timers[l]=new c,t.LoadTime.Stage8Time=0,t.Timers[o]=new c,t.LoadTime.Stage9Time=0,t.Timers[a]=new c,t.LoadTime.Stage10Time=0,t.Timers[r]=new c,t.LoadTime.Stage11Time=0,t.Timers[e]=new c,t.LoadTime.ErrorResult=0,t.ActivationRuntimeType=C,h.StartStopwatch(t,m),u.SendULSTraceTag(s.msoulscat_Osf_Runtime,n.info,h.GenerateActivationMessage(C,y),19515419)},h.ActivationEnd=function(e){h.ActivateEndInternal(e)},h.PageStart=function(e){h.StartStopwatch(e,p)},h.PageLoaded=function(e){h.StopStopwatch(e,p)},h.ServerCallStart=function(e){h.StartStopwatch(e,f)},h.ServerCallEnd=function(e){h.StopStopwatch(e,f)},h.AuthenticationStart=function(e){h.StartStopwatch(e,d)},h.AuthenticationEnd=function(e){h.StopStopwatch(e,d)},h.EntitlementCheckStart=function(e){h.StartStopwatch(e,l)},h.EntitlementCheckEnd=function(e){h.StopStopwatch(e,l)},h.KilledAppsCheckStart=function(e){h.StartStopwatch(e,o)},h.KilledAppsCheckEnd=function(e){h.StopStopwatch(e,o)},h.AppStateCheckStart=function(e){h.StartStopwatch(e,a)},h.AppStateCheckEnd=function(e){h.StopStopwatch(e,a)},h.ManifestRequestStart=function(e){h.StartStopwatch(e,r)},h.ManifestRequestEnd=function(e){h.StopStopwatch(e,r)},h.OfficeJSStartToLoad=function(t){h.StartStopwatch(t,e)},h.OfficeJSLoaded=function(t){h.StopStopwatch(t,e)},h.SetAnonymousFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,0)},h.SetRetryCount=function(e,t){h.SetActivationInfoField(e,t,3,2)},h.SetManifestTrustCachedFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,5)},h.SetManifestDataCachedFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,7)},h.SetOmexHasEntitlementFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,9)},h.SetManifestDataInvalidFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,11)},h.SetAppStateDataCachedFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,13)},h.SetAppStateDataInvalidFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,15)},h.SetActivationRuntimeType=function(e,t){h.SetActivationInfoField(e,t,2,17)},h.SetErrorResult=function(e,t){e.LoadTime&&(e.LoadTime.ErrorResult=t,h.ActivateEndInternal(e))},h.SetBit=function(e,t,n,r){h.SetActivationInfoField(e,t,r||2,n)},h.StartStopwatch=function(e,t){e.LoadTime&&e.Timers&&e.Timers[t]&&(e.Timers[t].Start(),h.UpdateActivatingNumber(e))},h.StopStopwatch=function(e,t){e.LoadTime&&e.Timers&&e.Timers[t]&&(e.Timers[t].Stop(),h.UpdateActivatingNumber(e))},h.ConvertFlagToBit=function(e){return e?2:1},h.SetActivationInfoField=function(e,t,n,r){e.LoadTime&&(h.UpdateActivatingNumber(e),e.LoadTime.ActivationInfo=h.SetBitField(e.LoadTime.ActivationInfo,t,n,r))},h.SetBitField=function(e,t,n,r){return e&~(Math.pow(2,n)-1<<r)|t<<r},h.UpdateActivatingNumber=function(e){e.LoadTime&&(e.LoadTime.Stage6Time=e.LoadTime.Stage6Time>h.activatingNumber?e.LoadTime.Stage6Time:h.activatingNumber)},h.ActivateEndInternal=function(e){if(e.LoadTime){if(h.StopStopwatch(e,m),e.Timers)for(var r in e.Timers)e.Timers[r].ElapsedTime!=t&&(e.LoadTime[r]=e.Timers[r].ElapsedTime);u.SendULSTraceTag(s.msoulscat_Osf_Runtime,n.info,h.GenerateActivationMessage(e.ActivationRuntimeType,e.LoadTime.CorrelationId),19515420),g.Instance().LogData(e.LoadTime),e.LoadTime=t,h.activatingNumber--}},h.activatingNumber=0,h}();e.AppLoadTimeHelper=A;var S=function(){var e=" AppCorrelationId:";function r(){}return r.LogProxyFailure=function(e,a,i){var s;e==t&&(e=""),s=o.OUtil.formatString("appCorrelationId:{0}, methodName:{1}",e,a),Object.keys(i).forEach((function(e){var n=i[e];n!=t&&(n=n.toString()),s+=", "+e+":"+n})),u.SendULSTraceTag(r.category,n.warning,s,6062432)},r.LogExceptionTag=function(a,o,i,s){var c=a;o&&(o.name&&(c+=" Exception name:"+o.name+"."),o.paramName&&(c+=" Param name:"+o.paramName+"."),o.message&&(c+=" Message:"+o.message+"."),o.stack&&(c+=" [Stack:"+o.stack+"]")),i!=t&&(c+=e+i+"."),u.SendULSTraceTag(r.category,n.warning,c,s)},r.LogCommonMessageTag=function(a,o,i){o!=t&&(a+=e+o+"."),u.SendULSTraceTag(r.category,n.info,a,i)},r.category=s.msoulscat_Osf_Runtime,r}();e.RuntimeTelemetryHelper=S;var _=function(){function e(){}return e.LogInsertionDialogSession=function(e,t,n,r,o,s){var c=new i.InsertionDialogSessionUsageData,l=0===e.toLowerCase().indexOf("wa")?parseInt(e.substring(2),10):parseInt(e,10),u=a.Undefined;u|=r?a.Inserted:a.Canceled,n>0&&(u|=a.TrustPageVisited),c.AssetId=l,c.TotalSessionTime=t,c.TrustPageSessionTime=n,c.DialogState=u,c.LastActiveTab=o,c.LastActiveTabCount=s,h.Instance().LogData(c)},e}();e.InsertionDialogSessionHelper=_}(s||(s={})),function(e){var t,n=!0,r=!1,a=null,i=function(){function e(){this.m_osfControlId=a,this.m_isControlReady=r,this.m_queue=[]}return Object.defineProperty(e.prototype,"osfControlId",{get:function(){return this.m_osfControlId},set:function(e){this.m_osfControlId=e},enumerable:n,configurable:n}),Object.defineProperty(e.prototype,"isControlReady",{get:function(){return this.m_isControlReady},set:function(e){this.m_isControlReady=e},enumerable:n,configurable:n}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.m_queue.length},enumerable:n,configurable:n}),e.prototype.queueAction=function(e,t){var n={eventData:e,actionSender:t};this.m_queue.push(n)},e.prototype.sendActions=function(){var e=this;return new Promise((function(t){window.setTimeout((function(){for(;e.m_queue.length>0;){var n=e.m_queue[0];e.m_queue.splice(0,1),e.sendAction(n)}t()}),0)}))},e.prototype.sendAction=function(e){var t=e.eventData,n=e.actionSender;t&&n&&this.m_isControlReady&&n(this.m_osfControlId,t)},e}();!function(e){e[e.Unknown=0]="Unknown",e[e.Host=1]="Host",e[e.Addin=2]="Addin"}(t||(t={}));var c=function(){var c="The Otel isn't available, couldn't call sendOtelEvent for logging the shortcuts telemetry",l="function",u="object",d="Failed to disptach the shortcut key",f="Error: Invalid Parameter";function p(){}return p.init=function(){return p.s_usedShortcutAddins={},e.ActionMetadataManager.init(n)},p.tryDispatchShortcutKeyDeprecated=function(t,o,i){try{if(!i)throw f;var c=e.ActionMetadataManager.getActionFromShortcutKey(t,o);return c&&c.addinId&&c.actionId?(i(c.addinId,c.actionId),setTimeout((function(){p.sendShortcutUsageTelemetry(c.addinId)}),0),n):r}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag(d,e,a,0),r}},p.isConflictFound=function(e,t){return e&&t.length>0||!e&&t.length>1},p.tryDispatchShortcutKey=function(i,c,l,u,m,g){try{if(!u)throw f;if(!m)throw f;var h=e.ActionMetadataManager.getShortcutInfoArrayFromShortcutKey(i,c);return h&&0!==h.length?!l&&1===h.length&&h[0].addinId&&h[0].actionId?(u(h[0].addinId,h[0].actionId),setTimeout((function(){p.sendShortcutUsageTelemetry(h[0].addinId)}),0),n):p.isConflictFound(!!l,h)?("undefined"!=typeof Common&&Common.App&&Common.App.AppsForOffice&&Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper?Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().getAddinShortcutsPreferenceSetting().then((function(d){if(d){var f=JSON.parse(d);if(f[c.toString()]){var v=f[c.toString()][i.toString()];if(v){for(var y=r,b=0;b<h.length;b++)if(v.addinId==h[b].addinId){y=n;break}if(y)return void(v.ownerType==t.Addin?u(v.addinId,v.action):m());s.RuntimeTelemetryHelper.LogCommonMessageTag("Action owner do not exist",a,0)}}}var C=[];l&&C.push({addinId:a,addinName:a,action:a,actionDescription:l,ownerType:t.Host});for(b=0;b<h.length;b++){var A=new o.AddinIdInfo(h[b].addinId),S=o.OsfManifestManager.getCachedManifest(A.getSolutionId(),A.getSolutionVersion());S?C.push({addinId:h[b].addinId,addinName:S._displayNames[S._UILocale.toLowerCase()],action:h[b].actionId,actionDescription:h[b].actionId,ownerType:t.Addin}):s.RuntimeTelemetryHelper.LogCommonMessageTag("manifest for "+h[b].addinId+" is not cached",a,0)}var _={modifiers:i,keyCode:c,shortcutText:e.ShortcutsMappingTableManager.getShortcutText(i,c,p.getPlatformName()),shortcutDisplayInfoArray:C};g(_).then((function(e){e>=0&&_.shortcutDisplayInfoArray[e]&&p.enableShortcutKey(_.shortcutDisplayInfoArray[e].ownerType,_.shortcutDisplayInfoArray[e].addinId,_.shortcutDisplayInfoArray[e].action,i,c).then((function(){_.shortcutDisplayInfoArray[e].ownerType==t.Addin?u(_.shortcutDisplayInfoArray[e].addinId,_.shortcutDisplayInfoArray[e].action):m()})),setTimeout((function(){p.sendShortcutConflictInfoTelemetry(_,e)}),0)}))})):s.RuntimeTelemetryHelper.LogCommonMessageTag("AddinShortcutsPreferenceSettingHelper isn't ready",a,0),n):r:r}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag(d,e,a,0),r}},p.enableShortcutKey=function(e,t,n,r,a){return Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().saveAddinShortcutsPreferenceSetting(e,t,n,r,a)},p.sendQueuedActions=function(e){var t=p.getOrCreateAddinActionQueue(e);t&&(t.isControlReady=n,t.sendActions())},p.queueOrSendActionIfControlReady=function(e,t,n){var r=p.getOrCreateAddinActionQueue(e);r.isControlReady?r.isEmpty?n(e,t):(r.queueAction(t,n),r.sendActions()):r.queueAction(t,n)},p.getOrCreateAddinActionQueue=function(e){var t=p.s_actionQueues[e];return t||((t=new i).osfControlId=e,p.s_actionQueues[e]=t),t},p.sendShortcutUsageTelemetry=function(t){if(!p.s_usedShortcutAddins[t]){p.s_usedShortcutAddins[t]=n;var r=t.split("|");if(!r[1]||!r[4])return void s.RuntimeTelemetryHelper.LogCommonMessageTag("Couldn't get solutionid or storetype from the addinid",a,0);if(typeof Otel===u&&typeof Otel.Telemetry===u&&typeof Otel.Telemetry.sendOtelEvent===l){var o={otelEvent:{eventName:"Office.Extensibility.Shortcuts.RuntimeInfo",dataFields:[{name:"shortcutBeingUsed",dataType:0,value:n},{name:"solutionId",dataType:1,value:r[1]},{name:"storeType",dataType:1,value:r[4]}],telemetryProperties:e.TelemetryProperties}};Otel.Telemetry.sendOtelEvent(o)}else s.RuntimeTelemetryHelper.LogCommonMessageTag(c,a,0)}},p.sendShortcutConflictInfoTelemetry=function(r,o){var i;typeof Otel===u&&typeof Otel.Telemetry===u&&typeof Otel.Telemetry.sendOtelEvent===l?i={otelEvent:{eventName:"Office.Extensibility.Shortcuts.ConflictInfo",dataFields:[{name:"FConflictWithExcel",dataType:0,value:r.shortcutDisplayInfoArray[0].ownerType==t.Host},{name:"ConflictVectorSize",dataType:2,value:r.shortcutDisplayInfoArray.length}],telemetryProperties:e.TelemetryProperties}}:s.RuntimeTelemetryHelper.LogCommonMessageTag(c,a,0),o>=0?i&&(i.otelEvent.dataFields.push({name:"ExcelHostShortcutGotOverride",dataType:0,value:r.shortcutDisplayInfoArray[0].ownerType==t.Host&&r.shortcutDisplayInfoArray[o].ownerType!=t.Host}),Otel.Telemetry.sendOtelEvent(i)):i&&(i.otelEvent.dataFields.push({name:"UserCanceledConflictUI",dataType:0,value:n}),Otel.Telemetry.sendOtelEvent(i))},p.getPlatformName=function(){var t=navigator.userAgent;return t.indexOf("Windows")>=0||t.indexOf("SunOS")>=0||t.indexOf("Linux")>=0?e.ShortcutsMappingTableManager.s_shortcutPlatformWin32:t.indexOf("Macintosh")>=0||t.indexOf("Mac OS X")>=0?e.ShortcutsMappingTableManager.s_shortcutPlatformMac:(s.RuntimeTelemetryHelper.LogCommonMessageTag("Unknown platform or operating system",a,0),a)},p.s_usedShortcutAddins={},p.s_actionQueues={},p}();e.ShortcutKeyDispatchManager=c}(d||(d={}));var l='xmlns="urn:schemas-microsoft-com:office:office" xmlns:o="urn:schemas-microsoft-com:office:office"';o.AppVersion={access:"ZAC150",excel:"ZXL150",excelwebapp:"WAE160",outlook:"ZOL150",outlookwebapp:"MOW150",powerpoint:"ZPP151",powerpointwebapp:"WAP160",project:"ZPJ150",word:"ZWD150",wordwebapp:"WAW160",onenotewebapp:"WAO160",visio:"ZVO161",visiowebapp:"WAV161"},o.AppSubType={Taskpane:1,Content:2,Contextual:3,Dictionary:4},o.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2};o.HostSpecificFileVersionDefault="16.00",o.HostSpecificFileVersionMap={access:{web:"16.00"},agavito:{winrt:"16.00"},excel:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},onenote:{android:"16.00",web:"16.00",win32:"16.00",winrt:"16.00"},outlook:{ios:"16.00",mac:"16.00",web:"16.01",win32:"16.02"},powerpoint:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},project:{win32:"16.00"},sway:{web:"16.00"},word:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},visio:{web:"16.00",win32:"16.00"}},o.HostType={Excel:"Excel",Outlook:"Outlook",Access:"Access",PowerPoint:"PowerPoint",Word:"Word",Sway:"Sway",OneNote:"OneNote",Visio:"Visio"},o.ManifestHostType={Workbook:"Workbook",Document:"Document",Presentation:"Presentation",Notebook:"Notebook",Mailbox:"Mailbox",Drawing:"Drawing"},o.HostPlatform={Web:"Web"},o.getAppVerCode=function(e){var t,n="Invalid appName.";switch(e){case o.AppName.ExcelWebApp:t="excel.exe";break;case o.AppName.AccessWebApp:t="ZAC";break;case o.AppName.PowerpointWebApp:t="WAP";break;case o.AppName.WordWebApp:t="WAW";break;case o.AppName.OneNoteWebApp:t="WAO";break;case o.AppName.VisioWebApp:t="WAV";break;default:throw a.msAjaxDebug.trace(n),n}return t},o.getModernAppVerCode=function(e){var t,n="Invalid appName.";switch(e){case o.AppName.ExcelWebApp:t="WAC_Excel";break;case o.AppName.PowerpointWebApp:t="WAC_PowerPoint";break;case o.AppName.WordWebApp:t="WAC_Word";break;case o.AppName.OneNoteWebApp:t="WAC_OneNote";break;case o.AppName.OutlookWebApp:t="WAC_Outlook";break;case o.AppName.VisioWebApp:t="WAC_Visio";break;default:throw a.msAjaxDebug.trace(n),n}return t},o.getManifestHostType=function(e){var t;switch(e){case o.HostType.Excel:t=o.ManifestHostType.Workbook;break;case o.HostType.Word:t=o.ManifestHostType.Document;break;case o.HostType.PowerPoint:t=o.ManifestHostType.Presentation;break;case o.HostType.OneNote:t=o.ManifestHostType.Notebook;break;case o.HostType.Outlook:t=o.ManifestHostType.Mailbox;break;case o.HostType.Visio:t=o.ManifestHostType.Drawing;break;default:throw a.msAjaxDebug.trace("Invalid host type."),"Invalid hostType."}return t},o.Capability={Mailbox:"Mailbox",Document:"Document",Workbook:"Workbook",Project:"Project",Presentation:"Presentation",Database:"Database",Sway:"Sway",Notebook:"Notebook",Drawing:"Drawing"},o.HostCapability={Excel:o.Capability.Workbook,Outlook:o.Capability.Mailbox,Access:o.Capability.Database,PowerPoint:o.Capability.Presentation,Word:o.Capability.Document,Sway:o.Capability.Sway,OneNote:o.Capability.Notebook,Visio:o.Capability.Drawing},o.OsfControlTarget={Undefined:-1,InContent:0,TaskPane:1,Contextual:2},o.OsfControlPermission={Restricted:1,ReadDocument:2,WriteDocument:4,ReadItem:32,ReadWriteMailbox:64,ReadAllDocument:131,ReadWriteDocument:135},o.OsfControlStatus={NotActivated:1,Activated:2,AppStoreNotReachable:3,InvalidOsfControl:4,UnsupportedStore:5,UnknownStore:6,ActivationFailed:7,NotSandBoxSupported:8},o.OsfControlPageStatus={NotStarted:1,Loading:2,Ready:3,FailedHandleRequest:4,FailedOriginCheck:5,FailedPermissionCheck:6},o.StoreType={OMEX:"omex",SPCatalog:"spcatalog",SPApp:"spapp",Exchange:"exchange",FileSystem:"filesystem",Registry:"registry",InMemory:"inmemory",OneDrive:"onedrive",PrivateCatalog:"excatalog",HardCodedPreinstall:"hardcodedpreinstall",FirstParty:"firstparty",UploadFileDevCatalog:"uploadfiledevcatalog",Sdx:"sdxcatalog",WopiCatalog:"wopicatalog"},o.StoreTypeEnum={MarketPlace:0,Catalog:1,SPApp:2,Exchange:3,FileSystem:4,Registry:5,OneDrive:9,PrivateCatalog:10,HardCodedPreinstall:11,FirstParty:12,Sdx:14,UploadFileDevCatalog:15,WopiCatalog:16},o.ManifestIdIssuer={Microsoft:"Microsoft",Custom:"Custom"},o.OmexClientAppStatus={OK:1,UnknownAssetId:2,KilledAsset:3,NoEntitlement:4,DownloadsExceeded:5,Expired:6,Invalid:7,Revoked:8,ServerError:9,BadRequest:10,LimitedTrial:11,TrialNotSupported:12,EntitlementDeactivated:13,VersionMismatch:14,VersionNotSupported:15,UserIsMinor:16},o.OmexState={Killed:0,OK:1,Withdrawn:2,Flagged:3,DeveloperWithdrawn:4},o.OmexTrialType={None:0,Office:1,External:2},o.OmexEntitlementType={Free:"free",Trial:"trial",Paid:"paid"},o.OmexAuthNStatus={NotAttempted:-1,CheckFailed:0,Authenticated:1,Anonymous:2,Unknown:3},o.OmexRemoveAppStatus={Failed:0,Success:1},o.OfficeAppType={ContentApp:o.OsfControlTarget.InContent,TaskPaneApp:o.OsfControlTarget.TaskPane,MailApp:o.OsfControlTarget.Contextual},o.FormFactor={Default:"DefaultSettings",Desktop:"DesktopSettings",Tablet:"TabletSettings",Phone:"PhoneSettings"},o.OsfOfficeExtensionManagerPerfMarker={GetEntitlementStart:"Agave.OfficeExtensionManager.GetEntitlementStart",GetEntitlementEnd:"Agave.OfficeExtensionManager.GetEntitlementEnd"},o.OsfControlActivationPerfMarker={ActivationStart:"Agave.AgaveActivationStart",ActivationEnd:"Agave.AgaveActivationEnd",DeactivationStart:"Agave.AgaveDeactivationStart",DeactivationEnd:"Agave.AgaveDeactivationEnd",SelectionTimeout:"Agave.AgaveSelectionTimeout"},o.NotificationUxPerfMarker={RenderLoadingAnimationStart:"Agave.NotificationUx.RenderLoadingAnimationStart",RenderLoadingAnimationEnd:"Agave.NotificationUx.RenderLoadingAnimationEnd",RemoveLoadingAnimationStart:"Agave.NotificationUx.RemoveLoadingAnimationStart",RemoveLoadingAnimationEnd:"Agave.NotificationUx.RemoveLoadingAnimationEnd",RenderStage1Start:"Agave.NotificationUx.RenderStage1Start",RenderStage1End:"Agave.NotificationUx.RenderStage1End",RemoveStage1Start:"Agave.NotificationUx.RemoveStage1Start",RemoveStage1End:"Agave.NotificationUx.RemoveStage1End",RenderStage2Start:"Agave.NotificationUx.RenderStage2Start",RenderStage2End:"Agave.NotificationUx.RenderStage2End",RemoveStage2Start:"Agave.NotificationUx.RemoveStage2Start",RemoveStage2End:"Agave.NotificationUx.RemoveStage2End"},o.ProxyCallStatusCode={Succeeded:1,Failed:0,ProxyNotReady:-1},o.UpnCheckCode={NotSet:0,Match:1,NotMatch:2},o.HostFrameTrustState={NotInitialized:0,NotImplemented:1,NotReady:2,Exempted:3,NotTrusted:4,Trusted:5},o.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2},o.SQMDataPoints={DATAID_APPSFOROFFICEUSAGE:10595,DATAID_APPSFOROFFICENOTIFICATIONS:10942},o.BWsaStreamTypes={Static:1},o.BWsaConfig={defaultMaxStreamRows:1e3},o.ErrorStatusCodes={E_OEM_EXTENSION_NOT_ENTITLED:2147758662,E_MANIFEST_SERVER_UNAVAILABLE:2147758672,E_USER_NOT_SIGNED_IN:2147758677,E_MANIFEST_DOES_NOT_EXIST:2147758673,E_OEM_EXTENSION_KILLED:2147758660,E_OEM_OMEX_EXTENSION_KILLED:2147758686,E_MANIFEST_UPDATE_AVAILABLE:2147758681,S_OEM_EXTENSION_TRIAL_MODE:275013,E_OEM_EXTENSION_WITHDRAWN_FROM_SALE:2147758690,E_TOKEN_EXPIRED:2147758675,E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED:2147757992,E_MANIFEST_REFERENCE_INVALID:2147758678,S_USER_CLICKED_BUY:274205,E_MANIFEST_INVALID_VALUE_FORMAT:2147758654,E_TRUSTCENTER_MOE_UNACTIVATED:2147757996,S_OEM_EXTENSION_FLAGGED:275040,S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE:275041,E_BROWSER_VERSION:2147758194,E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR:-2147209295,E_PRIVACY_SERVICE_DISABLED_ADMIN:2147758792,WAC_AgaveUnsupportedStoreType:1041,WAC_AgaveActivationError:1042,WAC_ActivateAttempLoading:1043,WAC_HTML5IframeSandboxNotSupport:1044,WAC_AgaveRequirementsErrorOmex:1045,WAC_AgaveRequirementsError:1046,WAC_AgaveOriginCheckError:1047,WAC_AgavePermissionCheckError:1048,WAC_AgaveHostHandleRequestError:1049,WAC_AgaveUnknownClientAppStatus:1050,WAC_AgaveAnonymousProxyCreationError:1051,WAC_AgaveOsfControlActivationError:1052,WAC_AgaveEntitlementRequestFailure:1053,WAC_AgaveManifestRequestFailure:1054,WAC_AgaveManifestAndEtokenRequestFailure:1055,WAC_FirstPartyAddInListRequestFailure:1056,WAC_SDX_DMSRequestFailed:1058,WAC_SDX_AssetIdNotInDMSResponse:1059,WAC_CustomFunctionsRegistrationError:1060,WAC_WopiHostCheckStatusNotTrusted:1061,WAC_WopiHostCheckStatusNotReady:1062,WAC_AgaveIRMBlockError:1063},o.InvokeResultCode={S_OK:0,E_REQUEST_TIME_OUT:-2147471590,E_USER_NOT_SIGNED_IN:-2147208619,E_CATALOG_ACCESS_DENIED:-2147471591,E_CATALOG_REQUEST_FAILED:-2147471589,E_OEM_NO_NETWORK_CONNECTION:-2147208640,E_PROVIDER_NOT_REGISTERED:-2147208617,E_OEM_CACHE_SHUTDOWN:-2147208637,E_OEM_REMOVED_FAILED:-2147209421,E_CATALOG_NO_APPS:-1,E_GENERIC_ERROR:-1e3,S_HIDE_PROVIDER:10},o.OmexClientNames=function(){var e={},t=o.AppName;return e[t.ExcelWebApp]="WAC_Excel",e[t.WordWebApp]="WAC_Word",e[t.OutlookWebApp]="WAC_Outlook",e[t.AccessWebApp]="WAC_Access",e[t.PowerpointWebApp]="WAC_Powerpoint",e[t.OneNoteWebApp]="WAC_OneNote",e[t.VisioWebApp]="WAC_Visio",e}(),o.OmexAppVersions=function(){var e={},t=o.AppName;return e[t.ExcelWebApp]=o.AppVersion.excelwebapp,e[t.WordWebApp]=o.AppVersion.wordwebapp,e[t.OutlookWebApp]=o.AppVersion.outlookwebapp,e[t.AccessWebApp]=o.AppVersion.access,e[t.PowerpointWebApp]=o.AppVersion.powerpointwebapp,e[t.OneNoteWebApp]=o.AppVersion.onenotewebapp,e[t.VisioWebApp]=o.AppVersion.visiowebapp,e}(),o.ActivationTypes={V1Enabled:0,V1S2SEnabled:1,V2Enabled:2,V2S2SEnabled:3},o.ManifestRequestTypes={Manifest:1,Etoken:2,Both:3},o.HostInfoFlags={None:0,SharedApp:1,CustomFunction:2,ProtectedDocDisable:4,ExperimentJsEnabled:8},o.MaxAppContextLength=10240,o.HostFeatureGateFlags={None:0,Enable3rdPartySetAppContextInIFrameName:2},o.SdxAssetIds={Ideas:"fa000000029",ExperimentationSdx:"fa000000059"},o.ExtendedManifestSupportTokens={Requirements:"RequirementsToken",Locale:"LocaleToken",TokenReplaceRegex:"\\$\\{token\\.(\\w+)\\}"},function(e){var t=null,n=function(){function n(){}return n.versionLessThan=function(e,t){return o.OsfManifestManager.versionLessThan(e,t)},n.ParseManifest=function(e,n,r){try{return new o.Manifest.Manifest(e,n)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest:",e,r,20306078),t}},n.constructAddInId=function(t,n,r,a){return e.MsAjaxString.format("{0}|{1}|{2}|{3}|{4}|||","2",t,n,this.GetStoreTypeId(r).toString(),a)},n.GetStoreTypeId=function(e){return e==o.StoreType.OMEX?o.StoreTypeEnum.MarketPlace:e==o.StoreType.SPCatalog?o.StoreTypeEnum.Catalog:e==o.StoreType.SPApp?o.StoreTypeEnum.SPApp:e==o.StoreType.Exchange?o.StoreTypeEnum.Exchange:e==o.StoreType.FileSystem?o.StoreTypeEnum.FileSystem:e==o.StoreType.Registry?o.StoreTypeEnum.Registry:e==o.StoreType.OneDrive?o.StoreTypeEnum.OneDrive:e==o.StoreType.PrivateCatalog?o.StoreTypeEnum.PrivateCatalog:e==o.StoreType.HardCodedPreinstall?o.StoreTypeEnum.HardCodedPreinstall:e==o.StoreType.FirstParty?o.StoreTypeEnum.FirstParty:e==o.StoreType.UploadFileDevCatalog?o.StoreTypeEnum.UploadFileDevCatalog:e==o.StoreType.WopiCatalog?o.StoreTypeEnum.WopiCatalog:-1},n.GetStoreTypeName=function(e){var n=parseInt(e);return n==o.StoreTypeEnum.MarketPlace?o.StoreType.OMEX:n==o.StoreTypeEnum.Catalog?o.StoreType.SPCatalog:n==o.StoreTypeEnum.SPApp?o.StoreType.SPApp:n==o.StoreTypeEnum.Exchange?o.StoreType.Exchange:n==o.StoreTypeEnum.FileSystem?o.StoreType.FileSystem:n==o.StoreTypeEnum.Registry?o.StoreType.Registry:n==o.StoreTypeEnum.OneDrive?o.StoreType.OneDrive:n==o.StoreTypeEnum.PrivateCatalog?o.StoreType.PrivateCatalog:n==o.StoreTypeEnum.HardCodedPreinstall?o.StoreType.HardCodedPreinstall:n==o.StoreTypeEnum.FirstParty?o.StoreType.FirstParty:n==o.StoreTypeEnum.UploadFileDevCatalog?o.StoreType.UploadFileDevCatalog:n==o.StoreTypeEnum.WopiCatalog?o.StoreType.WopiCatalog:t},n}();e.ManifestUtil=n;var r=function(){function n(){}return n.failed=function(n,r,a){if(n.status!=e.DataServiceResultCode.Succeeded){var o={status:n.status,httpStatus:n.httpStatus};return a!=t&&(o.value=a),r(o),!0}return!1},n.retry=function(e,t){void 0===t&&(t={});var n=t.retries,r=void 0===n?3:n,a=t.factor,o=void 0===a?2:a,i=t.minTimeout,s=void 0===i?300:i,c=t.maxTimeout,l=void 0===c?1/0:c;return new Promise((function(t,n){var a=function(i){e().then(t,(function(e){i>=r?n(e):setTimeout((function(){return a(i+1)}),Math.min(s*Math.pow(o,i),l))}))};a(0)}))},n.limitRate=function(e,t){var n=[],r=-1/0,a=function(){var o=n.shift();n.length>0&&setTimeout(a,t),r=performance.now(),e.apply(void 0,o)};return function(){for(var e=[],o=0;o<arguments.length;o++)e[o-0]=arguments[o];0===n.length&&setTimeout(a,Math.max(0,t-(performance.now()-r))),n.push(e)}},n.withCache=function(e,t,r){var a="__OSF_AsyncCache_",o=t.forceUpdateCache,i=void 0!==o&&o,s=t.maxAgeInSecs,c=void 0===s?259200:s;if(!i&&n.Cache.hasOwnProperty(e))return Promise.resolve({cacheType:"memory",value:n.Cache[e]});var l=a+e,u="__OSF_AsyncCacheExpiry",d=Date.now();try{if(d>=n.NextCheckExpiry){var f=JSON.parse(localStorage.getItem(u))||{},p=!1;for(var m in n.NextCheckExpiry=1/0,f)d>f[m]?(localStorage.removeItem(a+m),delete f[m],p=!0):n.NextCheckExpiry=Math.min(n.NextCheckExpiry,f[m]);p&&localStorage.setItem(u,JSON.stringify(f))}if(!i&&localStorage.hasOwnProperty(l))return Promise.resolve({cacheType:"localStorage",value:localStorage.getItem(l)})}catch(e){}return r().then((function(t){n.Cache[e]=t;try{var r=JSON.parse(localStorage.getItem(u))||{};r[e]=d+1e3*c,n.NextCheckExpiry=Math.min(n.NextCheckExpiry,r[e]),localStorage.setItem(u,JSON.stringify(r)),localStorage.setItem(l,t)}catch(e){}return{cacheType:"none",value:t}}))},n.fetch=function(e,n){return void 0===n&&(n={}),new Promise((function(r,a){var o=new XMLHttpRequest,i=n.method,s=void 0===i?"GET":i,c=n.headers,l=void 0===c?{}:c,u=n.body,d=void 0===u?t:u;for(var f in o.onreadystatechange=function(){4==o.readyState&&r({ok:o.status>=200&&o.status<=299,status:o.status,statusText:o.statusText,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(JSON.parse(o.responseText))}})},o.onerror=a,o.open(s,e,!0),l)o.setRequestHeader(f,l[f]);o.send(d)}))},n.Cache={},n.NextCheckExpiry=0,n}();e.AsyncUtil=r;var a=function(){function e(){}return e.register=function(e,t){this._registry[e]=t},e.resolve=function(e,n){var r=this,a=r._resolved[e];if(a!=t)return a;if((n=n||r._hostInfo)!=t){var o=r._registry[e];if(o==t)return t;r._resolved[e]=a=o(n)}return a},e.setHostContext=function(e){this._hostInfo=e},e.getHostContext=function(){return this._hostInfo},e._registry={},e._resolved={},e}();e.CatalogFactory=a}(d||(d={})),function(e){var t=function(){function t(e){this._initParams=e}return t.prototype.getEntitlementAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed,httpStatus:403})},t.prototype.getAndCacheManifest=function(t,n,r,a){a({status:e.DataServiceResultCode.Failed,httpStatus:404})},t.prototype.activateAsync=function(t,n){var r=this;r._initParams&&r._initParams.loaderParams?r._initParams.controlStatus===o.OsfControlStatus.ActivationFailed?n.fail(r._initParams.loaderParams,r._initParams.controlStatus):n.notifyUser(r._initParams.loaderParams):n.fail(e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveActivationError_ERR,errorCode:o.ErrorStatusCodes.WAC_AgaveActivationError}),o.OsfControlStatus.ActivationFailed)},t.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed,httpStatus:403})},t.prototype.getAppDetails=function(t,n,r,a){a({status:e.DataServiceResultCode.Failed,httpStatus:403})},t}();e.ForbiddenCatalog=t}(d||(d={})),function(e){var t=function(){var e=null;function t(){}return t.defaultTitle=function(e){switch(e){case o.InfoType.Information:return Strings.OsfRuntime.L_AgaveInformationTitle_TXT;case o.InfoType.Error:return Strings.OsfRuntime.L_AgaveErrorTile_TXT;case o.InfoType.Warning:return Strings.OsfRuntime.L_AgaveWarningTitle_TXT}return Strings.OsfRuntime.L_AgaveInformationTitle_TXT},t.fillMissing=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?o.InfoType.Information:n.infoType,n.title=n.title||t.defaultTitle(n.infoType),n.buttonTxt=n.buttonTxt||Strings.OsfRuntime.L_OkButton_TXT,n.buttonCallback=n.buttonCallback||e,n.url=n.url||e,n.urlButtonTxt=n.urlButtonTxt||e,n.dismissCallback=n.dismissCallback||e,n.reDisplay=!n.dismissCallback,n.displayDeactive=n.displayDeactive==e||n.displayDeactive,n.detailView=n.detailView||!1,n.logAsError=n.logAsError||!1,n.highPriority=n.highPriority||!1,n.retryAll=n.retryAll||!1,n.errorCode=n.errorCode?n.errorCode:0,n},t.error=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?o.InfoType.Error:n.infoType,n.logAsError=n.logAsError==e||n.logAsError,t.fillMissing(n)},t.warning=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?o.InfoType.Warning:n.infoType,n.logAsError=n.logAsError==e||n.logAsError,t.fillMissing(n)},t.showNotification=function(e,n){e.notifyUser(t.fillMissing(n))},t.showError=function(e,n){e.notifyUser(t.error(n))},t.showWarning=function(e,n){e.notifyUser(t.warning(n))},t.failWithWarning=function(e,n,r){r=t.isNullOrUndefined(r)?o.OsfControlStatus.ActivationFailed:r,e.fail(t.warning(n),r)},t.failWithError=function(e,n,r){r=t.isNullOrUndefined(r)?o.OsfControlStatus.ActivationFailed:r,e.fail(t.error(n),r)},t.isNullOrUndefined=function(t){return t===e||void 0===t},t}();e.LoaderUtil=t}(d||(d={})),function(e){var t=function(){function t(e,t){this.osfControl=e,this.trusted=t}return t.prototype.getRequirementsChecker=function(){return this.osfControl._contextActivationMgr.getRequirementsChecker()},t.prototype.load=function(t,n){var r=null,a=this,i=a,s=performance.now();a.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted&&(a.osfControl._retryActivate=r,a.osfControl._contextActivationMgr.retryAll(t.entitlement.assetId)),a.osfControl._status!==o.OsfControlStatus.NotActivated&&a.osfControl.deActivate();var c=t.manifest,l=a.osfControl;if(l._etoken=t.eToken,l._manifest=c,l._sourceLocationOverrideUrl?l._iframeUrl=l._sourceLocationOverrideUrl:l._sourceLocationOverrideResourceId?l._iframeUrl=c.getSourceLocationOverrideByResourceId(l._sourceLocationOverrideResourceId):l._iframeUrl=c.getDefaultSourceLocation(l._contextActivationMgr.getFormFactor()),l._iframeUrl&&l.updateUrlsForSdx(t.manifestUrl),l._permission=c.getPermission(),l._appDomains=c.getAppDomains(),l.processManifestForCustomFunctions(c),c.getExtendedOverrides()&&l.processManifestForExtendedOverrides(c),n!=r&&(l._iframeUrl=n.decorateUrl(l._iframeUrl)),l.hostInfoFlags()&o.HostInfoFlags.ProtectedDocDisable&&!l.isFirstParty())e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveProtectedDocError_ERR,detailView:!0,errorCode:o.ErrorStatusCodes.WAC_AgaveIRMBlockError});else if(l._contextActivationMgr._doesUrlHaveSupportedProtocol(l._iframeUrl)){n!=r&&n.preLoad(l,l._contextActivationMgr);var u=c.getDefaultDisplayName();l._isAddinCommands((function(e){e?(l._isvirtualOsfControl=!0,l.invokeVirtualOsfControlActivationCallback(c)):(i.osfControl._sdxTelemetryContext.iframeCreateStart=performance.now(),l._createIframeAndActivateOsfControl(u),i.osfControl._sdxTelemetryContext.iframeCreateEnd=performance.now())})),t.entitlement!=r&&t.entitlement.storeType===o.StoreType.Sdx&&e.SDXCatalog.recordActivity("IframeCreate",s,!0,[{name:"OsfControlId",string:l._id},{name:"AssetId",string:t.entitlement.assetId}]),n!=r&&n.postLoad(l,l._contextActivationMgr)}else e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveManifestError_ERR,detailView:!0,errorCode:o.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT})},t.prototype.skipTrust=function(){var e=this;return e.osfControl._contextActivationMgr._autoTrusted||e.osfControl.getTrustNoPrompt()||e.osfControl._isOsfControlInEmbeddingMode(e.osfControl)},t.prototype.hasConsent=function(){return this.trusted||this.isInsertion()},t.prototype.isInsertion=function(){return this.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted},t.prototype.setRetryCall=function(e){this.osfControl._retryActivate=e},t.prototype.askForTrust=function(e,t){var n=this;this.osfControl._showTrustError(e.clientName,e.displayName,e.providerName,e.iconUrl,e.entitlement.storeType,(function(){n.restartActivation(),t()}),e.url,e.isSSOAddin)},t.prototype.askForUpgrade=function(e,t){var n=this;e.buttonCallback=function(){n.restartActivation(),t()},this.notifyUser(e)},t.prototype.fail=function(e,t){var n=this.osfControl;n._status=t,this.notifyUser(e),n._contextActivationMgr.raiseOsfControlStatusChange(n)},t.prototype.notifyUser=function(e){var t=this.osfControl;e.id=t._id,t._contextActivationMgr.displayNotification(e)},t.prototype.restartActivation=function(){this.osfControl._restartActivate()},t.prototype.isForCustomFunctionSandbox=function(){return this.osfControl.isCustomFunctionSandbox()},t.prototype.setIsUpgrading=function(e){this.osfControl.setIsUpgrading(e)},t.prototype.getIsUpgrading=function(){return this.osfControl.getIsUpgrading()},t.prototype.setUpgradingFailed=function(e){this.osfControl.setUpgradingFailed(e)},t}();e.OsfControlLoader=t}(d||(d={})),function(e){var t=function(){function e(e){this._requirementsChecker=e}return e.prototype.getRequirementsChecker=function(){return this._requirementsChecker},e.prototype.load=function(){},e.prototype.skipTrust=function(){return!1},e.prototype.hasConsent=function(){return!1},e.prototype.setRetryCall=function(){},e.prototype.askForTrust=function(){},e.prototype.askForUpgrade=function(){},e.prototype.fail=function(){},e.prototype.notifyUser=function(){},e.prototype.restartActivation=function(){},e.prototype.isForCustomFunctionSandbox=function(){return!1},e.prototype.setIsUpgrading=function(){},e.prototype.getIsUpgrading=function(){return!1},e.prototype.setUpgradingFailed=function(){},e}();e.PreCacher=t}(d||(d={})),function(e){var t=function(){var t=null;function n(){var e=this;e.isReady=!1,e.clientEndPoint=t,e.pendingCallbacks=[],e.iframe=t,e._pendingRequests={},e.conversationId=o.OUtil.generateConversationId()}return n.prototype.invokeProxyCommandAsync=function(n,r,a){var o=this,i=r||r.correlationId||"";this.prepareProxy((function(c){c.value!=t?o.invokeProxyMethodAsync(n,a,r):(s.RuntimeTelemetryHelper.LogExceptionTag("clientendpoint is invalid",t,i,18940552),a({status:e.DataServiceResultCode.ProxyNotReady}))}),(function(){s.RuntimeTelemetryHelper.LogExceptionTag("proxysetup failure",t,i,18940553),a({status:e.DataServiceResultCode.ProxyNotReady})}))},n.prototype.prepareProxy=function(){},n.prototype.doesUrlHaveSupportedProtocol=function(e){var n=!1;e&&(n=decodeURIComponent(e).match(/^https?:\/\/.+$/gi)!=t);return n},n.prototype.invokeProxyMethodAsync=function(n,r,a){var i,c=a||a.correlationId||"",l=[this.clientEndPoint._targetUrl,n];for(var u in a)("string"===(i=typeof a[u])||"number"===i||"boolean"===i)&&l.push(a[u]);var d=l.join("."),f=this._pendingRequests,p={onCompleted:r,methodName:n,correlationId:c},m=f[d];if(m)m.push(p);else{f[d]=[p];a||(a={}),a.officeVersion=o.Constants.ThreePartsFileVersion,this.clientEndPoint.invoke(n,(function(n,r){var a=t,o=0,i=e.DataServiceResultCode.Failed;0===n&&r.status&&(a=r.result,i=e.DataServiceResultCode.Succeeded);var c=f[d];delete f[d];for(var l=c.length,u=0;u<l;u++){var p=c.shift();try{r&&r.failureInfo&&(o=r.failureInfo.statusCode||t,r.failureInfo.result=r.result,s.RuntimeTelemetryHelper.LogProxyFailure(p.correlationId,p.methodName,r.failureInfo)),p.onCompleted({status:i,httpStatus:o,value:a})}catch(t){var m="invokeProxyMethodAsync failed";e.WACUtils.logExceptionToBrowserConsole(m,t),s.RuntimeTelemetryHelper.LogExceptionTag(m,t,p.correlationId,19015124)}}}),a)}},n}();e.ProxyBase=t}(d||(d={})),function(e){!function(e){var t="ManifestRequest",n="KilledAppsCheck",r="AppStateCheck",a="EntitlementCheck",o="Authentication",i="ServerCall",s="Activation";e[e[s]=0]=s,e[e[i]=1]=i,e[e[o]=2]=o,e[e[a]=3]=a,e[e[r]=4]=r,e[e[n]=5]=n,e[e[t]=6]=t}(e.Activity||(e.Activity={}));var t=e.Activity;!function(e){var t="DmsRequestCachedFlag",n="ManifestRequestType",r="ActivationRuntimeType",a="AppStateDataInvalidFlag",o="AppStateDataCachedFlag",i="ManifestDataInvalidFlag",s="OmexHasEntitlementFlag",c="ManifestDataCachedFlag",l="ManifestTrustCachedFlag",u="RetryCount",d="AnonymousFlag";e[e[d]=0]=d,e[e[u]=1]=u,e[e[l]=2]=l,e[e[c]=3]=c,e[e[s]=4]=s,e[e[i]=5]=i,e[e[o]=6]=o,e[e[a]=7]=a,e[e[r]=8]=r,e[e[n]=9]=n,e[e[t]=10]=t}(e.FlagName||(e.FlagName={}));var n=e.FlagName,r=function(){function r(e,t,n,r,a){var o=this;o.correlationId=e,o.perfContext=t,o.appInfo=n,o.assetId=r,o.instanceId=a}return r.prototype.startActivity=function(a){var i=this;switch(a){case t.Activation:var c=o.ActivationTypes.V2Enabled;return 0==(15&i.appInfo)&&e.S2SOmexCatalogService._requestHandler&&(c=o.ActivationTypes.V2S2SEnabled),s.AppLoadTimeHelper.ActivationStart(i.perfContext,i.appInfo,i.assetId,i.correlationId,i.instanceId,c),void i.setBits(n.ActivationRuntimeType,c)}s.AppLoadTimeHelper.StartStopwatch(i.perfContext,r.StopWatchName[a])},r.prototype.stopActivity=function(e){s.AppLoadTimeHelper.StopStopwatch(this.perfContext,r.StopWatchName[e])},r.prototype.setFlag=function(e,t){var n=t?2:1;this.setBits(e,n)},r.prototype.setBits=function(e,t){s.AppLoadTimeHelper.SetBit(this.perfContext,t,r.FlagOffsetMap[e],2)},r.FlagOffsetMap=[0,2,5,7,9,11,13,15,17,19,21],r.StopWatchName=["Stage1Time","Stage4Time","Stage5Time","Stage7Time","Stage9Time","Stage8Time","Stage10Time"],r}();e.ActivationTelemetryContext=r;var a=function(){function e(e){this.correlationId=e}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.AddinCommandsTelemetryContext=a;var i=function(){function e(e){this.correlationId=e}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.InsertDialogTelemetryContext=i;var c=function(){function e(){}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.SimpleTelemetryContext=c}(d||(d={})),function(e){var t=null,n=function(){var n=".";function r(n,r){void 0===r&&(r=t),this._initParam=n,this._cacheManager=r||new e.AppsDataCacheManager(o.OUtil.getLocalStorage(),new e.SafeSerializer)}return r.prototype.getEntitlementAsync=function(n,r,a){var i=this,s=i,c=[],l=[],u=n?i.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey():i.getUploadFileDevCatalogAddinsCacheKey(),d=i._cacheManager.GetCacheItem(u);d!=t&&(d.forEach((function(n){var r=s._cacheManager.GetCacheItem(s.getUploadFileDevCatalogManifestCacheKey(n));if(r!=t){var a=e.ManifestUtil.ParseManifest(r,s._initParam.appUILocale);if(a==t)return;var i={assetId:n,appVersion:a.getMarketplaceVersion(),storeId:"developer",storeType:o.StoreType.UploadFileDevCatalog,targetType:a.getTarget()};l.push(i),c.push(n)}})),c.length!=d.length&&(c.length>0?i._cacheManager.SetCacheItem(u,c):i._cacheManager.RemoveCacheItem(u))),a({status:e.DataServiceResultCode.Succeeded,value:l})},r.prototype.getAndCacheManifest=function(n,a,i,s){var c=this,l=o.OsfManifestManager.getCachedManifest(n.assetId,n.appVersion);if(l==t){var u=function(e,r,a){var o=c._cacheManager.GetCacheItem(c.getUploadFileDevCatalogManifestCacheKey(n.assetId));o==t&&e>=1?setTimeout((function(){return u(e-1,2*r,a)}),r):a(o)};u(r.GetManifestRetryLimit,r.GetManifestRetryWaitMs,(function(r){var a;r!=t&&(a=e.ManifestUtil.ParseManifest(r,c._initParam.appUILocale))!=t&&o.OsfManifestManager.cacheManifest(n.assetId,n.appVersion,a),s({status:a!=t?e.DataServiceResultCode.Succeeded:e.DataServiceResultCode.Failed,value:a})}))}else s({status:e.DataServiceResultCode.Succeeded,value:l})},r.prototype.activateAsync=function(n,r,a){var i=this;this.getAndCacheManifest(n,n.storeId,a,(function(s){if(s.status!=e.DataServiceResultCode.Succeeded)e.LoaderUtil.failWithError(r,{description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),i.activateAsync(n,r,a)},errorCode:o.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE});else{var c=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();if(c&&c.enableSingleSignOnForAddin&&!r.isForCustomFunctionSandbox())s.value;r.load({entitlement:n,eToken:"",manifest:s.value},t)}}))},r.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},r.prototype.getAppDetails=function(t,n,r,a){a({status:e.DataServiceResultCode.Failed})},r.prototype.validateAndCacheNewManifest=function(e,t,n,r){return!!this.validateAddinIdAndVersion(e,t)&&(this.cacheManifest(e,t,n,r),!0)},r.prototype.localCacheAddinCommands=function(e){this.cacheMyAddins(this.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey(),e)},r.prototype.validateAddinIdAndVersion=function(e,t){return r.idRegExp.test(e)&&r.versionRegExp.test(t)},r.prototype.cacheManifest=function(e,t,n,r){var a=this;o.OsfManifestManager.cacheManifest(e,t,r),a.cacheMyAddins(a.getUploadFileDevCatalogAddinsCacheKey(),e),a._cacheManager.SetCacheItem(a.getUploadFileDevCatalogManifestCacheKey(e),n)},r.prototype.cacheMyAddins=function(e,n){var r=this._cacheManager.GetCacheItem(e);r==t&&(r=[]),r.lastIndexOf(n)<0&&(r.push(n),this._cacheManager.SetCacheItem(e,r))},r.prototype.getUploadFileDevCatalogAddinsCacheKey=function(){return r.UploadFileCatalogCacheKey.myAddins+n+this._initParam.appName+n+this._initParam.userNameHashCode},r.prototype.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey=function(){return r.UploadFileCatalogCacheKey.addinCommandsMyAddins+n+this._initParam.appName+n+this._initParam.userNameHashCode},r.prototype.getUploadFileDevCatalogManifestCacheKey=function(e){return r.UploadFileCatalogCacheKey.manifest+n+this._initParam.appName+n+e},r.UploadFileCatalogCacheKeyPrefix="__OSF_UPLOADFILE.",r.UploadFileCatalogCacheKey={myAddins:r.UploadFileCatalogCacheKeyPrefix+"MyAddins",addinCommandsMyAddins:r.UploadFileCatalogCacheKeyPrefix+"AddinCommandsMyAddins",manifest:r.UploadFileCatalogCacheKeyPrefix+"Manifest"},r.idRegExp=new RegExp("[\\w-]+"),r.versionRegExp=new RegExp("(\\d{1,2}.)*\\d{1,2}"),r.GetManifestRetryLimit=4,r.GetManifestRetryWaitMs=500,r}();e.CatalogFactory.register(o.StoreType.UploadFileDevCatalog,(function(r){return r.enableUploadFileDevCatalog?new n({appName:r.appName,appUILocale:r.appUILocale,userNameHashCode:r.userNameHashCode}):new e.ForbiddenCatalog(t)}));var r=function(){var t="Should never here";function n(e,t){this._catalog=e,this._storeType=t}return n.prototype.validateAndCacheNewManifest=function(){throw t},n.prototype.getEntitlementsAsync=function(t,n,r,a){this._catalog.getEntitlementAsync(n,new e.AddinCommandsTelemetryContext(o.OUtil.Guid.generateNewGuid()),(function(e){a(e.value)}),!1,r)},n.prototype.getManifestAsync=function(){throw t},n.prototype.localCacheAddinCommands=function(e,t,n,r){this._storeType==o.StoreType.UploadFileDevCatalog&&this._catalog.localCacheAddinCommands(t,n,r)},n}(),a=function(){function n(){}return n.createAddinDataProvider=function(n){var a=e.CatalogFactory.resolve(n);return a==t?t:new r(a,n)},n}();e.AddinDataProviderFactory=a}(d||(d={})),function(e){var t=function(){var t=!0,n=!1,r=null;function a(e){var t=this;t._omex=r,t._addinListReady=n,t._entitlements=[],t._appDetails={},t._getEntitlementCallback=r,t._hostInfo=e,t._appUILocale=e.appUILocale,t._enabled=e.enableWopiCatalog,t._enabled&&""!==e.wopiHostAddinList&&t.updateAddinList(e.wopiHostAddinList)}return a.prototype.getOmexCatalog=function(){var n=this;if(n._omex)return n._omex;var r,a={appName:n._hostInfo.appName,appVersion:n._hostInfo.appVersion,clientMode:n._hostInfo.clientMode,appUILocale:n._hostInfo.appUILocale,dataLocale:n._hostInfo.dataLocale,osfOmexBaseUrl:n._hostInfo.osfOmexBaseUrl,devCatalogUrl:n._hostInfo.devCatalogUrl,spBaseUrl:n._hostInfo.spBaseUrl,docUrl:n._hostInfo.docUrl,allowExternalMarketplace:n._hostInfo.allowExternalMarketplace,clientName:n._hostInfo.clientName,clientVersion:n._hostInfo.clientVersion,hostType:n._hostInfo.hostType,omexForceAnonymous:t,userNameHashCode:n._hostInfo.userNameHashCode,enableUploadFileDevCatalog:n._hostInfo.enableUploadFileDevCatalog,enablePrivateCatalog:n._hostInfo.enablePrivateCatalog,enableWopiCatalog:n._hostInfo.enableWopiCatalog},i=a.osfOmexBaseUrl.indexOf(o.Constants.ProtocolSeparator);r=i>=0?a.osfOmexBaseUrl.substr(i):o.Constants.ProtocolSeparator+a.osfOmexBaseUrl;var s=o.Constants.Https+r;return o.OUtil.getQueryStringParamValue(window.location.search,o.Constants.OmexForceAnonymousParamName).toLowerCase()==o.Constants.OmexForceAnonymousParamValue.toLowerCase()&&(a.omexForceAnonymous=t),n._omex=new e.OmexCatalog({appName:a.appName,appUILocale:a.appUILocale,AppVersion:a.appVersion,clientMode:a.clientMode,docUrl:a.docUrl,omexBaseUrl:s,omexForceAnonymous:a.omexForceAnonymous}),n._omex},a.prototype.updateAddinList=function(a){var i=this,s=i;i._entitlements=[];var c=r,l=n,u=n,d=n,f=n,p=n;try{c=JSON.parse(a)}catch(n){e.WACUtils.logExceptionToBrowserConsole("Fail to parse JSON string.",n),l=t,c=r}if(c)if(Array.isArray(c))for(var m=0;m<c.length;m++){var g=c[m];if(g.addinId){var h=void 0;if(g.type)try{h=o.OUtil.parseEnum(g.type,o.OfficeAppType)}catch(n){e.WACUtils.logExceptionToBrowserConsole("Incorrect targetType.",g.type),f=t;continue}else h=1;g.wopiOnly=t;var v={assetId:g.addinId,storeType:g.wopiOnly?o.StoreType.WopiCatalog:o.StoreType.OMEX,appVersion:"0.0.0.0",storeId:i._appUILocale,contentMarket:i._appUILocale,targetType:h};i._entitlements.push(v)}else e.WACUtils.logExceptionToBrowserConsole("Required field missing: addinId.",g),d=t}else e.WACUtils.logExceptionToBrowserConsole("Received add-in list is not an array.",c),u=t;var y=i._entitlements.map((function(e){return e.assetId}));i.getOmexCatalog().getAppDetails(y,i._appUILocale,new e.SimpleTelemetryContext,(function(n){if(n.status!==e.DataServiceResultCode.Succeeded){var a=n.value.map((function(e){return e.assetId.toUpperCase()})),o=s._entitlements;s._entitlements=[];for(var i=0;i<o.length;i++){var c=o[i];-1==a.indexOf(c.assetId.toUpperCase())?(e.WACUtils.logExceptionToBrowserConsole("Can't find Office Add-in from Microsoft AppSource given addin ID.",c.assetId),p=t):s._entitlements.push(c)}}s._appDetails={};for(var m=0,g=n.value;m<g.length;m++)for(var h=g[m],v=0,y=s._entitlements;v<y.length;v++){c=y[v];if(h.assetId.toUpperCase()===c.assetId.toUpperCase()){h.storeType=c.storeType,s._appDetails[h.assetId.toUpperCase()]=h;break}}if(e.SDXCatalog.recordActivity("WopiCatalogUpdateAddinList",performance.now(),t,[{name:"JSONParseError",boolean:l},{name:"AddinListNotAnArray",boolean:u},{name:"RequiredFieldMissing",boolean:d},{name:"IncorrectTargetType:",boolean:f},{name:"AddinNoFound",boolean:p},{name:"AddinListNonEmpty",boolean:s._entitlements.length>0}]),s._addinListReady=t,s._getEntitlementCallback!=r){var b=s._getEntitlementCallback;s._getEntitlementCallback=r,b({status:e.DataServiceResultCode.Succeeded,value:s._entitlements})}}),n)},a.prototype.getEntitlementAsync=function(t,n,a){var o=this;if(o._enabled)if(o._addinListReady)a({status:e.DataServiceResultCode.Succeeded,value:o._entitlements});else if(n.startActivity(e.Activity.EntitlementCheck),o._getEntitlementCallback!=r){var i=o._getEntitlementCallback;o._getEntitlementCallback=function(t){n.stopActivity(e.Activity.EntitlementCheck),i(t),a(t)}}else o._getEntitlementCallback=function(t){n.stopActivity(e.Activity.EntitlementCheck),a(t)};else a({status:e.DataServiceResultCode.Succeeded,value:[]})},a.prototype.getAndCacheManifest=function(e,t,r,a,o){this.getOmexCatalog().getAndCacheManifest(e,t,r,a,o||n)},a.prototype.activateAsync=function(n,a,i){var s=this;i.startActivity(e.Activity.Activation);var c=this;this.isAddinEntitledAsync(n.assetId,(function(l){l.value?c.getAndCacheManifest(n,s._appUILocale,i,(function(t){t.status===e.DataServiceResultCode.Succeeded?(i.stopActivity(e.Activity.Activation),a.load({entitlement:n,manifest:t.value,eToken:""},r)):(i.stopActivity(e.Activity.Activation),e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message,url:"",errorCode:o.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){a.restartActivation(),c.activateAsync(n,a,i)}}))})):(i.stopActivity(e.Activity.Activation),e.LoaderUtil.showWarning(a,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){a.restartActivation(),c.activateAsync(n,a,i)},detailView:t,retryAll:t,errorCode:o.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED}))}))},a.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},a.prototype.getAppDetails=function(t,r,a,o){var i=this;this.getEntitlementAsync(n,new e.SimpleTelemetryContext,(function(){for(var n=[],r=e.DataServiceResultCode.Succeeded,a=0;a<t.length;a++){var s=t[a].toUpperCase();i._appDetails[s]?n.push(i._appDetails[s]):r=e.DataServiceResultCode.Failed}o({status:r,value:n})}))},a.prototype.isAddinEntitledAsync=function(r,a){this.getEntitlementAsync(n,new e.SimpleTelemetryContext,(function(o){if(o.status===e.DataServiceResultCode.Succeeded)for(var i=r.toUpperCase(),s=0,c=o.value;s<c.length;s++){if(c[s].assetId.toUpperCase()===i)return void a({status:e.DataServiceResultCode.Succeeded,value:t})}a({status:e.DataServiceResultCode.Succeeded,value:n})}))},a}();e.WOPICatalog=t}(d||(d={})),function(e){!function(e){var t="Unauthenticated",n="UnknownUserType",r="PrxoyUrlEmpty",a="ProxyNotReady",o="Succeeded";e[e[o]=1]=o,e[e.Failed=0]="Failed",e[e[a]=-1]=a,e[e[r]=-2]=r,e[e[n]=2]=n,e[e[t]=3]=t}(e.DataServiceResultCode||(e.DataServiceResultCode={}));e.DataServiceResultCode}(d||(d={})),function(e){var t=function(){var t=null;function n(n,r){void 0===r&&(r=t),this._initParam=n,this._cacheManager=r||new e.AppsDataCacheManager(o.OUtil.getLocalStorage(),new e.SafeSerializer)}return n.LogFirstPartyCatalogMonitoringError=function(e,n){s.RuntimeTelemetryHelper.LogExceptionTag("First Party Catalog Error AssetId: "+n+" Message: "+e,t,t,39068e3)},n.prototype.getEntitlementAsync=function(){throw new Error("in firstParty get Entitlementasync")},n.prototype.getAndCacheManifest=function(){throw new Error("in firstParty getAndCacheManifest")},n.prototype.removeAsync=function(){throw new Error("in firstParty removeAsync")},n.prototype.getAppDetails=function(){throw new Error("in firstParty getappDetails")},n.prototype.TryFallBackFirstPartyAddInList=function(r,a,o){var i=this._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!1);i?(n.LogFirstPartyCatalogMonitoringError("Falling back to stale 1st party add-ins list.",a),o({status:e.DataServiceResultCode.Succeeded,value:i})):o({status:e.DataServiceResultCode.Failed,value:t})},n.prototype.GetFirstyPartyAddInsInfo=function(n,r,a,o){var i=this,c=this._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!0,t,t,!1);if(c){var l={addInList:c,refreshRate:t};o({status:e.DataServiceResultCode.Succeeded,value:l})}else n.getFirstPartyAddInList((function(n){if(n.status==e.DataServiceResultCode.Succeeded){var c=t;try{c=e.OmexXmlProcessor.ProcessFirstPartyAddInList(n.value)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Problem parsing first party list.",e,r.correlationId,34366472),void i.TryFallBackFirstPartyAddInList(r,a,o)}i._cacheManager.SetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,c.addInList,c.refreshRate/e.CacheConsts.hourToDayConversionFactor),o({status:e.DataServiceResultCode.Succeeded,value:c})}else i.TryFallBackFirstPartyAddInList(r,a,o)}))},n.prototype.TryFallBackFirstPartyManifest=function(r,a,o){var i=this.ReadFirstPartyManifestFromLocalStorage(a,r);i?(n.LogFirstPartyCatalogMonitoringError("Falling back to stale manifest.",r),o({status:e.DataServiceResultCode.Succeeded,value:i})):o({status:e.DataServiceResultCode.Failed,value:t})},n.prototype.ReadFirstPartyManifestFromLocalStorage=function(n,r){var a=o.OUtil.formatString(e.CacheConsts.firstPartyManifestCacheKey,r),i=this._cacheManager.GetCacheItem(a,!1);return i?e.ManifestUtil.ParseManifest(i,this._initParam.appUILocale,n.correlationId):t},n.prototype.GetCachedManifest=function(e,t){var n=o.OsfManifestManager.getCachedManifest(t,"");return n||(n=this.ReadFirstPartyManifestFromLocalStorage(e,t))&&o.OsfManifestManager.cacheManifest(t,"",n),n},n.prototype.GetFirstPartyManifest=function(t,n,r,a){var i=this,s=this.GetCachedManifest(n,r.assetId);if(!s||o.OsfManifestManager.versionLessThan(s.getMarketplaceVersion(),r.version)){var c=o.OUtil.formatString("{0}/{1}",this._initParam.firstPartyManifestCDNUrl,r.path);t.getFirstPartyManifest(c,(function(t){if(t.status==e.DataServiceResultCode.Succeeded){var s=e.ManifestUtil.ParseManifest(t.value,i._initParam.appUILocale,n.correlationId);if(s){o.OsfManifestManager.cacheManifest(r.assetId,"",s);var c=o.OUtil.formatString(e.CacheConsts.firstPartyManifestCacheKey,r.assetId);i._cacheManager.SetCacheItem(c,t.value),a({status:e.DataServiceResultCode.Succeeded,value:s})}else i.TryFallBackFirstPartyManifest(r.assetId,n,a)}else i.TryFallBackFirstPartyManifest(r.assetId,n,a)}))}else a({status:e.DataServiceResultCode.Succeeded,value:s})},n.prototype.getDataService=function(n,r){var a=this,o=a;if(a._dataService==t){var i={status:e.DataServiceResultCode.Failed,value:t},s=function(t,n){t.status==e.DataServiceResultCode.Succeeded?(o._dataService=n,i.value=n,i.status=e.DataServiceResultCode.Succeeded,r(i)):(i.httpStatus=t.httpStatus,r(i))},c=e.ProxyBasedCatalogService.getFirstPartyInstance(a._initParam);c.prepareProxy(n.correlationId,(function(e){s(e,c)}))}else r({status:e.DataServiceResultCode.Succeeded,value:a._dataService})},n.prototype.createActivityScope=function(t,n){var r=this;this.getDataService(t,(function(a){if(!e.AsyncUtil.failed(a,n)){var o=a.value,i={cacheManager:r._cacheManager,cachePrefix:e.CacheConsts.anonymousCacheKeyPrefix,cid:o.getCID(),anonymous:!0,telemetryContext:t},s=o.createScope(i);n({status:e.DataServiceResultCode.Succeeded,value:s})}}))},n.prototype.activateAsync=function(r,a,i){var s=this,c=s;i.startActivity(e.Activity.Activation),i.startActivity(e.Activity.ServerCall);var l=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),u=l&&l.enableFirstPartySDXErrorMessages;if(s._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!0,t,t,!1)){var d=s.GetCachedManifest(i,r.assetId);if(d)return i.stopActivity(e.Activity.ServerCall),void a.load({entitlement:r,manifest:d,eToken:""},t)}s.createActivityScope(i,(function(s){if(s.status!=e.DataServiceResultCode.Succeeded)return n.LogFirstPartyCatalogMonitoringError("Failed to create 1st party activity scope.",r.assetId),void e.LoaderUtil.failWithError(a,{title:u?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:u?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),c.activateAsync(r,a,i)},errorCode:o.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError});var l=s.value;c.GetFirstyPartyAddInsInfo(l,i,r.assetId,(function(s){if(s.status!=e.DataServiceResultCode.Succeeded)return n.LogFirstPartyCatalogMonitoringError("Failed get list of 1st party addIns.",r.assetId),void e.LoaderUtil.failWithError(a,{title:u?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:u?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),c.activateAsync(r,a,i)},errorCode:o.ErrorStatusCodes.WAC_FirstPartyAddInListRequestFailure});var d=s.value.addInList[r.assetId];if(!d)return n.LogFirstPartyCatalogMonitoringError("Could not find 1st party addin assetId in list.",r.assetId),void e.LoaderUtil.failWithError(a,{title:u?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:u?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),c.activateAsync(r,a,i)},errorCode:o.ErrorStatusCodes.WAC_FirstPartyAddInListRequestFailure});i.startActivity(e.Activity.ManifestRequest),c.GetFirstPartyManifest(l,i,d,(function(s){if(s.status!=e.DataServiceResultCode.Succeeded)return n.LogFirstPartyCatalogMonitoringError("Could not get 1st party manifest.",r.assetId),void e.LoaderUtil.failWithError(a,{title:u?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:u?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),c.activateAsync(r,a,i)},errorCode:o.ErrorStatusCodes.WAC_AgaveManifestRequestFailure});i.stopActivity(e.Activity.ManifestRequest),i.stopActivity(e.Activity.ServerCall);var l=s.value;a.load({entitlement:r,manifest:l,eToken:""},t)}))}))}))},n}();e.FirstPartyCatalog=t,e.CatalogFactory.register(o.StoreType.FirstParty,(function(n){if(n.osfOmexBaseUrl&&n.firstPartyManifestCDNUrl){var r,a=n.osfOmexBaseUrl.indexOf(o.Constants.ProtocolSeparator);r=a>=0?n.osfOmexBaseUrl.substr(a):o.Constants.ProtocolSeparator+n.osfOmexBaseUrl;var i=o.Constants.Https+r;return new t({appName:n.appName,appUILocale:n.appUILocale,AppVersion:n.appVersion,clientMode:n.clientMode,docUrl:n.docUrl,omexBaseUrl:i,omexForceAnonymous:!0,firstPartyManifestCDNUrl:n.firstPartyManifestCDNUrl})}return new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,errorCode:o.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:o.OsfControlStatus.ActivationFailed})}))}(d||(d={})),function(e){var t=function(){var e="OMEX_clearCacheAsync",t="OMEX_removeCacheAsync",n="OMEX_getAppStateAsync",r="OMEX_getKilledAppsAsync",a="OMEX_getManifestAndETokenAsync";function o(){}return o.CheckProxyIsReady="OMEX_isProxyReady",o.Gated_GetManifestAndEToken=a,o.Gated_GetKilledApps=r,o.Gated_GetEntitlementSummary="OMEX_getEntitlementSummaryAsync",o.Gated_GetAppState=n,o.Gated_RemoveApp="OMEX_removeAppAsync",o.Gated_RemoveCache=t,o.Gated_ClearCache=e,o.UnGated_GetAppDetails="OMEX_getAppDetailsAsync",o.UnGated_GetRecommendations="OMEX_getRecommendationsAsync",o.UnGated_ClearCache=e,o.Anonymous_GetManifestAndEToken=a,o.Anonymous_GetKilledApps=r,o.Anonymous_GetAppState=n,o.Anonymous_RemoveCache=t,o.Anonymous_ClearCache=e,o.Anonymous_GetAuthNStatus="OMEX_getAuthNStatus",o.Anonymous_GetFirstPartyAddInList="OMEX_getFirstPartyAddInListAsync",o.Anonymous_GetFirstPartyManifest="OMEX_getFirstPartyManifestAsync",o}();e.OmexProxyMethods=t;var n=function(n){var r=null;function a(e){n.call(this),this.osfOmexBaseUrl=e}return c(a,n),a.prototype.prepareProxy=function(e,t,n){var o=this;n&&(o.isReady=!1,a.resetProxy(o)),o.isReady?e({status:r,value:{clientEndpoint:o.clientEndPoint}}):o.clientEndPoint?o.pendingCallbacks.push([e,t]):o.createProxy(e,t)},a.resetProxy=function(e){Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e.conversationId)&&Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e.conversationId),e.iframe&&(o.OUtil.removeEventListener(e.iframe,"load",e.iframeOnload),e.iframe.parentNode.removeChild(e.iframe),e.iframe=r),e.clientEndPoint=r},a.prototype.createProxy=function(n,i){var c=this;try{!c.doesUrlHaveSupportedProtocol(c.proxyUrl)&&i({status:r,value:{errorMessage:"Protocal of proxyUrl is not supported."}});var l=document.createElement("iframe");l.setAttribute("id",c.proxyName),l.setAttribute("name",c.proxyName);var u=c.proxyUrl+"?"+c.conversationId,d=window.location.origin;u=o.OUtil.addXdmInfoAsHash(u,c.conversationId+"|"+c.proxyName+"|"+d),u=o.OUtil.addSerializerVersionAsHash(u,o.SerializerVersion.Browser),u=o.OUtil.addFlightsAsHash(u,JSON.stringify(o.Flights)),l.setAttribute("src",u),l.setAttribute("scrolling","auto"),l.setAttribute("border","0"),l.setAttribute("width","0"),l.setAttribute("height","0"),l.setAttribute("style","position: absolute; left: -100px; top:0px;");var f=500;c.proxyName===o.Constants.OmexAnonymousServiceName&&o.OUtil.checkFlight(o.FlightNames.FirstPartyAnonymousProxyReadyCheckTimeout)&&(f=5e3),document.body.appendChild(l);var p=c,m=function(){if(p.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(p.conversationId,l.contentWindow,p.proxyUrl),p.clientEndPoint)p.clientEndPoint.invoke(t.CheckProxyIsReady,(function(e,t){var n=p.pendingCallbacks.length;if(0!=n){var o=r;0===e&&t.status?(p.isReady=!0,o={status:r,value:{clientEndpoint:p.clientEndPoint}}):(a.resetProxy(p),o={status:r,value:{errorMessage:"OmexProxyBase::onIframeLoad::isProxyReadyCallback failed, error code "+e}});for(var i=0;i<n;i++){var s=p.pendingCallbacks.shift();p.isReady?s[0](o):s[1](o)}}}),{__timeout__:f});else{var e="Unexpected error, iframe loaded again after failing OMEX_isProxyReady";s.RuntimeTelemetryHelper.LogExceptionTag(e,r,r,18121820),i({status:r,value:{errorMessage:e}})}o.OUtil.set_entropy((new Date).getTime())};o.OUtil.addEventListener(l,"load",m),c.iframeOnload=m,c.pendingCallbacks.push([n,i]),c.iframe=l}catch(t){var g="Error creating client endpoint with proxyUrl = ["+c.proxyUrl+"], msg:"+e.WACUtils.serializeObjectToString(t);i({status:r,value:{errorMessage:g}})}},a}(e.ProxyBase);e.OmexProxyBase=n}(d||(d={})),function(e){var t=function(t){function n(e){var n=this;t.call(n,e),n.proxyName=o.Constants.OmexAnonymousServiceName,n.proxyUrl=n.osfOmexBaseUrl+o.Constants.OmexAnonymousServiceExtension}return c(n,t),n.prototype.getManifestAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetManifestAndEToken,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertClientAppInstallInfo(t.value)),n(t)}))},n.prototype.getFirstPartyAddInListAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetFirstPartyAddInList,t,(function(e){n(e)}))},n.prototype.getFirstPartyManifestAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetFirstPartyManifest,t,(function(e){n(e)}))},n.prototype.getAppStateAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetAppState,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppState(t.value)),n(t)}))},n.prototype.getKilledAppAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetKilledApps,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertKilledAppsInfo(t.value)),n(t)}))},n.prototype.getAuthNStatusAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetAuthNStatus,t,n)},n}(e.OmexProxyBase);e.AnonymousOmexProxy=t}(d||(d={})),function(e){var t=function(t){var n=null;function r(e){var n=this;t.call(n,e),n.proxyName=o.Constants.OmexGatedServiceName,n.proxyUrl=n.osfOmexBaseUrl+o.Constants.OmexGatedServiceExtension}return c(r,t),r.prototype.getOmexEntitlementsAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetEntitlementSummary,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertEntitlementInfo(t.value)),r(t)}))},r.prototype.getManifestAndETokenAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetManifestAndEToken,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertClientAppInstallInfo(t.value)),r(t)}))},r.prototype.getAppStateAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetAppState,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppState(t.value)),r(t)}))},r.prototype.getKilledAppAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetKilledApps,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertKilledAppsInfo(t.value)),r(t)}))},r.prototype.removeApps=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_RemoveApp,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertRemoveAppResponse(t.value)),r(t)}))},r}(e.OmexProxyBase);e.GatedOmexProxy=t}(d||(d={})),function(e){var t,n="",r=null;!function(e){var t="AnonymousUser",n="AuthedUser",r="NotDetected";e[e[r]=0]=r,e[e[n]=1]=n,e[e[t]=2]=t}(t||(t={}));var a=function(){function a(n){var r=this;r.currentUserType=t.NotDetected,r.omexAuthNStatus=o.OmexAuthNStatus.NotAttempted,r.omexAuthConnectTries=1,r.initParams=n,r.gatedProxy=new e.GatedOmexProxy(n.omexBaseUrl),r.ungatedProxy=new e.UnGatedOmexProxy(n.omexBaseUrl),r.anonymousProxy=new e.AnonymousOmexProxy(n.omexBaseUrl)}return a.getInstance=function(e){return a._instance==r&&(a._instance=new a(e)),a._instance},a.getFirstPartyInstance=function(e){if(a._firstPartyInstance==r){var t=new a(e);t._isFirstParty=!0,t.omexAuthNStatus=o.OmexAuthNStatus.Anonymous,this._firstPartyInstance=t}return a._firstPartyInstance},a.prototype.prepareProxy=function(a,o){var i=this;a=a||n;this.ensureOmexProxySetUp(a,(function(n){var a;n&&n.status!=r?n.status:e.DataServiceResultCode.ProxyNotReady;n&&n.value&&(i._isFirstParty?a=!0:n.value.currentUserType&&(n.value.currentUserType==t.AuthedUser?a=!1:n.value.currentUserType==t.AnonymousUser&&(a=!0))),o({status:n.status,value:{anonymous:a}})}))},a.prototype.createScope=function(e){return new c(e,this)},a.prototype.getCID=function(){switch(this.currentUserType){case t.AuthedUser:return this._cid;case t.AnonymousUser:return n}throw"not initialized"},a.prototype.ensureOmexProxySetUp=function(a,i){var c=this;if(c.currentUserType==t.NotDetected||!c.anonymousProxy.isReady&&!c.gatedProxy.isReady){var l=c,u=function(){l.currentUserType=t.AuthedUser,i({status:e.DataServiceResultCode.Succeeded,value:l})},d=function(){l.omexAuthConnectTries<o.Constants.AuthenticatedConnectMaxTries?(l.omexAuthConnectTries++,l.omexAuthNStatus!==o.OmexAuthNStatus.CheckFailed?l.anonymousProxy.prepareProxy(f,m):l.gatedProxy.prepareProxy(u,d)):(s.RuntimeTelemetryHelper.LogExceptionTag("exceed maximum tries and fail",r,a,18657693),l.anonymousProxy.prepareProxy(p,m))},f=function(e){if(e&&e.value){l.anonymousProxy.getAuthNStatusAsync({correlationId:a},(function(e){if(e.status===o.ProxyCallStatusCode.Succeeded){var t=e.value;t==o.OmexAuthNStatus.Authenticated?(l.omexAuthNStatus=o.OmexAuthNStatus.Authenticated,l.gatedProxy.prepareProxy(u,d)):t!=o.OmexAuthNStatus.Anonymous&&t!=o.OmexAuthNStatus.Unknown||(l.omexAuthNStatus=o.OmexAuthNStatus.Anonymous,l.anonymousProxy.prepareProxy(p,m))}else s.RuntimeTelemetryHelper.LogExceptionTag("auth check failure.",r,a,18657694),l.omexAuthNStatus=o.OmexAuthNStatus.CheckFailed,l.initParams.omexForceAnonymous?l.anonymousProxy.prepareProxy(p,m):l.gatedProxy.prepareProxy(u,d)}))}else s.RuntimeTelemetryHelper.LogExceptionTag("GetAuthNStatus callback param invalid",r,a,18657695)},p=function(n){l.omexAuthNStatus==o.OmexAuthNStatus.NotAttempted?f(n):(l.currentUserType=t.AnonymousUser,i({status:e.DataServiceResultCode.Succeeded,value:l}))},m=function(t){var o=n;void 0!==t&&t.value&&t.value.errorMessage&&(o=t.value.errorMessage),s.RuntimeTelemetryHelper.LogExceptionTag("create anonymous proxy failure: "+o,r,a,18657696),i({status:e.DataServiceResultCode.ProxyNotReady})};l.initParams.omexForceAnonymous?l.anonymousProxy.prepareProxy(p,m):l.gatedProxy.prepareProxy(u,d)}else i({status:e.DataServiceResultCode.Succeeded,value:c})},a}();e.ProxyBasedCatalogService=a;var i=function(){function e(){}return e.dummyApplicationName="unused",e}(),c=function(){var a="contentMarket",c="assetID",u="applicationName",d="errors";function f(e,t){var r=this;r._build=o.Constants.FileVersion,r._catalogService=t,r._appVersion=o.OmexAppVersions[r._catalogService.initParams.appName],r._clientName=o.OmexClientNames[r._catalogService.initParams.appName],r._clientVersion=l.getClientVersionFromWACAppVersion(r._catalogService.initParams.AppVersion),r._correlationId=e.telemetryContext.correlationId||n}return f.prototype.getFirstPartyAddInList=function(e){var t=this.buildOmexRequestParameters();t[d]={},this._catalogService.anonymousProxy.getFirstPartyAddInListAsync(t,e)},f.prototype.getFirstPartyManifest=function(e,t){var n=this.buildOmexRequestParameters();n[d]={},n.manifestUrl=e,this._catalogService.anonymousProxy.getFirstPartyManifestAsync(n,t)},f.prototype.tryFail=function(t,n,r){return t!=e.DataServiceResultCode.Succeeded&&(r({status:t}),!0)},f.prototype.isUserTypeValid=function(e){return e!==t.NotDetected||(s.RuntimeTelemetryHelper.LogExceptionTag("userType is invalid.",r,this._correlationId,18657698),!1)},f.prototype.getEntitlementAsync=function(n,r,a){var o=this,s=o,c=o.buildOmexRequestParameters();c[u]=i.dummyApplicationName,c.appVersion=o._appVersion,c.clearEntitlement=a||!1;var l=o._catalogService.currentUserType;o.isUserTypeValid(l)?l===t.AuthedUser?o._catalogService.gatedProxy.getOmexEntitlementsAsync(c,(function(e){s.tryFail(e.status,e.httpStatus,r)||(s._catalogService._cid=e.value.cid,r(e))})):l===t.AnonymousUser&&r({status:e.DataServiceResultCode.Succeeded,value:{refreshRate2:0,entitlements:[]}}):r({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,entitlements:[]}})},f.prototype.getLastStoreUpdate=function(){},f.prototype.isStoreDisabled=function(t){t({status:e.DataServiceResultCode.Succeeded,value:!1})},f.prototype.getManifest=function(t,r,a){this.getETokenAndManifestInternal(t,r,o.ClientAppInfoReturnType.urlOnly,(function(t){var r=t&&t.value&&t.value.manifest?t.value.manifest:n,i=t&&t.value&&t.value.status2?t.value.status2:o.OmexClientAppStatus.ServerError,s=t?t.status:e.DataServiceResultCode.Failed;a({status:s,value:{status2:i,manifest:r}})}))},f.prototype.getEToken=function(e,t,n){this.getETokenAndManifestInternal(e,t,o.ClientAppInfoReturnType.etokenOnly,n)},f.prototype.getETokenAndManifest=function(e,t,n){this.getETokenAndManifestInternal(e,t,o.ClientAppInfoReturnType.both,n)},f.prototype.getAppState=function(r,o){var i=this,s=i,l=i.buildOmexRequestParameters();l[c]=r.assetId,l[a]=r.storeId,l[d]={};var u=i._catalogService.currentUserType;i.isUserTypeValid(u)?u===t.AuthedUser?i._catalogService.gatedProxy.getAppStateAsync(l,(function(e){s.tryFail(e.status,e.httpStatus,o)?s.logServiceCallResponseError("appstate",e.httpStatus):o(e)})):u===t.AnonymousUser&&i._catalogService.anonymousProxy.getAppStateAsync(l,o):o({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,assetId:n,productId:n,version:n,state2:-1}})},f.prototype.getKilledApps=function(n){var a=this,o=a,i=a.buildOmexRequestParameters(),s=a._catalogService.currentUserType;a.isUserTypeValid(s)?s===t.AuthedUser?a._catalogService.gatedProxy.getKilledAppAsync(i,(function(e){o.tryFail(e.status,e.httpStatus,n)?o.logServiceCallResponseError("killedapps",e.httpStatus):n(e)})):s===t.AnonymousUser&&a._catalogService.anonymousProxy.getKilledAppAsync(i,n):n({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,killedApps:r}})},f.prototype.getAppDetails=function(e,t,r){var o=this,i=this.buildOmexRequestParameters();i.assetid=n,i[c]=e.join(","),i[a]=t,this._catalogService.ungatedProxy.getAppDetailsAsync(i,(function(e){o.tryFail(e.status,e.httpStatus,r)?o.logServiceCallResponseError("appdetails",e.httpStatus):r(e)}))},f.prototype.removeApps=function(r,a){var o=this,i=o,s=o.buildOmexRequestParameters();s.assetid=n,s[c]=r.join(",");var l=o._catalogService.currentUserType;o.isUserTypeValid(l)?l===t.AuthedUser?o._catalogService.gatedProxy.removeApps(s,(function(e){i.tryFail(e.status,e.httpStatus,a)?i.logServiceCallResponseError("removeapps",e.httpStatus):a(e)})):l===t.AnonymousUser&&a({status:e.DataServiceResultCode.Succeeded,value:{removedApps:[]}}):a({status:e.DataServiceResultCode.UnknownUserType,value:{removedApps:[]}})},f.prototype.getETokenAndManifestInternal=function(s,l,d,f){var p=this,m=p,g=p.buildOmexRequestParameters();g[u]=i.dummyApplicationName,g[c]=s.assetId,g.clientAppInfoReturnType=d;var h=p._catalogService.currentUserType;p.isUserTypeValid(h)?h===t.AuthedUser&&d!=o.ClientAppInfoReturnType.urlOnly?(g.assetContentMarket=l,g.userContentMarket=s.storeId,g.expectedVersion=s.appVersion,p._catalogService.gatedProxy.getManifestAndETokenAsync(g,(function(e){m.tryFail(e.status,e.httpStatus,f)?m.logServiceCallResponseError("manifestandetoken",e.httpStatus):f(e)}))):(g[a]=s.storeId,g.clientAppInfoReturnType==o.ClientAppInfoReturnType.etokenOnly?f({status:e.DataServiceResultCode.Succeeded,value:{status2:o.OmexClientAppStatus.OK,etoken:n,manifest:r}}):p._catalogService.anonymousProxy.getManifestAsync(g,(function(e){m.tryFail(e.status,e.httpStatus,f)?m.logServiceCallResponseError("manifest",e.httpStatus):f(e)}))):f({status:e.DataServiceResultCode.UnknownUserType,value:{etoken:n,manifest:r}})},f.prototype.buildOmexRequestParameters=function(){var e=this;return{clientName:e._clientName,clientVersion:e._clientVersion,correlationId:e._correlationId,build:e._build}},f.prototype.logServiceCallResponseError=function(e,t){var n="proxybased request "+e+" failed";t&&(n+=":"+t),s.RuntimeTelemetryHelper.LogExceptionTag(n,r,this._correlationId,18657697)},f}();e.ProxyBasedCatalogServiceScope=c;var l=function(){function e(){}return e.getClientVersionFromWACAppVersion=function(e){if(e){var t=e.split("."),n=parseInt(t[0],10),r=parseInt(t[1],10)||0;if(!(n<=15&&r<=0)){var a=o.Constants.FileVersion.split(".");return n+"."+r+"."+a[2]+"."+a[3]}}},e.getOmexEndPointPageUrl=function(e,t,n){return o.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",e,n,t)},e}();e.OmexUtils=l}(d||(d={})),function(e){var t=function(t){function n(e){var n=this;t.call(n,e),n.proxyName=o.Constants.OmexUnGatedServiceName,n.proxyUrl=n.osfOmexBaseUrl+o.Constants.OmexUnGatedServiceExtension}return c(n,t),n.prototype.getAppDetailsAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.UnGated_GetAppDetails,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppDetails(t.value)),n(t)}))},n}(e.OmexProxyBase);e.UnGatedOmexProxy=t}(d||(d={})),function(e){var t=!1,n=null,r=!0,a=function(){var a="cacheExpired";function i(e,t){var n=this;n._initParam=t,n._cacheManager=e.cacheManager,n._cachePrefix=e.cachePrefix,n._cid=e.cid,n._anonymous=e.anonymous,n._telemetryContext=e.telemetryContext}return i.prototype.GetCacheKeyPrefix=function(){return this._cachePrefix},i.prototype.getOmexEndPointPageUrl=function(t,n){return e.OmexUtils.getOmexEndPointPageUrl(this._initParam.omexBaseUrl,t,n)},i.prototype.getKilledApps=function(t,a,i){var s=this,c=s;s._telemetryContext.startActivity(e.Activity.KilledAppsCheck);var l=o.OUtil.formatString(e.CacheConsts.killedAppsCacheKey,s.GetCacheKeyPrefix());if(i)s._cacheManager.RemoveCacheItem(l);else{var u=s._cacheManager.GetCacheItem(l,r);if(u&&u.refreshRate2!=n)return s._telemetryContext.stopActivity(e.Activity.KilledAppsCheck),void a({status:e.DataServiceResultCode.Succeeded,value:u})}t.getKilledApps((function(t){t.status==e.DataServiceResultCode.Succeeded?(c._telemetryContext.stopActivity(e.Activity.KilledAppsCheck),u=t.value,c._cacheManager.SetCacheItem(l,u,u.refreshRate/e.CacheConsts.hourToDayConversionFactor),a(t)):a(t)}))},i.prototype.getAppState=function(i,s,c,l){var u=this,d=u;u._telemetryContext.startActivity(e.Activity.AppStateCheck);var f,p=o.OUtil.formatString(e.CacheConsts.appStateCacheKey,u.GetCacheKeyPrefix(),s.storeId,s.assetId);if(l)u._cacheManager.RemoveCacheItem(p);else{var m={};if(f=u._cacheManager.GetCacheItem(p,r,m),u._telemetryContext.setFlag(e.FlagName.AppStateDataInvalidFlag,m[a]||t),f&&f.state2!=n)return u._telemetryContext.stopActivity(e.Activity.AppStateCheck),u._telemetryContext.setFlag(e.FlagName.AppStateDataCachedFlag,r),void c({status:e.DataServiceResultCode.Succeeded,value:f})}i.getAppState(s,(function(n){n.status==e.DataServiceResultCode.Succeeded?(d._telemetryContext.stopActivity(e.Activity.AppStateCheck),d._telemetryContext.setFlag(e.FlagName.AppStateDataCachedFlag,t),f=n.value,d._cacheManager.SetCacheItem(p,f,f.refreshRate2/e.CacheConsts.hourToDayConversionFactor),c(n)):c(n)}))},i.prototype.getManifest=function(i,s,c,l,u){var d=this,f=d;d._telemetryContext.startActivity(e.Activity.ManifestRequest);var p,m=o.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,s.assetId,s.storeId);if(u)d._cacheManager.RemoveCacheItem(m);else{var g={};if(p=d._cacheManager.GetCacheItem(m,r,g),d._telemetryContext.setFlag(e.FlagName.ManifestDataInvalidFlag,g[a]||t),p&&p.status2!=n)return d._telemetryContext.stopActivity(e.Activity.ManifestRequest),d._telemetryContext.stopActivity(e.Activity.ServerCall),d._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,r),void l({status:e.DataServiceResultCode.Succeeded,value:{status2:p.status2,manifest:p.manifest}})}i.getManifest(s,c,(function(n){n.status==e.DataServiceResultCode.Succeeded&&n.value.status2==o.OmexClientAppStatus.OK?(f._telemetryContext.stopActivity(e.Activity.ManifestRequest),f._telemetryContext.stopActivity(e.Activity.ServerCall),f._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,t),f._telemetryContext.setBits(e.FlagName.ManifestRequestType,o.ManifestRequestTypes.Manifest),p={etoken:"",status2:n.value.status2,manifest:n.value.manifest},f._cacheManager.SetCacheItem(m,p,e.CacheConsts.manifestRefreshRate),l(n)):l(n)}))},i.prototype.removeApps=function(n,a,i){var s=this;n.removeApps(a,(function(n){if(n.status==e.DataServiceResultCode.Succeeded){for(var a=".*",c=t,l=[],u=n.value.removedApps,d=0;d<u.length;++d)u[d].result2==o.OmexRemoveAppStatus.Success&&(l.push(new RegExp(o.OUtil.formatString(e.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,a,u[d].assetId,a,a),"i")),c=r);c&&s._cacheManager.RemoveMatches(l),i(n)}else i(n)}))},i.prototype.getCachedETokenAndManifest=function(o){var i={},s=this._cacheManager.GetCacheItem(o,r,i);if(this._telemetryContext.setFlag(e.FlagName.ManifestDataInvalidFlag,i[a]||t),s){if(s.status2&&s.tokenExpirationDate2&&s.tokenExpirationDate2>(new Date).getTime())return s;s.etoken=n,s.tokenExpirationDate2=n,s.entitlementType=n}return s},i.prototype.getETokenAndManifest=function(a,i,s,c,l){var u=this,d=u;if(u._anonymous)u.getManifest(a,i,s,(function(t){e.AsyncUtil.failed(t,c)||c({status:t.status,value:{etoken:"",status2:t.value.status2,manifest:t.value.manifest}})}),l);else{u._telemetryContext.startActivity(e.Activity.ManifestRequest);var f,p=function(t,n){d._telemetryContext.stopActivity(e.Activity.ManifestRequest),d._telemetryContext.stopActivity(e.Activity.ServerCall),d._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,t),n&&d._telemetryContext.setBits(e.FlagName.ManifestRequestType,n)},m=o.OUtil.formatString(e.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,u._cid,i.assetId,i.storeId,s);if(l)u._cacheManager.RemoveCacheItem(m);else{if((f=u.getCachedETokenAndManifest(m))&&f.etoken&&f.manifest)return p(r),void c({status:e.DataServiceResultCode.Succeeded,value:f});var g=f?f.manifest:n;if(g==n||""==g){var h=o.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,i.assetId,i.storeId),v=u._cacheManager.GetCacheItem(h,r);v&&(g=v.manifest)}if(g)return void(f&&f.etoken?(p(r),f.manifest=g,c({status:e.DataServiceResultCode.Succeeded,value:f})):a.getEToken(i,s,(function(n){n.status===e.DataServiceResultCode.Succeeded&&n.value&&(p(t,o.ManifestRequestTypes.Etoken),(f=n.value).status2===o.OmexClientAppStatus.OK&&(d._cacheManager.SetCacheItem(m,f,e.CacheConsts.manifestRefreshRate),f.manifest=g)),c(n)})))}a.getETokenAndManifest(i,s,(function(n){n.status==e.DataServiceResultCode.Succeeded?(p(t,o.ManifestRequestTypes.Both),n.value.status2===o.OmexClientAppStatus.OK&&d._cacheManager.SetCacheItem(m,n.value,e.CacheConsts.manifestRefreshRate),c(n)):c(n)}))}},i.prototype.getEntitlements=function(t,r,a,o){var i=this,s=i;i._telemetryContext.startActivity(e.Activity.EntitlementCheck);var c,l,u=function(){l!=n&&c!=n&&(c=c.filter((function(e){return l.every((function(t){return t.assetId!=e.assetId}))})),a({status:e.DataServiceResultCode.Succeeded,value:{entitlements:c,killed:l}}))};i._anonymous?(c=[],i._telemetryContext.stopActivity(e.Activity.EntitlementCheck),u()):t.getEntitlementAsync(r,(function(t){s._telemetryContext.stopActivity(e.Activity.EntitlementCheck),a!=n&&(e.AsyncUtil.failed(t,a)?a=n:(s._cid||(s._cid=t.value.cid),c=t.value.entitlements,u()))}),o),i.getKilledApps(t,(function(t){a!=n&&(l=t.status==e.DataServiceResultCode.Succeeded?t.value.killedApps:[],u())}))},i.prototype.activate=function(a,i,c){var l,u,d=this,f={assetId:i.assetId,appVersion:i.appVersion,storeId:i.storeId,storeType:i.storeType,targetType:i.targetType},p=t,m=this.getOmexEndPointPageUrl(f.assetId,f.storeId),g=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),h=function(u,p){switch(u.status2){case o.OmexClientAppStatus.OK:if(u.tokenExpirationDate2&&u.tokenExpirationDate2<=(new Date).getTime())return void e.LoaderUtil.failWithWarning(c,e.LoaderUtil.warning({description:Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){return v()},errorCode:o.ErrorStatusCodes.E_TOKEN_EXPIRED}));var h=e.ManifestUtil.ParseManifest(u.manifest,d._initParam.appUILocale,d._telemetryContext.correlationId);if(h==n)return void e.LoaderUtil.failWithError(c,{infoType:o.InfoType.Error,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v()},description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,errorCode:o.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT});var b=h.getMarketplaceVersion();if(o.OsfManifestManager.cacheManifest(f.assetId,i.appVersion,h),h.requirementsSupported===t||void 0===h.requirementsSupported&&!c.getRequirementsChecker().isManifestSupported(h)){h.requirementsSupported=t;var A;return A=Strings.OsfRuntime.L_AgaveManifestRequirementsErrorOmex_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,void e.LoaderUtil.failWithError(c,{description:A,url:m,detailView:r,errorCode:o.ErrorStatusCodes.WAC_AgaveRequirementsErrorOmex})}h.requirementsSupported=r,d._telemetryContext.setFlag(e.FlagName.ManifestTrustCachedFlag,!p);var S=o.OUtil.formatString(o.Constants.ActivatedCacheKey,i.assetId.toLowerCase(),i.storeType,i.storeId);if(p&&!c.skipTrust(i)){var _=o.OmexClientNames[d._initParam.appName];if(!(d._anonymous&&d._cacheManager.GetCacheItem(S,t))&&!c.hasConsent(i)&&!c.isForCustomFunctionSandbox())return void c.askForTrust({anonymous:t,clientName:_,entitlement:f,displayName:h.getDefaultDisplayName(),providerName:h.getProviderName(),iconUrl:h.getDefaultIconUrl(),url:m,isSSOAddin:h.isSSOAddin()},(function(){d.restartActivationTelemetry(),d._cacheManager.SetCacheItem(S,r),d._anonymous?c.load({entitlement:f,manifest:h,eToken:u.etoken},n):d.getETokenAndManifest(a,f,f.storeId,(function(t){t.status==e.DataServiceResultCode.Succeeded&&t.value.status2==o.OmexClientAppStatus.OK?(t.value.version!=n&&e.ManifestUtil.versionLessThan(f.appVersion,t.value.version)&&(f.appVersion=t.value.version),C(r)):e.LoaderUtil.failWithError(c,{infoType:o.InfoType.Error,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v()},description:o.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveOmexCatalogName),errorCode:o.ErrorStatusCodes.WAC_AgaveManifestAndEtokenRequestFailure})}))}))}c.hasConsent(i)&&d._cacheManager.SetCacheItem(S,r);var O=l.version;e.ManifestUtil.versionLessThan(O,i.appVersion)&&(O=i.appVersion),e.ManifestUtil.versionLessThan(b,O)?(f.appVersion=O,e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),c.setIsUpgrading(r),c.setUpgradingFailed(t),v(r),y()},url:m,highPriority:r,displayDeactive:t,errorCode:o.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE})):l.state2===o.OmexState.DeveloperWithdrawn?e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveRetiring_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,url:m,displayDeactive:t,errorCode:o.ErrorStatusCodes.S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE}):l.state2===o.OmexState.Flagged?e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveSoftKilled_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,url:m,displayDeactive:t,errorCode:o.ErrorStatusCodes.S_OEM_EXTENSION_FLAGGED}):!d._anonymous&&u.entitlementType&&u.entitlementType.toLowerCase()===o.OmexEntitlementType.Trial&&(e.LoaderUtil.showNotification(c,{description:Strings.OsfRuntime.L_AgaveTrial_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:function(){return window.open(m)},reDisplay:r,highPriority:r,displayDeactive:t,errorCode:o.ErrorStatusCodes.S_OEM_EXTENSION_TRIAL_MODE}),e.LoaderUtil.showNotification(c,{description:Strings.OsfRuntime.L_AgaveTrialRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v(r)},detailView:r,reDisplay:r,highPriority:r,displayDeactive:t,errorCode:o.ErrorStatusCodes.S_USER_CLICKED_BUY})),c.load({entitlement:f,manifest:h,eToken:u.etoken},n);break;case o.OmexClientAppStatus.KilledAsset:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:o.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED});break;case o.OmexClientAppStatus.NoEntitlement:case o.OmexClientAppStatus.TrialNotSupported:case o.OmexClientAppStatus.LimitedTrial:case o.OmexClientAppStatus.EntitlementDeactivated:if(d._anonymous){e.LoaderUtil.failWithError(c,{title:Strings.OsfRuntime.L_AgaveSigninRequiredTitle_TXT,description:Strings.OsfRuntime.L_AgaveNotViewableAnonymous_ERR,buttonTxt:Strings.OsfRuntime.L_SignInButton_TXT,buttonCallback:function(){var e=window.location.href,t=d._initParam.omexBaseUrl+o.Constants.SignInRedirectUrl+encodeURIComponent(e);window.open(t)},errorCode:o.ErrorStatusCodes.E_USER_NOT_SIGNED_IN})}else{c.setRetryCall((function(){d.restartActivationTelemetry(),v(r)})),e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseNotAquired_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:function(){window.open(m),e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseNotAquiredRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v(r)},detailView:r,retryAll:r,errorCode:o.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})},errorCode:o.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})}break;case o.OmexClientAppStatus.UnknownAssetId:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,errorCode:o.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST});break;case o.OmexClientAppStatus.Expired:case o.OmexClientAppStatus.Invalid:e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v()},errorCode:o.ErrorStatusCodes.E_TOKEN_EXPIRED});break;case o.OmexClientAppStatus.Revoked:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveRetired_ERR,url:m,errorCode:o.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE});break;case o.OmexClientAppStatus.VersionMismatch:f.appVersion=u.version,c.askForUpgrade(e.LoaderUtil.warning({description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,url:m,highPriority:r,logAsError:r,errorCode:o.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE}),(function(){d.restartActivationTelemetry(),c.setIsUpgrading(r),c.setUpgradingFailed(t),v(r)}));break;case o.OmexClientAppStatus.VersionNotSupported:e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,errorCode:o.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType},o.OsfControlStatus.UnsupportedStore);break;case o.OmexClientAppStatus.UserIsMinor:g&&g.enableDisplayBlockedMinorError&&e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:o.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR});break;default:s.RuntimeTelemetryHelper.LogExceptionTag("unknown clientAppStatus in manifestAndEtoken: "+u.status2,n,d._telemetryContext.correlationId,20030238),e.LoaderUtil.failWithError(c,{description:o.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveOmexCatalogName),buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v(r)},errorCode:o.ErrorStatusCodes.WAC_AgaveUnknownClientAppStatus})}},v=function(i){var s=u?u.contentMarket:f.storeId,m=function(n,a){return n.status!=e.DataServiceResultCode.Succeeded?g&&g.enableDisplayBlockedMinorError&&451===n.httpStatus?(e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:o.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR}),r):(e.LoaderUtil.failWithError(c,{description:o.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveOmexCatalogName),buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v(i)},errorCode:a}),r):t};c.skipTrust(f)?d.getManifest(a,f,s,(function(e){if(m(e,o.ErrorStatusCodes.WAC_AgaveManifestRequestFailure))c.getIsUpgrading()&&(c.setUpgradingFailed(r),c.setIsUpgrading(t));else{if(i)return l=n,void A(r);c.getIsUpgrading()&&c.setIsUpgrading(t),h({etoken:"",status2:e.value.status2,manifest:e.value.manifest})}}),i):d.getETokenAndManifest(a,f,s,(function(e){if(m(e,o.ErrorStatusCodes.WAC_AgaveManifestAndEtokenRequestFailure))c.getIsUpgrading()&&(c.setUpgradingFailed(r),c.setIsUpgrading(t));else{if(i)return l=n,p=t,C(r),void A(r);c.getIsUpgrading()&&c.setIsUpgrading(t),h(e.value)}}),i)},y=function(){var t=o.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,f.assetId,f.storeId);d._cacheManager.RemoveCacheItem(t)},b=function(){if(l!=n&&p){if(u!=n)return f.appVersion=u.version,void v();var t,s,g;if(l.state2===o.OmexState.Flagged?t=r:l.state2===o.OmexState.DeveloperWithdrawn?s=r:l.state2===o.OmexState.Withdrawn&&(g=r),!(t||s||g)||(e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveRetired_ERR,url:m,errorCode:o.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE}),!t))if(c.hasConsent(i))v();else{var y=u?u.contentMarket:f.storeId;d.getManifest(a,f,y,(function(t){t.status==e.DataServiceResultCode.Succeeded?h({etoken:"",status2:t.value.status2,manifest:t.value.manifest},r):e.LoaderUtil.failWithError(c,{description:o.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveOmexCatalogName),buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),b()},errorCode:o.ErrorStatusCodes.WAC_AgaveManifestRequestFailure})}))}}},C=function(i){u=n,p=t,d.getEntitlements(a,t,(function(a){if(a.status!=e.DataServiceResultCode.Succeeded)return g&&g.enableDisplayBlockedMinorError&&451===a.httpStatus?void e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:o.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR}):void e.LoaderUtil.failWithError(c,{description:o.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveOmexCatalogName),buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),C()},errorCode:o.ErrorStatusCodes.WAC_AgaveEntitlementRequestFailure});a.value.killed.some((function(e){return e.assetId==f.assetId}))?e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:o.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED}):(a.value.entitlements.some((function(e){return e.assetId.toLowerCase()==f.assetId.toLowerCase()?(u=e,m=d.getOmexEndPointPageUrl(e.assetId,e.contentMarket),r):t})),d._telemetryContext.setFlag(e.FlagName.OmexHasEntitlementFlag,u!=n),p=r,b())}),i)},A=function(t){l=n,d.getAppState(a,f,(function(t){if(t.status!=e.DataServiceResultCode.Succeeded)return l={state2:o.OmexState.OK,productId:n,assetId:f.assetId,version:f.appVersion,refreshRate2:0},void b();t.value.state2!==o.OmexState.Killed?(l=t.value,b()):e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:o.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED})}),t)};A(),C()},i.prototype.restartActivationTelemetry=function(){var t=this;t._telemetryContext.startActivity(e.Activity.Activation),t._telemetryContext.startActivity(e.Activity.ServerCall),t._telemetryContext.setFlag(e.FlagName.AnonymousFlag,t._anonymous)},i}(),i=function(){function i(t,a){void 0===a&&(a=n),this._anonymous=r,this._initParam=t,this._cacheManager=a||new e.AppsDataCacheManager(o.OUtil.getLocalStorage(),new e.SafeSerializer)}return i.prototype.GetCacheKeyPrefix=function(){return this._anonymous?e.CacheConsts.anonymousCacheKeyPrefix:e.WACUtils.CacheConstants.GatedCacheKeyPrefix},i.prototype.getOmexEndPointPageUrl=function(e,t){return o.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._initParam.omexBaseUrl,t,e)},i.prototype.getDataService=function(t,r){var a=this,i=a;if(a._dataService==n)if(a._dataServiceReady==n){a._dataServiceReady=r;var s={status:e.DataServiceResultCode.Failed,value:n},c=function(t,r){var a=i._dataServiceReady;i._dataServiceReady=n,t.status==e.DataServiceResultCode.Succeeded?(i._anonymous=t.value.anonymous,i._dataService=r,s.value=r,s.status=e.DataServiceResultCode.Succeeded,a(s)):(s.httpStatus=t.httpStatus,a(s))};t.startActivity(e.Activity.Authentication);var l=new e.S2SOmexCatalogService(a._initParam);l.initialize(t.correlationId,(function(n){if(n.status==e.DataServiceResultCode.Succeeded){var r=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();if(!r||!r.enableAnonymousUseLegacyCatalogService||!n.value.anonymous)return t.stopActivity(e.Activity.Authentication),void c(n,l)}t.setBits(e.FlagName.ActivationRuntimeType,o.ActivationTypes.V2Enabled);var a=e.ProxyBasedCatalogService.getInstance(i._initParam);a.prepareProxy(t.correlationId,(function(n){t.stopActivity(e.Activity.Authentication),t.setBits(e.FlagName.RetryCount,a.omexAuthConnectTries),c(n,a)}))}))}else{t.startActivity(e.Activity.Authentication);var u=a._dataServiceReady;a._dataServiceReady=function(n){t.stopActivity(e.Activity.Authentication),u(n),r(n)}}else r({status:e.DataServiceResultCode.Succeeded,value:a._dataService})},i.prototype.createActivityScope=function(t,r){var o=this;this.getDataService(t,(function(i){if(e.AsyncUtil.failed(i,r))s.RuntimeTelemetryHelper.LogExceptionTag("failed to get data service.",n,t.correlationId,18657692);else{t.setFlag(e.FlagName.AnonymousFlag,o._anonymous);var c=i.value,l={cacheManager:o._cacheManager,cachePrefix:o.GetCacheKeyPrefix(),cid:c.getCID(),anonymous:o._anonymous,telemetryContext:t},u=c.createScope(l),d=new a(l,o._initParam);r({status:e.DataServiceResultCode.Succeeded,value:{serviceScope:u,activityScope:d}})}}))},i.prototype.getEntitlementAsync=function(t,n,r,a,i){var s=this;this.createActivityScope(n,(function(n){e.AsyncUtil.failed(n,r,[])||(s._anonymous?r({status:e.DataServiceResultCode.Failed,httpStatus:403}):n.value.serviceScope.getEntitlementAsync(t,(function(t){if(!e.AsyncUtil.failed(t,r,[])){for(var n=t.value.entitlements,a=0;a<n.length;a++){var i=n[a],s=i;s.appVersion=i.version,s.storeId=i.contentMarket,s.storeType=o.StoreType.OMEX,s.targetType=o.OUtil.getTargetType(i.appSubType)}r({status:t.status,value:n})}}),a,i))}))},i.prototype.getAndCacheManifest=function(r,a,i,s,c){var l=this;c=c||t;var u=o.OsfManifestManager.getCachedManifest(r.assetId,r.appVersion);c||u==n?this.createActivityScope(i,(function(t){if(!e.AsyncUtil.failed(t,s)){var u=t.value.serviceScope;t.value.activityScope.getManifest(u,r,a,(function(t){if(!e.AsyncUtil.failed(t,s))if(t.value.status2==o.OmexClientAppStatus.OK){var a=e.ManifestUtil.ParseManifest(t.value.manifest,l._initParam.appUILocale,i.correlationId);a!=n?(o.OsfManifestManager.cacheManifest(r.assetId,r.appVersion,a),s({status:e.DataServiceResultCode.Succeeded,value:a})):s({status:e.DataServiceResultCode.Failed,value:a})}else s({status:e.DataServiceResultCode.Failed})}),c)}})):s({status:e.DataServiceResultCode.Succeeded,value:u})},i.prototype.activateAsync=function(t,n,a){var i=this;a.startActivity(e.Activity.Activation),a.startActivity(e.Activity.ServerCall),this.createActivityScope(a,(function(s){i.isStoreDisabled(a,(function(c){if(c.value===r)e.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_OmexStoreDisabledByAdmin,errorCode:o.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED});else if(s.status!=e.DataServiceResultCode.Succeeded)return void e.LoaderUtil.failWithError(n,{description:o.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveOmexCatalogName),buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),i.activateAsync(t,n,a)},errorCode:o.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError})}));var c=s.value.serviceScope;s.value.activityScope.activate(c,t,n)}))},i.prototype.removeAsync=function(t,n,r){this.createActivityScope(n,(function(n){if(!e.AsyncUtil.failed(n,r)){var a=n.value.serviceScope;n.value.activityScope.removeApps(a,t,r)}}))},i.prototype.getAppDetails=function(t,a,i,s,c){var l=this,u=l,d=[];if(c)l._cacheManager.RemoveAll(e.CacheConsts.ungatedCacheKeyPrefix);else{for(var f=t,p=[],m=0;m<f.length;++m){var g=o.OUtil.formatString(e.CacheConsts.appDetailKey,f[m]),h=l._cacheManager.GetCacheItem(g,r);h&&h.state2!=n?d.push(h):p.push(f[m])}if(0===p.length)return void s({status:e.DataServiceResultCode.Succeeded,value:d});t=p}l.createActivityScope(i,(function(n){e.AsyncUtil.failed(n,s,d)||n.value.serviceScope.getAppDetails(t,a,(function(t){if(!e.AsyncUtil.failed(t,s,d)){for(var n=t.value,r=0;r<n.length;++r){var a=n[r],i=o.OUtil.formatString(e.CacheConsts.appDetailKey,a.assetId);u._cacheManager.SetCacheItem(i,a),d.push(a)}t.value=d,s(t)}}))}))},i.prototype.isStoreDisabled=function(n,r){this.createActivityScope(n,(function(n){e.AsyncUtil.failed(n,r,t)||n.value.serviceScope.isStoreDisabled(r)}))},i}();e.OmexCatalog=i,e.CatalogFactory.register(o.StoreType.OMEX,(function(t){if(t.allowExternalMarketplace&&t.osfOmexBaseUrl){var n,a=t.osfOmexBaseUrl.indexOf(o.Constants.ProtocolSeparator);n=a>=0?t.osfOmexBaseUrl.substr(a):o.Constants.ProtocolSeparator+t.osfOmexBaseUrl;var s=o.Constants.Https+n;return o.OUtil.getQueryStringParamValue(window.location.search,o.Constants.OmexForceAnonymousParamName).toLowerCase()==o.Constants.OmexForceAnonymousParamValue.toLowerCase()&&(t.omexForceAnonymous=r),new i({appName:t.appName,appUILocale:t.appUILocale,AppVersion:t.appVersion,clientMode:t.clientMode,docUrl:t.docUrl,omexBaseUrl:s,omexForceAnonymous:t.omexForceAnonymous})}return new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,errorCode:o.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:o.OsfControlStatus.ActivationFailed})}))}(d||(d={})),function(e){var t=function(){function e(){}return e.anonymousCacheKeyPrefix="__OSF_ANONYMOUS_OMEX.",e.ungatedCacheKeyPrefix="__OSF_OMEX.",e.manifestRefreshRate=1825,e.hourToDayConversionFactor=24,e.anonymousAppInstallInfoCacheKey=e.anonymousCacheKeyPrefix+"appInstallInfo.{0}.{1}",e.firstPartyAddinListCacheKey=e.anonymousCacheKeyPrefix+"firstPartyAddInList",e.firstPartyManifestCacheKey=e.anonymousCacheKeyPrefix+"firstPartyManifest.{0}",e.killedAppsCacheKey="{0}killedApps",e.appStateCacheKey="{0}appState.{1}.{2}",e.appDetailKey="__OSF_OMEX.appDetails.{0}",e}();e.CacheConsts=t}(d||(d={})),function(e){var t=null,n=function(){function n(e,t,n){var r=this;r._handler=e,r._initParam=t,r._cacheManager=n.cacheManager,r._cachePrefix=n.cachePrefix,r._cid=n.cid,r._correlationId=n.telemetryContext.correlationId}return n.prototype.tryFail=function(t,n){return 200!=t&&(n({httpStatus:t,status:e.DataServiceResultCode.Failed}),!0)},n.prototype.getLastStoreUpdate=function(t){var n=this,r=n,a=n._initParam.appUILocale;n._handler.getLastStoreUpdate(a,n._correlationId,(function(n,a){r.tryFail(n,t)?r.logServiceCallResponseError("laststoreupdate",n):t({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessLastStoreUpdate(a)})}))},n.prototype.getEntitlementAsync=function(n,r,a,i){var s=this,c=s,l=o.OmexAppVersions[s._initParam.appName],u=o.OUtil.formatString(s._cachePrefix+e.WACUtils.CacheConstants.EntitlementsKey,l,s._cid);if(a)s._cacheManager.RemoveCacheItem(u);else{var d=s._cacheManager.GetCacheItem(u,!0,t,i);if(d!=t)return void r({status:e.DataServiceResultCode.Succeeded,value:d})}s._handler.getEntitlement(n,l,s._correlationId,(function(t,n){if(c.tryFail(t,r))c.logServiceCallResponseError("entitlement",t);else{var a=e.OmexXmlProcessor.ProcessEntitlement(n);a.cid=c._cid,c._cacheManager.SetCacheItem(u,a,a.refreshRate2/e.CacheConsts.hourToDayConversionFactor),r({status:e.DataServiceResultCode.Succeeded,value:a})}}))},n.prototype.getEToken=function(t,n,r){var a=this,i=n,s=t.storeId,c=t.assetId,l=t.appVersion;this._handler.getEToken(s,i,c,l,this._correlationId,(function(t,n){a.tryFail(t,r)?a.logServiceCallResponseError("etoken",t):r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessClientAppInstallInfo(n,o.ClientAppInfoReturnType.etokenOnly)})}))},n.prototype.getETokenAndManifest=function(t,n,r){var a=this;this.getEToken(t,n,(function(o){o.status==e.DataServiceResultCode.Succeeded?a.getManifest(t,n,(function(t){if(t.status!=e.DataServiceResultCode.Succeeded)return o.status=t.status,o.httpStatus=t.httpStatus,void r(o);o.value.manifest=t.value.manifest,r(o)})):r(o)}))},n.prototype.getManifest=function(t,n,r){var a=n;this._handler.getManifest(a,t.assetId,this._correlationId,(function(t,n){r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ConvertAnonymousManifest(t,n)})}))},n.prototype.getAppState=function(t,n){var r=this,a=t.storeId+":"+t.assetId;this._handler.getAppState(a,this._correlationId,(function(t,a){r.tryFail(t,n)?r.logServiceCallResponseError("appstate",t):n({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessAppState(a)})}))},n.prototype.getKilledApps=function(t){var n=this;this._handler.getKilledApps(this._correlationId,(function(r,a){n.tryFail(r,t)?n.logServiceCallResponseError("killedapps",r):t({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessKilledApps(a)})}))},n.prototype.getAppDetails=function(t,n,r){var a=this;this._handler.getAppDetails(n,t.join(","),this._correlationId,(function(t,n){a.tryFail(t,r)?a.logServiceCallResponseError("appdetails",t):r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessAppDetails(n)})}))},n.prototype.removeApps=function(t,n){var r=this;this._handler.removeApps(t.join(","),this._correlationId,(function(t,a){if(r.tryFail(t,n))r.logServiceCallResponseError("removeapps",t);else{var i=e.OmexXmlProcessor.ProcessRemoveAppResponse(a);i.removedApps.some((function(e){return e.result2==o.OmexRemoveAppStatus.Success}))&&r.clearEntitlementCache(),n({status:e.DataServiceResultCode.Succeeded,value:i})}}))},n.prototype.clearEntitlementCache=function(){var t=new RegExp(o.OUtil.formatString(e.WACUtils.CacheConstants.EntitlementsKey,".*",".*"),"i");this._cacheManager.RemoveMatches([t])},n.prototype.isStoreDisabled=function(t){var n=this;this._handler.isStoreDisabled(this._correlationId,(function(r){if(200!=r&&403!=r&&401!=r)return n.logServiceCallResponseError("isStoreDisabled",r),void t({status:e.DataServiceResultCode.Failed,value:!1});t({status:e.DataServiceResultCode.Succeeded,value:401==r})}))},n.prototype.logServiceCallResponseError=function(e,n){var r="s2s request "+e+" failed";n&&(r+=":"+n),s.RuntimeTelemetryHelper.LogExceptionTag(r,t,this._correlationId,18657699)},n}();e.OmexCatalogServiceS2SScope=n;var r=function(){function r(e){this._cid="",this._initParam=e}return r.initRequestHandler=function(e){r._requestHandler==t&&(r._requestHandler=e)},r.prototype.getCID=function(){return this._cid},r.prototype.initialize=function(n,a){var o=this;r._requestHandler!=t?this._initParam.omexForceAnonymous?a({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!0}}):r._requestHandler.getUserId(n,(function(r,i){200==r?(o._cid=i.trim(),a({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!1}})):403==r?a({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!0}}):(s.RuntimeTelemetryHelper.LogExceptionTag("s2s getuserId request failed "+r,t,n,18657728),a({status:e.DataServiceResultCode.Failed,httpStatus:r}))})):a({status:e.DataServiceResultCode.Failed,httpStatus:404})},r.prototype.createScope=function(e){return new n(r._requestHandler,this._initParam,e)},r}();e.S2SOmexCatalogService=r}(d||(d={})),function(e){var t=function(){var e="description",t="provider",n="o:assets",r="contentMarket",a="appSubType",i="expirationDate",s="state",c="version",u="productId",d="assetId",f="o:asset",p="o:results",m="refreshRate",g=null;function h(){}return h.ProcessLastStoreUpdate=function(e){var t=new o.XmlProcessor(e,l).getDocumentElement().selectSingleNode("o:update");return t.firstChild!=g?Date.parse(t.firstChild.nodeValue):g},h.ProcessAppState=function(e){var t={},n=new o.XmlProcessor(e,l),r=n.getDocumentElement();n.readAttributes(r,{rr:m},t);var a=n.selectSingleNode(p),g=n.selectSingleNode("o:lang",a),v=n.selectSingleNode(f,g);return n.readAttributes(v,{assetid:d,prodid:u,ver:c,state:s,tdurl:"takeDownUrl",upv:"unsafePreviousVersion",expiry:i},t),h.ConvertAppState(t)},h.ProcessFirstPartyAddInList=function(e){var t={addInList:{},refreshRate:g},n=new o.XmlProcessor(e,l),r=n.getDocumentElement(),a=n.selectSingleNode("o:Apps",r),i=a.getAttribute("d1p1:rr");t.refreshRate=i?parseInt(i):0;for(var s=n.selectNodes("o:App",a),c=0;c<s.length;c++){var u=s[c],f={assetId:g,path:g,version:g};n.readAttributes(u,{assetid:d},f);var p=n.selectSingleNode("o:Path",u);f.path=p.text!=g?p.text:p.textContent!=g?p.textContent:p.nodeTypedValue;var m=n.selectSingleNode("o:Version",u);f.version=m.text!=g?m.text:m.textContent!=g?m.textContent:m.nodeTypedValue,t.addInList[f.assetId]=f}return t},h.ConvertAppState=function(e){return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e.state2=e.state?parseInt(e.state):0,e.expirationDate2=h.GetTickByDate(e.expirationDate),e},h.ProcessEntitlement=function(e){var t={},n=new o.XmlProcessor(e,l),s=n.selectSingleNode("o:entitlementlist"),f=n.selectSingleNode("o:hdr",s);n.readAttributes(f,{pm:"billingMarket",pagesize:"pageSize",rr:m},t);for(var p,g,v=n.selectNodes("o:entitlement",n.selectSingleNode("o:entitlements",s)),y=[],b=0;b<v.length;++b)g={},p=v[b],n.readAttributes(p,{assetid:d,pid:u,ver:c,appst:a,cm:r,trlt:"licenseType",acqdate:"acquireDate",expiry2:i,attreq:"attentionRequired"},g),y.push(g);return t.entitlements=y,h.ConvertEntitlementInfo(t)},h.ConvertEntitlementInfo=function(e){for(var t=e.entitlements,n=0;n<t.length;++n){var r=t[n];r.appSubType2=r.appSubType?parseInt(r.appSubType):0,r.acquireDate2=h.GetTickByDate(r.acquireDate),r.expirationDate2=h.GetTickByDate(r.expirationDate),r.attentionRequired2="true"===r.attentionRequired}return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e},h.ProcessKilledApps=function(e){var t={},r=new o.XmlProcessor(e,l),a=r.getDocumentElement();r.readAttributes(a,{rr:m},t);for(var i=[],s=r.selectSingleNode(n),c=r.selectNodes(f,s),p=0;p<c.length;++p){var g=c[p],v={};r.readAttributes(g,{assetid:d,pid:u},v),i.push({assetId:v.assetId,productId:v.productId})}return t.killedApps=i,h.ConvertKilledAppsInfo(t)},h.ConvertKilledAppsInfo=function(e){return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e},h.ProcessClientAppInstallInfo=function(e,t){var a=new o.XmlProcessor(e,l),i=a.selectSingleNode(n),s=a.selectSingleNode(f,i),u={etoken:g,manifest:g};if(t===o.ClientAppInfoReturnType.urlOnly?a.readAttributes(s,{url:"url"},u):t===o.ClientAppInfoReturnType.etokenOnly?a.readAttributes(s,{etok:"etoken"},u):a.readAttributes(s,{url:"url",etok:"etoken"},u),a.readAttributes(s,{status:"status",cm:r,assetid:d,ver:c},u),t!=o.ClientAppInfoReturnType.urlOnly&&u.etoken){var p=new o.XmlProcessor(u.etoken,""),m=p.selectSingleNode("t",p.selectSingleNode("r"));p.readAttributes(m,{te:"tokenExpirationDate",et:"entitlementType",cid:"cid"},u)}return h.ConvertClientAppInstallInfo(u)},h.ConvertClientAppInstallInfo=function(e){return e.status2=e.status?parseInt(e.status):0,e.tokenExpirationDate2=h.GetTickByDate(e.tokenExpirationDate),e},h.ProcessManifest=function(e){return{manifest:e}},h.ProcessRemoveAppResponse=function(e){for(var t,n,r={removedApps:[]},a=new o.XmlProcessor(e,l),i=(a.getDocumentElement(),a.selectSingleNode("o:apps",a.selectSingleNode("o:removedApps"))),s=a.selectNodes("o:app",i),c=0;c<s.length;++c)t=s[c],n={},a.readAttributes(t,{assetid:d,result:"result"},n),r.removedApps.push(n);return h.ConvertRemoveAppResponse(r)},h.ConvertRemoveAppResponse=function(e){for(var t=e.removedApps,n=0;n<t.length;++n){var r=t[n];r.result2=r.result?parseInt(r.result):0}return e},h.ProcessAppDetails=function(n){for(var r,i,u=new o.XmlProcessor(n,l),f=u.selectSingleNode(p),m=u.selectNodes("o:wainfo",f),g=[],v=0;v<m.length;++v)r=m[v],i={},u.readAttributes(r,{assetid:d,appid:"webApplicationId",defhei:"defaultHeight",defwid:"defaultWidth",title:"name",prov:t,desc:e,icon:"iconUrl",ver:c,state:s,appst:a,appvers:"appVersions",req:"requirements",hosts:"hosts",highresicon:"highResolutionIconUrl"},i),g.push(i);return h.ConvertAppDetails(g)},h.ConvertAppDetails=function(e){for(var t=0;t<e.length;++t){var n=e[t];n.defaultHeight2=n.defaultHeight?parseInt(n.defaultHeight):0,n.defaultWidth2=n.defaultWidth?parseInt(n.defaultWidth):0,n.state2=n.state?parseInt(n.state):0,n.appSubType2=n.appSubType?parseInt(n.appSubType):0}return e},h.ProcessRecommendations=function(n){for(var r,a,i,u=new o.XmlProcessor(n,l),f=u.selectSingleNode(p),m=u.selectNodes("o:wa",f),g=[],h=0;h<m.length;++h)r=m[h],i={},u.readAttributes(r,{assetid:d,title:"name",desc:e,icon:"iconUrl",ver:c,state:s,rat:"rating",dls:"downloads",prov:t},i),a=u.selectSingleNode("o:price",r),u.readAttributes(a,{fop:"originalPrice",opt:"originalPriceTier",fpp:"promotionalPrice",ppt:"promotionalPriceTier",cmod:"priceModel"},i),g.push(i);return g},h.ConvertAnonymousManifest=function(e,t){var n,r="";switch(e){case 200:n=o.OmexClientAppStatus.OK,r=t;break;case 204:case 1223:n=o.OmexClientAppStatus.NoEntitlement;break;case 400:n=o.OmexClientAppStatus.BadRequest;break;case 410:n=o.OmexClientAppStatus.KilledAsset;break;case 404:n=o.OmexClientAppStatus.UnknownAssetId;break;case 412:n=o.OmexClientAppStatus.VersionNotSupported;break;case 451:n=o.OmexClientAppStatus.UserIsMinor;break;default:n=o.OmexClientAppStatus.ServerError}return{status2:n,manifest:r}},h.GetTickByDate=function(e){return e?new Date(e).getTime():g},h}();e.OmexXmlProcessor=t}(d||(d={})),function(e){var t=function(){var t=null;function n(n,r,a,i){void 0===i&&(i=t),this._cacheManager=i||new e.AppsDataCacheManager(o.OUtil.getLocalStorage(),new e.SafeSerializer),this._privateCatalogService=new e.PrivateCatalogService(o.OmexClientNames[n],o.OUtil.normalizeAppVersion(r)),this._uiLocale=a}return n.prototype.getEntitlementAsync=function(t,r,a,o){r.startActivity(e.Activity.EntitlementCheck),o&&(this._cacheManager.RemoveAll(n._addInsCacheKey),this._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey)),this.GetAddInList(t,r,(function(t){for(var o=[],i=0;i<t.length;i++){var s=t[i];s.addInState===n._addInOkState&&o.push(s)}r.stopActivity(e.Activity.EntitlementCheck),a({status:e.DataServiceResultCode.Succeeded,value:o})}),(function(e){a({status:e})}))},n.prototype.getAppDetails=function(r,a,o,i,s){var c=this,l=c;s&&c._cacheManager.RemoveAll(n._addInDetailsCacheKeyPrefix);for(var u=[],d=[],f=0;f<r.length;f++){var p=n.GetAppDetailsCacheKey(r[f].ProductId),m=c._cacheManager.GetCacheItem(p);m?u.push(m):d.push(r[f])}0!==d.length?c._privateCatalogService.GetManifests(d,t,t,o,(function(t){for(var r=0;r<t.length;r++){var a=l.ParseAndCacheManifest(t[r],o);if(a){var s=n.CreateAddInDetails(a);u.push(s);var c=n.GetAppDetailsCacheKey(s.assetId);l._cacheManager.SetCacheItem(c,s,n._addInDetailsRefreshRateDays)}}i({status:e.DataServiceResultCode.Succeeded,value:u})}),(function(e){i({status:e})})):i({status:e.DataServiceResultCode.Succeeded,value:u})},n.prototype.getAndCacheManifest=function(t,r,a,o){var i={ProductId:t.assetId,Version:t.appVersion,AddInState:n._addInOkState,StoreInfo:{AssetId:t.storeId,ContentMarket:r}};this.GetManifest(i,a,(function(t){o({status:e.DataServiceResultCode.Succeeded,value:t})}),(function(e){o({status:e})}))},n.prototype.activateAsync=function(r,a,i){var s=this;i.startActivity(e.Activity.Activation);var c=this;this.GetAddInList(!1,i,(function(l){for(var u,d=/[{}]/g,f=0;f<l.length;f++){var p=l[f];if(r.assetId.replace(d,"").toLowerCase()===p.assetId.replace(d,"").toLowerCase()){u=p;break}}if(u)if(u.addInState===n._addInOkState){r.appVersion=u.appVersion;var m={ProductId:u.assetId,Version:u.appVersion,AddInState:n._addInOkState,StoreInfo:{AssetId:u.storeId,ContentMarket:""}};s.GetManifest(m,i,(function(e){a.load({entitlement:r,manifest:e,eToken:""},t)}),(function(){e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message,url:"",errorCode:o.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){a.restartActivation(),c.activateAsync(r,a,i)}})}))}else e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,url:"",errorCode:o.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED});else e.LoaderUtil.showWarning(a,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){a.restartActivation(),c._cacheManager.RemoveAll(n._addInsCacheKey),c._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey),c.activateAsync(r,a,i)},detailView:!0,retryAll:!0,errorCode:o.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})}),(function(){e.LoaderUtil.showWarning(a,{description:o.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveAdminManagedCatalogName),buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){a.restartActivation(),c._cacheManager.RemoveAll(n._addInsCacheKey),c._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey),c.activateAsync(r,a,i)},detailView:!0,retryAll:!0,errorCode:o.ErrorStatusCodes.WAC_AgaveActivationError}),i.stopActivity(e.Activity.Activation)}))},n.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},n.GetAppDetailsCacheKey=function(e){return n._addInDetailsCacheKeyPrefix+o.OUtil.formatString(n._addInDetailsCacheKeySufix,e)},n.GetManifestCacheKey=function(e,t){return n._manifestCacheKeyPrefix+o.OUtil.formatString(n._manifestCacheKeySufix,e,t)},n.CreateAddInDetails=function(e){return{assetId:e.getMarketplaceID(),webApplicationId:e.getWebApplicationId(),defaultHeight2:e.getDefaultHeight()||0,defaultHeight:String(e.getDefaultHeight()||0),defaultWidth2:e.getDefaultWidth()||0,defaultWidth:String(e.getDefaultWidth()||0),name:e.getDefaultDisplayName(),provider:e.getProviderName(),description:e.getDefaultDescription(),iconUrl:e.getDefaultIconUrl(),version:e.getMarketplaceVersion(),state2:1,state:"1",appSubType2:e.getOmexTargetCode(),appSubType:String(e.getOmexTargetCode()),appVersions:void 0,requirements:e.getRequirementsXml(),hosts:e.getHostsXml(),highResolutionIconUrl:e.getDefaultHighResolutionIconUrl()}},n.prototype.GetAddInList=function(e,r,a,o){var i,s=this;e||!(i=this._cacheManager.GetCacheItem(n._addInsCacheKey))?this._privateCatalogService.GetAddInList(t,t,r,(function(e){for(var t=0;t<e.length;t++){var r=e[t],o=n.GetAppDetailsCacheKey(r.assetId),i=s._cacheManager.GetCacheItem(o);i&&i.version!==r.appVersion&&s._cacheManager.RemoveCacheItem(o)}s._cacheManager.SetCacheItem(n._addInsCacheKey,e,n._addInListRefreshRateDays),a(e)}),o):a(i)},n.prototype.GetManifest=function(r,a,i,s){var c=this,l=c;a.startActivity(e.Activity.ManifestRequest);var u=o.OsfManifestManager.getCachedManifest(r.ProductId,r.Version);if(u)return a.stopActivity(e.Activity.ManifestRequest),void i(u);var d=n.GetManifestCacheKey(r.ProductId,r.Version),f=c._cacheManager.GetCacheItem(d);if(f)return(u=new o.Manifest.Manifest(f,c._uiLocale))?(a.stopActivity(e.Activity.ManifestRequest),void i(u)):void s(e.DataServiceResultCode.Failed);c._privateCatalogService.GetManifests([r],t,t,a,(function(t){(u=l.ParseAndCacheManifest(t[0],a))?(o.OsfManifestManager.cacheManifest(r.ProductId,r.Version,u),a.stopActivity(e.Activity.ManifestRequest),i(u)):s(e.DataServiceResultCode.Failed)}),(function(e){s(e)}))},n.prototype.ParseAndCacheManifest=function(e,r){try{var a=new o.Manifest.Manifest(e,this._uiLocale),i=n.GetManifestCacheKey(a.getMarketplaceID(),a.getMarketplaceVersion());return this._cacheManager.SetCacheItem(i,e,n._addInManifestRefreshRateDays),a}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest retrieved from Private Catalog.",e,r.correlationId,19965729)}return t},n._addInsCacheKey="__OSF_PRIVATECATALOG_ADDINS",n._addInDetailsCacheKeyPrefix="__OSF_PRIVATECATALOG_ADDINDETAILS",n._addInDetailsCacheKeySufix="_{0}",n._manifestCacheKeyPrefix="__OSF_PRIVATECATALOG_MANIFEST",n._manifestCacheKeySufix="_{0}_{1}",n._lastCatalogUpdateKey="_OSF_PRIVATECATALOG_LASTUPDATE",n._addInListRefreshRateDays=1/24,n._addInDetailsRefreshRateDays=365,n._addInManifestRefreshRateDays=365,n._addInOkState="Ok",n}();e.PrivateCatalog=t,e.CatalogFactory.register(o.StoreType.PrivateCatalog,(function(n){return n.enablePrivateCatalog?new t(n.appName,n.appVersion,n.appUILocale):new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({description:o.OUtil.formatString(Strings.OsfRuntime.L_AgaveCatalogNotEnabled_ERR,Strings.OsfRuntime.L_AgaveAdminManagedCatalogName),errorCode:o.ErrorStatusCodes.E_EXCHANGE_PRIVATE_CATALOG_DISABLED}),controlStatus:o.OsfControlStatus.ActivationFailed})}))}(d||(d={})),function(e){var t=function(){var t="Failed to parse response into PrivateCatalogServiceResponse object.",n=200,r=!0,a=null,i=!1;function c(e,t){this._clientCode=e,this._clientVersion=t}return c.initRequestHandler=function(t,n,s,l){void 0===l&&(l=i),c._requestHandler==a&&(c._requestHandler=t),c.authenticationProxy==a&&(c.authenticationProxy=n),c._isThirdPartyHostEnabled=s,c._resultCodeIsEnabled=l&&l===r,c._tokenCacheManager=new e.TokenCacheManager(o.OUtil.getLocalStorage(),new e.SafeSerializer),c._cacheManager=new e.AppsDataCacheManager(o.OUtil.getLocalStorage(),new e.SafeSerializer)},c.ParseAddInList=function(e,t){var n,r=[];try{n=JSON.parse(e)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetAddIns reponse.",e,t.correlationId,19965730),a}if(!n||!n.AddIns)return s.RuntimeTelemetryHelper.LogCommonMessageTag("GetPrivateCatalogAddIns response could not be parsed.",t.correlationId,20194262),r;for(var i=0,l=n.AddIns;i<l.length;i++){var u=l[i];u.AddInState&&u.ProductId&&u.Version?(r.push({assetId:u.ProductId,storeId:u.StoreInfo?u.StoreInfo.AssetId:"none",appVersion:u.Version,storeType:o.StoreType.PrivateCatalog,targetType:o.OsfControlTarget.Undefined,addInState:u.AddInState,contentMarket:u.StoreInfo?u.StoreInfo.ContentMarket:""}),c.StoreAuthenticationData(n)):s.RuntimeTelemetryHelper.LogCommonMessageTag(o.OUtil.formatString('Add-In metadata was missing some data. ID: "{0}", Version: "{1}", State: "{2}".',u.ProductId||"",u.Version||"",u.AddInState||""),t.correlationId,20194263)}return r},c.ParseAndCacheManifestList=function(e,t){var n,r=[];try{n=JSON.parse(e)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetManifests reponse.",e,t.correlationId,19965731),a}if(!n||!n.Manifests)return s.RuntimeTelemetryHelper.LogCommonMessageTag("GetAddInManifests response could not be parsed.",t.correlationId,20194264),r;for(var o=0,i=n.Manifests;o<i.length;o++){var l=i[o];r.push(l)}return c.StoreAuthenticationData(n),r},c.StoreAuthenticationData=function(e){c._tokenCacheManager.AddRefreshToken(e.RefreshToken,e.UserId,e.TenantId),c._userId=e.UserId,c._tenantId=e.TenantId},c.prototype.GetLastPrivateCatalogUpdate=function(t,o,l,u,d){var f=this,p=0;c._requestHandler.getLastPrivateCatalogUpdate(this._clientCode,this._clientVersion,t,o,l.correlationId,(function(m,g){var h="GetLastPrivateCatalogUpdate response could not be parsed.",v="Could not parse GetLastPrivateCatalogUpdate reponse.";if(p++,c._resultCodeIsEnabled){if(m===n){var y=c.ParsePrivateCatalogServiceResponse(g,l);if(!y)return void d(e.DataServiceResultCode.Failed);if(1===y.ResponseCode){try{C=JSON.parse(g)}catch(t){return s.RuntimeTelemetryHelper.LogExceptionTag(v,t,l.correlationId,42284249),void d(e.DataServiceResultCode.Failed)}return C&&C.LastUpdate?(c.StoreAuthenticationData(C),void u(C.LastUpdate)):(s.RuntimeTelemetryHelper.LogCommonMessageTag(h,l.correlationId,42284250),void d(e.DataServiceResultCode.Failed))}if(2===y.ResponseCode)if(A=c.TryGetRefreshToken(g,l))return void f.GetLastPrivateCatalogUpdate(a,A,l,u,d);if(2===y.ResponseCode||3===y.ResponseCode){var b=r;return setTimeout((function(){c.authenticationProxy.tryAuthorize((function(e){b&&(b=i,f.GetLastPrivateCatalogUpdate(e,a,l,u,d))}),(function(){if(b){b=i;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}))}),0),void setTimeout((function(){if(b){b=i;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}),c._authenticationTimeout)}return void c.HandleLogging(y,l,d)}}else{if(m===n){var C;try{C=JSON.parse(g)}catch(t){return s.RuntimeTelemetryHelper.LogExceptionTag(v,t,l.correlationId,22823177),void d(e.DataServiceResultCode.Failed)}return C&&C.LastUpdate?(c.StoreAuthenticationData(C),void u(C.LastUpdate)):(s.RuntimeTelemetryHelper.LogCommonMessageTag(h,l.correlationId,22823178),void d(e.DataServiceResultCode.Failed))}if(403===m){var A;if(1==p)if(p++,(A=c.TryGetRefreshToken(g,l))!=a)return void f.GetLastPrivateCatalogUpdate(t,A,l,u,d);if(p>c._maxAuthenticationAttempts||t!=a)return s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetLastPrivateCatalogUpdate authentication loop occured.",a,l.correlationId,22823179),void d(e.DataServiceResultCode.Unauthenticated);p++;b=r;return setTimeout((function(){c.authenticationProxy.tryAuthorize((function(e){b&&(b=i,f.GetLastPrivateCatalogUpdate(e,o,l,u,d))}),(function(){b&&(b=i,d(e.DataServiceResultCode.Unauthenticated))}))}),0),void setTimeout((function(){b&&(b=i,d(e.DataServiceResultCode.Unauthenticated))}),5e3)}}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetLastPrivateCatalogUpdate request failed with status code "+m,a,l.correlationId,22823180),d(e.DataServiceResultCode.Failed)}))},c.prototype.GetAddInList=function(t,o,l,u,d){var f=this,p=0;c._requestHandler.getPrivateCatalogAddIns(this._clientCode,this._clientVersion,t,o,l.correlationId,(function(m,g){if(p++,c._resultCodeIsEnabled){if(m===n){var h=c.ParsePrivateCatalogServiceResponse(g,l);if(!h)return void d(e.DataServiceResultCode.Failed);if(1===h.ResponseCode)return(y=c.ParseAddInList(g,l))?void u(y):void d(e.DataServiceResultCode.Failed);if(2===h.ResponseCode)if(b=c._tokenCacheManager.GetRefreshToken(h.UserId,h.TenantId))return void f.GetAddInList(a,b,l,u,d);if(2===h.ResponseCode||3===h.ResponseCode){var v=r;return setTimeout((function(){c.authenticationProxy.tryAuthorize((function(e){v&&(v=i,f.GetAddInList(e,a,l,u,d))}),(function(){if(v){v=i;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}))}),0),void setTimeout((function(){if(v){v=i;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}),c._authenticationTimeout)}return void c.HandleLogging(h,l,d)}}else{var y;if(m===n)return(y=c.ParseAddInList(g,l))?void u(y):void d(e.DataServiceResultCode.Failed);if(403===m){var b;if(1==p)if(p++,(b=c.TryGetRefreshToken(g,l))!=a)return void f.GetAddInList(t,b,l,u,d);if(p>c._maxAuthenticationAttempts||t!=a)return s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetAddInList authentication loop occured. Either authentication attempts count is greater than 2, or authorizationCode is not null. attemptsCount: "+p,a,l.correlationId,20497158),void d(e.DataServiceResultCode.Unauthenticated);p++;v=r;return setTimeout((function(){c.authenticationProxy.tryAuthorize((function(e){v&&(v=i,f.GetAddInList(e,o,l,u,d))}),(function(){if(v){v=i;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}))}),0),void setTimeout((function(){if(v){v=i;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}),5e3)}}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetAddInList request failed with status code "+m,a,l.correlationId,20497159),d(e.DataServiceResultCode.Failed)}))},c.prototype.GetManifests=function(t,o,l,u,d,f){var p=this,m=0,g={AddIns:t,RefreshToken:l,ResponseCode:1,UserId:"",TenantId:""};c._requestHandler.getPrivateCatalogManifests(e.WACUtils.serializeObjectToString(g),o,l,u.correlationId,(function(g,h){if(m++,c._resultCodeIsEnabled){if(g===n){var v=c.ParsePrivateCatalogServiceResponse(h,u);if(!v)return void f(e.DataServiceResultCode.Failed);if(1===v.ResponseCode)return(b=c.ParseAndCacheManifestList(h,u))?void d(b):void f(e.DataServiceResultCode.Failed);if(2===v.ResponseCode)if(C=c.TryGetRefreshToken(h,u))return void p.GetManifests(t,a,C,u,d,f);if(2===v.ResponseCode||3===v.ResponseCode){var y=r;return setTimeout((function(){c.authenticationProxy.tryAuthorize((function(e){y&&(y=i,p.GetManifests(t,e,a,u,d,f))}),(function(){if(y){y=i;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;f(t)}}))}),0),void setTimeout((function(){if(y){y=i;var t=c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;f(t)}}),c._authenticationTimeout)}return void c.HandleLogging(v,u,f)}}else{var b;if(g===n)return(b=c.ParseAndCacheManifestList(h,u))?void d(b):void f(e.DataServiceResultCode.Failed);if(403===g){var C;if(1==m)if(m++,(C=c.TryGetRefreshToken(h,u))!=a)return void p.GetManifests(t,o,C,u,d,f);return m>c._maxAuthenticationAttempts||o!=a?(s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetManifests authentication loop occured.",a,u.correlationId,20497160),void f(e.DataServiceResultCode.Unauthenticated)):(m++,void c.authenticationProxy.tryAuthorize((function(e){p.GetManifests(t,e,l,u,d,f)}),(function(){f(e.DataServiceResultCode.Unauthenticated)})))}}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetManifests request failed with status code "+g,a,u.correlationId,20497161),f(e.DataServiceResultCode.Failed)}))},c.TryGetRefreshToken=function(e,n){var r;try{r=JSON.parse(e)}catch(e){s.RuntimeTelemetryHelper.LogCommonMessageTag(t,n.correlationId,40748691)}return r?c._tokenCacheManager.GetRefreshToken(r.UserId,r.TenantId):a},c.HandleLogging=function(t,n,r){return t?4===t.ResponseCode||5===t.ResponseCode?(5===t.ResponseCode?s.RuntimeTelemetryHelper.LogCommonMessageTag("PrivateCatalogService: User not authenticated.",a,42768075):s.RuntimeTelemetryHelper.LogExceptionTag("PrivateCatalogService: All authentication attempts failed. ResponseCode: "+t.ResponseCode,a,n.correlationId,42284252),void r(c._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed)):((0===t.ResponseCode||7===t.ResponseCode)&&s.RuntimeTelemetryHelper.LogExceptionTag("Call to AddinServiceHandler failed. ResponseCode: "+t.ResponseCode,a,n.correlationId,42284253),6===t.ResponseCode&&s.RuntimeTelemetryHelper.LogCommonMessageTag("PrivateCatalogService: User not supported.",a,42284254),void r(e.DataServiceResultCode.Failed)):(s.RuntimeTelemetryHelper.LogExceptionTag("PrivateCatalogService.HandleLogging: parsedResponse object is null.",a,n.correlationId,42284251),void r(e.DataServiceResultCode.Failed))},c.ParsePrivateCatalogServiceResponse=function(e,n){var r;try{r=JSON.parse(e)}catch(e){s.RuntimeTelemetryHelper.LogCommonMessageTag(t,n.correlationId,42284255)}return r},c.SignOutUser=function(){s.RuntimeTelemetryHelper.LogCommonMessageTag(o.OUtil.formatString("PrivateCatalogService.SignOutUser: userId = {0}, tenantId = {1}",c._userId,c._tenantId),a,21616005),c._tokenCacheManager.RemoveRefreshToken(c._userId,c._tenantId),c.authenticationProxy.signOut((function(){c._cacheManager.RemoveAll(e.PrivateCatalog._addInsCacheKey),c._cacheManager.RemoveAll(e.PrivateCatalog._addInDetailsCacheKeyPrefix)}),(function(){s.RuntimeTelemetryHelper.LogCommonMessageTag("Private Catalog: Failed to sign out ",a,22316866)}))},c._maxAuthenticationAttempts=3,c._authenticationTimeout=3e3,c}();e.PrivateCatalogService=t}(d||(d={})),function(e){var t=function(){var t="requestIdleCallback",n="SDX Catalog Error AssetId: ",r=null,a="fetch",i="",c=!1,l="sdxPreloadStart",u=!0,d="errorMessage",f="manifestParseEnd",p="manifestParseStart",m="manifestRetrievalEnd",g="manifestRetrievalStart",h="packageListParseEnd",v="packageListParseStart",y="packageListRetrievalEnd",b="packageListRetrievalStart",C="activateAsyncStart",A="cachedUrls",S="Version",_="FFN",O="AssetId",I="OsfControlId",x="performanceTimestampOrigin";function T(){}return T.recordActivity=function(e,t,n,r){otel&&otel.sendActivityEvent&&otel.sendActivityEvent({name:"Office.Online.Sdx."+e,durationMs:performance.now()-t,succeeded:n,dataFields:r})},T.recordActivationActivity=function(e,t){var n="SdxOnWacCDNIsEnabled",r="activationStart";T.recordActivity("Activation",t[r],e,[{name:"PerformanceTimestampOrigin",double:t[x]},{name:I,string:t.osfControlId},{name:O,string:t.assetId},{name:_,string:t.ffn},{name:S,string:t.version},{name:"SourceLocationOverrideResourceId",string:t.sourceLocationOverrideResourceId},{name:"IframeUrl",string:t.iframeUrl},{name:"CachedUrls",string:t[A]},{name:"ActivationStart",double:t[r]},{name:"ActivateAsyncStart",double:t[C]},{name:"PackageListRetrievalStart",double:t[b]},{name:"PackageListRetrievalEnd",double:t[y]},{name:"PackageListParseStart",double:t[v]},{name:"PackageListParseEnd",double:t[h]},{name:"ManifestRetrievalStart",double:t[g]},{name:"ManifestRetrievalEnd",double:t[m]},{name:"ManifestParseStart",double:t[p]},{name:"ManifestParseEnd",double:t[f]},{name:"IframeCreateStart",double:t.iframeCreateStart},{name:"IframeCreateEnd",double:t.iframeCreateEnd},{name:"GetAppContextStart",double:t.getAppContextStart},{name:"GetAppContextEnd",double:t.getAppContextEnd},{name:"IframeOnLoadReceived",double:t.iframeOnLoadReceived},{name:"ErrorMessage",string:t[d]},{name:"OfficeJsReadyDate",double:t.officeJsReadyDate},{name:n,boolean:t[n]},{name:"IsPreload",boolean:t.isPreload===u},{name:"SdxPreloadStart",string:t[l]}])},T.InitializeSdx=function(e){var t="Application",n=o.OUtil.getValue(e.flightingTreatmentVariables,{});o.OUtil.getValue(n["Microsoft.Office.OEP.FA000000059.SdxOnWacCDNIsEnabled"],c)&&o.OUtil.pushFlight(o.FlightNames.SdxOnWacCDNIsEnabled);var r=o.OUtil.getValue(e.generalParameters,{});T.appName=o.OUtil.getValue(r[t],"Unknown"),T.wacCdnRssUrl=o.OUtil.getValue(r.wacCdnRssUrl,i),T.InitializeSdxList(r.SdxDmsUrl,r.SdxCdnUrl,r.UICulture,r[t],r.LoggableUserId,r.SessionStartInfoJson)},T.MarkSdxPreloadStart=function(e){var t=e.toLowerCase();T.SdxPreloadStart[t]=performance.now()},T.IsSdxPreloaded=function(e){var t=e.toLowerCase();return T.SdxPreloadStart.hasOwnProperty(t)},T.GetPackageList=function(t,n,i,l,u,d){void 0===d&&(d=c);var f=window[a]||e.AsyncUtil.fetch,p={automation:"Dogfood",microsoft:"Microsoft",dogfood:"Dogfood"}[JSON.parse(u).AudienceGroup.toLowerCase()]||"Production";return e.AsyncUtil.withCache("SDXPackageList_"+i+"_"+n.toLowerCase(),{forceUpdateCache:d,maxAgeInSecs:3600},(function(){return e.AsyncUtil.retry((function(){var e=o.OUtil.Guid.generateNewGuid();return s.RuntimeTelemetryHelper.LogCommonMessageTag("Making network call to DMS. DMSActivityId="+e,r,594629387),f(t,{method:"POST",body:JSON.stringify({Context:{Hosts:[i],ReactNativeVersion:"0.0.0.0",Channel:"DevMain",Capabilities:o.AppSpecificSetup.BuildRequirementsChecker()._getSupportedSetAsDmsCapabilities(),Ring:p,Platform:"Web",Locales:[n],ClientId:l},SyncId:0}),headers:{"Content-Type":"application/json",DMSActivityId:e}}).then((function(e){if(!e.ok)throw new Error("GetPackageList error: "+e.status+" - "+e.statusText);return e.text()}))}))}))},T.GetManifest=function(t,n,i,l){void 0===l&&(l=c);var u=window[a]||e.AsyncUtil.fetch,d=T.GetManifestCdnUrl(t,n),f=o.OUtil.hashCode(d);return e.AsyncUtil.withCache("SDXManifest_"+n.AssetId+"_"+n.FFN+"_"+n.Version+"_"+f,{forceUpdateCache:l},(function(){return e.AsyncUtil.retry((function(){return s.RuntimeTelemetryHelper.LogCommonMessageTag("Making network call to CDN. Url="+d,r,594629386),u(d).then((function(e){if(!e.ok)throw new Error("GetManifest error: "+e.status+" - "+e.statusText);return e.text()}))}))}))},T.GetManifestCdnUrl=function(e,t){return o.OUtil.formatString(function(e,t){return o.OUtil.checkFlight(o.FlightNames.SdxOnWacCDNIsEnabled)&&"Word"===T.appName&&t.AssetId.toLowerCase()===o.SdxAssetIds.ExperimentationSdx?T.wacCdnRssUrl+"sdxexpwaccdn/manifest_web.xml":e}(e,t),t.AssetId,t.FFN,t.Version,"en-us")},T.IsAbsoluteUrl=function(e){return/^(?:[a-z]+:)?\/\//i.test(e)},T.ResolveUrl=function(e,t){if(T.IsAbsoluteUrl(t))return t;var n=e.lastIndexOf("/");return e.substr(0,n)+("/"===t.charAt(0)?i:"/")+t},T.UpdateManifestIconUrl=function(e,t,n){for(var r="en-US",a=["_iconUrls","_highResolutionIconUrls"],o=0;o<a.length;o++){var i=a[o];if(e[i])if(e[i][n])e[i][n]=T.ResolveUrl(t,e[i][n]);else if(e[i][r])e[i][n]=T.ResolveUrl(t,e[i][r]);else for(var s in e[i])if(e[i].hasOwnProperty(s)&&r.toLowerCase()==s.toLowerCase()){e[i][s]=T.ResolveUrl(t,e[i][s]);break}}},T.InitializeSdxList=function(e,t,n,a,i,c){var l=T.GetPackageList(e,n,o.getManifestHostType(a),i,c,u).then((function(e){var t=e.value;return JSON.parse(t).Packages}));l.then((function(e){return e.forEach((function(e){return T.requestIdleCallback(function(e){return function(){return T.GetManifest(t,e,n,u).catch((function(){}))}}(e))})),e}),(function(e){s.RuntimeTelemetryHelper.LogExceptionTag("Error in getting SDX package list.",e,r,594629385)})),T.SdxCdnManifestUrlByAssetId=l.then((function(e){var n={};return e.forEach((function(e){n[e.AssetId.toLowerCase()]=T.GetManifestCdnUrl(t,e)})),n}))},T.PrefetchUrl=function(t,n){if(void 0===n&&(n=c),!T.PrefetchedAssetSet.hasOwnProperty(t)){var r={start:performance.now()};if(T.PrefetchedAssetSet[t]=r,n){var o=document.createElement("link");o.rel="prefetch",o.href=t,o.onload=function(){r.end=performance.now()},document.head.appendChild(o)}else{var i=window[a]||e.AsyncUtil.fetch;T.requestIdleCallback((function(){i(t,{mode:"no-cors"}).then((function(){r.end=performance.now()}))}))}}},T.ResolveRelativeUrl=function(e,t){return T.SdxCdnManifestUrlByAssetId.then((function(n){var a=n[t.toLowerCase()];if(a==r)throw new Error("Unable to find manifestUrl");return T.ResolveUrl(a,e)}))},T.PrefetchAsset=function(e,t,n,a){var s=e.match(T.OfficeJsEntryRegex);if(s===r){var l=c;"iframeUrl:"===e.slice(0,10)&&(e=e.slice(10),l=u),T.IsAbsoluteUrl(e)?T.PrefetchUrl(e,l):l?T.ResolveRelativeUrl(e,a).then((function(e){return T.PrefetchUrl(e,u)}),(function(){})):T.ResolveRelativeUrl(e,a).then((function(e){return T.PrefetchUrl(e,c)}),(function(){}))}else{var d=s[1],f=s[2],p="https://appsforoffice.microsoft.com/lib/"+s[3]+"/hosted/",m=n.toLowerCase(),g=o.HostSpecificFileVersionMap[m].web||o.HostSpecificFileVersionDefault;T.PrefetchUrl(i+p+d),T.PrefetchUrl(i+p+m+"-web-"+g+(f||i)+".js"),T.PrefetchUrl(p+"en-us/office_strings.js"),T.PrefetchUrl(p+"telemetry/oteljs_agave.js"),T.PrefetchUrl(p+"webauth/webauth.implicit.js")}},T.PrefetchSdxAssets=function(e,t,n,a){var o="Microsoft.Office.OEP.",l=e.SdxAssetsToPrefetchMapping;if(l!=r&&!T.IsSdxPreloaded(a)){var d=[],f=[];try{d=JSON.parse(t[o+a.toUpperCase()+".SdxPrefetchAssetsToAdd"]||"[]"),f=JSON.parse(t[o+a.toUpperCase()+".SdxPrefetchAssetsToRemove"]||"[]")}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Error in parsing the sdx prefetch override flighting treatment variables.",e,r,593052824)}if("Word"===n){var p;try{p=JSON.parse(l)[a.toLowerCase()]}catch(e){return void T.LogSDXCatalogMonitoringError("Parsing SdxAssetsToPrefetchMapping failed.",a)}if(Array.isArray(p))for(var m=0;m<p.length;m++){var g=p[m];-1===f.indexOf(g)&&T.PrefetchAsset(g,e,n,a)}else for(var h=0,v=Object.keys(p);h<v.length;h++){var y=v[h],b=c;if(y===i)b=u;else{var C=y.split("=="),A=C[0],S=C[1];e[A]==S?b=u:t["Microsoft.Office."+A]==S&&(b=u)}if(b)for(var _=0,O=p[y];_<O.length;_++){g=O[_];-1===f.indexOf(g)&&T.PrefetchAsset(g,e,n,a)}}for(var I=0;I<d.length;I++){g=d[I];T.PrefetchAsset(g,e,n,a)}}}},T.AddWacSettingParametersToIframeUrl=function(e,t){var n=document.createElement("a");n.href=e;var r=Object.keys(t).map((function(e){return"wacSetting"+e+"="+encodeURIComponent(t[e].toString())})).join("&"),a=n.search.length>1?n.search.substr(1)+"&":i;return n.search=a+r,n.href},T.activateAsync=function(t,a,E,M,P,k){var R="WasCachedInMemory",N="PackageListRetrieval";E.startActivity(e.Activity.Activation),k[C]=performance.now(),k.assetId=t.assetId.toUpperCase();var w=e.CatalogFactory.getHostContext();s.RuntimeTelemetryHelper.LogCommonMessageTag("Start activating SDX with assetId: "+t.assetId+".",E.correlationId,37291606),E.startActivity(e.Activity.ServerCall);var D=r,U=performance.now();k[b]=performance.now(),T.GetPackageList(w.sdxDmsUrl,w.appUILocale,o.getManifestHostType(w.hostType),P.clientId,P.sessionStartInfoJson).then((function(e){var t=e.cacheType,n=e.value;k[y]=performance.now(),k[v]=performance.now();var r={cacheType:t,packages:JSON.parse(n).Packages};return k[h]=performance.now(),r})).then((function(e){var t=e.cacheType,n=e.packages;return T.recordActivity(N,U,u,[{name:I,string:E.instanceId},{name:R,bool:"memory"==t}]),n}),(function(e){throw k[y]=performance.now(),T.recordActivity(N,U,c,[{name:I,string:E.instanceId},{name:R,bool:c}]),e.sdxErrorCode=o.ErrorStatusCodes.WAC_SDX_DMSRequestFailed,e})).then((function(e){if((D=e.filter((function(e){return e.AssetId.toLowerCase()==t.assetId.toLowerCase()}))[0])==r){var n=new Error('Unable to find SDX "'+t.assetId+'" in the package list.');throw n.sdxErrorCode=o.ErrorStatusCodes.WAC_SDX_AssetIdNotInDMSResponse,n}return D})).then((function(t){var n="ManifestRetrieval";E.startActivity(e.Activity.ManifestRequest);var r=performance.now();return k[g]=performance.now(),k.ffn=t.FFN,k.version=t.Version,T.GetManifest(w.sdxCdnUrl,t,w.appUILocale).then((function(e){var a=e.cacheType,o=e.value;return k[m]=performance.now(),T.recordActivity(n,r,u,[{name:I,string:E.instanceId},{name:O,string:t.AssetId},{name:_,string:t.FFN},{name:S,string:t.Version},{name:R,bool:"memory"==a}]),o}),(function(e){throw k[m]=performance.now(),T.recordActivity(n,r,c,[{name:I,string:E.instanceId},{name:O,string:t.AssetId},{name:_,string:t.FFN},{name:S,string:t.Version},{name:R,bool:c}]),e.sdxErrorCode=o.ErrorStatusCodes.WAC_AgaveManifestRequestFailure,e}))})).then((function(t){k[p]=performance.now();var n=e.ManifestUtil.ParseManifest(t,w.appUILocale,E.correlationId);if(k[f]=performance.now(),T.recordActivity("ManifestParse",k[p],n!=r,[{name:I,string:E.instanceId},{name:O,string:D.AssetId},{name:_,string:D.FFN},{name:S,string:D.Version}]),n==r){var a=new Error("Unable to parse manifest.");throw a.sdxErrorCode=o.ErrorStatusCodes.WAC_AgaveManifestRequestFailure,a}return o.OsfManifestManager.cacheManifest(D.AssetId,i,n),n})).then((function(n){E.stopActivity(e.Activity.ServerCall),E.stopActivity(e.Activity.ManifestRequest);var o=T.GetManifestCdnUrl(w.sdxCdnUrl,D);T.UpdateManifestIconUrl(n,o,w.appUILocale),k[A]=JSON.stringify(T.PrefetchedAssetSet),k[l]=JSON.stringify(T.SdxPreloadStart),k[x]=Date.now()-performance.now(),a.load({entitlement:t,manifest:n,eToken:i,manifestUrl:o},r)}),(function(o){if(k[d]=o.toString(),k[A]=JSON.stringify(T.PrefetchedAssetSet),k[l]=JSON.stringify(T.SdxPreloadStart),k[x]=Date.now()-performance.now(),e.SDXCatalog.recordActivationActivity(c,k),s.RuntimeTelemetryHelper.LogExceptionTag(n+t.assetId,o,r,39068003),o.sdxErrorCode!=r){var i=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),u=i&&i.enableFirstPartySDXErrorMessages;e.LoaderUtil.failWithError(a,{title:u?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:u?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),T.activateAsync(t,a,E,M,P,k)},errorCode:o.sdxErrorCode})}}))},T.LogSDXCatalogMonitoringError=function(e,t){s.RuntimeTelemetryHelper.LogExceptionTag(n+t+" Message: "+e,r,r,594350788)},T.appName="Unknown",T.wacCdnRssUrl=i,T.PrefetchedAssetSet={},T.OfficeJsEntryRegex=/^(office(\.debug)?\.js)@(1|1\.0|1\.1|beta)$/i,T.SdxPreloadStart={},T.requestIdleCallback=window[t]?window[t].bind(window):e.AsyncUtil.limitRate((function(e){return e()}),50),T}();e.SDXCatalog=t}(d||(d={})),function(e){var t=!1,n=null,r=!0,a=function(){function a(e,t){this._initParam=t,this._cacheManager=e.cacheManager,this._telemetryContext=e.telemetryContext}return a.prototype.getManifest=function(a,i,s,c){var l=this,u=l;l._telemetryContext.startActivity(e.Activity.ManifestRequest);var d=o.OsfManifestManager.getCachedManifest(i.OfficeExtensionID,i.OfficeExtensionVersion);if(d)return l._telemetryContext.stopActivity(e.Activity.ManifestRequest),l._telemetryContext.stopActivity(e.Activity.ServerCall),void s({status:e.DataServiceResultCode.Succeeded,value:{manifest:d,cached:r}});i.EncodedAbsUrl?a.getManifest(i.EncodedAbsUrl,i.OfficeExtensionID,i.OfficeExtensionVersion,(function(r){if(u._telemetryContext.stopActivity(e.Activity.ManifestRequest),u._telemetryContext.stopActivity(e.Activity.ServerCall),r.status==e.DataServiceResultCode.Succeeded){var a=e.ManifestUtil.ParseManifest(r.value.manifest,u._initParam.appUILocale,u._telemetryContext.correlationId);a==n&&(r.status=e.DataServiceResultCode.Failed),s({status:r.status,value:{manifest:a,cached:t}})}else s({status:r.status,value:{manifest:n,cached:t}})}),c):s({status:e.DataServiceResultCode.Failed,value:{manifest:n,cached:t}})},a.prototype.activate=function(a,i,s){var c,l=this,u={assetId:i.assetId,appVersion:i.appVersion,storeId:i.storeId,storeType:i.storeType,targetType:i.targetType},d=function(a,c){var d=a.manifest,f=d.getMarketplaceVersion();if(o.OsfManifestManager.cacheManifest(i.assetId,i.appVersion,d),a.cached&&e.ManifestUtil.versionLessThan(f,i.appVersion))m(r);else{if(d.requirementsSupported===t||void 0===d.requirementsSupported&&!s.getRequirementsChecker().isManifestSupported(d)){d.requirementsSupported=t;var p;return p=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,void e.LoaderUtil.failWithError(s,{description:p,detailView:r,errorCode:o.ErrorStatusCodes.WAC_AgaveRequirementsError})}if(d.requirementsSupported=r,c&&!s.skipTrust(i)){var g=o.OUtil.formatString(o.Constants.ActivatedCacheKey,i.assetId.toLowerCase(),i.storeType,i.storeId),h=o.OmexClientNames[l._initParam.applicationName];if(!l._cacheManager.GetCacheItem(g,t)&&!s.hasConsent(i)&&!s.isForCustomFunctionSandbox())return void s.askForTrust({anonymous:n,clientName:h,entitlement:u,displayName:d.getDefaultDisplayName(),providerName:d.getProviderName(),iconUrl:d.getDefaultIconUrl(),isSSOAddin:d.isSSOAddin()},(function(){l._cacheManager.SetCacheItem(g,r),s.load({entitlement:u,manifest:d,eToken:n},n)}))}s.hasConsent(i)&&l._cacheManager.SetCacheItem(g,r),s.load({entitlement:u,manifest:d,eToken:n},n)}},f=function(t){l.getManifest(a,c,(function(n){n.status===e.DataServiceResultCode.Succeeded&&n.value.manifest?d(n.value,r):e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),f(t)},errorCode:o.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE})}),t)},p=function(t){c?c.OfficeExtensionKillbit?e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,errorCode:o.ErrorStatusCodes.E_OEM_EXTENSION_KILLED}):f(t):e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),l._telemetryContext.startActivity(e.Activity.Activation),l._telemetryContext.startActivity(e.Activity.ServerCall),m(r)},errorCode:o.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST})},m=function(r){c=n,l._telemetryContext.startActivity(e.Activity.EntitlementCheck),a.getEntitlementAsync(t,i.targetType,(function(t){if(t.status==e.DataServiceResultCode.Succeeded){l._telemetryContext.stopActivity(e.Activity.EntitlementCheck);for(var a,i=n,d=t.value.entitlements,f=0;f<d.length;f++)(a=d[f]).OfficeExtensionID&&u.assetId&&a.OfficeExtensionID.toLowerCase()==u.assetId.toLowerCase()&&(i&&!e.ManifestUtil.versionLessThan(i.OfficeExtensionVersion,a.OfficeExtensionVersion)||(i=a));c=i,p(r)}else e.LoaderUtil.failWithError(s,{description:o.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveMyOrganizationCatalogName),buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),l._telemetryContext.startActivity(e.Activity.Activation),l._telemetryContext.startActivity(e.Activity.ServerCall),m()},errorCode:o.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE})}),r)};m()},a}(),i=function(){function i(t,r){var a=this;void 0===r&&(r=n),a._appDataService={},a._catalogUrlDataService={},a._initParam=t,a._cacheManager=r||new e.AppsDataCacheManager(o.OUtil.getLocalStorage(),new e.SafeSerializer)}return i.prototype.getDataService=function(e,t,n){this.getDataServiceInternal(this._appDataService,e,t,n)},i.prototype.getCatalogUrlDataService=function(e,t,n){this.getDataServiceInternal(this._catalogUrlDataService,e,t,n)},i.prototype.getDataServiceInternal=function(t,r,a,o){if(t[r]==n&&(t[r]={spCatalogService:n,spCatalogServiceReady:n}),t[r].spCatalogService==n)if(t[r].spCatalogServiceReady==n){t[r].spCatalogServiceReady=o;var i={status:e.DataServiceResultCode.Failed,value:n},s=function(a,o){var s=t[r].spCatalogServiceReady;t[r].spCatalogServiceReady=n,a.status==e.DataServiceResultCode.Succeeded?(t[r].spCatalogService=o,i.value=o,i.status=e.DataServiceResultCode.Succeeded,s(i)):(i.httpStatus=a.httpStatus,s(i))};a.startActivity(e.Activity.Authentication);var c=e.SPCatalogProxyBasedCatalogService.getInstance(this._initParam);c.prepareProxy(r,a.correlationId,(function(t){a.stopActivity(e.Activity.Authentication),s(t,c)}))}else{var l=t[r].spCatalogServiceReady;t[r].spCatalogServiceReady=function(e){l(e),o(e)}}else o({status:e.DataServiceResultCode.Succeeded,value:t[r].spCatalogService})},i.prototype.createActivityScope=function(t,n,r){var o=this;this.getDataService(t,n,(function(i){if(!e.AsyncUtil.failed(i,r)){var s=i.value,c={cacheManager:o._cacheManager,storeId:t,telemetryContext:n},l=s.createScope(c),u=new a(c,o._initParam);r({status:e.DataServiceResultCode.Succeeded,value:{serviceScope:l,activityScope:u}})}}))},i.prototype.getEntitlementAsync=function(t,r,a,i,s,c){var l=this,u=function(s){s.status===e.DataServiceResultCode.Succeeded?(l.myOrgCatalogUrl=s.value,l.createActivityScope(s.value,r,(function(r){e.AsyncUtil.failed(r,a,[])||r.value.serviceScope.getEntitlementAsync(t,n,(function(t){if(!e.AsyncUtil.failed(t,a,[])){for(var n=t.value.entitlements,r=0;r<n.length;r++){var i=n[r];i.assetId=i.OfficeExtensionID,i.appVersion=i.OfficeExtensionVersion,i.storeId=l.myOrgCatalogUrl,i.storeType=o.StoreType.SPCatalog,i.targetType=o.OfficeAppType[i.OEType]}a({status:t.status,value:n})}}),i)}))):a({status:s.status,value:n})};(c=c||this.myOrgCatalogUrl||n)?u({status:e.DataServiceResultCode.Succeeded,value:c}):this.getSPCatalogUrl(r,u)},i.prototype.getAndCacheManifest=function(a,i,s,c){var l=this;this.getEntitlementAsync(r,s,(function(t){if(o.OUtil.writeProfilerMark(o.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd),t.status===e.DataServiceResultCode.Succeeded&&t.value){for(var r=t.value,i=r.length,u=n,d=0;d<i;d++){var f=r[d];f.OfficeExtensionID&&a.assetId&&f.OfficeExtensionID.toLowerCase()===a.assetId.toLowerCase()&&(u&&!o.OsfManifestManager.versionLessThan(u.OfficeExtensionVersion,f.OfficeExtensionVersion)||(u=f))}u!=n?l.createActivityScope(l.myOrgCatalogUrl,s,(function(t){e.AsyncUtil.failed(t,c)||t.value.activityScope.getManifest(t.value.serviceScope,u,(function(e){c({status:e.status,value:e.value.manifest})}))})):c({status:e.DataServiceResultCode.Failed,value:n})}else c({status:e.DataServiceResultCode.Failed,value:n})}),t,0,a.storeId)},i.prototype.isUpnMatchAsync=function(t,n,r){var a=this;this.getCatalogUrlDataService(this._initParam.spBaseUrl,n,(function(){e.SPCatalogProxyBasedCatalogService.getInstance(a._initParam).isUpnMatchAsync(t,a._initParam.spBaseUrl,n.correlationId,r)}))},i.prototype.activateAsync=function(t,n,r){var a=this;r.startActivity(e.Activity.Activation),r.startActivity(e.Activity.ServerCall),this.createActivityScope(t.storeId,r,(function(i){if(i.status==e.DataServiceResultCode.Succeeded){var s=i.value.serviceScope;i.value.activityScope.activate(s,t,n)}else e.LoaderUtil.failWithError(n,{description:o.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveMyOrganizationCatalogName),buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),a.activateAsync(t,n,r)},errorCode:o.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError})}))},i.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},i.prototype.getAppDetails=function(t,n,r,a){a({status:e.DataServiceResultCode.Failed})},i.prototype.getSPCatalogUrl=function(t,n){var r=this;this.getCatalogUrlDataService(this._initParam.spBaseUrl,t,(function(){e.SPCatalogProxyBasedCatalogService.getInstance(r._initParam).getSPCatalogUrl(r._initParam.spBaseUrl,t.correlationId,n)}))},i}();e.CatalogFactory.register(o.StoreType.SPCatalog,(function(e){return new i({applicationName:o.HostCapability[e.hostType],AppVersion:e.appVersion,clientMode:e.clientMode,appUILocale:e.appUILocale,spBaseUrl:e.spBaseUrl,docUrl:e.docUrl})}))}(d||(d={})),function(e){var t=function(){function e(){}return e.CheckProxyIsReady="OEM_isProxyReady",e.GetEntitlementSummary="OEM_getEntitlementSummaryAsync",e.GetManifest="OEM_getManifestAsync",e.GetSPCatalogUrl="OEM_getSPCatalogUrlAsync",e.IsUpnMatch="OEM_isUpnMatchAsync",e}();e.SPCatalogProxyMethods=t;var n=function(){function e(){this.iframeProxies={},this.iframeProxyCount=0}return e.iframeNamePrefix="__officeExtensionProxy",e}();e.IframeProxyGroup=n;var r=function(r){var a=null;function i(e,t){r.call(this),this.proxyUrl=e,this.iframeProxyGroup=t}return c(i,r),i.prototype.getEntitlementsAsync=function(e,n){this.invokeProxyCommandAsync(t.GetEntitlementSummary,e,n)},i.prototype.getManifestAsync=function(e,n){this.invokeProxyCommandAsync(t.GetManifest,e,n)},i.prototype.getSPCatalogUrlAsync=function(e,n){this.invokeProxyCommandAsync(t.GetSPCatalogUrl,e,n)},i.prototype.isUpnMatchAsync=function(e,n){this.invokeProxyCommandAsync(t.IsUpnMatch,e,n)},i.prototype.prepareProxy=function(e,t){var n=this;n.isReady?e({status:a,value:{clientEndpoint:n.clientEndPoint}}):n.clientEndPoint?n.pendingCallbacks.push([e,t]):n.createProxy(e,t)},i.resetProxy=function(e){delete e.iframeProxyGroup.iframeProxies[e.proxyUrl],e.iframeProxyGroup.iframeProxyCount=e.iframeProxyGroup.iframeProxyCount-1,Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e.conversationId)&&Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e.conversationId),e.iframe&&(o.OUtil.removeEventListener(e.iframe,"load",e.iframeOnload),e.iframe.parentNode.removeChild(e.iframe),e.iframe=a),e.clientEndPoint=a},i.prototype.createProxy=function(r,c){var l=this;try{if(!l.doesUrlHaveSupportedProtocol(l.proxyUrl))return void c({status:a,value:{errorMessage:"Protocal of proxyUrl is not supported."}});l.iframeProxyGroup.iframeProxies[l.proxyUrl]=l,l.iframeProxyGroup.iframeProxyCount=l.iframeProxyGroup.iframeProxyCount+1;var u=l.proxyUrl,d=u.length;"/"===u.charAt(d-1)&&(u=u.substr(0,d-1));var f=document.createElement("iframe"),p=n.iframeNamePrefix+l.iframeProxyGroup.iframeProxyCount;f.setAttribute("id",p),f.setAttribute("name",p);var m=u+"/_layouts/15/OfficeExtensionManager.aspx?"+l.conversationId,g=window.location.origin;m=o.OUtil.addXdmInfoAsHash(m,l.conversationId+"|"+p+"|"+g),m=o.OUtil.addSerializerVersionAsHash(m,o.SerializerVersion.Browser),m=o.OUtil.addFlightsAsHash(m,JSON.stringify(o.Flights)),f.setAttribute("scrolling","auto"),f.setAttribute("border","0"),f.setAttribute("width","0"),f.setAttribute("height","0"),f.setAttribute("style","position: absolute; left: -100px; top:0px;");var h=l;document.body.appendChild(f);var v=function(){if(h.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(h.conversationId,f.contentWindow,h.proxyUrl),h.clientEndPoint)h.clientEndPoint.invoke(t.CheckProxyIsReady,(function(e,t){var n=a;0===e&&t.status?(h.isReady=!0,n={status:a,value:{clientEndpoint:h.clientEndPoint}}):(i.resetProxy(h),n={status:a,value:{errorMessage:"isProxyReadyCallback failed, error code "+e}});for(var r=h.pendingCallbacks.length,o=0;o<r;o++){var s=h.pendingCallbacks.shift();h.isReady?s[0](n):s[1](n)}}),{__timeout__:2e3});else{var e="Unexpected error, iframe loaded again after failing OEM_isProxyReady";s.RuntimeTelemetryHelper.LogExceptionTag(e,a,a,18657365),c({status:a,value:{errorMessage:e}})}};o.OUtil.addEventListener(f,"load",v),f.setAttribute("src",m),l.iframeOnload=v,l.pendingCallbacks.push([r,c]),l.iframe=f}catch(t){var y="Error creating client endpoint with proxyUrl = ["+l.proxyUrl+"], msg:"+e.WACUtils.serializeObjectToString(t);c({status:a,value:{errorMessage:y}})}},i}(e.ProxyBase);e.SPCatalogProxy=r}(d||(d={})),function(e){var t="webUrl",n=null,r=function(){function r(t){this.proxyRetries={},this.initParams=t,this.iframeProxyGroup=new e.IframeProxyGroup}return r.getInstance=function(e){return r._instance==n&&(r._instance=new r(e)),r._instance},r.prototype.prepareProxy=function(t,r,a){r=r||"";this.proxyRetries[t]=1,this.ensureSPCatalogProxySetUp(t,r,(function(t){t&&t.status!=n?t.status:e.DataServiceResultCode.ProxyNotReady;a({status:t.status})}))},r.prototype.createScope=function(e){return new i(e,this)},r.prototype.getSPCatalogUrl=function(r,i,c){var l=this;this.prepareProxy(r,i,(function(){var u;if(r)if(u=l.iframeProxyGroup.iframeProxies[r]){var d={};d[t]=r,u.getSPCatalogUrlAsync(d,(function(t){var r="getspcatalogurl failed";t.status!==e.DataServiceResultCode.Succeeded&&(s.RuntimeTelemetryHelper.LogExceptionTag(r,n,i,19015125),a.msAjaxDebug.trace(r)),c(t)}))}else s.RuntimeTelemetryHelper.LogExceptionTag(o.OUtil.formatString("getspcatalogurl proxy not found, webUrl: {0}",r),n,i,19969545),c({status:e.DataServiceResultCode.ProxyNotReady});else s.RuntimeTelemetryHelper.LogExceptionTag("getspcatalogurl proxy URL empty",n,i,595190872),c({status:e.DataServiceResultCode.PrxoyUrlEmpty})}))},r.prototype.isUpnMatchAsync=function(r,i,c,l){var u=this;this.prepareProxy(i,c,(function(){var d;if(i)if(d=u.iframeProxyGroup.iframeProxies[i]){var f={};f.upn=r,f[t]=i,d.isUpnMatchAsync(f,(function(t){var r="isUpnMatchAsync failed";t.status!==e.DataServiceResultCode.Succeeded&&(s.RuntimeTelemetryHelper.LogExceptionTag(r,n,c,588814302),a.msAjaxDebug.trace(r)),l(t)}))}else s.RuntimeTelemetryHelper.LogExceptionTag(o.OUtil.formatString("isUpnMatchAsync proxy not found, webUrl: {0}",i),n,c,588814303),l({status:e.DataServiceResultCode.ProxyNotReady});else s.RuntimeTelemetryHelper.LogExceptionTag("isUpnMatchAsync proxy URL empty",n,c,588814301),l({status:e.DataServiceResultCode.PrxoyUrlEmpty})}))},r.prototype.ensureSPCatalogProxySetUp=function(t,r,a){if(!t)return s.RuntimeTelemetryHelper.LogExceptionTag("proxyUrl is null",n,r,19969546),void a({status:e.DataServiceResultCode.Failed});var i=this.iframeProxyGroup.iframeProxies[t];if(i||(i=new e.SPCatalogProxy(t,this.iframeProxyGroup)),i.isReady)a({status:e.DataServiceResultCode.Succeeded});else{var c=this,l=function(){a({status:e.DataServiceResultCode.Succeeded})},u=function(){c.proxyRetries[t]<o.Constants.AuthenticatedConnectMaxTries?(c.proxyRetries[t]++,i.prepareProxy(l,u)):(s.RuntimeTelemetryHelper.LogExceptionTag("sp exceed maximum tries and fail",n,r,18940555),a({status:e.DataServiceResultCode.ProxyNotReady}))};i.prepareProxy(l,u)}},r}();e.SPCatalogProxyBasedCatalogService=r;var i=function(){var r="clearCache";function a(e,t){this._catalogService=t,this.proxyUrl=e.storeId,this._correlationId=e.telemetryContext.correlationId||""}return a.prototype.tryFail=function(t,n,r){return t!=e.DataServiceResultCode.Succeeded&&(r({status:t}),!0)},a.prototype.getEntitlementAsync=function(e,n,a,o){var i=this,s=i,c=i._catalogService.iframeProxyGroup.iframeProxies[i.proxyUrl],l={};l[t]=i.proxyUrl,l.applicationName=i._catalogService.initParams.applicationName,l.officeExtentionTarget=n,l[r]=o||!1,l.supportedManifestVersions={"1.0":!0,1.1:!0},c.getEntitlementsAsync(l,(function(e){s.tryFail(e.status,e.httpStatus,a)?s.logServiceCallResponseError("entitlement",e.httpStatus):a(e)}))},a.prototype.getLastStoreUpdate=function(){},a.prototype.getManifest=function(e,t,n,a,o){var i=this,s=this._catalogService.iframeProxyGroup.iframeProxies[this.proxyUrl],c={};c.manifestUrl=e,c.id=t,c.version=n,c[r]=o,s.getManifestAsync(c,(function(e){i.tryFail(e.status,e.httpStatus,a)?i.logServiceCallResponseError("manifest",e.httpStatus):a(e)}))},a.prototype.isUpnMatchAsync=function(e,n){var r=this,a=r,o=r._catalogService.iframeProxyGroup.iframeProxies[r.proxyUrl],i={};i.upn=e,i[t]=r.proxyUrl,o.isUpnMatchAsync(i,(function(e){a.tryFail(e.status,e.httpStatus,n)?a.logServiceCallResponseError("isUpnMatch",e.httpStatus):n(e)}))},a.prototype.logServiceCallResponseError=function(e,t){var r="spproxy request "+e+" failed";t&&(r+=":"+t),s.RuntimeTelemetryHelper.LogExceptionTag(r,n,this._correlationId,18940556)},a}();e.SPCatalogProxyBasedCatalogServiceScope=i}(d||(d={})),o.InfoType={Error:0,Warning:1,Information:2,SecurityInfo:3},o.NotificationType={TrustYellowBar:0,TrustPromptTaskpane:3,TrustPromptContent:4},o.OmexMessageType={TabExit:1,ButtonClick:2,PageLoad:3},o._ErrorUXHelper=function(e){var t="progress_",n="input,a,button",r="moe-infobar-button2_",a=!0,i="moe-infobar-button_",c="moe-infobar-button",l=!1,u="button",f="moe-infobar-dismiss_",p="moe-infobar-dismiss",m="moe-infobar-message",g="moe-infobar-message_",h="moe-infobar-title",v="span",y="moe-infobar-message-div",b="moe-infobar-secinfo",C="moe-infobar-info",A="moe-infobar-warning",S="moe-infobar-error",_="moe-infobar-button-cell",O="moe-infobar-top-right-cell",I="moe-infobar-message-cell",x="moe-infobar-top-left-cell",T="presentation",E="role",M="moe-infobar-infotable",P="table",k="moe-infobar-body",R="alt",N=null,w="100%",D="center",U="no-repeat",F="alpha(opacity=100)",L="1",j="white",B="url(",H="onclick",V="tabindex",W="image",G="type",X="input",q="id",z="moe-background",K="class",J="div",Q="moe-trust-prompt-table_",Y="notificationbackground_",Z="moe-infobar-body_",$="agavedefaulticon96x96.png",ee="moe_status_icons.png",te="progress.gif",ne="img",re=e,ae=re.getOsfOmexBaseUrl(),oe="omexNotificationIframeClassName";o.OUtil.loadCSS(re.getLocalizedCSSFilePath("moeerrorux.css")),document.createElement(ne).src=re.getLocalizedImageFilePath(te),document.createElement(ne).src=re.getLocalizedImageFilePath(ee),document.createElement(ne).src=re.getLocalizedImageFilePath($);var ie={},se=0,ce=function(e){for(var t,n=e.childNodes.length,r=0;r<n;)"iframe"===(t=e.childNodes.item(r)).tagName.toLowerCase()?r++:(e.removeChild(t),n--)},le=function(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)},ue=function(e,t){var n;o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RemoveStage2Start),n=t?Z+e:Y+e;var r=Me(e);r&&ie[e][0].highPriority&&se--,le(n),r&&ie[e].shift(),o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RemoveStage2End)},de=function(e){o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RemoveStage2Start);var t=Q+e.id,n=Me(e.id);n&&ie[e.id][0].highPriority&&se--,le(t),n&&ie[e.id].shift(),o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RemoveStage2End)},fe=function(e){o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RenderStage1Start),ce(e.div);var t=document.createElement(J);t.setAttribute(K,z),t.setAttribute(q,"icon_"+e.id);var n=document.createElement(X);n.setAttribute(q,"iconImg_"+e.id),n.setAttribute(G,W),n.setAttribute(V,"0"),n.src=re.getLocalizedImageFilePath(ee);var r,a,i;n.setAttribute(H,"getIntoStage2(params)"),o.OUtil.attachClickHandler(n,(function(){!function(e){e.sqmDWords[1]|=2,_e(e.id);var t=d.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();t&&t.enableSingleSignOnForAddin?me(e):pe(e)}(e)})),t.appendChild(n),e.displayDeactive&&(t.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",t.style.backgroundColor=j,t.style.opacity=L,t.style.filter=F,t.style.backgroundRepeat=U,t.style.backgroundPosition=D,t.style.height=w),e.infoType===o.InfoType.Error?(r="moe-status-error-icon",a="iconImg_error_"+e.id,i=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===o.InfoType.Warning?(r="moe-status-warning-icon",a="iconImg_warning_"+e.id,i=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===o.InfoType.Information?(r="moe-status-info-icon",a="iconImg_info_"+e.id,i=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(r="moe-status-secinfo-icon",a="iconImg_secinfo_"+e.id,i=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)!=N&&9==parseFloat(RegExp.$1)&&(r+="_ie"),n.setAttribute(K,r),n.setAttribute(q,a),n.setAttribute(R,i),0!=e.div.childNodes.length?e.div.insertBefore(t,e.div.childNodes[0]):e.div.appendChild(t),Ie(e.id,o.AgaveHostAction.TabIn),o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RenderStage1End)},pe=function(e){o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RenderStage2Start),ce(e.div);var t=e.description;e.title.length>100&&(e.title=e.title.substring(0,99)),e.description.length>255&&(e.description=e.description.substring(0,254));var n=Z+e.id,d=document.getElementById(n);null==d&&((d=document.createElement(J)).setAttribute(K,k),d.setAttribute(q,n));var Q=document.createElement(J);Q.innerHTML=t,d.setAttribute("title",Q.textContent),Q=N;var te=document.createElement(P);te.setAttribute(K,M),te.setAttribute(E,T);for(var ae=0;ae<3;ae++)te.insertRow(ae).setAttribute(E,T);var oe=te.rows;oe[0].insertCell(0),oe[0].insertCell(1),oe[0].insertCell(2),oe[0].cells[1].setAttribute("rowSpan","2"),oe[1].insertCell(0),oe[1].insertCell(1),oe[2].insertCell(0),oe[2].insertCell(1),oe[2].insertCell(2),oe[0].cells[0].setAttribute(K,x),oe[0].cells[1].setAttribute(K,I),oe[0].cells[2].setAttribute(K,O),oe[2].cells[1].setAttribute(K,_);var ie,se,le=document.createElement(ne);le.src=re.getLocalizedImageFilePath(ee),e.infoType===o.InfoType.Error?(ie=S,se=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===o.InfoType.Warning?(ie=A,se=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===o.InfoType.Information?(ie=C,se=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(ie=b,se=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),le.setAttribute(K,ie),le.setAttribute(R,se),oe[0].cells[0].appendChild(le);var de=document.createElement("a");de.setAttribute(K,y),de.setAttribute(V,L);var fe=document.createElement(v);fe.setAttribute(K,h),fe.innerHTML=e.title;var pe=g+e.id,me=document.getElementById(pe);null==me&&((me=document.createElement(v)).setAttribute(K,m),me.setAttribute(q,pe)),me.innerHTML=e.description,de.appendChild(fe),de.appendChild(me),oe[0].cells[1].appendChild(de);var ge=function(e){var t=re.getOsfControl(e.id);s.AppNotificationHelper.LogNotification(t._appCorrelationId,e.sqmDWords[0],e.sqmDWords[1])},he=function(){e.sqmDWords[1]|=8,ge(e),!e.reDisplay&&ue(e.id,e.displayDeactive),_e(e.id),e.reDisplay?Te(e):Ee(e.id),e.dismissCallback&&e.dismissCallback()},ve=document.createElement(X);ve.setAttribute(G,W),ve.setAttribute("src",re.getLocalizedImageFilePath(ee)),ve.setAttribute(K,p),ve.setAttribute(q,f+e.id),ve.setAttribute(V,"0"),ve.setAttribute(R,Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT),ve.setAttribute(E,u),ve.setAttribute(H,"handleDismiss();"),o.OUtil.attachClickHandler(ve,he),oe[0].cells[2].appendChild(ve),e.detailView=l;var ye=document.createElement(u);if(ye.setAttribute(K,c),ye.innerHTML=e.buttonTxt,ye.setAttribute(q,i+e.id),ye.setAttribute(V,L),ye.setAttribute(G,u),e.buttonCallback){ye.setAttribute(H,"handleButtonClick()"),o.OUtil.attachClickHandler(ye,(function(){if(e.sqmDWords[1]|=4,ge(e),ue(e.id,l),_e(e.id),Ee(e.id),e.retryAll===a){var t=re.getOsfControl(e.id);t._retryActivate=N,re.retryAll(t._marketplaceID)}e.buttonCallback()}))}else ye.setAttribute(H,"handleDismiss()"),o.OUtil.attachClickHandler(ye,he);if(oe[2].cells[1].appendChild(ye),e.url){var be=document.createElement(u);be.setAttribute(K,c),be.innerHTML=e.urlButtonTxt?e.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT,be.setAttribute(q,r+e.id),be.setAttribute(H,"moreInfoButtonClick()"),o.OUtil.attachClickHandler(be,(function(){e.sqmDWords[1]|=4,ge(e),e.sqmDWords[1]=1,window.open(e.url)})),be.setAttribute(V,L),be.setAttribute(G,u),oe[2].cells[1].appendChild(be)}d.appendChild(te);var Ce=document.createElement(J);Ce.setAttribute(K,z),Ce.setAttribute(q,Y+e.id),e.displayDeactive&&(Ce.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",Ce.style.backgroundColor=j,Ce.style.opacity=L,Ce.style.filter=F,Ce.style.backgroundRepeat=U,Ce.style.backgroundPosition=D,Ce.style.height=w),Ce.appendChild(d),0!=e.div.childNodes.length?e.div.insertBefore(Ce,e.div.childNodes[0]):e.div.appendChild(Ce),Ie(e.id,o.AgaveHostAction.TabIn),o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RenderStage2End)},me=function(e){o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RenderStage2Start);try{ce(e.div);var t=e.description;e.title.length>100&&(e.title=e.title.substring(0,99)),e.description.length>255&&(e.description=e.description.substring(0,254));var n=Z+e.id,r=document.getElementById(n);null==r&&((r=document.createElement(J)).className=k,r.id=n),r.title=t,e.iframeNotificationUrl?r.appendChild(ve(e,r)):r.appendChild(he(e));var a=document.createElement(J);a.className=z,a.id=Y+e.id,e.displayDeactive&&(a.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",a.style.backgroundColor=j,a.style.opacity=L,a.style.filter=F,a.style.backgroundRepeat=U,a.style.backgroundPosition=D,a.style.height=w),a.appendChild(r),0!=e.div.childNodes.length?e.div.insertBefore(a,e.div.childNodes[0]):e.div.appendChild(a),Ie(e.id,o.AgaveHostAction.TabIn)}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to show infobar, error message: ",e,N,23455900)}o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RenderStage2End)},ge=function(e){var t="moe-trust-prompt-description-id";o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RenderStage2Start);try{ce(e.div);var n=function(e){function t(e,t){var n=e.insertRow(-1);n.className="moe-trust-prompt-row "+t,n.setAttribute(E,T),n.insertCell(-1).className="moe-trust-prompt-cell"}e.id;var n=Q+e.id,r=document.getElementById(n);r===N&&((r=document.createElement(P)).id=n,r.className="moe-trust-prompt-table",r.setAttribute(E,T)),t(r.createTHead(),"moe-trust-prompt-header");var a=r.createTBody();return t(a,"moe-trust-prompt-preview"),t(a,"moe-trust-prompt-description"),t(r.createTFoot(),"moe-trust-prompt-footer"),r}(e),r=n.rows,i=function(e){var t=document.createElement("p");return t.innerHTML=e.notificationType===o.NotificationType.TrustPromptContent?e.name:e.title,t.className="moe-trust-prompt-header-title",t}(e);r[0].cells[0].appendChild(i);var c=function(e){var t=document.createElement(ne);return t.src=e.icon,t.className="moe-trust-prompt-preview-img",t.setAttribute(R,e.iconTitle),t}(e),l=function(e){var t=document.createElement("p");return t.innerHTML=e.name,t.className="moe-trust-prompt-preview-title",t}(e),d=function(e){var t=document.createElement("p");return t.innerHTML=e.provider,t.className="moe-trust-prompt-preview-sub",t}(e);r[1].cells[0].appendChild(c),r[1].cells[0].appendChild(l),r[1].cells[0].appendChild(d);var f=function(e){var n=document.createElement("p");return n.innerHTML=e.description,n.className="moe-trust-prompt-description-text",n.id=t,n}(e);r[2].cells[0].appendChild(f);var p=function(){var n,r=document.createElement(u);return r.textContent=e.buttonTxt,r.className="moe-trust-prompt-button moe-trust-prompt-button-primary moe-trust-prompt-buttons-action",r.id="moe-trust-prompt-buttons-action_"+e.id,r.tabIndex=0,r.type=u,r.setAttribute("aria-describedby",t),n=e.buttonCallback?function(){if(e.sqmDWords[1]|=4,Ce(e),de(e),_e(e.id),Ee(e.id),e.retryAll===a){var t=re.getOsfControl(e.id);t._retryActivate=N,re.retryAll(t._marketplaceID)}e.buttonCallback()}:function(){e.sqmDWords[1]|=8,Ce(e),!e.reDisplay&&de(e),_e(e.id),e.reDisplay?Te(e):Ee(e.id),e.dismissCallback&&e.dismissCallback()},o.OUtil.attachClickHandler(r,n),r}();if(r[3].cells[0].appendChild(p),e.url!==N){var m=function(e){var t=document.createElement(u);return t.textContent=e.urlButtonTxt||Strings.OsfRuntime.L_MoreInfoButton_TXT,t.className="moe-trust-prompt-button moe-trust-prompt-buttons-url",t.id="moe-trust-prompt-buttons-url_"+e.id,t.tabIndex=0,t.type=u,o.OUtil.attachClickHandler(t,(function(){e.sqmDWords[1]|=4,Ce(e),window.open(e.url)})),t}(e);r[3].cells[0].appendChild(m)}var g=function(e){var t=document.createElement(J);t.className="moe-trust-prompt-collapse cui-ctl-iconContainer cui-img-cont-float cui-img-16by16";var n=document.createElement(ne);switch(e.clientName){case"WAC_Powerpoint":n.src=re.getLocalizedImageFilePath("per.png"),n.className="per_UpChevron_16x16x32";break;case"WAC_Word":n.src=re.getLocalizedImageFilePath("we.png"),n.className="we_UpChevron_16x16x32";break;case"WAC_Excel":n.src=re.getLocalizedImageFilePath("EwaEdit.png"),n.className="ewaboot_UpChevron16"}return n.alt=Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT,t.appendChild(n),o.OUtil.attachClickHandler(t,(function(){var t="collapsed";e.collapsed===a?e.div.classList.remove(t):e.div.classList.add(t),e.collapsed=!e.collapsed})),t}(e);0!=e.div.childNodes.length?e.div.insertBefore(n,e.div.childNodes[0]):e.div.appendChild(n),e.div.appendChild(g),e.div.style.overflowY="auto",e.div.classList.add("moe-trust-prompt"),e.div.classList.add(e.clientName),e.div.classList.add(e.notificationType===o.NotificationType.TrustPromptContent?"content-add-in":"taskpane-add-in"),Ie(e.id,o.AgaveHostAction.TabIn)}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to show trust prompt, error message: ",e,N,38592974)}o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RenderStage2End)},he=function(e){var t=ye(e),n=t.rows;n[0].cells[0].appendChild(be(e));var s=document.createElement("a");s.className=y,s.tabIndex=1;var d=document.createElement(v);d.className=h,d.textContent=e.title;var f=g+e.id,p=document.getElementById(f);null==p&&((p=document.createElement(v)).className=m,p.id=f),p.textContent=e.description,s.appendChild(d),s.appendChild(p),n[0].cells[1].appendChild(s);var b=function(){Ae(e)},C=Se(e);o.OUtil.attachClickHandler(C,b),n[0].cells[2].appendChild(C),e.detailView=l;var A=document.createElement(u);if(A.className=c,A.textContent=e.buttonTxt,A.id=i+e.id,A.tabIndex=1,A.type=u,e.buttonCallback){o.OUtil.attachClickHandler(A,(function(){if(e.sqmDWords[1]|=4,Ce(e),ue(e.id,l),_e(e.id),Ee(e.id),e.retryAll===a){var t=re.getOsfControl(e.id);t._retryActivate=N,re.retryAll(t._marketplaceID)}e.buttonCallback()}))}else o.OUtil.attachClickHandler(A,b);if(n[2].cells[1].appendChild(A),e.url){var S=document.createElement(u);S.className=c,S.textContent=e.urlButtonTxt?e.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT,S.id=r+e.id,o.OUtil.attachClickHandler(S,(function(){e.sqmDWords[1]|=4,Ce(e),e.sqmDWords[1]=1,window.open(e.url)})),S.tabIndex=1,S.type=u,n[2].cells[1].appendChild(S)}return t},ve=function(e,t){var n="message",r=ye(e),i=r.rows,c=document.createElement("iframe");window.getComputedStyle(e.div,N);c.width=w,c.frameBorder="0",c.className=oe,c.src=e.iframeNotificationUrl,i[0].cells[1].appendChild(c);var u="moe-hovered";t.addEventListener("mouseenter",(function(){o.OUtil.addClass(t,u),c.contentWindow.postMessage(o.AgaveHostAction.MouseEnter,ae)})),t.addEventListener("mouseleave",(function(){o.OUtil.removeClass(t,u),c.contentWindow.postMessage(o.AgaveHostAction.MouseLeave,ae)})),e.detailView=l;var d=N,f=Se(e);return o.OUtil.attachClickHandler(f,(function(){Ae(e),window.removeEventListener(n,d)})),i[0].cells[2].appendChild(f),f.addEventListener("keydown",(function(e){9==e.keyCode&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),c.contentWindow.postMessage(o.AgaveHostAction.TabInShift,ae))})),e.buttonCallback&&(d=function(t){try{if(t.source==c.contentWindow){var r=JSON.parse(t.data),i=parseInt(r[o.OmexMessageKeys.MessageType]),u=parseInt(r[o.OmexMessageKeys.MessageValue]);if(i==o.OmexMessageType.ConsentResult){if(ue(e.id,l),_e(e.id),Ee(e.id),e.retryAll===a&&(e.notificationType==o.NotificationType.TrustYellowBar||e.notificationType==o.NotificationType.ConsentYellowBar&&u==o.ConsentResultCode.Success)){var p=re.getOsfControl(e.id);p._retryActivate=N,re.retryAll(p._marketplaceID)}window.removeEventListener(n,d),e.buttonCallback(u)}else i==o.OmexMessageType.TabExit&&(u==o.AgaveHostAction.TabExitShift&&re._notifyHost?re._notifyHost(e.id,o.AgaveHostAction.TabExitShift):u==o.AgaveHostAction.TabExit&&(window.focus(),f.focus()))}}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Exception in receivedMessageHandler: ",e,N,23455901)}},window.addEventListener(n,d)),r},ye=function(e){var t=document.createElement(P);t.className=M,t.setAttribute(E,T);for(var n=e.iframeNotificationUrl?1:3,r=0;r<n;r++){t.insertRow(r).setAttribute(E,T)}var a=t.rows;return a[0].insertCell(0),a[0].insertCell(1),a[0].insertCell(2),a[0].cells[1].setAttribute("rowSpan","2"),a[0].cells[0].setAttribute(K,x),a[0].cells[1].setAttribute(K,I),a[0].cells[2].setAttribute(K,O),e.iframeNotificationUrl==N&&(a[1].insertCell(0),a[1].insertCell(1),a[2].insertCell(0),a[2].insertCell(1),a[2].insertCell(2),a[2].cells[1].setAttribute(K,_)),a[0].cells[0].appendChild(be(e)),t},be=function(e){var t,n,r=document.createElement(ne);return r.src=re.getLocalizedImageFilePath(ee),e.infoType===o.InfoType.Error?(t=S,n=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===o.InfoType.Warning?(t=A,n=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===o.InfoType.Information?(t=C,n=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(t=b,n=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),r.className=t,r.alt=n,r},Ce=function(e){var t=re.getOsfControl(e.id);s.AppNotificationHelper.LogNotification(t._appCorrelationId,e.sqmDWords[0],e.sqmDWords[1])},Ae=function(e){e.sqmDWords[1]|=8,Ce(e),!e.reDisplay&&ue(e.id,e.displayDeactive),_e(e.id),e.reDisplay?Te(e):Ee(e.id),e.dismissCallback&&e.dismissCallback()},Se=function(e){var t=document.createElement(X);return t.type=W,t.src=re.getLocalizedImageFilePath(ee),t.className=p,t.id=f+e.id,t.tabIndex=0,t.alt=Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT,t.setAttribute(E,u),t},_e=function(e){var t=re.getOsfControl(e);t&&(t._controlFocus=a)},Oe=function(e){var t=re.getOsfControl(e);if(t&&!Me(e))if(t.getStatus()===o.OsfControlStatus.Activated&&t.getPageStatus()===o.OsfControlPageStatus.Ready)t.notifyAgave(o.AgaveHostAction.TabIn);else{var n="_trySetFocusInAppContent$newCallback";if(t._notifyHostIFrameOnLoaded&&t._notifyHostIFrameOnLoaded.newCallbackIdentity&&t._notifyHostIFrameOnLoaded.newCallbackIdentity===n)return;var r=function(e){return function(){if(e)try{e()}catch(e){}t.getStatus()===o.OsfControlStatus.Activated&&t.getPageStatus()===o.OsfControlPageStatus.Ready&&t.notifyAgave(o.AgaveHostAction.TabIn),t._notifyHostIFrameOnLoaded=e}}(t._notifyHostIFrameOnLoaded);r.newCallbackIdentity=n,t._notifyHostIFrameOnLoaded=r}},Ie=function(e,t){var r=re.getOsfControl(e);if(r&&r._controlFocus)if(Me(e)){var a=ie[e][0];if(a&&a.div)if(a.iframeNotificationUrl!=N){var i=a.div.getElementsByClassName(oe)[0];i&&(i.contentWindow.postMessage(o.AgaveHostAction.TabIn,ae),re._notifyHost&&re._notifyHost(e,o.AgaveHostAction.SelectWithError))}else{var s=a.div.querySelectorAll(n);if(s&&s.length>0){var c=s[0];c instanceof HTMLElement&&(window.focus(),c.focus(),re._notifyHost&&re._notifyHost(e,o.AgaveHostAction.SelectWithError))}}}else r.notifyAgave(t)},xe=function(e,t){var r=re.getOsfControl(e);if(r&&r._controlFocus)if(Me(e)){var a=ie[e][0];if(a&&a.div){var i=a.div.querySelectorAll(n);if(i&&i.length>0){var s=i.length>1?i[1]:i[0];s instanceof HTMLElement&&(window.focus(),s.focus(),re._notifyHost&&re._notifyHost(e,o.AgaveHostAction.SelectWithError))}}}else r._controlFocus=l,re._notifyHost(e,t)},Te=function(e){if(e.notificationType!==o.NotificationType.TrustPromptContent&&e.notificationType!==o.NotificationType.TrustPromptTaskpane)if(null==e.detailView||e.detailView===l)e.sqmDWords[1]=0,fe(e);else{e.sqmDWords[1]=1;var t=d.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();t&&t.enableSingleSignOnForAddin?me(e):pe(e)}else ge(e)},Ee=function(e){if(Me(e)){var t=ie[e][0];Te(t)}else Oe(e)},Me=function(e){return ie[e]&&ie[e].length>0};return{showProgress:function(e,n){try{if(o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RenderLoadingAnimationStart),!document.getElementById(t+n)){ie[n]=[];var r=document.createElement(J);r.setAttribute(K,z),r.setAttribute(q,t+n),r.style.backgroundColor="rgba(255, 255, 255, 0.5)",r.style.opacity=L,r.style.filter=F,r.style.height=w;var a=document.createElement(J);a.style.width=w,a.style.height=w,a.style.backgroundImage=B+re.getLocalizedImageFilePath(te)+")",a.style.backgroundRepeat=U,a.style.backgroundPosition=D,r.appendChild(a),e.appendChild(r)}o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RenderLoadingAnimationEnd)}catch(e){}},showNotification:function(e){e.sqmDWords=[e.errorCode,0],delete e.errorCode,null==e.highPriority&&(e.highPriority=e.infoType===o.InfoType.Error?a:l),null==e.reDisplay&&(e.reDisplay=e.infoType===o.InfoType.Error?a:l);var t=ie[e.id];void 0===t&&(t=[],ie[e.id]=t),e.highPriority===l?t.push(e):(t.splice(se,0,e),se++),(1===ie[e.id].length||e.highPriority)&&Te(t[0])},showICon:function(e){fe(e)},removeDOMElement:function(e){le(e)},removeProgressDiv:function(e,n){o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RemoveLoadingAnimationStart),e.ownerDocument.getElementById(t+n)&&ce(e),o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RemoveLoadingAnimationEnd)},removeIConDiv:function(e){!function(e){o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RemoveStage1Start),le("icon_"+e),o.OUtil.writeProfilerMark(o.NotificationUxPerfMarker.RemoveStage1End)}(e)},removeInfoBarDiv:function(e,t){ue(e,t)},dismissMessages:function(e){!function(e){if(ie[e]){if(ie[e].length>0){var t=ie[e][0].div;ce(t)}delete ie[e]}}(e)},getHTMLEncodedString:function(e){return function(e){var t=document.createElement(J),n=document.createTextNode(e);return t.appendChild(n),t.innerHTML}(e)},purgeOsfControlNotification:function(e){var t=ie[e],n=re.getOsfControl(e);t&&t.length>0&&n&&s.AppNotificationHelper.LogNotification(e,t[0].sqmDWords[0],t[0].sqmDWords[1])},focusOnNotificationUx:function(e,t){_e(e),Ie(e,t)},focusOnNotificationUxShiftIn:function(e,t){_e(e),xe(e,t)},appHasNotifications:function(e){return Me(e)}}},function(e){var t,n="web",r="default";!function(e){e[e[r]=0]=r,e[e[n]=1]=n,e[e.win32=2]="win32",e[e.mac=3]="mac"}(t||(t={}));var a=function(){var a="resources.default",i="resources",c="Extended Manifest",l="string",u="^\\$\\{resource\\.([A-Za-z0-9_-]+)\\}$",d=null,f=!0;function p(){}return p.ensureFinalExtendedOverridesUrls=function(t,n){var r=t.getExtendedOverrides();r.hasFinalUrls||(r.url=e.ExtendedManifestUtility.ensureFinalExtendedOverridesUrl(t.getExtendedOverrides().url,t,n),t.getExtendedOverrides().resourcesUrl&&(r.resourcesUrl=e.ExtendedManifestUtility.ensureFinalExtendedOverridesUrl(t.getExtendedOverrides().resourcesUrl,t,n)),r.hasFinalUrls=f)},p.ensureFinalExtendedOverridesUrl=function(e,t,n){var r=p.computeUrlTokens(t,n);return p.substituteUrlTokens(e,r)},p.computeUrlTokens=function(e,t){for(var n=e.getExtendedOverridesTokens(),r={},a=0;a<n.length;++a)n[a].type==o.ExtendedManifestSupportTokens.Requirements?r[n[a].name]=p.computeRequirementsToken(n[a],t):n[a].type==o.ExtendedManifestSupportTokens.Locale?r[n[a].name]=p.computeLocaleToken(n[a],t):r[n[a].name]=n[a].defaultValue;return r},p.computeRequirementsToken=function(e,t){for(var n=e.defaultValue,r=e.overrides,a=0;a<r.length;++a)t._requirementsChecker._checkSets(r[a].data.sets)&&t._requirementsChecker._checkMethods(r[a].data.methods)&&(n=r[a].value);return n},p.computeLocaleToken=function(e,t){for(var n=e.defaultValue.toLowerCase(),r=t.getAppUILocale().toLowerCase(),a=r.replace(/-.+/,"-*"),o=e.overrides,i=0;i<o.length;++i){var s=o[i];if(r==s.data){n=s.value;break}a==s.data&&(n=s.value)}return n},p.substituteUrlTokens=function(e,t){return e.replace(new RegExp(o.ExtendedManifestSupportTokens.TokenReplaceRegex,"g"),(function(e,n,r,a){return p.substituteMatchWithTokenValue(e,n,r,a,t)}))},p.downloadContent=function(e){return new Promise((function(t,n){o.OUtil.xhrGet(e,(function(e){e?t(e):n(-1)}),(function(e){n(e)}))}))},p.substituteMatchWithResourceValue=function(t,n,r,a){if(r&&"object"==typeof r[n])return r[n].value;if(a&&"object"==typeof a[n])return a[n].value;throw s.RuntimeTelemetryHelper.LogExceptionTag("Missing Extended Manifest Resource Token value",d,d,0),new e.OsfRuntimeError(e.OsfRuntimeErrorCode.tokenError,"Missing Extended Manifest Resource token value")},p.replaceResourceTokens=function(e,t,n){var r=new RegExp(u);return e.replace(r,(function(e,r){return p.substituteMatchWithResourceValue(e,r,t,n)}))},p.constructExtendedManifest=function(e,t){var a=void 0;e.resources&&(a=e.resources[r]);var o=e.shortcuts,i=e.actions;if(o)for(var c=0;c<o.length;c++)o[c].key[n]&&(o[c].key[n]=p.replaceResourceTokens(o[c].key[n],t,a)),o[c].key[r]&&(o[c].key[r]=p.replaceResourceTokens(o[c].key[r],t,a)),!o[c].key[r]&&!o[c].key[n]&&s.RuntimeTelemetryHelper.LogExceptionTag("Error: No valid platform for shortcut",d,d,d);if(i)for(c=0;c<i.length;c++)i[c].name=p.replaceResourceTokens(i[c].name,t,a);return{shortcuts:o,actions:i}},p.substituteMatchWithTokenValue=function(t,n,r,a,o){var i="Missing ExtendedOverrides Token value";if(typeof o[n]===l)return o[n];throw s.RuntimeTelemetryHelper.LogExceptionTag(i,d,d,0),new e.OsfRuntimeError(e.OsfRuntimeErrorCode.tokenError,i)},p.validateExtendedOverrides=function(t){var n,o=[],l=t.resources,f=t.shortcuts,p=t.actions,m=new RegExp(u),g=new RegExp(".*\\$\\{resource\\.([A-Za-z0-9_-]+)\\}.*"),h=e.ExtendedManifestUtility.validateShortcuts(f,m,g),v=e.ExtendedManifestUtility.validateActions(p,m,g,h.neededActionIds);if(o=h.errors.concat(v.errors),n=h.tokens.concat(h.tokens),h.needsResources&&v.needsResources)if(l)if(Object.keys(l).length>1&&o.push(e.ExtendedManifestValidationErrorMessages.invalidProperty(c,i,"1 locale",Object.keys(l).length+" locales")),l[r]){var y=e.ExtendedManifestUtility.validateExtendedOverridesResources(l[r],n,!1);o=o.concat(y)}else o.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(c,a));else o.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(c,i));return o.length>0&&s.RuntimeTelemetryHelper.LogExceptionTag("Invalid extended manifest",d,d,0),{errors:o,tokens:n,needsResources:!1}},p.validateShortcuts=function(n,r,a){var o="shortcuts[",i=[],s=!1,u=[],d={};if(n)for(var p=0;p<n.length;++p)if(n[p].action?d[n[p].action]=f:i.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(c,o+p+"].action")),n[p].key)for(var m in n[p].key)m in t?r.test(n[p].key[m])?(u.push(n[p].key[m]),s=f):a.test(n[p].key[m])?i.push(e.ExtendedManifestValidationErrorMessages.invalidValue(c,o+p+"].key."+m,n[p].key[m])):typeof n[p].key[m]!==l&&i.push(e.ExtendedManifestValidationErrorMessages.invalidType(c,o+p+"].key.",l,typeof n[p].key[m])):i.push(e.ExtendedManifestValidationErrorMessages.invalidValue(c,o+p+"].key",m));else i.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(c,o+p+"].key"));return{errors:i,tokens:u,needsResources:s,neededActionIds:d}},p.validateActions=function(t,n,r,a){var o="].name",i="actions[",s=[],u=[],d=!1,p={};if(t)for(var m=0;m<t.length;++m)t[m].id?(a[t[m].id]&&delete a[t[m].id],p[t[m].id]?s.push(e.ExtendedManifestValidationErrorMessages.duplicateValue(c,i+m+"].id",t[m].id)):p[t[m].id]=f):s.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(c,i+m+"].id")),t[m].type||(t[m].type="ExecuteFunction"),t[m].name?n.test(t[m].name)?(u.push(t[m].name),d=f):r.test(t[m].name)?s.push(e.ExtendedManifestValidationErrorMessages.invalidValue(c,i+m+o,t[m].name)):typeof t[m].name!==l&&s.push(e.ExtendedManifestValidationErrorMessages.invalidType(c,i+m+o,l,typeof t[m].name)):s.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(c,i+m+o));for(var g=Object.keys(a),h=0;h<g.length;h++)s.push(e.ExtendedManifestValidationErrorMessages.missingMatchingActionId(g[h]));return{errors:s,tokens:u,needsResources:d}},p.validateExtendedOverridesResources=function(t,n,r){var o="Extended Manifest Resources",l=[];if(!t)return l;for(var f=Object.keys(t),p=new RegExp(u),m=0;m<n.length;m++){var g=n[m],h=p.exec(g)[1],v=t[h];v?v.value||(r?l.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(o,"resources["+f.indexOf(h)+"].value")):l.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(c,"resources.default["+f.indexOf(h)+"].value"))):r?l.push(e.ExtendedManifestValidationErrorMessages.missingRequiredValue(o,i,g)):l.push(e.ExtendedManifestValidationErrorMessages.missingRequiredValue(c,a,g))}return l.length>0&&s.RuntimeTelemetryHelper.LogExceptionTag("Invalid extended manifest resources",d,d,0),l},p.validateAndSubstituteExtendedManifestTokens=function(t,n){var r=e.ExtendedManifestUtility.validateExtendedOverrides(t),a=e.ExtendedManifestUtility.validateExtendedOverridesResources(n,r.tokens,f);if(0==r.errors.concat(a).length)return e.ExtendedManifestUtility.constructExtendedManifest(t,n);throw new e.OsfRuntimeError(e.OsfRuntimeErrorCode.invalidExtendedOverride,"Invalid Extended Override")},p}();e.ExtendedManifestUtility=a}(d||(d={})),function(e){var t=function(){var e=", expected = ",t=", value = ",n="[";function r(){}return r.missingRequiredProperty=function(e,t){return n+e+"][Parsing][Missing Required Property] property = "+t},r.invalidValue=function(e,r,a){return n+e+"][Parsing][Invalid Value] property = "+r+t+a},r.invalidType=function(r,a,o,i){return n+r+"][Parsing][Invalid Type] property = "+a+e+o+t+i},r.invalidProperty=function(r,a,o,i){return n+r+"][Parsing][Invalid Property] property = "+a+e+o+t+i},r.missingRequiredValue=function(t,r,a){return n+t+"][Parsing][Missing Required Value] property = "+r+e+a},r.missingMatchingActionId=function(e){return"[Extended Manifest][Parsing][Missing Matching Action Id] expected = "+e},r.duplicateValue=function(e,r,a){return n+e+"][Parsing][Duplicate Value] property = "+r+t+a},r}();e.ExtendedManifestValidationErrorMessages=t}(d||(d={})),function(e){var t=function(){function e(){}return e.setHostFeatureEnabledInfo=function(e){this._hostFeatureEnabledInfo=e},e.getHostFeatureEnabledInfo=function(){return this._hostFeatureEnabledInfo},e}();e.HostFeatureEnabledInfo=t}(d||(d={})),function(e){var t=function(){function e(){}return e.prototype.get=function(e,t){return this.openTransaction(e).then((function(n){return new Promise((function(r,a){var o=n.objectStore(e).get(t);o.onsuccess=function(e){var t=e.target.result;r(t)},o.onerror=function(e){a(e)}}))}))},e.prototype.set=function(e,t,n){return this.openTransaction(e).then((function(r){return new Promise((function(a,o){var i=r.objectStore(e).put(n,t);i.onsuccess=function(){a()},i.onerror=function(e){o(e)}}))}))},e.prototype.openDB=function(e){var t=window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.indexedDB;return new Promise((function(n,r){var a=t.open(e);a.onupgradeneeded=function(){var t=a.result;!t.objectStoreNames.contains(e)&&t.createObjectStore(e)},a.onsuccess=function(){var e=a.result;n(e)},a.onerror=function(e){r(e)}}))},e.prototype.openTransaction=function(e){return this.openDB(e).then((function(t){return t.transaction(e,"readwrite")}))},e}(),n=function(){function e(){}return e.prototype.get=function(e,t){var n=localStorage.getItem(e.concat("_",t));return Promise.resolve(n)},e.prototype.set=function(e,t,n){return localStorage.setItem(e.concat("_",t),n),Promise.resolve()},e}(),r=function(){var e=null,r="The browser does not support Web Storage";function a(){this.indexedDB=window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.indexedDB}return a.get=function(t,n){var a=this.getOrCreateOsfCache();return a?a.get(t,n):(s.RuntimeTelemetryHelper.LogCommonMessageTag(r,e,0),Promise.resolve(e))},a.set=function(t,n,a){var o=this.getOrCreateOsfCache();return o?o.set(t,n,a):(s.RuntimeTelemetryHelper.LogCommonMessageTag(r,e,0),Promise.resolve(e))},a.getOrCreateOsfCache=function(){var r="undefined";return a.instance==e&&(typeof indexedDB!=r?a.instance=new t:typeof localStorage!=r&&(a.instance=new n)),a.instance},a.c_osfCacheTableName="OSF.Cache",a.c_extendedManifestTableName="OSF.ExtendedManifest",a.c_extendedManifestResourcesTableName="OSF.ExtendedManifestResources",a}();e.OsfCache=r}(d||(d={})),o.OUtil.setNamespace("AppSpecificSetup",o),o.ContextActivationManager=function(e){var t="0",n="osfControl for the given ID doesn't exist.",r="object",i="string",c="DevConsoleEnabled",l="IsReactMLR",u=null,f=!0,p=!1,m=this,g=m;if(o.OUtil.validateParamObject(e,{appName:{type:Number,mayBeNull:p},appVersion:{type:String,mayBeNull:p},clientMode:{type:Number,mayBeNull:p},appUILocale:{type:String,mayBeNull:p},dataLocale:{type:String,mayBeNull:p},osfOmexBaseUrl:{type:String,mayBeNull:f},devCatalogUrl:{type:String,mayBeNull:f},oneDriveCatalogBaseApiUrl:{type:String,mayBeNull:f},sdxCdnUrl:{type:String,mayBeNull:f},sdxDmsUrl:{type:String,mayBeNull:f},spBaseUrl:{type:String,mayBeNull:f},docUrl:{type:String,mayBeNull:f},hostControl:{type:Object,mayBeNull:f},pageBaseUrl:{type:String,mayBeNull:f},lcid:{type:String,mayBeNull:f},formFactor:{type:String,mayBeNull:f},controlStatusChanged:{type:Object,mayBeNull:f},notifyHost:{type:Object,mayBeNull:f},allowExternalMarketplace:{type:Boolean,mayBeNull:f},localizedScriptsUrl:{type:String,mayBeNull:f},localizedImagesUrl:{type:String,mayBeNull:f},localizedStylesUrl:{type:String,mayBeNull:f},localizedResourcesUrl:{type:String,mayBeNull:f},trustAgaves:{type:Boolean,mayBeNull:f},enableAddinCommands:{type:Boolean,mayBeNull:f},enableBlackForestRedirect:{type:Boolean,mayBeNull:f},enableMyOrg:{type:Boolean,mayBeNull:f},enableMyApps:{type:Boolean,mayBeNull:f},enableDevCatalog:{type:Boolean,mayBeNull:f},enableOneDriveCatalog:{type:Boolean,mayBeNull:f},enablePrivateCatalog:{type:Boolean,mayBeNull:f},enableTaskpaneUpgradeToAppCommand:{type:Boolean,mayBeNull:f},enableUploadFileDevCatalog:{type:Boolean,mayBeNull:f},enableV1RedirectApis:{type:Boolean,mayBeNull:f},omexForceAnonymous:{type:Boolean,mayBeNull:f},userNameHashCode:{type:Number,mayBeNull:f},hostFullVersion:{type:String,mayBeNull:f},envCode:{type:String,mayBeNull:f},showSignOutFromPrivateCatalogMessage:{type:Boolean,mayBeNull:f},enableSingleSignOnForAddin:{type:Boolean,mayBeNull:f},firstPartySingleSignOnWhitelist:{type:String,mayBeNull:f},enableServiceDeliveredExperience:{type:Boolean,mayBeNull:f},hideAppsExtensionUrl:{type:String,mayBeNull:f},enableInsertDialogAccessibilityFix:{type:Boolean,mayBeNull:f},disableLogging:{type:Boolean,mayBeNull:f},enableDisplayBlockedMinorError:{type:Boolean,mayBeNull:f},enableFirstPartySSO:{type:Boolean,mayBeNull:f},disableAppsForOfficeThirdParty:{type:Boolean,mayBeNull:f},wacSessionId:{type:String,mayBeNull:f},enableFirstPartySDXErrorMessages:{type:Boolean,mayBeNull:f},isHostDocumentDomain:{type:Boolean,mayBeNull:f},enableRichApiCellEditDelay:{type:Boolean,mayBeNull:f},wopiHostOriginFromPostMessage:{type:String,mayBeNull:f},wopiHostOriginFromWacPropBag:{type:String,mayBeNull:f},"wacIsEmbedded ":{type:Boolean,mayBeNull:f},"accessibilityAllowFocusAddinTaskpane ":{type:Boolean,mayBeNull:f},disableMicrophonePermission:{type:Boolean,mayBeNull:f},agaveAddinUploadEnabled:{type:Boolean,mayBeNull:f},addinEnforceHttpsIsEnabled:{type:Boolean,mayBeNull:f},featureGateFlag:{type:Number,mayBeNull:f},isReactRibbonEnabled:{type:Boolean,mayBeNull:f},enableAddinInsertDialogReflow:{type:Boolean,mayBeNull:f},enableDisplayUILocaleQueryString:{type:Boolean,mayBeNull:f}},u),m._osfOmexBaseUrl=e.osfOmexBaseUrl,m._devCatalogUrl=e.devCatalogUrl,m._sdxCdnUrl=e.sdxCdnUrl,m._sdxDmsUrl=e.sdxDmsUrl,m._firstPartyManifestCDNUrl=e.firstPartyManifestCDNUrl,m._oneDriveCatalogBaseApiUrl=e.oneDriveCatalogBaseApiUrl,m._spBaseUrl=e.spBaseUrl,m._myOrgCatalogUrl=u,m._enableAddinCommands=e.enableAddinCommands||p,m._enableBlackForestRedirect=e.enableBlackForestRedirect||p,m._enableInsertDialogAccessibilityFix=e.enableInsertDialogAccessibilityFix||p,m._enableFirstPartySDXErrorMessages=e.enableFirstPartySDXErrorMessages||p,m._enableMyOrg=e.enableMyOrg||p,m._enableMyApps=e.enableMyApps||p,m._enableDevCatalog=e.enableDevCatalog||p,m._enableOneDriveCatalog=e.enableOneDriveCatalog||p,m._enablePrivateCatalog=e.enablePrivateCatalog||p,m._showSignOutFromPrivateCatalogMessage=e.showSignOutFromPrivateCatalogMessage||p,m._enableTaskpaneUpgradeToAppCommand=e.enableTaskpaneUpgradeToAppCommand||p,m._enableUploadFileDevCatalog=e.enableUploadFileDevCatalog||p,m._enableV1RedirectApis=e.enableV1RedirectApis||p,m._appName=e.appName,m._appVersion=e.appVersion,m._clientMode=e.clientMode,m._appUILocale=e.appUILocale,m._dataLocale=e.dataLocale,m._docUrl=e.docUrl,m._hostControl=e.hostControl,m._formFactor=e.formFactor||o.FormFactor.Default,m._pageBaseUrl=e.pageBaseUrl,m._lcid=e.lcid,m._controlStatusChanged=e.controlStatusChanged,m._notifyHost=e.notifyHost||function(){},m._allowExternalMarketplace=e.allowExternalMarketplace,m._localizedScriptsUrl=e.localizedScriptsUrl,m._localizedImagesUrl=e.localizedImagesUrl,m._localizedStylesUrl=e.localizedStylesUrl,m._localizedResourcesUrl=e.localizedResourcesUrl,m._autoTrusted=e.trustAgaves,m._omexForceAnonymous=e.omexForceAnonymous||p,m._userNameHashCode=e.userNameHashCode||0,m._hostFullVersion=e.hostFullVersion,m._wacHostEnvironment=e.envCode,m._enableSingleSignOnForAddin=e.enableSingleSignOnForAddin||p,m._enableFirstPartySSO=e.enableFirstPartySSO||p,m._enableServiceDeliveredExperience=e.enableServiceDeliveredExperience||f,m._hideAppsExtensionUrl=m._osfOmexBaseUrl+e.hideAppsExtensionUrl,m._disableLogging=e.disableLogging||p,m._enableDisplayBlockedMinorError=e.enableDisplayBlockedMinorError||p,m._disableAppsForOfficeThirdParty=e.disableAppsForOfficeThirdParty||p,m._isHostDocumentDomain=e.isHostDocumentDomain||p,m._enableRichApiCellEditDelay=e.enableRichApiCellEditDelay||p,m._loggableUserId=e.loggableUserId,m._sessionStartInfoJson=e.sessionStartInfoJson,m._firstPartySingleSignOnWhitelist=e.firstPartySingleSignOnWhitelist,m._wopiHostOriginFromPostMessage=e.wopiHostOriginFromPostMessage,m._wopiHostOriginFromWacPropBag=e.wopiHostOriginFromWacPropBag,m._wacIsEmbedded=e.wacIsEmbedded,m._enableWopiHostCheck=e.isHostFrameTrustCheckEnabledForAddIns||p,m._enableUpnCheck=e.isUpnCheckEnabled||p,m._wacUpn=e.wacUpn,m._accessibilityAllowFocusAddinTaskpane=e.accessibilityAllowFocusAddinTaskpane,m._disableMicrophonePermission=e.disableMicrophonePermission||p,m._oAuthManager=u,m._agaveAddinUploadEnabled=e.agaveAddinUploadEnabled||p,m._isHostFrameTrusted=e.isHostFrameTrusted||o.HostFrameTrustState.NotInitialized,m._hostFeatureGateFlag=e.hostFeatureGateFlag||o.HostFeatureGateFlags.None,m._isReactRibbonEnabled=e.isReactRibbonEnabled||p,m._enableAddinInsertDialogReflow=e.enableAddinInsertDialogReflow||p,m._enableDisplayUILocaleQueryString=e.enableDisplayUILocaleQueryString||p,m._enable3rdPartySetAppContextInIframeName=m._hostFeatureGateFlag&o.HostFeatureGateFlags.Enable3rdPartySetAppContextInIFrameName,m._appSettings=e.appSettings||{},m._flightingTreatmentVariables=e.flightingTreatmentVariables||{},m._enableWopiHostCheck=m._enableWopiHostCheck||_(m._appSettings,"WopiHostCheckForAddinsIsEnabled"),m._hostAllowedSdxEmbedding=e.hostAllowedSdxEmbedding||f,m._hostAllowedSdxEmbedding=f,m._upnCheckResult=o.UpnCheckCode.NotSet,d.HostFeatureEnabledInfo.setHostFeatureEnabledInfo(e),m._pageBaseUrl&&"/"!==m._pageBaseUrl.charAt(m._pageBaseUrl.length-1)&&(m._pageBaseUrl=m._pageBaseUrl+"/"),m._localizedResourcesUrl&&"/"!==m._localizedResourcesUrl.charAt(m._localizedResourcesUrl.length-1)&&(m._localizedResourcesUrl=m._localizedResourcesUrl+"/"),m._clientId=o.OUtil.getUniqueId(),m._cachedOsfControls={},m._notReadyOsfControls={},m._notReadyOsfControlsIndex=0,m._iframeAttributeBag={},m._serviceEndPoint=u,m._serviceEndPointInternal=u,m._internalConversationId=u,m._iframeProxies={},m._iframeProxyCount=0,m._iframeNamePrefix="__officeExtensionProxy",m._webUrl=u,m._wsa=u,m._insertDialogDiv=u,m._hasPreloadedOfficeJs=p,m._contextMgrCorrelationId=e.wacSessionId||o.OUtil.Guid.generateNewGuid(),s.RuntimeTelemetryHelper.LogCommonMessageTag("_contextMgrCorrelationId :"+m._contextMgrCorrelationId,u,20194265),s.RuntimeTelemetryHelper.LogCommonMessageTag("ContextActivationManager Constructor isHostFrameTrusted param:"+e.isHostFrameTrusted,m._contextMgrCorrelationId,591697925),m._hostType=u,m._hostPlatform=u,m._hostSpecificFileVersion=u,m._requirementsChecker=new o.RequirementsChecker,m._onClickInstallOsfControl=u,m._osfOmexBaseUrl){var h,v=m._osfOmexBaseUrl.indexOf(o.Constants.ProtocolSeparator);h=v>=0?m._osfOmexBaseUrl.substr(v):o.Constants.ProtocolSeparator+m._osfOmexBaseUrl;var y=o.Constants.Https+h,b=o.Constants.Https+h;o.OUtil.getQueryStringParamValue(window.location.search,o.Constants.OmexForceAnonymousParamName).toLowerCase()==o.Constants.OmexForceAnonymousParamValue.toLowerCase()?(m._omexAuthNStatus=o.OmexAuthNStatus.Anonymous,m._omexForceAnonymous=f):m._omexAuthNStatus=o.OmexAuthNStatus.NotAttempted,m._omexGatedWSProxy={proxyUrl:y+o.Constants.OmexGatedServiceExtension,proxyName:o.Constants.OmexGatedServiceName,isReady:p,clientEndPoint:u,pendingCallbacks:[]},m._omexWSProxy={proxyUrl:b+o.Constants.OmexUnGatedServiceExtension,proxyName:o.Constants.OmexUnGatedServiceName,isReady:p,clientEndPoint:u,pendingCallbacks:[]},m._omexAnonymousWSProxy={proxyUrl:y+o.Constants.OmexAnonymousServiceExtension,proxyName:o.Constants.OmexAnonymousServiceName,isReady:p,clientEndPoint:u,pendingCallbacks:[]},m._omexBillingMarket=u,m._omexEndPointBaseUrl=b}(e.addinEnforceHttpsIsEnabled||p)&&o.OUtil.pushFlight(o.FlightNames.AddinEnforceHttps),m._enableUpnCheck=m._enableUpnCheck||_(m._appSettings,"AddinCheckUpnIsEnabled"),m._enableDisplayUILocaleQueryString=m._enableDisplayUILocaleQueryString||_(m._appSettings,"DisplayUILocaleQueryStringIsEnabled"),m._agaveAddinUploadEnabled=m._agaveAddinUploadEnabled||_(m._appSettings,"AgaveAddinUploadEnabled"),S(m._appSettings,"AddinRibbonIdAllowUnknown",o.FlightNames.AddinRibbonIdAllowUnknown),S(m._appSettings,"IgnoreWindowNameIsEnabled",o.FlightNames.IgnoreWindowName),S(m._appSettings,"DialogPromptCleanDisplayIsEnabled",o.FlightNames.DialogPromptCleanDisplay),S(m._appSettings,"AddinActionDefinitionHybridMode",o.FlightNames.AddinActionDefinitionHybridMode),S(m._appSettings,"AddInsInSupportedIrmDocsIsEnabled",o.FlightNames.AddInsInSupportedIrmDocsIsEnabled),S(m._appSettings,"ManifestParserDevConsoleEnabled",o.FlightNames.ManifestParserDevConsoleLog),S(m._appSettings,"NotifyHostOnlyWithOriginIsEnabled",o.FlightNames.NotifyHostOnlyWithOrigin),S(m._appSettings,"UseActionIdForUILessCommand",o.FlightNames.UseActionIdForUILessCommand);for(var C=o.TestFlightStart;C<=o.TestFlightEnd;C++){var A="OSFTestFlight"+C;S(m._appSettings,A,C)}function S(e,t,n){_(e,t)&&o.OUtil.pushFlight(n)}function _(e,t){var n=e&&t&&void 0!==e[t]&&e[t]&&(typeof e[t]===i&&"TRUE"===e[t].toUpperCase()||"boolean"==typeof e[t]&&e[t]);return void 0!==n?n:p}o.OUtil.getValue(m._flightingTreatmentVariables["Microsoft.Office.OEP.FirstPartyAnonymousProxyReadyCheckTimeoutEnabled"],p)&&o.OUtil.pushFlight(o.FlightNames.FirstPartyAnonymousProxyReadyCheckTimeout),o.Settings.IsReactRibbonEnabled=m._isReactRibbonEnabled,o.Settings[l]=_(m._appSettings,l),o.OUtil.checkFlight(o.FlightNames.ManifestParserDevConsoleLog)&&(o.Settings[c]=_(m._appSettings,c)),"RibbonGroupIdMap"in o&&"RibbonGroupIdMapCommonMLR"in o&&(o.RibbonGroupIdMap=Object.assign(o.RibbonGroupIdMapCommonMLR,o.RibbonGroupIdMap)),m._isFromWacAutomation=function(){if(void 0!==this._isFromWacAutomation&&this._isFromWacAutomation!==u)return this._isFromWacAutomation;try{for(var e=window,t=void 0;e!==t;){if(!e.location||!e.location.search)return p;if(e.location.search.toLowerCase().indexOf("automation=1")>=0)return f;t=e,e=e.parent}}catch(e){return p}return p}(),o.OsfManifestManager._setUILocale(m._appUILocale);var O=m;if(O.getContextForEmbeddingPage=function(){var e=0;if(O._hostSpecificFileVersion&&-1!=O._hostSpecificFileVersion.indexOf(".")){var t=O._hostSpecificFileVersion.split("."),n=t[1];isNaN(n)||(e=parseInt(t[1]))}var r=O._requirementsChecker._getSupportedSet();return{appName:O._appName,appVersion:O._appVersion,appUILocal:O._appUILocale,dataLocale:O._dataLocale,docUrl:O._docUrl||window.location.href,clientMode:O._clientMode,minorVersion:e,requirements:r}},m._enableServiceDeliveredExperience)var I=function(e){var t=e&&e.contextId?O.getOsfControl(e.contextId):u;switch(e.id){case o.MessageIDs.FetchBundleUrl:if(!t._agaveEndPoint){var n=t._conversationId+o.SharedConstants.NotificationConversationIdSuffix;t._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(n,t._frame.contentWindow,t._iframeUrl)}if(t._bundleUrl){var r={id:o.MessageIDs.LoadReactBundle,bundleUrl:t._bundleUrl};t.sendMessageToSdx(r)}break;case o.MessageIDs.LoadBundleSuccess:t._pageStatus=o.OsfControlPageStatus.Ready,t._contextActivationMgr._ErrorUXHelper&&t._contextActivationMgr._ErrorUXHelper.removeProgressDiv(t._div,t._id);break;case o.MessageIDs.LoadBundleError:break;default:a.msAjaxDebug.trace("MessageID: "+e.id+" onMessageFromSdx got wrong message.")}};var x=function(e){if(e.strUrl){var t=o.OUtil.parseUrl(e.strUrl);if(t&&("http:"==t.protocol||"https:"==t.protocol))return void(o.OUtil.checkFlight(o.FlightNames.IgnoreWindowName)?window.open(e.strUrl,"",e.strWindowFeatures):window.open(e.strUrl,e.strWindowName,e.strWindowFeatures))}s.RuntimeTelemetryHelper.LogCommonMessageTag("Silent fail for window.open.",this._contextMgrCorrelationId,592570305)},T=function(e,t){e.hasOwnProperty("fromInsertDialog")&&!e.fromInsertDialog||O._insertDialogDiv!=u&&2==O._insertDialogDiv.childNodes.length&&O._insertDialogDiv.removeChild(O._insertDialogDiv.lastChild);var n,r=o.OUtil.Guid.generateNewGuid(),i=new d.InsertDialogTelemetryContext(r);e.storeType==o.StoreTypeEnum.MarketPlace?n={storeType:o.StoreType.OMEX,storeLocator:O._osfOmexBaseUrl}:e.storeType==o.StoreTypeEnum.Catalog?n={storeType:o.StoreType.SPCatalog,storeLocator:O._myOrgCatalogUrl}:e.storeType==o.StoreTypeEnum.OneDrive&&(n={storeType:o.StoreType.OneDrive,storeLocator:O._oneDriveCatalogBaseApiUrl});var s=p||e.refresh,c={assetId:"",contentMarket:"",anonymous:p,clientEndPoint:u,clearCache:s,clearKilledApps:p,referenceInUse:n,hostType:O._hostType};if(e&&e.storeType==o.StoreTypeEnum.MarketPlace){c.clientVersion=O._getClientVersionForOmex(),c.clientVersion&&(c.clientName=O._getClientNameForOmex(),c.appVersion=O._getAppVersionForOmex());(f=d.CatalogFactory.resolve(o.StoreType.OMEX)).getEntitlementAsync(p,i,Function.createDelegate(O,(function(e){if(e.status==d.DataServiceResultCode.Succeeded&&e.value){for(var n,r=e.value,a=r.length,c={},l=[],p=0;p<a;p++)c[(n=r[p]).contentMarket]?c[n.contentMarket].push(n.assetId):c[n.contentMarket]=[n.assetId];s&&w(r),0===a&&t({errorCode:o.InvokeResultCode.S_OK});var m=0,g=function(e,n){if(e.status==d.DataServiceResultCode.Succeeded&&e.value&&e.value.length&&e.value.length>0)for(var r=e.value,i=O.getRequirementsChecker(),s=0;s<r.length;s++){if(i.isEntitlementFromOmexSupported(r[s])){var c=[];c.push(r[s].name),c.push(r[s].assetId),c.push(r[s].description),c.push(o.OUtil.getTargetType(r[s].appSubType)),c.push(o.OUtil.normalizeAppVersion(r[s].version)),c.push(r[s].assetId),c.push(o.StoreType.OMEX),c.push(parseInt(r[s].defaultWidth)),c.push(parseInt(r[s].defaultHeight)),c.push(r[s].iconUrl),c.push(r[s].provider),c.push(n),c.push(o.StoreType.OMEX),c.push(r[s].webApplicationId),l.push(c)}m++}if(m===a){var u={value:l,errorCode:o.InvokeResultCode.S_OK};t(u)}},h=function(e,t){f.getAppDetails(e,t,i,(function(e){Function.createDelegate(O,g)(e,t)}),s)};for(var v in c)h(c[v],v)}else{var y={value:u,errorCode:o.InvokeResultCode.E_USER_NOT_SIGNED_IN};t(y)}})),s)}else if(e&&e.storeType==o.StoreTypeEnum.Catalog){var l=d.CatalogFactory.resolve(o.StoreType.SPCatalog);l.myOrgCatalogUrl=O._myOrgCatalogUrl;l.getEntitlementAsync(p,i,Function.createDelegate(O,(function(e){var r;if(o.OUtil.writeProfilerMark(o.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd),e.status==d.DataServiceResultCode.Succeeded&&e.value){for(var a,i=e.value,s=i.length,c=[],l=0,f=O.getRequirementsChecker(),p=0;p<s;p++)if(a=i[p],f.isEntitlementFromCorpCatalogSupported(a)){var m=[];m.push(a.Title),m.push(a.OfficeExtensionID),m.push(a.OfficeExtensionDescription),m.push(o.OfficeAppType[a.OEType]),m.push(o.OUtil.normalizeAppVersion(a.OfficeExtensionVersion)),m.push(a.OfficeExtensionID),m.push(o.StoreType.SPCatalog),m.push(parseInt(a.OfficeExtensionDefaultWidth.toString())),m.push(parseInt(a.OfficeExtensionDefaultHeight.toString())),m.push(a.OfficeExtensionIcon),m.push(a.OEProviderName),m.push(n.storeLocator),m.push(o.StoreType.SPCatalog),c.push(m),l++}r=l>0?{value:c,errorCode:o.InvokeResultCode.S_OK}:{value:u,errorCode:o.InvokeResultCode.E_CATALOG_NO_APPS}}else r=n.storeLocator?{value:u,errorCode:o.InvokeResultCode.E_GENERIC_ERROR}:{value:u,errorCode:o.InvokeResultCode.E_CATALOG_NO_APPS};t(r)})),s)}else if(e&&e.storeType==o.StoreTypeEnum.OneDrive){o.OsfManifestManager.getOneDriveEntitlementsAsync(c,(function(e){var n;e.statusCode===o.ProxyCallStatusCode.Succeeded&&e.value&&(n={value:e.value.entitlements,errorCode:o.InvokeResultCode.S_OK},t(n))}))}else if(e&&e.storeType==o.StoreTypeEnum.PrivateCatalog){var f;(f=d.CatalogFactory.resolve(o.StoreType.PrivateCatalog)).getEntitlementAsync(p,i,Function.createDelegate(O,(function(e){if(e.status!=d.DataServiceResultCode.Unauthenticated)if(e.status===d.DataServiceResultCode.Succeeded&&e.value){var n=e.value;if(0!==n.length){var r;r=n.map((function(e){return{ProductId:e.assetId,AddInState:e.addInState,Version:e.appVersion}}));var a=[];f.getAppDetails(r,"",i,Function.createDelegate(O,(function(e){if(e.status===d.DataServiceResultCode.Succeeded&&e.value&&e.value.length&&0!==e.value.length){for(var n=e.value,r=O.getRequirementsChecker(),i=0;i<n.length;i++)if(r.isEntitlementFromOmexSupported(n[i])){var s=[];s.push(n[i].name),s.push(n[i].assetId),s.push(n[i].description),s.push(o.OUtil.getTargetType(n[i].appSubType)),s.push(o.OUtil.normalizeAppVersion(n[i].version)),s.push(n[i].assetId),s.push(o.StoreType.PrivateCatalog),s.push(parseInt(n[i].defaultWidth)),s.push(parseInt(n[i].defaultHeight)),s.push(n[i].iconUrl),s.push(n[i].provider),s.push(o.StoreType.PrivateCatalog),s.push(o.StoreType.PrivateCatalog),a.push(s)}t({value:a,errorCode:o.InvokeResultCode.S_OK})}else t({value:u,errorCode:o.InvokeResultCode.E_CATALOG_REQUEST_FAILED})})),s)}else t({errorCode:o.InvokeResultCode.E_CATALOG_NO_APPS})}else t({value:u,errorCode:o.InvokeResultCode.E_CATALOG_REQUEST_FAILED});else t({value:u,errorCode:o.InvokeResultCode.E_USER_NOT_SIGNED_IN})})),s)}else a.msAjaxDebug.trace("Unknown store type.")};m._onClickInstallOsfControl=function(e){if(O._enableUploadFileDevCatalog){a.msAjaxDebug.trace("onClickInstallOsfControl!");try{o.OUtil.validateParamObject(e,{manifest:{type:String,mayBeNull:p}},u);var n=new o.Manifest.Manifest(e.manifest,O.getAppUILocale()),r=n.getMarketplaceID(),i=n.getMarketplaceVersion();if(d.CatalogFactory.resolve(o.StoreType.UploadFileDevCatalog).validateAndCacheNewManifest(r,i,e.manifest,n)){var c={id:r,targetType:n.getTarget(),appVersion:i,currentStoreType:o.StoreType.UploadFileDevCatalog,storeId:"developer",assetId:r,assetStoreId:o.StoreType.UploadFileDevCatalog,width:parseInt(n.getDefaultWidth()||t),height:parseInt(n.getDefaultHeight()||t),isAddinCommands:n._isAddinCommandsManifest(o.getManifestHostType(O._hostType))};o.OUtil.validateParamObject(c,{id:{type:String,mayBeNull:p},targetType:{type:Number,mayBeNull:p},appVersion:{type:String,mayBeNull:p},width:{type:Number,mayBeNull:f},height:{type:Number,mayBeNull:f}},u),s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,c.currentStoreType,c.assetId,c.appVersion,c.targetType,c.isAddinCommands,c.width,c.height),O._notifyHost(t,o.AgaveHostAction.InsertAgave,c)}else O._notifyHost(t,o.AgaveHostAction.NotifyHostError,u)}catch(e){var l="Invalid manifest from addincommands dev catalog.";return d.WACUtils.logExceptionToBrowserConsole(l,e),s.RuntimeTelemetryHelper.LogExceptionTag(l,e,this._appCorrelationId,19203548),void O._notifyHost(t,o.AgaveHostAction.NotifyHostError,u)}}};var E=function(e){a.msAjaxDebug.trace("onClickRefreshfAddinCommands!"),O._notifyHost(t,o.AgaveHostAction.RefreshAddinCommands,e)},M=function(e){var t=o.OUtil.Guid.generateNewGuid(),n=new d.InsertDialogTelemetryContext(t),r=d.CatalogFactory.resolve(o.StoreType.OMEX),a=new d.PreCacher(O.getRequirementsChecker()),i={assetId:e.assetId,storeType:o.StoreType.OMEX,storeId:e.storeId,appVersion:"",targetType:u};r.activateAsync(i,a,n)},P=function(e,t){if(O._enableSingleSignOnForAddin&&e.webApplicationId)R(e,t);else{var n={assetId:e.id,clientVersion:O._getClientVersionForOmex(),clientName:O._getClientNameForOmex(),clientEndPoint:O._omexGatedWSProxy.clientEndPoint},r=O._insertDialogDiv,a={errorCode:o.InvokeResultCode.E_OEM_REMOVED_FAILED,forceRefreshEntitlements:p},i=o.OUtil.Guid.generateNewGuid(),c=new d.InsertDialogTelemetryContext(i);d.CatalogFactory.resolve(o.StoreType.OMEX).removeAsync([n.assetId],c,(function(i){var c=0;if(i.status==d.DataServiceResultCode.Succeeded&&i.value&&i.value.removedApps&&i.value.removedApps.length>0){for(var l=i.value.removedApps,u=o.InvokeResultCode.E_OEM_REMOVED_FAILED,m=0;m<l.length;m++)if(l[m].assetId==n.assetId){l[m].result==o.OmexRemoveAppStatus.Success&&(u=o.InvokeResultCode.S_OK);break}u==o.InvokeResultCode.S_OK&&(c=O.untrustOsfControls(e),k(n.assetId)),a.errorCode=u}var g=!document.documentElement.contains(r);s.AppManagementMenuHelper.LogAppManagementMenuAction(n.assetId,o.AppManagementAction.Remove,c,g,p,a.errorCode),a.forceRefreshEntitlements=f,t(a)}))}},k=function(e){var n={solutionId:e};O._appName==o.AppName.ExcelWebApp&&O._notifyHost(t,o.AgaveHostAction.UninstallCustomFunctions,n)},R=function(e,n){var r=O._hideAppsExtensionUrl+"&"+o.OmexPageParameterKeys.AppName+"="+o.getModernAppVerCode(O._appName)+"&"+o.OmexPageParameterKeys.AssetId+"="+e.id+"&"+o.OmexPageParameterKeys.AppCorrelationId+"="+O._contextMgrCorrelationId,a=document.createElement("iframe");a.setAttribute("id","serviceExtensionIframe"),a.setAttribute("src",r),a.setAttribute("scrolling","auto"),a.setAttribute("border",t),a.setAttribute("width",t),a.setAttribute("height",t),a.setAttribute("style","position: absolute; left: -100px; top:0px;"),document.body.appendChild(a);var i=O._insertDialogDiv,c=function(t){if(t.source==a.contentWindow){var r={errorCode:o.InvokeResultCode.E_OEM_REMOVED_FAILED,forceRefreshEntitlements:p};document.body.removeChild(a),window.removeEventListener("message",c);var l=0,u=JSON.parse(t.data),d=parseInt(u[o.OmexRemoveAddinMessageKeys.RemoveAddinResultCode]),m=o.InvokeResultCode.E_OEM_REMOVED_FAILED;if(d===o.OmexRemoveAddinResultCode.Success){for(var g=u[o.OmexRemoveAddinMessageKeys.RemoveAddinResultValue],h=0;h<g.length;h++)if(g[h]==e.id){m=o.InvokeResultCode.S_OK;break}m==o.InvokeResultCode.S_OK&&(l=O.untrustOsfControls(e),N(e.id),k(e.id)),r.errorCode=m}var v=!document.documentElement.contains(i);s.AppManagementMenuHelper.LogAppManagementMenuAction(e.id,o.AppManagementAction.Remove,l,v,p,r.errorCode),r.forceRefreshEntitlements=f,n(r)}};window.addEventListener("message",c)},N=function(e){var t=".*",n=[];n.push(new RegExp(o.OUtil.formatString(d.WACUtils.CacheConstants.EntitlementsKey,t,t),"i")),n.push(new RegExp(o.OUtil.formatString(d.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,t,e,t,t),"i")),d.WACUtils.removeMatchesFromLocalStorage(n)},w=function(e){for(var t,n=[],r=e.length,a=0;a<r;a++){t=e[a];var i=o.OUtil.formatString(d.WACUtils.CacheConstants.AppStateCacheKey,d.WACUtils.CacheConstants.GatedCacheKeyPrefix,t.contentMarket,t.assetId),s=o.OUtil.formatString(d.WACUtils.CacheConstants.AppInstallInfoKey,d.WACUtils.CacheConstants.AnonymousCacheKeyPrefix,t.assetId,t.contentMarket),c=o.OUtil.formatString(d.WACUtils.CacheConstants.AppDetailKey,d.WACUtils.CacheConstants.UngatedCacheKeyPrefix,t.assetId),l=o.OUtil.formatString(d.WACUtils.CacheConstants.ActivatedCacheKey,t.assetId.toLowerCase(),o.StoreType.OMEX,t.contentMarket),u=o.OUtil.formatString("{0}.{1}.{2}",t.assetId,t.storeId,t.contentMarket);n[i]=f,n[s]=f,n[c]=f,n[l]=f,n[u]=f}for(var p=o.OUtil.getLocalStorage(),m=p.getKeysWithPrefix("__OSF_"),g=(a=0,m.length);a<g;a++){var h=m[a];if(0==h.indexOf(d.WACUtils.CacheConstants.GatedCacheKeyPrefix+d.WACUtils.CacheConstants.AppState)||0==h.indexOf(d.WACUtils.CacheConstants.AnonymousCacheKeyPrefix+d.WACUtils.CacheConstants.AppInstallInfo)||0==h.indexOf(d.WACUtils.CacheConstants.UngatedCacheKeyPrefix+d.WACUtils.CacheConstants.AppDetails)||0==h.indexOf(d.WACUtils.CacheConstants.ActivatedCacheKeyPrefix))n[h]!=f&&p.removeItem(h);else if(0==h.indexOf(d.WACUtils.CacheConstants.GatedCacheKeyPrefix+d.WACUtils.CacheConstants.AppinstallAuthenticated)){var v=h.replace(d.WACUtils.CacheConstants.GatedCacheKeyPrefix+d.WACUtils.CacheConstants.AppinstallAuthenticated,"");n[v=v.substring(v.indexOf(".")+1)]!=f&&p.removeItem(h)}}};if(m._serviceEndPoint=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(m._clientId),m._serviceEndPoint._onHandleRequestError=function(e,t){var n,a,c,l="DdaMethod";e&&(n=e._data)&&((a=typeof(a=typeof n===r&&typeof n[l]===r?n[l].ControlId:typeof n===r?n[0]:n)===i?a:u)&&(c=O.getOsfControl(a))&&(c._pageStatus="Failed origin check"===t?o.OsfControlPageStatus.FailedOriginCheck:"Access Denied"===t?o.OsfControlPageStatus.FailedPermissionCheck:o.OsfControlPageStatus.FailedHandleRequest,s.RuntimeTelemetryHelper.LogExceptionTag(t,u,c.getCorrelationId(),19203549)))},m._serviceEndPoint.registerMethod("ContextActivationManager_getAppContextAsync",(function(e,t){var c=typeof e===i?e:typeof e===r&&e.length>0?e[0]:u;(!c||!t)&&s.RuntimeTelemetryHelper.LogExceptionTag("Parameter validation error in getAppContextAsync.",u,u,19203545);var l=O.getOsfControl(c);if(!l)throw a.msAjaxDebug.trace(n),s.RuntimeTelemetryHelper.LogExceptionTag("Cannot get osfControl with given ID.",u,u,19203546),a.msAjaxError.argument("contextId");l._sdxTelemetryContext.getAppContextStart=performance.now(),l._iframeOnGetAppContextDelegate&&l._iframeOnGetAppContextDelegate(),s.AppLoadTimeHelper.OfficeJSLoaded(l._telemetryContext),t(l.getAppContext()),l._pageStatus=o.OsfControlPageStatus.Ready,l._pageIsReadyTimerExpired&&s.RuntimeTelemetryHelper.LogExceptionTag("App attempted to retrieve context after app activation error has occured.",u,l.getCorrelationId(),19203547),l._contextActivationMgr._ErrorUXHelper&&l._contextActivationMgr._ErrorUXHelper.removeProgressDiv(l._div,l._id),l.ensureAgaveEndPoint(),l._focusOnIframeWhenLoaded&&l._frame.contentWindow.focus(),s.AppLoadTimeHelper.ActivationEnd(l._telemetryContext),l._sdxTelemetryContext.getAppContextEnd=performance.now(),l._timer&&(window.clearTimeout(l._timer),l._timer=u),l._iframeIsLoaded&&l._notifyHostIFrameOnLoaded()}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPoint.registerMethod("ContextActivationManager_notifyHost",(function(e){e&&2==e.length||!(e&&3==e.length&&(e[1]===o.AgaveHostAction.UpdateTargetUrl||e[1]===o.AgaveHostAction.SendTelemetryEvent||e[1]===o.AgaveHostAction.SendCustomerContent||e[1]===o.AgaveHostAction.SendMessage||e[1]===o.AgaveHostAction.LaunchExtensionComponent||e[1]===o.AgaveHostAction.StopExtensionComponent||e[1]===o.AgaveHostAction.RestartExtensionComponent||e[1]===o.AgaveHostAction.EnableTaskPaneHeaderButton||e[1]===o.AgaveHostAction.DisableTaskPaneHeaderButton||e[1]===o.AgaveHostAction.RefreshRibbonGallery||e[1]===o.AgaveHostAction.OfficeJsReady))&&a.msAjaxDebug.trace("ContextActivationManager_notifyHost params is wrong.");var t=e[0],r=e[1],i=O.getOsfControl(t);if(i)if(r===o.AgaveHostAction.TabExitShift||r===o.AgaveHostAction.ExitNoFocusableShift)O._ErrorUXHelper.focusOnNotificationUxShiftIn(t,r);else if(r===o.AgaveHostAction.UpdateTargetUrl){var s=e[2];i.checkAppDomains(s)&&i.updateAgaveEndPointTargetUrl(s)}else if(r===o.AgaveHostAction.SendTelemetryEvent||r===o.AgaveHostAction.SendCustomerContent){var c=e[2];i._contextActivationMgr._notifyHost(t,r,c)}else if(r===o.AgaveHostAction.LaunchExtensionComponent){var l=e[2];i._contextActivationMgr._notifyHost(t,r,l)}else if(r===o.AgaveHostAction.RestartExtensionComponent){var d=e[2];if(d.InstanceToken){var f=i._contextActivationMgr._cachedOsfControls[d.InstanceToken];if(f)f.refresh();else if(d.LaunchProperties&&d.LaunchProperties.OptionalProperties){var p=d.Id.Id,m=d.LaunchProperties.OptionalProperties.SourceLocationOverrideResourceId;i._contextActivationMgr.refreshOsfControl(p,m)}}}else if(r===o.AgaveHostAction.StopExtensionComponent){var g=e[2];i._contextActivationMgr._notifyHost(t,r,g)}else if(r==o.AgaveHostAction.SendMessage){for(var h in i._contextActivationMgr._cachedOsfControls)if(h!=i.getID()){var v=i._contextActivationMgr._cachedOsfControls[h];if(v.getStoreLocator()==i.getStoreLocator()&&v.getStoreType()==i.getStoreType()){var y=e[2];v.getOwnerAddinAssetId()!=u&&v.getOwnerAddinAssetId()==i.getOwnerAddinAssetId()?v.notifyAgave(o.AgaveHostAction.SendMessage,y):v.getMarketplaceID()==i.getMarketplaceID()&&v.notifyAgave(o.AgaveHostAction.SendMessage,y)}}}else if(r==o.AgaveHostAction.EnableTaskPaneHeaderButton){var b=e[2];i._contextActivationMgr._notifyHost(t,r,b)}else if(r==o.AgaveHostAction.RefreshRibbonGallery){var C=e[2];i._contextActivationMgr._notifyHost(t,r,C)}else if(r==o.AgaveHostAction.OfficeJsReady){var A=e[2];i._sdxTelemetryContext.officeJsReadyDate=A,i._iframeOnGetAppContextDelegate&&i._iframeOnGetAppContextDelegate()}else i._contextActivationMgr._notifyHost?i._contextActivationMgr._notifyHost(t,r):a.msAjaxDebug.trace("No notifyHost provided by the host.");else a.msAjaxDebug.trace(n)}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPoint.registerMethod("ContextActivationManager_openWindowInHost",x,Microsoft.Office.Common.InvokeType.async,p),m._enableServiceDeliveredExperience&&m._serviceEndPoint.registerMethod("Office_sendMessageToHost",I,Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(m._clientId+o.Constants.EndPointInternalSuffix),m._serviceEndPointInternal.registerMethod("ContextActivationManager_getEntitlementsForInsertDialog",T,Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignIn",(function(e){if(e&&e.storeType!=o.StoreTypeEnum.PrivateCatalog){var n=window.location.href,r=O._osfOmexBaseUrl+o.Constants.SignInRedirectUrl+encodeURIComponent(n);window.location.assign(r)}else d.PrivateCatalogService.authenticationProxy.getSignInUrl((function(e){window.top.location.replace(e)}),(function(){O._notifyHost(t,o.AgaveHostAction.NotifyHostError,u)}))}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignOut",(function(e){e&&e.storeType==o.StoreTypeEnum.PrivateCatalog&&d.PrivateCatalogService.SignOutUser(),E(e,u)}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeWindowOpen",(function(e){if(e.pageUrl){var t={strUrl:e.pageUrl,strWindowName:u,strWindowFeatures:u};x(t)}}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInsertOsfControl",(function(e){a.msAjaxDebug.trace("onClickInsertOsfControl!"),O._notifyHost(t,o.AgaveHostAction.InsertAgave,e)}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInstallOsfControl",m._onClickInstallOsfControl,Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickRefreshAddinCommands",E,Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickCancelDialog",(function(){a.msAjaxDebug.trace("onClickCancelDialog!"),O._notifyHost(t,o.AgaveHostAction.CancelDialog),O._internalConversationId&&(O._serviceEndPointInternal.unregisterConversation(O._internalConversationId),O._internalConversationId=u)}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_removeAppForInsertDialog",P,Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_logTelemetryDataForInsertDialog",(function(e){switch(e.datapointName){case o.DataPointNames.AppManagementMenu:o.OUtil.validateParamObject(e,{assetId:{type:String,mayBeNull:p},operationMetadata:{type:Number,mayBeNull:p},hrStatus:{type:Number,mayBeNull:p}},u),s.AppManagementMenuHelper.LogAppManagementMenuAction(e.assetId,e.operationMetadata,0,p,p,e.hrStatus);break;case o.DataPointNames.InsertionDialogSession:o.OUtil.validateParamObject(e,{assetId:{type:String,mayBeNull:p},totalSessionTime:{type:Number,mayBeNull:p},trustPageSessionTime:{type:Number,mayBeNull:p},appInserted:{type:Boolean,mayBeNull:p},lastActiveTab:{type:Number,mayBeNull:p},lastActiveTabCount:{type:Number,mayBeNull:p}},u),s.InsertionDialogSessionHelper.LogInsertionDialogSession(e.assetId,e.totalSessionTime,e.trustPageSessionTime,e.appInserted,e.lastActiveTab,e.lastActiveTabCount);break;case o.DataPointNames.UploadFileDevCatelog:o.OUtil.validateParamObject(e,{operationMetadata:{type:Number,mayBeNull:p},hrStatus:{type:Number,mayBeNull:p}},u),s.UploadFileDevCatelogHelper.LogUploadFileDevCatelogAction(this._appCorrelationId,e.operationMetadata,0,p,p,e.hrStatus);break;case o.DataPointNames.UploadFileDevCatalogUsage:o.OUtil.validateParamObject(e,{currentStoreType:{type:String,mayBeNull:p},id:{type:String,mayBeNull:f},appVersion:{type:String,mayBeNull:f},appTargetType:{type:Number,mayBeNull:p},isAppCommand:{type:String,mayBeNull:p},appSizeWidth:{type:Number,mayBeNull:f},appSizeHeight:{type:Number,mayBeNull:f}},u),s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,e.currentStoreType,e.Id,e.appVersion,e.appTargetType,e.isAppCommand,e.appSizeWidth,e.appSizeHeight)}}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_getOmexData",M,Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_removeAppCommandsAddin",(function(e){var n=O.getOsfControl(e.id);n?n._isAddinCommands((function(n){n&&O._notifyHost(t,o.AgaveHostAction.RemoveAppCommandsAddin,{assetId:e.id})})):a.msAjaxDebug.trace("osfControl for the given ID doesn't exist:"+e.id)}),Microsoft.Office.Common.InvokeType.async,p),o.AppSpecificSetup._setupFacade(m._hostControl,m,m._serviceEndPoint,m._serviceEndPointInternal),e.hostType=m._hostType,e.spBaseUrl=m._spBaseUrl,d.CatalogFactory.setHostContext(e),m._localeStringLoadingPendingCallbacks=[],m._localizedScriptsUrl&&"null/"!=m._localizedScriptsUrl){m._loadLocaleString(Function.createDelegate(m,(function(){this._ErrorUXHelper=new o._ErrorUXHelper(this)})))}m.queryEntitlementDetails=function(e){T(e,e.callbackFunc)},m._getOmexData=function(e){M(e)},m._removeAppForInsertDialog=function(e){P(e,e.callbackFunc)};m._enableUpnCheck&&m._enableMyOrg&&m._spBaseUrl!=u&&!d.WACUtils.isTeamsWebView()&&function(e,t){var n="wacUpn is null.",r=function(e){var n=f;d.WACUtils.logExceptionToBrowserConsole("Check UPN result: "+e.value,u),e.status===d.DataServiceResultCode.Succeeded?n=e.value:s.RuntimeTelemetryHelper.LogCommonMessageTag("Upn Check failed.",u,588814298),t(n)},a=d.CatalogFactory.resolve(o.StoreType.SPCatalog);a!=u&&e!=u?a.isUpnMatchAsync(e,new d.SimpleTelemetryContext,r):(e==u&&(d.WACUtils.logExceptionToBrowserConsole(n,u),s.RuntimeTelemetryHelper.LogCommonMessageTag(n,u,588814299)),e==u&&s.RuntimeTelemetryHelper.LogCommonMessageTag("spcatalog is null.",u,588814300),r({status:d.DataServiceResultCode.Failed,value:p}))}(m._wacUpn,(function(e){g._upnCheckResult=e?o.UpnCheckCode.Match:o.UpnCheckCode.NotMatch}))},o.ContextActivationManager.prototype={insertOsfControl:function(e){var t=!0,n=!1,r=this;o.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:n},id:{type:String,mayBeNull:n},marketplaceID:{type:String,mayBeNull:n},marketplaceVersion:{type:String,mayBeNull:n},store:{type:String,mayBeNull:n},storeType:{type:String,mayBeNull:n},alternateReference:{type:Object,mayBeNull:t},settings:{type:Object,mayBeNull:t},reason:{type:String,mayBeNull:t},osfControlType:{type:Number,mayBeNull:t},snapshotUrl:{type:String,mayBeNull:t},preactivationCallback:{type:Object,mayBeNull:t},virtualOsfControlActivationCallback:{type:Object,mayBeNull:t},isvirtualOsfControl:{type:Boolean,mayBeNull:t},isDialog:{type:Boolean,mayBeNull:t},hostCustomMessage:{type:String,mayBeNull:t},isForUILessAction:{type:Boolean,mayBeNull:t},ownerAddinAssetId:{type:String,mayBeNull:t},ownerAddinStoreType:{type:String,mayBeNull:t},sourceLocationOverrideUrl:{type:String,mayBeNull:t},focusOnIframeWhenLoaded:{type:Boolean,mayBeNull:t},featureGates:{type:Object,mayBeNull:t},activationStart:{type:Number,mayBeNull:t},hostInfoFlags:{type:Number,mayBeNull:t},sharedRuntimeId:{type:String,mayBeNull:t},initialDisplayMode:{type:Number,mayBeNull:t}},null);var a=n;if(a=o.OUtil.checkFlight(o.FlightNames.AddInsInSupportedIrmDocsIsEnabled)?o.OsfControl.isFirstPartyStoreString(e.storeType):e.storeType.toLowerCase()==o.StoreType.FirstParty.toLowerCase(),!r._disableAppsForOfficeThirdParty||a){var i={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,alternateReference:e.alternateReference,settings:e.settings,reason:e.reason,osfControlType:e.osfControlType,snapshotUrl:e.snapshotUrl,contextActivationMgr:r,preactivationCallback:e.preactivationCallback,virtualOsfControlActivationCallback:e.virtualOsfControlActivationCallback,isvirtualOsfControl:e.isvirtualOsfControl,isDialog:e.isDialog,hostCustomMessage:e.hostCustomMessage,isForUILessAction:e.isForUILessAction,ownerAddinAssetId:e.ownerAddinAssetId,sourceLocationOverrideResourceId:e.sourceLocationOverrideResourceId,sourceLocationOverrideUrl:e.sourceLocationOverrideUrl,ownerAddinStoreType:e.ownerAddinStoreType,focusOnIframeWhenLoaded:e.focusOnIframeWhenLoaded,featureGates:e.featureGates,activationStart:e.activationStart,hostInfoFlags:e.hostInfoFlags,sharedRuntimeId:e.sharedRuntimeId,initialDisplayMode:e.initialDisplayMode},c=r.getSQMAgaveUsage(i.storeType,i.osfControlType,i.reason,e.marketplaceID),l=new o.OsfControl(i);l._sqmDWords[0]=c[0],l._sqmDWords[1]=c[1],l._contextActivationMgr._ErrorUXHelper&&l._contextActivationMgr._ErrorUXHelper.showProgress(l._div,l._id);return r._loadLocaleString(Function.createDelegate(r,(function(){l.activate({isInsertOsfControl:t}),s.RuntimeTelemetryHelper.LogCommonMessageTag("OsfControl activation lifecycle: OsfControl active got called for controlId: "+l._id,this._contextMgrCorrelationId,594356321)}))),l}},insertDialogControl:function(e){var t=!1;o.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:t},id:{type:String,mayBeNull:t},dialogUrl:{type:String,mayBeNull:t},marketplaceID:{type:String,mayBeNull:t},marketplaceVersion:{type:String,mayBeNull:t},appDomains:{type:Array,mayBeNull:t},store:{type:String,mayBeNull:t},storeType:{type:String,mayBeNull:t},agaveName:{type:String,mayBeNull:!0}},null);var n={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,isDialog:!0,contextActivationMgr:this};new o.OsfControl(n).createIframeForDialogControl(e.agaveName,e.dialogUrl,e.appDomains)},insertBlankControlWithErrorUX:function(e,t){var n=!1,r=this;o.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:n},id:{type:String,mayBeNull:n},marketplaceID:{type:String,mayBeNull:n},marketplaceVersion:{type:String,mayBeNull:n},store:{type:String,mayBeNull:n},osfControlType:{type:Number,mayBeNull:!0},storeType:{type:String,mayBeNull:n}},null);var a={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,osfControlType:e.osfControlType,contextActivationMgr:r,isvirtualOsfControl:n},i=new o.OsfControl(a);i._contextActivationMgr.registerOsfControl(i);var s=function(e,t){var r,a="",o="",i="",s=n;e.status===d.DataServiceResultCode.Succeeded&&e.value&&(a=(r=e.value).getDefaultDisplayName(),o=r.getProviderName(),i=r.getDefaultIconUrl(),s=r.isSSOAddin()),t(a,o,i,s)},c=d.OmexUtils.getOmexEndPointPageUrl(r.getOsfOmexBaseUrl(),e.marketplaceID,e.store),l=d.CatalogFactory.resolve(e.storeType.toLowerCase());if(null!=l){var u={assetId:e.marketplaceID,appVersion:e.marketplaceVersion,storeType:e.storeType,storeId:e.store,targetType:null},f=o.OmexClientNames[r._appName];l.getAndCacheManifest(u,r._storeLocator,new d.AddinCommandsTelemetryContext(i.getCorrelationId()),(function(n){s(n,(function(n,r,a,o){i._showTrustError(f,n,r,a,e.storeType,t,c,o)}))}))}},purgeDialogControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&(n._conversationId&&this._getServiceEndPoint().unregisterConversation(n._conversationId),this.unregisterOsfControl(n))},dispose:function(){var e=this;e._serviceEndPoint&&(e._serviceEndPoint.dispose(),Microsoft.Office.Common.XdmCommunicationManager.deleteServiceEndPoint(e._clientId),e._serviceEndPoint=null),e._serviceEndPointInternal&&(e._serviceEndPointInternal.dispose(),Microsoft.Office.Common.XdmCommunicationManager.deleteServiceEndPoint(e._clientId+o.Constants.EndPointInternalSuffix),e._serviceEndPointInternal=null)},setLocalizedUrl:function(e,t,n){var r=this,a=Function._validateParams(arguments,[{name:"scriptUrl",type:String,mayBeNull:!1},{name:"imageUrl",type:String,mayBeNull:!1},{name:"styleUrl",type:String,mayBeNull:!1}]);if(a)throw a;if(r._localizedScriptsUrl=e,r._localizedImagesUrl=t,r._localizedStylesUrl=n,r._localizedScriptsUrl&&"null/"!=r._localizedScriptsUrl){var i=function(){this._ErrorUXHelper||(this._ErrorUXHelper=new o._ErrorUXHelper(this))};r._loadLocaleString(Function.createDelegate(r,i))}},getOsfControlStatus:function(e){var t=this._cachedOsfControls[e];return t?t.getStatus():o.OsfControlStatus.InvalidOsfControl},hostCheckReadyHandler:function(e,t){var n=this;if(null!=n._isHostFrameTrusted&&null!=n._notReadyOsfControlsIndex){null!=t&&(n._isHostFrameTrusted=t),s.RuntimeTelemetryHelper.LogCommonMessageTag("Host frame check set :"+JSON.stringify(t),n._contextMgrCorrelationId,595354008);for(var r=0;r<n._notReadyOsfControlsIndex;r++){var a=n._notReadyOsfControls[r];a&&a.refresh()}}},activateOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&n.activate()},deActivateOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&n.deActivate()},purgeOsfControl:function(e,t){var n=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"purgeManifest",type:Boolean,mayBeNull:!1}]);if(n)throw n;var r=this._cachedOsfControls[e];void 0!==r&&(s.RuntimeTelemetryHelper.LogCommonMessageTag("OsfControl activation lifecycle: purgeOsfControl for controlId: "+e,this._contextMgrCorrelationId,594356320),r.purge(t))},purgeOsfControlNotifications:function(){for(var e in this._cachedOsfControls)this._ErrorUXHelper.purgeOsfControlNotification(e)},untrustOsfControls:function(e){var t=this,n=0,r=function(e){return function(){e.activate({hasConsent:!0})}},a=o.OUtil.formatString(o.Constants.ActivatedCacheKey,e.id.toLowerCase(),e.currentStoreType,e.storeId);for(var i in t._deleteCachedFlag(a),t._cachedOsfControls){var s=t._cachedOsfControls[i];if(s._marketplaceID.toLowerCase()==e.id.toLowerCase()){t._ErrorUXHelper.purgeOsfControlNotification(s._id),s.deActivate();var c=d.OmexUtils.getOmexEndPointPageUrl(t.getOsfOmexBaseUrl(),s._marketplaceID,e.storeId),l=o.OmexClientNames[t._appName];s._showTrustError(l,e.displayName,e.providerName,e.iconUrl,e.currentStoreType,r(s),c),n++}}return n},retryAll:function(e){var t=this;for(var n in t._cachedOsfControls){var r=t._cachedOsfControls[n];r._marketplaceID.toLowerCase()==e.toLowerCase()&&r._retryActivate&&(t._ErrorUXHelper.purgeOsfControlNotification(r._id),t._ErrorUXHelper.removeInfoBarDiv(n,!1),r._retryActivate(),r._retryActivate=null)}},validateAndCacheNewDevAddinManifest:function(e){var t=this;t._getDevAddinManifestContent(e,t._validateAndCacheNewDevAddinManifest.bind(t),t._notifyHost.bind(t))},_getDevAddinManifestContent:function(e,t,n){var r;try{(r=new XMLHttpRequest).onreadystatechange=function(){return 4==r.readyState&&200==r.status?t(r.responseText):4==r.readyState&&0==r.status?n("0",o.AgaveHostAction.InsertDevManifestError,{manifestUrl:e}):void 0},r.open("GET",e,!0),r.send()}catch(t){var a="Cannot access developer manifest url.";return d.WACUtils.logExceptionToBrowserConsole(a,t),s.RuntimeTelemetryHelper.LogExceptionTag(a,t,this._appCorrelationId,587338073),n("0",o.AgaveHostAction.InsertDevManifestError,{manifestUrl:e})}},_validateAndCacheNewDevAddinManifest:function(e){var t="developer",n=this;try{var r=new o.Manifest.Manifest(e,n.getAppUILocale()),a=r.getMarketplaceID(),i=r.getMarketplaceVersion(),c=d.CatalogFactory.resolve(o.StoreType.UploadFileDevCatalog);if(c.validateAndCacheNewManifest(a,i,e,r)){var l={id:a,targetType:r.getTarget(),appVersion:i,currentStoreType:o.StoreType.UploadFileDevCatalog,storeId:t,assetId:a,assetStoreId:o.StoreType.UploadFileDevCatalog,width:parseInt(r.getDefaultWidth()||"0"),height:parseInt(r.getDefaultHeight()||"0"),isAddinCommands:r._isAddinCommandsManifest(o.getManifestHostType(n._hostType))};return o.OUtil.validateParamObject(l,{id:{type:String,mayBeNull:!1},targetType:{type:Number,mayBeNull:!1},appVersion:{type:String,mayBeNull:!1},width:{type:Number,mayBeNull:!0},height:{type:Number,mayBeNull:!0}},null),c.localCacheAddinCommands(a,i,t),o.OUtil.getLocalStorage().setItem(a,"true"),n._notifyHost("0",o.AgaveHostAction.InsertDevManifest,l)}return n._notifyHost("0",o.AgaveHostAction.NotifyHostError,null)}catch(e){var u="Invalid developer addin manifest.";return d.WACUtils.logExceptionToBrowserConsole(u,e),s.RuntimeTelemetryHelper.LogExceptionTag(u,e,n._appCorrelationId,587338074),n._notifyHost("0",o.AgaveHostAction.NotifyHostError,null)}},getOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;return this._cachedOsfControls[e]},getOsfControls:function(){var e=[];for(var t in this._cachedOsfControls)e.push(this._cachedOsfControls[t]);return e},getOsfOmexBaseUrl:function(){return this._osfOmexBaseUrl},getAppName:function(){return this._appName},getClientMode:function(){return this._clientMode},getClientId:function(){return this._clientId},getFormFactor:function(){return this._formFactor},getDocUrl:function(){return this._docUrl},getAppUILocale:function(){return this._appUILocale},getDataLocale:function(){return this._dataLocale},getPageBaseUrl:function(){return this._pageBaseUrl},getLcid:function(){return this._lcid},isExternalMarketplaceAllowed:function(){return this._allowExternalMarketplace},isStoreDisabled:function(e){this._loadLocaleString(Function.createDelegate(this,(function(){var t=d.CatalogFactory.resolve(o.StoreType.OMEX),n=o.OUtil.Guid.generateNewGuid(),r=new d.InsertDialogTelemetryContext(n);if(t instanceof d.OmexCatalog)t.isStoreDisabled(r,e);else{e({value:!1,status:200})}})))},getLocalizedScriptsUrl:function(){return this._localizedScriptsUrl?this._localizedScriptsUrl:""},getLocalizedImagesUrl:function(){return this._localizedImagesUrl?this._localizedImagesUrl:""},getLocalizedStylesUrl:function(){return this._localizedStylesUrl?this._localizedStylesUrl:""},raiseOsfControlStatusChange:function(e){this._controlStatusChanged&&this._controlStatusChanged(e)},registerOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;this._cachedOsfControls[e.getID()]=e},registerNotReadyOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;this._notReadyOsfControls[this._notReadyOsfControlsIndex]=e,this._notReadyOsfControlsIndex++},unregisterOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;delete this._cachedOsfControls[e.getID()]},setIframeAttributeBag:function(e){this._iframeAttributeBag=e},displayNotification:function(e){var t=null,n=!0,r=!1,a=this;o.OUtil.validateParamObject(e,{infoType:{type:Number,mayBeNull:r},id:{type:String,mayBeNull:r},title:{type:String,mayBeNull:r},description:{type:String,mayBeNull:r},url:{type:String,mayBeNull:n},icon:{type:String,mayBeNull:n},buttonTxt:{type:String,mayBeNull:n},buttonCallback:{type:Function,mayBeNull:n},dismissCallback:{type:Function,mayBeNull:n},"displayDeactive ":{type:Boolean,mayBeNull:n},highPriority:{type:Boolean,mayBeNull:n},detailView:{type:Boolean,mayBeNull:n},reDisplay:{type:Boolean,mayBeNull:n},logAsError:{type:Boolean,mayBeNull:n},errorCode:{type:Number,mayBeNull:n},retryAll:{type:Boolean,mayBeNull:n},iframeNotificationUrl:{type:String,mayBeNull:n},notificationType:{type:Number,mayBeNull:n}},t),e.errorCode||(e.errorCode=0);var i=a._cachedOsfControls[e.id];if(i)if(i._isvirtualOsfControl){if(e.errorCode==o.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED||e.errorCode==o.ErrorStatusCodes.E_OEM_EXTENSION_KILLED)return void a.purgeOsfControl(e.id,n);if(null==e.highPriority&&(e.highPriority=e.infoType===o.InfoType.Error?n:r),e.highPriority===r)i._notificationParams.push(e);else{for(var c=i._notificationParams,l=0;l<c.length;l++)if(!c[l].highPriority){c.splice(l,0,e),c=t;break}c!=t&&c.push(e)}!i._isvirtualOsfControlCallbackInvoked&&i.ensureToGetVirtualOsfControlManifest((function(e){i.invokeVirtualOsfControlActivationCallback(e)})),!i._isManifestProcessedForCustomFunctions&&i.ensureToGetVirtualOsfControlManifest((function(e){i.processManifestForCustomFunctions(e)}))}else{if(e.logAsError&&(s.AppLoadTimeHelper.SetErrorResult(i._telemetryContext,e.errorCode),a._notifyHostError)){var u={errorCode:e.errorCode};a._notifyHostError(e.id,o.AgaveHostAction.NotifyHostError,u)}(e.displayDeactive||e.iframeNotificationUrl!=t)&&(e.detailView=n),e.div=i._div,a._ErrorUXHelper.showNotification(e)}},dismissMessages:function(e){this._ErrorUXHelper&&this._ErrorUXHelper.dismissMessages(e)},notifyAgave:function(e,t){var n=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"actionId",type:Number,mayBeNull:!1}]);if(n)throw n;var r=this._cachedOsfControls[e];void 0!==r&&(t===o.AgaveHostAction.CtrlF6In||t===o.AgaveHostAction.TabIn||t===o.AgaveHostAction.Select?this._ErrorUXHelper.focusOnNotificationUx(e,t):t===o.AgaveHostAction.TabInShift&&r._pageStatus!==o.OsfControlPageStatus.Ready?this._ErrorUXHelper.focusOnNotificationUxShiftIn(e,t):r.notifyAgave(t))},setWSA:function(e){var t=this;t._wsa=e,t._wsa&&(t._wsa.createStreamUnobfuscated(o.SQMDataPoints.DATAID_APPSFOROFFICEUSAGE,o.BWsaStreamTypes.Static,2,o.BWsaConfig.defaultMaxStreamRows),t._wsa.createStreamUnobfuscated(o.SQMDataPoints.DATAID_APPSFOROFFICENOTIFICATIONS,o.BWsaStreamTypes.Static,4,o.BWsaConfig.defaultMaxStreamRows))},getWSA:function(){return this._wsa},getSQMAgaveUsage:function(e,t,n,r){var a,i;switch(e.toLowerCase()){case o.StoreType.OMEX:a=0;break;case o.StoreType.SPCatalog:a=1;break;case o.StoreType.FileSystem:a=2;break;case o.StoreType.Registry:a=3;break;case o.StoreType.Exchange:a=4;break;case o.StoreType.SPApp:a=5;break;case o.StoreType.FirstParty:a=6;break;case o.StoreType.Sdx:a=7;break;case o.StoreType.InMemory:a=8;break;case o.StoreType.OneDrive:a=9;break;case o.StoreType.PrivateCatalog:a=10;break;case o.StoreType.HardCodedPreinstall:a=11;break;case o.StoreType.UploadFileDevCatalog:a=12;break;default:a=15}switch(t){case o.OsfControlType.DocumentLevel:i=1;break;case o.OsfControlType.ContainerLevel:i=0;break;default:i=2}var s=7;if(n&&n.toLowerCase)switch(n.toLowerCase()){case Microsoft.Office.WebExtension.InitializationReason.Inserted.toLowerCase():s=0;break;case Microsoft.Office.WebExtension.InitializationReason.DocumentOpened.toLowerCase():s=1}var c=0;0!==r.toLowerCase().indexOf("wa")&&0!==r.toLowerCase().indexOf("fa")||(c=r&&r.length>2?parseInt(r.substring(2),10):0,isNaN(c)&&(c=0));return[s<<8|i<<4|a,c]},isMyOrgReady:function(e){var t=this;if(t._enableMyOrg)if(t._spBaseUrl&&t._iframeProxies&&t._iframeProxies[t._spBaseUrl]&&t._iframeProxies[t._spBaseUrl].clientEndPoint)e({isReady:!0,clientEndPoint:t._iframeProxies[t._spBaseUrl].clientEndPoint});else{t._createSharePointIFrameProxy(t._spBaseUrl,(function(t){e(t?{isReady:!0,clientEndPoint:t}:{isReady:!1})}))}else e({isReady:!1})},openInputUrlDialog:function(e){var t="style",n=this,r=document.createElement("p"),a="title-p";r.setAttribute("id",a),n._enableInsertDialogAccessibilityFix?"ltr"==document.documentElement.getAttribute("dir")?r.setAttribute(t,"padding: 26px 0px 10px 26px;"):r.setAttribute(t,"padding: 26px 26px 10px 0px;"):r.setAttribute(t,"margin: 26px 0px 10px 26px;"),r.textContent="DevCatalog server Url is configured in settings.xml - Enter manifest file name only (AppId.xml):",e.appendChild(r);var i=document.createElement("div"),c=document.createElement("input");c.setAttribute("type","url"),c.setAttribute("id","url-input"),c.setAttribute("aria-labelledby",a),c.setAttribute("data-lpignore","true"),n._enableInsertDialogAccessibilityFix?("ltr"==document.documentElement.getAttribute("dir")?c.setAttribute(t,"margin-left: 26px; height: 18px; width: calc(100% - 141px); vertical-align: middle;"):c.setAttribute(t,"margin-right: 26px; height: 18px; width: calc(100% - 141px); vertical-align: middle;"),i.appendChild(c)):(c.setAttribute("size","75"),c.setAttribute(t,"margin-left: 26px; height: 18px; vertical-align: middle;"),e.appendChild(c));var l=n,u=function(e){var t=new o.Manifest.Manifest(e,l.getAppUILocale());!o.OsfManifestManager.hasManifest(t.getMarketplaceID(),t.getMarketplaceVersion())&&o.OsfManifestManager.cacheManifest(t.getMarketplaceID(),t.getMarketplaceVersion(),t);var n={id:t.getMarketplaceID(),targetType:t.getTarget(),appVersion:t.getMarketplaceVersion(),currentStoreType:o.StoreType.Registry,storeId:"developer",assetId:t.getMarketplaceID(),assetStoreId:o.StoreType.Registry,width:t.getDefaultWidth()||0,height:t.getDefaultHeight()||0,isAddinCommands:t._isAddinCommandsManifest(o.getManifestHostType(l._hostType))};s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,n.currentStoreType,n.id,n.appVersion,n.targetType,n.isAddinCommands,n.width,n.height),l._notifyHost("0",o.AgaveHostAction.InsertAgave,n)},d=function(e){alert("Error when requesting manifest file: "+e)},f=document.createElement("input");f.setAttribute("type","button"),f.setAttribute("id","devcat-insert-button"),f.setAttribute("value","Insert"),f.setAttribute("class","WACButton WACDialogButtonNormal"),o.OUtil.addEventListener(f,"click",(function(){o.OUtil.xhrGet(l._devCatalogUrl+"/"+c.value,u,d)})),n._enableInsertDialogAccessibilityFix?(i.appendChild(f),e.appendChild(i)):e.appendChild(f)},launchInsertDialog:function(e,t,n){var r=null,a="100%";0!=e.childNodes.length&&e.removeChild(e.childNodes.item(0));var i,c=o.OUtil.Guid.generateNewGuid(),l=new d.InsertDialogTelemetryContext(c);if(this._enableDevCatalog){(i=document.createElement("div")).style.width=a,i.style.height="80%",e.appendChild(i);var u=document.createElement("div");u.style.width=a,u.style.height="20%",e.appendChild(u),this.openInputUrlDialog(u)}else i=e;var f=this;f._insertDialogDiv=i;var p=document.createElement("div");p.style.width=a,p.style.height=a,p.style.backgroundImage="url("+f.getLocalizedImageFilePath("progress.gif")+")",p.style.backgroundRepeat="no-repeat",p.style.backgroundPosition="center",i.appendChild(p);!function(e,t){if(f._enableMyOrg)try{o.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:!1}},t);f.isMyOrgReady((function(n){n.isReady?(e.clientEndPoint=n.clientEndPoint,d.CatalogFactory.resolve(o.StoreType.SPCatalog).getSPCatalogUrl(l,(function(n){t({statusCode:n.status,value:n.value,context:e})}))):t({statusCode:o.InvokeResultCode.E_GENERIC_ERROR,value:r,context:e})}))}catch(n){return s.RuntimeTelemetryHelper.LogExceptionTag("Error when getting corporate catalog url:",n,this._appCorrelationId,34719254),void t({statusCode:o.InvokeResultCode.E_GENERIC_ERROR,value:r,context:e})}else t({statusCode:o.InvokeResultCode.E_CATALOG_NO_APPS,value:r,context:e})}({webUrl:f._spBaseUrl},(function(e){var c=document.createElement("iframe");c.setAttribute("id","InsertDialog"),c.setAttribute("src","about:blank"),c.setAttribute("width",a),c.setAttribute("height",a),c.setAttribute("marginHeight","0"),c.setAttribute("marginWidth","0"),c.setAttribute("frameBorder","0"),c.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups"),"undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime&&c.setAttribute("title",Strings.OsfRuntime.L_InsertionDialogTile_TXT);var l=r,u=[];f.isStoreDisabled((function(a){var d='"}',p='], "url":"',m=",",g='{ "IsUploadFileDevCatalogEnabled":'+f._enableUploadFileDevCatalog+m+'"isStoreDisabled":'+a.value+m+'"showSignOutFromPrivateCatalogMessage":'+f._showSignOutFromPrivateCatalogMessage+m+'"enableInsertDialogAccessibilityFix":'+f._enableInsertDialogAccessibilityFix+m+'"enableAddinInsertDialogReflow":'+f._enableAddinInsertDialogReflow+m+'"isBlackForestRedirectEnabled":'+f._enableBlackForestRedirect+m+'"isHostDocumentDomain":'+f._isHostDocumentDomain+m+'"agaveAddinUploadEnabled":'+f._agaveAddinUploadEnabled+" }";if(f.isExternalMarketplaceAllowed()){var h='{ "provValues":[0,0,0,'+(f._enableMyApps?o.InvokeResultCode.S_OK.toString():o.InvokeResultCode.S_HIDE_PROVIDER.toString())+p+f._osfOmexBaseUrl+'", "client":"'+f._getClientNameForOmex()+'", "'+o.OmexPageParameterKeys.AuthType+'":'+f._getAuthTypeForHideAppsExtensionUrl()+"}";u.push('"myApp":'+h),s.RuntimeTelemetryHelper.LogCommonMessageTag("isExternalMarketplaceAllowed is true, myApp tab show firstly.",f._contextMgrCorrelationId,20194266)}if(e&&e.value!=r){if(f._enableMyOrg){f._myOrgCatalogUrl=e.value;var v='{ "provValues":[1,1,0,'+e.statusCode+p+e.value+d;u.push('"myOrg":'+v)}if(f._enableOneDriveCatalog&&-1!=document.cookie.indexOf("OneDriveCatalog=true")){f._myOneDriveCatalogUrl=e.value;var y='{ "provValues":[9,9,0,0], "url":"'+e.value+d;u.push('"myOneDrive":'+y)}}if(f._enablePrivateCatalog){var b='{"provValues":[10,10,0,0], "client":"'+f._getClientNameForOmex()+d;u.push('"privateCatalog":'+b)}u.length>0&&(l="{"+u.join(", ")+"}"),f._internalConversationId&&f._serviceEndPointInternal.unregisterConversation(f._internalConversationId);var C=f.getClientId()+"_"+f.getDocUrl(),A=o.OUtil.getFrameName(C),S=o.OUtil.generateConversationId();f._internalConversationId=o.OUtil.generateConversationId(),c.setAttribute("name",A);var _=r;n!=r&&(_='{ "navigationMode":'+n.navigationMode+', "navigationModeParameter": "'+n.assetId+'", "category":"'+n.category+d);var O=window.location.origin,I="",x=[S,encodeURIComponent(O),f._appVersion,o.getAppVerCode(f._appName),f.getLcid(),o.Constants.FileVersion,encodeURIComponent(l),t,encodeURIComponent(g),encodeURIComponent(_),f._contextMgrCorrelationId];I=f._localizedResourcesUrl?f._localizedResourcesUrl+"WefGallery.htm?b="+o.Constants.FileVersion:f._pageBaseUrl+f.getLcid()+"/WefGallery.htm?b="+o.Constants.FileVersion;var T=o.OUtil.addXdmInfoAsHash(I,x.join("|"));T=o.OUtil.addFlightsAsHash(T,JSON.stringify(o.Flights)),f._serviceEndPointInternal.registerConversation(S,T),c.setAttribute("src",T),f._insertDialogDiv?(0!=i.childNodes.length&&i.removeChild(i.childNodes.item(0)),i.appendChild(c)):(i.insertBefore(c,i.firstChild),f._insertDialogDiv=i)}))})),f._preloadOfficeJs()},activateAgavesBlockedBySandboxNotSupport:function(){for(var e in this._cachedOsfControls){var t=this._cachedOsfControls[e];t._status===o.OsfControlStatus.NotSandBoxSupported&&t.activate()}},setRequirementsChecker:function(e){this._requirementsChecker=e},getRequirementsChecker:function(){return this._requirementsChecker},appHasNotifications:function(e){return!!this._ErrorUXHelper&&this._ErrorUXHelper.appHasNotifications(e)},refreshOsfControl:function(e,t){var n=this;for(var r in n._cachedOsfControls)if(n._cachedOsfControls[r]&&e==n._cachedOsfControls[r]._marketplaceID&&t==n._cachedOsfControls[r]._sourceLocationOverrideResourceId){n._cachedOsfControls[r].refresh();break}},_doesUrlHaveSupportedProtocol:function(e){var t=!1;e&&(t=null!=decodeURIComponent(e).match(/^https?:\/\/.+$/gi));return t},_loadLocaleString:function(e){var t=this;if("undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime){for(var n=t._localeStringLoadingPendingCallbacks.length,r=0;r<n;r++){t._localeStringLoadingPendingCallbacks.shift()()}e()}else{t._localeStringLoadingPendingCallbacks.push(e);var a=t._localeStringLoadingPendingCallbacks;if(1===a.length){t._loadStringScript((function(){for(var e=a.length,t=0;t<e;t++){var n=a.shift();"function"==typeof n&&n()}}))}}},_loadStringScript:function(e){var t=this,n=this.getLocalizedScriptsUrl();n+=o.Constants.StringResourceFile;var r=0,a=function(){var i=null;if("undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime){if(r>0){c=o.OUtil.formatString("osfruntime_strings loaded after {0} retries.",r);s.RuntimeTelemetryHelper.LogExceptionTag(c,i,i,20306077)}e()}else{if(++r<3)return void setTimeout((function(){o.OUtil.loadScript(n,a)}),750*r);t._localeStringLoadingPendingCallbacks.length=0;var c=o.OUtil.formatString("The locale, {0}, provided by the host app is not supported. Url: {1}",t.getLcid(),n);s.RuntimeTelemetryHelper.LogExceptionTag(c,i,i,20306076)}};o.OUtil.loadScript(n,a)},_getServiceEndPoint:function(){return this._serviceEndPoint},_getOmexEndPointPageUrl:function(e,t){return o.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._omexEndPointBaseUrl,t,e)},_getManifestAndTargetByConversationId:function(e){for(var t in this._cachedOsfControls){var n=this._cachedOsfControls[t];if(e===n._getConversationId()){var r=n.getStoreType()==o.StoreType.FirstParty?"":n.getMarketplaceVersion();return{manifest:n.getManifest()||o.OsfManifestManager.getCachedManifest(n.getMarketplaceID()),version:r,target:n.getOsfControlType()}}}return null},_createSharePointIFrameProxy:function(e,t){var n=null,r=this;if(r._doesUrlHaveSupportedProtocol(e)){var a=e.length;"/"===e.charAt(a-1)&&(e=e.substr(0,a-1));var i=r._iframeProxies[e];if(i)i.isReady?t(i.clientEndPoint):i.pendingCallbacks.push(t);else{var c=o.OUtil.generateConversationId(),l=document.createElement("iframe");r._iframeProxyCount=r._iframeProxyCount+1;var u=r._iframeNamePrefix+r._iframeProxyCount;l.setAttribute("id",u),l.setAttribute("name",u);var d=e+"/_layouts/15/OfficeExtensionManager.aspx?"+c,f=window.location.origin;d=o.OUtil.addXdmInfoAsHash(d,c+"|"+u+"|"+f),d=o.OUtil.addSerializerVersionAsHash(d,o.SerializerVersion.Browser),d=o.OUtil.addFlightsAsHash(d,JSON.stringify(o.XdmFlights)),o.OUtil.checkFlight(o.FlightNames.CheckReceiverOrigin)&&(d=o.OUtil.addFlightsAsHash(d,JSON.stringify(o.Flights))),l.setAttribute("scrolling","auto"),l.setAttribute("border","0"),l.setAttribute("width","0"),l.setAttribute("height","0"),l.setAttribute("style","position: absolute; left: -100px; top:0px;");var p=r,m=function(t,r){var a,i=p._iframeProxies[e];if(i&&0===t&&r.status?(i.isReady=!0,a=i.clientEndPoint):(delete p._iframeProxies[e],Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(c)?(Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(c),o.OUtil.removeEventListener(l,"load",g),l.parentNode.removeChild(l)):s.RuntimeTelemetryHelper.LogExceptionTag("Unexpected error occured with SharePoint proxy.",n,n,19203550),a=n),i)for(var u=i.pendingCallbacks.length,d=0;d<u;d++){i.pendingCallbacks.shift()(a)}},g=function(){p._iframeProxies[e]&&(p._iframeProxies[e].clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(c,l.contentWindow,e),p._iframeProxies[e].clientEndPoint.invoke("OEM_isProxyReady",m,{__timeout__:2e3}))};document.body.appendChild(l),o.OUtil.addEventListener(l,"load",g),l.setAttribute("src",d),r._iframeProxies[e]={clientEndPoint:n,isReady:!1,pendingCallbacks:[t]}}}else t(n)},_getClientVersionForOmex:function(){if(this._appVersion){var e=this._appVersion.split("."),t=parseInt(e[0],10),n=parseInt(e[1],10)||0;if(!(t<=15&&n<=0)){var r=o.Constants.FileVersion.split(".");return t+"."+n+"."+r[2]+"."+r[3]}}},_getClientNameForOmex:function(){return o.OmexClientNames[this._appName]},_getAppVersionForOmex:function(){return o.OmexAppVersions[this._appName]},_setCachedFlag:function(e){var t=o.OUtil.getLocalStorage();t&&t.setItem(e,"true")},_getCachedFlag:function(e){var t=o.OUtil.getLocalStorage();if(t)return!!t.getItem(e)},_deleteCachedFlag:function(e){var t=o.OUtil.getLocalStorage();t&&t.removeItem(e)},_preloadOfficeJs:function(){var e=this;if(!e._hasPreloadedOfficeJs){var t=document.createElement("script");t.src=o.OUtil.formatString("{0}?locale={1}&host={2}&version={3}",o.Constants.PreloadOfficeJsUrl,e._appUILocale,e._appName,e._hostSpecificFileVersion),t.type="text/javascript",t.id=o.Constants.PreloadOfficeJsId,t.onerror=function(){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to connect to preload service.",null,null,19203551)},document.getElementsByTagName("head")[0].appendChild(t),e._hasPreloadedOfficeJs=!0}},_getAuthTypeForHideAppsExtensionUrl:function(){var e=o.OUtil.getQueryStringParamValue(this._hideAppsExtensionUrl,o.OmexPageParameterKeys.AuthType);return e||o.AuthType.Anonymous},isAddinCommandsAsync:function(e,t){var n=null,r=!1;o.OUtil.validateParamObject(e,{marketplaceId:{type:String,mayBeNull:r},marketplaceVersion:{type:String,mayBeNull:r},storeType:{type:String,mayBeNull:r},storeId:{type:String,mayBeNull:r},targetData:{type:Object,mayBeNull:r},clearCache:{type:Boolean,mayBeNull:!0}},n);var a=e.storeType.toLowerCase(),i={contextActivationMgr:n,referenceInUse:n},c=e.clearCache||r;try{i.referenceInUse={id:e.marketplaceId,version:e.marketplaceVersion,storeType:e.storeType,storeLocator:e.storeId},i.contextActivationMgr=this;var l=function(a){a!=n&&a.statusCode==d.DataServiceResultCode.Succeeded&&a.value!=n?t(!0,a.value._isAddinCommandsManifest(o.getManifestHostType(i.contextActivationMgr._hostType)),e):t(r,r,e)};if(o.StoreType.OMEX===a||o.StoreType.UploadFileDevCatalog===a||o.StoreType.SPCatalog===a||o.StoreType.PrivateCatalog===a){var u=d.CatalogFactory.resolve(a),f={assetId:i.referenceInUse.id,storeType:a,storeId:i.referenceInUse.storeLocator,appVersion:i.referenceInUse.version,targetType:n},p=o.OUtil.Guid.generateNewGuid(),m=new d.AddinCommandsTelemetryContext(p);u.getAndCacheManifest(f,f.storeId,m,(function(e){l({statusCode:e.status,value:e.value})}),c)}else t(!0,r,e)}catch(a){s.RuntimeTelemetryHelper.LogExceptionTag("Error for checking is addincommands or not",a,n,19203552),t(r,r,e)}},setOAuthManager:function(e){this._oAuthManager=e},getManifestInvaildErrorString:function(){return Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message},getDevManifestInvalidUrlErrorString:function(e){return o.OUtil.formatString(Strings.OsfRuntime.L_DeveloperAddinManifestInvalidUrl_Message,e)},getUserNameHashCode:function(){return this._userNameHashCode},ownerAddinControlRecreated:function(e,t){for(var n in this._cachedOsfControls){var r=this._cachedOsfControls[n];r._ownerAddinAssetId&&r._ownerAddinStoreType&&r._ownerAddinAssetId==e&&r._ownerAddinStoreType==t&&r.setOwnerAddinControlRecreated(!0)}}};var u,d;!function(){function e(){}e.hashString=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t},e.stringToHash=function(t){var n=e.hashString(t),r=n.toString();return r=n<0?"1"+r.substring(1):"0"+r},e.startsWith=function(e,t){return 0==e.indexOf(t)},e.isFileUrl=function(t){return e.startsWith(t.toLowerCase(),"file:")},e.removeHttpPrefix=function(t){var n="";return e.startsWith(t.toLowerCase(),e.httpsPrefix)?n=e.httpsPrefix:e.startsWith(t.toLowerCase(),e.httpPrefix)&&(n=e.httpPrefix),t.slice(n.length)},e.getUrlDomain=function(t){var n=e.removeHttpPrefix(t);return n=(n=n.split("/")[0]).split(":")[0]},e.isIp4Address=function(e){return/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)},e.filter=function(t){if(e.isFileUrl(t))return"file://"+(r=e.stringToHash(t));var n=e.getUrlDomain(t);if(e.isIp4Address(n)){var r=e.stringToHash(t);return e.startsWith(n,"10.")?"IP10Range_"+r:e.startsWith(n,"192.")?"IP192Range_"+r:e.startsWith(n,"127.")?"IP127Range_"+r:"IPOther_"+r}return n.split(".").slice(-2).join(".")},e.httpPrefix="http://",e.httpsPrefix="https://"}();o.OsfControl=function(e){var t=null,n=!0,r=!1,a=this;o.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:r},contextActivationMgr:{type:Object,mayBeNull:r},id:{type:String,mayBeNull:r},marketplaceID:{type:String,mayBeNull:r},marketplaceVersion:{type:String,mayBeNull:r},store:{type:String,mayBeNull:r},storeType:{type:String,mayBeNull:r},alternateReference:{type:Object,mayBeNull:n},settings:{type:Object,mayBeNull:n},reason:{type:String,mayBeNull:n},osfControlType:{type:Number,mayBeNull:n},snapshotUrl:{type:String,mayBeNull:n},preactivationCallback:{type:Object,mayBeNull:n},virtualOsfControlActivationCallback:{type:Object,mayBeNull:n},isvirtualOsfControl:{type:Boolean,mayBeNull:n},isDialog:{type:Boolean,mayBeNull:n},hostCustomMessage:{type:String,mayBeNull:n},isForUILessAction:{type:Boolean,mayBeNull:n},ownerAddinAssetId:{type:String,mayBeNull:n},sourceLocationOverrideResourceId:{type:String,mayBeNull:n},sourceLocationOverrideUrl:{type:String,mayBeNull:n},ownerAddinStoreType:{type:String,mayBeNull:n},focusOnIframeWhenLoaded:{type:Boolean,mayBeNull:n},featureGates:{type:Object,mayBeNull:n},hostInfoFlags:{type:Number,mayBeNull:n},sharedRuntimeId:{type:String,mayBeNull:n},initialDisplayMode:{type:Number,mayBeNull:n}},t),a._div=e.div,a._sourceLocationOverrideResourceId=e.sourceLocationOverrideResourceId,a._sourceLocationOverrideUrl=e.sourceLocationOverrideUrl,a._contextActivationMgr=e.contextActivationMgr,a._id=e.id,a._storeType=e.storeType.toLowerCase(),a._storeLocator=e.store,a._marketplaceID=e.marketplaceID,a._marketplaceVersion=e.marketplaceVersion,a._alternateReference=e.alternateReference,a._settings=e.settings||{},a._reason=null==e.reason?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:e.reason,a._osfControlType=null==e.osfControlType?o.OsfControlType.DocumentLevel:e.osfControlType,a._snapshotUrl=e.snapshotUrl,a._status=o.OsfControlStatus.NotActivated,a._iframeIsLoaded=r,a._iframeLoadedNotified=r,a._notificationParams=[],a._iframeUrl=t,a._permission=t,a._conversationId=t,a._manifestUrl=t,a._pageStatus=o.OsfControlPageStatus.NotStarted,a._pageIsReadyTimerExpired=r,a._timer=t,a._retryLoadingNum=2,a._timer1=t,a._retryCheckingNum=2,a._autoRetryCheckingNum=2,a._frame=t,a._agaveEndPoint=t,a._etoken="",a._sqmDWords=[0,0],a._preactivationCallback=e.preactivationCallback,a._telemetryContext={},a._controlFocus=r,a._agavePageUrl=t,a._agaveWindowName=t,a._manifest=t,a._virtualOsfControlActivationCallback=e.virtualOsfControlActivationCallback,a._isvirtualOsfControl=null==e.isvirtualOsfControl?r:e.isvirtualOsfControl,a._isvirtualOsfControlCallbackInvoked=r,a._isManifestProcessedForCustomFunctions=r,a._processManifestForExtendedOverridesPromise=t,a._isDialog=null==e.isDialog?r:e.isDialog,a._hostCustomMessage=e.hostCustomMessage,a._isUpgrading=r,a._isUpgradingFailed=r,a._focusOnIframeWhenLoaded=null==e.focusOnIframeWhenLoaded?r:e.focusOnIframeWhenLoaded,a._featureGates=e.featureGates||{},a._hostInfoFlags="number"==typeof e.hostInfoFlags?e.hostInfoFlags:0,a._sharedRuntimeId=null==e.sharedRuntimeId?t:e.sharedRuntimeId,a._initialDisplayMode=null==e.initialDisplayMode?0:e.initialDisplayMode,a._appContextIsSetToIframeName=r,a._sdxTelemetryContext={},a._contextActivationMgr._enableServiceDeliveredExperience&&(a._bundleUrl=t,a._sdxIframeTemplateUrl="https://osf-agave/rtm/sdx/index.html"),a._isUILessAddInCommands=!!e.isForUILessAction,a._ownerAddinAssetId=e.ownerAddinAssetId?e.ownerAddinAssetId:t,a._ownerAddinStoreType=e.ownerAddinStoreType?e.ownerAddinStoreType:t,o.OUtil.isiOS()&&(a._div.style.webkitOverflowScrolling="touch",a._div.style.overflow="auto"),a._appCorrelationId=a._contextActivationMgr._contextMgrCorrelationId||o.OUtil.Guid.generateNewGuid(),a._iframeOnLoadDelegate=Function.createDelegate(a,a._iframeOnLoad),a._retryActivate=t,a._onKeyDownEventDelegate=Function.createDelegate(a,a._onKeydownEvent),a._ownerAddinControlRecreated=r},o.OsfControl.isFirstPartyStoreString=function(e){if(e){var t=e.toLowerCase();return t===o.StoreType.FirstParty||t===o.StoreType.Sdx}return!1},o.OsfControl.isFirstPartyStoreEnum=function(e){return!!e&&(e==o.StoreTypeEnum.FirstParty||e==o.StoreTypeEnum.Sdx)},o.OsfControl.prototype={activate:function(e){var t=null,n=this;if(n._status!==o.OsfControlStatus.Activated)if(n._contextActivationMgr.registerOsfControl(n),o.OUtil.addEventListener(n._div,"keydown",n._onKeyDownEventDelegate),(e=e||{}).hostType=n._contextActivationMgr._hostType,e.osfControl=e.osfControl||n,e.referenceInUse=e.referenceInUse||{id:n._marketplaceID,version:n._marketplaceVersion,storeType:n._storeType,storeLocator:n._storeLocator},e.correlationId=e.osfControl._appCorrelationId,e.isInsertOsfControl=!!e.isInsertOsfControl&&e.isInsertOsfControl,1==e.isInsertOsfControl){if(!n._contextActivationMgr._hostAllowedSdxEmbedding||n._checkWopiHost(n._contextActivationMgr._enableWopiHostCheck))return void n.invokePreactivationCompletedCallback();n._contextActivationMgr._enableMyOrg&&n._contextActivationMgr._spBaseUrl!=t&&n._contextActivationMgr._wacUpn==t&&s.RuntimeTelemetryHelper.LogCommonMessageTag("WAC UPN in Sharepoint is null, assetID:"+n._marketplaceID,n._contextActivationMgr._contextMgrCorrelationId,592852928),n._contextActivationMgr._enableUpnCheck&&n._contextActivationMgr._enableMyOrg&&n._contextActivationMgr._spBaseUrl!=t?(n._contextActivationMgr._wacUpn==t&&(s.RuntimeTelemetryHelper.LogCommonMessageTag("CheckUpnInSPO failed because WAC UPN is null, assetId: "+n._marketplaceID,n._contextActivationMgr._contextMgrCorrelationId,588814296),n._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_SPO_NotSignIn_Error_ERR,t,t,t,t,t,t,o.ErrorStatusCodes.WAC_WopiHostCheckStatusNotTrusted)),n._contextActivationMgr._upnCheckResult===o.UpnCheckCode.NotMatch?(s.RuntimeTelemetryHelper.LogCommonMessageTag("CheckUpnInSPO failed, assetId: "+n._marketplaceID,n._contextActivationMgr._contextMgrCorrelationId,588814297),n._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_UntrustedHost_Error_ERR,t,t,t,t,t,t,o.ErrorStatusCodes.WAC_WopiHostCheckStatusNotTrusted)):n.activateInternal(e)):n.activateInternal(e)}else n.activateInternal(e);else n.invokePreactivationCompletedCallback()},activateInternal:function(e){var t=!0,n=null,r=this,a=r;try{if(!r._doesBrowserSupportRequiredFeatures())return r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,t,o.ErrorStatusCodes.E_BROWSER_VERSION):r._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,t,o.ErrorStatusCodes.E_BROWSER_VERSION),void r.invokePreactivationCompletedCallback();var i=document.createElement("iframe"),c="sandbox"in i;i=n;var l=!1,u=o.OUtil.getLocalStorage();if(u&&(l=u.getItem(o.Constants.IgnoreSandBoxSupport)),r._contextActivationMgr._autoTrusted&&!c&&!l)return r._contextActivationMgr._ErrorUXHelper.removeProgressDiv(r._div,r._id),r._status=o.OsfControlStatus.NotSandBoxSupported,r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._contextActivationMgr.displayNotification({id:r._id,infoType:o.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN_FirstParty,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR_FirstParty,icon:n,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT_FirstParty,buttonCallback:Function.createCallback(r._activateAgavesBlockedBySandboxNotSupport,r._contextActivationMgr),url:o.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:n,reDisplay:t,displayDeactive:t,errorCode:o.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:t}):r._contextActivationMgr.displayNotification({id:r._id,infoType:o.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR,icon:n,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT,buttonCallback:Function.createCallback(r._activateAgavesBlockedBySandboxNotSupport,r._contextActivationMgr),url:o.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:n,reDisplay:t,displayDeactive:t,errorCode:o.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:t}),void r.invokePreactivationCompletedCallback();r.startActivate();var f=r,p=e.referenceInUse;if(p.storeType===o.StoreType.OMEX||p.storeType===o.StoreType.UploadFileDevCatalog||p.storeType===o.StoreType.SPCatalog||p.storeType===o.StoreType.PrivateCatalog||p.storeType===o.StoreType.FirstParty||p.storeType===o.StoreType.Sdx){var m=new d.OsfControlLoader(r,e.hasConsent),g=new d.ActivationTelemetryContext(r.getCorrelationId(),r._telemetryContext,r._sqmDWords[0],r._sqmDWords[1],r._id);if(p.storeType===o.StoreType.Sdx){if(p.id.toLowerCase()===o.SdxAssetIds.ExperimentationSdx){var h=r._contextActivationMgr._flightingTreatmentVariables["Microsoft.Office.OEP.FA000000059.SourceLocationOverrideResourceId"];h!=n&&(r._sourceLocationOverrideResourceId=h),r._sdxTelemetryContext.sourceLocationOverrideResourceId=r._sourceLocationOverrideResourceId,r._sdxTelemetryContext.SdxOnWacCDNIsEnabled=o.OUtil.checkFlight(o.FlightNames.SdxOnWacCDNIsEnabled)}1==r._initialDisplayMode&&(r._sdxTelemetryContext.isPreload=t),d.SDXCatalog.activateAsync({assetId:p.id,storeId:p.storeLocator,appVersion:p.version,storeType:p.storeType,targetType:""},m,g,r._contextActivationMgr.getRequirementsChecker(),{clientId:r._contextActivationMgr._loggableUserId,sessionStartInfoJson:r._contextActivationMgr._sessionStartInfoJson},r._sdxTelemetryContext)}else{var v=e.noTargetType||e.osfControl.getOsfControlType()===o.OsfControlTarget.TaskPane?n:e.osfControl.getOsfControlType();d.CatalogFactory.resolve(p.storeType).activateAsync({assetId:p.id,storeId:p.storeLocator,appVersion:p.version,storeType:p.storeType,targetType:p.storeType===o.StoreType.SPCatalog?v:""},m,g)}return void r.invokePreactivationCompletedCallback()}if("1B4CD97F-DBFE-4C1A-B4C4-FC163B4F9693"===p.id&&s.RuntimeTelemetryHelper.LogCommonMessageTag("ONO_Onboarding_CorrelationId :"+r.getCorrelationId(),n,23381916),s.AppLoadTimeHelper.ActivationStart(r._telemetryContext,r._sqmDWords[0],r._sqmDWords[1],r.getCorrelationId(),r._id,o.ActivationTypes.V2Enabled),s.AppLoadTimeHelper.ServerCallStart(r._telemetryContext),p.storeType===o.StoreType.Exchange||p.storeType===o.StoreType.InMemory)o.OsfManifestManager.getManifestAsync(e,(function(e){e.statusCode===o.ProxyCallStatusCode.Succeeded&&e.value&&!a._etoken&&(a._etoken=e.value.getInMemoryEToken()||""),a._onGetManifestCompleted(e)}));else if(p.storeType===o.StoreType.Registry&&r._contextActivationMgr._enableDevCatalog||p.storeType===o.StoreType.HardCodedPreinstall)if(e.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.DocumentOpened||p.storeType===o.StoreType.Registry&&r._contextActivationMgr._enableDevCatalog&&!o.OsfManifestManager.hasManifestForControl(e)){o.OUtil.xhrGet(r._contextActivationMgr._devCatalogUrl+"/"+p.id+".xml",(function(t){var r=new o.Manifest.Manifest(t,f._contextActivationMgr.getAppUILocale());if(e.osfControl!=n&&e.osfControl._sharedRuntimeId!=n&&e.osfControl._sharedRuntimeId.length>0){var a=o.OsfManifestManager.getSharedRuntimeManifestCacheKey(e.osfControl._marketplaceID,e.osfControl._sharedRuntimeId);!o.OsfManifestManager.hasManifest(a,e.osfControl._marketplaceVersion)&&o.OsfManifestManager.cacheManifest(a,e.osfControl._marketplaceVersion,r)}!o.OsfManifestManager.hasManifest(r.getMarketplaceID(),r.getMarketplaceVersion())&&o.OsfManifestManager.cacheManifest(r.getMarketplaceID(),r.getMarketplaceVersion(),r),o.OsfManifestManager.getManifestAsync(e,Function.createDelegate(f,f._onGetManifestCompleted))}),(function(e){alert("Error when requesting manifest file: "+e)}))}else{if(e.osfControl!=n&&e.osfControl._sharedRuntimeId!=n&&e.osfControl._sharedRuntimeId.length>0){var y=o.OsfManifestManager.getSharedRuntimeManifestCacheKey(e.osfControl._marketplaceID,e.osfControl._sharedRuntimeId);if(!o.OsfManifestManager.hasManifest(y,e.osfControl._marketplaceVersion)){var b=o.OsfManifestManager.getCachedManifest(e.osfControl._marketplaceID,e.osfControl._marketplaceVersion);o.OsfManifestManager.cacheManifest(y,e.osfControl._marketplaceVersion,b)}}o.OsfManifestManager.getManifestAsync(e,Function.createDelegate(r,r._onGetManifestCompleted))}else if(p.storeType===o.StoreType.OneDrive&&r._contextActivationMgr._enableOneDriveCatalog){var C=function(t){var n=new o.Manifest.Manifest(t,f._contextActivationMgr.getAppUILocale());o.OsfManifestManager.cacheManifest(p.id,n.getMarketplaceVersion(),n),o.OsfManifestManager.getManifestAsync(e,Function.createDelegate(f,f._onGetManifestCompleted))},A=function(){f._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(f,f._refresh),n,n,n,n,o.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},S=window.location.protocol+"//"+window.location.host;o.OneDriveOAuth.setHostCallbackUri(S);var _=r._contextActivationMgr._oneDriveCatalogBaseApiUrl+"/root:/Manifests/"+p.id+":/content?access_token=";o.OneDriveOAuth.getAccessToken((function(e){_+=e,o.OUtil.xhrGet(_,C,A)}),(function(){f._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(f,f._refresh),n,n,n,n,o.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)}))}else p.storeType===o.StoreType.SPApp?(s.AppLoadTimeHelper.EntitlementCheckStart(r._telemetryContext),e.baseUrl=r._contextActivationMgr.getPageBaseUrl(),e.pageUrl=r._contextActivationMgr._docUrl,e.webUrl=r._contextActivationMgr._webUrl,e.appWebUrl=r._contextActivationMgr._webUrl,o.OsfManifestManager.getSPAppEntitlementsAsync(e,Function.createDelegate(r,r._onGetEntitlementsCompleted))):p.storeType===o.StoreType.FileSystem||p.storeType===o.StoreType.Registry||p.storeType===o.StoreType.HardCodedPreinstall?r._showActivationWarning(o.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,n,n,n,n,o.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType):p.storeType===o.StoreType.OneDrive?r._showActivationWarning(o.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,n,n,n,n,o.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType):r._showActivationError(o.OsfControlStatus.UnknownStore,Strings.OsfRuntime.L_AgaveUnknownStoreType_ERR,n,n,n,n,n,n,o.ErrorStatusCodes.E_MANIFEST_REFERENCE_INVALID)}catch(e){var O="Error getting app data.";d.WACUtils.logExceptionToBrowserConsole(O,e),s.RuntimeTelemetryHelper.LogExceptionTag(O,e,r.getCorrelationId(),18420419),r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,n,o.ErrorStatusCodes.WAC_AgaveOsfControlActivationError):r._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,n,o.ErrorStatusCodes.WAC_AgaveOsfControlActivationError)}r.invokePreactivationCompletedCallback()},createIframeForDialogControl:function(e,t,n){for(var r=this;r._div.childNodes.length>0;)r._div.removeChild(r._div.childNodes.item(0));var a=r._createIframeForControl(e);r._iframeUrl=t,r._appDomains=n,r._setIframeAttribute(a,t),r._div.appendChild(a),r._contextActivationMgr.registerOsfControl(r)},deActivate:function(){var e=null,t=this;try{if(o.OUtil.writeProfilerMark(o.OsfControlActivationPerfMarker.DeactivationStart),t._contextActivationMgr.dismissMessages(t._id),t._retryActivate=e,t._status!==o.OsfControlStatus.NotActivated){for(t._agaveEndPoint&&(Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(t._agaveEndPoint._conversationId),t._agaveEndPoint=e),t._frame&&(o.OUtil.removeEventListener(t._frame,"load",t._iframeOnLoadDelegate),t._frame=e),t._timer&&(window.clearTimeout(t._timer),t._timer=e);t._div.childNodes.length>0;)t._div.removeChild(t._div.childNodes.item(0));t._status=o.OsfControlStatus.NotActivated,t._conversationId&&t._contextActivationMgr._getServiceEndPoint().unregisterConversation(t._conversationId),t._contextActivationMgr.raiseOsfControlStatusChange(t)}t._controlFocus=!1,o.OUtil.removeEventListener(t._div,"keydown",t._onKeyDownEventDelegate),t._iframeIsLoaded=!1,t._iframeLoadedNotified=!1,o.OUtil.writeProfilerMark(o.OsfControlActivationPerfMarker.DeactivationEnd)}catch(e){var n="Deactivate failed.";d.WACUtils.logExceptionToBrowserConsole(n,e),s.RuntimeTelemetryHelper.LogExceptionTag(n,e,t.getCorrelationId(),18420420)}},startActivate:function(){var e=this;for(e._controlFocus=!0,e._pageStatus=o.OsfControlPageStatus.Loading,e._sdxTelemetryContext={activationStart:performance.now(),performanceTimestampOrigin:Date.now()-performance.now(),osfControlId:e._id},o.OUtil.writeProfilerMark(o.OsfControlActivationPerfMarker.ActivationStart),e._frame&&(o.OUtil.removeEventListener(e._frame,"load",e._iframeOnLoadDelegate),e._frame=null);e._div.childNodes.length>0;)e._div.removeChild(e._div.childNodes.item(0));e._contextActivationMgr._ErrorUXHelper.showProgress(e._div,e._id)},refresh:function(){this._refresh()},_restartActivate:function(){this.deActivate(),this.startActivate(),this.invokePreactivationCompletedCallback()},purge:function(e){var t=this,n=Function._validateParams(arguments,[{name:"purgeManifest",type:Boolean,mayBeNull:!1}]);if(n)throw n;try{t._contextActivationMgr._ErrorUXHelper.purgeOsfControlNotification(t._id),t.deActivate(),e&&o.OsfManifestManager.purgeManifest(t._marketplaceID,t._marketplaceVersion),t._contextActivationMgr.unregisterOsfControl(t)}catch(e){var r="Purge failed.";d.WACUtils.logExceptionToBrowserConsole(r,e),s.RuntimeTelemetryHelper.LogExceptionTag(r,e,t.getCorrelationId(),18420421)}},invokeVirtualOsfControlActivationCallback:function(e){var t=this;try{t._virtualOsfControlActivationCallback&&(t._virtualOsfControlActivationCallback(t,e),t._isvirtualOsfControlCallbackInvoked=!0)}catch(e){var n="invokeVirtualOsfControlActivationCallback failed.";d.WACUtils.logExceptionToBrowserConsole(n,e),s.RuntimeTelemetryHelper.LogExceptionTag(n,e,t.getCorrelationId(),36496280)}},ensureToGetVirtualOsfControlManifest:function(e){var t=null,n=this,r=n;if(n._manifest)e(n._manifest);else{var a={assetId:n._marketplaceID,appVersion:n._marketplaceVersion,storeType:n._storeType,storeId:n._storeLocator,targetType:t},i=function(n){var a=t;n.status===d.DataServiceResultCode.Succeeded&&n.value?a=n.value:r._status=o.OsfControlStatus.ActivationFailed,e(a)},s=d.CatalogFactory.resolve(a.storeType);s!=t?s.getAndCacheManifest(a,n._storeLocator,new d.AddinCommandsTelemetryContext(n.getCorrelationId()),i):(alert("AddinCommands is not supported in "+a.storeType+" store."),i({status:d.DataServiceResultCode.Failed,value:t}))}},invokePreactivationCompletedCallback:function(){this._preactivationCallback&&this._preactivationCallback()},getMarketplaceID:function(){return this._marketplaceID},getMarketplaceVersion:function(){return this._marketplaceVersion},getContainingDiv:function(){return this._div},getID:function(){return this._id},getSettings:function(){return this._settings},setSettings:function(e){this._settings=e},getReason:function(){return this._reason},getManifest:function(){return this._manifest},getOsfControlType:function(){return this._osfControlType},getSharedRuntimeId:function(){return this._sharedRuntimeId},getSnapshotUrl:function(){return this._snapshotUrl},getStoreType:function(){return this._storeType},isFirstParty:function(){var e=this;return o.OUtil.checkFlight(o.FlightNames.AddInsInSupportedIrmDocsIsEnabled)?o.OsfControl.isFirstPartyStoreString(e._storeType):e._storeType&&(e._storeType===o.StoreType.FirstParty||e._storeType===o.StoreType.Sdx)},hostInfoFlags:function(){return this._hostInfoFlags},updateAgaveEndPointTargetUrl:function(e){this.ensureAgaveEndPoint(),this._agaveEndPoint&&(this._agaveEndPoint._targetUrl=e)},getStoreLocator:function(){return this._storeLocator},getHostCustomMessage:function(){return this._hostCustomMessage},getProperty:function(e){var t=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(t)throw t;return this._settings[e]},addProperty:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"value",type:String,mayBeNull:!1}]);if(n)throw n;this._settings[e]=t},removeProperty:function(e){var t=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(t)throw t;delete this._settings[e]},getStatus:function(){return this._status},getPageStatus:function(){return this._pageStatus},checkAppDomains:function(e){var t=Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(this._appDomains,e);return t||this.isTargetSubdomainOfSourceLocation(e)},isTargetSubdomainOfSourceLocation:function(e){return Microsoft.Office.Common.XdmCommunicationManager.isTargetSubdomainOfSourceLocation(this._agavePageUrl,e)},getNotificationParams:function(){return this._notificationParams},removeFirstNotification:function(){this._notificationParams.shift()},getIframeUrl:function(){return this._iframeUrl},getPermission:function(){return this._permission},getTrustNoPrompt:function(){return!1},getEToken:function(){return this._etoken},getCorrelationId:function(){return this._appCorrelationId},getAgavePageUrl:function(){return this._agavePageUrl},getAgaveWindowName:function(){return this._agaveWindowName},notifyAgave:function(e,t){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_notifyAgave",null,[e,t])},sendMessageToSdx:function(e,t){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_sendMessageToSdx",t,e)},isUILessAddInCommands:function(){return this._isUILessAddInCommands},getOwnerAddinAssetId:function(){return this._ownerAddinAssetId},getOwnerAddinStoreType:function(){return this._ownerAddinStoreType},getFeatureGates:function(){return this._featureGates},getOwnerAddinControlRecreated:function(){return this._ownerAddinControlRecreated},setOwnerAddinControlRecreated:function(e){this._ownerAddinControlRecreated=e},_onKeydownEvent:function(e){var t="input, button, a",n=this;if(e.preventDefault=e.preventDefault||function(){e.returnValue=!1},117==e.keyCode&&(e.ctrlKey||e.metaKey)){e.preventDefault(),e.stopPropagation();var r=o.AgaveHostAction.CtrlF6Exit;e.shiftKey&&(r=o.AgaveHostAction.CtrlF6ExitShift),n._contextActivationMgr._notifyHost(n._id,r)}else if(9==e.keyCode){e.preventDefault(),e.stopPropagation();var a=n._div.querySelectorAll(t);if(0==a.length)return;o.OUtil.focusToNextTabbable(a,e.target||e.srcElement,e.shiftKey)||(e.shiftKey?n._contextActivationMgr._notifyHost(n._id,o.AgaveHostAction.TabExitShift):n._agaveEndPoint?n.notifyAgave(o.AgaveHostAction.TabIn):n._contextActivationMgr._notifyHost(n._id,o.AgaveHostAction.TabExit))}else if(27==e.keyCode)e.preventDefault(),n._contextActivationMgr._notifyHost(n._id,o.AgaveHostAction.EscExit);else if(113==e.keyCode)e.preventDefault(),n._contextActivationMgr._notifyHost(n._id,o.AgaveHostAction.F2Exit);else if(13==e.keyCode||32==e.keyCode)for(var i=n._div.querySelectorAll(t),s=0;s<i.length;s++){var c=e.target||e.srcElement;if(i[s]===c)return e.preventDefault(),e.stopPropagation(),void c.click()}else e.preventDefault(),e.stopPropagation()},_onGetEntitlementsCompleted:function(e){var t=null,n=this;if(e.statusCode===o.ProxyCallStatusCode.Succeeded&&e.value){s.AppLoadTimeHelper.EntitlementCheckEnd(n._telemetryContext);for(var r,a=e.context.referenceInUse,i=e.value.entitlements,c=i.length,l=t,u=0;u<c;u++)(r=i[u]).OfficeExtensionID&&a.id&&r.OfficeExtensionID.toLowerCase()===a.id.toLowerCase()&&(l&&!n._lessThan(l.OfficeExtensionVersion,r.OfficeExtensionVersion)||(l=r));(r=l)?r.OfficeExtensionKillbit?n._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,t,t,t,t,t,t,o.ErrorStatusCodes.E_OEM_EXTENSION_KILLED):(e.context.manifestUrl=r.EncodedAbsUrl,e.context.appInstanceId=r.AppInstanceID,e.context.productId=r.ProductID,e.context.appInstanceId?o.OsfManifestManager.getAppInstanceInfoByIdAsync(e.context,Function.createDelegate(n,n._onGetAppInstanceInfoByIdCompleted)):o.OsfManifestManager.getManifestAsync(e.context,Function.createDelegate(n,n._onGetManifestCompleted))):n._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveNotExist_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createCallback((function(e){e.osfControl._refresh(e)}),{clearCache:!0,referenceInUse:e.context.referenceInUse,osfControl:e.context.osfControl}),t,t,t,t,o.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST)}else n._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,o.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetAppInstanceInfoByIdCompleted:function(e){var t=null,n=this;if(e.statusCode===o.ProxyCallStatusCode.Succeeded&&e.value){var r=e.value,a=e.context;r.AppWebFullUrl&&(a.appWebUrl=r.AppWebFullUrl),a.clientId=r.AppPrincipalId,a.remoteAppUrl=r.RemoteAppUrl,a.appWebUrl&&a.productId?o.OsfManifestManager.getSPTokenByProductIdAsync(a,Function.createDelegate(n,n._onGetSPTokenByProductIdCompleted)):o.OsfManifestManager.getManifestAsync(a,Function.createDelegate(n,n._onGetManifestCompleted))}else n._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,o.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetSPTokenByProductIdCompleted:function(e){e.statusCode===o.ProxyCallStatusCode.Succeeded&&e.value&&(this._etoken=e.value),o.OsfManifestManager.getManifestAsync(e.context,Function.createDelegate(this,this._onGetManifestCompleted))},_retryActivation:function(){var e=this;e._retryLoadingNum--,e._pageStatus===o.OsfControlPageStatus.Ready||e._retryLoadingNum<=0?(e._contextActivationMgr._ErrorUXHelper.removeProgressDiv(e._div,e._id),e._retryLoadingNum=2):e._refresh()},_iframeOnLoad:function(){var e=this,t=e;e._iframeIsLoaded=!0,e._appContextIsSetToIframeName&&t._contextActivationMgr._ErrorUXHelper&&(t._contextActivationMgr._ErrorUXHelper.removeProgressDiv(t._div,t._id),t._pageStatus=o.OsfControlPageStatus.Ready,t._focusOnIframeWhenLoaded&&t._frame&&t._frame.contentWindow&&t._frame.contentWindow.focus(),t.ensureAgaveEndPoint()),s.AppLoadTimeHelper.PageLoaded(e._telemetryContext);t._pageStatus!==o.OsfControlPageStatus.Ready?t._timer=window.setTimeout((function(){!function(e){var t=null;if(e){if(e._contextActivationMgr._ErrorUXHelper&&(o.OUtil.writeProfilerMark(o.OsfControlActivationPerfMarker.SelectionTimeout),e._contextActivationMgr._ErrorUXHelper.removeProgressDiv(e._div,e._id)),e._pageStatus!==o.OsfControlPageStatus.Ready){if(2===e._retryLoadingNum){var n=o.ErrorStatusCodes.WAC_AgaveActivationError;switch(e._pageStatus){case o.OsfControlPageStatus.FailedOriginCheck:n=o.ErrorStatusCodes.WAC_AgaveOriginCheckError;break;case o.OsfControlPageStatus.FailedPermissionCheck:n=o.ErrorStatusCodes.WAC_AgavePermissionCheckError;break;case o.OsfControlPageStatus.FailedHandleRequest:n=o.ErrorStatusCodes.WAC_AgaveHostHandleRequestError}if(e._contextActivationMgr._enableFirstPartySDXErrorMessages&&e.isFirstParty()){var r="Timeout loading contents in iframe. Error: "+n;e._storeType.toLowerCase()==o.StoreType.FirstParty.toLowerCase()?d.FirstPartyCatalog.LogFirstPartyCatalogMonitoringError(r,e._marketplaceID):e._storeType.toLowerCase()==o.StoreType.Sdx.toLowerCase()&&d.SDXCatalog.LogSDXCatalogMonitoringError(r,e._marketplaceID),e._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,n)}else e._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,n)}else if(1===e._retryLoadingNum)if(e._contextActivationMgr._enableFirstPartySDXErrorMessages&&e.isFirstParty()){r="User retry failed to load contents in iframe.";e._storeType.toLowerCase()==o.StoreType.FirstParty.toLowerCase()?d.FirstPartyCatalog.LogFirstPartyCatalogMonitoringError(r,e._marketplaceID):e._storeType.toLowerCase()==o.StoreType.Sdx.toLowerCase()&&d.SDXCatalog.LogSDXCatalogMonitoringError(r,e._marketplaceID),e._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR_FirstParty,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,o.ErrorStatusCodes.WAC_ActivateAttempLoading)}else e._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,o.ErrorStatusCodes.WAC_ActivateAttempLoading)}else e._notifyHostIFrameOnLoaded();e._timer&&(window.clearTimeout(e._timer),e._timer=t),e._pageIsReadyTimerExpired=!0}}(t)}),5e3*t._retryLoadingNum+1):t._notifyHostIFrameOnLoaded()},_handleNotReady:function(){var e=null,t="CheckWopiHost IsHostFrameTrusted Value:",n=this,r=!0;return n._contextActivationMgr._isHostFrameTrusted===o.HostFrameTrustState.NotInitialized||n._contextActivationMgr._isHostFrameTrusted===o.HostFrameTrustState.NotReady?(n._contextActivationMgr.registerNotReadyOsfControl(n),n._timer1=window.setTimeout((function(){!function(n){if(n){if(n._contextActivationMgr._isHostFrameTrusted===o.HostFrameTrustState.NotInitialized||n._contextActivationMgr._isHostFrameTrusted===o.HostFrameTrustState.NotReady)if(n._autoRetryCheckingNum>=0)n._autoRetryCheckingNum--,s.RuntimeTelemetryHelper.LogCommonMessageTag(t+n._contextActivationMgr._isHostFrameTrusted,n._contextActivationMgr._contextMgrCorrelationId,574448148),n._refresh();else if(n._retryCheckingNum>=0){n._retryCheckingNum--,s.RuntimeTelemetryHelper.LogCommonMessageTag(t+n._contextActivationMgr._isHostFrameTrusted,n._contextActivationMgr._contextMgrCorrelationId,577815005);o.ErrorStatusCodes.WAC_WopiHostCheckStatusNotReady;n._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_UnknownHost_Error_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),e,e,e,e,o.ErrorStatusCodes.WAC_WopiHostCheckStatusNotReady)}else{s.RuntimeTelemetryHelper.LogCommonMessageTag(t+n._contextActivationMgr._isHostFrameTrusted,n._contextActivationMgr._contextMgrCorrelationId,577815006);o.ErrorStatusCodes.WAC_WopiHostCheckStatusNotReady;n._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_UnknownHost_Error_ERR,e,e,e,e,e,e,o.ErrorStatusCodes.WAC_WopiHostCheckStatusNotReady)}else s.RuntimeTelemetryHelper.LogCommonMessageTag(t+n._contextActivationMgr._isHostFrameTrusted,n._contextActivationMgr._contextMgrCorrelationId,577815007),n._status==o.OsfControlStatus.NotActivated&&n._refresh();n._timer1&&(window.clearTimeout(n._timer1),n._timer1=e)}}(n)}),5e3*(n._retryCheckingNum+1))):n._contextActivationMgr._isHostFrameTrusted===o.HostFrameTrustState.NotTrusted?(s.RuntimeTelemetryHelper.LogCommonMessageTag(t+n._contextActivationMgr._isHostFrameTrusted,n._contextActivationMgr._contextMgrCorrelationId,577815008),n._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_UntrustedHost_Error_ERR,e,e,e,e,e,e,o.ErrorStatusCodes.WAC_WopiHostCheckStatusNotTrusted),n._timer1&&(window.clearTimeout(n._timer1),n._timer1=e)):(s.RuntimeTelemetryHelper.LogCommonMessageTag(t+n._contextActivationMgr._isHostFrameTrusted,n._contextActivationMgr._contextMgrCorrelationId,577815009),r=!1,n._timer1&&(window.clearTimeout(n._timer1),n._timer1=e)),r},_checkWopiHost:function(e){var t=null,n="CheckWopiHost IsHostFrameTrusted Value:",r=this,a=!1,i=r;return e&&(i._contextActivationMgr._isHostFrameTrusted===o.HostFrameTrustState.NotTrusted?(s.RuntimeTelemetryHelper.LogCommonMessageTag(n+r._contextActivationMgr._isHostFrameTrusted,r._contextActivationMgr._contextMgrCorrelationId,577815010),i._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_UntrustedHost_Error_ERR,t,t,t,t,t,t,o.ErrorStatusCodes.WAC_WopiHostCheckStatusNotTrusted),a=!0,i._timer1&&(window.clearTimeout(i._timer1),i._timer1=t)):r._contextActivationMgr._isHostFrameTrusted===o.HostFrameTrustState.NotInitialized||r._contextActivationMgr._isHostFrameTrusted===o.HostFrameTrustState.NotReady?a=i._handleNotReady():i._timer1&&(window.clearTimeout(i._timer1),i._timer1=t)),s.RuntimeTelemetryHelper.LogCommonMessageTag(n+r._contextActivationMgr._isHostFrameTrusted,r._contextActivationMgr._contextMgrCorrelationId,595354007),a},_isOsfControlInEmbeddingMode:function(e){var t=!1;try{t=null!=e.getContainingDiv().parentNode.parentNode.id.match(/^(m_excelEmbedRenderer_|ewaSynd).+$/gi)}catch(e){d.WACUtils.logExceptionToBrowserConsole("_isOsfControlInEmbeddingMode error.",e)}return t},_createIframeAndActivateOsfControl:function(e){var t=this;s.RuntimeTelemetryHelper.LogCommonMessageTag("IFrame Created"+t._iframeUrl,t._contextActivationMgr._contextMgrCorrelationId,594356319);var n=t._createIframeForControl(e);t._activate(n,t._iframeUrl)},_createIframeForControl:function(e){var t,n=this,r=document.createElement("iframe");for(var a in r.setAttribute("id",n._id),r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.setAttribute("frameborder","0"),r.setAttribute("allowfullscreen","true"),t=n._contextActivationMgr._enableFirstPartySDXErrorMessages&&n.isFirstParty()?e:Strings.OsfRuntime.L_IframeTitle_TXT+" "+e,r.setAttribute("title",t),r.style.msUserSelect="element",n._setSandboxAttribute(r),n._contextActivationMgr._iframeAttributeBag)r.setAttribute(a,n._contextActivationMgr._iframeAttributeBag[a]);return n._frame=r,r},_setSandboxAttribute:function(e){e.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-modals allow-downloads");var t="geolocation;camera";this._contextActivationMgr._disableMicrophonePermission||(t+=";microphone"),this._contextActivationMgr._accessibilityAllowFocusAddinTaskpane&&(t+=";focus-without-user-activation *"),e.setAttribute("allow",t)},_onGetManifestCompleted:function(e){var t=null,n=this;if(e.statusCode===o.ProxyCallStatusCode.Succeeded&&e.value){s.AppLoadTimeHelper.ManifestRequestEnd(n._telemetryContext),s.AppLoadTimeHelper.ServerCallEnd(n._telemetryContext);var r=e.value,a=e.context,i=a.referenceInUse,c=i.storeType,l=r.getDefaultDisplayName();if(n._manifest=r,a.manifestCached&&!a.retried){var u=r.getMarketplaceVersion();if(n._lessThan(u,i.version)&&c===o.StoreType.SPApp)return void n._refresh({clearCache:!0,referenceInUse:i,osfControl:a.osfControl,retried:!0})}if(!1===r.requirementsSupported||void 0===r.requirementsSupported&&!n._contextActivationMgr.getRequirementsChecker().isManifestSupported(r)){r.requirementsSupported=!1;var f,p;return f=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,p=o.ErrorStatusCodes.WAC_AgaveRequirementsError,void n._showActivationError(o.OsfControlStatus.ActivationFailed,f,t,t,null,t,t,!0,p)}if(r.requirementsSupported=!0,n._iframeUrl=r.getDefaultSourceLocation(n._contextActivationMgr.getFormFactor()),n._iframeUrl&&n.updateUrlsForSdx(),n._permission=r.getPermission(),n._appDomains=r.getAppDomains(),c===o.StoreType.SPApp&&n._iframeUrl&&(a.clientId&&(n._iframeUrl=n._iframeUrl.replace(/~clientid/gi,a.clientId)),a.appWebUrl&&(n._iframeUrl=n._iframeUrl.replace(/~appweburl/gi,a.appWebUrl)),a.remoteAppUrl&&(n._iframeUrl=n._iframeUrl.replace(/~remoteappurl/gi,a.remoteAppUrl))),!n._contextActivationMgr._doesUrlHaveSupportedProtocol(n._iframeUrl))return void n._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestError_ERR,t,t,t,t,t,t,o.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT);n.processManifestForCustomFunctions(r),n._isvirtualOsfControl?!a.showNewerVersion&&n.invokeVirtualOsfControlActivationCallback(r):n._createIframeAndActivateOsfControl(l)}else s.RuntimeTelemetryHelper.LogExceptionTag("GetManifest failed:"+d.WACUtils.serializeObjectToString(e),t,t,18420422),n._showActivationError(o.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,o.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},isCurrentLocaleDefaultLocale:function(e){return e.getDefaultLocale().toLowerCase()!=this._contextActivationMgr.getAppUILocale().toLowerCase()},processManifestForExtendedOverrides:function(e){var t=this;return t._processManifestForExtendedOverridesPromise&&!t._isUpgrading?t._processManifestForExtendedOverridesPromise:(t._processManifestForExtendedOverridesPromise=t.processManifestForExtendedOverridesInternal(e),t._processManifestForExtendedOverridesPromise)},processManifestForExtendedOverridesInternal:function(e){var t=null,n=this,r=n;if(n._isManifestProcessedForExtendedOverrides&&!n._isUpgrading)return Promise.resolve(t);n._isManifestProcessedForExtendedOverrides=!0;try{if(!e.getExtendedOverrides().url){var a="Missing extendedOverrides url info for manifest contains ExtendedOverrides node";return s.RuntimeTelemetryHelper.LogExceptionTag(a,t,n.getCorrelationId(),588887693),Promise.reject(a)}d.ExtendedManifestUtility.ensureFinalExtendedOverridesUrls(e,n._contextActivationMgr)}catch(e){a="Failed to construct ExtendedOverrides";return s.RuntimeTelemetryHelper.LogExceptionTag(a,e,n.getCorrelationId(),592221731),Promise.reject(a)}if(e.getExtendedOverrides().hasFinalUrls&&!d.OsfExtendedManifestCache.wasExtendedManifestAlreadyFetched(e._id)){var o=[d.ExtendedManifestUtility.downloadContent(e.getExtendedOverrides().url)];return e.getExtendedOverrides().resourcesUrl&&e.getDefaultLocale().toLowerCase()!=n._contextActivationMgr.getAppUILocale().toLowerCase()&&o.push(d.ExtendedManifestUtility.downloadContent(e.getExtendedOverrides().resourcesUrl)),Promise.all(o).then((function(e){if(e.length<1||e.length>2){var n="Invalid number of files fetched.";throw s.RuntimeTelemetryHelper.LogExceptionTag(n,t,r.getCorrelationId(),578434901),n}var a=JSON.parse(e[0]),o=t;2==e.length&&(o=JSON.parse(e[1]));var i=d.ExtendedManifestUtility.validateAndSubstituteExtendedManifestTokens(a,o);if(!i){n="Did not get a validated extended manifest.";throw s.RuntimeTelemetryHelper.LogExceptionTag(n,t,r.getCorrelationId(),578434902),n}var c=d.ManifestUtil.constructAddInId(r._marketplaceID,r._marketplaceVersion,r._storeType,r._storeLocator);return d.ShortcutsMappingTableManager.validateExtendedManifestShortcutKeys(i,c,!0),d.OsfExtendedManifestCache.set(c,JSON.stringify(i)),r.sendParseExtendedManifestTelemetry(i.shortcuts,r._marketplaceID,r._storeType),t})).catch((function(e){throw s.RuntimeTelemetryHelper.LogExceptionTag("Promise rejected.",e,r.getCorrelationId(),588887695),e}))}return Promise.resolve(t)},sendParseExtendedManifestTelemetry:function(e,t,n){if("object"==typeof Otel&&"object"==typeof Otel.Telemetry&&"function"==typeof Otel.Telemetry.sendOtelEvent){var r={otelEvent:{eventName:"Office.Extensibility.ExtendedManifest.ParseExtendedManifest",dataFields:[{name:"ContainsShortcut",dataType:0,value:e},{name:"SolutionId",dataType:1,value:t},{name:"StoreType",dataType:1,value:n}],telemetryProperties:d.TelemetryProperties}};Otel.Telemetry.sendOtelEvent(r)}else s.RuntimeTelemetryHelper.LogCommonMessageTag("The Otel isn't available, couldn't call sendOtelEvent for logging the shortcuts telemetry",null,574448149)},isCustomFunctionSandbox:function(){var e=this;if("object"==typeof e._settings&&"number"==typeof e._settings.length)for(var t=0;t<e._settings.length;t++)if("object"==typeof e._settings[t]&&"number"==typeof e._settings[t].length&&"string"==typeof e._settings[t][0]&&"string"==typeof e._settings[t][1]&&"customfunctionaddinid"==e._settings[t][0].toLowerCase())return!0;return!1},processManifestForCustomFunctions:function(e){var t=this,n=t;if((!t._isManifestProcessedForCustomFunctions||t._isUpgrading)&&(t._isManifestProcessedForCustomFunctions=!0,e&&(t.getReason()===Microsoft.Office.WebExtension.InitializationReason.Inserted||t.getReason()===Microsoft.Office.WebExtension.InitializationReason.DocumentOpened)&&e.containsCustomFunctionsForAppHost(t._contextActivationMgr._hostType))){var r=o.getManifestHostType(t._contextActivationMgr._hostType),i=t._contextActivationMgr.getFormFactor(),s=new d.Parser.ParsingContext(r,i,null,e),c=new d.Parser.AddinCommandsManifestParser(r,i),l={assetId:t._marketplaceID,appVersion:t._marketplaceVersion,storeType:t._storeType,storeId:t._storeLocator,targetType:null},u={setErrorMessageForAddin:function(e,t){a.msAjaxDebug.trace("Error parsing app manifest: "+t)}},f=c.parseExtensions(l,e,u);if("object"==typeof f.ExtensionPoints&&"number"==typeof f.ExtensionPoints.length)for(var p=e.isXLLCompatible(),m=0;m<f.ExtensionPoints.length;m++)if("CustomFunctions"===f.ExtensionPoints[m].type){var g=f.ExtensionPoints[m],h=function(){var t={osfControl:n,locale:n._getCustomFunctionsLocale(e),invariantNamespace:n._getCustomFunctionsInvariantNamespace(s,g.namespaceResId),namespace:s.resources.ShortStrings[g.namespaceResId],metadataUrl:s.resources.Urls[g.metadataResId],title:e.getDefaultDisplayName(),isXllCompatible:p,manifest:e._xmlProcessor.getNodeXml(e._xmlProcessor.getDocumentElement())};n._contextActivationMgr._notifyHost(n._id,o.AgaveHostAction.InstallCustomFunctions,t)};t.isCustomFunctionSandbox()?(t._iframeUrl=s.resources.Urls[g.pageResId],t._isUpgrading&&h()):h();break}}},setIsUpgrading:function(e){this._isUpgrading=e},getIsUpgrading:function(){return this._isUpgrading},setUpgradingFailed:function(e){this._isUpgradingFailed=e},getUpgradingFailed:function(){return this._isUpgradingFailed},updateUrlsForSdx:function(e){var t=this;if(t.isFirstParty()){var n=".js",r=t._iframeUrl.substr(t._iframeUrl.length-n.length,n.length).toLowerCase()===n,a=/^(?:[a-z]+:)?\/\//i.test(t._iframeUrl);if(r||!a){var o,i=r?"index.html":t._iframeUrl;if(null!==e){var s=e.lastIndexOf("/");-1!==s&&(o=e.substr(0,s)+"/"+i)}r&&(t._bundleUrl=t._iframeUrl),t._iframeUrl=null!=o?o:t._sdxIframeTemplateUrl}}},updateUrlsForSdxBundle:function(e){var t=this;if(t._contextActivationMgr._enableServiceDeliveredExperience){var n=".js";t._iframeUrl.substr(t._iframeUrl.length-n.length,n.length).toLowerCase()===n&&(t._bundleUrl=t._iframeUrl,t._iframeUrl=null!=e?e:t._sdxIframeTemplateUrl)}},_getCustomFunctionsLocale:function(e){return e._UILocale?e._UILocale.toLocaleLowerCase():e._defaultLocale?e._defaultLocale.toLocaleLowerCase():""},_getCustomFunctionsInvariantNamespace:function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("o:OfficeApp"),r=e.selectSingleNode(n,["ov:VersionOverrides","ov:Resources","bt:ShortStrings","bt:String [@id = '"+t+"']"]);return r?r.getAttribute("DefaultValue"):null},_lessThan:function(e,t){return o.OsfManifestManager.versionLessThan(e,t)},_showTrustError:function(e,t,n,r,a,i,s,c){var l=null,u=this,d=o.OUtil.formatString(Strings.OsfRuntime.L_AgaveName_INFO,t||"");d=u._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(d);var f=o.OUtil.formatString(Strings.OsfRuntime.L_AgaveProvider_INFO,n||"");f=u._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(f),c=null==c?!!u.getManifest()&&u.getManifest().isSSOAddin():c;var p=Strings.OsfRuntime.L_AgaveNewAppTitle_TXT,m=Strings.OsfRuntime.L_AgaveTrustAddIn_INFO,g=Strings.OsfRuntime.L_TrustButton_TXT,h=u._osfControlType===o.OsfControlType.DocumentLevel?o.NotificationType.TrustPromptContent:o.NotificationType.TrustPromptTaskpane;u._retryActivate=i,u._contextActivationMgr.displayNotification({id:u._id,infoType:o.InfoType.SecurityInfo,clientName:e,name:t||l,provider:n,title:p,description:m,icon:r||l,buttonTxt:g,buttonCallback:i,url:s||l,dismissCallback:l,reDisplay:!0,displayDeactive:!0,logAsError:!0,retryAll:!0,errorCode:o.ErrorStatusCodes.E_TRUSTCENTER_MOE_UNACTIVATED,iframeNotificationUrl:null,notificationType:h})},_showActivationError:function(e,t,n,r,a,i,s,c,l){var u=!0,d=null,f=this;if(f._status=e,f._contextActivationMgr._enableFirstPartySDXErrorMessages&&f.isFirstParty())var p={id:f._id,infoType:o.InfoType.Error,status:e,title:s||Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty,description:t,icon:d,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||d,url:a||d,dismissCallback:i||d,reDisplay:!i&&u,displayDeactive:u,detailView:!!c&&u,logAsError:u,errorCode:l||0};else p={id:f._id,infoType:o.InfoType.Error,status:e,title:s||Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:t,icon:d,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||d,url:a||d,dismissCallback:i||d,reDisplay:!i&&u,displayDeactive:u,detailView:!!c&&u,logAsError:u,errorCode:l||0};f._contextActivationMgr.displayNotification(p),f._contextActivationMgr.raiseOsfControlStatusChange(f)},_showActivationWarning:function(e,t,n,r,a,i,s){var c=!0,l=null,u=this;if(u._status=e,u._contextActivationMgr._enableFirstPartySDXErrorMessages&&u.isFirstParty())var d={id:u._id,infoType:o.InfoType.Warning,status:e,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT_FirstParty,description:t,icon:l,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||l,url:a||l,dismissCallback:i||l,reDisplay:!i&&c,displayDeactive:c,logAsError:c,errorCode:s||0};else d={id:u._id,infoType:o.InfoType.Warning,status:e,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:t,icon:l,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||l,url:a||l,dismissCallback:i||l,reDisplay:!i&&c,displayDeactive:c,logAsError:c,errorCode:s||0};u._contextActivationMgr.displayNotification(d),u._contextActivationMgr.raiseOsfControlStatusChange(u)},_refresh:function(e){this.deActivate(),this.activate(e)},_activateAgavesBlockedBySandboxNotSupport:function(e){e.activateAgavesBlockedBySandboxNotSupport();var t=o.OUtil.getLocalStorage();t&&t.setItem(o.Constants.IgnoreSandBoxSupport,"true")},_setCachedFlag:function(e){this._contextActivationMgr._setCachedFlag(e)},_getCachedFlag:function(e){return this._contextActivationMgr._getCachedFlag(e)},_deleteCachedFlag:function(e){this._contextActivationMgr._deleteCachedFlag(e)},_notifyHostIFrameOnLoaded:function(){var e=this;e._contextActivationMgr._changeGateOnPageReadyFix?e._contextActivationMgr._notifyHost&&!e._iframeLoadedNotified&&(e._contextActivationMgr._notifyHost(e._id,o.AgaveHostAction.PageIsReady),e._iframeLoadedNotified=!0):e._contextActivationMgr._notifyHost&&e._contextActivationMgr._notifyHost(e._id,o.AgaveHostAction.PageIsReady)},_addETokenAsQueryParameter:function(e){var t=document.createElement("a");t.href=e;var n=this.getEToken(),r=o.Constants.ETokenParameterName+"="+encodeURIComponent(o.OUtil.encodeBase64(n)),a=t.search.length>1?t.search.substr(1)+"&":"";t.search=a+r;var i=t.href;return t=null,i},_addAsQueryParameter:function(e,t,n){var r=document.createElement("a");r.href=e;var a=encodeURIComponent(t)+"="+encodeURIComponent(n),o=r.search.length>1?r.search.substr(1)+"&":"";r.search=o+a;var i=r.href;return r=null,i},_activate:function(e,t){var n="OsfControlId",r=!0,a=this,i=a;if(s.AppLoadTimeHelper.PageStart(a._telemetryContext),a._storeType===o.StoreType.Sdx){var c=performance.now(),l=!1,u=!1,f=!1,p=function(){f||(f=r,s.RuntimeTelemetryHelper.LogCommonMessageTag("SDX Activation Duration = "+(performance.now()-i._sdxTelemetryContext.activationStart)+".",null,42271587),d.SDXCatalog.recordActivationActivity(r,i._sdxTelemetryContext),i._marketplaceID.toLowerCase()===o.SdxAssetIds.ExperimentationSdx&&setTimeout((function(){return i.deActivate()}),6e4))};a._iframeOnLoadDelegate=Function.createDelegate(a,(function(){var e=this;e._sdxTelemetryContext.iframeOnLoadReceived=performance.now(),l||(l=r,d.SDXCatalog.recordActivity("PageLoad",c,r,[{name:n,string:e._id},{name:"AssetId",string:e._marketplaceID}]),u&&p()),e._iframeOnLoad.apply(e,arguments)})),a._iframeOnGetAppContextDelegate=function(){u||(u=r,d.SDXCatalog.recordActivity("OfficeJsReady",c,r,[{name:n,string:i._id},{name:"AssetId",string:i._marketplaceID}]),l&&p())}}a._setIframeAttribute(e,t),a._pageIsReadyTimerExpired=!1,o.OUtil.addEventListener(e,"load",a._iframeOnLoadDelegate),a._div.appendChild(e),a._status=o.OsfControlStatus.Activated,o.OUtil.writeProfilerMark(o.OsfControlActivationPerfMarker.ActivationEnd),a._contextActivationMgr.raiseOsfControlStatusChange(a),s.AppLoadTimeHelper.OfficeJSStartToLoad(a._telemetryContext)},_setIframeAttribute:function(e,t){var n=this;n._storeType!==o.StoreType.Sdx?t=n._addETokenAsQueryParameter(t):n._contextActivationMgr._enableDisplayUILocaleQueryString&&n.isFirstParty()&&(t=n._addAsQueryParameter(t,o.Constants.DisplayLanguageParameterName,n._contextActivationMgr._appUILocale));var r=n._contextActivationMgr.getClientId()+"_"+n._contextActivationMgr.getDocUrl()+"_"+n._id,a=o.OUtil.getFrameName(r);n._conversationId=o.OUtil.generateConversationId();var i=[n._contextActivationMgr._hostType,n._contextActivationMgr._hostPlatform,n._contextActivationMgr._hostSpecificFileVersion,n._contextActivationMgr._appUILocale,n.getCorrelationId(),n._isDialog?"isDialog":null,n._contextActivationMgr._disableLogging?"disableLogging":null,n._hostInfoFlags].join("|"),c=t,l=window.location.origin;if(void 0===l||l&&"null"===l){var u=o.OUtil.parseUrl(window.location.href);l=u.protocol+"//"+u.hostname+(u.port?":"+u.port:"")}var f=n._conversationId+"|"+n._id+"|"+(l.indexOf("$")>=0?encodeURIComponent(l):l),p={};if(p[o.WindowNameItemKeys.BaseFrameName]=a,p[o.WindowNameItemKeys.HostInfo]=i,p[o.WindowNameItemKeys.XdmInfo]=f,p[o.WindowNameItemKeys.SerializerVersion]=o.SerializerVersion.Browser,p[o.WindowNameItemKeys.Flights]=JSON.stringify(o.Flights),n._marketplaceID.toLowerCase()===o.SdxAssetIds.ExperimentationSdx&&n.addProperty("sdxTelemetryContext",JSON.stringify(n._sdxTelemetryContext)),n._contextActivationMgr._enable3rdPartySetAppContextInIframeName||n.isFirstParty()){var m=n.getAppContext(),g=JSON.stringify(m).length;s.RuntimeTelemetryHelper.LogCommonMessageTag("AppContext length is: "+g,n.getCorrelationId(),593896220),g<o.MaxAppContextLength?(p[o.WindowNameItemKeys.AppContext]=m,n._appContextIsSetToIframeName=!0):s.RuntimeTelemetryHelper.LogCommonMessageTag("We got a huge appContext exceeding maximum, appContext length is: "+g,n.getCorrelationId(),593896219)}o.OUtil.checkFlight(o.FlightNames.CheckReceiverOrigin)&&(p[o.WindowNameItemKeys.Flights]=JSON.stringify(o.Flights));var h=o.OUtil.getLocalStorage();if(h){var v="CustomFunctionsRuntimeLogging",y=h.getItem(v);y&&(p[v]=y)}n._contextActivationMgr._getServiceEndPoint().registerConversation(n._conversationId,c,n._appDomains),e.setAttribute("src",c),n._sdxTelemetryContext.iframeUrl=c,n._agaveWindowName=d.WACUtils.serializeObjectToString(p),e.setAttribute("name",n._agaveWindowName),o.OUtil.addClass(e,"AddinIframe"),n._agavePageUrl=c},getAppContext:function(){var e=this,t=e.getEToken(),n=0;if(e._contextActivationMgr._hostSpecificFileVersion&&-1!=e._contextActivationMgr._hostSpecificFileVersion.indexOf(".")){var r=e._contextActivationMgr._hostSpecificFileVersion.split("."),a=r[1];isNaN(a)||(n=parseInt(r[1]))}var i=e._contextActivationMgr._requirementsChecker._getSupportedSet(),s=new o.OfficeAppContext(e.getMarketplaceID(),e._contextActivationMgr._appName,e._contextActivationMgr._appVersion,e._contextActivationMgr._appUILocale,e._contextActivationMgr._dataLocale,e._contextActivationMgr._docUrl||window.location.href,e._contextActivationMgr._clientMode,e.getSettings(),e.getReason(),e.getOsfControlType(),t,e._appCorrelationId,e.getID(),!1,!0,n,i,e.getHostCustomMessage(),e._contextActivationMgr._hostFullVersion||o.Constants.FileVersion,window.innerHeight,window.innerWidth,e.getManifest()?e.getManifest().getDefaultDisplayName():null,e._appDomains,void 0,e.getFeatureGates(),void 0,e._initialDisplayMode);return s._wacHostEnvironment=e._contextActivationMgr._wacHostEnvironment||"0",s._isFromWacAutomation=!!e._contextActivationMgr._isFromWacAutomation,s._addInSourceLocationSubdomainAllowedIsEnabled=!0,s._addInSourceUrl=e._agavePageUrl,s},ensureAgaveEndPoint:function(){var e=this;if(!e._agaveEndPoint){var t=e._conversationId+o.SharedConstants.NotificationConversationIdSuffix;e._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(t,e._frame.contentWindow,e._iframeUrl)}},_getConversationId:function(){return this._conversationId},_doesBrowserSupportRequiredFeatures:function(){var e=!1;if(Object.defineProperty)try{Object.defineProperty({},"myTestProperty",{get:function(){return this.desc},set:function(e){this.desc=e}}),e=!0}catch(e){}return e},_isAddinCommands:function(e){var t=this;if(t._isvirtualOsfControl)e(!0);else if(t._contextActivationMgr._enableAddinCommands&&t._contextActivationMgr._enableTaskpaneUpgradeToAppCommand&&null!=t._virtualOsfControlActivationCallback){var n={marketplaceId:t._marketplaceID,marketplaceVersion:t._marketplaceVersion,storeType:t._storeType,storeId:t._storeLocator,targetData:{}};t._contextActivationMgr.isAddinCommandsAsync(n,(function(t,n){e(n)}))}else e(!1)}},function(e){var t=function(){function t(){}return t.getAll=function(){var n=[],r=[];return e.OsfCache.get(e.OsfCache.c_osfCacheTableName,t.c_osfExtendedManifestIdsCacheKey).then((function(t){return t?(JSON.parse(t).forEach((function(t){r.push(e.OsfCache.get(e.OsfCache.c_extendedManifestTableName,t).then((function(e){if(e){var r={addinId:t,extendedManifest:JSON.parse(e)};n.push(r)}})))})),Promise.all(r)):null})).then((function(){return n}))},t.get=function(t){return e.OsfCache.get(e.OsfCache.c_extendedManifestTableName,t).then((function(e){return e?{addinId:t,extendedManifest:JSON.parse(e)}:null}))},t.set=function(n,r){var a=this,o=JSON.stringify(JSON.parse(r)),i=[];return e.OsfCache.get(e.OsfCache.c_osfCacheTableName,t.c_osfExtendedManifestIdsCacheKey).then((function(e){return e?(i=JSON.parse(e)).indexOf(n)<0?(i.push(n),a.setExtendedManifestHelper(i,n,o,!1)):a.setExtendedManifestHelper(i,n,o,!0):(i.push(n),a.setExtendedManifestHelper(i,n,o,!1))}))},t.wasExtendedManifestAlreadyFetched=function(e){return t.s_fetchedExtendedManifestIdsInMemory&&t.s_fetchedExtendedManifestIdsInMemory.indexOf(e)>=0},t.onChanged=function(e){t.s_onCacheChangedCallbacks.push(e)},t.setExtendedManifestHelper=function(n,r,a,o){return o?e.OsfCache.get(e.OsfCache.c_extendedManifestTableName,r).then((function(n){if(a!=n)return e.OsfCache.set(e.OsfCache.c_extendedManifestTableName,r,a).then((function(){t.processCallbacks()}))})):e.OsfCache.set(e.OsfCache.c_extendedManifestTableName,r,a).then((function(){return t.s_fetchedExtendedManifestIdsInMemory.push(r),e.OsfCache.set(e.OsfCache.c_osfCacheTableName,t.c_osfExtendedManifestIdsCacheKey,JSON.stringify(n)).then((function(){t.processCallbacks()}))}))},t.processCallbacks=function(){t.s_onCacheChangedCallbacks.forEach((function(e){e()}))},t.c_osfExtendedManifestIdsCacheKey="OsfExtendedManifestIds",t.s_fetchedExtendedManifestIdsInMemory=[],t.s_onCacheChangedCallbacks=[],t}();e.OsfExtendedManifestCache=t,t.onChanged((function(){e.ActionMetadataManager.init(!1)}))}(d||(d={})),o.OUtil.setNamespace("Manifest",o),o.Manifest.HostApp=function(e){this._appName=e,this._minVersion=null},o.Manifest.HostApp.prototype={getAppName:function(){return this._appName},getMinVersion:function(){return this._minVersion},_setMinVersion:function(e){this._minVersion=e}},o.Manifest.ExtensionSettings=function(){this._sourceLocations={},this._defaultHeight=null,this._defaultWidth=null},o.Manifest.ExtensionSettings.prototype={getDefaultHeight:function(){return this._defaultHeight},getDefaultWidth:function(){return this._defaultWidth},getSourceLocations:function(){return this._sourceLocations},_addSourceLocation:function(e,t){this._sourceLocations[e.toLocaleLowerCase()]=t},_setDefaultWidth:function(e){this._defaultWidth=e},_setDefaultHeight:function(e){this._defaultHeight=e}},o.Manifest.WebAppInfoAuthorization=function(){this._resource=null,this._scopes=null},o.Manifest.WebAppInfoAuthorization.prototype={getResource:function(){return this._resource},getScopes:function(){return this._scopes}},o.Manifest.EquivalentAddins=function(){this._equivalentAddins=[]},o.Manifest.EquivalentAddins.prototype={isXLLCompatible:function(){for(var e=0;e<this._equivalentAddins.length;e++)if(this._equivalentAddins[e].isXLLCompatible())return!0;return!1},add:function(e){this._equivalentAddins.push(e)},getEquivalentAddins:function(){return this._equivalentAddins}},o.Manifest.EquivalentAddin=function(){this._progId=null,this._fileName=null,this._type=null},o.Manifest.EquivalentAddin.prototype={getProgId:function(){return this._progId},getFileName:function(){return this._fileName},getType:function(){return this._type},isXLLCompatible:function(){return"XLL"==this._type},isComAddin:function(){return"COM"==this._type}},function(e){e[e.Short=0]="Short",e[e.Long=1]="Long"}(u||(u={})),o.Manifest.Runtimes=function(){this._runtimes=[]},o.Manifest.Runtimes.prototype={getSharedRuntime:function(e){var t=null,n=this;if(e==t||n._runtimes==t)return t;for(var r=0;r<n._runtimes.length;r++)if(n._runtimes[r]!=t&&n._runtimes[r].Resid===e)return n._runtimes[r];return t},add:function(e){if(null!=e&&null!=this._runtimes){if(null!=this.getSharedRuntime(e.Resid))throw a.msAjaxError.argument("Manifest parser failure: cannot have same Resid for different runtime.");this._runtimes.push(e)}},getRuntimes:function(){return this._runtimes}},o.Manifest.Runtime=function(){this.Resid=null,this.LifeTime=u.Short},o.Manifest.Manifest=function(e,t){var n=null,r="ov:VersionOverrides",i="VersionOverrides",s="xsi:type",c="o:OfficeApp",l="1.1",f=this;if(f._UILocale=t||"en-us","string"==typeof e){var p;f._displayNames={},f._descriptions={},f._iconUrls={},f._extensionSettings={},f._highResolutionIconUrls={},f._versionOverrides={},f._ribbonExtensionControls={},f._xmlProcessor=new o.XmlProcessor(e,o.ManifestNamespaces[l]),f._xmlProcessor.selectSingleNode(c)?(p=function(){var e=this,t=e._xmlProcessor.selectSingleNode("o:Hosts",g);e._hosts=e._parseHosts(t),t&&(e._hostsXml=t.xml||t.outerHTML);t=e._xmlProcessor.selectSingleNode("o:Requirements",g),e._requirements=e._parseRequirements(t),t&&(e._requirementsXml=t.xml||t.outerHTML);(t=e._xmlProcessor.selectSingleNode("o:HighResolutionIconUrl",g))&&e._parseLocaleAwareSettings(t,Function.createDelegate(e,e._addHighResolutionIconUrl))},f._manifestSchemaVersion=o.ManifestSchemaVersion[l]):(f._xmlProcessor=new o.XmlProcessor(e,o.ManifestNamespaces["1.0"]),p=function(){var e=this,t=e._xmlProcessor.selectSingleNode("o:Capabilities",g),n=e._xmlProcessor.selectNodes("o:Capability",t);e._capabilities=e._parseCapabilities(n)},f._manifestSchemaVersion=o.ManifestSchemaVersion["1.0"]);var m=f._xmlProcessor.getDocumentElement();f._target=o.OUtil.parseEnum(m.getAttribute(s),o.OfficeAppType);var g=f._xmlProcessor.selectSingleNode(c);if(m=f._xmlProcessor.selectSingleNode("o:Id",g),f._id=f._xmlProcessor.getNodeValue(m),!new RegExp("^[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}$","i").test(f._id))throw a.msAjaxError.argument("Manifest");if(m=f._xmlProcessor.selectSingleNode("o:Version",g),f._version=f._xmlProcessor.getNodeValue(m),m=f._xmlProcessor.selectSingleNode("o:ProviderName",g),f._providerName=f._xmlProcessor.getNodeValue(m),m=f._xmlProcessor.selectSingleNode("o:IdIssuer",g),f._idIssuer=f._parseIdIssuer(m),(m=f._xmlProcessor.selectSingleNode("o:AlternateId",g))&&(f._alternateId=f._xmlProcessor.getNodeValue(m)),m=f._xmlProcessor.selectSingleNode("o:DefaultLocale",g),f._defaultLocale=f._xmlProcessor.getNodeValue(m),m=f._xmlProcessor.selectSingleNode("o:DisplayName",g),f._parseLocaleAwareSettings(m,Function.createDelegate(f,f._addDisplayName)),m=f._xmlProcessor.selectSingleNode("o:Description",g),f._parseLocaleAwareSettings(m,Function.createDelegate(f,f._addDescription)),m=f._xmlProcessor.selectSingleNode("o:AppDomains",g),f._appDomains=f._parseAppDomains(m),(m=f._xmlProcessor.selectSingleNode("o:IconUrl",g))&&f._parseLocaleAwareSettings(m,Function.createDelegate(f,f._addIconUrl)),(m=f._xmlProcessor.selectSingleNode("o:Signature",g))&&(f._signature=f._xmlProcessor.getNodeValue(m)),f._parseExtensionSettings(),m=f._xmlProcessor.selectSingleNode("o:Permissions",g),f._permissions=f._parsePermission(m),f._allowSnapshot=!0,(m=f._xmlProcessor.selectSingleNode("o:AllowSnapshot",g))&&(f._allowSnapshot=f._parseBooleanNode(m)),f._manifestSchemaVersion===o.ManifestSchemaVersion[l]){var h="ov:";if(f._target==o.OfficeAppType.ContentApp&&(h="c:"),m=f._xmlProcessor.selectSingleNode(h+i,g)){var v=f._xmlProcessor.selectSingleNode(h+"WebApplicationInfo",m);if(v){var y=f._xmlProcessor.selectSingleNode(h+"Resource",v);f._webApplicationResource=f._xmlProcessor.getNodeValue(y);var b=f._xmlProcessor.selectSingleNode(h+"Id",v);f._webApplicationId=f._xmlProcessor.getNodeValue(b);var C=f._xmlProcessor.selectSingleNode(h+"MsaId",v);f._webApplicationMsaId=C?f._xmlProcessor.getNodeValue(C):f._webApplicationId;var A=f._xmlProcessor.selectSingleNode(h+"Scopes",v);f._webApplicationScopes=f._parseWebApplicationScopes(A,h),f._webApplicationAuthorizations=f._parseWebAppInfoAuthorizations(v,h)}}}if(f._manifestSchemaVersion===o.ManifestSchemaVersion[l]&&f._target==o.OfficeAppType.TaskPaneApp){h="ov:";if(m=f._xmlProcessor.selectSingleNode(h+i,g)){var S=f._xmlProcessor.selectSingleNode(h+"EquivalentAddins",m);f._equivalentAddins=f._parseEquivalentAddins(S,h)}}if(f._manifestSchemaVersion===o.ManifestSchemaVersion[l])(_=f._xmlProcessor.selectSingleNode(r,g))&&(f._manifestSourceLocationOverrides=f._parseSourceLocationOverrides(_));if(f._manifestSchemaVersion===o.ManifestSchemaVersion[l]&&f._target==o.OfficeAppType.TaskPaneApp){var _,O=f._xmlProcessor.selectSingleNode("o:ExtendedOverrides",g);if(O!=n&&f._parseExtendedOverrides(O),(_=f._xmlProcessor.selectSingleNode(r,g))!==n){var I=f._xmlProcessor.selectSingleNode("ov:Hosts",_);if(I!==n){var x=f._xmlProcessor.selectNodes("ov:Host",I);if(x!==n)for(var T=x.length,E=0;E<T;E++){var M=x[E].getAttribute(s);if("Workbook"===M||"Presentation"===M){f._versionOverrides[M]={};var P=f._xmlProcessor.selectSingleNode("ov:Runtimes",x[E]);if(P)f._versionOverrides[M]._runtimes=f._parseRuntimes(P);else{var k=new o.Manifest.Runtime;k.Resid="OEP.SharedRuntime.Url",k.LifeTime=u.Long;var R=new o.Manifest.Runtimes;R.add(k),f._versionOverrides[M]._runtimes=R}var N=new d.Parser.AddinCommandsManifestParser(M,"DesktopFormFactor"),w=new d.Parser.AddinCommandsManifestParser(M,"AllFormFactors"),D={setErrorMessageForAddin:function(e){a.msAjaxDebug.trace("Error parsing app manifest: "+e)}},U={assetId:f._id,appVersion:f._version,storeType:n,storeId:n,targetType:n},F=N.parseExtensions(U,f,D),L=w.parseExtensions(U,f,D);f._versionOverrides[M]._addinCommandsExtensionPoints=F.ExtensionPoints,f._versionOverrides[M]._functionFileResid=F.functionFileResid,f._versionOverrides[M]._customFunctionExtensionPoint=L.ExtensionPoints[0],f._versionOverrides[M]._showTaskpaneControls=f._retrieveAppCommandShowTaskpaneControls(M),f._validateShowTaskpaneSharedRuntime(M),f._generateRibbonExtensionControlMap(M)}}}}}p.apply(f)}else e(f)},o.Manifest.Manifest.prototype={getSourceLocationOverrideByResourceId:function(e){return e&&this._manifestSourceLocationOverrides?this._manifestSourceLocationOverrides[e]:null},getManifestSchemaVersion:function(){return this._manifestSchemaVersion},getMarketplaceID:function(){return this._id},getMarketplaceVersion:function(){return this._version},getDefaultLocale:function(){return this._defaultLocale},getProviderName:function(){return this._providerName},getIdIssuer:function(){return this._idIssuer},getAlternateId:function(){return this._alternateId},getSignature:function(){return this._signature},getCapabilities:function(){return this._capabilities},getDisplayName:function(e){return this._displayNames[e.toLocaleLowerCase()]},getDefaultDisplayName:function(){return this._getDefaultValue(this._displayNames)},getDescription:function(e){return this._descriptions[e]},getDefaultDescription:function(){return this._getDefaultValue(this._descriptions)},getIconUrl:function(e){return this._iconUrls[e]},getDefaultIconUrl:function(){return this._getDefaultValue(this._iconUrls)},getSourceLocation:function(e,t){return this._getExtensionSetting(t).getSourceLocations()[e.toLocaleLowerCase()]},getDefaultSourceLocation:function(e){var t=this._getExtensionSetting(e).getSourceLocations();return this._getDefaultValue(t)},getDefaultWidth:function(e){return this._getExtensionSetting(e).getDefaultWidth()},getDefaultHeight:function(e){return this._getExtensionSetting(e).getDefaultHeight()},getTarget:function(){return this._target},getOmexTargetCode:function(){switch(this._target){case o.OfficeAppType.ContentApp:return 2;case o.OfficeAppType.TaskPaneApp:return 1;case o.OfficeAppType.MailApp:return 3;default:return 0}},getPermission:function(){return this._permissions},hasPermission:function(e){return(this._permissions&e)===e},getHosts:function(){return this._hosts},getHostsXml:function(){return this._hostsXml},getRequirements:function(){return this._requirements},getRequirementsXml:function(){return this._requirementsXml},getHighResolutionIconUrl:function(e){return this._highResolutionIconUrls[e]},getDefaultHighResolutionIconUrl:function(){return this._getDefaultValue(this._highResolutionIconUrls)},getAppDomains:function(){return this._appDomains},getInMemoryEToken:function(){return this._inMemoryEToken},isAllowSnapshot:function(){return this._allowSnapshot},addManifestUrl:function(e){var t=d.WACUtils.getDomainForUrl(e);-1===this._appDomains.indexOf(t)&&this._appDomains.push(t)},getWebApplicationResource:function(){return this._webApplicationResource},getWebApplicationId:function(){return this._webApplicationId},getWebApplicationMsaId:function(){return this._webApplicationMsaId},getWebApplicationScopes:function(){return this._webApplicationScopes},getWebApplicationAuthorizations:function(){return this._webApplicationAuthorizations},getEquivalentAddins:function(){return this._equivalentAddins?this._equivalentAddins.getEquivalentAddins():[]},isXLLCompatible:function(){return!!this._equivalentAddins&&this._equivalentAddins.isXLLCompatible()},isSSOAddin:function(){return!!this._webApplicationResource&&!!this._webApplicationId},containsAddinCommands:function(e){var t=this._getCurrentHostTypeNode(e);if(null!==t&&null!=this._xmlProcessor.selectSingleNode("ov:DesktopFormFactor",t))return!0;return!1},getRibbonExtensionControlMap:function(){return this._ribbonExtensionControls},getExtendedOverrides:function(){return this._extendedOverrides},getExtendedOverridesTokens:function(){return this._extendedOverridesTokens?this._extendedOverridesTokens:[]},containsCustomFunctions:function(e){var t=this._getCurrentHostTypeNode(e);if(null!==t){var n=this._xmlProcessor.selectSingleNode("ov:AllFormFactors",t);if(null!==n){var r=this._xmlProcessor.selectNodes("ov:ExtensionPoint",n);if(null!==r)for(var a=r.length,o=0;o<a;o++){if("CustomFunctions"===r[o].getAttribute("xsi:type"))return!0}}}return!1},containsCustomFunctionsForAppHost:function(e){var t=o.getManifestHostType(e);return e!=o.HostType.Outlook&&this.containsCustomFunctions(t)},getSharedRuntimeForCustomFunctions:function(e){var t=null;if(e==t||this._versionOverrides==t)return t;var n=this._versionOverrides[e];return n==t||n._customFunctionExtensionPoint==t||n._runtimes==t?t:n._runtimes.getSharedRuntime(n._customFunctionExtensionPoint.pageResId)},getSharedRuntimeForTaskpane:function(e,t){var n=null;if(e==n||t==n||this._versionOverrides==n)return n;var r=this._versionOverrides[e];if(r==n||r._showTaskpaneControls==n||r._runtimes==n)return n;var a=n;return this._iterateAppCommandShowTaskpaneControls(r._showTaskpaneControls,(function(e){return e!=n&&e.action!=n&&((e.action.taskpaneId===t||e.id===t)&&(a=e.action.sourceLocationResid,!0))})),a==n?n:r._runtimes.getSharedRuntime(a)},getTaskpaneIdByRuntimeId:function(e,t){var n=null;if(e==n||t==n||this._versionOverrides==n)return n;var r=this._versionOverrides[e];if(r==n||r._showTaskpaneControls==n||r._runtimes==n)return n;var a=n;return this._iterateAppCommandShowTaskpaneControls(r._showTaskpaneControls,(function(e){return e!=n&&e.action!=n&&(e.action.sourceLocationResid===t&&(a=e.action.taskpaneId,!0))})),a},getSharedRuntimeById:function(e,t){var n=null;if(this._versionOverrides==n)return n;var r=this._versionOverrides[e];return r==n||r._runtimes==n?n:r._runtimes.getSharedRuntime(t)},getSharedRuntimeForAppCmdsExecuteFunction:function(e){var t=null;if(e==t||this._versionOverrides==t)return t;var n=this._versionOverrides[e];return n==t||n._runtimes==t?t:n._runtimes.getSharedRuntime(n._functionFileResid)},getSharedRuntimeId:function(e,t,n){var r=t?this.getSharedRuntimeForAppCmdsExecuteFunction(e):this.getSharedRuntimeForTaskpane(e,n);return null!==r?r.Resid:null},sharedRuntimeHasShortLifeTime:function(e,t){var n=null;if(e===n||t===n||this._versionOverrides===n)return!1;var r=this._versionOverrides[e];if(r===n||r._runtimes===n)return!1;var a=r._runtimes.getSharedRuntime(t);return a!==n&&a.LifeTime===u.Short},_iterateAppCommandShowTaskpaneControls:function(e,t){if(null!=e&&null!=t)for(var n=0;n<e.length&&!t(e[n]);n++);},_generateRibbonExtensionControlMap:function(e){var t=null,n=this;if(e==t||n._versionOverrides==t)return t;var r=n._versionOverrides[e];if(r!=t&&r._addinCommandsExtensionPoints!=t)for(var a=r._addinCommandsExtensionPoints.length,o=0;o<a;o++){var i=r._addinCommandsExtensionPoints[o];if("PrimaryCommandSurface"===i.type&&i.tabs)for(var s=0;s<i.tabs.length;s++){var c=i.tabs[s];n._ribbonExtensionControls[c.id]=c,n._addRibbonControlsToMap(c)}}},_addRibbonControlsToMap:function(e){if(e&&e.children)for(var t=0;t<e.children.length;t++){var n=e.children[t];!n||n instanceof d.Parser.MenuControl||(this._ribbonExtensionControls[n.id]=n),this._addRibbonControlsToMap(n)}},_retrieveAppCommandShowTaskpaneControls:function(e){var t=null,n=this;if(e==t||n._versionOverrides==t)return t;var r=n._versionOverrides[e],a=[];if(r!=t&&r._addinCommandsExtensionPoints!=t)for(var o=r._addinCommandsExtensionPoints.length,i=0;i<o;i++){var s=r._addinCommandsExtensionPoints[i];if(s!=t)if("PrimaryCommandSurface"===s.type){if(s.tabs==t)continue;for(var c=0;c<s.tabs.length;c++){var l=s.tabs[c];if(l!=t&&l.children!=t)for(var u=0;u<l.children.length;u++){var d=l.children[u];d!=t&&d.children!=t&&n._getShowTaskpaneControlsFromControlsParent(d,a)}}}else if("ContextMenu"===s.type){if(s.children==t)continue;var f=s.children[0];if(f==t||f.children==t)continue;n._getShowTaskpaneControlsFromControlsParent(f,a)}}return a},_getShowTaskpaneControlsFromControlsParent:function(e,t){var n="ShowTaskpane",r=null;if(e!=r&&e.children!=r&&t!=r)for(var a=0;a<e.children.length;a++){var o=e.children[a];if(o!=r)if("Button"===o.controlType)o.action!=r&&o.actionType===n&&t.push(o);else{if(o.children==r)continue;for(var i=0;i<o.children.length;i++){var s=o.children[i];s!=r&&s.action!=r&&s.actionType===n&&t.push(s)}}}},_validateShowTaskpaneSharedRuntime:function(e){var t=null;if(e!=t&&this._versionOverrides!=t){var n=this._versionOverrides[e];if(n!=t&&n._runtimes!=t&&n._showTaskpaneControls!=t){var r=[];this._iterateAppCommandShowTaskpaneControls(n._showTaskpaneControls,(function(e){var o="Manifest parser failure: resid and taskpaneid not correct";if(e==t||e.action==t)return!1;var i=n._runtimes.getSharedRuntime(e.action.sourceLocationResid),s=t;if(i==t||i.LifeTime!=u.Long){if(e.action.taskpaneId==t)return!1}else s=i.Resid;for(var c=[e.action.taskpaneId,s],l=!0,d=0;d<r.length;d++){if(r[d][0]==c[0]&&r[d][1]==c[1]){if(c[0]==t)throw a.msAjaxError.argument(o);l=!1;break}if(r[d][1]==c[1]&&r[d][1]!=t||r[d][0]==c[0]&&r[d][0]!=t)throw l=!1,a.msAjaxError.argument(o)}return l&&r.push(c),!1}))}}},_getDefaultValue:function(e){var t,n=this;if(n._UILocale&&(t=e[n._UILocale]||e[n._UILocale.toLocaleLowerCase()]||void 0),!t&&n._defaultLocale&&(t=e[n._defaultLocale]||e[n._defaultLocale.toLocaleLowerCase()]||void 0),!t){var r;for(var a in e){r=a;break}t=e[r]}return t},_getExtensionSetting:function(e){var t,n=this;if(void 0!==n._extensionSettings[e])t=n._extensionSettings[e];else for(var r in n._extensionSettings){t=n._extensionSettings[r];break}return t},_addDisplayName:function(e,t){this._displayNames[e.toLocaleLowerCase()]=t},_addDescription:function(e,t){this._descriptions[e]=t},_addIconUrl:function(e,t){this._iconUrls[e]=t},_parseLocaleAwareSettings:function(e,t){if(!e)throw a.msAjaxError.argument("Manifest");var n=e.getAttribute("DefaultValue");t(this._defaultLocale,n);var r=this._xmlProcessor.selectNodes("o:Override",e);if(r)for(var o=r.length,i=0;i<o;i++){var s=r[i];t(s.getAttribute("Locale"),s.getAttribute("Value"))}},_parseBooleanNode:function(e){if(e){var t=this._xmlProcessor.getNodeValue(e).toLowerCase();return"true"===t||"1"===t}return!1},_parseIdIssuer:function(e){if(e){var t=this._xmlProcessor.getNodeValue(e);return o.OUtil.parseEnum(t,o.ManifestIdIssuer)}return o.ManifestIdIssuer.Custom},_parseCapabilities:function(e){for(var t,n=[],r=0;r<e.length;r++){t=e[r].getAttribute("Name"),t=o.OUtil.parseEnum(t,o.Capability),n.push(t)}return n},_parsePermission:function(e){if(!e)throw a.msAjaxError.argument("Manifest");var t=this._xmlProcessor.getNodeValue(e);return o.OUtil.parseEnum(t,o.OsfControlPermission)},_parseExtensionSettings:function(){var e,t,n,r=this,i=r;for(var s in o.FormFactor){var c=r._xmlProcessor.selectSingleNode("o:OfficeApp");if(t=r._xmlProcessor.selectSingleNode("o:"+o.FormFactor[s],c)){e=new o.Manifest.ExtensionSettings,n=r._xmlProcessor.selectSingleNode("o:SourceLocation",t);r._parseLocaleAwareSettings(n,(function(t,n){e._addSourceLocation(t,n),i.addManifestUrl(n)})),(n=r._xmlProcessor.selectSingleNode("o:RequestedWidth",t))&&e._setDefaultWidth(r._xmlProcessor.getNodeValue(n)),(n=r._xmlProcessor.selectSingleNode("o:RequestedHeight",t))&&e._setDefaultHeight(r._xmlProcessor.getNodeValue(n)),r._extensionSettings[s]=e}}if(!e)throw a.msAjaxError.argument("Manifest")},_parseHosts:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:Host",e),r=0;r<n.length;r++)t.push(n[r].getAttribute("Name"));return t},_parseWebApplicationScopes:function(e,t){var n=[];if(e)for(var r=this._xmlProcessor.selectNodes(t+"Scope",e),a=0;a<r.length;a++)n.push(this._xmlProcessor.getNodeValue(r[a]));return n},_parseWebAppInfoAuthorizations:function(e,t){var n=this,r=[],a=n._xmlProcessor.selectSingleNode(t+"Authorizations",e);if(a){var i=n._xmlProcessor.selectNodes(t+"Authorization",a);if(i)for(var s=0;s<i.length;s++){var c=i[s],l=new o.Manifest.WebAppInfoAuthorization,u=n._xmlProcessor.selectSingleNode(t+"Resource",c);u&&(l._resource=n._xmlProcessor.getNodeValue(u));var d=n._xmlProcessor.selectSingleNode(t+"Scopes",c);if(d){var f=n._xmlProcessor.selectNodes(t+"Scope",d);if(f){for(var p=[],m=0;m<f.length;m++){var g=f[m];p.push(n._xmlProcessor.getNodeValue(g))}l._scopes=p}}r.push(l)}}return r},_parseRequirements:function(e){var t=this,n={sets:[],methods:[]};if(e){var r=t._xmlProcessor.selectSingleNode("o:Sets",e);n.sets=t._parseSets(r);var a=t._xmlProcessor.selectSingleNode("o:Methods",e);n.methods=t._parseMethods(a)}return n},_parseSets:function(e){var t=[];if(e)for(var n=e.getAttribute("DefaultMinVersion"),r=this._xmlProcessor.selectNodes("o:Set",e),a=0;a<r.length;a++){var o=r[a],i=o.getAttribute("MinVersion");t.push({name:o.getAttribute("Name"),version:i||n})}return t},_parseMethods:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:Method",e),r=0;r<n.length;r++)t.push(n[r].getAttribute("Name"));return t},_parseSourceLocationOverrides:function(e){var t={};if(e){var n=this._xmlProcessor.selectSingleNode("ov:Resources",e);if(n){var r=this._xmlProcessor.selectSingleNode("bt:Urls",n);if(r){var a=this._xmlProcessor.selectNodes("bt:Url",r);if(a)for(var o=0;o<a.length;o++){var i=a[o],s=i.getAttribute("id"),c=i.getAttribute("DefaultValue");s&&c&&(t[s]=c)}}}}return t},_parseAppDomains:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:AppDomain",e),r=0;r<n.length;r++){var a=d.WACUtils.getDomainForUrl(this._xmlProcessor.getNodeValue(n[r]));-1===t.indexOf(a)&&t.push(a)}return t},_parseRuntimes:function(e){var t=null;if(e==t)return t;var n=new o.Manifest.Runtimes,r=this._xmlProcessor.selectNodes("ov:Runtime",e);if(r==t)return t;for(var a=0;a<r.length;a++){var i=this._parseRuntime(r[a]);n.add(i)}return n},_parseRuntime:function(e){if(null==e)return null;var t=new o.Manifest.Runtime;return t.Resid=e.getAttribute("resid"),"long"===e.getAttribute("lifetime")?t.LifeTime=u.Long:t.LifeTime=u.Short,t},_parseEquivalentAddins:function(e,t){var n=new o.Manifest.EquivalentAddins;if(e)for(var r=this._xmlProcessor.selectNodes(t+"EquivalentAddin",e),a=0;a<r.length;a++){var i=this._parseEquivalentAddin(r[a],t);n.add(i)}return n},_parseEquivalentAddin:function(e,t){var n=this,r=new o.Manifest.EquivalentAddin;if(e){var i=n._xmlProcessor.selectSingleNode(t+"ProgId",e);i&&(r._progId=n._xmlProcessor.getNodeValue(i));var s=n._xmlProcessor.selectSingleNode(t+"FileName",e);s&&(r._fileName=n._xmlProcessor.getNodeValue(s));var c=n._xmlProcessor.selectSingleNode(t+"Type",e);if(!c)throw a.msAjaxError.argument("Manifest");var l=""+n._xmlProcessor.getNodeValue(c);r._type=l.toUpperCase()}return r},_parseExtendedOverrides:function(e){var t="xsi:type",n=this;n._extendedOverrides={url:e.getAttribute("Url"),resourcesUrl:e.getAttribute("ResourcesUrl"),hasFinalUrls:!1};var r=n._xmlProcessor.selectSingleNode("o:Tokens",e);if(null!=r){var a=n._xmlProcessor.selectNodes("o:Token",r);if(null!=a){for(var i=[],s=0;s<a.length;s++){var c=a[s],l=n._xmlProcessor.selectNodes("o:Override",c),u=[],d=c.getAttribute(t);if(d==o.ExtendedManifestSupportTokens.Requirements)for(var f=0;f<l.length;f++){var p=n._xmlProcessor.selectSingleNode("o:Requirements",l[f]),m={value:l[f].getAttribute("Value"),data:n._parseRequirements(p)};u.push(m)}else if(d==o.ExtendedManifestSupportTokens.Locale)for(f=0;f<l.length;f++){m={value:l[f].getAttribute("Value"),data:l[f].getAttribute("Locale").toLowerCase()};u.push(m)}var g={name:c.getAttribute("Name"),defaultValue:c.getAttribute("DefaultValue"),type:c.getAttribute(t),overrides:u};i.push(g)}n._extendedOverridesTokens=i}}},_addHighResolutionIconUrl:function(e,t){this._highResolutionIconUrls[e]=t},_isAddinCommandsManifest:function(e){return this.containsAddinCommands(e)||this.containsCustomFunctions(e)},_getCurrentHostTypeNode:function(e){var t=null,n=this,r=n._xmlProcessor.selectSingleNode("o:OfficeApp");if(r!==t&&n.getManifestSchemaVersion()===o.ManifestSchemaVersion[1.1]){var a=n._xmlProcessor.selectSingleNode("ov:VersionOverrides",r);if(a!==t){var i=n._xmlProcessor.selectSingleNode("ov:Hosts",a);if(i!==t){var s=n._xmlProcessor.selectNodes("ov:Host",i);if(s!==t)for(var c=s.length,l=0;l<c;l++){if(s[l].getAttribute("xsi:type")===e)return s[l]}}}}return t}},o.OsfManifestManager=function(){var e="undefined",t="marketplaceVersion",n="marketplaceID",r=!0,a=null,i=!1,c={},l="en-us",u={};function f(e,t){return e+"_"+t}return{getManifestAsync:function(e,t){o.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:i},referenceInUse:{type:Object,mayBeNull:i}},t);var n=this,l=e.referenceInUse,u=l.id;e.osfControl!=a&&e.osfControl._sharedRuntimeId!=a&&e.osfControl._sharedRuntimeId.length>0&&(u=o.OsfManifestManager.getSharedRuntimeManifestCacheKey(l.id,e.osfControl._sharedRuntimeId));var p=f(u,l.version),m=c[p];if(e.manifestCached=i,m)e.manifestCached=r,n.manifestContainsDownloadResources(m)?n.downloadResourcesAsync(e,t,m,p):t({statusCode:o.ProxyCallStatusCode.Succeeded,value:m,context:e});else if(e.clientEndPoint&&e.manifestUrl){s.AppLoadTimeHelper.ManifestRequestStart(e.osfControl._telemetryContext);var g={manifestUrl:e.manifestUrl,id:l.id,version:l.version,clearCache:e.clearCache||i};this._invokeProxyMethodAsync(e,"OEM_getManifestAsync",(function(i){var c;if(i.statusCode===o.ProxyCallStatusCode.Succeeded&&i.value)try{var u;c=i.context.osfControl,"string"==typeof i.value?(i.context.manifestCached=r,u=i.value):(i.context.manifestCached=i.value.cached,u=i.value.manifest),s.AppLoadTimeHelper.SetManifestDataCachedFlag(c._telemetryContext,i.value.cached),i.value=new o.Manifest.Manifest(u,c._contextActivationMgr.getAppUILocale()),o.OsfManifestManager.cacheManifest(l.id,l.version,i.value)}catch(e){var f;i.value=a,c&&(f=c._appCorrelationId);var g="Invalid manifest in getManifestAsync.";d.WACUtils.logExceptionToBrowserConsole(g,e),s.RuntimeTelemetryHelper.LogExceptionTag(g,e,f,18420423)}else s.RuntimeTelemetryHelper.LogExceptionTag("getManifestAsync failed:"+d.WACUtils.serializeObjectToString(i),a,a,18420424);n.manifestContainsDownloadResources(m)?n.downloadResourcesAsync(e,t,i.value,p):t(i)}),g)}else t({statusCode:o.ProxyCallStatusCode.Failed,value:a,context:e})},manifestContainsDownloadResources:function(e){return this.manifestContainsExtendedOverrides(e)},manifestContainsExtendedOverrides:function(e){return"object"==typeof e&&"function"==typeof e.getExtendedOverrides&&"object"==typeof e.getExtendedOverrides()},downloadResourcesAsync:function(e,t,n,r){this.manifestContainsExtendedOverrides(n)&&this.downloadExtendedOverridesAsync(e,t,n,r)},downloadExtendedOverridesAsync:function(e,t,n,r){var i=this,c=function(e,t,n,c){var l=e.osfControl._appCorrelationId;d.WACUtils.logExceptionToBrowserConsole(c,n),s.RuntimeTelemetryHelper.LogExceptionTag(c,n,l,578168534),i._cachedManifests&&i._cachedManifests[r]&&(i._cachedManifests[r]=void 0),t({statusCode:o.ProxyCallStatusCode.Failed,value:a,context:e})};!this.manifestContainsExtendedOverrides(n)&&c(e,t,"Unreachable","Unreachable code path executed!");try{e.osfControl.processManifestForExtendedOverrides(n).then((function(){return function(e,t,n){t({statusCode:o.ProxyCallStatusCode.Succeeded,value:n,context:e})}(e,t,n)})).catch((function(n){return c(e,t,n,"Invalid ExtendedOverrides content.")}))}catch(n){c(e,t,n,"Unexpected exception from OsfControlV2.processManifestForExtendedOverrides()")}},getAppInstanceInfoByIdAsync:function(e,t){o.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:i},appInstanceId:{type:String,mayBeNull:i},clientEndPoint:{type:Object,mayBeNull:i}},t);var n={webUrl:e.webUrl,appInstanceId:e.appInstanceId,clearCache:e.clearCache||i};this._invokeProxyMethodAsync(e,"OEM_getSPAppInstanceInfoByIdAsync",t,n)},getSPTokenByProductIdAsync:function(e,t){o.OUtil.validateParamObject(e,{appWebUrl:{type:String,mayBeNull:i},productId:{type:String,mayBeNull:i}},t);var n=this;e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.appWebUrl,(function(r){if(r){var s={webUrl:e.appWebUrl,productId:e.productId,clearCache:e.clearCache||i,clientEndPoint:r};n._invokeProxyMethodAsync(e,"OEM_getSPTokenByProductIdAsync",t,s)}else t({statusCode:o.ProxyCallStatusCode.ProxyNotReady,value:a,context:e})}))},getSPAppEntitlementsAsync:function(e,t){var n="/";if(o.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:i},referenceInUse:{type:Object,mayBeNull:i},baseUrl:{type:String,mayBeNull:i},pageUrl:{type:String,mayBeNull:i},webUrl:{type:String,mayBeNull:r}},t),e.webUrl)this.getCorporateCatalogEntitlementsAsync(e,t);else{var s=document.createElement("a");s.href=e.pageUrl;var c=s.pathname,l=c.split(n),u=l.length-1,d=s.href.substring(0,s.href.length-c.length);d&&d.charAt(d.length-1)!==n&&(d+=n);for(var f=[d],p=0;p<u;p++)l[p]&&(d=d+l[p]+n,f.push(d));s=a;var m=this,g=e.osfControl._contextActivationMgr,h=f.pop(),v=function(e){if(e.statusCode===o.ProxyCallStatusCode.Succeeded){var r=e.value;r&&r.charAt(r.length-1)!==n&&(r+=n),g._webUrl=r,e.context.webUrl=r,e.context.appWebUrl=r,m.getCorporateCatalogEntitlementsAsync(e.context,t)}else t(e)},y=function(n){if(n){e.clientEndPoint=n;var r={pageUrl:e.pageUrl,baseUrl:h,clearCache:e.clearCache||i};m._invokeProxyMethodAsync(e,"OEM_getSPAppWebUrlFromPageUrlAsync",v,r)}else f.length>0?(h=f.pop(),g._createSharePointIFrameProxy(h,y)):t({statusCode:o.ProxyCallStatusCode.Failed,value:a,context:e})};g._createSharePointIFrameProxy(h,y)}},getOneDriveEntitlementsAsync:function(e,t){var n="Content-Type",r=e.referenceInUse.storeLocator,a=e.referenceInUse.storeLocator+"/root:/Manifests",i=o.OneDriveOAuth.getAccessTokenFromCookie(),s="?access_token="+i,c=a+s,l=new XMLHttpRequest,u=new XMLHttpRequest;l.onreadystatechange=function(){if(4==l.readyState&&200==l.status){var t=JSON.parse(l.response).id,r=e.referenceInUse.storeLocator+"/items/"+t+"/children"+s;u.open("GET",r),u.setRequestHeader(n,"json"),u.send()}};var d=[],f=0,p=0,m=function(){f==p&&t({statusCode:o.ProxyCallStatusCode.Succeeded,value:{entitlements:d},context:e})},g=function(e,t){p++;var n=t;try{var r=new o.Manifest.Manifest(e.responseText),a=[];a.push(r.getDefaultDisplayName()),a.push(n),a.push(r.getDefaultDescription()),a.push(r.getTarget()),a.push(r.getMarketplaceVersion()),a.push(n),a.push(o.StoreType.OneDrive),a.push(r.getDefaultWidth()||0),a.push(r.getDefaultHeight()||0),a.push(r.getDefaultIconUrl()),a.push(r.getProviderName()),a.push(r.getDefaultLocale()),a.push(o.StoreType.OneDrive),d.push(a)}catch(e){}m()},h=function(){p++,m()};u.onreadystatechange=function(){if(4==u.readyState&&200==u.status){for(var e=JSON.parse(u.responseText),t=0;t<e.value.length;t++)if(".xml"==e.value[t].name.substr(e.value[t].name.length-4).toLowerCase()){var n=r+"/root:/Manifests/"+e.value[t].name+":/content?access_token="+i;o.OUtil.xhrGetFull(n,e.value[t].name,g,h),f++}m()}},l.open("GET",c),l.setRequestHeader(n,"json"),l.send()},getCorporateCatalogEntitlementsAsync:function(e,t){o.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:i},referenceInUse:{type:Object,mayBeNull:i},webUrl:{type:String,mayBeNull:i}},t),s.AppLoadTimeHelper.AuthenticationStart(e.osfControl._telemetryContext);var n=this,c=0,l=function(u){if(u){s.AppLoadTimeHelper.AuthenticationEnd(e.osfControl._telemetryContext),e.clientEndPoint=u;var d={webUrl:e.webUrl,applicationName:o.HostCapability[e.hostType],officeExtentionTarget:e.noTargetType||e.osfControl.getOsfControlType()===o.OsfControlTarget.TaskPane?a:e.osfControl.getOsfControlType(),clearCache:e.clearCache||i,supportedManifestVersions:{"1.0":r,1.1:r}};n._invokeProxyMethodAsync(e,"OEM_getEntitlementSummaryAsync",t,d)}else c<o.Constants.AuthenticatedConnectMaxTries?(c++,setTimeout((function(){e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.webUrl,l)}),500)):t({statusCode:o.ProxyCallStatusCode.ProxyNotReady,value:a,context:e})};e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.webUrl,l)},_invokeProxyMethodAsync:function(e,t,n,r){var i,c=[r.clientEndPoint?r.clientEndPoint._targetUrl:e.clientEndPoint._targetUrl,t];for(var l in r)("string"===(i=typeof r[l])||"number"===i||"boolean"===i)&&c.push(r[l]);var f=c.join("."),p=u,m={onCompleted:n,context:e,methodName:t},g=p[f];if(g)g.push(m);else{p[f]=[m];var h=e.clientEndPoint;r.clientEndPoint&&(h=r.clientEndPoint,delete r.clientEndPoint),e.referenceInUse&&e.referenceInUse.storeType===o.StoreType.OMEX&&(r.officeVersion=o.Constants.ThreePartsFileVersion),h.invoke(t,(function(e,t){var n=a,r=o.ProxyCallStatusCode.Failed;0===e&&t.status&&(n=t.result,r=o.ProxyCallStatusCode.Succeeded);var i=p[f];delete p[f];for(var c=i.length,l=0;l<c;l++){var u,m=i.shift();try{m.context&&m.context.osfControl&&(u=m.context.osfControl._appCorrelationId),t&&t.failureInfo&&s.RuntimeTelemetryHelper.LogProxyFailure(u,m.methodName,t.failureInfo),m.onCompleted({statusCode:r,value:n,context:m.context})}catch(e){var g="_invokeProxyMethodAsync failed.";d.WACUtils.logExceptionToBrowserConsole(g,e),s.RuntimeTelemetryHelper.LogExceptionTag(g,e,u,18420425)}}}),r)}},removeOmexCacheAsync:function(e,t){o.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:i},referenceInUse:{type:Object,mayBeNull:i},clientEndPoint:{type:Object,mayBeNull:i}},t);var n=e.referenceInUse,r={applicationName:e.hostType,assetID:n.id,officeExtentionTarget:e.osfControl.getOsfControlType(),clearEntitlement:e.clearEntitlement||i,clearToken:e.clearToken||i,clearAppState:e.clearAppState||i,clearManifest:e.clearManifest||i,appVersion:e.appVersion};e.anonymous?r.contentMarket=n.storeLocator:(r.assetContentMarket=e.osfControl._omexEntitlement.contentMarket,r.userContentMarket=n.storeLocator),this._invokeProxyMethodAsync(e,"OMEX_removeCacheAsync",t,r)},purgeManifest:function(r,a){var o=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:i},{name:t,type:String,mayBeNull:i}]);if(o)throw o;var s=f(r,a);typeof c[s]!=e&&delete c[s]},cacheManifestFromXml:function(e,r,a,s){var c=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:i},{name:t,type:String,mayBeNull:i},{name:"manifestXml",type:String,mayBeNull:i},{name:"uiLocale",type:String,mayBeNull:i}]);if(c)throw c;this.cacheManifest(e,r,new o.Manifest.Manifest(a,s))},cacheManifest:function(e,r,a){var o=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:i},{name:t,type:String,mayBeNull:i},{name:"manifest",type:Object,mayBeNull:i}]);if(o)throw o;var s=f(e,r);a._UILocale=a._UILocale||l,c[s]=a},hasManifest:function(a,o){var s=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:i},{name:t,type:String,mayBeNull:i}]);if(s)throw s;var l=f(a,o);return typeof c[l]!=e?r:i},hasManifestForControl:function(e){return o.OUtil.validateParamObject(e,{referenceInUse:{type:Object,mayBeNull:i}},a),this.hasManifest(e.referenceInUse.id,e.referenceInUse.version)},getCachedManifest:function(e,r){var a=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:i},{name:t,type:String,mayBeNull:i}]);if(a)throw a;var o=f(e,r);return c[o]},getSharedRuntimeManifestCacheKey:function(e,t){var r=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:i},{name:"sharedRuntimeId",type:String,mayBeNull:i}]);if(r)throw r;return e+t},versionLessThan:function(e,t){for(var n,r,a=e.split("."),o=t.split("."),s=Math.min(a.length,o.length),c=0;c<s;c++)try{if((n=parseFloat(a[c]))!=(r=parseFloat(o[c])))return n<r}catch(e){}if(a.length>=o.length)return i;s=o.length;var l=0;for(c=a.length;c<s;c++){try{r=parseFloat(o[c])}catch(e){r=0}l+=r}return l>0},_setUILocale:function(e){l=e}}}(),o.AddinIdInfo=function(e){var t=e.split("|");8!=t.length&&s.RuntimeTelemetryHelper.LogCommonMessageTag("OSF.AddinIdInfo.constructor: Unexpected format of the addinId",null,0);var n=t[0],r=t[1],a=t[2],i=t[3];return"2"!=n&&s.RuntimeTelemetryHelper.LogCommonMessageTag("OSF.AddinIdInfo.constructor: Unexpected format version: "+n+".",null,0),{getSolutionId:function(){return r},getSolutionVersion:function(){return a},getFormatVersion:function(){return n},needToRestoreManifest:function(){return i==o.StoreTypeEnum.Registry.toString()}}},function(e){!function(e){var t="invalidExtendedOverride",n="tokenError";e[e.Invalid=0]="Invalid",e[e[n]=1]=n,e[e[t]=2]=t}(e.OsfRuntimeErrorCode||(e.OsfRuntimeErrorCode={}));e.OsfRuntimeErrorCode;var t=function(e){function t(n,r){var a=this;e.call(a,r),Object.setPrototypeOf(a,t.prototype),a.code=n,a.name="OsfRuntimeError"}return c(t,e),t}(Error);e.OsfRuntimeError=t}(d||(d={})),o.ManifestSchemaVersion={"1.0":"1.0",1.1:"1.1"},o.ManifestNamespaces={"1.0":'xmlns="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"',1.1:'xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0" xmlns:ov="http://schemas.microsoft.com/office/taskpaneappversionoverrides" xmlns:c="http://schemas.microsoft.com/office/contentappversionoverrides"'},o.OsfNavigationMode={DefaultMode:0,CategoryMode:1,TrustPageMode:2,QueryResultMode:3},o.RequirementsChecker=function(e,t,n,r,a){var o=this;o.setCapabilities(e),o.setHosts(t),o.setRequirements(n),o.setSupportedControlTargets(r),o.setSupportedOmexAppVersions(a),o.setFilteringEnabled(!1)},o.RequirementsChecker.prototype={defaultMinMaxVersion:"1.1",isManifestSupported:function(e){if(!this.isFilteringEnabled())return!0;if(!e)return!1;switch(e.getManifestSchemaVersion()||o.ManifestSchemaVersion["1.0"]){case o.ManifestSchemaVersion["1.0"]:return this._checkManifest1_0(e);case o.ManifestSchemaVersion[1.1]:return this._checkManifest1_1(e);default:return!1}},isEntitlementFromOmexSupported:function(e){var t,n=this;if(!n.isFilteringEnabled())return!0;if(!e)return!1;switch(e.appSubType){case"1":t=o.OsfControlTarget.TaskPane;break;case"2":t=o.OsfControlTarget.InContent;break;case"3":t=o.OsfControlTarget.Contextual;break;case"4":t=o.OsfControlTarget.TaskPane;break;default:return!1}if(!n._checkControlTarget(t))return!1;if(!e.requirements&&!e.hosts)return!e.hasOwnProperty("appVersions")||void 0===e.appVersions||n._checkOmexAppVersions(e.appVersions);var r,a,i,s,c=new o.Manifest.Manifest((function(){}));return e.requirements&&(c._xmlProcessor=new o.XmlProcessor(e.requirements,o.ManifestNamespaces[1.1]),a=c._xmlProcessor.getDocumentElement()),r=c._parseRequirements(a),e.hosts&&(c._xmlProcessor=new o.XmlProcessor(e.hosts,o.ManifestNamespaces[1.1]),s=c._xmlProcessor.getDocumentElement()),i=c._parseHosts(s),n._checkHosts(i)&&n._checkSets(r.sets)&&n._checkMethods(r.methods)},isEntitlementFromCorpCatalogSupported:function(e){var t=this;if(!t.isFilteringEnabled())return!0;if(!e)return!1;var n=o.OfficeAppType[e.OEType];if(!t._checkControlTarget(n))return!1;var r,a,i,s,c,l=new o.Manifest.Manifest((function(){}));e.OfficeExtensionCapabilitiesXML&&(l._xmlProcessor=new o.XmlProcessor(e.OfficeExtensionCapabilitiesXML,o.ManifestNamespaces[1.1]),s=l._xmlProcessor.getDocumentElement(),a=(c=l._parseRequirements(s)).sets,i=c.methods,r=l._parseHosts(s));return t._checkHosts(r)&&t._checkSets(a)&&t._checkMethods(i)},setCapabilities:function(e){this._supportedCapabilities=this._scalarArrayToObject(e)},setHosts:function(e){this._supportedHosts=this._scalarArrayToObject(e)},setRequirements:function(e){var t=this;t._supportedSets=e&&t._arrayToSetsObject(e.sets)||{},t._supportedMethods=e&&t._scalarArrayToObject(e.methods)||{}},setSupportedControlTargets:function(e){this._supportedControlTargets=this._scalarArrayToObject(e)},setSupportedOmexAppVersions:function(e){this._supportedOmexAppVersions=e&&e.slice?e.slice(0):[]},setFilteringEnabled:function(e){this._filteringEnabled=!!e},isFilteringEnabled:function(){return this._filteringEnabled},_checkManifest1_0:function(e){return this._checkCapabilities(e.getCapabilities())},_checkCapabilities:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(this._supportedCapabilities[e[t]])return!0;return!1},_checkManifest1_1:function(e){var t=e.getRequirements()||{};return this._checkHosts(e.getHosts())&&this._checkSets(t.sets)&&this._checkMethods(t.methods)},_checkHosts:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(this._supportedHosts[e[t]])return!0;return!1},_checkSets:function(e){var t=this;if(!e||0===e.length)return!0;for(var n=0;n<e.length;n++){var r=e[n],a=t._supportedSets[r.name.toLowerCase()];if(!a)return!1;if(r.version&&(t._compareVersionStrings(a.minVersion||t.defaultMinMaxVersion,r.version)>0||t._compareVersionStrings(a.maxVersion||t.defaultMinMaxVersion,r.version)<0))return!1}return!0},_checkMethods:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(!this._supportedMethods[e[t]])return!1;return!0},_checkControlTarget:function(e){return null!=e&&this._supportedControlTargets[e]},_checkOmexAppVersions:function(e){if(!e)return!1;for(var t=0;t<this._supportedOmexAppVersions.length;t++)if(e.indexOf(this._supportedOmexAppVersions[t])>=0)return!0;return!1},_scalarArrayToObject:function(e){var t={};if(e&&e.length)for(var n=0;n<e.length;n++)null!=e[n]&&(t[e[n]]=!0);return t},_arrayToSetsObject:function(e){var t={};if(e&&e.length)for(var n=0;n<e.length;n++){var r=e[n];r&&null!=r.name&&(t[r.name.toLowerCase()]=r)}return t},_getSupportedSet:function(){for(var e={},t=Object.getOwnPropertyNames(this._supportedSets),n=0;n<t.length;n++){var r=this._supportedSets[t[n]];e[r.name.toLowerCase()]=r.maxVersion||this.defaultMinMaxVersion}return"undefined"!=typeof JSON?JSON.stringify(e):e},_getSupportedSetAsDmsCapabilities:function(){var e=this;return Object.getOwnPropertyNames(this._supportedSets).map((function(t){var n=e._supportedSets[t];return{Name:n.name.toLowerCase(),Version:n.maxVersion||e.defaultMinMaxVersion}}))},_compareVersionStrings:function(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length),r=0;r<n;r++){var a=parseInt(e[r],10)||0,o=parseInt(t[r],10)||0;if(a!==o)return a-o}return 0}},d.appSpecificCheckOrigin=function(e,t,n,r){try{return!(!(t&&t.source&&t.source.location&&t.source.location.pathname)||t.source.location.pathname.indexOf("projection.aspx")<0&&t.source.location.href!=window.location.href)&&r(e,n)}catch(e){return!1}},window.OfficeExt=d},15556:function(e,t){e.exports={am:"am-et",ar:"ar-sa",bg:"bg-bg","bn-in":"bn-in",ca:"ca-es",cs:"cs-cz",cy:"cy-gb",da:"da-dk",de:"de-de",el:"el-gr",en:"en-us",es:"es-es","es-mx":"es-mx",et:"et-ee",eu:"eu-es",fa:"fa-ir",fi:"fi-fi",fil:"fil-ph",fr:"fr-fr","fr-ca":"fr-ca",gl:"gl-es",gu:"gu-in",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",id:"id-id",is:"is-is",it:"it-it",ja:"ja-jp",kk:"kk-kz",kn:"kn-in",ko:"ko-kr","lo-la":"lo-la",lt:"lt-lt",lv:"lv-lv",ml:"ml-in",mr:"mr-in",ms:"ms-my",nl:"nl-nl","nn-no":"nn-no",no:"nb-no",pl:"pl-pl",pt:"pt-br","pt-pt":"pt-pt",ro:"ro-ro",ru:"ru-ru",sk:"sk-sk",sl:"sl-si",sr:"sr-latn-rs","sr-cyrl":"sr-cyrl-rs",sv:"sv-se",sw:"sw-ke",ta:"ta-in",te:"te-in",th:"th-th",tr:"tr-tr",uk:"uk-ua",ur:"ur-pk",vi:"vi-vn","zh-hans":"zh-cn","zh-hant":"zh-tw"}},15557:function(e,t,n){var r=n(15558),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},15558:function(e,t,n){t=e.exports=n(77)(!1);var r=n(1551)(n(15559));t.push([e.i,"._3mhPR1XTv-25tdKsbXrR95.ms-Panel{top:48px}._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-contentInner{top:40px;position:absolute;overflow:visible}._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-contentInner .ms-Panel-content{height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;min-height:400px;overflow:visible}html[dir] ._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-contentInner .ms-Panel-content{padding-bottom:0}html[dir=ltr] ._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-contentInner .ms-Panel-content,html[dir=rtl] ._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-contentInner .ms-Panel-content{padding-left:0;padding-right:0}._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-main{width:955px!important}html[dir=ltr] ._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-main{right:0!important;left:auto!important}html[dir=rtl] ._3mhPR1XTv-25tdKsbXrR95.ms-Panel .ms-Panel-main{left:0!important;right:auto!important}._2IDzPQHBsw5KT3CSo3T99y{display:-webkit-box;display:-ms-flexbox;display:flex;height:calc(100vh - 80px);width:960px;overflow:hidden}._3Xw5QeaxPNy626kZ_avN_b{position:absolute;top:6px;z-index:1000;cursor:pointer}html[dir] ._3Xw5QeaxPNy626kZ_avN_b{background:none}html[dir=ltr] ._3Xw5QeaxPNy626kZ_avN_b{left:901px}html[dir=rtl] ._3Xw5QeaxPNy626kZ_avN_b{right:901px}.fm3HSVWLq7Ufa6UsA9Ia3{height:100%;width:100%}html[dir] .fm3HSVWLq7Ufa6UsA9Ia3{background:url("+r+");background-repeat:no-repeat;background-position:50%;padding-top:17px}.KD3KxCCkMSejIJaTn41EQ{top:11px;z-index:1;position:absolute;cursor:pointer}html[dir=ltr] .KD3KxCCkMSejIJaTn41EQ{right:73px}html[dir=rtl] .KD3KxCCkMSejIJaTn41EQ{left:73px}._2HflJSd-IP_2TEdM2l5TZL{height:100%;width:100%}html[dir] ._2HflJSd-IP_2TEdM2l5TZL{background:url("+r+");background-repeat:no-repeat;background-position:50%}._1hahf_PvaHVm9Vp1wotjvF{top:-29px;z-index:1;position:absolute;cursor:pointer}html[dir=ltr] ._1hahf_PvaHVm9Vp1wotjvF{right:73px}html[dir=rtl] ._1hahf_PvaHVm9Vp1wotjvF{left:73px}",""]),t.locals={inClientStorePanelContainer:"_3mhPR1XTv-25tdKsbXrR95",container:"_2IDzPQHBsw5KT3CSo3T99y",closeButton:"_3Xw5QeaxPNy626kZ_avN_b",inClientStoreIFrameCenter:"fm3HSVWLq7Ufa6UsA9Ia3",FeedbackCommandBarCenter:"KD3KxCCkMSejIJaTn41EQ",inClientStoreIFrame:"_2HflJSd-IP_2TEdM2l5TZL",FeedbackCommandBar:"_1hahf_PvaHVm9Vp1wotjvF"}},15559:function(e,t,n){e.exports=n.p+"../resources/images/progress-e4ba8e5c7eb8b6080aadb62c29bbf737.gif"},15560:function(e,t,n){var r=n(15561),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},15561:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,"._37Fda6WfJOJiiR3vms2f3i{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;max-width:510px}html[dir] ._37Fda6WfJOJiiR3vms2f3i{margin:30px}",""]),t.locals={divContainer:"_37Fda6WfJOJiiR3vms2f3i"}},15562:function(e){e.exports=JSON.parse('{"b":"m9a","l":"n9a","c":"o9a","d":"p9a","e":"q9a","f":"r9a","g":"s9a","k":"t9a","h":"u9a","i":"v9a","j":"w9a","m":"x9a","n":"y9a","o":"z9a","a":"A9a"}')},15563:function(e,t,n){var r=n(15564),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},15564:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._35FjC3WF9MoHaA96_nmkPF{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary)}html[dir] ._35FjC3WF9MoHaA96_nmkPF{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._35FjC3WF9MoHaA96_nmkPF .ms-Callout-main{overflow:hidden!important}._3aJfygwIsiE-a6ugF_-9MK{height:32px!important;color:inherit}html[dir] ._3aJfygwIsiE-a6ugF_-9MK{background-color:transparent}._3aJfygwIsiE-a6ugF_-9MK .ms-Button{height:32px}._3aJfygwIsiE-a6ugF_-9MK .is-expanded .ms-CommandBarItem-overflow,.y5HTBMEC0Ik6LA3LsA_Vo .ms-Button-label{color:"[theme:themePrimary, default:#0078D4]"!important}._1C_kN6v-4J2Nrr5ST9WGLl{color:"[theme:neutralTertiaryAlt, default:#c8c6c4]"}html[dir] ._1C_kN6v-4J2Nrr5ST9WGLl{padding:8px}html[dir=ltr] ._1C_kN6v-4J2Nrr5ST9WGLl{float:left}html[dir=rtl] ._1C_kN6v-4J2Nrr5ST9WGLl{float:right}._36RJ_gVN4jNeoXS0xazZtY{height:16px;width:0}html[dir] ._36RJ_gVN4jNeoXS0xazZtY{padding:0 0 0 0;margin:8px 0;border-color:"[theme:neutralTertiaryAlt, default:#c8c6c4]"!important}html[dir=ltr] ._36RJ_gVN4jNeoXS0xazZtY{border-right-width:1px;border-right-style:solid;float:left}html[dir=rtl] ._36RJ_gVN4jNeoXS0xazZtY{border-left-width:1px;border-left-style:solid;float:right}._1RmIbFX5laaq5a6G3fX_ZE{width:570px;max-height:450px;min-height:32px}html[dir] ._1RmIbFX5laaq5a6G3fX_ZE{border-top-style:solid;border-top-width:1px;border-top-color:"[theme:neutralTertiaryAlt, default:#c8c6c4]"}',""]),t.locals={divContainer:"_35FjC3WF9MoHaA96_nmkPF",contextualBar:"_3aJfygwIsiE-a6ugF_-9MK",selected:"y5HTBMEC0Ik6LA3LsA_Vo",appIcon:"_1C_kN6v-4J2Nrr5ST9WGLl",divider:"_36RJ_gVN4jNeoXS0xazZtY",contextualAddinFrame:"_1RmIbFX5laaq5a6G3fX_ZE"}},15565:function(e){e.exports=JSON.parse('{"a":"L9a"}')},15566:function(e,t,n){var r=n(15567),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},15567:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,"._3kAp1tVu6pGq9lEQgNBLTj{display:none}._1c_RfP_c6TXoIGXiDm5VDY{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);max-width:none!important}html[dir] ._1c_RfP_c6TXoIGXiDm5VDY{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}",""]),t.locals={divContainer:"_3kAp1tVu6pGq9lEQgNBLTj",dialogContainer:"_1c_RfP_c6TXoIGXiDm5VDY"}},15568:function(e){e.exports=JSON.parse('{"a":"S9a"}')},15569:function(e){e.exports=JSON.parse('{"d":"N9a","e":"O9a","a":"P9a","b":"Q9a","c":"R9a"}')},15570:function(e,t,n){var r=n(15571),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},15571:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._35Uxh-lNCy7AIVxAkLQnf{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);height:100%;width:100%}html[dir] ._35Uxh-lNCy7AIVxAkLQnf{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._2fBIui4X7VzMUeMlgn0aAJ{position:relative;top:25%}html[dir] ._2fBIui4X7VzMUeMlgn0aAJ{text-align:center}._2O6_TNrH7pVtosTqq1iHX0{display:inline-block;font-size:80px;line-height:1;color:"[theme:themePrimary, default:#0078D4]"}html[dir] ._2O6_TNrH7pVtosTqq1iHX0{text-align:center}._1hrmefbBRxJBgKb0Fz4kj6{display:block;max-width:70%}html[dir] ._1hrmefbBRxJBgKb0Fz4kj6{margin:auto}.t085jF8UewCxzoVIxg3MF{font-size:17px;font-weight:300;color:"[theme:neutralPrimary, default:#323130]"}html[dir] .t085jF8UewCxzoVIxg3MF{padding-top:25px}._3CjShi0HyNf1-sMSa13b4o{font-size:12px;font-weight:400;color:"[theme:neutralSecondary, default:#605e5c]"}html[dir] ._3CjShi0HyNf1-sMSa13b4o{padding-top:10px}',""]),t.locals={errorContainer:"_35Uxh-lNCy7AIVxAkLQnf",errorContent:"_2fBIui4X7VzMUeMlgn0aAJ",errorIcon:"_2O6_TNrH7pVtosTqq1iHX0",errorTextCommon:"_1hrmefbBRxJBgKb0Fz4kj6",errorTextTitle:"t085jF8UewCxzoVIxg3MF",errorTextDescription:"_3CjShi0HyNf1-sMSa13b4o"}},15572:function(e){e.exports=JSON.parse('{"a":"M9a"}')},15573:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._2LyIY1IT_FLcj7nlu42I5I,._2LzxftK71oMfUs1YO4b6DN{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:70px}html[dir] ._2LyIY1IT_FLcj7nlu42I5I,html[dir] ._2LzxftK71oMfUs1YO4b6DN{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white);padding:0 22px;padding-top:10px}._2LzxftK71oMfUs1YO4b6DN{color:var(--white)}html[dir] ._2LzxftK71oMfUs1YO4b6DN{background:var(--neutralPrimary)}._2F5ZiV8NB3K3qoiCs8805O,.YfSEUR7JmTlDH39zyXugr{height:60px}html[dir] ._2F5ZiV8NB3K3qoiCs8805O,html[dir] .YfSEUR7JmTlDH39zyXugr{padding:0 32px;padding-top:10px}html[dir=ltr] ._2F5ZiV8NB3K3qoiCs8805O,html[dir=ltr] .YfSEUR7JmTlDH39zyXugr{padding-right:36px}html[dir=rtl] ._2F5ZiV8NB3K3qoiCs8805O,html[dir=rtl] .YfSEUR7JmTlDH39zyXugr{padding-left:36px}.YfSEUR7JmTlDH39zyXugr{color:var(--white)}html[dir] .YfSEUR7JmTlDH39zyXugr{background:var(--neutralPrimary)}._3qSJ1BvxuTyayDzbR1sZHx,._3rHEaK7tAMX_8d2jJbfQYm{position:static}html[dir=ltr] ._3qSJ1BvxuTyayDzbR1sZHx,html[dir=ltr] ._3rHEaK7tAMX_8d2jJbfQYm{margin-right:-10px;right:0}html[dir=rtl] ._3qSJ1BvxuTyayDzbR1sZHx,html[dir=rtl] ._3rHEaK7tAMX_8d2jJbfQYm{margin-left:-10px;left:0}._3rHEaK7tAMX_8d2jJbfQYm,._3rHEaK7tAMX_8d2jJbfQYm:hover{color:"[theme:neutralLight, default:#edebe9]"}html[dir] ._3rHEaK7tAMX_8d2jJbfQYm:hover{background:"[theme:neutralSecondary, default:#605e5c]"}._1TN9YpVgiQGSwrH412Bdgx{font-size:32px;color:"[theme:neutralSecondary, default:#605e5c]";width:32px;height:32px;min-width:32px}html[dir] ._1TN9YpVgiQGSwrH412Bdgx{border:0;padding:0}html[dir=ltr] ._1TN9YpVgiQGSwrH412Bdgx{float:left}html[dir=rtl] ._1TN9YpVgiQGSwrH412Bdgx{float:right}.B85HD7JJkDxOZ255cVew6{color:"[theme:neutralTertiary, default:#a19f9d]"}._1IsbQs17q9hMPNRjzbH3Y4,.RfDArGIwgd__1dHPieSxZ{font-size:21px;font-weight:100;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:"[theme:neutralPrimary, default:#323130]";overflow:hidden;white-space:nowrap;text-overflow:ellipsis}html[dir=ltr] ._1IsbQs17q9hMPNRjzbH3Y4,html[dir=ltr] .RfDArGIwgd__1dHPieSxZ{float:left;margin-left:8px}html[dir=rtl] ._1IsbQs17q9hMPNRjzbH3Y4,html[dir=rtl] .RfDArGIwgd__1dHPieSxZ{float:right;margin-right:8px}.RfDArGIwgd__1dHPieSxZ{color:"[theme:neutralLight, default:#edebe9]"}.aE5GasCrbxr6WFaLuRHdA{text-overflow:ellipsis;overflow:hidden}.aE5GasCrbxr6WFaLuRHdA,.D_t_F2iR_J5JIVwSvJzKO{white-space:nowrap}._12oaZ7uLdngB73OnarBfW-{color:"[theme:neutralPrimary, default:#323130]"}._3G5K82X99gDigafEdIG_F3,._3G5K82X99gDigafEdIG_F3:hover{color:"[theme:neutralLight, default:#edebe9]"}html[dir] ._3G5K82X99gDigafEdIG_F3:hover{background:"[theme:neutralSecondary, default:#605e5c]"}',""]),t.locals={addinPaneHeader:"_2LyIY1IT_FLcj7nlu42I5I",addinPaneHeaderDark:"_2LzxftK71oMfUs1YO4b6DN",addinPaneHeaderCalendar:"_2F5ZiV8NB3K3qoiCs8805O",addinPaneHeaderCalendarDark:"YfSEUR7JmTlDH39zyXugr",closeButton:"_3qSJ1BvxuTyayDzbR1sZHx",closeButtonDark:"_3rHEaK7tAMX_8d2jJbfQYm",addinPaneIcon:"_1TN9YpVgiQGSwrH412Bdgx",fallbackIcon:"B85HD7JJkDxOZ255cVew6",addinPaneLabelText:"_1IsbQs17q9hMPNRjzbH3Y4",addinPaneLabelTextDark:"RfDArGIwgd__1dHPieSxZ",ellipsis:"aE5GasCrbxr6WFaLuRHdA",rightButtons:"D_t_F2iR_J5JIVwSvJzKO",persistIcon:"_12oaZ7uLdngB73OnarBfW-",persistIconDark:"_3G5K82X99gDigafEdIG_F3"}},15574:function(e,t,n){var r=n(15575),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},15575:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,"._1k5ke6nDxpeUR8lrcSeiY5,._1bbHEH-SwdPurkguSSuYX6{height:100%;overflow-y:hidden}._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-content,._1bbHEH-SwdPurkguSSuYX6 .ms-Panel-content{height:calc(100vh - 50px);overflow-y:hidden}html[dir] ._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-content,html[dir] ._1bbHEH-SwdPurkguSSuYX6 .ms-Panel-content{padding:0}html[dir] ._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-commands,html[dir] ._1bbHEH-SwdPurkguSSuYX6 .ms-Panel-commands{margin-top:0}._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-main,._1bbHEH-SwdPurkguSSuYX6 .ms-Panel-main{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);top:48px;height:calc(100% - 48px);width:320px!important}html[dir] ._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-main,html[dir] ._1bbHEH-SwdPurkguSSuYX6 .ms-Panel-main{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}html[dir=ltr] ._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-main,html[dir=ltr] ._1bbHEH-SwdPurkguSSuYX6 .ms-Panel-main{left:calc(100vw - 322px)!important}html[dir=rtl] ._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-main,html[dir=rtl] ._1bbHEH-SwdPurkguSSuYX6 .ms-Panel-main{right:calc(100vw - 322px)!important}._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-contentInner,._1bbHEH-SwdPurkguSSuYX6 .ms-Panel-contentInner{height:100%}._1bbHEH-SwdPurkguSSuYX6 .ms-Panel-content{height:calc(100vh - 2px)}._1bbHEH-SwdPurkguSSuYX6 .ms-Panel-main{top:0;height:100%}.isShyHeaderMode._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-main,.isShyHeaderMode._1bbHEH-SwdPurkguSSuYX6 .ms-Panel-main{top:8px;height:calc(100% - 8px)}.isShyHeaderMode._1k5ke6nDxpeUR8lrcSeiY5 .ms-Panel-content,.isShyHeaderMode._1bbHEH-SwdPurkguSSuYX6 .ms-Panel-content{height:calc(100vh - 10px)}._8Iga8mKVcPGOaQygACFwN .ms-Panel-main{top:0;height:100%}",""]),t.locals={taskPane:"_1k5ke6nDxpeUR8lrcSeiY5",taskPaneInPopout:"_1bbHEH-SwdPurkguSSuYX6",taskPaneNoHeader:"_8Iga8mKVcPGOaQygACFwN"}},15576:function(e,t,n){var r=n(15577),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},15577:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,".C1qPgTlqf9Y7t0ml3EHcF{display:none}._1fUNAcJOHwVFh9BqSDLXu2{width:100%;height:calc(100% - 80px)}.G2EwK-c9YGqvxnB1GHcDM{height:calc(100% - 70px)}.P6cxIKyPIAjWQFeaZzdcd{display:block;top:0;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.P6cxIKyPIAjWQFeaZzdcd iframe{max-height:100%}.wdOcR00mWtKSYE12x1mhd{display:none}",""]),t.locals={divContainer:"C1qPgTlqf9Y7t0ml3EHcF",extensionContainer:"_1fUNAcJOHwVFh9BqSDLXu2",extensionContainerCalendar:"G2EwK-c9YGqvxnB1GHcDM",extensionHost:"P6cxIKyPIAjWQFeaZzdcd",hide:"wdOcR00mWtKSYE12x1mhd"}},15578:function(e,t,n){var r=n(15579),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},15579:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,".hILIH9i-q7hXQGEpldvA2{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);max-width:none}html[dir] .hILIH9i-q7hXQGEpldvA2{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._3wbeT-LKN3ClVrBC37qMHu{height:190px}._3PKPHkrVd4hnglpDBfYb3-{width:550px;height:400px}._3mgLsubAj-SyqGrLV6-bnx{display:none!important}",""]),t.locals={dialogContainer:"hILIH9i-q7hXQGEpldvA2",uiLessContainer:"_3wbeT-LKN3ClVrBC37qMHu",consentContainer:"_3PKPHkrVd4hnglpDBfYb3-",hiddenContainer:"_3mgLsubAj-SyqGrLV6-bnx"}},15580:function(e){e.exports=JSON.parse('{"b":"B9a","a":"C9a"}')},15581:function(e,t,n){var r=n(15582),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},15582:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,"._3YILU6DQcy9_FzoKf8XVYT{width:100%;height:100%}",""]),t.locals={uiLessContainer:"_3YILU6DQcy9_FzoKf8XVYT"}},15583:function(e,t,n){var r=n(15584),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},15584:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,".ms-ContextualMenu-icon ._1KiZKEg8-nD4NulHDjAhzX{position:relative;top:-8px}",""]),t.locals={fallbackIcon:"_1KiZKEg8-nD4NulHDjAhzX"}},15585:function(e){e.exports=JSON.parse('{"a":"T9a"}')},186:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,a=!1;function o(t){r--,delete e[t]}this.put=function(t,n,a,i){if(void 0!==a&&("number"!=typeof a||isNaN(a)||a<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==i&&"function"!=typeof i)throw new Error("Cache timeout callback must be a function");var s=e[t];s?clearTimeout(s.timeout):r++;var c={value:n,expire:a+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){o(t),i&&i(t,n)}.bind(this),a)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),a&&(t=0,n=0)},this.get=function(o){var i=e[o];if(void 0!==i){if(isNaN(i.expire)||i.expire>=Date.now())return a&&t++,i.value;a&&n++,r--,delete e[o]}else a&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){a=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),a=Date.now(),o=n&&n.skipDuplicates;for(var i in r)if(r.hasOwnProperty(i)){if(o)if(e[i])continue;var s=r[i],c=s.expire-a;if(c<=0){this.del(i);continue}c=c>0?c:void 0,this.put(i,s.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},1872:function(e,t,n){"use strict";var r=n(768),a=n(3),o=n(0),i=n(713),s=n(261),c=n(733),l=n(1934),u=n(511),d=n(470),f=n(438),p=n(263),m=n(1260),g=n(1254),h=Object(i.a)(),v=o.createElement(g.a,null).type,y="DialogContent",b=function(e){function t(t){var n=e.call(this,t)||this;return Object(d.a)(n),Object(f.a)(y,t,{titleId:"titleProps.id"}),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,r=t.className,i=t.closeButtonAriaLabel,s=t.onDismiss,l=t.subTextId,u=t.subText,d=t.titleProps,f=void 0===d?{}:d,g=t.titleId,v=t.title,y=t.type,b=t.styles,C=t.theme,A=t.draggableHeaderClassName,S=h(b,{theme:C,className:r,isLargeHeader:y===c.a.largeHeader,isClose:y===c.a.close,draggableHeaderClassName:A}),_=this._groupChildren();return u&&(e=o.createElement("p",{className:S.subText,id:l},u)),o.createElement("div",{className:S.content},o.createElement("div",{className:S.header},o.createElement("div",Object(a.__assign)({id:g,role:"heading","aria-level":1},f,{className:Object(p.a)(S.title,f.className)}),v),o.createElement("div",{className:S.topButton},this.props.topButtonsProps.map((function(e,t){return o.createElement(m.a,Object(a.__assign)({key:e.uniqueId||t},e))})),(y===c.a.close||n&&y!==c.a.largeHeader)&&o.createElement(m.a,{className:S.button,iconProps:{iconName:"Cancel"},ariaLabel:i,onClick:s,title:i}))),o.createElement("div",{className:S.inner},o.createElement("div",{className:S.innerContent},e,_.contents),_.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return o.Children.map(this.props.children,(function(t){"object"==typeof t&&null!==t&&t.type===v?e.footers.push(t):e.contents.push(t)})),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},t=Object(a.__decorate)([u.d],t)}(o.Component),C=n(7),A={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},S=Object(r.a)(b,(function(e){var t,n,r,a=e.className,o=e.theme,i=e.isLargeHeader,s=e.isClose,c=e.hidden,l=e.isMultiline,u=e.draggableHeaderClassName,d=o.palette,f=o.fonts,p=o.effects,m=o.semanticColors,g=Object(C.getGlobalClassNames)(A,o);return{content:[i&&[g.contentLgHeader,{borderTop:"4px solid "+d.themePrimary}],s&&g.close,{flexGrow:1,overflowY:"hidden"},a],subText:[g.subText,f.medium,{margin:"0 0 24px 0",color:m.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:C.FontWeights.regular}],header:[g.header,{position:"relative",width:"100%",boxSizing:"border-box"},s&&g.close,u&&[u,{cursor:"move"}]],button:[g.button,c&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:m.buttonText,fontSize:C.IconFontSizes.medium}}}],inner:[g.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: "+C.ScreenWidthMinSmall+"px) and (max-width: "+C.ScreenWidthMaxSmall+"px)"]={padding:"0 16px 16px"},t)}],innerContent:[g.content,{position:"relative",width:"100%"}],title:[g.title,f.xLarge,{color:m.bodyText,margin:"0",minHeight:f.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(n={},n["@media (min-width: "+C.ScreenWidthMinSmall+"px) and (max-width: "+C.ScreenWidthMaxSmall+"px)"]={padding:"16px 46px 16px 16px"},n)},i&&{color:m.menuHeader},l&&{fontSize:f.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(r={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:m.buttonText},".ms-Dialog-button:hover":{color:m.buttonTextHovered,borderRadius:p.roundedCorner2}},r["@media (min-width: "+C.ScreenWidthMinSmall+"px) and (max-width: "+C.ScreenWidthMaxSmall+"px)"]={padding:"15px 8px 0 0"},r)}]}}),void 0,{scope:"DialogContent"}),_=Object(i.a)(),O={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1},I={type:c.a.normal,className:"",topButtonsProps:[]},x=function(e){function t(t){var n=e.call(this,t)||this;return n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,r=e.modalProps,a=e.dialogContentProps,o=e.subText,i=r&&r.subtitleAriaId||t;return i||(i=(a&&a.subText||o)&&n._defaultSubTextId),i},n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,r=e.modalProps,a=e.dialogContentProps,o=e.title,i=r&&r.titleAriaId||t;return i||(i=(a&&a.title||o)&&n._defaultTitleTextId),i},n._id=Object(s.a)("Dialog"),n._defaultTitleTextId=n._id+"-title",n._defaultSubTextId=n._id+"-subText",n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t,n,r,i=this.props,s=i.className,c=i.containerClassName,u=i.contentClassName,d=i.elementToFocusOnDismiss,f=i.firstFocusableSelector,p=i.forceFocusInsideTrap,m=i.styles,g=i.hidden,h=i.ignoreExternalFocusing,v=i.isBlocking,y=i.isClickableOutsideFocusTrap,b=i.isDarkOverlay,C=i.isOpen,A=i.onDismiss,x=i.onDismissed,T=i.onLayerDidMount,E=i.responsiveMode,M=i.subText,P=i.theme,k=i.title,R=i.topButtonsProps,N=i.type,w=i.minWidth,D=i.maxWidth,U=i.modalProps,F=Object(a.__assign)({},U?U.layerProps:{onLayerDidMount:T});T&&!F.onLayerDidMount&&(F.onLayerDidMount=T),U&&U.dragOptions&&!U.dragOptions.dragHandleSelector?(n="ms-Dialog-draggable-header",r=Object(a.__assign)(Object(a.__assign)({},U.dragOptions),{dragHandleSelector:"."+n})):r=U&&U.dragOptions;var L=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},O),{className:s,containerClassName:c,isBlocking:v,isDarkOverlay:b,onDismissed:x}),U),{layerProps:F,dragOptions:r}),j=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({className:u,subText:M,title:k,topButtonsProps:R,type:N},I),this.props.dialogContentProps),{draggableHeaderClassName:n,titleProps:Object(a.__assign)({id:(null===(e=this.props.dialogContentProps)||void 0===e?void 0:e.titleId)||this._defaultTitleTextId},null===(t=this.props.dialogContentProps)||void 0===t?void 0:t.titleProps)}),B=_(m,{theme:P,className:L.className,containerClassName:L.containerClassName,hidden:g,dialogDefaultMinWidth:w,dialogDefaultMaxWidth:D});return o.createElement(l.a,Object(a.__assign)({elementToFocusOnDismiss:d,firstFocusableSelector:f,forceFocusInsideTrap:p,ignoreExternalFocusing:h,isClickableOutsideFocusTrap:y,onDismissed:L.onDismissed,responsiveMode:E},L,{isDarkOverlay:L.isDarkOverlay,isBlocking:L.isBlocking,isOpen:void 0!==C?C:!g,className:B.root,containerClassName:B.main,onDismiss:A||L.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),o.createElement(S,Object(a.__assign)({subTextId:this._defaultSubTextId,title:j.title,subText:j.subText,showCloseButton:L.isBlocking,topButtonsProps:j.topButtonsProps,type:j.type,onDismiss:A||j.onDismiss,className:j.className},j),this.props.children))},t.defaultProps={hidden:!0},t=Object(a.__decorate)([u.d],t)}(o.Component),T={root:"ms-Dialog"};n.d(t,"a",(function(){return E}));var E=Object(r.a)(x,(function(e){var t,n=e.className,r=e.containerClassName,a=e.dialogDefaultMinWidth,o=void 0===a?"288px":a,i=e.dialogDefaultMaxWidth,s=void 0===i?"340px":i,c=e.hidden,l=e.theme;return{root:[Object(C.getGlobalClassNames)(T,l).root,l.fonts.medium,n],main:[{width:o,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: "+C.ScreenWidthMinMedium+"px)"]={width:"auto",maxWidth:s,minWidth:o},t)},!c&&{display:"flex"},r]}}),void 0,{scope:"Dialog"});E.displayName="Dialog"},1986:function(e,t,n){"use strict";var r=n(1),a=n(2051),o=n(374),i=n(730),s=n(121),c=n(5),l="X-AnchorMailbox",u="Authorization",d="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";function p(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,p,m,g,h;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(n={},p=Object(o.k)(e)){if(p.accountState==o.b.AccessRevoked)return[2,null];if(p.accountState==o.b.AccountDeprovisioned||p.accountState==o.b.AccountNotFound)return Object(o.c)(p.accountState,p.accountProviderType),[2,null]}return t?(n[l]=t,n[f]=t):p&&(n[l]=p.anchorMailbox),p?(m=p.token,!(g=Object(i.g)(p.tokenExpiry))&&m?[3,2]:(Object(s.s)("getAndUpdateAccessToken",{tokenExpiry:Object(c.y)(p.tokenExpiry,Object(c.Rb)()),isTokenExpired_1:g,isTokenInvalid_2:!m},{isCore:!0}),[4,a.a.importAndExecute(p.accountId,e,m)])):[3,3];case 1:(m=r.sent())||(m=""),r.label=2;case 2:h=void 0,"Outlook"==p.accountProviderType?(h='MSAuth1.0 usertoken="'+m+'", type="MSACT"',n[d]=1..toString()):"Google"!=p.accountProviderType&&"ICloud"!=p.accountProviderType||(h="Bearer "+m,n[d]=2..toString()),n[u]=h,r.label=3;case 3:return[2,n]}}))}))}var m=n(1989),g=n(23);function h(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,a;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=Object(m.a)(),a=n,[4,v(e,t)];case 1:return a.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function v(e,t){var n;return Object(r.c)(this,void 0,void 0,(function(){var a,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return a=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,[4,p(e.mailboxInfo.userIdentity,y(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return o=r.sent(),Object(m.b)(a,o),[2,a]}}))}))}function y(e,t){var n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&g.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return y}))},1989:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach((function(n){return e.set(n,t[n])}))}function a(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},1991:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),a=Object(r.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},2030:function(e,t,n){"use strict";var r=n(1),a=n(1989);function o(e,t){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":t||e}}function i(e,t,n){t&&(e||n)&&Object(a.b)(t,o(e,n))}function s(e,t){var n,a=null!=t?t:{},o=(null===(n=a.headers)||void 0===n?void 0:n.set)?new Headers(a.headers):new Headers;return a.datapoint=a.datapoint||{},a.datapoint.mailbox=a.datapoint.mailbox||"Explicit",i(e,o),Object(r.a)(Object(r.a)({},a),{headers:o})}var c=n(374),l=n(1986),u=n(87),d=n(319);function f(e){return Object(r.c)(this,void 0,void 0,(function(){var t=this;return Object(r.f)(this,(function(n){return[2,Object(u.b)().then((function(n){return Object(r.c)(t,void 0,void 0,(function(){var t,a;return Object(r.f)(this,(function(r){switch(r.label){case 0:return e?Object(c.r)(e.userIdentity)?[4,Object(l.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return t=r.sent(),d(n,t),[3,3];case 2:"GroupMailbox"!=e.type&&"TeamsMailbox"!=e.type||(a=o(e.mailboxSmtpAddress),d(n,a)),r.label=3;case 3:return[2,n]}}))}))}))]}))}))}function p(){return Object(u.b)().then((function(e){return e.prefer='exchange.Behavior="CalendarInternal"',e}))}function m(e){return void 0===e&&(e=null),Object(c.r)(e)?p().then((function(t){return Object(l.a)(e).then((function(e){return Object.keys(e).forEach((function(n){return t[n]=e[n]})),t}))})):Promise.resolve({})}var g=n(65);function h(e,t,n,r){var a=new Headers;return n&&a.set("X-OWA-CANARY",Object(g.a)()),t&&a.set("X-OWA-ActionName",t),(e||r)&&(r?i(e,a,r):i(e,a)),a}n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return h}))},2051:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(31),a=n(1991);n.d(t,"b",(function(){return a.a}));var o=new r.c((function(){return n.e(1286).then(n.bind(null,2298))})),i=new r.a(o,(function(e){return e.getAndUpdateAccessToken}))},2078:function(e,t,n){"use strict";n.d(t,"a",(function(){return ReactEditor})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return c}));var r=n(31),a=new r.c((function(){return Promise.all([n.e(24),n.e(25),n.e(26),n.e(43),n.e(47),n.e(269),n.e(669)]).then(n.bind(null,3002))})),ReactEditor=Object(r.d)(a,(function(e){return e.ReactEditor})),o=new r.b(a,(function(e){return e.setTableHeaderRow})),i=new r.b(a,(function(e){return e.operateContent})),s=new r.b(a,(function(e){return e.focusToEditor}));function c(e){s.import().then((function(t){return t(e)}))}},2316:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),a=n(2431),o=function(e,t){return e||t};function i(e){var t=e||Object(a.a)();return Object(r.j)([],Object(r.g)(t.isShown.values())).reduce(o,!1)}},2431:function(e,t,n){"use strict";var r=n(14),a=n(2);t.a=Object(a.createStore)("appPaneUnderlayViewState",{isShown:new r.ObservableMap,shrinkable:new r.ObservableMap})},2444:function(e,t,n){"use strict";var r=n(0),a=r.createContext(window);t.a=a},2446:function(e,t,n){"use strict";var r=n(0),a=n(158),o=n.n(a),i=n(20),s=n(2086),c=n(2316),l=n(1),u=n(2431),d=function(e,t){return e||t};function f(e){var t=e||Object(u.a)();return Object(l.j)([],Object(l.g)(t.shrinkable.values())).reduce(d,!1)}var p=n(3012),m=n(378).bind(p),g=Object(i.a)((function(e){var t=e.underlay;return Object(c.a)(t)&&r.createElement("div",{className:m(p.underlay,{shrinkable:f(t)})})})),h=n(1713),v=n(132),y=n(622),b=n(2945);t.a=Object(i.a)((function(e){var t=e.renderHeader,n=e.children,a=e.renderSkipLinkPlaceholder,i=e.underlay;return Object(y.b)(),r.createElement(h.a,{className:b.appContainer,theme:Object(v.c)()},null==a?void 0:a(),null==t?void 0:t(),r.createElement("div",{className:o()(b.main,{isShyHeaderMode:Object(s.b)()})},n,r.createElement(g,{underlay:i})))}))},2748:function(e,t,n){"use strict";n(2813),n(2446);var r=n(2316);n.d(t,"a",(function(){return r.a}))},2780:function(e,t,n){"use strict";var r=n(57),a=n(711),o=n(24),i=n(210);function s(){var e=Object(o.i)("outlookSpaces-enabled"),t=Object(r.h)(),n=t.SessionSettings,s=void 0===n?{}:n,c=t.PolicySettings;if(!Object(i.a)("spacesEnabled"))return!1;switch(s.WebSessionType){case 0:var l=Object(o.i)("outlookSpaces-canEnableByPolicy")||Object(a.d)(),u=!!(c||{}).ProjectMocaEnabled;return e||l&&u;case 1:var d=Object(r.u)(),f=Object(o.i)("outlookSpaces-free-consumer-enabled");return e&&(d||f);case 2:return e&&Object(o.i)("outlookSpaces-gmail-enabled");default:return!1}}n.d(t,"a",(function(){return s}))},2813:function(e,t,n){"use strict";n(2828),n(2822),n(2824),n(2826)},2822:function(e,t,n){var r=n(2823),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},2823:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,"#OwaReferenceAttachments{display:none}",""]),t.locals={OwaReferenceAttachments:"OwaReferenceAttachments"}},2824:function(e,t,n){var r=n(2825),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},2825:function(e,t,n){(e.exports=n(77)(!1)).push([e.i,'[class*=" o365-Icon--"]:before,[class^=o365-Icon--]:before{font-family:office365icons;font-style:normal;font-weight:400;speak:none;display:inline-block;text-decoration:inherit;width:1em;font-variant:normal;line-height:1em}html[dir] [class*=" o365-Icon--"]:before,html[dir] [class^=o365-Icon--]:before{text-align:center;text-transform:none}html[dir=ltr] [class*=" o365-Icon--"]:before,html[dir=ltr] [class^=o365-Icon--]:before,html[dir=rtl] [class*=" o365-Icon--"]:before,html[dir=rtl] [class^=o365-Icon--]:before{margin-right:.2em;margin-left:.2em}',""])},2826:function(e,t,n){var r=n(2827),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},2827:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'.o365-Icon--direct:before{content:"\\e369"}.o365-Icon--emptyDocuments:before{content:"\\e324"}.o365-Icon--emptyDocumentSearch:before{content:"\\e404"}.o365-Icon--emptyDraft:before{content:"\\e325"}.o365-Icon--emptyError:before{content:"\\e347"}.o365-Icon--emptyFolder:before{content:"\\e348"}.o365-Icon--emptyMail:before{content:"\\e326"}.o365-Icon--emptySearch:before{content:"\\e327"}.o365-Icon--emptyTrash:before{content:"\\e328"}.o365-Icon--emptyTrophy:before{content:"\\e329"}.o365-Icon--emptyImage:before{content:"\\e406"}.o365-Icon--emptyImageSearch:before{content:"\\e405"}.o365-Icon--flag2:before{content:"\\e36b"}.o365-Icon--magnifyingGlass:before{content:"\\e36c"}.o365-Icon--unread:before{content:"\\e367"}.o365-Icon--folderClosed:before{content:"\\e394"}.o365-Icon--lock3:before{content:"\\e36f"}',""]),t.locals={"o365-Icon--direct":"o365-Icon--direct","o365-Icon--emptyDocuments":"o365-Icon--emptyDocuments","o365-Icon--emptyDocumentSearch":"o365-Icon--emptyDocumentSearch","o365-Icon--emptyDraft":"o365-Icon--emptyDraft","o365-Icon--emptyError":"o365-Icon--emptyError","o365-Icon--emptyFolder":"o365-Icon--emptyFolder","o365-Icon--emptyMail":"o365-Icon--emptyMail","o365-Icon--emptySearch":"o365-Icon--emptySearch","o365-Icon--emptyTrash":"o365-Icon--emptyTrash","o365-Icon--emptyTrophy":"o365-Icon--emptyTrophy","o365-Icon--emptyImage":"o365-Icon--emptyImage","o365-Icon--emptyImageSearch":"o365-Icon--emptyImageSearch","o365-Icon--flag2":"o365-Icon--flag2","o365-Icon--magnifyingGlass":"o365-Icon--magnifyingGlass","o365-Icon--unread":"o365-Icon--unread","o365-Icon--folderClosed":"o365-Icon--folderClosed","o365-Icon--lock3":"o365-Icon--lock3"}},2828:function(e,t,n){var r=n(2829),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},2829:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'a,body,button,div,form,html,img,label,span,textarea{margin:0;padding:0;border:0;font:inherit;vertical-align:baseline}body,button,div,form,html,img,label,span,textarea{color:inherit}table{font:inherit}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration,input[type=search]::-webkit-search-results-button,input[type=search]::-webkit-search-results-decoration{display:none}input::-webkit-input-placeholder{color:"[theme:neutralTertiary, default:#a19f9d]"}input::-moz-placeholder{color:"[theme:neutralTertiary, default:#a19f9d]"}input::-ms-input-placeholder{color:"[theme:neutralTertiary, default:#a19f9d]"}input::placeholder{color:"[theme:neutralTertiary, default:#a19f9d]"}.ms-Fabric--isFocusHidden :focus{outline:0}@media print{.ms-Callout-container,.noPrint,.noPrint *{display:none!important}}html{-ms-content-zooming:none}body{width:100%;min-width:1008px;height:100%;overflow-y:hidden;overflow-x:auto;position:absolute!important;font-family:"Segoe UI Web (West European)",Segoe UI,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,sans-serif;-webkit-scrollbar-base-color:"[theme:white, default:#ffffff]";-webkit-scrollbar-face-color:"[theme:neutralTertiaryAlt, default:#c8c6c4]";-webkit-scrollbar-shadow-color:"[theme:white, default:#ffffff]";-webkit-scrollbar-highlight-color:"[theme:white, default:#ffffff]";-webkit-scrollbar-3dlight-color:"[theme:white, default:#ffffff]";-webkit-scrollbar-darkshadow-color:"[theme:white, default:#ffffff]";-webkit-scrollbar-track-color:"[theme:white, default:#ffffff]";-webkit-scrollbar-arrow-color:"[theme:white, default:#ffffff]";-webkit-tap-highlight-color:transparent;-webkit-font-smoothing:antialiased}html[dir] body{background-color:"[theme:white, default:#ffffff]"}.customScrollBar,body{-ms-overflow-style:-ms-autohiding-scrollbar;scrollbar-color:"[theme:neutralTertiaryAlt, default:#c8c6c4]" transparent;scrollbar-width:thin}html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:increment,html[dir] body::-webkit-scrollbar-button:horizontal:increment{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEA+QLMGAIMGAIMGAIMBAUIGQoZU5HAwB+ZgDtGYq3fgAAAABJRU5ErkJggg==)}html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:increment:hover,html[dir] body::-webkit-scrollbar-button:horizontal:increment:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEA+QLMGAIMGAIMGAIMBAUIGQoZU5HAwB+ZgDtGYq3fgAAAABJRU5ErkJggg==)}html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:decrement,html[dir] body::-webkit-scrollbar-button:horizontal:decrement{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAiSURBVHgBY2BEAxQJMKAJMKAJMKAJMOATgIkQMBTBooZfAH56AO2yINTrAAAAAElFTkSuQmCC)}html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:decrement:hover,html[dir] body::-webkit-scrollbar-button:horizontal:decrement:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAiSURBVHgBY2BEAxQJMKAJMKAJMKAJMOATgIkQMBTBooZfAH56AO2yINTrAAAAAElFTkSuQmCC)}html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:increment,html[dir] body::-webkit-scrollbar-button:vertical:increment{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAfSURBVHgBY2BEA7QTYIAChAoYH6EFxkeYwQBj0MelAH3GAO2C9+AaAAAAAElFTkSuQmCC)}html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:increment:hover,html[dir] body::-webkit-scrollbar-button:vertical:increment:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAfSURBVHgBY2BEA7QTYIAChAoYH6EFxkeYwQBj0MelAH3GAO2C9+AaAAAAAElFTkSuQmCC)}html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:decrement,html[dir] body::-webkit-scrollbar-button:vertical:decrement{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEAzQVYIAzYHwGGAvOZ4AyIXyECH1cCgB/GgDtpWTgqAAAAABJRU5ErkJggg==)}html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:decrement:hover,html[dir] body::-webkit-scrollbar-button:vertical:decrement:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEAzQVYIAzYHwGGAvOZ4AyIXyECH1cCgB/GgDtpWTgqAAAAABJRU5ErkJggg==)}.customScrollBar::-webkit-scrollbar,body::-webkit-scrollbar{height:18px;width:18px}.customScrollBar::-webkit-scrollbar:disabled,body::-webkit-scrollbar:disabled{display:none}.customScrollBar::-webkit-scrollbar-button,.customScrollBar::-webkit-scrollbar-corner,body::-webkit-scrollbar-button,body::-webkit-scrollbar-corner{cursor:pointer}html[dir] .customScrollBar::-webkit-scrollbar-button,html[dir] .customScrollBar::-webkit-scrollbar-corner,html[dir] body::-webkit-scrollbar-button,html[dir] body::-webkit-scrollbar-corner{background:transparent}.customScrollBar::-webkit-scrollbar-button:horizontal:decrement,.customScrollBar::-webkit-scrollbar-button:horizontal:decrement:hover,.customScrollBar::-webkit-scrollbar-button:horizontal:increment,.customScrollBar::-webkit-scrollbar-button:horizontal:increment:hover,.customScrollBar::-webkit-scrollbar-button:vertical:decrement,.customScrollBar::-webkit-scrollbar-button:vertical:decrement:hover,.customScrollBar::-webkit-scrollbar-button:vertical:increment,.customScrollBar::-webkit-scrollbar-button:vertical:increment:hover,body::-webkit-scrollbar-button:horizontal:decrement,body::-webkit-scrollbar-button:horizontal:decrement:hover,body::-webkit-scrollbar-button:horizontal:increment,body::-webkit-scrollbar-button:horizontal:increment:hover,body::-webkit-scrollbar-button:vertical:decrement,body::-webkit-scrollbar-button:vertical:decrement:hover,body::-webkit-scrollbar-button:vertical:increment,body::-webkit-scrollbar-button:vertical:increment:hover{height:18px;width:18px}html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:decrement,html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:decrement:hover,html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:increment,html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:increment:hover,html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:decrement,html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:decrement:hover,html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:increment,html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:increment:hover,html[dir] body::-webkit-scrollbar-button:horizontal:decrement,html[dir] body::-webkit-scrollbar-button:horizontal:decrement:hover,html[dir] body::-webkit-scrollbar-button:horizontal:increment,html[dir] body::-webkit-scrollbar-button:horizontal:increment:hover,html[dir] body::-webkit-scrollbar-button:vertical:decrement,html[dir] body::-webkit-scrollbar-button:vertical:decrement:hover,html[dir] body::-webkit-scrollbar-button:vertical:increment,html[dir] body::-webkit-scrollbar-button:vertical:increment:hover{background-position:50%}html[dir] .customScrollBar::-webkit-scrollbar-track,html[dir] body::-webkit-scrollbar-track{background:transparent}html[dir] .customScrollBar::-webkit-scrollbar-thumb,html[dir] .customScrollBar::-webkit-scrollbar-thumb:hover,html[dir] body::-webkit-scrollbar-thumb,html[dir] body::-webkit-scrollbar-thumb:hover{border-radius:9px;border:solid 6px transparent;background-clip:content-box}html[dir] .customScrollBar::-webkit-scrollbar-thumb,html[dir] body::-webkit-scrollbar-thumb{background-color:"[theme:neutralTertiaryAlt, default:#c8c6c4]"}html[dir] .customScrollBar::-webkit-scrollbar-thumb:hover,html[dir] body::-webkit-scrollbar-thumb:hover{background-color:#98a3a6}.customScrollBar::-webkit-scrollbar-thumb:vertical,body::-webkit-scrollbar-thumb:vertical{min-height:50px}.customScrollBar::-webkit-scrollbar-thumb:horizontal,body::-webkit-scrollbar-thumb:horizontal{min-width:50px}#app{height:100%;width:100%;overflow:hidden}.displayNone{display:none!important}.visibilityHidden{visibility:hidden}html[dir] .backgroundColorNeutralLight{background-color:"[theme:neutralLight, default:#edebe9]"}html[dir=ltr] .personaMarginThreeColumn,html[dir=ltr] .personaMarginThreeColumnCondensedView{padding:0 12px 0 8px}html[dir=rtl] .personaMarginThreeColumn,html[dir=rtl] .personaMarginThreeColumnCondensedView{padding:0 8px 0 12px}html[dir] .personaMarginThreeColumn{padding-top:15px}.screenReaderOnly{clip:rect(0 0 0 0);-webkit-clip-path:inset(100%);clip-path:inset(100%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.disableTextSelection{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.allowTextSelection{-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;cursor:auto}.fadein200-appear{opacity:.01}.fadein200-appear.fadein200-appear-active{opacity:1}html[dir] .fadein200-appear.fadein200-appear-active{-webkit-transition:opacity .2s ease-in;transition:opacity .2s ease-in}html[dir=rtl] .flipForRtl{-webkit-transform:scaleX(-1);transform:scaleX(-1)}@font-face{font-family:EmojiFont;src:local("Apple Color Emoji"),local("Segoe UI Emoji"),local("NotoColorEmoji"),local("Android Emoji"),local("Segoe UI Symbol"),local("EmojiSymbols");unicode-range:U+200d,U+203c,U+2049,U+2122,U+2139,U+2194-2199,U+21a9-21aa,U+231a-231b,U+2328,U+23cf,U+23e9-23f3,U+23f8-23fa,U+24c2,U+25aa-25ab,U+25b6,U+25c0,U+25fb-25fe,U+2600-2604,U+260e,U+2611,U+2614-2615,U+2618,U+261d,U+2620,U+2622-2623,U+2626,U+262a,U+262e-262f,U+2638-263a,U+2640,U+2642,U+2648-2653,U+2660,U+2663,U+2665-2666,U+2668,U+267b,U+267f,U+2692-2697,U+2699,U+269b-269c,U+26a0-26a1,U+26aa-26ab,U+26b0-26b1,U+26bd-26be,U+26c4-26c5,U+26c8,U+26ce,U+26cf,U+26d1,U+26d3-26d4,U+26e9-26ea,U+26f0-26f5,U+26f7-26fa,U+26fd,U+2702,U+2705,U+2708-2709,U+270a-270b,U+270c-270d,U+270f,U+2712,U+2714,U+2716,U+271d,U+2721,U+2728,U+2733-2734,U+2744,U+2747,U+274c,U+274e,U+2753-2755,U+2757,U+2763-2764,U+2795-2797,U+27a1,U+27b0,U+27bf,U+2934-2935,U+2b05-2b07,U+2b1b-2b1c,U+2b50,U+2b55,U+3030,U+303d,U+3297,U+3299,U+fe0f,U+1f000-1f9ff}@font-face{font-family:EmojiFont;src:local("Apple Color Emoji"),local("Segoe UI Emoji"),local("NotoColorEmoji"),local("Android Emoji"),local("Segoe UI Symbol"),local("EmojiSymbols");unicode-range:U+200d,U+203c,U+2049,U+2122,U+2139,U+2194-2199,U+21a9-21aa,U+231a-231b,U+2328,U+23cf,U+23e9-23f3,U+23f8-23fa,U+24c2,U+25aa-25ab,U+25b6,U+25c0,U+25fb-25fe,U+2600-2604,U+260e,U+2611,U+2614-2615,U+2618,U+261d,U+2620,U+2622-2623,U+2626,U+262a,U+262e-262f,U+2638-263a,U+2640,U+2642,U+2648-2653,U+2660,U+2663,U+2665-2666,U+2668,U+267b,U+267f,U+2692-2697,U+2699,U+269b-269c,U+26a0-26a1,U+26aa-26ab,U+26b0-26b1,U+26bd-26be,U+26c4-26c5,U+26c8,U+26ce,U+26cf,U+26d1,U+26d3-26d4,U+26e9-26ea,U+26f0-26f5,U+26f7-26fa,U+26fd,U+2702,U+2705,U+2708-2709,U+270a-270b,U+270c-270d,U+270f,U+2712,U+2714,U+2716,U+271d,U+2721,U+2728,U+2733-2734,U+2744,U+2747,U+274c,U+274e,U+2753-2755,U+2757,U+2763-2764,U+2795-2797,U+27a1,U+27b0,U+27bf,U+2934-2935,U+2b05-2b07,U+2b1b-2b1c,U+2b50,U+2b55,U+3030,U+303d,U+3297,U+3299,U+fe0f,U+1f000-1f9ff;font-weight:600}html[dir] mark{background-color:#fff100}',""]),t.locals={"ms-Fabric--isFocusHidden":"ms-Fabric--isFocusHidden","ms-Callout-container":"ms-Callout-container",noPrint:"noPrint",customScrollBar:"customScrollBar",app:"app",displayNone:"displayNone",visibilityHidden:"visibilityHidden",backgroundColorNeutralLight:"backgroundColorNeutralLight",personaMarginThreeColumn:"personaMarginThreeColumn",personaMarginThreeColumnCondensedView:"personaMarginThreeColumnCondensedView",screenReaderOnly:"screenReaderOnly",disableTextSelection:"disableTextSelection",allowTextSelection:"allowTextSelection","fadein200-appear":"fadein200-appear","fadein200-appear-active":"fadein200-appear-active",flipForRtl:"flipForRtl"}},3012:function(e,t,n){var r=n(3013),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},3013:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,"._3XEE4Rit1S7G0CuMrFPO6s{width:320px;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}@media only screen and (max-width:1400px){._2zEFIJ-JjYEByJZ4t5P6Yq._3XEE4Rit1S7G0CuMrFPO6s{width:calc(100vw - 1080px);min-width:0}}",""]),t.locals={underlay:"_3XEE4Rit1S7G0CuMrFPO6s",shrinkable:"_2zEFIJ-JjYEByJZ4t5P6Yq"}},3076:function(e){e.exports=JSON.parse('{"a":"gJa","c":"hJa","e":"iJa","b":"jJa","d":"kJa"}')},3158:function(e){e.exports=JSON.parse('{"a":"fJa"}')},326:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r,a=n(1);function o(e){r=e}function i(){var e,t;return Object(a.c)(this,void 0,void 0,(function(){var n,o;return Object(a.f)(this,(function(a){switch(a.label){case 0:return(o=r)?[4,r()]:[3,2];case 1:o=a.sent(),a.label=2;case 2:if((n=o)&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},3414:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19),a=n(197),o=n(57);function i(){return Object(a.a)()?Object(o.u)():Object(r.a)().SegmentationSettings.Irm}},3415:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return y}));var r=n(287),a=n(132),o="attach.svg",i="attachDark.svg",s="inlineimage.svg",c="inlineimageDark.svg",l="emoji.svg",u="fluid.svg",d="showribbon.svg",f="showribbonDark.svg",p="dictate.svg",m="dictationLanguage.svg",g="spelling.svg";function h(e){var t,n,r=!1;switch(e){case"AddAttachment":t=b(Object(a.e)()?i:o),n=b(o),r=!0;break;case"AddInlineImage":t=b(Object(a.e)()?c:s),n=b(s),r=!0;break;case"AddEmoji":t=b(l),r=!0;break;case"ToggleDarkCompose":t="Sunny";break;case"FluidHeroButton":t=b(u),r=!0;break;case"QuickUse":t="ClipboardList";break;case"ToggleDictation":t=b(p),r=!0;break;case"SetDictationLanguage":t=b(m),r=!0;break;case"ToggleRibbon":t=b(Object(a.e)()?f:d),n=b(d),r=!0;break;case"SensitivityMenu":t="MarkAsProtected";break;case"ProtectMessage":t="Encryption";break;case"SaveDraft":t="Save";break;case"InsertSignature":t="InsertSignatureLine";break;case"ShowFrom":t="ArrangeByFrom";break;case"SetImportance":t="Important";break;case"ShowMessageOptions":t="MailOptions";break;case"SwitchBodyType":t="PlainText";break;case"AccChecker":t="AccessibiltyChecker";break;case"ProofingOptions":t=b(g),r=!0;break;case"CustomizeActions":t="Settings";break;default:t=""}return{iconName:t,fallbackIconName:n||t,isImage:r}}function v(e){var t;switch(e){case"-":t="-";break;case"Reply":t="Reply";break;case"ReplyAll":t="ReplyAll";break;case"Forward":t="Forward";break;case"ReplyByMeeting":t="Calendar";break;case"ReportAbuse":t="ReportHacked";break;case"Delete":t="Delete";break;case"MarkReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"AssignPolicy":t="Assign";break;case"AddToSafeSenders":t="AddFriend";break;case"MarkJunkNotJunk":t="MailAlert";break;case"MarkAsPhishing":t="Phishing";break;case"Block":t="BlockContact";break;case"CreateRule":t="CreateMailRule";break;case"Print":t="Print";break;case"Translate":t="LocaleLanguage";break;case"ShowInImmersiveReader":t="ReadOutLoud";break;case"ViewMessageSource":t="OpenSource";break;case"Popout":t="OpenInNewWindow";break;case"LikeUnlike":t="Like";break;case"SetReaction":t="Emoji2";break;case"ToggleDarkMode":t="Sunny";break;case"ReplyByIM":case"ReplyAllByIM":t="ChatInviteFriend";break;case"ToggleAmp":t="LightningBolt";break;case"AddToProjectSpace":t="NotePinned";break;case"CustomizeActions":t="Settings";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}function y(e){var t;switch(e){case"-":t="-";break;case"Delete":t="Delete";break;case"Archive":t="Archive";break;case"PinUnpin":t="Pinned";break;case"ReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"Move":t="FabricFolder";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}function b(e){return Object(r.a)("surfaceActions/"+e)}},3431:function(e,t,n){"use strict";var r=n(2078),a="_ShowEditorSettingsSource";function o(e,t){return function(){r.c.import().then((function(n){return n(e,(function(e){return e.triggerContentChangedEvent(a,t),null}))}))}}var i=n(24),s=n(102);function c(){return Object(s.c)()||Object(s.d)()||Object(i.i)("mc-officeEditorBXFirefoxSafari")&&(Object(s.f)()||Object(s.h)())}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}))},3449:function(e){e.exports=JSON.parse('{"a":"xJa"}')},3513:function(e,t,n){"use strict";var r=n(31),a=n(4914);function o(e){return a.a.addinOptionSurfaceItems[e]}var i=n(6),s=n(4109),c=n(4624),l=n(3669),u=n(3805),d=n(4908),f=n(4710),p=n(3670),m=n(2958),g=n(3449),h=n(4915),v=n(4715),y=n(4909),b=n(4916),C=n(4917),A=n(3304),S=n(4918),_=n(4919),O=n(4305),I=n(3244),x=n(3243),T=n(4054),E=n(3076),M=n(3158),P=n(4053),k=n(4467),R=n(4716),N=n(4910),w=n(4711),D=n(4911),U=n(4712),F=n(4205),L=n(4912),j=n(4713),B=n(197),H=n(5192);function V(e){switch(e){case"AddAttachment":case"AddClassicAttachment":return Object(i.b)(d.a);case"InsertLink":return Object(i.b)(d.b);case"AddInlineImage":return Object(i.b)(v.a);case"AddEmoji":return Object(i.b)(H.d);case"QuickUse":return Object(i.b)(H.q);case"ToggleRibbon":return Object(i.b)(h.a);case"SaveDraft":return Object(i.b)(N.a);case"InsertSignature":return Object(i.b)(y.a);case"ShowFrom":return Object(i.b)(U.a);case"SetImportance":return Object(i.b)(D.a);case"ShowMessageOptions":return Object(i.b)(L.a);case"SwitchBodyType":return Object(i.b)(j.a);case"SensitivityMenu":return Object(i.b)(w.a);case"ProtectMessage":return Object(i.b)(f.a);case"AccChecker":return Object(i.b)(s.a);case"ToggleDarkCompose":return Object(i.b)(H.x);case"ToggleDictation":return Object(i.b)(H.y);case"SetDictationLanguage":return Object(i.b)(H.u);case"ProofingOptions":return Object(i.b)(H.p);case"FluidHeroButton":return Object(i.b)(H.b);case"CustomizeActions":return Object(i.b)(H.c);default:return""}}function W(e){switch(e){case"LikeUnlike":return Object(i.b)(H.g);case"SetReaction":return Object(i.b)(H.v);case"Reply":return Object(i.b)(I.a);case"ReplyAll":return Object(i.b)(x.a);case"Forward":return Object(i.b)(A.a);case"ReplyByMeeting":return Object(i.b)(H.i);case"ReportAbuse":return Object(i.b)(R.a);case"Popout":return Object(i.b)(k.a);case"Delete":return Object(i.b)(H.f);case"MarkReadUnread":return Object(i.b)(E.a);case"FlagUnflag":return Object(i.b)(C.a);case"AssignPolicy":return Object(i.b)(u.a);case"AddToSafeSenders":return Object(i.b)(H.e);case"MarkJunkNotJunk":return Object(i.b)(_.a);case"MarkAsPhishing":return Object(i.b)(H.h);case"Block":return Object(i.c)(Object(i.b)(b.a),"");case"CreateRule":return Object(i.b)(p.a);case"Print":return Object(i.b)(O.a);case"Translate":return Object(i.b)(T.a);case"ShowInImmersiveReader":return Object(i.b)(F.a);case"ViewMessageSource":return Object(B.a)()?Object(i.b)(H.k):Object(i.b)(H.j);case"ToggleDarkMode":return Object(i.b)(S.a);case"ReplyByIM":return Object(i.b)(H.t);case"ReplyAllByIM":return Object(i.b)(H.s);case"ToggleAmp":return Object(i.b)(H.w);case"AddToProjectSpace":return Object(i.b)(c.a);case"OtherReplyActions":return Object(i.b)(H.o);case"MessageSafety":return Object(i.b)(H.l);case"View":return Object(i.b)(H.z);case"CustomizeActions":return Object(i.b)(H.c);case"AdvancedActions":return Object(i.b)(H.a);case"Addins":return Object(i.b)(H.n);default:return""}}function G(e){switch(e){case"None":return Object(i.b)(H.m);case"Delete":return Object(i.b)(m.a);case"Archive":return Object(i.b)(l.a);case"PinUnpin":return Object(i.b)(P.a);case"ReadUnread":return Object(i.b)(H.r);case"FlagUnflag":return Object(i.b)(g.a);case"Move":return Object(i.b)(M.a);default:return""}}var X=n(3415),q=n(3431),z=n(4913),K=n(3414),J=n(24),Q=n(2091),Y=n(2780),Z=n(1080),$=n(19),ee=n(132),te=n(102);function ne(){var e=[{key:"Reply",hideInGroup:!0,hideInSxS:!0},{key:"ReplyAll",hideInGroup:!1,hideInSxS:!0},{key:"Forward",hideInGroup:!1,hideInSxS:!0}];return e.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"ReplyByMeeting",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"Delete",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"MarkReadUnread",hideInGroup:!1,hideInSxS:!0},{key:"FlagUnflag",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(J.i)("fwk-skypeBusinessV2")&&e.push({key:"ReplyByIM",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAllByIM",hideInGroup:!0,hideInSxS:!1},{key:"-",hideInGroup:!0,hideInSxS:!1}),Object(Y.a)()&&e.push({key:"AddToProjectSpace",hideInGroup:!1,hideInSxS:!1},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object($.a)().SessionSettings.IsShadowMailbox||(e.push({key:"AddToSafeSenders",hideInGroup:!0,hideInSxS:!0},{key:"MarkJunkNotJunk",hideInGroup:!0,hideInSxS:!0},{key:"MarkAsPhishing",hideInGroup:!0,hideInSxS:!0},{key:"Block",hideInGroup:!0,hideInSxS:!0}),Object(J.i)("tri-reportAbuse")&&e.push({key:"ReportAbuse",hideInGroup:!Object(B.a)(),hideInSxS:!0}),e.push({key:"-",hideInGroup:!1,hideInSxS:!1})),Object(B.a)()||e.push({key:"AssignPolicy",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object($.a)().SessionSettings.IsShadowMailbox||e.push({key:"CreateRule",hideInGroup:!0,hideInSxS:!0}),e.push({key:"Print",hideInGroup:!1,hideInSxS:!1}),Object(J.i)("rp-inlineTranslation")&&Object(J.i)("rp-inlineTranslationManual")&&e.push({key:"Translate",hideInGroup:!0,hideInSxS:!0}),Object(ee.e)()&&e.push({key:"ToggleDarkMode",hideInGroup:!1,hideInSxS:!1}),Object(J.i)("rp-immersiveReader")&&e.push({key:"ShowInImmersiveReader",hideInGroup:!1,hideInSxS:!0}),e.push({key:"ViewMessageSource",hideInGroup:!1,hideInSxS:!0}),e.push({key:"Popout",hideInGroup:!1,hideInSxS:!0}),Object(J.i)("rp-reactions")||Object(B.a)()||e.push({key:"LikeUnlike",hideInGroup:!1,hideInSxS:!0}),Object(J.i)("rp-reactions")&&e.push({key:"SetReaction",hideInGroup:!1,hideInSxS:!0,hideInMailSurfaceSettings:!0}),Object(J.i)("rp-amp")&&Object(B.a)()&&e.push({key:"ToggleAmp",hideInGroup:!1,hideInSxS:!0}),e.push({key:"OtherReplyActions",hideInMailSurfaceSettings:!0},{key:"MessageSafety",hideInMailSurfaceSettings:!0},{key:"View",hideInMailSurfaceSettings:!0},{key:"CustomizeActions",hideInMailSurfaceSettings:!0},{key:"AdvancedActions",hideInMailSurfaceSettings:!0},{key:"Addins",hideInMailSurfaceSettings:!0}),e}function re(){var e=[];return e.push({key:"AddAttachment",hideInGroup:!1}),e.push({key:"AddInlineImage",hideInGroup:!1}),Object(Q.d)(1)&&e.push({key:"FluidHeroButton",hideInGroup:!1}),e.push({key:"AddEmoji",hideInGroup:!1}),Object(q.a)()&&e.push({key:"ProofingOptions",hideInGroup:!1}),(Object(te.e)()||Object(te.f)()||Object(te.c)())&&Object(J.i)("cmp-dictation")&&e.push({key:"ToggleDictation",hideInGroup:!1}),e=e.concat([{key:"ToggleRibbon",hideInGroup:!1},{key:"SaveDraft",hideInGroup:!1},{key:"InsertSignature",hideInGroup:!1},{key:"ShowFrom",hideInGroup:!1},{key:"SetImportance",hideInGroup:!1},{key:"SwitchBodyType",hideInGroup:!1},{key:"AccChecker",hideInGroup:!1}]),Object(J.i)("cmp-clp")&&!Object(B.a)()&&e.push({key:"SensitivityMenu",hideInGroup:!1}),Object(K.a)()&&e.push({key:"ProtectMessage",hideInGroup:!1}),Object(z.a)()&&e.push({key:"ShowMessageOptions",hideInGroup:!1}),e.push({key:"CustomizeActions",hideInGroup:!1}),e}function ae(e){return"Reply"==e||"ReplyAll"==e||"Forward"==e}function oe(e){return-1!==Object(Z.f)(Z.c.SurfaceActions).readSurfaceActions.indexOf(e)}function ie(e,t){return oe(e)||!(!Object(J.i)("rp-csaPinnedLikes")||Object(J.i)("rp-reactions")||"LikeUnlike"!==e||!t.LikeCount)||!("ToggleDarkMode"!==e||!Object(ee.e)())||!("ToggleAmp"!==e||!Object(J.i)("rp-amp")||!Object(B.a)())||!("SetReaction"!==e||!Object(J.i)("rp-reactions"))}var se=n(121);function ce(e,t,n,r){var a;r?a=r:(a="Pinned",(null==n?void 0:n.renderedInOverflow)&&(a=n.isPinned?"Overflow":"NotPinned")),Object(se.s)(e?"CSACountComposeUserAction":"CSACountReadUserAction",[t,a])}function le(e){var t,n;null===(n=null===(t=e.subMenuProps)||void 0===t?void 0:t.items)||void 0===n||n.forEach((function(e){e.renderedInOverflow=!0}))}function ue(e){var t,n;null===(n=null===(t=e.subMenuProps)||void 0===t?void 0:t.items)||void 0===n||n.forEach((function(e){e.renderedInOverflow=!1}))}n.d(t,"k",(function(){return fe})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return V})),n.d(t,"g",(function(){return W})),n.d(t,"f",(function(){return G})),n.d(t,"a",(function(){return"-"})),n.d(t,"d",(function(){return X.a})),n.d(t,"h",(function(){return X.c})),n.d(t,"e",(function(){return re})),n.d(t,"i",(function(){return ne})),n.d(t,"p",(function(){return ae})),n.d(t,"o",(function(){return ie})),n.d(t,"j",(function(){return oe})),n.d(t,"l",(function(){return ce})),n.d(t,"n",(function(){return le})),n.d(t,"m",(function(){return ue}));var de=new r.c((function(){return n.e(1039).then(n.bind(null,18621))})),fe=new r.a(de,(function(e){return e.setAddinOptionSurfaceItems}))},3563:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(31),a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(6),n.e(640)]).then(n.bind(null,5379))})),o=new r.a(a,(function(e){return e.mountAndShowFlexPane})),i=new r.a(a,(function(e){return e.hideFlexPane}))},3668:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"GetClientAccessTokenRequest:#Exchange"},e)}},3669:function(e){e.exports=JSON.parse('{"a":"EJa"}')},3670:function(e){e.exports=JSON.parse('{"a":"yJa"}')},3785:function(e,t,n){"use strict";var r=n(33),a=n(1);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.a)({__type:"GetClientAccessTokenJsonRequest:#Exchange"},n)),Object(r.a)("GetClientAccessToken",e,t)}n.d(t,"a",(function(){return o}))},3805:function(e){e.exports=JSON.parse('{"a":"DJa"}')},4008:function(e,t,n){"use strict";var r=n(4),a=n(19);n(15555);var o=n(15556);OSF.getLocalizedStringsFilePath=function(){var e=Object(r.C)()+"resources/locale/osfruntime/",t=Object(a.a)().SessionSettings?Object(a.a)().SessionSettings.UserLanguage:"en";return e+(o[t]||"en-us")+"/jscript/"},OSF.getManifestHostType=function(){},OSF.AppTelemetry={get enableTelemetry(){return!0}}},4020:function(e,t,n){"use strict";var r,a,o=n(1),i=32,s=126;function c(e){var t,n;if(!e)return!1;try{for(var r=Object(o.k)(e),a=r.next();!a.done;a=r.next()){var c=a.value;if(null==c||0===c.trim().length)return!1;for(var l=c.length;l--;)if(c.charCodeAt(l)>s||c.charCodeAt(l)<i)return!1}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0}function l(e){return!!e&&c(Object.keys(e))}!function(e){e[e.Read=1]="Read",e[e.Create=2]="Create",e[e.DeleteOwn=4]="DeleteOwn",e[e.DeleteAll=8]="DeleteAll",e[e.EditOwn=16]="EditOwn",e[e.EditAll=32]="EditAll"}(r||(r={})),function(e){e.Base64="base64",e.Eml="eml",e.Url="url",e.Ical="iCalendar"}(a||(a={}));var u=n(3482),d=(n(3483),n(3331)),f=n(3481),p=function(e){var t={locationIdentifier:{}};return t.displayName=e.DisplayName,e.PostalAddress&&"Resource"===e.PostalAddress.LocationSource?(t.emailAddress=e.PostalAddress.LocationUri,t.locationIdentifier.id=t.emailAddress,t.locationIdentifier.type=u.a.Room):(t.emailAddress="",t.locationIdentifier.id=t.displayName,t.locationIdentifier.type=u.a.Custom),t};function m(e){var t,n;if(!e||e.length<=0)return!1;try{for(var r=Object(o.k)(e),a=r.next();!a.done;a=r.next()){if(a.value.id.trim().length<=0)return!1}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0}n.d(t,"i",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return u.a})),n.d(t,"a",(function(){return d.a})),n.d(t,"f",(function(){return d.b})),n.d(t,"c",(function(){return f.a})),n.d(t,"g",(function(){return p})),n.d(t,"j",(function(){return m}))},4053:function(e){e.exports=JSON.parse('{"a":"eJa"}')},4054:function(e){e.exports=JSON.parse('{"a":"lJa"}')},4089:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Text=0]="Text",e[e.Html=3]="Html"}(r||(r={}))},4109:function(e){e.exports=JSON.parse('{"a":"GJa"}')},4141:function(e,t,n){"use strict";function r(e,t){var n,r;e&&e((n=t.EventResponseCode,(r={}).Error=n,r))}function a(e,t){(function(e){return void 0!==e.invokeHandlerIfPreviousOnTriggerFailed})(e)&&e.invokeHandlerIfPreviousOnTriggerFailed(t)}var o;!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.API_CALL_NOT_SUPPORTED_BY_EXTENSIONPOINT=9032]="API_CALL_NOT_SUPPORTED_BY_EXTENSIONPOINT",e[e.INTERNAL_ERROR=5001]="INTERNAL_ERROR",e[e.URL_NOT_IN_APP_DOMAINS=12004]="URL_NOT_IN_APP_DOMAINS",e[e.WEB_DIALOG_CLOSED=12006]="WEB_DIALOG_CLOSED",e[e.DIALOG_ALREADY_OPEN=12007]="DIALOG_ALREADY_OPEN"}(o||(o={}));var i,s=o,c="DialogApiEventError",l="ApiEventError";function u(e,t,n){return{EventResponseCode:e,ErrorClassification:t,ErrorDetails:n}}function d(){return u(s.SUCCESS)}function f(e){return e.EventResponseCode===s.SUCCESS}function p(e,t){return d()}function m(e){return d()}function g(e,t){return d()}function h(e){return e}function v(e){return[JSON.stringify(e)]}!function(e){e[e.DISPLAY_DIALOG_DISPID=10]="DISPLAY_DIALOG_DISPID",e[e.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID=11]="DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID",e[e.DIALOG_PARENT_MESSAGE_RECEIVED=12]="DIALOG_PARENT_MESSAGE_RECEIVED",e[e.ITEM_CHANGED_EVENT_DISPID=46]="ITEM_CHANGED_EVENT_DISPID",e[e.RECIPIENTS_CHANGED_EVENT_DISPID=47]="RECIPIENTS_CHANGED_EVENT_DISPID",e[e.APPOINTMENT_TIME_CHANGED_EVENT_DISPID=48]="APPOINTMENT_TIME_CHANGED_EVENT_DISPID",e[e.RECURRENCE_CHANGED_EVENT=49]="RECURRENCE_CHANGED_EVENT",e[e.ATTACHMENTS_CHANGED_EVENT_DISPID=50]="ATTACHMENTS_CHANGED_EVENT_DISPID",e[e.LOCATIONS_CHANGED_EVENT=51]="LOCATIONS_CHANGED_EVENT"}(i||(i={}));var y={},b={};function C(e,t){var n,r;switch(t){case i.DIALOG_PARENT_MESSAGE_RECEIVED:var a=b[t];if(null===(n=y[a])||void 0===n?void 0:n[t])return y[a][t]}return(null===(r=y[e])||void 0===r?void 0:r[t])?y[e][t]:null}function A(e){delete y[e]}function S(e,t){return!!C(e,t)}var _=n(121),O=n(2063),I=n(4);function x(e,t,n,a,o){var i=V(e),c=i.onTrigger(n,t);if(f(c)&&(c=function(e,t,n,r){var a=C(e,t);if(!a)return u(s.INTERNAL_ERROR,l,"HandlerNotRegistered");var o=n.formatArgsForHandler(r);return a(o),d()}(t,e,i,n)),r(a,c),o){var p=Object(O.m)(t),m=c.EventResponseCode;Object(_.s)("ExecuteEvent",{dispId:e,Id:p.extension.Id,DisplayName:p.extension.DisplayName,owa_1:Object(I.j)(),owa_2:Object(O.A)(o),extPoint:Object(O.q)(t),owa_4:p.extension.Type,EventResponseCode:m})}}var T=n(203);function E(e,t){var n=Object(O.x)(e);if(Object(O.I)(n))return u(s.DIALOG_ALREADY_OPEN,c,s[s.DIALOG_ALREADY_OPEN]);if(!function(e,t){if(t&&1==t.displayInIframe){return function(e,t){return Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(e,t)}(Object(O.m)(e).extension.AppDomains,t.url)}return!0}(e,t))return u(s.URL_NOT_IN_APP_DOMAINS,c,s[s.URL_NOT_IN_APP_DOMAINS]);var r=function(e,t,n){var r=Object(O.x)(e);return t&&1==t.displayInIframe?{controlId:Object(T.a)(),dialogType:1,url:t.url,heightInPercentage:t.height,widthInPercentage:t.width,parentControlId:e,isOpen:n,hostItemIndex:r}:Object(O.Q)(e)?{controlId:Object(T.a)(),dialogType:2,parentControlId:e,isOpen:n,hostItemIndex:r}:null}(e,t,!0);return Object(O.U)(r,n),d()}function M(e){var t=Object(O.x)(e);return Object(O.U)(null,t),x(i.DISPLAY_DIALOG_DISPID,e,null),d()}function P(e,t){return d()}function k(e){return function(e){return null!=e&&void 0!==e.messageToParent}(e)?function(e){var t=e.messageToParent;return{messageType:"0",messageContent:t}}(e):{messageType:s.WEB_DIALOG_CLOSED}}var R=!1,N=null;function w(e,t){return function(e,t){S(t,i.ITEM_CHANGED_EVENT_DISPID)||(R=!0,N={controlId:t,args:e},Object(_.s)("ExtTriggerUnregisteredItemChangedEvent"))}(e,t),d()}function D(e){R&&N.controlId===e&&x(i.ITEM_CHANGED_EVENT_DISPID,e,N.args),R=!1,N=null}function U(e){return[JSON.stringify(e)]}function F(e){return[JSON.stringify(e)]}function L(e){var t={recurrence:JSON.stringify(e.recurrence)};return[JSON.stringify(t)]}function j(e){return[JSON.stringify(e)]}function B(){return d()}function H(e){return e?function(e){var t=e.messageContent;return{messageType:"0",messageContent:t}}(e):{messageType:s.WEB_DIALOG_CLOSED}}function V(e){switch(e){case i.DISPLAY_DIALOG_DISPID:case i.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID:return{register:E,unregister:M,onTrigger:P,formatArgsForHandler:k};case i.DIALOG_PARENT_MESSAGE_RECEIVED:return{register:p,unregister:m,onTrigger:B,formatArgsForHandler:H};case i.ITEM_CHANGED_EVENT_DISPID:return{register:p,unregister:m,onTrigger:w,formatArgsForHandler:h,invokeHandlerIfPreviousOnTriggerFailed:D};case i.APPOINTMENT_TIME_CHANGED_EVENT_DISPID:return{register:p,unregister:m,onTrigger:g,formatArgsForHandler:v};case i.RECIPIENTS_CHANGED_EVENT_DISPID:return{register:p,unregister:m,onTrigger:g,formatArgsForHandler:F};case i.RECURRENCE_CHANGED_EVENT:return{register:p,unregister:m,onTrigger:g,formatArgsForHandler:L};case i.LOCATIONS_CHANGED_EVENT:return{register:p,unregister:m,onTrigger:g,formatArgsForHandler:U};case i.ATTACHMENTS_CHANGED_EVENT_DISPID:return{register:p,unregister:m,onTrigger:g,formatArgsForHandler:j};default:throw new Error("ApiEvent not implemented")}}var W=n(24),G=[i.DISPLAY_DIALOG_DISPID];function X(e,t,n){var o,c,l,p,m,g=(o=t.controlId,c=t.eventDispId,l=Object(O.m)(o),p=Object(O.K)(l),m=G.includes(c),!(!p||!m));if(Object(W.i)("addin-autoRun")&&g)return Object(_.s)("ExtRegisterApiEventNotSupportedInAutorun",[t.eventDispId]),void r(n,u(s.API_CALL_NOT_SUPPORTED_BY_EXTENSIONPOINT));if(Object(O.Q)(t.controlId)&&function(e){switch(e){case i.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID:case i.DISPLAY_DIALOG_DISPID:case i.DIALOG_PARENT_MESSAGE_RECEIVED:return!1;case i.APPOINTMENT_TIME_CHANGED_EVENT_DISPID:case i.ITEM_CHANGED_EVENT_DISPID:case i.RECIPIENTS_CHANGED_EVENT_DISPID:case i.RECURRENCE_CHANGED_EVENT:case i.LOCATIONS_CHANGED_EVENT:case i.ATTACHMENTS_CHANGED_EVENT_DISPID:return!0}}(t.eventDispId))r(n,d());else{var h=function(e){return e.targetId?JSON.parse(e.targetId):null}(t),v=V(t.eventDispId),C=v.register(t.controlId,h);f(C)&&(C=function(e,t,n){return function(e,t,n){y[e]||(y[e]={},b[t]=e),y[e][t]=n}(e,t,n),d()}(t.controlId,t.eventDispId,e)),r(n,C),a(v,t.controlId)}}function q(e,t){var n=V(e.eventDispId).unregister(e.controlId);f(n)&&(n=function(e,t){if(!S(e,t))return u(s.INTERNAL_ERROR,l,"ControlNotRegistered");return function(e,t){var n;(null===(n=y[e])||void 0===n?void 0:n[t])&&delete y[e][t]}(e,t),d()}(e.controlId,e.eventDispId)),r(t,n)}function z(e,t,n){var r=Object(O.n)(e),a=!1,o=null;r.forEach((function(r){S(r,t)&&(a||(a=!0,o=n()),x(t,r,o,null,e))}))}var K=n(2076),J=n(2083);function Q(e,t){var n=Object(K.c)(e);null!=n&&n.mode===J.a.AppointmentOrganizer&&z(e,i.APPOINTMENT_TIME_CHANGED_EVENT_DISPID,(function(){return t}))}var Y=n(94),Z=n(4020);function $(e,t,n){var r=Object(O.p)(e),a=Object(K.c)(r);if(null!=a&&(a.mode===J.a.AppointmentOrganizer||a.mode===J.a.MessageCompose)){var o=null;switch(t){case Z.c.Added:o="added";break;case Z.c.Deleted:o="removed";break;default:Object(Y.a)(t)}var s={attachmentStatus:o,attachmentDetails:n};z(r,i.ATTACHMENTS_CHANGED_EVENT_DISPID,(function(){return s}))}}function ee(e,t){var n=Object(K.c)(e);null==n||n.mode!==J.a.AppointmentOrganizer&&n.mode!==J.a.MessageCompose||z(e,i.RECIPIENTS_CHANGED_EVENT_DISPID,(function(){return t}))}function te(e,t){var n=Object(K.c)(e);null!=n&&n.mode===J.a.AppointmentOrganizer&&z(e,i.RECURRENCE_CHANGED_EVENT,(function(){return{recurrence:t}}))}function ne(e,t){var n=Object(O.p)(e),r=Object(K.c)(n);if(null!=r&&r.mode===J.a.AppointmentOrganizer){var a=t.map(Z.g);z(n,i.LOCATIONS_CHANGED_EVENT,(function(){return{enhancedLocations:a}}))}}n.d(t,"c",(function(){return X})),n.d(t,"j",(function(){return q})),n.d(t,"d",(function(){return x})),n.d(t,"b",(function(){return A})),n.d(t,"e",(function(){return Q})),n.d(t,"f",(function(){return $})),n.d(t,"h",(function(){return ee})),n.d(t,"i",(function(){return te})),n.d(t,"g",(function(){return ne})),n.d(t,"a",(function(){return i}))},4205:function(e){e.exports=JSON.parse('{"a":"ZIa"}')},4305:function(e){e.exports=JSON.parse('{"a":"oJa"}')},4322:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return g}));var r,a,o=n(1),i=n(4930),s=n(157),c=n(2063),l=n(57);n(4008);function u(){return r}function d(){void 0===r&&(r="Store"+OSF.OUtil.generateConversationId());var e=Object(c.r)(),t=r+"|"+window.location.href.split("?")[0],n=OSF.OUtil.addXdmInfoAsHash(e.InClientStoreUrl,t);n=i.a(n,"client","WAC_Outlook");var o=Date.now();return n=i.a(n,"cv","16.2130.0.9999"),n=i.a(n,"ui",Object(l.j)()),n=i.a(n,"rs",Object(l.j)()),n=i.a(n,"timestamp",o.toString()),n=i.a(n,"ep",function(){if(a)return"il";return"ma"}()),n=i.a(n,"exchver",i.c()),n=i.a(n,"privateenabled",e.CustomExtensionsEnabled.toString()),n=i.a(n,"cb",i.d()),n=i.a(n,"ClientSessionId",i.e()),n=i.a(n,"userPuid","0"),n=i.a(n,"gates","Marketplace.Outlook.Pin.Addin.Options,Marketplace.Outlook.Pin.Addin.Calendar.Options")}function f(){var e=OSF.OUtil.getUniqueId();return Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(e)}function p(){return Object(o.c)(this,void 0,void 0,(function(){var e;return Object(o.f)(this,(function(t){switch(t.label){case 0:return[4,Object(s.a)()];case 1:return(e=t.sent()).headers.append("X-EWS-TargetVersion","2.80"),delete e.credentials,[2,e]}}))}))}function m(e){return"string"==typeof e?e:["notresponded","notconsented","consented"][e]}var g=function(e){a=e}},4467:function(e){e.exports=JSON.parse('{"a":"dJa"}')},4493:function(e,t,n){"use strict";var r=n(1);function a(e,t,n){return"Addin_"+e+"_"+t+"_"+n}var o,i=n(7753),s=n(2076),c=n(3402),l=n(2263);function u(e){return void 0===e&&(e=null),{error:o.Success,data:e}}function d(e){return{error:o.Failed,errorCode:e}}function f(e,t){return!p(e)&&(t(d(l.a.InsufficientItemPermissions)),!0)}function p(e){return!e.isSharedItem||!e.getSharedProperties||(!e.isSharedItem()||e.getSharedProperties().delegatePermissions.EditOwn)}!function(e){e[e.Success=0]="Success",e[e.Failed=1]="Failed"}(o||(o={}));var m=n(2063),g=n(3097);function h(e,t,n){return Object(r.c)(this,void 0,void 0,(function(){var o,f,h,v,y,b;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(o=Object(s.c)(e),f=Object(m.u)(t),h=a(e,f,n),!Object(g.f)(h))return[2,d(l.b.NotificationKeyNotFound)];if(v=Object(g.e)(h),(y=v.Persistent)&&!p(o))return[2,d(l.b.InsufficientItemPermissions)];o.removeNotificationMessage(h),Object(g.h)(h),r.label=1;case 1:return r.trys.push([1,4,,5]),y?[4,Object(i.a)(e,f)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:return(b=r.sent())instanceof c.a?[2,d(b.errorCode)]:[3,5];case 5:return[2,u()]}}))}))}function v(e){switch(e){case 0:return"informationalMessage";case 2:return"errorMessage";case 1:return"progressIndicator";case 3:return"insightMessage"}return""}function y(e,t,n,o,f,v,y,b,C){return void 0===y&&(y=null),void 0===b&&(b=!1),void 0===C&&(C=null),Object(r.c)(this,void 0,void 0,(function(){var A,S,_,O,I,x,T;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(!(A=Object(s.c)(e)))return[2,d(l.b.InvalidSelection)];if(S=Object(m.u)(t),_=a(e,S,o),function(e,t,n){var r=Object(m.m)(t);if(r){var o=r.get_Id(),i=a(e,n,o);Object(g.f)(i)&&h(e,t,o)}}(e,t,S),O=!1,Object(g.f)(_)){if(b)return[2,d(l.b.DuplicateNotificationKey)];I=Object(g.e)(_),O=I.Persistent}else if(Object(g.g)(e,S,C))return[2,d(l.b.NumberOfNotificationsExceeded)];if(x=function(e,t,n,r,a,o,i){return{ExtensionId:e,Persistent:!!t||2===r,Key:n,Type:r,Message:a,Icon:o,Actions:i||null}}(S,n,o,f,v,y,C),!p(A)&&x.Persistent)return[2,d(l.b.InsufficientItemPermissions)];Object(g.a)(e,S,_,x),A.addNotificationMessage(_),r.label=1;case 1:return r.trys.push([1,4,,5]),O||x.Persistent?[4,Object(i.a)(e,S)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:return(T=r.sent())instanceof c.a?[2,d(T.errorCode)]:[3,5];case 5:return[2,u()]}}))}))}function b(e){try{var t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("style");if(n&&n.length>0)for(var r=0;r<n.length;r++)n[r]&&(n[r].innerHTML="");return t.body.textContent||""}catch(e){return""}}var C=n(6242);function A(e){var t=Object(m.C)(e);if(t){var n=t.hostItemIndex,r=Object(m.D)(e);"Persistent"==r&&Object(C.b)(),Object(m.fb)(r,n);var a=Object(s.c)(n);a&&a.closeTaskPane&&a.closeTaskPane()}}var S=n(2083);function _(e){return Object(s.d)(e)}function O(e,t,n){return e&&e.match(function(e,t){var n,r="g";t&&(r="ig");try{n=new RegExp(e,r)}catch(e){return null}return n}(t,n))}var I=n(1085),x=255;function T(e){var t,n;try{for(var a=Object(r.k)(e),o=a.next();!o.done;o=a.next()){var i=o.value.length;if(i<=0||i>x)return!0}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return!1}var E=n(1435);var M=n(4020);var P=n(4903),k=n(203);function R(e,t,n){var a,o,i,s,c=m.j.EnabledAddinCommands;if(!c)return null;try{for(var l=Object(r.k)(c.getExtensionPoint(n)),u=l.next();!u.done;u=l.next()){var d=u.value;if(d.Id==e&&d.AddinCommands.size>0)try{for(var f=(i=void 0,Object(r.k)(d.AddinCommands.values())),p=f.next();!p.done;p=f.next()){var g=p.value;if(g.control.Id==t)return g}}catch(e){i={error:e}}finally{try{p&&!p.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}}}catch(e){a={error:e}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(a)throw a.error}}return null}var N=n(121);var w=/^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;function D(e){return w.test(e)}function U(e){var t=[];return e.forEach((function(e){D(e.address)&&t.push({Name:e.name,EmailAddress:e.address})})),t}var F={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},L=/[&<>"'\/]/g;var j=n(33);function B(e){return(t={input:e},Object(j.a)("SanitizeHtml",t,n)).catch(H);var t,n}function H(){return null}var V="<div>",W="</div>";function G(e){var t=e.trim();return t.substr(0,V.length).toLowerCase()==V&&t.substr(t.length-W.length,W.length).toLowerCase()==W&&(t=t.substring(V.length,t.length-W.length)),t}function X(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,B(e)];case 1:return null==(t=n.sent())?[2,null]:[2,G(t)]}}))}))}var q=n(67),z=null;function K(e){z=e}function J(){return z}var Q,Y=function(e,t){var n=J();n&&n(e,t)},Z=n(440);!function(e){e[e.Success=0]="Success",e[e.OperationNotSupported=5e3]="OperationNotSupported",e[e.InternalError=5001]="InternalError",e[e.NotSsoAgave=13e3]="NotSsoAgave",e[e.UserNotSignedIn=13001]="UserNotSignedIn",e[e.UserAborted=13002]="UserAborted",e[e.InvalidResourceUrl=13004]="InvalidResourceUrl",e[e.InvalidGrant=13005]="InvalidGrant",e[e.ClientError=13006]="ClientError",e[e.AddinIsAlreadyRequestingToken=13008]="AddinIsAlreadyRequestingToken",e[e.SSOUnsupportedPlatform=13012]="SSOUnsupportedPlatform"}(Q||(Q={}));var $=n(295),ee="bc59ab01-8403-45c6-8796-ac3ef710b3e3",te="/owa/extSSO.aspx";function ne(e,t,n){var r=Object(m.F)(e),a=Object($.resolve)(window.location.origin,te);try{Object(Z.getAccessTokenOnBehalfOfResource)(ee,a,r,t,n,re)}catch(e){re(e,void 0)}}function re(e,t){var n,r;t?Y(null,t):Y((n=e,r=Q.ClientError,n&&(n.indexOf(Z.AdalErrorCode.NoUserLogin)>=0?r=Q.UserNotSignedIn:n.indexOf(Z.AdalErrorCode.InvalidResourceUrl)>=0?r=Q.InvalidResourceUrl:n.indexOf(Z.AdalErrorCode.NoPreAuth)>=0||n.indexOf(Z.AdalErrorCode.NotConsent)>=0?r=Q.InvalidGrant:n.indexOf(Z.AdalErrorCode.UserAborted)>=0&&(r=Q.UserAborted)),r)),K(null)}var ae=1e6;function oe(e,t,n,a,o,i){return Object(r.c)(this,void 0,void 0,(function(){var t,c,f,p,m;return Object(r.f)(this,(function(r){switch(r.label){case 0:return(t=n.appendTxt||""===n.appendTxt?n.appendTxt:n.data).length>ae?(a(d(l.a.OoeInvalidDataFormat)),[2]):(c=null==i?void 0:i(),f=null,n.coercionType!==_n.a.Html?[3,2]:[4,X(t)]);case 1:return null==(f=r.sent())?(a(d(l.a.HtmlSanitizationFailure)),[2]):function(e){for(var t=(new DOMParser).parseFromString(e,"text/html").querySelectorAll("img"),n=0;n<t.length;n++){var r=t[n].getAttribute("src");if(r=decodeURIComponent(r)){var a=r.lastIndexOf(".");if(-1!==a&&"svg"===r.substring(a+1).toLowerCase())return!0}}return!1}(f)?(a(d(Q.OperationNotSupported)),[2]):[3,3];case 2:p=Object(s.c)(e),f="HTML"!==p.getBodyType()||n.appendOnSend?t:t.replace(L,(function(e){return F[e]})),r.label=3;case 3:if(n.appendOnSend)n.appendOnSend.txt=f,o(n.appendOnSend);else{if(i&&(m=i(),h=m,!(null==(g=c)&&null==h||null!=g&&null!=h&&g.data===h.data&&g.sourceProperty===h.sourceProperty&&g.startPosition===h.startPosition&&g.endPosition===h.endPosition)))return a(d(l.a.CursorPositionChanged)),[2];o(f),"Firefox"===Object(q.a)().browser&&document.activeElement.blur()}return a(u()),[2]}var g,h}))}))}var ie=n(9849),se=n(24),ce=5e3;var le,ue=n(10390);function de(e,t,n,a){!function(e){var t,n,a,o,i=Object(m.s)().taskPanes;try{for(var s=Object(r.k)(i.values()),c=s.next();!c.done;c=s.next()){var l=c.value;try{for(var u=(a=void 0,Object(r.k)(l.values())),d=u.next();!d.done;d=u.next()){if(d.value.controlId===e)return!0}}catch(e){a={error:e}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return!1}(t)?function(e){return Object(m.s)().runningContextualAddinCommand&&Object(m.s)().runningContextualAddinCommand.controlId===e}(t)&&Object(m.db)():A(t),a(u())}function fe(e,t,n,r){n.itemId?(Object(s.c)(e).displayAppointmentForm(n.itemId),r(u())):r(d())}function pe(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(t){switch(t.label){case 0:return[4,Object(s.c)(e).displayMessageForm(n.itemId)];case 1:return t.sent(),a(u()),[2]}}))}))}!function(e){e[e.MaxRecipientsOnDisplayNewAppointment=100]="MaxRecipientsOnDisplayNewAppointment",e[e.MaxSubjectLength=255]="MaxSubjectLength",e[e.MaxBodyLengthOnDisplayApis=32768]="MaxBodyLengthOnDisplayApis",e[e.MaxLocationLengthOnDisplayNewAppointment=255]="MaxLocationLengthOnDisplayNewAppointment",e[e.MaxAttachmentNumberOnDisplayApis=100]="MaxAttachmentNumberOnDisplayApis",e[e.MaxRecipientsPerCall=100]="MaxRecipientsPerCall"}(le||(le={}));var me=le,ge=function(e){return"string"==typeof e?{Name:e,EmailAddress:e}:{Name:e.name,EmailAddress:e.address}},he=function(e){return e?e.map(ge):[]};function ve(e,t,n,r){var a;!n||ye((a=n).requiredAttendees,me.MaxRecipientsOnDisplayNewAppointment)||ye(a.optionalAttendees,me.MaxRecipientsOnDisplayNewAppointment)||ye(a.subject,me.MaxSubjectLength)||ye(a.body,me.MaxBodyLengthOnDisplayApis)||ye(a.location,me.MaxLocationLengthOnDisplayNewAppointment)?r(d()):(Object(s.c)(e).displayNewAppointmentForm(he(n.requiredAttendees),he(n.optionalAttendees),n.start,n.end,n.location,n.resources,n.subject,n.body),r(u()))}function ye(e,t){return e&&e.length>t}function be(e){switch(e[0]){case"file":return function(e){return{id:e[2],name:e[1],attachmentType:M.a.File,isInline:e[3]}}(e);case"item":return function(e){return{id:e[2],name:e[1],attachmentType:M.a.Item,isInline:!1}}(e);default:return null}}function Ce(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,o,i,c,l,f,p,m;return Object(r.f)(this,(function(g){switch(g.label){case 0:if(t=!1,o=Object(r.g)([n.toRecipients,n.ccRecipients,n.bccRecipients].map((function(e){return e?e.length>me.MaxRecipientsPerCall?(t=!0,null):function(e){var t=[];return e.forEach((function(e){D(e)&&t.push({Name:e,EmailAddress:e,MailboxType:"OneOff",RoutingType:"SMTP"})})),t}(e):[]})),3),i=o[0],c=o[1],l=o[2],t)return a(d()),[2];if(f="",n.subject){if(n.subject.length>me.MaxSubjectLength)return a(d()),[2];f=n.subject}return p="",n.htmlBody?n.htmlBody.length>me.MaxBodyLengthOnDisplayApis?(a(d()),[2]):[4,X(n.htmlBody)]:[3,2];case 1:if(null==(p=g.sent()))return a(d()),[2];g.label=2;case 2:if(m=[],n.attachments){if(n.attachments.length>me.MaxAttachmentNumberOnDisplayApis)return a(d()),[2];m=n.attachments.map(be)}return[4,Object(s.c)(e).displayNewMessageForm(i,c,l,f,p,m)];case 3:return g.sent(),a(u()),[2]}}))}))}function Ae(e,t,n,a,o){return Object(r.c)(this,void 0,void 0,(function(){var t,i,c;return Object(r.f)(this,(function(r){switch(r.label){case 0:return t="",i=[],n.htmlBody?n.htmlBody.length>me.MaxBodyLengthOnDisplayApis?(a(d()),[2]):[4,X(n.htmlBody)]:[3,2];case 1:if(null==(t=r.sent()))return a(d()),[2];r.label=2;case 2:if(n.attachments){if(n.attachments.length>me.MaxAttachmentNumberOnDisplayApis)return a(d()),[2];i=n.attachments.map(be)}return[4,(c=Object(s.c)(e)).displayReplyForm(c.getItemId(),o,t,i)];case 3:return r.sent(),a(u()),[2]}}))}))}function Se(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(t){switch(t.label){case 0:return[4,Ae(e,0,n,a,!0)];case 1:return t.sent(),[2]}}))}))}function _e(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Se(e,0,n,a)];case 1:return r.sent(),[3,3];case 2:return t=r.sent(),a(d(t.message.search("ErrorInvalidIdMalformed")<0?t:l.b.ItemNotFound)),[3,3];case 3:return[2]}}))}))}function Oe(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(t){switch(t.label){case 0:return[4,Ae(e,0,n,a,!1)];case 1:return t.sent(),[2]}}))}))}function Ie(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Oe(e,0,n,a)];case 1:return r.sent(),[3,3];case 2:return t=r.sent(),a(d(t.message.search("ErrorInvalidIdMalformed")<0?t:l.b.ItemNotFound)),[3,3];case 3:return[2]}}))}))}n(4008);function xe(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.a)({__type:"EwsProxyRequestParameters:#Exchange"},n)),Object(j.a)("ExecuteEwsProxy",e,t)}function Te(e,t,n){return xe({Body:e,Token:t,ExtensionId:n})}var Ee=n(6),Me="Token type is not supported for caching: {0}",Pe=n(3785),ke=n(3668),Re=n(180),Ne="CallerIdentity",we="ScopedToken",De="ExtensionRestApiCallback",Ue="ExtensionCallback";function Fe(e,t,n){var r=new Array(t.length);t.forEach((function(t,a){return r[a]={TokenType:t,Id:e,Scope:n}}));var a=Object(ke.a)({TokenRequests:r});return Object(Pe.a)({Header:Object(Re.b)(),Body:a})}var Le=15,je={},Be={};function He(e,t){Ge(t.TokenType)[e]=function(e){return{cacheTime:Date.now(),token:e}}(t)}function Ve(e,t){var n=Ge(t);return function(e,t){var n=Ge(t);n[e]&&(r=n[e],a=Date.now()-r.cacheTime,o=1e3*(r.token.TTL-Le)*60,a>=o)&&delete n[e];var r,a,o;return!!n[e]}(e,t)?n[e].token:null}function We(e){return e==Ne||e==Ue}function Ge(e){switch(e){case Ne:return je;case Ue:return Be;default:throw Object(Ee.c)(Me,e)}}var Xe="Success";function qe(e,t,n){return Object(r.c)(this,void 0,void 0,(function(){var a,o,i,s;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(We(t)&&(a=Ve(e.extension.Id,t)))return[2,a];o=[],Ve(e.extension.Id,Ne)||o.push(Ne),2!=e.extension.RequestedCapabilities||Ve(e.extension.Id,Ue)||o.push(Ue),t!=De&&t!=we||o.push(t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Fe(e.extension.Id,o,n)];case 2:return i=r.sent(),[3,4];case 3:return r.sent(),[2,null];case 4:return s=function(e){return e.Body.ResponseMessages.Items.forEach(ze),e.Body.ResponseMessages.Items}(i),[2,Ke(t)(s)]}}))}))}function ze(e){"NoError"==e.ResponseCode&&e.ResponseClass==Xe&&We(e.Token.TokenType)&&He(e.Token.Id,e.Token)}var Ke=function(e){return function(t){var n=t.filter(Je(e))[0];return n?n.Token:null}},Je=function(e){return function(t){return"NoError"==t.ResponseCode&&t.ResponseClass==Xe&&t.Token.TokenType==e}};var Qe=1e6;var Ye="Error",Ze="accessToken";function $e(e){var t;return(t={})[Ye]=e,t}function et(e){if(e){var t;try{var n=new URL(e);if(!n||"https:"!=n.protocol)return;t=n.host}catch(n){var r=document.createElement("a");if(r.href=e,"https:"!==r.protocol)return;var a=function(e){return"/"===e.substring(e.length-1,e.length)};""!==r.pathname&&"/"!==r.pathname||a(e)||(e+="/");var o=r.protocol+"//"+r.hostname+(a(r.hostname)?"":"/")+r.pathname+r.search+r.hash,i=r.protocol+"//"+r.host+(a(r.host)?"":"/")+r.pathname+r.search+r.hash;e!=o&&e!=i||(t="443"==r.port?r.hostname:r.host)}return t}}var tt=n(197);var nt=n(94),rt=n(1996),at=n(4607);function ot(e,t,n){return Object(r.c)(this,void 0,void 0,(function(){var a,o,i,s,c,l,u,d,f,p,m,g;return Object(r.f)(this,(function(h){switch(h.label){case 0:if(a=null,o=t.getItem(),i=!1,!(o.Attachments.length>0))return[3,13];h.label=1;case 1:h.trys.push([1,10,11,12]),s=Object(r.k)(o.Attachments),c=s.next(),h.label=2;case 2:return c.done?[3,9]:(l=c.value,u=l.AttachmentOriginalUrl,d=l.AttachmentId.Id,"ReferenceAttachment:#Exchange"!==l.__type||n!==u?[3,3]:(f=l,a={format:M.b.Url,content:f.AttachLongPathName},i=!0,[2,a]));case 3:return n!==d?[3,8]:!0!==e?[3,5]:[4,t.getAttachmentContent(n)];case 4:return a=h.sent(),[3,7];case 5:return[4,t.getAttachmentContent(n)];case 6:a=h.sent(),h.label=7;case 7:return i=!0,[2,a];case 8:return c=s.next(),[3,2];case 9:return[3,12];case 10:return p=h.sent(),m={error:p},[3,12];case 11:try{c&&!c.done&&(g=s.return)&&g.call(s)}finally{if(m)throw m.error}return[7];case 12:if(!i)return[2,a];h.label=13;case 13:return[2,a]}}))}))}var it=n(1273),st=n(1270),ct=n(439),lt="Success";function ut(e,t,n){var r=e.map((function(e){return Object(ct.a)({Id:e})}));return Object(it.a)({Header:Object(Re.b)(),Body:Object(st.a)({ItemShape:t,ItemIds:r,ShapeName:n})}).then((function(e){return(t=e.Body.ResponseMessages.Items[0]).ResponseClass==lt?t.Items[0]:{};var t}))}var dt=n(981),ft=n(979);function pt(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return Object(se.i)("addin-getBodyAsyncApi-update-fix")?[3,3]:e.NormalizedBody?[3,2]:[4,ut([e.ItemId.Id],mt(),"ItemNormalizedBody")];case 1:t=n.sent(),e.NormalizedBody=t.NormalizedBody,n.label=2;case 2:return[2,e.NormalizedBody.Value];case 3:return[4,ut([e.ItemId.Id],mt(),"ItemNormalizedBody")];case 4:return[2,n.sent().NormalizedBody.Value]}}))}))}function mt(){return Object(dt.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ft.a)({FieldURI:"NormalizedBody"})]})}function gt(e,t){return{wasSuccessful:e,token:t}}var ht,vt="ParentItemId:";!function(e){e[e.Message=1]="Message",e[e.Appointment=2]="Appointment",e[e.MeetingRequest=3]="MeetingRequest",e[e.MessageCompose=4]="MessageCompose",e[e.AppointmentCompose=5]="AppointmentCompose"}(ht||(ht={}));var yt=ht;function bt(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n;return Object(r.f)(this,(function(r){switch(r.label){case 0:return t.itemType=yt.AppointmentCompose,n=t,[4,e.getSeriesId()];case 1:return n.seriesId=r.sent(),[2,t]}}))}))}var Ct=n(14),At=n(319);function St(e,t,n){if(!e)return{};var r={Addresses:e.Addresses?e.Addresses.map((function(e){return e.Address})):[],Urls:e.Urls?e.Urls.map((function(e){return e.Url})):[],PhoneNumbers:e.PhoneNumbers?e.PhoneNumbers:[]};return r.IsLegacyExtraction=function(e){return!(e.EntityDocument||e.PropertyExistence&&e.PropertyExistence.TextEntityExtractions)}(t),0!=n.extension.RequestedCapabilities&&(r.Contacts=e.Contacts?e.Contacts:[],r.EmailAddresses=e.EmailAddresses?e.EmailAddresses.map((function(e){return e.EmailAddress})):[],r.MeetingSuggestions=e.MeetingSuggestions?e.MeetingSuggestions.map(Ot.bind(r)):[],r.TaskSuggestions=e.TaskSuggestions?e.TaskSuggestions:[]),r}function _t(e,t){var n,a;try{for(var o=Object(r.k)(t),i=o.next();!i.done;i=o.next()){var s=O(e,i.value,!0);if(s&&s.length>0)return!0}}catch(e){n={error:e}}finally{try{i&&!i.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return!1}function Ot(e){var t=this.IsLegacyExtraction,n=Object(Ct.toJS)(At({},e));return n.EndTime=t?It(n.EndTime):new Date(n.EndTime).getTime(),n.StartTime=t?It(n.StartTime):new Date(n.StartTime).getTime(),n}function It(e){var t=new Date(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),n.getTime()}function xt(e){var t={};return e&&Object.keys(e).forEach((function(n){var r;e[n]&&(t[n]=(r=e[n],Object(m.s)().contextualCalloutState.selectedTerms.filter((function(e){return r.indexOf(e)>=0}))))})),t}function Tt(e){return ut([e.ItemId.Id],Object(dt.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ft.a)({FieldURI:"EntityExtractionResult"})]}),null)}function Et(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var o,i,s;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(t.EntityExtractionResult||!function(e){return e.PropertyExistence&&(e.PropertyExistence.ExtractedAddresses||e.PropertyExistence.ExtractedContacts||e.PropertyExistence.ExtractedEmails||e.PropertyExistence.ExtractedMeetings||e.PropertyExistence.ExtractedPhones||e.PropertyExistence.ExtractedTasks||e.PropertyExistence.ExtractedUrls)}(t))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Tt(t)];case 2:return o=r.sent(),Object(m.nb)(t,o.EntityExtractionResult),[3,4];case 3:return r.sent(),[3,4];case 4:return t.EntityExtractionResult&&(a.entities=St(t.EntityExtractionResult,t,n),a.entities&&(i=JSON.parse(JSON.stringify(a.entities)),a.selectedEntities=function(e,t){var n={};return e&&t&&(e.Addresses&&(n.Addresses=e.Addresses.filter((function(e){return _t(e,t)}))),e.MeetingSuggestions&&(n.MeetingSuggestions=e.MeetingSuggestions.filter((function(e){return _t(e.MeetingString,t)}))),e.TaskSuggestions&&(n.TaskSuggestions=e.TaskSuggestions.filter((function(e){return _t(e.TaskString,t)}))),e.PhoneNumbers&&(n.PhoneNumbers=e.PhoneNumbers.filter((function(e){return _t(e.OriginalPhoneString,t)}))),e.Urls&&(n.Urls=e.Urls.filter((function(e){return _t(e,t)}))),e.Contacts&&(n.Contacts=e.Contacts.filter((function(e){return _t(e.ContactString,t)}))),e.EmailAddresses&&(n.EmailAddresses=e.EmailAddresses.filter((function(e){return _t(e,t)})))),n}(i,Object(m.s)().contextualCalloutState.selectedTerms))),(s=function(e,t){var n=Object(m.w)(e);return(null==n?void 0:n.contextualEvaluationResults)&&n.contextualEvaluationResults.has(t)?n.contextualEvaluationResults.get(t):null}(e,n.extension.Id))&&(a.filteredEntities=s.filteredEntityMatches,a.regExMatches=s.regExMatches,a.selectedRegExMatches=xt(a.regExMatches)),[2,a]}}))}))}var Mt,Pt,kt=n(6329);!function(e){e[e.Other=0]="Other",e[e.DistributionList=1]="DistributionList",e[e.User=2]="User",e[e.ExternalUser=3]="ExternalUser"}(Mt||(Mt={})),function(e){e[e.Unknown=0]="Unknown",e[e.Organizer=1]="Organizer",e[e.Tentative=2]="Tentative",e[e.Accept=3]="Accept",e[e.Decline=4]="Decline",e[e.NoResponseReceived=5]="NoResponseReceived"}(Pt||(Pt={}));var Rt=function(e){return{address:e.EmailAddress,name:e.Name,recipientType:Dt(e.MailboxType)}},Nt=function(e){var t=Rt(e.Mailbox);return t.appointmentResponse=function(e){switch(e){case"Organizer":return Pt.Organizer;case"Tentative":return Pt.Tentative;case"Accept":return Pt.Accept;case"Decline":return Pt.Decline;case"NoResponseReceived":return Pt.NoResponseReceived;default:return Pt.Unknown}}(e.ResponseType),t},wt=function(e){return e?e.map((function(e){return Nt(e)})):[]};function Dt(e){switch(e){case"PublicDL":case"PrivateDL":case"PublicFolder":return Mt.DistributionList;case"Mailbox":case"Contact":return Mt.User;case"OneOff":return Mt.ExternalUser;default:return Mt.Other}}function Ut(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var o,i,s,c;return Object(r.f)(this,(function(r){switch(r.label){case 0:return a.itemType=yt.Appointment,o=e.getItem(),a.id=o.ItemId.Id,a.end=o.End,a.start=o.Start,a.location=o.Location?o.Location.DisplayName:"",a.dateTimeCreated=o.DateTimeCreated?new Date(o.DateTimeCreated):null,a.dateTimeModified=o.LastModifiedTime?new Date(o.LastModifiedTime):null,a.itemClass=o.ItemClass,a.subject=o.Subject,a.normalizedSubject=o.Subject,a.organizer=Nt(o.Organizer),i=wt(o.RequiredAttendees),a.to=function(e,t){if(t){if(!e.some((function(e){return e.address.toLowerCase()===t.address.toLowerCase()})))return e.concat(t)}return e}(i,a.organizer),a.cc=wt(o.OptionalAttendees),a.attachments=o.Attachments?Object(M.f)(o.Attachments):[],[4,e.getRecurrence()];case 1:return s=r.sent(),a.recurrence=Object(kt.a)({recurrenceType:s,timeZone:o.StartTimeZoneId,startTime:new Date(o.Start),endTime:new Date(o.End)}),a.resources=wt(o.Resources),c=a,[4,e.getSeriesId()];case 2:return c.seriesId=r.sent(),[4,Et(n,o,t,a)];case 3:return[2,a=r.sent()]}}))}))}var Ft=n(10453),Lt=n(79),jt=n(57),Bt=n(4);function Ht(e,t,n,r){return r=function(e,t){return t.hostVersion=Object(Bt.r)()||"debug",t.owaView="mouse",t.timeZoneOffsets=Object(Lt.e)(),t}(0,r=function(e,t){var n=e.extension;return t.extensionId=n.Id,t.marketplaceContentMarket=n.MarketplaceContentMarket,t.permissionLevel=n.RequestedCapabilities,t.marketplaceAssetId=n.MarketplaceAssetID,t.entryPointUrl=e.get_EntryPoint(),t.consentMetadata=n.ConsentMetadata,t.endNodeUrl=n.EndNodeUrl,t}(t,r)),0!=t.extension.RequestedCapabilities&&(r=function(e,t){return t.userDisplayName=Object(jt.k)(),t.userEmailAddress=Object(jt.l)(),t.userTimeZone=Object(jt.p)(),t.userProfileType=Object(Ft.a)(),t.ewsUrl=Object(m.r)().EwsUrl,t.restUrl=Object(m.r)().RestUrl,t}(0,r)),e.isSharedItem&&e.getSharedProperties&&(r.isFromSharedFolder=e.isSharedItem()),r.shouldRunNewCodeForFlags|=1,r}var Vt="0xe1d";function Wt(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return a.id=e.getItemId(),a.isRead=!0,a.itemType=yt.Message,o=e.getItem(),a.itemClass=o.ItemClass,a.subject=o.Subject,a.normalizedSubject=function(e,t){if(!e.ExtendedProperty)return null;for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n];if((null==r?void 0:r.ExtendedFieldURI)&&r.ExtendedFieldURI.PropertyTag===t)return r.Value}return null}(o,Vt),a.conversationId=o.ConversationId.Id,a.internetMessageId=o.InternetMessageId,a.dateTimeCreated=o.DateTimeCreated?new Date(o.DateTimeCreated).getTime():null,a.dateTimeModified=o.LastModifiedTime?new Date(o.LastModifiedTime).getTime():null,a.dateTimeSent=o.DateTimeSent?new Date(o.DateTimeSent).getTime():null,a.attachments=o.Attachments?Object(M.f)(o.Attachments):[],[4,Et(n,o,t,a)];case 1:return a=r.sent(),0==t.extension.RequestedCapabilities?[3,3]:(a.from=o.From?Rt(o.From.Mailbox):null,a.sender=o.Sender?Rt(o.Sender.Mailbox):null,a.to=o.ToRecipients?o.ToRecipients.map(Rt):[],a.cc=o.CcRecipients?o.CcRecipients.map(Rt):[],a.bcc=o.BccRecipients?o.BccRecipients.map(Rt):[],function(e){return 0==e.ItemClass.indexOf("IPM.Schedule.Meeting.Request")||0==e.ItemClass.indexOf("IPM.Schedule.Meeting.Canceled")}(o)?[4,Gt(e,a)]:[3,3]);case 2:a=r.sent(),r.label=3;case 3:return[2,a]}}))}))}function Gt(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,a,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=e.getItem(),t.itemType=yt.MeetingRequest,t.location=n.Location.DisplayName,t.start=n.Start,t.end=n.End,t.to=n.RequiredAttendees?n.RequiredAttendees.map(Nt):[],t.cc=n.OptionalAttendees?n.OptionalAttendees.map(Nt):[],t.resources=n.Resources?n.Resources.map(Nt):[],a=t,[4,e.getSeriesId()];case 1:return a.seriesId=r.sent(),[4,e.getRecurrence()];case 2:return o=r.sent(),t.recurrence=Object(kt.a)({recurrenceType:o,timeZone:n.StartTimeZoneId,startTime:new Date(n.Start),endTime:new Date(n.End)}),[2,t]}}))}))}function Xt(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,a,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:switch(n={},a=Object(s.c)(t),Object(m.w)(t),o=Object(m.m)(e),n=Ht(a,o,0,n),a.mode){case S.a.MeetingRequest:case S.a.MessageRead:return[3,1];case S.a.MessageCompose:return[3,3];case S.a.AppointmentAttendee:return[3,4];case S.a.AppointmentOrganizer:return[3,6]}return[3,8];case 1:return[4,Wt(a,o,t,n)];case 2:return n=r.sent(),[3,8];case 3:return n=function(e,t){return t.itemType=yt.MessageCompose,t.conversationId=e.getConversationId(),t.isRead=!1,t}(a,n),[3,8];case 4:return[4,Ut(a,o,t,n)];case 5:return n=r.sent(),[3,8];case 6:return[4,bt(a,n)];case 7:return n=r.sent(),[3,8];case 8:return[2,n]}}))}))}var qt=n(4496);var zt,Kt=500;!function(e){e[e.Start=1]="Start",e[e.End=2]="End"}(zt||(zt={}));var Jt=zt;var Qt=n(2030);function Yt(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(r.a)({__type:"LoadExtensionCustomPropertiesParameters:#Exchange"},n))),Object(j.a)("LoadExtensionCustomProperties",e,t)}function Zt(e,t,n){return Yt({request:{ExtensionId:e,ItemId:t}},n?{headers:Object(Qt.e)(n)}:{})}function $t(e,t,n){return{errorMessage:e,wasSuccessful:t,customProperties:n}}var en=n(4141);function tn(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.a)({__type:"RegisterConsentJsonRequest:#Exchange"},n)),Object(j.a)("RegisterConsent",e,t)}function nn(e,t){var n,a=(n={Id:e,ConsentState:t},Object(r.a)({__type:"RegisterConsentRequest:#Exchange"},n));return tn({Header:Object(Re.b)(),Body:a})}function rn(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(r.a)({__type:"SaveExtensionCustomPropertiesParameters:#Exchange"},n))),Object(j.a)("SaveExtensionCustomProperties",e,t)}function an(e,t,n,r){return rn({request:{ExtensionId:e,ItemId:t,CustomProperties:r}},n?{headers:Object(Qt.e)(n)}:{})}function on(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(r.a)({__type:"SaveExtensionSettingsParameters:#Exchange"},n))),Object(j.a)("SaveExtensionSettings",e,t)}var sn=32768;var cn=255;var ln,un,dn=12e4;!function(e){e[e.GetInitialData=1]="GetInitialData",e[e.GetUserIdentityToken=2]="GetUserIdentityToken",e[e.EwsRequest=5]="EwsRequest",e[e.LoadCustomProperties=3]="LoadCustomProperties",e[e.SaveCustomProperties=4]="SaveCustomProperties",e[e.DisplayNewAppointmentForm=7]="DisplayNewAppointmentForm",e[e.DisplayMessageForm=8]="DisplayMessageForm",e[e.DisplayAppointmentForm=9]="DisplayAppointmentForm",e[e.DisplayReplyForm=10]="DisplayReplyForm",e[e.DisplayReplyAllForm=11]="DisplayReplyAllForm",e[e.GetCallbackToken=12]="GetCallbackToken",e[e.SetBodySelectedDataAsync=13]="SetBodySelectedDataAsync",e[e.GetBodyTypeAsync=14]="GetBodyTypeAsync",e[e.GetRecipientsAsync=15]="GetRecipientsAsync",e[e.AddFileAttachmentAsync=16]="AddFileAttachmentAsync",e[e.SetSubjectAsync=17]="SetSubjectAsync",e[e.GetSubjectAsync=18]="GetSubjectAsync",e[e.AddItemAttachmentAsync=19]="AddItemAttachmentAsync",e[e.RemoveAttachmentAsync=20]="RemoveAttachmentAsync",e[e.SetRecipientsAsync=21]="SetRecipientsAsync",e[e.AddRecipientsAsync=22]="AddRecipientsAsync",e[e.BodyPrependAsync=23]="BodyPrependAsync",e[e.GetTimeAsync=24]="GetTimeAsync",e[e.SetTimeAsync=25]="SetTimeAsync",e[e.GetLocationAsync=26]="GetLocationAsync",e[e.SetLocationAsync=27]="SetLocationAsync",e[e.GetSelectedDataAsync=28]="GetSelectedDataAsync",e[e.SetSelectedDataAsync=29]="SetSelectedDataAsync",e[e.DisplayReplyFormWithAttachments=30]="DisplayReplyFormWithAttachments",e[e.DisplayReplyAllFormWithAttachments=31]="DisplayReplyAllFormWithAttachments",e[e.SaveAsync=32]="SaveAsync",e[e.AddNotificationMessageAsync=33]="AddNotificationMessageAsync",e[e.GetAllNotificationMessagesAsync=34]="GetAllNotificationMessagesAsync",e[e.ReplaceNotificationMessageAsync=35]="ReplaceNotificationMessageAsync",e[e.RemoveNotificationMessageAsync=36]="RemoveNotificationMessageAsync",e[e.GetBodyAsync=37]="GetBodyAsync",e[e.SetBodyAsync=38]="SetBodyAsync",e[e.RegisterConsentAsync=40]="RegisterConsentAsync",e[e.Close=41]="Close",e[e.CloseApp=42]="CloseApp",e[e.DisplayNewMessageForm=44]="DisplayNewMessageForm",e[e.EventCompleted=94]="EventCompleted",e[e.CloseContainer=97]="CloseContainer",e[e.GetAccessTokenAsync=98]="GetAccessTokenAsync",e[e.GetInitializationContextAsync=99]="GetInitializationContextAsync",e[e.AppendOnSendAsync=100]="AppendOnSendAsync",e[e.GetRecurrenceAsync=103]="GetRecurrenceAsync",e[e.SetRecurrenceAsync=104]="SetRecurrenceAsync",e[e.GetFromAsync=107]="GetFromAsync",e[e.GetSharedPropertiesAsync=108]="GetSharedPropertiesAsync",e[e.MESSAGE_PARENT_DISPID=144]="MESSAGE_PARENT_DISPID",e[e.SEND_MESSAGE_DIALOG_DISPID=145]="SEND_MESSAGE_DIALOG_DISPID",e[e.GetAttachmentsAsync=149]="GetAttachmentsAsync",e[e.AddBase64FileAttachmentAsync=148]="AddBase64FileAttachmentAsync",e[e.GetAttachmentContentAsync=150]="GetAttachmentContentAsync",e[e.GetInternetHeadersAsync=151]="GetInternetHeadersAsync",e[e.SetInternetHeadersAsync=152]="SetInternetHeadersAsync",e[e.RemoveInternetHeadersAsync=153]="RemoveInternetHeadersAsync",e[e.GetEnhancedLocationsAsync=154]="GetEnhancedLocationsAsync",e[e.AddEnhancedLocationsAsync=155]="AddEnhancedLocationsAsync",e[e.RemoveEnhancedLocationsAsync=156]="RemoveEnhancedLocationsAsync",e[e.GetCategoriesAsync=157]="GetCategoriesAsync",e[e.AddCategoriesAsync=158]="AddCategoriesAsync",e[e.RemoveCategoriesAsync=159]="RemoveCategoriesAsync",e[e.GetMasterCategoriesAsync=160]="GetMasterCategoriesAsync",e[e.AddMasterCategoriesAsync=161]="AddMasterCategoriesAsync",e[e.RemoveMasterCategoriesAsync=162]="RemoveMasterCategoriesAsync",e[e.GetItemIdAsync=164]="GetItemIdAsync",e[e.GetAllInternetHeadersAsync=168]="GetAllInternetHeadersAsync",e[e.SaveSettingsRequest=404]="SaveSettingsRequest",e[e.SetSignatureAsync=173]="SetSignatureAsync",e[e.GetComposeTypeAsync=174]="GetComposeTypeAsync",e[e.IsClientSignatureEnabledAsync=175]="IsClientSignatureEnabledAsync",e[e.DisableClientSignatureAsync=176]="DisableClientSignatureAsync",e[e.displayNewAppointmentFormAsync=177]="displayNewAppointmentFormAsync",e[e.displayNewMessageFormAsync=178]="displayNewMessageFormAsync",e[e.displayMessageFormAsync=179]="displayMessageFormAsync",e[e.displayAppointmentFormAsync=180]="displayAppointmentFormAsync",e[e.displayReplyFormWithAttachmentsAsync=181]="displayReplyFormWithAttachmentsAsync",e[e.displayReplyAllFormWithAttachmentsAsync=182]="displayReplyAllFormWithAttachmentsAsync",e[e.displayReplyFormAsync=183]="displayReplyFormAsync",e[e.displayReplyAllFormAsync=184]="displayReplyAllFormAsync",e[e.setSessionDataAsync=185]="setSessionDataAsync",e[e.getSessionDataAsync=186]="getSessionDataAsync",e[e.getAllSessionDataAsync=187]="getAllSessionDataAsync",e[e.clearSessionDataAsync=188]="clearSessionDataAsync",e[e.removeSessionDataAsync=189]="removeSessionDataAsync"}(ln||(ln={}));var fn=function(e,t){this.apiMethodDelegate=e,this.apiPermissionRequired=t},pn=((un={})[ln.GetInitialData]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var n;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,Xt(t,e)];case 1:return n=r.sent(),Object(qt.m)(!0,Object(m.m)(t),e,Object(m.q)(t),Object(m.E)(e,t),t),a(n),[2]}}))}))}),0),un[ln.EwsRequest]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var e,o,i,s,c;return Object(r.f)(this,(function(r){switch(r.label){case 0:return!(e=n.body)||e.length>Qe?(a(d(l.b.GenericResponseError)),[2]):[4,qe(o=Object(m.m)(t),Ue)];case 1:if(!(i=r.sent()))return a(d(l.b.GenericTokenError)),[2];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Te(e,i.TokenValue,o.extension.Id)];case 3:return s=r.sent(),c=function(e){return{wasProxySuccessful:e.WasProxySuccessful,errorMessage:e.ErrorMessage,statusCode:e.StatusCode,statusDescription:e.StatusDescription,body:e.Body}}(s),a(c),[3,5];case 4:return r.sent(),a(d(l.b.GenericResponseError)),[3,5];case 5:return[2]}}))}))}),2),un[ln.GetRecipientsAsync]=new fn((function(e,t,n,r){r(u(Object(s.c)(e).getRecipients(n.recipientField).slice(0,Kt).map((function(e){return{name:e.Name,address:e.EmailAddress,recipientType:Dt(e.MailboxType)}}))))}),1),un[ln.GetSubjectAsync]=new fn((function(e,t,n,r){r(u(Object(s.c)(e).getSubject()||""))}),1),un[ln.SetSubjectAsync]=new fn((function(e,t,n,r){if(n.subject.length>cn)r(d(null));else{var a=Object(s.c)(e);f(a,r)||(a.setSubject(n.subject),r(u()))}}),3),un[ln.SetRecipientsAsync]=new fn((function(e,t,n,r){var a=Object(s.c)(e);if(!f(a,r)){var o=U(n.recipientArray);try{a.setRecipients(n.recipientField,o),r(u())}catch(e){r(d(e.errorCode))}}}),3),un[ln.AddRecipientsAsync]=new fn((function(e,t,n,r){var a=Object(s.c)(e);if(!f(a,r)){var o=U(n.recipientArray);try{a.addRecipients(n.recipientField,o),r(u())}catch(e){r(d(e.errorCode))}}}),3),un[ln.SaveSettingsRequest]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var o,i,s;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(o=n[0],(i=JSON.stringify(o)).length>sn)return a(d(l.b.GenericSettingsError)),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),s=Object(m.m)(t),[4,(c=s.extension.Id,f=s.extension.Version,p=i,on({request:{ExtensionId:c,ExtensionVersion:f,Settings:p}}))];case 2:return r.sent(),Object(m.ob)(e,t,i),a(u()),[3,4];case 3:return r.sent(),a(d(l.b.GenericSettingsError)),[3,4];case 4:return[2]}var c,f,p}))}))}),0),un[ln.GetAccessTokenAsync]=new fn((function(e,t,n,r){if(Object(tt.a)())r($e(Q.SSOUnsupportedPlatform));else if(function(e){return!!Object(m.F)(e)}(t))if(J())r($e(Q.AddinIsAlreadyRequestingToken));else if(Object(m.I)(e))r($e(Q.InternalError));else if(function(e,t){var n=Object(m.F)(e);n&&(n=n.toLowerCase().replace("api://","https://"));var r=et(n),a=et(t),o=et(window.location.href);return!r||!a||r.toLowerCase()!=a.toLowerCase()&&a!=o}(t,n.SecurityOrigin))r($e(Q.InvalidResourceUrl));else{var a=n.allowConsentPrompt;if(n.forMSGraphAccess){var i=Object(m.m)(t);if(Object(m.R)(null==i?void 0:i.extension))return void r($e(Q.SSOUnsupportedPlatform));a=!1}!function(e){K(e)}((function(e,t){r(e?$e(e):function(e){var t;return(t={})[Ye]=o.Success,t[Ze]=e,t}(t))})),ne(t,n.authChallenge,a)}else r($e(Q.NotSsoAgave))}),1),un[ln.GetCallbackToken]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var o,i,c,u;return Object(r.f)(this,(function(r){switch(r.label){case 0:return o=Object(m.m)(t),i=function(e){var t=s.c(e).getItemId();if(!t)return;return vt+t}(e),function(e,t){return e==De&&2==t}(c=n.isRest?De:we,o.extension.RequestedCapabilities)||i?[4,qe(o,c,i)]:(a(d(l.b.CallSaveAsyncBeforeToken)),[2]);case 1:return u=r.sent(),a(u?gt(!0,u.TokenValue):d(l.b.GenericTokenError)),[2]}}))}))}),1),un[ln.GetUserIdentityToken]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var e;return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,qe(Object(m.m)(t),Ne)];case 1:return e=n.sent(),a(e?gt(!0,e.TokenValue):d(l.b.GenericTokenError)),[2]}}))}))}),1),un[ln.MESSAGE_PARENT_DISPID]=new fn((function(e,t,n,r){Object(en.d)(en.a.DISPLAY_DIALOG_DISPID,t,n,(function(){r(u())}))}),0),un[ln.SEND_MESSAGE_DIALOG_DISPID]=new fn((function(e,t,n,r){Object(en.d)(en.a.DIALOG_PARENT_MESSAGE_RECEIVED,t,n,(function(){r(u())}))}),0),un[ln.SetBodyAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return f(t=Object(s.c)(e),a)?[2]:(o=n.coercionType==_n.a.Html?"HTML":"Text",[4,oe(e,0,n,a,(function(e){return t.setBody(e,o)}))]);case 1:return r.sent(),[2]}}))}))}),1),un[ln.GetBodyAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,o,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(t=Object(s.c)(e),o=t.mode,i=null,o!=S.a.MessageRead&&o!=S.a.AppointmentAttendee)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,pt(t.getItem())];case 2:return i=r.sent(),[3,4];case 3:return r.sent(),a(d(l.a.GenericResponseError)),[2];case 4:return[3,6];case 5:o!=S.a.MessageCompose&&o!=S.a.AppointmentOrganizer||(i=t.getBody()),r.label=6;case 6:return n.coercionType==_n.a.Text&&(i=b(i)),a(u(i)),[2]}}))}))}),1),un[ln.GetBodyTypeAsync]=new fn((function(e,t,n,r){var a=Object(s.c)(e).getBodyType();r(u(a&&a.toLowerCase()||null))}),1),un[ln.BodyPrependAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(r){switch(r.label){case 0:return f(t=Object(s.c)(e),a)?[2]:n.coercionType===_n.a.Html&&"Text"===t.getBodyType()?(a(d(l.a.OoeInvalidDataFormat)),[2]):[4,oe(e,0,n,a,t.prependBody)];case 1:return r.sent(),[2]}}))}))}),3),un[ln.Close]=new fn((function(e,t){Object(s.c)(e).close(),Object(ue.a)(e)}),0),un[ln.CloseApp]=new fn(de,0),un[ln.CloseContainer]=new fn(de,0),un[ln.DisplayMessageForm]=new fn(pe,1),un[ln.displayMessageFormAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,pe(e,0,n,a)];case 1:return r.sent(),[3,3];case 2:return t=r.sent(),a(d(t.message.search("ErrorInvalidIdMalformed")<0?t:l.b.ItemNotFound)),[3,3];case 3:return[2]}}))}))}),1),un[ln.DisplayReplyAllForm]=new fn(Se,1),un[ln.displayReplyAllFormAsync]=new fn(_e,1),un[ln.DisplayReplyAllFormWithAttachments]=new fn(Se,1),un[ln.displayReplyAllFormWithAttachmentsAsync]=new fn(_e,1),un[ln.DisplayReplyForm]=new fn(Oe,1),un[ln.displayReplyFormAsync]=new fn(Ie,1),un[ln.DisplayReplyFormWithAttachments]=new fn(Oe,1),un[ln.displayReplyFormWithAttachmentsAsync]=new fn(Ie,1),un[ln.DisplayAppointmentForm]=new fn(fe,1),un[ln.displayAppointmentFormAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(s.c)(e).checkItemId(n.itemId)];case 1:return r.sent(),fe(e,0,n,a),[3,3];case 2:return t=r.sent(),a(d(t.message.search("ErrorInvalidIdMalformed")<0?t:l.b.ItemNotFound)),[3,3];case 3:return[2]}}))}))}),1),un[ln.DisplayNewAppointmentForm]=new fn(ve,1),un[ln.displayNewAppointmentFormAsync]=new fn((function(e,t,n,r){try{ve(e,0,n,r)}catch(e){r(d(e.message.search("ErrorInvalidIdMalformed")<0?e:l.b.ItemNotFound))}}),1),un[ln.DisplayNewMessageForm]=new fn(Ce,1),un[ln.displayNewMessageFormAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Ce(e,0,n,a)];case 1:return r.sent(),[3,3];case 2:return t=r.sent(),a(d(t.message.search("ErrorInvalidIdMalformed")<0?t:l.b.ItemNotFound)),[3,3];case 3:return[2]}}))}))}),1),un[ln.EventCompleted]=new fn((function(e,t,n,r){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(t,n)}),0),un[ln.GetSelectedDataAsync]=new fn((function(e,t,n,r){var a=Object(s.c)(e).getSelectedData();a?(n.coercionType==_n.a.Text&&(a.data=b(a.data)),r(u(a))):r(d(l.a.InvalidSelection))}),1),un[ln.SetSelectedDataAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return f(t=Object(s.c)(e),a)?[2]:null==(o=t.getSelectedData())?(a(d(l.a.InvalidSelection)),[2]):n.coercionType===_n.a.Html&&("subject"===o.sourceProperty||"body"===o.sourceProperty&&"Text"===t.getBodyType())?(a(d(l.a.OoeInvalidDataFormat)),[2]):[4,oe(e,0,n,a,t.setSelectedData,t.getSelectedData)];case 1:return r.sent(),[2]}}))}))}),3),un[ln.SetBodySelectedDataAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(r){switch(r.label){case 0:return f(t=Object(s.c)(e),a)?[2]:[4,oe(e,0,n,a,t.setBodySelectedData,t.getSelectedData)];case 1:return r.sent(),[2]}}))}))}),0),un[ln.SaveAsync]=new fn((function(e,t,n,r){var a=Object(s.c)(e);f(a,r)||a.saveItem().then((function(e){r(e?u(e):d(l.a.SaveError))}))}),3),un[ln.LoadCustomProperties]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var n,o,i,c,u,f,p;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(n=Object(s.c)(e),!(o=n.getItemId()))return a($t("",!0,"{}")),[2];i=Object(m.u)(t),r.label=1;case 1:return r.trys.push([1,3,,4]),n.isSharedItem&&n.getSharedProperties&&n.isSharedItem()&&n.isRemoteItem()&&(u=n.getSharedProperties(),c=u.owner),[4,Zt(i,o,c)];case 2:return f=r.sent(),(p=f.CustomProperties)&&(p=p.trim()),p||(p="{}"),a($t(f.ErrorMessage,f.WasSuccessful,p)),[3,4];case 3:return r.sent(),a(d(l.b.GenericResponseError)),[3,4];case 4:return[2]}}))}))}),1),un[ln.SaveCustomProperties]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var o,i,c,p,g,h;return Object(r.f)(this,(function(r){switch(r.label){case 0:o=Object(s.c)(e),i=Object(m.u)(t),c=JSON.stringify(n.customProperties),p=o.getItemId(),r.label=1;case 1:return r.trys.push([1,5,,6]),f(o,a)?[2]:p?[3,3]:[4,o.saveItem()];case 2:p=r.sent(),r.label=3;case 3:return o.isSharedItem&&o.getSharedProperties&&o.isSharedItem()&&o.isRemoteItem()&&(h=o.getSharedProperties(),g=h.owner),[4,an(i,p,g,c)];case 4:return r.sent().WasSuccessful?a(u()):a(d(l.b.GenericResponseError)),[3,6];case 5:return r.sent(),a(d(l.b.GenericResponseError)),[3,6];case 6:return[2]}}))}))}),1),un[ln.AddNotificationMessageAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var o,i,u,f,p,g,h,v,b;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(u=!1,f=Object(s.c)(e),p=f.mode,3===n.type&&!n.actions)return a(d(l.a.InvalidParameterValueError)),[2];if(3===n.type&&n.actions)switch(u=!0,g=Object(m.m)(t),h=g.extension.Id,p){case S.a.MessageRead:case S.a.AppointmentAttendee:return a(d(l.a.OperationNotSupported)),[2];case S.a.MessageCompose:case S.a.AppointmentOrganizer:if(!(o=R(h,n.actions[0].commandId,p)))return a(d(l.a.InvalidParameterValueError)),[2];i={NotificationActionData:n.actions[0],CustomButtonAction:o,CustomButtonIcon:o.get_Size16Icon()}}return[4,y(e,t,n.persistent,n.key,n.type,n.message,n.icon,!0,i)];case 1:return v=r.sent(),b=Object(m.m)(t),Object(N.s)("ShowNotificationBar",{Id:b.extension.Id,DisplayName:b.extension.DisplayName,Scenario:Object(m.A)(e),extPoint:Object(m.q)(t),IsClickableInfobar:u,error:v instanceof c.a?JSON.stringify(v):"",mode:p}),a(v),[2]}}))}))}),1),un[ln.GetAllNotificationMessagesAsync]=new fn((function(e,t,n,a){a(u(Object(s.c)(e).getNotificationMessageIds().reduce((function(e,t){var n=Object(g.e)(t);return n&&e.push(function(e){return Object(r.a)({key:e.Key,type:v(e.Type),message:e.Message,icon:e.Icon},e.Persistent&&2!==e.Type&&{persistent:!0})}(n)),e}),[])))}),1),un[ln.RemoveNotificationMessageAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,h(e,t,n.key)];case 1:return o=r.sent(),a(o),[2]}}))}))}),1),un[ln.ReplaceNotificationMessageAsync]=new fn((function(e,t,n,a){var o,i;return Object(r.c)(this,void 0,void 0,(function(){var u,f,p,g,h,v,b,C,A;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(p=!1,g=Object(s.c)(e),h=g.mode,3===n.type&&!n.actions)return a(d(l.a.InvalidParameterValueError)),[2];if(3===n.type&&n.actions)switch(p=!0,v=Object(m.m)(t),b=v.extension.Id,h){case S.a.MessageRead:case S.a.AppointmentAttendee:return a(d(l.a.OperationNotSupported)),[2];case S.a.MessageCompose:case S.a.AppointmentOrganizer:if(!(u=R(b,n.actions[0].commandId,h)))return a(d(l.a.InvalidParameterValueError)),[2];f={NotificationActionData:n.actions[0],CustomButtonAction:u,CustomButtonIcon:u.get_Size16Icon()}}return[4,y(e,t,n.persistent,n.key,n.type,n.message,n.icon,!1,f)];case 1:return C=r.sent(),A=Object(m.m)(t),Object(N.s)("ShowNotificationBar",{Id:null===(o=null==A?void 0:A.extension)||void 0===o?void 0:o.Id,DisplayName:null===(i=null==A?void 0:A.extension)||void 0===i?void 0:i.DisplayName,Scenario:Object(m.A)(e),extPoint:Object(m.q)(t),IsClickableInfobar:p,error:C instanceof c.a?JSON.stringify(C):"",mode:h}),a(C),[2]}}))}))}),1),un[ln.AddItemAttachmentAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,o,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:t=Object(s.c)(e),r.label=1;case 1:return r.trys.push([1,3,,4]),f(t,a)?[2]:[4,t.addItemAttachment(n.name,n.itemId,n.isInline)];case 2:return o=r.sent(),a(o?u(o):d(l.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return i=r.sent(),a(d(i)),[3,4];case 4:return[2]}}))}))}),3),un[ln.AddFileAttachmentAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:t=Object(s.c)(e),r.label=1;case 1:return r.trys.push([1,3,,4]),f(t,a)?[2]:[4,t.addFileAttachment(n.name,n.uri,n.isInline)];case 2:return o=r.sent(),a(o?u(o):d(l.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return r.sent(),a(d(l.a.AttachmentUploadGeneralFailure)),[3,4];case 4:return[2]}}))}))}),3),un[ln.AddBase64FileAttachmentAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,o,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:t=Object(s.c)(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.addFileAttachmentFromBase64(n.base64String,n.name,n.isInline)];case 2:return o=r.sent(),a(o?u(o):d(l.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return i=r.sent(),a(d(i.errorCode)),[3,4];case 4:return[2]}}))}))}),3),un[ln.RemoveAttachmentAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(!n||!n.attachmentIndex)return a(d(l.a.InvalidAttachmentId)),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),f(t=Object(s.c)(e),a)?[2]:[4,t.removeAttachment(n.attachmentIndex)];case 2:return r.sent(),a(u()),[3,4];case 3:return o=r.sent(),a(d(o.errorCode)),[3,4];case 4:return[2]}}))}))}),3),un[ln.GetCategoriesAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,n,o,i,c;return Object(r.f)(this,(function(f){switch(f.label){case 0:t=Object(s.c)(e),n=t.mode,o=null,i=null,f.label=1;case 1:switch(f.trys.push([1,11,,12]),n){case S.a.MessageRead:return[3,2];case S.a.MessageCompose:return[3,4];case S.a.AppointmentAttendee:return[3,5];case S.a.AppointmentOrganizer:return[3,7]}return[3,9];case 2:return[4,t.getCategoriesItem()];case 3:return o=f.sent(),[3,10];case 4:return a(d(l.b.OperationNotSupported)),[2];case 5:return[4,t.getCategoriesItem()];case 6:return o=f.sent(),[3,10];case 7:return[4,t.getCategoriesItem()];case 8:return o=f.sent(),[3,10];case 9:Object(E.a)(n),f.label=10;case 10:return null==o?(a(d(l.b.GenericResponseError)),[2]):(i=function(e){var t,n,a=[];try{for(var o=Object(r.k)(e),i=o.next();!i.done;i=o.next()){var s=i.value,c={displayName:s.Name,color:P.a[s.Color]};a.push(c)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return a}(o),a(u(i)),[3,12]);case 11:return c=f.sent(),a(d(c.errorCode)),[3,12];case 12:return[2]}}))}))}),1),un[ln.AddCategoriesAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,o,i,c,f,p;return Object(r.f)(this,(function(m){switch(m.label){case 0:return t=Object(s.c)(e),o=t.mode,[4,I.u.import()];case 1:if(i=m.sent(),c=i(),function(e,t){var n,a,o=function(e){if(0===t.filter((function(t){return t.Name===e})).length)return{value:!0}};try{for(var i=Object(r.k)(e),s=i.next();!s.done;s=i.next()){var c=s.value,l=o(c);if("object"==typeof l)return l.value}}catch(e){n={error:e}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}return!1}(n.categories,c)||T(n.categories))return a(d(l.a.InvalidCategoryError)),[2];g=n.categories,h=[],g.forEach((function(e){var t,n,a=!1;try{for(var o=Object(r.k)(h),i=o.next();!i.done;i=o.next())i.value===e&&(a=!0)}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}a||h.push(e)})),f=h,m.label=2;case 2:switch(m.trys.push([2,12,,13]),o){case S.a.MessageRead:return[3,3];case S.a.MessageCompose:return[3,5];case S.a.AppointmentAttendee:return[3,6];case S.a.AppointmentOrganizer:return[3,8]}return[3,10];case 3:return[4,t.addCategoriesItemRead(f)];case 4:return m.sent(),[3,11];case 5:return a(d(l.a.OperationNotSupported)),[2];case 6:return[4,t.addCategoriesItemRead(f)];case 7:return m.sent(),[3,11];case 8:return[4,t.addCategoriesItemCompose(f)];case 9:return m.sent(),[3,11];case 10:Object(E.a)(o),m.label=11;case 11:return a(u()),[3,13];case 12:return p=m.sent(),a(d(p.errorCode)),[3,13];case 13:return[2]}var g,h}))}))}),1),un[ln.RemoveCategoriesAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,o,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(t=Object(s.c)(e),o=t.mode,T(n.categories))return a(d(l.a.InvalidCategoryError)),[2];r.label=1;case 1:switch(r.trys.push([1,11,,12]),o){case S.a.MessageRead:return[3,2];case S.a.MessageCompose:return[3,4];case S.a.AppointmentAttendee:return[3,5];case S.a.AppointmentOrganizer:return[3,7]}return[3,9];case 2:return[4,t.removeCategoriesItemRead(n.categories)];case 3:return r.sent(),[3,10];case 4:return a(d(l.a.OperationNotSupported)),[2];case 5:return[4,t.removeCategoriesItemRead(n.categories)];case 6:return r.sent(),[3,10];case 7:return[4,t.removeCategoriesItemCompose(n.categories)];case 8:return r.sent(),[3,10];case 9:Object(E.a)(o),r.label=10;case 10:return a(u()),[3,12];case 11:return i=r.sent(),a(d(i.errorCode)),[3,12];case 12:return[2]}}))}))}),1),un[ln.GetAttachmentContentAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,o,i,c,f;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(!n||!n.id)return a(d(l.a.InvalidAttachmentId)),[2];if(t=null,o=Object(s.c)(e),i=o.mode,!1,c=Object(rt.a)({Id:n.id}),Object(at.a)(c.model)&&(f=c.model.EmbeddedItemClass)&&"IPM.Note"!==f&&"IPM.Appointment"!==f)return a(d(l.a.AttachmentTypeNotSupported)),[2];switch(i){case S.a.MessageRead:return[3,1];case S.a.MessageCompose:return[3,3];case S.a.AppointmentAttendee:return[3,5];case S.a.AppointmentOrganizer:return[3,7]}return[3,9];case 1:return[4,ot(!0,o,n.id)];case 2:return t=r.sent(),[3,10];case 3:return[4,o.getAttachmentContent(n.id)];case 4:return t=r.sent(),[3,10];case 5:return[4,ot(!1,o,n.id)];case 6:return t=r.sent(),[3,10];case 7:return[4,o.getAttachmentContent(n.id)];case 8:return t=r.sent(),[3,10];case 9:Object(nt.a)(i),r.label=10;case 10:if(null==t)return a(d(l.a.InvalidAttachmentId)),[2];try{a(u(t))}catch(e){a(d(l.a.InvalidAttachmentId))}return[2]}}))}))}),1),un[ln.GetAttachmentsAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,n,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:switch(t=Object(s.c)(e),n=null,o=[],t.mode){case S.a.MessageCompose:return[3,1];case S.a.AppointmentOrganizer:return[3,3]}return[3,5];case 1:return[4,t.getAttachments()];case 2:return n=r.sent(),[3,5];case 3:return[4,t.getAttachments()];case 4:return n=r.sent(),[3,5];case 5:if(null==n)return a(d(l.a.GenericResponseError)),[2];o=n.map((function(e){return{id:e.id,name:e.name,contentType:e.contentType,size:e.size,attachmentType:e.attachmentType,isInline:e.isInline,url:e.url?e.url:void 0}}));try{a(u(o))}catch(e){a(d(e.errorCode))}return[2]}}))}))}),1),un[ln.RegisterConsentAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var o,i,s;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(o=n.consentState,!(i=Object(m.u)(t))||!o)return a(d(l.b.GenericResponseError)),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),Object(m.lb)(e,t,o),[4,nn(i,o)];case 2:return"NoError"===(s=r.sent()).Body.ResponseCode&&"Success"===s.Body.ResponseClass?(a(u()),[2]):(a(d(l.b.GenericResponseError)),[3,4]);case 3:return r.sent(),a(d(l.b.GenericResponseError)),[3,4];case 4:return[2]}}))}))}),0),un[ln.GetLocationAsync]=new fn((function(e,t,n,r){r(u(Object(s.c)(e).getLocation()||""))}),1),un[ln.SetLocationAsync]=new fn((function(e,t,n,r){if(null!=n.location){var a=Object(s.c)(e);f(a,r)||(a.setLocation(n.location),r(u()))}else r(d(null))}),3),un[ln.GetTimeAsync]=new fn((function(e,t,n,r){var a=Object(s.c)(e),o=null;n.TimeProperty===Jt.Start?o=a.getStartTime():n.TimeProperty===Jt.End&&(o=a.getEndTime()),r(u(o))}),1),un[ln.SetTimeAsync]=new fn((function(e,t,n,r){var a=Object(s.c)(e);if(!f(a,r)){var o=new Date(n.time);if(n.TimeProperty===Jt.Start)a.setStartTime(o);else if(n.TimeProperty===Jt.End){if(!a.setEndTime(o))return void r(d(l.a.InvalidEndTime))}r(u())}}),3),un[ln.GetInitializationContextAsync]=new fn((function(e,t,n,a){var o=Object(m.s)().taskPanes.get(e),i="";Object(r.j)([],Object(r.g)(o.values())).forEach((function(e){e.initializationContext&&(i=e.initializationContext)})),a(null!=i&&null!=i?u(i):d())}),1),un[ln.GetFromAsync]=new fn((function(e,t,n,r){var a=Object(s.c)(e).getFrom();r(a?u({name:a.Name,address:a.EmailAddress}):d())}),1),un[ln.GetSharedPropertiesAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,n,o,i,c,l;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(t=Object(s.c)(e),n=t.getSharedProperties(),!t.isRemoteItem())return[3,5];i=n.owner,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,(d=n.owner,new Promise((function(e,t){if(d){var n="https://outlook.office365.com/autodiscover/autodiscover.json/v1.0/"+d+"?Protocol=REST",r=new XMLHttpRequest;r.open("GET",n),r.onload=function(){if(200===r.status){var n=JSON.parse(this.response).Url;e(n)}else t(new Error("Request failed with status "+r.status+". Message: "+r.responseText))},r.send()}else t(new Error("smtpAddress is null or empty"))})))];case 2:return o=r.sent(),[3,4];case 3:return r.sent(),o=void 0,[3,4];case 4:return[3,6];case 5:i=Object(jt.l)(),o=Object(m.r)().RestUrl,r.label=6;case 6:return c=function(e){var t=0;e.Read&&(t+=M.d.Read);e.Create&&(t+=M.d.Create);e.DeleteOwn&&(t+=M.d.DeleteOwn);e.DeleteAll&&(t+=M.d.DeleteAll);e.EditOwn&&(t+=M.d.EditOwn);e.EditAll&&(t+=M.d.EditAll);return t}(n.delegatePermissions),l={delegatePermissions:c,owner:n.owner,targetRestUrl:o,targetMailbox:i},a(u(l)),[2]}var d}))}))}),1),un[ln.GetRecurrenceAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,n,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,(t=Object(s.c)(e)).getRecurrence()];case 1:return n=r.sent(),o=Object(kt.a)({recurrenceType:n,timeZone:t.getTimeZoneName(),endTime:t.getEndTime(),startTime:t.getStartTime()}),a(u(o)),[2]}}))}))}),1),un[ln.SetRecurrenceAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return Object(kt.c)(n.recurrenceData)?f(t=Object(s.c)(e),a)?[2]:[4,t.getSeriesId()]:(a(d(l.a.InvalidRecurrence)),[2]);case 1:return null!=r.sent()?(a(d(l.a.SetRecurrenceOnInstance)),[2]):(null==(o=Object(kt.b)(n.recurrenceData))?t.setRecurrence(null):(t.setTimeZoneName(o.timeZone),t.setStartTime(o.startTime),t.setEndTime(o.endTime),t.setRecurrence(o.recurrenceType)),a(u()),[2])}}))}))}),3),un[ln.GetInternetHeadersAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n&&Object(M.i)(n.internetHeaderKeys)?[4,Object(s.c)(e).getInternetHeaders(n.internetHeaderKeys)]:(a(d()),[2]);case 1:return t=r.sent(),a(u(t)),[2]}}))}))}),1),un[ln.SetInternetHeadersAsync]=new fn((function(e,t,n,r){if(n&&Object(M.h)(n.internetHeaderNameValuePairs)){var a=Object(s.c)(e);f(a,r)||(a.setInternetHeaders(n.internetHeaderNameValuePairs),r(u()))}else r(d())}),1),un[ln.RemoveInternetHeadersAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n&&Object(M.i)(n.internetHeaderKeys)?f(t=Object(s.c)(e),a)?[2]:[4,t.removeInternetHeaders(n.internetHeaderKeys)]:(a(d()),[2]);case 1:return r.sent(),a(u()),[2]}}))}))}),1),un[ln.AppendOnSendAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var o,i,c,u,p,g;return Object(r.f)(this,(function(r){switch(r.label){case 0:return null!=(o=Object(m.m)(t))&&o.extension?(o.extension.ExtendedPermissions?o.extension.ExtendedPermissions.map((function(e){return e.toLowerCase()})):[]).indexOf("appendonsend")<=-1?(a(d(l.a.MissingExtendedPermissionsForAPIError)),[2]):(i=Object(s.c)(e),c=i.mode,Object(se.i)("rp-appendOnSend")&&c!=S.a.MessageRead&&c!=S.a.AppointmentAttendee?(u=n.appendTxt)&&u.length>ce?(a(d(l.a.OoeInvalidDataFormat)),[2]):f(i,a)?[2]:n.coercionType===_n.a.Html&&"Text"===i.getBodyType()?(a(d(l.a.OoeInvalidDataFormat)),[2]):null==(p=Object(m.u)(t))||Object(ie.a)(p,t)?(a(d(l.a.ApiCallNotSupportedByExtensionPoint)),[2]):(g={id:p,typ:n.coercionType,txt:u},n.appendOnSend=g,[4,oe(e,0,n,a,i.appendOnSend)]):(a(d(l.a.OperationNotSupported)),[2])):(a(d(l.a.GenericResponseError)),[2]);case 1:return r.sent(),[2]}}))}))}),3),un[ln.GetEnhancedLocationsAsync]=new fn((function(e,t,n,r){var a=Object(s.c)(e).getEnhancedLocations();!a||a.length<=0?r(u([])):r(u(a.map(M.g)))}),1),un[ln.AddEnhancedLocationsAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(f(t=Object(s.c)(e),a))return[2];if(!n||!Object(M.j)(n.enhancedLocations))return a(d()),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.addEnhancedLocations(n.enhancedLocations)];case 2:return r.sent(),a(u()),[3,4];case 3:return r.sent(),a(d()),[3,4];case 4:return[2]}}))}))}),3),un[ln.RemoveEnhancedLocationsAsync]=new fn((function(e,t,n,r){var a=Object(s.c)(e);n&&Object(M.j)(n.enhancedLocations)?(a.removeEnhancedLocations(n.enhancedLocations),r(u())):r(d())}),3),un[ln.GetMasterCategoriesAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,n,o,i,c;return Object(r.f)(this,(function(r){switch(r.label){case 0:t=Object(s.c)(e),n=t.mode,o=[],i=null,r.label=1;case 1:switch(r.trys.push([1,8,,9]),n){case S.a.MessageRead:case S.a.MessageCompose:return[3,2];case S.a.AppointmentAttendee:case S.a.AppointmentOrganizer:return[3,4]}return[3,6];case 2:return[4,t.getCategoriesMailbox()];case 3:return o=r.sent(),[3,7];case 4:return[4,t.getCategoriesMailbox()];case 5:return o=r.sent(),[3,7];case 6:Object(E.a)(n),r.label=7;case 7:return null==o||null==o?(a(d(l.b.GenericResponseError)),[2]):(i=o.map((function(e){return{displayName:e.Name,color:P.a[e.Color]}})),a(u(i)),[3,9]);case 8:return c=r.sent(),a(d(c.errorCode)),[3,9];case 9:return[2]}}))}))}),2),un[ln.AddMasterCategoriesAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,o,i,c,f;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),(t=Object(s.c)(e)).isSharedItem()?(a(d(l.b.InsufficientItemPermissions)),[2]):([],o=n.categoryDetails.map((function(e){return{Name:e.displayName,Id:Object(k.a)(),Color:P.a[e.color]}})),(i=function(e,t){var n=[];return e.forEach((function(e){var t=e.Name.length;if(0===t||t>255)return null;for(var r=!1,a=0;a<n.length;a++)n[a].Name==e.Name&&(n[a].Color=e.Color,r=!0);r||n.push(e)})),n}(o))?function(e){for(var t=Object(I.o)(),n=function(n){if(t.filter((function(t){return t.Name===e[n].Name})).length>0)return{value:!0}},r=0;r<e.length;r++){var a=n(r);if("object"==typeof a)return a.value}return!1}(i)?(a(d(l.b.DuplicateCategoryError)),[2]):[4,t.addCategoriesMailbox(i)]:(a(d(l.b.InvalidCategoryError)),[2]));case 1:return c=r.sent(),a(c?u():d(l.b.GenericResponseError)),[3,3];case 2:return f=r.sent(),a(d(f.errorCode)),[3,3];case 3:return[2]}}))}))}),2),un[ln.RemoveMasterCategoriesAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,o,i,c;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),(t=Object(s.c)(e)).isSharedItem())return a(d(l.b.InsufficientItemPermissions)),[2];for(o=0;o<n.categories.length;o++)if(0===(i=n.categories[o].length)||i>255)return a(d(l.b.InvalidCategoryError)),[2];return[4,t.removeCategoriesMailbox(n.categories)];case 1:return c=r.sent(),a(c?u():d(l.b.GenericResponseError)),[3,3];case 2:return r.sent(),a(d()),[3,3];case 3:return[2]}}))}))}),2),un[ln.GetItemIdAsync]=new fn((function(e,t,n,r){var a=Object(s.c)(e).getItemId();r(a?u(a):d(l.a.ItemNotSavedError))}),1),un[ln.GetAllInternetHeadersAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,Object(s.c)(e).getAllInternetHeaders()];case 1:return t=n.sent(),a(null==t?d(l.a.GenericResponseError):u(t)),[2]}}))}))}),1),un[ln.SetSignatureAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(r){switch(r.label){case 0:return Object(se.i)("addin-signatureScenario")?n.data.length>dn?(a(d(l.a.OoeInvalidDataFormat)),[2]):(t=Object(s.c)(e),n.coercionType===_n.a.Html&&"Text"===t.getBodyType()?(a(d(l.a.OoeInvalidDataFormat)),[2]):f(t,a)?[2]:t.mode!==S.a.MessageCompose?(a(d(Q.OperationNotSupported)),[2]):[4,oe(e,0,n,a,(function(e){return t.setSignature(e)}))]):(a(d(l.a.OperationNotSupported)),[2]);case 1:return r.sent(),[2]}}))}))}),3),un[ln.GetComposeTypeAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,n,o;return Object(r.f)(this,(function(r){if(!Object(se.i)("addin-signatureScenario"))return a(d(l.b.OperationNotSupported)),[2];t=Object(s.c)(e),n=t.mode;try{if(n!==S.a.MessageCompose)return a(d(l.b.OperationNotSupported)),[2];void 0,o=t.getComposeTypeAndCoercionType(),a(u(o))}catch(e){a(d(e.errorCode))}return[2]}))}))}),1),un[ln.IsClientSignatureEnabledAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,n,o;return Object(r.f)(this,(function(r){if(!Object(se.i)("addin-signatureScenario"))return a(d(l.b.OperationNotSupported)),[2];t=Object(s.c)(e),n=t.mode;try{if(n!==S.a.MessageCompose)return a(d(l.b.OperationNotSupported)),[2];void 0,o=t.isClientSignatureEnabled(),a(u(o))}catch(e){a(d(e.errorCode))}return[2]}))}))}),1),un[ln.DisableClientSignatureAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var t,n,o,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(!Object(se.i)("addin-signatureScenario"))return a(d(l.b.OperationNotSupported)),[2];t=Object(s.c)(e),n=t.mode,r.label=1;case 1:return r.trys.push([1,5,,6]),n!==S.a.MessageCompose?[3,3]:(o=void 0,[4,t.disableClientSignature()]);case 2:return o=r.sent(),a(u(o)),[2];case 3:return a(d(l.b.OperationNotSupported)),[2];case 4:return[3,6];case 5:return i=r.sent(),a(d(i.errorCode)),[3,6];case 6:return[2]}}))}))}),3),un[ln.setSessionDataAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var o,i;return Object(r.f)(this,(function(r){if(o=Object(s.c)(e),!(i=Object(m.m)(t))||!o)return a(d()),[2];try{o.setSessionDataState(n.name,n.value,i.get_Id()),a(u())}catch(e){a(d(e))}return[2]}))}))}),3),un[ln.getSessionDataAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var o,i,c;return Object(r.f)(this,(function(r){if(o=Object(m.m)(t),i=Object(s.c)(e),!o||!i)return a(d()),[2];try{c=i.getSessionDataState(n.name,o.get_Id()),a(u(c))}catch(e){a(d(e))}return[2]}))}))}),3),un[ln.getAllSessionDataAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var n,o,i;return Object(r.f)(this,(function(r){if(n=Object(m.m)(t),o=Object(s.c)(e),!n||!o)return a(d()),[2];try{i=o.getAllSessionDataState(n.get_Id()),a(u(i))}catch(e){a(d(e))}return[2]}))}))}),3),un[ln.clearSessionDataAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var n,o;return Object(r.f)(this,(function(r){if(n=Object(m.m)(t),o=Object(s.c)(e),!n||!o)return a(d()),[2];try{o.clearSessionDataState(n.get_Id()),a(u())}catch(e){a(d(e))}return[2]}))}))}),3),un[ln.removeSessionDataAsync]=new fn((function(e,t,n,a){return Object(r.c)(this,void 0,void 0,(function(){var o,i;return Object(r.f)(this,(function(r){if(o=Object(m.m)(t),i=Object(s.c)(e),!o||!i)return a(d()),[2];try{i.removeSessionDataState(n.name,o.get_Id()),a(u())}catch(e){a(d(e))}return[2]}))}))}),3),un),mn=[ln.DisplayAppointmentForm,ln.DisplayMessageForm,ln.DisplayNewAppointmentForm,ln.DisplayNewMessageForm,ln.MESSAGE_PARENT_DISPID];var gn=n(9850);function hn(e,t,n,r,a){if(pn[t]&&pn[t].apiMethodDelegate){var o=pn[t].apiMethodDelegate,i=Object(m.m)(n),s="ExecuteApiMethod";if(!_(e))return Object(N.s)("ExtExecuteApiMethodNoItemFailure",[t]),void a(d(l.b.GenericResponseError));if(!function(e,t){var n,r=Object(m.m)(e),a=!1,o=null===(n=null==r?void 0:r.extension)||void 0===n?void 0:n.RequestedCapabilities;switch(t){case 0:a=!0;break;case 1:1!=o&&3!=o&&2!=o||(a=!0);break;case 3:3!=o&&2!=o||(a=!0);break;case 2:2==o&&(a=!0)}return a}(n,pn[t].apiPermissionRequired))return Object(N.s)("ExtExecuteApiMethodInsufficientPermissions",[t]),void a(d(l.b.InsufficientItemPermissions));var c=function(e,t){var n=Object(m.m)(e),r=Object(m.K)(n),a=mn.includes(t);return!(!r||!a)}(n,t);if(Object(se.i)("addin-autoRun")&&c)return Object(N.s)("ExtExecuteApiMethodNotSupportedInAutorun",[t]),void a(d(l.b.ApiCallNotSupportedByExtensionPoint));var u=Object(gn.a)();try{o(e,n,r,(function(r){var o=null;r&&(r.errorCode?o=r.errorCode:r.Error&&(o=r.Error));var c=Object(gn.a)();Object(N.s)(s,{dispId:t,Id:i.extension.Id,DisplayName:i.extension.DisplayName,owa_1:Object(Bt.j)(),owa_2:Object(m.A)(e),extPoint:Object(m.q)(n),owa_4:i.extension.Type,apiExecutionTime:c-u,isAutoRun:Object(m.K)(i),errorCode:o}),a(r)}))}catch(r){var f=Object(gn.a)();Object(N.s)(s,{dispId:t,Id:i.extension.Id,DisplayName:i.extension.DisplayName,owa_1:Object(Bt.j)(),owa_2:Object(m.A)(e),extPoint:Object(m.q)(n),owa_4:i.extension.Type,apiExecutionTime:f-u,isAutoRun:Object(m.K)(i),error:JSON.stringify(r)}),a(d(l.b.InternalServerError))}}}function vn(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(r.a)({__type:"GetExtensibilityContextParameters:#Exchange"},n))),Object(j.a)("GetExtensibilityContext",e,t)}function yn(e,t,n,r,a){return vn({request:{FormFactor:e,ClientLanguage:t,IncludeDisabledExtensions:n,ApiVersionSupported:r,ClientOverrideVersion:a}})}function bn(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.a)({__type:"GetAllClientExtensionsNotificationsJsonRequest:#Exchange"},n)),Object(j.a)("GetAllClientExtensionsNotifications",e,t)}function Cn(e){var t,n=(t={ItemId:e},Object(r.a)({__type:"GetAllClientExtensionsNotificationsRequest:#Exchange"},t));return bn({Header:Object(Re.b)(),Body:n})}function An(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return t=Object(s.c)(e),n={Id:t.getItemId()},t.addNotificationMessage?(Object(g.c)(e).map(t.addNotificationMessage),[4,Cn(n).catch(Sn)]):[2];case 1:return(o=r.sent())&&(o.Body.Apps||[]).forEach((function(n){var r=!1;n.Notifications.forEach((function(o){var i={ExtensionId:n.Id,Persistent:!0,Key:o.Key,Type:o.Type,Message:o.Message,Icon:o.Icon};2===o.Type&&(i.Persistent=!1,r=!0);var s=a(e,n.Id,o.Key);Object(g.a)(e,n.Id,s,i),t.addNotificationMessage(s)})),r&&Object(i.a)(e,n.Id)})),[2]}}))}))}function Sn(){return null}var _n=n(4089);n.d(t,"c",(function(){return y})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return A})),n.d(t,"f",(function(){return g.b})),n.d(t,"g",(function(){return _})),n.d(t,"h",(function(){return O})),n.d(t,"i",(function(){return hn})),n.d(t,"j",(function(){return Tt})),n.d(t,"k",(function(){return yn})),n.d(t,"l",(function(){return An})),n.d(t,"m",(function(){return h})),n.d(t,"b",(function(){return Xt})),n.d(t,"a",(function(){return _n.a}))},4496:function(e,t,n){"use strict";var r=function(){return{tenantTokens:["56468f6991c348029c6bba403b444607-7f5d6cd1-7fbe-4ab1-be03-3b2b6aeb3eb4-7696"]}},a=n(2076),o=n(121),i=n(57),s=n(2063),c=n(4),l=function(e,t,n,l,u,d,f){var p=function(e){var t=Object(a.c)(e);if(t.isSharedItem)return t.isSharedItem();return!1}(n),m=!!Object(s.K)(t);if(function(e,t,n,a,l,u,d,f,p){var m,g;f&&(m=f.getExecutionInitTime(),g=f.getExecutionStartTime());var h=new o.b("ExtAddinLaunched",r());h.addCustomData({id:t.extension.Id,name:t.extension.DisplayName,owa_1:Object(c.j)(),owa_2:Object(s.A)(n),owa_3:a,lang:Object(i.j)(),owa_4:t.extension.Type,errorCode:l,delegate:u,isAutoRun:d,executionInitTime:m,executionStartTime:g,controlId:p}),e?h.end():h.endWithError("Timeout",new Error("Add-in failed to load with code: "+l))}(e,t,n,l,f,p,m,u,d),e&&p&&function(e,t){var n=new o.b("ExtDelegateAddinLaunched",r());n.addCustomData({id:e.extension.Id,name:e.extension.DisplayName,owa_1:Object(c.j)(),owa_2:Object(s.A)(t)}),n.end()}(t,n),e&&m){var g=function(e){return e.getLaunchEventType()}(t);!function(e,t,n,a,i){var s,c;a&&(s=a.getQueuePushTime(),c=a.getQueuePopTime());var l=new o.b("ExtAutoRunAddinLaunched",r());l.addCustomData({id:e.extension.Id,name:e.extension.DisplayName,launchEventType:n,autoRunQueuePushTimeTime:s,autorunQueuePopTime:c,controlId:i}),l.end()}(t,0,g,u,d)}};var u=9e5;function d(){var e=r();return e.timeout=u,new o.b("ExtItemSendEvent",e)}function f(e,t){e.addCustomData({owa_1:t}),e.end()}function p(e,t,n){e.addCustomData({reason:m(t),id:n.extension.Id,name:n.extension.DisplayName,module:Object(c.j)()}),e.end()}function m(e){if(e.status===s.d.Success)return e.allowEvent?4:2;switch(e.status){case s.d.TimedOut:return 16;case s.d.FunctionNotFound:return 8;default:return 32}}var g=n(10453),h=n(5377),v=n(2083),y=n(24),b="addin";var C=n(94);function A(e,t,n,r){e.data["Data.SDX.AppState"]=E(n),e.data["Data.SDX.LaunchReason"]=function(e,t){if(Object(s.P)(e.extension.Id,t)||Object(h.d)(e)||Object(s.K)(e))return"Auto";return"Manual"}(t,r),e.data["Data.SDX.CommandPlacement"]=function(e,t,n){var r;if(Object(s.P)(e.extension.Id,n))return"OnSend";if(Object(h.d)(e))return"Persistent";if(Object(s.K)(e))return"LaunchEvent";if(e.detectedEntity)return"Contextual";var o=Object(a.c)(t);return(null===(r=null==o?void 0:o.isAddinPinned)||void 0===r?void 0:r.call(o,e.extension.Id))?"Ribbon":"Overflow"}(t,n,r),e.data["Data.SDX.ActionType"]=function(e){switch(Object(s.q)(e)){case 2:return"ShowTaskpane";case 3:return"ExecuteFunction";case 1:return"Contextual";case 5:return"Dialog";case 4:return"Unknown"}}(r),e.data["Data.SDX.AppInstallOrigin"]=P(t.extension)}function S(e,t,n,r){e.data["Data.SDX.AppState"]=E(n),e.data["Data.SDX.AppInstallOrigin"]=P(t.extension),e.data["Data.SDX.LaunchEventType"]=t.getLaunchEventType(),e.data["Instance.Id"]=r}function _(e,t){var n=Object(s.t)(t);n&&(e.data["Data.SDX.AppInstallOrigin"]=P(n),e.data["Data.SDX.Id"]=n.Id),e.data["Data.SDX.FeatureFlags"]=k()}function O(e,t,n,r){e.data["Data.SDX.AppState"]=T(r);var a=Object(s.t)(t);a&&(e.data["Data.SDX.AppInstallOrigin"]=P(a),e.data["Data.SDX.CommandPlacement"]=n?"Ribbon":"Overflow",e.data["Data.SDX.Id"]=a.Id),e.data["Data.SDX.FeatureFlags"]=k()}function I(e,t,n,r,a){e.data["Data.SDX.AppState"]=T(a);var o=Object(s.t)(t);o&&(e.data["Data.SDX.AppInstallOrigin"]=P(o),e.data["Data.SDX.Id"]=o.Id),e.data["Data.AppTeachingUICalloutAction"]=function(e){switch(e){case"Show":return"Show";case"ClickOnClose":return"ClickOnClose";case"ClickOnGotIt":return"ClickOnGotIt";case"ClickOnCustomize":return"ClickOnCustomize";case"MissNoAnchor":return"MissNoAnchor";case"MissNotSelected":return"MissNotSelected";default:return Object(C.a)(e)}}(r),e.data["Data.AppTeachingUICalloutGoal"]=function(e){switch(e){case"NewAdminDeployment":return"NewAdminDeployment";case"Awareness":return"Awareness";default:return Object(C.a)(e)}}(n),e.data["Data.SDX.FeatureFlags"]=k()}function x(){switch(Object(c.y)()){case"Dogfood":return"Dogfood";case"Microsoft":return"Microsoft";default:return"Production"}}function T(e){switch(e){case v.a.MessageRead:return"MessageRead";case v.a.MessageCompose:return"MessageCompose";case v.a.AppointmentAttendee:return"AppointmentAttendee";case v.a.AppointmentOrganizer:return"AppointmentOrganizer";default:return"Unknown"}}function E(e){var t=Object(a.c)(e);return T(null==t?void 0:t.mode)}function M(){switch(Object(g.a)()){case"outlookCom":return"MsaPuid";case"office365":return"OrgIdPuid";default:return"Unknown"}}function P(e){return"Organization"===e.OriginString?"Organization":"User"===e.OriginString?"User":"Default"===e.OriginString?"Default":"None"}function k(){return(e=[],y.d.forEach((function(t,n){0===n.indexOf(b)&&t&&e.push(n)})),e.sort()).join(",");var e}var R,N,w,D,U,F,L,j,B,H,V=n(1),W="db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439",G=1755;function X(e){return Object(V.c)(this,void 0,void 0,(function(){var t,n;return Object(V.f)(this,(function(r){switch(r.label){case 0:return t={eventName:"Office.Extensibility.Host.AppInstall",telemetryProperties:{ariaTenantToken:W,nexusTenantToken:G},eventFlags:{dataCategories:De,diagnosticLevel:Ue},timestamp:Date.now()},_(n=we(t),e),n.iKey?[4,o.m.importAndExecute(n.iKey,n)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}function q(e,t,n){return Object(V.c)(this,void 0,void 0,(function(){var r,a;return Object(V.f)(this,(function(i){switch(i.label){case 0:return r={eventName:"Office.Extensibility.Host.AppPinning",telemetryProperties:{ariaTenantToken:W,nexusTenantToken:G},eventFlags:{dataCategories:De,diagnosticLevel:Ue},timestamp:Date.now()},O(a=we(r),e,t,n),a.iKey?[4,o.m.importAndExecute(a.iKey,a)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}function z(e,t,n,r){return Object(V.c)(this,void 0,void 0,(function(){var a,i;return Object(V.f)(this,(function(s){switch(s.label){case 0:return a={eventName:"Office.Extensibility.Host.AppTeachingUICallout",telemetryProperties:{ariaTenantToken:W,nexusTenantToken:G},eventFlags:{dataCategories:De,diagnosticLevel:Ue},timestamp:Date.now()},I(i=we(a),e,t,n,r),i.iKey?[4,o.m.importAndExecute(i.iKey,i)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}}))}))}function K(e,t,n){return Object(V.c)(this,void 0,void 0,(function(){var r,a;return Object(V.f)(this,(function(i){switch(i.label){case 0:return r={eventName:"Office.Extensibility.Host.LaunchEvent",telemetryProperties:{ariaTenantToken:W,nexusTenantToken:G},eventFlags:{dataCategories:De,diagnosticLevel:Ue},timestamp:Date.now()},S(a=we(r),e,t,n),a.iKey?[4,o.m.importAndExecute(a.iKey,a)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}function J(e,t){return{name:e,dataType:1,value:t,classification:4}}function Q(e,t){return{name:e,dataType:2,value:t,classification:4}}function Y(e,t){return{name:e,dataType:0,value:t,classification:4}}N=R||(R={}),w="Office.System.Result",N.getFields=function(e,t){var n=[];return n.push(Q(e+".Code",t.code)),void 0!==t.type&&n.push(Y(e+".Type",t.type)),void 0!==t.tag&&n.push(Q(e+".Tag",t.tag)),void 0!==t.isExpected&&n.push(J(e+".IsExpected",t.isExpected)),n.push(Y("zC.Activity.Result",w)),n},(U=D||(D={})).contractName="Office.System.Activity",U.getFields=function(e){var t=[];return void 0!==e.cV&&t.push(Y("Activity.CV",e.cV)),t.push(Q("Activity.Duration",e.duration)),t.push(Q("Activity.Count",e.count)),t.push(Q("Activity.AggMode",e.aggMode)),void 0!==e.success&&t.push(J("Activity.Success",e.success)),void 0!==e.result&&t.push.apply(t,R.getFields("Activity.Result",e.result)),t.push(Y("zC.Activity",U.contractName)),t},(F||(F={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Y(e+".Id",t.id)),void 0!==t.version&&n.push(Y(e+".Version",t.version)),void 0!==t.sessionId&&n.push(Y(e+".SessionId",t.sessionId)),n},(L||(L={})).getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(Y(e+".Alias",t.alias)),void 0!==t.primaryIdentityHash&&n.push(Y(e+".PrimaryIdentityHash",t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(Y(e+".PrimaryIdentitySpace",t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(Y(e+".TenantId",t.tenantId)),void 0!==t.tenantGroup&&n.push(Y(e+".TenantGroup",t.tenantGroup)),void 0!==t.isAnonymous&&n.push(J(e+".IsAnonymous",t.isAnonymous)),n},(j||(j={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(Y(e+".Name",t.name)),void 0!==t.state&&n.push(Y(e+".State",t.state)),n},(B||(B={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Q(e+".Id",t.id)),void 0!==t.name&&n.push(Y(e+".Name",t.name)),void 0!==t.commandSurface&&n.push(Y(e+".CommandSurface",t.commandSurface)),void 0!==t.parentName&&n.push(Y(e+".ParentName",t.parentName)),void 0!==t.triggerMethod&&n.push(Y(e+".TriggerMethod",t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(Q(e+".TimeOffsetMs",t.timeOffsetMs)),n},function(e){e.getFields=function(e,t){var n=[];return n.push(Y(e+".ErrorGroup",t.errorGroup)),n.push(Q(e+".Tag",t.tag)),void 0!==t.code&&n.push(Q(e+".Code",t.code)),void 0!==t.id&&n.push(Q(e+".Id",t.id)),void 0!==t.count&&n.push(Q(e+".Count",t.count)),n}}(H||(H={}));var Z,$=D,ee=R,te=H,ne=j,re=F,ae=B,oe=L;!function(e){!function(e){!function(e){e.Activity=$,e.Result=ee,e.Error=te,e.Funnel=ne,e.Host=re,e.User=oe,e.UserAction=ae}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(Z||(Z={}));var ie,se,ce,le,ue,de,fe,pe=(ie=[],{fireEvent:function(e){ie.forEach((function(t){return t(e)}))},addListener:function(e){e&&ie.push(e)}});function me(e,t,n){pe.fireEvent({level:e,category:t,message:n})}function ge(e,t,n){me(0,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}ce=se||(se={}),le=".",ue=[],de={},ce.setTenantTokens=function(e,t){var n=e.split(le);n.length<2||"Office"!==n[0]||e[e.length-1]===le?me(0,0,(function(){return"Invalid namespace: "+e})):(ue.push({namespace:e,telemetryProperties:t}),ue.sort((function(e,t){return t.namespace.length-e.namespace.length})),de={})},ce.getTenantTokens=function(e){if(e in de)return de[e];for(var t=0;t<ue.length;t++){var n=ue[t].namespace;if(e.substring(0,n.length+1)===n+le)return de[e]=ue[t].telemetryProperties,de[e]}},ce.clear=function(){ue=[],de={}},function(e){var t=9007199254740991,n=-t,r=/^[A-Z][a-zA-Z0-9]*$/,a=/^[a-zA-Z0-9_\.]*$/;function o(e){return void 0!==e&&a.test(e)}function i(e){if(!((t=e.name)&&o(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;2===e.dataType&&s(e.value)}function s(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<n||e>t)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;var t=e.split("."),n=t[t.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(t)&&(a=n,void 0!==a&&r.test(a));var a}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!o(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var t=0;t<e.dataFields.length;t++)i(e.dataFields[t])},e.validateInt=s}(fe||(fe={}));var he="4.0.9",ve=function(){return(ve=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function ye(e){var t={eventName:e.eventName,eventFlags:e.eventFlags};return t.telemetryProperties=e.telemetryProperties?ve({},e.telemetryProperties):{},e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t.dataFields=e.dataFields?e.dataFields.slice():[],t.timestamp=e.timestamp,t}!function(){function e(e,t,n){var r,a;this.telemetrySinks=[],this.persistentDataFields=[],this.config=n||{},e?(this.telemetrySinks=e.telemetrySinks,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=ve(ve({},e.getConfig()),this.config)):this.persistentDataFields.push(Y("OTelJS.Version",he)),t&&(a=this.persistentDataFields).push.apply(a,t)}e.prototype.sendTelemetryEvent=function(e){if(e.telemetryProperties&&(e.telemetryProperties.customerContentVersion||e.telemetryProperties.customerContentType))me(0,0,(function(){return"Customer content"}));else{var t=ye(e);if(!t.telemetryProperties.ariaTenantToken||!t.telemetryProperties.nexusTenantToken){var n=se.getTenantTokens(e.eventName);if(!n)return void me(0,0,(function(){return"No tenant token: "+e.eventName}));t.telemetryProperties.ariaTenantToken=n.ariaTenantToken,t.telemetryProperties.nexusTenantToken=n.nexusTenantToken}this.sendTelemetryEventInternal(t)}},e.prototype.sendCustomerContent=function(e){var t=ye(e);return(!t.telemetryProperties.customerContentVersion||t.telemetryProperties.customerContentVersion>1)&&(t.telemetryProperties.customerContentVersion=1),t.telemetryProperties.ariaTenantToken=void 0,t.telemetryProperties.nexusTenantToken=void 0,t.dataFields.push(Q("EventContent.Type",2)),this.sendTelemetryEventInternal(t)},e.prototype.sendTelemetryEventInternal=function(e){try{if(0===this.telemetrySinks.length)return void me(1,0,(function(){return"No telemetry sinks are attached."}));this.processTelemetryEvent(e)}catch(e){return void ge(0,"SendTelemetryEvent",e)}try{this.telemetrySinks.forEach((function(t){e.telemetryProperties&&e.telemetryProperties.customerContentVersion&&e.telemetryProperties.customerContentType?t.sendCustomerContent&&t.sendCustomerContent(e):t.sendTelemetryEvent(e)}))}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t;e.dataFields&&this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields),this.config.disableValidation||fe.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e)},e.prototype.setTenantToken=function(e,t,n){se.setTenantTokens(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.cloneEvent=function(e){return ye(e)},e.prototype.getConfig=function(){return this.config}}();var be=function(){function e(){this._optionalEventsEnabled=!1}return e.prototype.processEvent=function(e){if(!this._optionalEventsEnabled&&!e.eventFlags)throw new Error(e.eventName+" missing Event Flags");var t=this._optionalEventsEnabled||!!e.eventFlags&&(10===e.eventFlags.diagnosticLevel||110===e.eventFlags.diagnosticLevel||120===e.eventFlags.diagnosticLevel);return t||me(2,1,(function(){return"1DS Data Classification Failed to Send: "+e.eventName})),t},e.prototype.setOptionalEventsEnabled=function(e){this._optionalEventsEnabled=e},e}(),Ce="Data.",Ae="zC.",Se="b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121";function _e(e,t,n){t&&t.forEach((function(t){if(!t.classification||4===t.classification||1===t.classification||n.customerContentEnabled&&32===t.classification){var r,a;switch(r=n.prependDataToken?t.name.substr(0,3)===Ae?Ae+Ce+t.name.substr(3):Ce+t.name:t.name,t.dataType){case 3:a=6;break;case 2:a=4;break;case 4:a=8;break;case 0:return void(e[r]="string"==typeof t.value?t.value.substr(0,25e3):t.value);case 1:default:return void(e[r]=t.value)}var o={value:t.value,propertyType:a};e[r]=o}}))}function Oe(e){return e<10?"0"+e:e.toString()}var Ie=n(11744),xe=function(){return(xe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Te=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],i=0,s=o.length;i<s;i++,a++)r[a]=o[i];return r},Ee=1,Me=function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this.usePartAPlugin=!1;var r=[],a=new be,o=[],i={},s=Object(Ie.d)(),c=(new Date).getTime().toString(),l=function(e,t){if(1===t.eventType)return Se;if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");return e.telemetryProperties.ariaTenantToken},u=function(e,t){return function(e,t){try{return e()}catch(e){return ge(1,"1DS Sink",e),t}}((function(){var a,o,u,d=ye(e);if(function(e){for(var t=0;t<r.length;t++)if(!r[t].processEvent(e))return!1;return!0}(d)){n.eventsProcessed++;var f={"Event.Sequence":{value:n.eventsProcessed,propertyType:4},"Event.Name":d.eventName,"Event.Source":"OTelJS","Event.Time":{value:(u=e.timestamp,o=u?new Date(u):new Date,o.getUTCFullYear()+"-"+Oe(o.getUTCMonth()+1)+"-"+Oe(o.getUTCDate())+"T"+Oe(o.getUTCHours())+":"+Oe(o.getUTCMinutes())+":"+Oe(o.getUTCSeconds())+"."+(a=o.getUTCMilliseconds(),a<10?"00"+a:a<100?"0"+a:a.toString())+"Z"),propertyType:9}};_e(f,d.dataFields,{prependDataToken:!0,customerContentEnabled:1===t.eventType}),f["Event.Id"]=s+"."+n.eventsProcessed;var p="custom";d.eventContract&&(f["Event.Contract"]=d.eventContract.name,p+="."+d.eventContract.name.toLowerCase().replace(/\./g,"_"),_e(f,d.eventContract.dataFields,{prependDataToken:!1,customerContentEnabled:1===t.eventType}));var m={iKey:l(d,t),name:d.eventName,data:f,time:(new Date).toISOString(),baseType:p,ext:{sdk:{seq:n.eventsProcessed,epoch:c}}};return n.usePartAPlugin||(m.data=xe(xe({},m.data),i)),m}}),void 0)};this.getOneDSTelemetryEvent=function(e){return u(e,{eventType:0})},this.getOneDSCustomerContent=function(e){if(t.enableCustomerContent&&e.telemetryProperties.customerContentVersion&&Math.floor(e.telemetryProperties.customerContentVersion)<=Ee&&1===e.telemetryProperties.customerContentType)return u(e,{eventType:1})},this.addPreprocessor=function(e){r.push(e)},this.getPersistentDataFields=function(){return o},this.addPersistentDataFields=function(e){_e(i,e,{prependDataToken:!1,customerContentEnabled:!1}),o=Te(o,e)},this.setOptionalEventsEnabled=function(e){a.setOptionalEventsEnabled(e)},this.setFullEventsEnabled=this.setOptionalEventsEnabled,this.addPersistentDataFields(e),this.addPreprocessor(a)},Pe=n(67),ke=null;function Re(){if(!ke){var e=Object(i.h)(),t=Object(V.j)(Object(V.j)([],Object(V.g)(Z.Office.System.User.getFields("User",{primaryIdentityHash:e.SessionSettings.UserPuid,primaryIdentitySpace:M(),isAnonymous:!1}))),[Y("App.Name","Outlook"),Y("App.Platform","Web"),Y("App.Version",Object(c.r)()),Y("Release.AudienceGroup",x()),Y("Release.Audience",Object(c.y)()),Y("User.TenantId",e.SessionSettings.ExternalDirectoryTenantGuid),Y("User.TenantGroup",(n=Object(g.a)(),"outlookCom"===n||"gmail"===n?"Consumer":"Commercial")),Y("Browser.Name",Object(Pe.a)().browser),Y("Browser.Version",Object(Pe.a)().browserVersion.join(".")),Y("Session.Id",Object(c.H)()),Y("Data.ExEnv",Object(c.y)()),Y("Device.OsBuild","N/A"),Y("Device.OsVersion","N/A")]);ke=new Me(t,{enableCustomerContent:!0})}var n;return ke}function Ne(e){return Re().getOneDSCustomerContent(e)}function we(e){return Re().getOneDSTelemetryEvent(e)}var De=2,Ue=110;n.d(t,"m",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"c",(function(){return A})),n.d(t,"d",(function(){return _})),n.d(t,"e",(function(){return O})),n.d(t,"f",(function(){return I})),n.d(t,"g",(function(){return S})),n.d(t,"n",(function(){return X})),n.d(t,"o",(function(){return q})),n.d(t,"p",(function(){return z})),n.d(t,"q",(function(){return K})),n.d(t,"k",(function(){return Ne})),n.d(t,"l",(function(){return we})),n.d(t,"a",(function(){return De})),n.d(t,"b",(function(){return Ue}))},4532:function(e,t,n){"use strict";var r=n(2431),a=n(2),o=Object(a.action)("setAppPaneUnderlayVisibility",(function(e,t,n,r){return{key:e,isShown:t,shrinkable:n,underlayViewState:r}}));Object(a.mutator)(o,(function(e){var t=e.underlayViewState||Object(r.a)();e.isShown?t.shrinkable.set(e.key,e.shrinkable):t.shrinkable.delete(e.key),t.isShown.set(e.key,e.isShown)})),t.a=o},4607:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2060);function a(e){return(e.__type||e.OwsTypeName)===r.b}},4624:function(e){e.exports=JSON.parse('{"a":"FJa"}')},4710:function(e){e.exports=JSON.parse('{"a":"zJa","b":"AJa"}')},4711:function(e){e.exports=JSON.parse('{"a":"aJa"}')},4712:function(e){e.exports=JSON.parse('{"a":"_Ia"}')},4713:function(e){e.exports=JSON.parse('{"a":"XIa"}')},4715:function(e){e.exports=JSON.parse('{"a":"vJa"}')},4716:function(e){e.exports=JSON.parse('{"a":"cJa"}')},4903:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=-1]="None",e[e.Preset0=0]="Preset0",e[e.Preset1=1]="Preset1",e[e.Preset2=2]="Preset2",e[e.Preset3=3]="Preset3",e[e.Preset4=4]="Preset4",e[e.Preset5=5]="Preset5",e[e.Preset6=6]="Preset6",e[e.Preset7=7]="Preset7",e[e.Preset8=8]="Preset8",e[e.Preset9=9]="Preset9",e[e.Preset10=10]="Preset10",e[e.Preset11=11]="Preset11",e[e.Preset12=12]="Preset12",e[e.Preset13=13]="Preset13",e[e.Preset14=14]="Preset14",e[e.Preset15=15]="Preset15",e[e.Preset16=16]="Preset16",e[e.Preset17=17]="Preset17",e[e.Preset18=18]="Preset18",e[e.Preset19=19]="Preset19",e[e.Preset20=20]="Preset20",e[e.Preset21=21]="Preset21",e[e.Preset22=22]="Preset22",e[e.Preset23=23]="Preset23",e[e.Preset24=24]="Preset24"}(r||(r={}))},4908:function(e){e.exports=JSON.parse('{"a":"BJa","b":"CJa"}')},4909:function(e){e.exports=JSON.parse('{"a":"uJa"}')},4910:function(e){e.exports=JSON.parse('{"a":"bJa"}')},4911:function(e){e.exports=JSON.parse('{"a":"$Ia"}')},4912:function(e){e.exports=JSON.parse('{"a":"YIa"}')},4913:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(57);function a(){return!Object(r.s)()}},4914:function(e,t,n){"use strict";var r=n(2),a=Object(r.createStore)("SurfaceActionsStore",{addinOptionSurfaceItems:{}})();t.a=a},4915:function(e){e.exports=JSON.parse('{"a":"wJa"}')},4916:function(e){e.exports=JSON.parse('{"a":"tJa"}')},4917:function(e){e.exports=JSON.parse('{"a":"sJa"}')},4918:function(e){e.exports=JSON.parse('{"a":"qJa"}')},4919:function(e){e.exports=JSON.parse('{"a":"pJa"}')},4930:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"g",(function(){return g}));var r,a=n(203),o=n(19),i=n(2063),s=n(8297),c=n(4);function l(){return"x"}function u(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");var r=e.split("#"),a=1==r.length?"":e.substr(e.indexOf("#"));return e=e.indexOf("?")>0?r[0]+"&"+t+"="+n+a:r[0]+"?"+t+"="+n+a}function d(){return Object(c.G)()}function f(){return null==r&&(r=Object(a.a)()),r}function p(){return Object(o.a)().UserOptions.TimeZone}function m(e){var t=encodeURIComponent(e),n=unescape(t);return btoa(n)}function g(){Object(i.Z)(!0),Object(s.a)()}n(295)},5192:function(e){e.exports=JSON.parse('{"a":"xIa","c":"yIa","d":"zIa","g":"AIa","i":"BIa","f":"CIa","e":"DIa","h":"EIa","k":"FIa","j":"GIa","l":"HIa","m":"IIa","n":"JIa","o":"KIa","p":"LIa","q":"MIa","r":"NIa","t":"OIa","s":"PIa","u":"QIa","w":"RIa","x":"SIa","y":"TIa","z":"UIa","b":"VIa","v":"WIa"}')},5377:function(e,t,n){"use strict";var r=n(12243),a=n(8295);function o(e){var t=Object(r.a)(e);return Object(a.a)()[t]}var i=n(7533);function s(e){return e.isActionable&&e.control.Action.SupportsPersistence}var c=n(1),l=n(6),u=n(2083),d=n(6349),f=n(12195),p=!1;function m(e){return Object(c.c)(this,void 0,void 0,(function(){var t,n;return Object(c.f)(this,(function(r){switch(r.label){case 0:return Object(d.b)()?e===u.a.AppointmentAttendee||e===u.a.AppointmentOrganizer?[2]:p?[3,2]:[4,Object(f.a)()]:[2];case 1:t=r.sent(),(n=JSON.parse(t)).addins&&(p=!0,n.addins.forEach((function(e){if(function(e){return!Object(l.f)(e.mode)&&!Object(l.f)(e.addinId)&&!Object(l.f)(e.commandId)}(e)){var t={addinId:e.addinId,commandId:e.commandId};Object(a.a)()[e.mode]=t}}))),r.label=2;case 2:return[2]}}))}))}function g(){return p}function h(e){return{addinId:e.extension.Id,commandId:e.control.Id}}var v=n(2063);function y(e){for(var t=Object.keys(Object(a.a)()),n=0;n<t.length;n++){var r=t[n],o=Object(a.a)()[r];o&&e.indexOf(o.addinId)<0&&(Object(i.b)(r,null),Object(v.eb)(o.addinId))}}var b=function(e){var t=o(u.a.MessageRead),n=o(u.a.MessageCompose);return!!(t&&e.extension.Id===t.addinId&&e.get_Id().indexOf(t.commandId)>=0)||!!(n&&e.extension.Id===n.addinId&&e.get_Id().indexOf(n.commandId)>=0)};n.d(t,"c",(function(){return o})),n.d(t,"h",(function(){return i.a})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return m})),n.d(t,"e",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"g",(function(){return y})),n.d(t,"d",(function(){return b}))},6242:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s}));var r=n(2083),a=c();function o(){return a}function i(e){a=e}function s(){a=c()}function c(){return{hostItemIndex:null,mode:r.a.Unknown}}},6329:function(e,t,n){"use strict";var r=n(1),a=n(5),o=60,i=6e4;function s(e){var t=e.split("-");return{year:parseInt(t[0]),month:parseInt(t[1]),day:parseInt(t[2])}}function c(e){var t=Number(e).toFixed(2);return Number(t)}var l="Monday",u="Tuesday",d="Wednesday",f="Thursday",p="Friday",m="Saturday",g="Sunday",h=[l,u,d,f,p].join(" "),v=[m,g].join(" "),y=[h,v].join(" ");function b(e){switch(e){case"mon":return l;case"tue":return u;case"wed":return d;case"thu":return f;case"fri":return p;case"sat":return m;case"sun":return g;case"weekday":return h;case"weekendDay":return v;case"day":return y}return""}function C(e){switch(e){case l:return"mon";case u:return"tue";case d:return"wed";case f:return"thu";case p:return"fri";case m:return"sat";case g:return"sun";case h:return"weekday";case v:return"weekendDay";case y:return"day"}return""}var A=n(79),S="January",_="February",O="March",I="April",x="May",T="June",E="July",M="August",P="September",k="October",R="November",N="December";function w(e){switch(e){case"jan":return S;case"feb":return _;case"mar":return O;case"apr":return I;case"may":return x;case"jun":return T;case"jul":return E;case"aug":return M;case"sep":return P;case"oct":return k;case"nov":return R;case"dec":return N}return""}function D(e){switch(e){case S:return"jan";case _:return"feb";case O:return"mar";case I:return"apr";case x:return"may";case T:return"jun";case E:return"jul";case M:return"aug";case P:return"sep";case k:return"oct";case R:return"nov";case N:return"dec"}return""}var U="First",F="Second",L="Third",j="Fourth",B="Last";function H(e){switch(e){case"first":return U;case"second":return F;case"third":return L;case"fourth":return j;case"last":return B}return""}function V(e){switch(e){case U:return"first";case F:return"second";case L:return"third";case j:return"fourth";case B:return"last"}return""}function W(e){if(null==e.recurrenceType)return null;var t=function(e){var t,n=e.startTime,l=e.endTime,u=e.recurrenceType,d=e.timeZone,f=s(u.RecurrenceRange.StartDate),p=(l.getTime()-n.getTime())/i,m=Object(a.Sb)(d,n.valueOf()).toString().split("T")[1].split(":");t=c(m[0])*o+c(m[1]);var g={startYear:f.year,startMonth:f.month,startDay:f.day,startTimeMin:t,durationMin:p};if(u.RecurrenceRange.EndDate){var h=s(u.RecurrenceRange.EndDate);g=Object(r.a)(Object(r.a)({},g),{endDay:h.day,endMonth:h.month,endYear:h.year})}else g.noEndDate=!0;return g}(e),n={name:e.timeZone,offset:Object(A.h)(e.startTime,e.timeZone)},l=e.recurrenceType.RecurrencePattern;switch(l.__type){case"DailyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval},recurrenceType:"daily",seriesTimeJson:t,recurrenceTimeZone:n}}(l,t,n);case"WeeklyRecurrence:#Exchange":return function(e,t,n){if(1===e.Interval&&"weekday"===C(e.DaysOfWeek))return{recurrenceProperties:void 0,recurrenceType:"weekday",seriesTimeJson:t,recurrenceTimeZone:n};return{recurrenceProperties:{interval:e.Interval,days:e.DaysOfWeek.split(" ").map(C),firstDayOfWeek:C(e.FirstDayOfWeek)},recurrenceType:"weekly",seriesTimeJson:t,recurrenceTimeZone:n}}(l,t,n);case"AbsoluteMonthlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval,dayOfMonth:e.DayOfMonth},recurrenceType:"monthly",seriesTimeJson:t,recurrenceTimeZone:n}}(l,t,n);case"RelativeMonthlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval,dayOfWeek:C(e.DaysOfWeek),weekNumber:V(e.DayOfWeekIndex)},recurrenceType:"monthly",seriesTimeJson:t,recurrenceTimeZone:n}}(l,t,n);case"AbsoluteYearlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:0,dayOfMonth:e.DayOfMonth,month:D(e.Month)},recurrenceType:"yearly",seriesTimeJson:t,recurrenceTimeZone:n}}(l,t,n);case"RelativeYearlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:0,dayOfWeek:C(e.DaysOfWeek),weekNumber:V(e.DayOfWeekIndex),month:D(e.Month)},recurrenceType:"yearly",seriesTimeJson:t,recurrenceTimeZone:n}}(l,t,n)}return null}var G=60;function X(e,t,n,r){var a=Math.floor(r/G);return r-=a*G,new Date(Date.UTC(e,t-1,n,a,r))}function q(e,t){switch(e){case"daily":return function(e){return{__type:"DailyRecurrence:#Exchange",Interval:e.interval}}(t);case"weekday":return{__type:"WeeklyRecurrence:#Exchange",Interval:1,FirstDayOfWeek:"Monday",DaysOfWeek:"Monday Tuesday Wednesday Thursday Friday"};case"weekly":return function(e){return{__type:"WeeklyRecurrence:#Exchange",Interval:e.interval,FirstDayOfWeek:b(e.firstDayOfWeek),DaysOfWeek:e.days.map(b).join(" ")}}(t);case"monthly":return function(e){return e.dayOfMonth?{__type:"AbsoluteMonthlyRecurrence:#Exchange",DayOfMonth:e.dayOfMonth,Interval:e.interval}:{__type:"RelativeMonthlyRecurrence:#Exchange",Interval:e.interval,DaysOfWeek:b(e.dayOfWeek),DayOfWeekIndex:H(e.weekNumber)}}(t);case"yearly":return function(e){return e.dayOfMonth?{__type:"AbsoluteYearlyRecurrence:#Exchange",Month:w(e.month),DayOfMonth:e.dayOfMonth}:{__type:"RelativeYearlyRecurrence:#Exchange",Month:w(e.month),DaysOfWeek:b(e.dayOfWeek),DayOfWeekIndex:H(e.weekNumber)}}(t);default:return null}}function z(e,t,n){return e+"-"+K(t)+"-"+K(n)}function K(e){return e<10?"0"+e:""+e}var J=n(57);function Q(e){if(null==e)return null;var t,n,r,a=e.seriesTimeJson,o=e.recurrenceProperties,i=e.recurrenceType,s=e.recurrenceTimeZone,c=a.startDay,l=a.startMonth,u=a.startYear,d=a.startTimeMin,f=a.durationMin;return t=s?s.name:Object(J.p)(),{recurrenceType:{__type:"RecurrenceType:#Exchange",RecurrenceRange:(n=a,r=z(n.startYear,n.startMonth,n.startDay),n.noEndDate?{__type:"NoEndRecurrence:#Exchange",StartDate:r}:{__type:"EndDateRecurrence:#Exchange",StartDate:r,EndDate:z(n.endYear,n.endMonth,n.endDay)}),RecurrencePattern:q(i,o)},timeZone:t,startTime:X(u,l,c,d),endTime:X(u,l,c,d+f)}}function Y(e){var t=null;e&&(t=JSON.parse(JSON.stringify(e)));var n=null==t?void 0:t.seriesTimeJson;return n&&(n.startTimeMinutes=n.startTimeMin,n.durationMinutes=n.durationMin,delete n.startTimeMin,delete n.durationMin,delete t.seriesTimeJson,t.seriesTime=n),t}function Z(e,t,n){return e>=1601&&t>=1&&t<=12&&n>=1&&n<=31}function $(e,t,n){var r=new Date;return r.setFullYear(e),r.setMonth(t-1),r.setDate(n),r}function ee(e){return null==e||!!e.recurrenceType&&(!(!e.seriesTimeJson||!function(e){if(!e)return!1;if(!Z(e.startYear,e.startMonth,e.startDay))return!1;if(!e.noEndDate){if(!Z(e.endYear,e.endMonth,e.endDay))return!1;if($(e.startYear,e.startMonth,e.startDay)>=$(e.endYear,e.endMonth,e.endDay))return!1}return!(e.startTimeMin<0||e.durationMin<0)}(e.seriesTimeJson))&&!!function(e,t){switch(e){case"daily":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;return!0}(t);case"weekly":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;if(!e.days||e.days.length<1)return!1;if(!e.firstDayOfWeek)return!1;return!0}(t);case"monthly":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;if(e.dayOfMonth&&!e.dayOfWeek&&!e.weekNumber)return!0;if(e.dayOfWeek&&e.weekNumber&&!e.dayOfMonth)return!0;return!1}(t);case"yearly":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;if(!e.month)return!1;if(e.dayOfMonth&&!e.dayOfWeek&&!e.weekNumber)return!0;if(e.dayOfWeek&&e.weekNumber&&!e.dayOfMonth)return!0;return!1}(t);case"weekday":return!t}}(e.recurrenceType,e.recurrenceProperties))}n.d(t,"a",(function(){return W})),n.d(t,"b",(function(){return Q})),n.d(t,"d",(function(){return Y})),n.d(t,"c",(function(){return ee}))},6349:function(e,t,n){"use strict";var r=n(197);function a(){return!Object(r.a)()}function o(){return!Object(r.a)()}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}))},6673:function(e,t,n){"use strict";n.d(t,"h",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"g",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return f}));var r=n(1),a=n(2063);function o(e){return s(e)?c(e).isMenu:e.AddinCommands.size>1}function i(e){return!!s(e)&&c(e).isActionable}function s(e){return 1==e.AddinCommands.size}function c(e){return e.AddinCommands.size>0?Object(r.j)([],Object(r.g)(e.AddinCommands.values()))[0]:null}function l(e){return s(e)?c(e).control.Supertip.Title:""}function u(e){var t=e.DisplayName;s(e)&&(t+=" - "+c(e).control.Supertip.Title);return t}function d(e,t,n){var o,i,s,c,l=a.j.EnabledAddinCommands;if(!l)return null;try{for(var u=Object(r.k)(l.getExtensionPoint(n)),d=u.next();!d.done;d=u.next()){var f=d.value;if(f.Id==e&&f.AddinCommands.size>0)try{for(var p=(s=void 0,Object(r.k)(f.AddinCommands.values())),m=p.next();!m.done;m=p.next()){var g=m.value;if(g.control.Id==t)return g}}catch(e){s={error:e}}finally{try{m&&!m.done&&(c=p.return)&&c.call(p)}finally{if(s)throw s.error}}}}catch(e){o={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}return null}function f(e){return a.j.compliance.isMinor&&(!function(e){return"Default"===e.TypeString}(t=e.extension)&&!function(e){return"Organization"===e.OriginString}(t)&&!function(e){return"Private"===e.TypeString}(t));var t}},6674:function(e){e.exports=JSON.parse('{"b":"D9a","a":"E9a","c":"F9a","g":"G9a","f":"H9a","d":"I9a","e":"J9a"}')},6782:function(e,t,n){"use strict";var r=n(8509),a=n(3573),o=n(7532),i=n(9852),s=n(0),c=n(212),l=n(20),u=n(6674),d=n(6),f=n(11745),p=n(9853),m=n(15560),g=Object(l.a)((function(e){return s.createElement("div",{className:m.divContainer},s.createElement("div",null,Object(d.b)(u.b)," ",s.createElement("a",{href:"",onClick:function(t){t.stopPropagation(),t.preventDefault(),e.onClickUninstall&&e.onClickUninstall(),Object(p.a)()}},Object(d.b)(u.a))))})),h=n(809),v=n(1260),y=n(7743),b=n(1115),C=n(424),A=n(3216),S=n(6673),_=n(8298),O=(n(4008),n(2063)),I=n(15563),x=Object(l.a)((function(e){var t=s.useRef(),n=function(){t.current.focus()},r=Object(O.s)();if(!r.runningContextualAddinCommand)return s.createElement("div",null);var a,o,i=r.contextualCalloutState.contextualAnchor,c=r.runningContextualAddinCommand,l=c.hostItemIndex,u=c.addinCommand,d=(a=r.contextualCalloutState.activeContextualAddinCommands,o=u,a.map((function(e){var t,n=e.get_Id()===o.get_Id();return{key:e.get_Id(),className:n&&I.selected,text:e.detectedEntity.Label,onClick:(t=e,function(){var e=Object(O.s)().runningContextualAddinCommand,n=e.hostItemIndex,r=e.addinCommand;t.get_Id()!==r.get_Id()&&Object(f.a)(n,t)})}}))),p={height:u.detectedEntity.RequestedHeight?u.detectedEntity.RequestedHeight+"px":"350px"},m={};m[13]=n,m[14]=n,m[15]=T;var h=Object(S.f)(u)?s.createElement(g,{onClickUninstall:T}):s.createElement(_.a,{addinCommand:r.runningContextualAddinCommand.addinCommand,controlId:r.runningContextualAddinCommand.controlId,hostItemIndex:l,manifestCacheProvider:y.a,style:p,notifyHostActions:m});return s.createElement(b.a,{gapSpace:0,target:i,onDismiss:T,setInitialFocus:!0,calloutWidth:parseInt("570px"),beakWidth:19,className:I.divContainer},s.createElement(C.a,{className:I.appIcon,iconName:"OfficeAddinsLogo"}),s.createElement("div",{className:I.divider}),s.createElement(A.a,{componentRef:function(e){t.current=e},items:d,className:I.contextualBar,onRenderItem:E,onRenderOverflowButton:M}),s.createElement("div",{className:I.contextualAddinFrame},h))}));function T(){var e=Object(O.s)(),t=e.runningContextualAddinCommand,n=e.activeDialogs,r=e.contextualCalloutState,a=t.hostItemIndex;n.get(a)||(r.contextualAnchor.focus(),Object(O.db)())}function E(e){return s.createElement(h.a,{className:e.className,onClick:e.onClick,text:e.text,ariaLabel:e.text})}function M(e){return s.createElement(v.a,{menuIconProps:{iconName:"More"},menuProps:{items:e},ariaLabel:Object(d.b)(u.c)})}var P=n(15565),k=n(1872),R=n(733),N=n(4141),w=n(2444),D=n(9856),U=n(15566),F=Object(l.a)((function(e){var t,n=s.useContext(w.a),r=Object(D.a)(n),a=Object(O.s)().frameworkComponentHostItemIndexMap.get(r),o=Object(O.s)().activeDialogs.get(a),i=s.useCallback((function(){return L(o.parentControlId)}),[null==o?void 0:o.parentControlId]);if(!o)return s.createElement("div",{className:U.divContainer});if(o.isOpen&&1==o.dialogType){var c=Object(O.m)(o.parentControlId),l=null===(t=null==c?void 0:c.extension)||void 0===t?void 0:t.DisplayName,u={height:o.heightInPercentage+"vh",width:o.widthInPercentage+"vw",overflow:"hidden"},f=Object(d.b)(P.a);f&&(f=f.replace("{0}",l));var p={};return p[15]=L,s.createElement(k.a,{hidden:!o.isOpen,onDismiss:i,dialogContentProps:{type:R.a.close,title:l,closeButtonAriaLabel:f},modalProps:{isBlocking:!0,containerClassName:U.dialogContainer},forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0},s.createElement(_.a,{addinCommand:c,controlId:o.controlId,isDialog:!0,hostItemIndex:o.hostItemIndex,sourceLocation:o.url,manifestCacheProvider:y.b,notifyHostActions:p,style:u}))}return s.createElement("div",{className:U.divContainer})}));function L(e){Object(N.j)({eventDispId:N.a.DISPLAY_DIALOG_DISPID,controlId:e})}var j=n(10333),B=n(15578),H=Object(l.a)((function(e){var t=O.j.activeDialogs.get(e.hostItemIndex),n=!1;t&&t.parentControlId==e.controlId&&2==t.dialogType&&(n=!0);var r=e.addinCommand,a=r.extension.ConsentState,o=r.extension.Type,i=2!=a&&"Preinstalled"==o?B.consentContainer:B.uiLessContainer,c=n?"":B.hiddenContainer;return s.createElement(k.a,{hidden:!1,onDismiss:function(){Object(N.j)({eventDispId:N.a.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID,controlId:e.controlId})},dialogContentProps:{type:R.a.normal,title:r.extension.DisplayName},modalProps:{isBlocking:n,containerClassName:B.dialogContainer,className:c},forceFocusInsideTrap:n,containerClassName:B.dialogContainer,isClickableOutsideFocusTrap:!0},s.createElement("div",{className:i},e.children))})),V=n(1),W=n(15580),G=n(858),X=n(4493),q=n(4496),z=n(15581),K=2,J=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.addDisplayNotification=function(e){Object(X.c)(r.props.hostItemIndex,r.props.controlId,!1,""+r.props.extendedAddinCommand.addinCommand.get_Id()+r.infoBarId++,Object(y.d)(e.infoType),e.description)},r.addGenericErrorNotification=function(){var e=Object(d.c)(Object(d.b)(W.b),r.props.extendedAddinCommand.addinCommand.get_ExtensionDisplayName());Object(X.c)(r.props.hostItemIndex,r.props.controlId,!1,r.props.extendedAddinCommand.addinCommand.get_Id(),2,e,r.props.extendedAddinCommand.addinCommand.get_Size16Icon())},r.invokeAppCommand=function(e,t){r.props.extendedAddinCommand.addinCommandTelemetry.setExecutionStartTime();var n=r.props.extendedAddinCommand.addinCommand.getControl();e&&(n=e,Object(O.hb)(r.props.controlId));var a=n.Action.FunctionName,o=Object(V.a)(Object(V.a)({source:{id:n.Id}},e?t:r.props.extendedAddinCommand.launchEventArgs),{commandMode:e?K:null});r.props.disableProgressBar||r.addProgressNotification(),OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(r.props.controlId,a,o,r.onEventCompleted),Object(O.K)(r.props.extendedAddinCommand.addinCommand)&&Object(q.q)(r.props.extendedAddinCommand.addinCommand,r.props.hostItemIndex,r.props.controlId)},r.onEventCompleted=function(e,t){var n=t?t.completedContext:void 0;Object(O.K)(r.props.extendedAddinCommand.addinCommand)?e!=O.d.TimedOut&&Object(O.S)(r.props.extendedAddinCommand,r.props.controlId,r.props.hostItemIndex,e,n):(r.props.disableProgressBar||r.removeProgressNotification(),e!=O.d.Success&&Object(O.J)(r.props.hostItemIndex)&&r.addGenericErrorNotification(),Object(O.gb)(r.props.controlId,r.props.hostItemIndex,e,n))},r.infoBarId=0,Object(O.K)(t.extendedAddinCommand.addinCommand)&&Object(O.s)().activeAutorunUilessFrames.set(t.controlId,r),r}return Object(V.e)(t,e),t.prototype.removeProgressNotification=function(){Object(X.m)(this.props.hostItemIndex,this.props.controlId,this.props.extendedAddinCommand.addinCommand.get_Id())},t.prototype.addProgressNotification=function(){var e=Object(d.c)(Object(d.b)(W.a),this.props.extendedAddinCommand.addinCommand.get_ExtensionDisplayName(),this.props.extendedAddinCommand.addinCommand.get_Label());Object(X.c)(this.props.hostItemIndex,this.props.controlId,!1,this.props.extendedAddinCommand.addinCommand.get_Id(),1,e)},t.prototype.render=function(){var e={};return e[8]=this.addGenericErrorNotification,s.createElement(_.a,{addinCommand:this.props.extendedAddinCommand.addinCommand,addinCommandTelemetry:this.props.extendedAddinCommand.addinCommandTelemetry,controlId:this.props.controlId,hostItemIndex:this.props.hostItemIndex,manifestCacheProvider:y.a,onInsertOsfControl:this.invokeAppCommand,onDisplayNotification:this.addDisplayNotification,notifyHostActions:e,className:z.uiLessContainer})},t=Object(V.d)([G.observer],t)}(s.Component),Q=Object(l.a)((function(e){var t=[];return Object(O.s)().runningUILessExtendedAddinCommands.forEach((function(e,n){e.forEach((function(e,r){e.addinCommandTelemetry.setExecutionInitTime();var a=e.addinCommand,o=Object(O.K)(a);t.push(s.createElement(H,{hostItemIndex:n,controlId:r,addinCommand:a,key:r},s.createElement(J,{extendedAddinCommand:e,controlId:r,hostItemIndex:n,disableProgressBar:o})))}))})),s.createElement("div",null,t)}));function Y(e,t,n){void 0===n&&(n=window);var r=n.document,a=Object(D.a)(n),o=r.getElementById(a);null==o?(a=Object(D.b)(n),(o=r.createElement("div")).id=a,Object(O.pb)(a,t),r.body.appendChild(o),c.render(s.createElement(s.StrictMode,null,s.createElement(w.a.Provider,{value:n},s.createElement($,{renderTaskPaneInPanel:e}))),o)):Object(O.pb)(a,t)}function Z(e){if(void 0===e&&(e=window),e!=window){var t=e.document,n=Object(D.a)(e),r=t.getElementById(n);if(null==r)return;Object(O.pb)(n),c.unmountComponentAtNode(r),t.body.removeChild(r)}}function $(e){return s.createElement(s.Fragment,null,e.renderTaskPaneInPanel&&s.createElement(j.a,{renderTaskPaneInPanel:!0}),s.createElement(Q,null),s.createElement(x,null),s.createElement(F,null))}var ee=n(11746),te=n(11747),ne=n(143);function re(e){var t,n=e.map(ae);return n.push({key:(t=Object(te.a)()).key,name:t.name,itemType:t.itemType,iconProps:t.iconProps}),n}function ae(e){return{key:e.Id,name:e.DisplayName,itemType:ne.a.Normal,iconProps:Object(ee.a)(e.IconUrl)}}var oe=n(24),ie=n(8527),se=n(146);var ce=function(e,t,n){if(Object(oe.i)("addin-autoRun")){var r=Object(O.o)(t).map((function(e){return new ie.d(e,new ie.b)}));Object(O.e)(r,e,n),1==t?function e(t,n,r){if(n<1)return;!function(e){var t,n=null===(t=Object(O.B)("Persistent",e))||void 0===t?void 0:t.controlId;if(!n)return!1;return!document.getElementById(n)}(t)?Object(O.T)(t):Object(se.a)(r).then((function(){e(t,n-1,r)}))}(e,3,1e3):Object(O.T)(e)}};n.d(t,"f",(function(){return r.a})),n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return o.a})),n.d(t,"g",(function(){return i.a})),n.d(t,"e",(function(){return Y})),n.d(t,"h",(function(){return Z})),n.d(t,"c",(function(){return re})),n.d(t,"d",(function(){return ce}))},733:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(r||(r={}))},7532:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2063);function a(e){if(!Object(r.O)(e)){var t=Object(r.B)("NonPersistent",e);!t||e&&t.hostItemIndex!==e||Object(r.fb)("NonPersistent",e)}}},7533:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));var r=n(12243),a=n(8295),o=n(12195);function i(e,t){s(Object(r.a)(e),t)}function s(e,t){var n=t?t.addinId:"",r=t?t.commandId:"";Object(a.a)()[e]=t||void 0,Object(o.b)(e,n,r)}},7736:function(e,t,n){"use strict";var r=n(1),a=n(2083),o=function(){function e(e){this.addinFactory=e}return e.prototype.activate=function(e){var t=this;return new Promise((function(n,r){var o=new Map;Object.values(a.a).filter((function(e){return isNaN(Number(a.a[e]))})).forEach((function(n){o.set(n,[]),e.forEach((function(e){var r=t.addinFactory.CreateAddinIfEntryPointSupported(e,n);r&&o.get(n).push(r)}))})),n(o)}))},e}(),i=n(3513),s=n(6782);var c=n(2063),l=n(8527),u=n(5377);function d(e,t){var n=new l.c;return t.activate(e).then((function(e){Object.values(a.a).forEach((function(t){n.setExtensionPoint(e.get(t),t)}))})).then((function(){n.isInitialized=!0,Object(c.X)(n),function(e){var t={};[a.a.MessageRead,a.a.MessageCompose,a.a.AppointmentAttendee,a.a.AppointmentOrganizer].forEach((function(n){var r=e.getExtensionPoint(n);t[n]=Object(s.c)(r)})),i.k.importAndExecute(t)}(n);var t=e.map((function(e){return e.Id}));Object(u.g)(t)}))}var f=n(9855),p=n(6349),m=n(24),g=n(23),h=n(11),v="previousAdminAddins";function y(e){var t,n,a=[];try{for(var o=Object(r.k)(e),i=o.next();!i.done;i=o.next()){var s={addinId:i.value};a.push(s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}Object(h.e)(window,v,JSON.stringify(a))}var b=n(19),C=864e5;function A(e){var t,n=S(e);if(!Object(h.b)(window,v))return y(n),t=new Date(Object(b.a)().MailboxCreateDate),Date.now()-t.getTime()<C||Object(m.i)("addin-exp-testPinOldAdminAddins")?n:[];var r=function(){var e,t=Object(h.a)(window,v);if(!t)return[];try{e=JSON.parse(t)}catch(e){return g.g.warn("Unable to parse adminAddins data: "+t),[]}return e.map((function(e){return e.addinId}))}(),a=n.filter((function(e){return r.indexOf(e)<0}));return y(n),a}function S(e){var t,n,a=[];try{for(var o=Object(r.k)(e),i=o.next();!i.done;i=o.next()){var s=i.value;if(s.Enabled&&(s.ExtensionPointCollection&&"Organization"===s.OriginString)){var c=s.Id.toLowerCase();a.push(c)}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return a}var _=n(4496);var O=n(1080),I=n(2),x=Object(I.action)("updateMailSurfaceOptions",(function(e,t,n){return{mailOptions:e,mailReadSurfaceAddinsToPin:t,mailComposeSurfaceAddinsToPin:n}}));Object(I.mutator)(x,(function(e){var t,n,o,i;try{for(var s=Object(r.k)(e.mailReadSurfaceAddinsToPin),c=s.next();!c.done;c=s.next()){var l=c.value;e.mailOptions.readSurfaceAddins.push(l),Object(_.o)(l,!0,a.a.MessageRead)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}try{for(var u=Object(r.k)(e.mailComposeSurfaceAddinsToPin),d=u.next();!d.done;d=u.next()){l=d.value;e.mailOptions.composeSurfaceAddins.push(l),Object(_.o)(l,!0,a.a.MessageCompose)}}catch(e){o={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}O.h.importAndExecute(O.c.SurfaceActions,e.mailOptions)}));var T=x,E=Object(I.action)("updateCalendarSurfaceOptions",(function(e,t){return{calendarOptions:e,calendarSurfaceAddinsToPin:t}}));Object(I.mutator)(E,(function(e){var t,n;try{for(var o=Object(r.k)(e.calendarSurfaceAddinsToPin),i=o.next();!i.done;i=o.next()){var s=i.value;e.calendarOptions.calendarSurfaceAddins.push(s),Object(_.o)(s,!0,a.a.AppointmentOrganizer)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}O.h.importAndExecute(O.c.CalendarSurfaceAddins,e.calendarOptions)}));var M=E;function P(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,o,i,s,l,u;return Object(r.f)(this,(function(d){switch(d.label){case 0:return t.length<=0?[2]:[4,O.i.import()];case 1:return[4,(n=d.sent())(O.c.SurfaceActions)];case 2:return o=d.sent(),i=function(e,t,n){var o,i,s,l;if(n.length>=3)return[];var u,d=n.length,f=[];try{for(var p=Object(r.k)(t),m=p.next();!m.done;m=p.next()){var g=m.value,h=g.toLowerCase();if(d>=3)break;if(!n.includes(h))try{for(var v=(s=void 0,Object(r.k)(e)),y=v.next();!y.done;y=v.next()){var b=y.value;if(h==b.Id.toLowerCase())if(b.ExtensionPointCollection)if(Object(c.v)(b.ExtensionPointCollection,a.a.MessageRead)){f.push(h),++d,u?Object(_.p)(g,"NewAdminDeployment","MissNotSelected",a.a.MessageRead):u=h;break}}}catch(e){s={error:e}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(s)throw s.error}}}}catch(e){o={error:e}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}return Object(c.rb)(u),f}(e,t,o.readSurfaceAddins),s=function(e,t,n){var o,i,s,l;if(n.length>=3)return[];var u,d=n.length,f=[];try{for(var p=Object(r.k)(t),m=p.next();!m.done;m=p.next()){var g=m.value,h=g.toLowerCase();if(d>=3)break;if(!n.includes(h))try{for(var v=(s=void 0,Object(r.k)(e)),y=v.next();!y.done;y=v.next()){var b=y.value;if(h==b.Id.toLowerCase())if(b.ExtensionPointCollection)if(Object(c.v)(b.ExtensionPointCollection,a.a.MessageCompose)){f.push(h),++d,u?Object(_.p)(g,"NewAdminDeployment","MissNotSelected",a.a.MessageCompose):u=h;break}}}catch(e){s={error:e}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(s)throw s.error}}}}catch(e){o={error:e}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}return Object(c.qb)(u),f}(e,t,o.composeSurfaceAddins),[4,n(O.c.CalendarSurfaceAddins)];case 3:return l=d.sent(),u=function(e,t,n){var o,i,s,l;if(n.length>=3)return[];var u,d=n.length,f=[];try{for(var p=Object(r.k)(t),m=p.next();!m.done;m=p.next()){var g=m.value,h=g.toLowerCase();if(d>=3)break;if(!n.includes(h))try{for(var v=(s=void 0,Object(r.k)(e)),y=v.next();!y.done;y=v.next()){var b=y.value;if(h==b.Id.toLowerCase()&&b.ExtensionPointCollection){var C=Object(c.v)(b.ExtensionPointCollection,a.a.AppointmentAttendee),A=Object(c.v)(b.ExtensionPointCollection,a.a.AppointmentOrganizer);if(C||A){f.push(h),++d,u?Object(_.p)(g,"NewAdminDeployment","MissNotSelected",a.a.AppointmentOrganizer):u=h;break}}}}catch(e){s={error:e}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(s)throw s.error}}}}catch(e){o={error:e}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}return Object(c.kb)(u),f}(e,t,l.calendarSurfaceAddins),(i.length>0||s.length>0)&&T(o,i,s),u.length>0&&M(l,u),[2]}}))}))}function k(e,t){if(!t||0==t.length)return e;var n=[];return e.forEach((function(e){t.includes(e)||n.push(e)})),n}var R=n(197);function N(){return!Object(R.a)()}n.d(t,"a",(function(){return D}));var w=!1;function D(){var e=this;return new Promise((function(t,n){return Object(r.c)(e,void 0,void 0,(function(){var e,n,i,s,l;return Object(r.f)(this,(function(u){switch(u.label){case 0:if((w||Object(c.L)())&&!Object(c.M)())return Object(c.ub)(t),[2];Object(c.Z)(!1),U(!0),e=[],n=new o(new c.c(new c.b)),i=null,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,Object(f.a)()];case 2:return i=u.sent(),[3,4];case 3:return s=u.sent(),g.d(s),[3,4];case 4:return Object(c.Y)(i),null!==(i=Object(c.r)())&&Object(p.a)()&&Object(c.V)(i.GenericInfo),e=function(e){return(null==e?void 0:e.Extensions)?e.Extensions.filter((function(e){return e.Enabled&&null!=e.ExtensionPointCollection})):[]}(i),N()&&(Object(m.i)("addin-exp-findNewAdminAddins")||Object(m.i)("addin-exp-pinNewAdminAddins")||Object(m.i)("addin-exp-pinNewAdminAddinsFRECallout"))&&(l=function(e){var t,n,a=A(e);if(a.length<=0)return[];Object(c.jb)(!0);try{for(var o=Object(r.k)(a),i=o.next();!i.done;i=o.next()){var s=i.value;Object(_.n)(s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return a}(e),(Object(m.i)("addin-exp-pinNewAdminAddins")||Object(m.i)("addin-exp-pinNewAdminAddinsFRECallout"))&&P(e,l)),N()&&(Object(m.i)("addin-exp-awarenessNudge")||Object(m.i)("addin-exp-awarenessNudgeCusBtn"))&&function(e){Object(r.c)(this,void 0,void 0,(function(){var t,n,o,i,s,l,u;return Object(r.f)(this,(function(r){switch(r.label){case 0:return(t=S(e))?[4,O.i.import()]:[2];case 1:return[4,(n=r.sent())(O.c.SurfaceActions)];case 2:return o=r.sent(),(i=k(t,o.readSurfaceAddins)).length>0&&Object(c.tb)(i,a.a.MessageRead),(s=k(t,o.composeSurfaceAddins)).length>0&&Object(c.tb)(s,a.a.MessageCompose),[4,n(O.c.CalendarSurfaceAddins)];case 3:return l=r.sent(),(u=k(t,l.calendarSurfaceAddins)).length>0&&Object(c.tb)(u,a.a.AppointmentOrganizer),[2]}}))}))}(e),[4,d(e,n)];case 5:return u.sent(),U(!1),t(),[2]}}))}))}))}function U(e){w=e}},7743:function(e,t,n){"use strict";var r=n(1),a=n(2063),o="permission";n(4008);var i=n(24),s="DefaultSettings",c="0",l={cache:function(e,t){var n,l,u=e.addinCommand,f=u.extension,p="Preinstalled"===f.TypeString&&2!==f.ConsentState?function(e){var t,n=function(e){switch(e){case 1:return"ReadItem";case 2:return"ReadWriteMailbox";case 3:return"ReadWriteItem";default:return"Restricted"}}(e),r=Object(a.r)().ConsentUrl;if(r.indexOf("?")>0)t=(i=r.split("?"))[0]+"?"+o+"="+n+"&"+i[1];else if(r.indexOf("#")>0){var i;t=(i=r.split("#"))[0]+"?"+o+"="+n+"#"+i[1]}else t=r+"?"+o+"="+n;return t}(f.RequestedCapabilities):u.get_EntryPoint();l=d(p,t),n=function(e,t,n){var a=n._sourceLocations[t];return new OSF.Manifest.Manifest((function(t){if(t._id=e.get_Id(),t._version=e.extension.Version,t._extensionSettings={},t._displayNames={},t._defaultLocale="",t._displayNames[c]=e.extension.DisplayName,t._extensionSettings[s]=n,Object(i.i)("addin-appDomainsDuplicateRemove")){var o=Object(r.j)([],Object(r.g)(e.extension.AppDomains));t._appDomains=function(e,t){var n=Object.entries(e),r=new Map(n.map((function(e){return-1!==e[1].indexOf("//")?[e[1].split("//")[1],!0]:[e[1],!0]}))),a=-1!==t.indexOf("//")?t.split("//")[1].split("/")[0]:t.split("/")[0];if(r.has(a))return e;return e.push(t),e}(o,a)}else t._appDomains=Object(r.j)(Object(r.j)([],Object(r.g)(e.extension.AppDomains)),[a])}))}(u,t,l),OSF.OsfManifestManager.cacheManifest(u.extension.Id,u.extension.Version,n)}},u={cache:function(e,t){var n=e.addinCommand,r=e.controlId,a=e.sourceLocation,o=function(e,t,n,r){var a=OSF.OsfManifestManager.getCachedManifest(e.extension.Id,e.extension.Version),o=OfficeExt.AddinCommandsManifestManager.createManifestForAddinAction(a,r,null,t);return o._extensionSettings={},o._extensionSettings[s]=d(r,n),o}(n,r,t,a);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(o,r,n.extension.Version)}};function d(e,t){var n=new OSF.Manifest.ExtensionSettings;return n._sourceLocations={},n._sourceLocations[t]=e,n}var f=n(15562),p=n(6);var m=function(e){return function(){window.open(e.extension.EndNodeUrl)}};function g(e){switch(e){case 0:case 3:case 1:return 2;case 2:default:return 0}}var h=n(4),v=n(57),y={sets:[{name:"mailbox",maxVersion:"1.9"},{name:"IdentityAPI",maxVersion:"1.3"},{name:"DialogAPI",maxVersion:"1.2"},{name:"react"}]};var b=["progress.gif","agavedefaulticon96x96.png","moe_status_icons.png"],C=["moeerrorux.css"],A="resources/images/osfruntime/",S="resources/styles/osfruntime/";function _(e,t,n){t.getLocalizedCSSFilePath=O(C,Object(h.C)()+S),t.getLocalizedImageFilePath=O(b,Object(h.C)()+A),t._notifyHostError=t._notifyHost,t._hostType="Outlook",t._hostPlatform="Web",t._hostSpecificFileVersion="16.01",t.getRequirementsChecker().setRequirements(y)}function O(e,t){return function(n){var r=e.filter((function(e){return n==e}))[0];return(r=function(e){if(!Object(v.v)())return e;switch(e){case"moeerrorux.css":return"moerroruxrtl.css";default:return e}}(r))?t+r:""}}var I=n(4493),x=n(4141),T=function(e){return function(t,n){if(t){var r=t.ApiParams,a=w(t.MethodData.ControlId),o=t.MethodData.DispatchId;Object(I.i)(e,o,a,r,n)}}},E=function(e,t,n){Object(x.c)(e,n,t)},M=function(e,t,n){n.controlId=w(n.controlId),n.eventDispId=function(e){if(e==x.a.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID)return x.a.DISPLAY_DIALOG_DISPID;return e}(n.eventDispId),Object(x.j)(n,t)},P=[{name:"GetInitialData",isBlocking:!0,action:T},{name:"executeMethod",isBlocking:!1,action:function(e){return function(t,n){if(t){var r=w(t.DdaMethod.ControlId),a=t.DdaMethod.DispatchId;Object(I.i)(e,a,r,t,n)}}}},{name:"ExecuteMethod",isBlocking:!1,action:T}];function k(e){return[{name:"appCommandInvoked",registerAction:OfficeExt.AddinCommandsRuntimeManager.registerEvent,unregisterAction:OfficeExt.AddinCommandsRuntimeManager.unregisterEvent},{name:"dialogMessageReceived",registerAction:E,unregisterAction:M},{name:"dialogParentMessageReceived",registerAction:E,unregisterAction:M},{name:"dialogNotificationShown",registerAction:E,unregisterAction:M},{name:"olkItemSelectedChanged",registerAction:E,unregisterAction:M},{name:"olkAppointmentTimeChanged",registerAction:E,unregisterAction:M},{name:"olkRecipientsChanged",registerAction:E,unregisterAction:M},{name:"olkRecurrenceChanged",registerAction:E,unregisterAction:M},{name:"olkEnhancedLocationsChanged",registerAction:E,unregisterAction:M},{name:"olkAttachmentsChanged",registerAction:E,unregisterAction:M}]}function R(e,t){P.forEach((function(n){t.registerMethod(n.name,n.action(e),Microsoft.Office.Common.InvokeType.async,n.isBlocking)})),k().forEach((function(e){t.registerEventEx(e.name,e.registerAction,Microsoft.Office.Common.InvokeType.asyncRegisterEvent,e.unregisterAction,Microsoft.Office.Common.InvokeType.asyncUnregisterEvent)}))}function N(e,t){P.forEach((function(e){return t.unregisterMethod(e.name)})),k().forEach((function(e){return t.unregisterEvent(e.name)}))}function w(e){var t,n,o=Object(a.s)().activeDialogs;try{for(var i=Object(r.k)(o.values()),s=i.next();!s.done;s=i.next()){var c=s.value;if(c&&c.controlId===e)return c.parentControlId}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return e}var D=n(2076),U=n(10453);function F(e,t,n){var r=t.addinCommand,o=t.controlId,i=t.isDialog,s=r.extension.Settings?JSON.parse(r.extension.Settings):{},c=function(e,t){var n,r=Object(D.c)(t);return JSON.stringify({userType:Object(U.a)(),userId:Object(h.q)(),extensionType:e.extension.TypeString,module:Object(h.j)(),deployment:Object(h.y)(),scenario:Object(a.A)(t),clientVersion:Object(h.r)(),isPinned:null===(n=null==r?void 0:r.isAddinPinned)||void 0===n?void 0:n.call(r,e.extension.Id),react:!0,disableLogging:!1})}(r,e);return{div:n,id:o,marketplaceID:i?o:r.extension.Id,marketplaceVersion:r.extension.Version,settings:s,store:"",storeType:OSF.StoreType.Exchange,hostCustomMessage:c,isDialog:i,isVirtualOsfControl:!1}}var L=n(4496),j=n(121),B=function(){function e(e,t,n,a,o,s){var c,l,u=this;this.notifyHost=function(e,t,n){return Object(r.c)(u,void 0,void 0,(function(){var a,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return(a=this.notifyHostActions)&&(o=a[t])?[4,o(e,n)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},this.hostItemIndex=e,this.addinCommandTelemetry=s,this.contextActivationManager=(c=Object(v.j)(),l=this.notifyHost,OSF.AppSpecificSetup._setupFacade=_,new OSF.ContextActivationManager({appName:64,appVersion:"16.01",clientMode:1,appUILocale:c,lcid:c,notifyHost:l,dataLocale:"",hostControl:{},localizedScriptsUrl:OSF.getLocalizedStringsFilePath(),docUrl:"",appSettings:Object(i.i)("addin-CheckReceiverOrigin")?{AddinCheckReceiverOriginIsEnabled:"true"}:{}})),this.notifyHostActions=n||{},this.onInsertOsfControlAction=a,this.onDisplayNotificationAction=o,this.manifestCacheProvider=t;var d=this.notifyHostActions[8];this.notifyHostActions[8]=function(e,t){return d&&d(e,t),u.notifyHostError(e,t),u.tryTerminateUiLessAddin(t.errorCode,e),Promise.resolve()},this.notifyHostActions[23]=this.sendTelemetryEvent.bind(this),this.notifyHostActions[38]=this.sendCustomerContentEvent.bind(this)}return e.prototype.insertOsfControl=function(e,t){R(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),this.activeOsfControl=e,this.extensionContainer=t,this.manifestCacheProvider.cache(e,Object(v.j)()),this.contextActivationManager.insertOsfControl(F(this.hostItemIndex,this.activeOsfControl,t))},e.prototype.purgeOsfControl=function(){if(this.activeOsfControl&&this.extensionContainer){var e=this.activeOsfControl.controlId;N(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),Object(x.b)(e),this.contextActivationManager.purgeOsfControl(e,!1),this.activeOsfControl=null,this.extensionContainer=null}},e.prototype.onInsertOsfControl=function(){var e=this.activeOsfControl.addinCommand.extension;("User"==e.OriginString||"Organization"==e.OriginString)&&a.j.Context&&a.j.Context.IsInOrgMarketplaceRole&&this.tryDisplayNotification(e.AppStatus,e.LicenseType),this.onInsertOsfControlAction&&this.onInsertOsfControlAction()},e.prototype.notifyAgave=function(e){var t=this.activeOsfControl.controlId;this.contextActivationManager.notifyAgave(t,e)},e.prototype.updateHostItemIndex=function(e){N(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),this.hostItemIndex=e,R(e,this.contextActivationManager._serviceEndPoint)},e.prototype.dispose=function(){this.contextActivationManager.dispose(),this.contextActivationManager=null},e.prototype.notifyHostError=function(e,t){var n;Object(L.m)(!1,null===(n=this.activeOsfControl)||void 0===n?void 0:n.addinCommand,this.hostItemIndex,Object(a.q)(e),this.addinCommandTelemetry,e,t.errorCode)},e.prototype.sendTelemetryEvent=function(e,t){return Object(r.c)(this,void 0,void 0,(function(){var e,n,a,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return e=Object(L.l)(t),n=this.activeOsfControl,a=n.addinCommand,o=n.controlId,Object(L.c)(e,a,this.hostItemIndex,o),e.iKey?[4,j.m.importAndExecute(e.iKey,e)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},e.prototype.sendCustomerContentEvent=function(e,t){return Object(r.c)(this,void 0,void 0,(function(){var e,n,a,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return Object(i.i)("addin-sendCustomerContent")?(e=Object(L.k)(t),n=this.activeOsfControl,a=n.addinCommand,o=n.controlId,Object(L.c)(e,a,this.hostItemIndex,o),e.iKey?[4,j.l.importAndExecute(e.iKey,e)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},e.prototype.displayNotification=function(e){this.contextActivationManager.displayNotification(e),this.onDisplayNotificationAction&&this.onDisplayNotificationAction(e)},e.prototype.tryDisplayNotification=function(e,t){var n=this.activeOsfControl,r=n.addinCommand,a=n.controlId;if(e){var o=function(e,t,n){var r="",a="",o=!1,i=!1;switch(n){case"1.0":r=Object(p.b)(f.b),a=Object(p.b)(f.l),o=!0,i=!0;break;case"1.1":r=Object(p.b)(f.c),a=Object(p.b)(f.l),o=!0,i=!0;break;case"1.2":r=Object(p.b)(f.d),a=Object(p.b)(f.l),o=!0,i=!0;break;case"2.0":r=Object(p.b)(f.e),a=Object(p.b)(f.l);break;case"2.1":r=Object(p.b)(f.f),a=Object(p.b)(f.l);break;case"3.0":r=Object(p.b)(f.g),a=Object(p.b)(f.k);break;case"3.1":r=Object(p.b)(f.h),a=Object(p.b)(f.k);break;case"3.2":r=Object(p.b)(f.i),a=Object(p.b)(f.k);break;case"3.3":r=Object(p.b)(f.j),a=Object(p.b)(f.k);break;default:return null}return{infoType:1,id:e,title:Object(p.b)(f.m),description:r,buttonTxt:a,buttonCallback:m(t),detailView:o,displayDeactive:i,reDisplay:!0}}(a,r,e);o&&this.displayNotification(o)}else 1==t&&this.displayNotification(function(e,t){return{infoType:2,id:t,title:Object(p.b)(f.n),description:Object(p.b)(f.o),buttonTxt:Object(p.b)(f.a),buttonCallback:function(){window.open(e.extension.EndNodeUrl)},reDisplay:!0}}(r,a))},e.prototype.tryTerminateUiLessAddin=function(e,t){if(1042==e){Object(a.gb)(t,this.hostItemIndex,a.d.TimedOut,{allowEvent:!1})}},e}();n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return g})),n.d(t,"c",(function(){return B}))},7753:function(e,t,n){"use strict";var r=n(1),a=n(3402),o=n(2263),i=n(33);function s(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.a)({__type:"UpdateClientExtensionNotificationsJsonRequest:#Exchange"},n)),Object(i.a)("UpdateClientExtensionNotifications",e,t)}var c=n(180);function l(e,t,n){var a,o=(a={ItemId:t,Id:e,Notifications:n},Object(r.a)({__type:"UpdateClientExtensionNotificationsRequest:#Exchange"},a));return s({Header:Object(c.b)(),Body:o})}var u=n(2076),d=n(3097);function f(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,i,s,c;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(n=Object(u.c)(e),!(i={Id:n.getItemId()}).Id)throw new a.a(o.b.CannotPersistPropertyInUnsavedDraftError);return s=Object(d.d)(e,t),c=Object.keys(s).map((function(e){var t=s[e];return{Key:t.Key,Type:t.Type,Message:t.Message,Icon:t.Icon}})),[4,l(t,i,c).catch((function(e){throw new a.a(o.b.PersistedNotificationArraySaveError)}))];case 1:return r.sent(),[2]}}))}))}n.d(t,"a",(function(){return f}))},8295:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r={};function a(){return r}},8296:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}));var r=n(8654),a={Normal:1,CostDeferred:2,RealTime:3},o={Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9},i=e({},r.b,{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519})}).call(this,n(3126).__assignFn)},8297:function(e,t,n){"use strict";var r=n(7736);n.d(t,"a",(function(){return r.a}));var a=n(9855);n.d(t,"b",(function(){return a.a}))},8298:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),a=n(0),o=n(6349),i=n(7743),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.refCallback=function(e){e&&(r.extensionContainer=e,r.osfControlAdapter.insertOsfControl(r.props,r.extensionContainer))},r.handlerContainerOnFocus=function(){r.notifyAgave(11)},r.osfControlAdapter=r.props.osfControlAdapter?r.props.osfControlAdapter:new i.c(t.hostItemIndex,t.manifestCacheProvider,t.notifyHostActions,t.onInsertOsfControl,t.onDisplayNotification,t.addinCommandTelemetry),r}return Object(r.e)(t,e),t.prototype.componentDidMount=function(){this.osfControlAdapter.onInsertOsfControl()},t.prototype.UNSAFE_componentWillReceiveProps=function(e){Object(o.b)()&&this.isNewHostItemIndex(e)&&this.osfControlAdapter.updateHostItemIndex(e.hostItemIndex)},t.prototype.shouldComponentUpdate=function(e){return this.isNewOsfControl(e)},t.prototype.componentWillUpdate=function(){this.osfControlAdapter.purgeOsfControl()},t.prototype.componentDidUpdate=function(){this.osfControlAdapter.onInsertOsfControl()},t.prototype.componentWillUnmount=function(){this.osfControlAdapter.purgeOsfControl(),this.osfControlAdapter.dispose(),this.osfControlAdapter=null},t.prototype.notifyAgave=function(e){this.osfControlAdapter.notifyAgave(e)},t.prototype.isNewOsfControl=function(e){return this.props.controlId!=e.controlId},t.prototype.isNewHostItemIndex=function(e){return this.props.hostItemIndex!=e.hostItemIndex},t.prototype.render=function(){return this.extensionContainer&&this.osfControlAdapter.insertOsfControl(this.props,this.extensionContainer),a.createElement("div",{ref:this.refCallback,style:this.props.style,className:this.props.className,onFocus:this.handlerContainerOnFocus})},t}(a.Component)},8509:function(e,t,n){"use strict";var r=n(6673),a=n(2076),o=n(5377),i=n(2063);function s(e,t){var n,s=Object(a.c)(e);if(s){var c=s.mode,l=Object(o.c)(c);if(l){var u=Object(r.c)(l.addinId,l.commandId,c);if(null===(n=s.isSharedItem)||void 0===n||!n.call(s)||Object(i.f)(u))if(u&&!Object(r.f)(u)){var d=Object(i.y)();Object(i.ab)(d,e,u,"Persistent",c,t)}else!u&&Object(i.L)()&&Object(o.h)(c,null)}}}var c=n(6242),l=n(2083);function u(e){var t,n=Object(a.c)(e),r=n.mode;return(null===(t=n.isSharedItem)||void 0===t||!t.call(n))&&(r!==l.a.MessageRead||Object(i.cb)(n.getItem()))}function d(e){switch(Object(a.c)(e).mode){case l.a.MessageRead:case l.a.MeetingRequest:return l.a.MessageRead;case l.a.MessageCompose:return l.a.MessageCompose;default:return l.a.Unknown}}function f(e){var t=Object(a.c)(e),n=Object(i.B)("Persistent",e);return!!n&&(!Object(i.f)(n.addinCommand)&&!!(t&&t.isSharedItem&&t.isSharedItem()))}var p=n(1),m=n(4493),g=n(4141);function h(e){var t,n=null===(t=Object(c.a)())||void 0===t?void 0:t.hostItemIndex,r=Object(i.B)("Persistent",n),a=null==r?void 0:r.controlId;1!==e&&2!==e||function(e){Object(g.d)(g.a.ITEM_CHANGED_EVENT_DISPID,e,null)}(a),Object(c.b)(),Object(i.fb)("Persistent",n)}function v(e){var t,n=null===(t=Object(c.a)())||void 0===t?void 0:t.hostItemIndex,r=Object(i.B)("Persistent",n),a=d(e);Object(o.c)(a)?Object(c.c)({hostItemIndex:e,mode:a}):Object(c.b)(),r?(Object(i.sb)(n,e),function(e,t){Object(p.c)(this,void 0,void 0,(function(){var n;return Object(p.f)(this,(function(r){switch(r.label){case 0:return[4,Object(m.b)(t,e)];case 1:return n=r.sent(),Object(g.d)(g.a.ITEM_CHANGED_EVENT_DISPID,t,n),[2]}}))}))}(e,r.controlId)):s(e)}var y=n(6349),b=n(3573);function C(e,t,n){if(void 0===t&&(t=void 0),void 0===n&&(n=window),Object(y.b)())switch(e){case b.a.NotSupported:h(3);break;case b.a.Empty:h(1),Object(i.pb)("exfc_main");break;case b.a.Multi:h(2);break;case b.a.Single:t&&function(e,t){var n;if(!Object(m.g)(e)||!Object(i.L)()||!Object(o.e)()||function(e){var t=Object(a.c)(e);return t.mode===l.a.MessageRead&&t.isInlineComposeOpen()}(e)||!function(e){var t=Object(a.c)(e);return t.mode!==l.a.MessageRead||t.isItemSelected()}(e)||t==window&&function(e){return e===Object(c.a)().hostItemIndex}(e))return;if(t==window)if(u(e))if(f(e))h(4);else if(function(e){return d(e)!==Object(c.a)().mode}(e)){!function(e,t){var n=d(t);Object(o.c)(n)?Object(c.c)({hostItemIndex:t,mode:n}):Object(c.b)(),Object(i.fb)("Persistent",e),s(t)}(null===(n=Object(c.a)())||void 0===n?void 0:n.hostItemIndex,e)}else v(e);else h(3);else u(e)&&!f(e)&&(Object(c.b)(),s(e))}(t,n)}}n.d(t,"a",(function(){return C}))},8527:function(e,t,n){"use strict";var r=n(1),a=n(2063),o=n(2083),i=function(){function e(){var e=this;this.getAutoRunAddinsByLaunchEventType=function(t){var n=e.getAddinsForMode(o.a.LaunchEvent),r=[],a=[];return(r=e.autoRunAddinsIndexMapping.get(t))&&r.map((function(e){a.push(n[e])})),a},this.setAutoRunAddinsMapping=function(t){t.forEach((function(t,n){Object(r.j)([],Object(r.g)(t.AddinCommands.values())).forEach((function(t){var r=null==t?void 0:t.getLaunchEventType();r&&e.setAutoRunAddinMapForLaunchEventType(r,n)}))}))},this.setAutoRunAddinMapForLaunchEventType=function(t,n){e.autoRunAddinsIndexMapping.has(t)?e.autoRunAddinsIndexMapping.get(t).push(n):e.autoRunAddinsIndexMapping.set(t,[n])},this.isInitialized=!1,this.appointmentAttendeeAddins=[],this.appointmentOrganizerAddins=[],this.detectedEntityAddins=[],this.messageReadAddins=[],this.messageComposeAddins=[],this.meetingRequestAddins=[],this.eventsAddins=[],this.autoRunAddins=[],this.autoRunAddinsIndexMapping=new Map}return e.prototype.getExtensionPoint=function(e,t){var n=this.getAddinsForMode(e);return t&&n&&(n=Object(a.l)(n)),n},e.prototype.setExtensionPoint=function(e,t){switch(t){case o.a.MeetingRequest:this.meetingRequestAddins=e;break;case o.a.AppointmentAttendee:this.appointmentAttendeeAddins=e;break;case o.a.AppointmentOrganizer:this.appointmentOrganizerAddins=e;break;case o.a.DetectedEntity:this.detectedEntityAddins=e;break;case o.a.MessageCompose:this.messageComposeAddins=e;break;case o.a.MessageRead:this.messageReadAddins=e;break;case o.a.TrapOnSendEvent:this.eventsAddins=e;break;case o.a.LaunchEvent:this.autoRunAddins=e,this.setAutoRunAddinsMapping(e)}},e.prototype.getAddinsForMode=function(e){switch(e){case o.a.MeetingRequest:return this.meetingRequestAddins;case o.a.AppointmentAttendee:return this.appointmentAttendeeAddins;case o.a.AppointmentOrganizer:return this.appointmentOrganizerAddins;case o.a.DetectedEntity:return this.detectedEntityAddins;case o.a.MessageCompose:return this.messageComposeAddins;case o.a.MessageRead:return this.messageReadAddins;case o.a.TrapOnSendEvent:return this.eventsAddins;case o.a.LaunchEvent:return this.autoRunAddins;default:return null}},e}(),s=n(9850),c=function(){function e(){}return e.prototype.setExecutionInitTime=function(){this.executionInitTime=Object(s.a)()},e.prototype.setExecutionStartTime=function(){this.executionStartTime=Object(s.a)()},e.prototype.setExecutionEndTime=function(){this.executionEndTime=Object(s.a)()},e.prototype.setQueuePushTime=function(){this.queuePushTime=Object(s.a)()},e.prototype.setQueuePopTime=function(){this.queuePopTime=Object(s.a)()},e.prototype.getExecutionInitTime=function(){return this.executionInitTime},e.prototype.getExecutionStartTime=function(){return this.executionStartTime},e.prototype.getExecutionEndTime=function(){return this.executionEndTime},e.prototype.getQueuePushTime=function(){return this.queuePushTime},e.prototype.getQueuePopTime=function(){return this.queuePopTime},e}(),l=function(e,t){this.addinCommand=e,this.addinCommandTelemetry=t,this.controlId=Object(a.K)(e)?null:Object(a.y)()},u=function(){function e(){}return e.prototype.setExecutionInitTime=function(){this.executionInitTime=Object(s.a)()},e.prototype.setExecutionStartTime=function(){this.executionStartTime=Object(s.a)()},e.prototype.setExecutionEndTime=function(){this.executionEndTime=Object(s.a)()},e.prototype.getExecutionInitTime=function(){return this.executionInitTime},e.prototype.getExecutionStartTime=function(){return this.executionStartTime},e.prototype.getExecutionEndTime=function(){return this.executionEndTime},e}();n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return u}))},9024:function(e){e.exports=JSON.parse('{"a":"K9a"}')},9850:function(e,t,n){"use strict";var r=n(31),a=n(9851);n.d(t,"a",(function(){return a.a}));var o=new r.c((function(){return n.e(514).then(n.bind(null,17855))}));new r.b(o,(function(e){return e.logJank}))},9851:function(e,t,n){"use strict";t.a=function(){return window.performance?performance.now():Date.now()}},9852:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(7532),a=n(2076),o=n(5377),i=n(2063);function s(e,t,n,s){var c;Object(r.a)(e);var l=Object(i.B)("Persistent",e);if(!(l&&(u=l.addinCommand,d=t,u&&d&&u.get_Id()===d.get_Id()))){var u,d,f=Object(a.c)(e);(null===(c=f)||void 0===c?void 0:c.openTaskPane)&&f.openTaskPane();var p=Object(i.y)();Object(i.ab)(p,e,t,function(e,t){var n=Object(o.c)(t);if(!n)return"NonPersistent";var r=n.addinId,a=n.commandId;return e.get_Id()===""+r+a?"Persistent":"NonPersistent"}(t,n),n,s)}}},9853:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,a=n(0),o=n(212),i=n(9854),s=n(10309);function c(){Object(s.a)().then((function(e){o.render(a.createElement(i.a,{storeUrl:e,ref:function(e){return!!e&&e.setPanelOpen()}}),r)}))}r=document.createElement("div"),document.body.appendChild(r)},9854:function(e,t,n){"use strict";var r=n(1),a=n(20),o=n(9024),i=n(6),s=n(0),c=n(3841),l=n(1260),u=n(1934),d=n(15557);function f(){c.a.sendFeedback()}t.a=Object(a.a)((function(e,t){var n=Object(r.g)(s.useState(!0),2),a=n[0],c=n[1];return s.useImperativeHandle(t,(function(){return{setPanelOpen:function(){c(!0)}}}),[]),s.createElement(u.a,{isOpen:a,onDismiss:function(){return c(!1)}},s.createElement("div",{className:d.container},s.createElement(l.a,{className:d.closeButton,onClick:function(){c(!1)},iconProps:{iconName:"Cancel"}}),s.createElement("iframe",{src:e.storeUrl,title:"",className:d.inClientStoreIFrameCenter,frameBorder:0})),s.createElement("div",{className:d.FeedbackCommandBarCenter},s.createElement("div",{onClick:f},Object(i.b)(o.a))))}),{forwardRef:!0})},9855:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(1),a=n(4493),o=n(57),i=3,s=3e3,c=3,l=!0,u="1.8",d="1.1";function f(){return function e(t){return Object(r.c)(this,void 0,void 0,(function(){var n;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,(f=t==i?0:s,new Promise((function(e,t){setTimeout((function(){e()}),f)})))];case 1:return r.sent(),[4,Object(a.k)(c,Object(o.m)(),l,u,d)];case 2:return[2,r.sent()];case 3:if(n=r.sent(),0==t)throw n;return[3,4];case 4:return[2,e(--t)]}var f}))}))}(i)}},9856:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=n(173);function a(e){return"exfc_"+(e==window?"main":Object(r.a)())}function o(e){var t;return e==window?"exfc_main":null===(t=null==e?void 0:e.document.querySelector('[id^="exfc_"]'))||void 0===t?void 0:t.id}},9857:function(e,t,n){var r=n(15573),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)}}]);
//# sourceMappingURL=owa.MailBoot~Addins~addins-marketplace.js.map
self.scriptsLoaded['owa.MailBoot~Addins~addins-marketplace.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Addins~addins-marketplace.js'] = (new Date()).getTime();