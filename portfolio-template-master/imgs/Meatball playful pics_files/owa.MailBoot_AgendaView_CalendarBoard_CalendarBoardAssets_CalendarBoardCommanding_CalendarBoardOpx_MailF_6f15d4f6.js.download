self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AgendaView~CalendarBoard~CalendarBoardAssets~CalendarBoardCommanding~CalendarBoardOpx~MailF~6f15d4f6.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[87],{1426:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(734);function u(e){var t={viewmodel:"ReadMessageItem",ItemID:encodeURIComponent(e),ispopout:"1"};return Object(n.a)(t)}},155:function(e,t,r){"use strict";var n,u,a;!function(e){e[e.CompletedDateTime=0]="CompletedDateTime",e[e.OrderDateTime=1]="OrderDateTime",e[e.CommittedOrder=2]="CommittedOrder"}(n||(n={})),function(e){e.LinkedEntities="LinkedEntities"}(u||(u={})),function(e){e[e.MyDay=0]="MyDay",e[e.DueDate=1]="DueDate",e[e.FolderId=2]="FolderId"}(a||(a={}));var i=r(121),o=r(6),c=r(151),d=r(23),l="/ows/todo/api/v1",m="tasks",s=l+"/tasks/{0}",f=l+"/tasks/{0}",O=l+"/taskfolders/{0}",p=l+"/taskfolders",b=l+"/taskfolders/{0}/tasks",D=l+"/tasks/{0}/subtasks",T=f+"/subtasks/{1}",y=s+"/subtasks/{1}",j=r(5),v=r(744),I=r(454),S=r(1426);var C={OrderDateTime:{propertyName:"OrderDateTime",getValue:function(e){return e?e.toISOString():null}},IsReminderOn:{propertyName:"IsReminderOn"},ReminderDateTime:{propertyName:"ReminderDateTime",getValue:function(e){return h(e)}},CompletedDateTime:{propertyName:"CompletedDateTime",getValue:function(e){return h(e)}},DueDateTime:{propertyName:"DueDateTime",getValue:function(e){return h(e)}},IsCompleted:{propertyName:"IsCompleted"},Subject:{propertyName:"Subject"},Status:{propertyName:"Status"},Importance:{propertyName:"Importance"},Note:{propertyName:"Body",getValue:function(e){return function(e){return{Content:e||"",ContentType:"Text"}}(e)}},LinkedEmail:{propertyName:"LinkedEntity",getValue:function(e){return function(e){if(!e)return null;return function(e){return{Id:Object(v.a)(e.Id),WebLink:Object(S.a)(e.Id),EntityType:I.c,EntitySubtype:e.EntitySubtype,DisplayName:e.DisplayName,Preview:{RestId:Object(v.a)(e.Id)}}}(e)}(e)}},CommittedDay:{propertyName:"CommittedDay",getValue:function(e){return e?Object(j.tb)(e):null}},CommittedOrder:{propertyName:"CommittedOrder",getValue:function(e){return e?e.toISOString():null}},CreatedWithLocalId:{propertyName:"CreatedWithLocalId"}};function h(e){return null===e?null:{DateTime:Object(j.rb)(e),TimeZone:e.tz}}function k(e,t){if(!e)return null;var r=Object.keys(e).map((function(r){return function(e,t,r){if(r&&null===t)return null;return function(e,t){var r=C[e];if(!r)return null;var n=r.getValue?r.getValue(t):t;return{key:r.propertyName,value:n}}(e,t)}(r,e[r],t)})).filter((function(e){return!!e}));if(0===r.length)return null;var n={};return r.forEach((function(e){n[e.key]=e.value})),n}function g(e,t){return k(e,t)}var N=r(19);function E(){var e=Object(N.a)().UserOptions.TimeZone;return{Prefer:Object(o.c)('outlook.timezone="{0}"',e)}}var F=r(1);function R(e){return Object(F.a)(Object(F.a)({},e),{CompletedDateTime:e.CompletedDateTime?Object(j.nc)(e.CompletedDateTime):void 0,OrderDateTime:e.OrderDateTime?Object(j.nc)(e.OrderDateTime):void 0})}function _(e,t,r){var n=Object(o.c)(D,e),u=g(t,!0);return u?Object(c.e)(n,u,null,!1,E()).then((function(e){return e?R(e):null})).catch((function(e){return d.d("[CreateSubtaskService] API returned error",e),null})):(Object(i.s)("CreateSubtaskServiceEmptyRequest",r,{isCore:!0}),null)}function L(e){var t=Object(I.h)(Object(F.a)(Object(F.a)({},e),{OrderDateTime:e.OrderDateTime?Object(j.nc)(e.OrderDateTime):null,FolderType:"Other"}));return e.FolderType&&"com.microsoft.outlook.email.commitment"===e.FolderType.toLowerCase()&&(t.FolderType="Commitments"),e.FolderType&&"com.microsoft.outlook.email.flagged"===e.FolderType.toLowerCase()&&(t.FolderType="FlaggedEmails"),t}function w(e){return Object(c.e)(p,{Name:e.Name},null,!1,E()).then((function(e){return e.Id?L(e):null})).catch((function(e){return null}))}function V(e,t){return k(e,t)}function q(e){var t,r,n,u,a=Object(F.a)(Object(F.a)({},e),{__type:"Todo",ReminderDateTime:e.ReminderDateTime?Object(j.nc)(e.ReminderDateTime.DateTime):void 0,CompletedDateTime:e.CompletedDateTime?Object(j.nc)(e.CompletedDateTime.DateTime):void 0,DueDateTime:e.DueDateTime?Object(j.nc)(e.DueDateTime.DateTime):void 0,OrderDateTime:e.OrderDateTime?Object(j.nc)(e.OrderDateTime):void 0,Status:e.Status,Subtasks:e.Subtasks?e.Subtasks.map(R):void 0,Importance:e.Importance,Note:(null===(t=e.Body)||void 0===t?void 0:t.Content)&&"Text"==e.Body.ContentType?e.Body.Content:void 0,LinkedEmail:P(e.LinkedEntities),CommittedDay:e.CommittedDay?(r=e.CommittedDay,n=Object(j.oc)(r),u=Object(j.nc)(Object(j.Db)(n),Object(j.yb)(n),Object(j.mb)(n)),u):void 0,CommittedOrder:e.CommittedOrder?Object(j.nc)(e.CommittedOrder):void 0,CreatedWithLocalId:e.CreatedWithLocalId?e.CreatedWithLocalId:void 0});return e?a:null}function P(e){if(!e)return null;var t,r=e.filter((function(e){return e.EntityType==I.c}));return 0==r.length?null:(t=r[0],{Id:Object(v.b)(t.Id),EntitySubtype:t.EntitySubtype,DisplayName:t.DisplayName})}function x(e,t,r){void 0===t&&(t=null);var n=t||m,u=Object(o.c)(b,n);return V(e,!0)?Object(c.e)(u,V(e,!0),null,!1,E(),void 0,void 0,void 0,"CREATE_TASK").then((function(e){return e.Id?q(e):null})).catch((function(e){return d.d("[CreateTaskService] API returned error",e),null})):(Object(i.s)("CreateTaskServiceEmptyRequest",r,{isCore:!0}),null)}var A=r(217);function W(e,t){var r=Object(o.c)(y,e,t);return Object(c.a)(r,null,null,!0,E()).then((function(e){return Object(A.a)(e.status)})).catch((function(e){return!1}))}function B(e){var t=Object(o.c)(s,e);return Object(c.a)(t,null,null,!0,E()).then((function(e){return Object(A.a)(e.status)})).catch((function(e){return!1}))}function G(){return Object(c.b)(p,void 0,!1,E()).then((function(e){return(null==e?void 0:e.Value)?e.Value.map((function(e){return L(e)})):null})).catch((function(e){return null}))}function K(e){return e&&e.type===a.MyDay}function M(e){return e&&e.type===a.DueDate}function $(e){return e&&e.type===a.FolderId}var z=r(94);function Q(e){var t=e.filters,r=e.orderBy,u=e.expand,a=function(e){if(K(e))return"smartlists/myday";if(M(e))return"smartlists/duedate";if($(e)){var t=e.folderId;return"taskfolders/"+(t||"tasks")}return Object(z.a)(e)}(e),i=function(e){switch(e){case n.CompletedDateTime:return"CompletedDateTime/DateTime desc";case n.OrderDateTime:case n.CommittedOrder:return"OrderDateTime/DateTime desc";default:Object(z.a)(e)}}(r),o=[u].join(","),c=t.taskStatusFilters.length>0?"&$filter="+t.taskStatusFilters.map(U).join(" or "):"";return"/ows/todo/api/v1/"+a+"/tasks/?"+function(e){var t="",r=e.customQueryOptions.maxPageSize;r&&(t+="&maxpagesize="+r);if(K(e)){var n=e.customQueryOptions.date,u=Object(j.tb)(n);return t+"&date="+u}if(M(e)){var a=e.customQueryOptions,i=a.startDate,o=a.endDate,c=Object(j.tb)(i),d=Object(j.tb)(o);return t+"&startDate="+c+"&endDate="+d}if($(e))return t;return Object(z.a)(e)}(e)+c+"&$orderby="+i+"&$expand="+o}function U(e){return"Status "+e.equalityOperator+" '"+e.status+"'"}function H(e,t){var r=this;return Object(c.b)(e,null,!1,E(),!0,void 0,t).then((function(e){return Object(F.c)(r,void 0,void 0,(function(){return Object(F.f)(this,(function(t){if(function(e){return null==e?void 0:e.Value}(e))return[2,e];throw new Error(Object(o.c)("The service response {0} is not of the expected GetTaskResponse type",e))}))}))})).catch((function(e){var t=function(e){if(e instanceof Error)return e;var t=null;try{t=JSON.stringify(e)}catch(e){t="[getErrorFromObject]: Unable to parse Error Message"}return new Error(t)}(e);return d.g.warn(e),{errorResponse:t,Value:[]}}))}var Y="com.microsoft.teams.message";function Z(e){return!!e.Source&&e.Source.substring(0,Y.length)===Y}function J(e){return Object(F.c)(this,void 0,void 0,(function(){var t;return Object(F.f)(this,(function(r){switch(r.label){case 0:return"GET_TASKS_IN_FOLDER",[4,H(Q(e),"GET_TASKS_IN_FOLDER")];case 1:return(t=r.sent()).errorResponse&&$(e)?("GET_TASKS_IN_FOLDER_RETRY",function(e){var t;if(1===(null===(t=e.filters.taskStatusFilters)||void 0===t?void 0:t.length)){var r=e.filters.taskStatusFilters[0];if("Completed"===r.status&&"ne"===r.equalityOperator)return!0}return!1}(e)&&(e.filters.taskStatusFilters=[{status:"NotStarted",equalityOperator:"eq"},{status:"InProgress",equalityOperator:"eq"},{status:"Deferred",equalityOperator:"eq"},{status:"WaitingOnOthers",equalityOperator:"eq"}]),[4,H(Q(e),"GET_TASKS_IN_FOLDER_RETRY")]):[3,3];case 2:t=r.sent(),r.label=3;case 3:return t.Value=t.Value.filter((function(e){return!Z(e)})),[2,t]}}))}))}function X(e,t,r){var n=Object(o.c)(T,e,t);return Object(c.d)(n,r,null,!0,E()).then((function(e){return Object(A.a)(e.status)})).catch((function(e){return!1}))}function ee(e,t){var r=Object(o.c)(O,e);return Object(c.d)(r,t,null,!0,E()).then((function(e){return Object(A.a)(e.status)})).catch((function(e){return!1}))}function te(e,t){var r=Object(o.c)(f,t);return Object(c.d)(r,e,null,!0,E()).then((function(e){return Object(A.a)(e.status)})).catch((function(e){return!1}))}r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return a})),r.d(t,"d",(function(){return _})),r.d(t,"e",(function(){return w})),r.d(t,"f",(function(){return x})),r.d(t,"g",(function(){return W})),r.d(t,"h",(function(){return B})),r.d(t,"k",(function(){return G})),r.d(t,"l",(function(){return J})),r.d(t,"p",(function(){return X})),r.d(t,"q",(function(){return ee})),r.d(t,"r",(function(){return te})),r.d(t,"i",(function(){return g})),r.d(t,"j",(function(){return V})),r.d(t,"m",(function(){return E})),r.d(t,"o",(function(){return q})),r.d(t,"n",(function(){return Z}))},454:function(e,t,r){"use strict";var n,u="dragged_email";!function(e){e.Normal="Normal",e.High="High",e.Low="Low"}(n||(n={}));var a=n;function i(e){return"Todo"===(null==e?void 0:e.__type)}var o=r(1),c=r(203);function d(e){return e=null!==e?e:{},Object(o.a)(Object(o.a)({},e),{CompletedDateTime:e.CompletedDateTime?e.CompletedDateTime:null,Id:e.Id?e.Id:Object(c.a)(),IsCompleted:!!e.IsCompleted&&e.IsCompleted,OrderDateTime:e.OrderDateTime?e.OrderDateTime:null,Subject:e.Subject?e.Subject:null})}function l(e){var t=(e=null!==e?e:{}).Id?e.Id:Object(c.a)();return Object(o.a)(Object(o.a)({},e),{__type:"Todo",Id:t,ParentFolderId:e.ParentFolderId?e.ParentFolderId:null,Subject:e.Subject?e.Subject:null,ReminderDateTime:e.ReminderDateTime?e.ReminderDateTime:null,IsReminderOn:!!e.IsReminderOn&&e.IsReminderOn,CompletedDateTime:e.CompletedDateTime?e.CompletedDateTime:null,DueDateTime:e.DueDateTime?e.DueDateTime:null,OrderDateTime:e.OrderDateTime?e.OrderDateTime:null,Status:e.Status?e.Status:"NotStarted",Subtasks:e.Subtasks?e.Subtasks:null,Importance:e.Importance?e.Importance:a.Normal,Note:e.Note?e.Note:null,LinkedEmail:e.LinkedEmail?e.LinkedEmail:null,CommittedDay:e.CommittedDay?e.CommittedDay:null,CommittedOrder:e.CommittedOrder?e.CommittedOrder:null,CreatedWithLocalId:t})}function m(e){return e=null!==e?e:{},Object(o.a)(Object(o.a)({},e),{Id:e.Id?e.Id:Object(c.a)(),Name:e.Name?e.Name:null,IsDefaultFolder:!!e.IsDefaultFolder&&e.IsDefaultFolder,IsSharedFolder:!!e.IsSharedFolder&&e.IsSharedFolder,IsOwner:!!e.IsOwner&&e.IsOwner,FolderType:e.FolderType?e.FolderType:"Other",SyncStatus:e.SyncStatus?e.SyncStatus:"Synced",OrderDateTime:e.OrderDateTime?e.OrderDateTime:null})}function s(e){return e&&e.subjects&&0!==e.subjects.length?e.subjects.map((function(t,r){return{Subject:t,LinkedEmail:{Id:e.latestItemIds[r],EntitySubtype:u,DisplayName:t}}})):[]}r.d(t,"c",(function(){return"message"})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return"highlight_from_email"})),r.d(t,"a",(function(){return"context_menu_email"})),r.d(t,"e",(function(){return a})),r.d(t,"j",(function(){return i})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return m})),r.d(t,"i",(function(){return s}))}}]);
//# sourceMappingURL=owa.MailBoot~AgendaView~CalendarBoard~CalendarBoardAssets~CalendarBoardCommanding~CalendarBoardOpx~MailF~6f15d4f6.js.map
self.scriptsLoaded['owa.MailBoot~AgendaView~CalendarBoard~CalendarBoardAssets~CalendarBoardCommanding~CalendarBoardOpx~MailF~6f15d4f6.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AgendaView~CalendarBoard~CalendarBoardAssets~CalendarBoardCommanding~CalendarBoardOpx~MailF~6f15d4f6.js'] = (new Date()).getTime();