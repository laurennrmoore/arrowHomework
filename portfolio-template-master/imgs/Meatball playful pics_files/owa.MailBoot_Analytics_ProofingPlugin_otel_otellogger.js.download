self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Analytics~ProofingPlugin~otel~otellogger.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[139],{10555:function(n,t,e){"use strict";e.d(t,"a",(function(){return s}));var i=e(4044),r=e(8585),o=i.a.isFunction,u="getPlugin",s=function(){function n(){var n=this,t=!1,e=null,i=null;n.core=null,n.diagLog=function(t){return n._getTelCtx(t).diagLog()},n.isInitialized=function(){return t},n.setInitialized=function(n){t=n},n.setNextPlugin=function(n){i=n},n.processNext=function(n,t){t?t.processNext(n):i&&o(i.processTelemetry)&&i.processTelemetry(n,null)},n._getTelCtx=function(t){void 0===t&&(t=null);var o=t;if(!o){var s=e||new r.a(null,{},n.core);o=i&&i[u]?s.createNew(null,i[u]):s.createNew(null,i)}return o},n._baseTelInit=function(o,s,a,c){o&&(o.extensionConfig=o.extensionConfig||[]),!c&&s&&(c=s.getProcessTelContext().getNext());var f=i;i&&i[u]&&(f=i[u]()),n.core=s,e=new r.a(c,o,s,f),t=!0}}return n.prototype.initialize=function(n,t,e,i){this._baseTelInit(n,t,e,i)},n}()},10560:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var i={Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}},10562:function(n,t,e){"use strict";e.d(t,"a",(function(){return o}));var i=e(4044),r=e(3297),o=function(){function n(t){this.listeners=[];var e=i.a.arrForEach,o=!!(t||{}).perfEvtsSendAll;Object(r.a)(n,this,(function(n){n.addNotificationListener=function(t){n.listeners.push(t)},n.removeNotificationListener=function(t){for(var e=i.a.arrIndexOf(n.listeners,t);e>-1;)n.listeners.splice(e,1),e=i.a.arrIndexOf(n.listeners,t)},n.eventsSent=function(t){e(n.listeners,(function(n){n&&n.eventsSent&&setTimeout((function(){return n.eventsSent(t)}),0)}))},n.eventsDiscarded=function(t,i){e(n.listeners,(function(n){n&&n.eventsDiscarded&&setTimeout((function(){return n.eventsDiscarded(t,i)}),0)}))},n.eventsSendRequest=function(t,i){e(n.listeners,(function(n){if(n&&n.eventsSendRequest)if(i)setTimeout((function(){return n.eventsSendRequest(t,i)}),0);else try{n.eventsSendRequest(t,i)}catch(n){}}))},n.perfEvent=function(t){t&&(!o&&t.isChildEvt()||e(n.listeners,(function(n){if(n&&n.perfEvent)if(t.isAsync)setTimeout((function(){return n.perfEvent(t)}),0);else try{n.perfEvent(t)}catch(n){}})))}}))}return n.prototype.addNotificationListener=function(n){},n.prototype.removeNotificationListener=function(n){},n.prototype.eventsSent=function(n){},n.prototype.eventsDiscarded=function(n,t){},n.prototype.eventsSendRequest=function(n,t){},n}()},10563:function(n,t,e){"use strict";e.d(t,"a",(function(){return c})),e.d(t,"b",(function(){return f}));var i=e(4044),r=i.a.isFunction,o="processTelemetry",u="priority",s="setNextPlugin",a="isInitialized";function c(n,t){for(var e=[],u=null,c=n.getNext();c;){var f=c.getPlugin();f&&(u&&r(u[s])&&r(f[o])&&u[s](f),r(f[a])&&f[a]()||e.push(f),u=f,c=c.getNext())}i.a.arrForEach(e,(function(e){e.initialize(n.getCfg(),n.core(),t,n.getNext())}))}function f(n){return n.sort((function(n,t){var e=0,i=r(t[o]);return r(n[o])?e=i?n[u]-t[u]:1:i&&(e=-1),e}))}},12337:function(n,t,e){"use strict";e.d(t,"a",(function(){return p}));var i=e(4044),r=e(12338),o=e(8585),u=e(10563),s=e(3297),a=e(6405),c="Extensions must provide callback to initialize",f=i.a.arrForEach,l=i.a.isNullOrUndefined,g="_notificationManager",p=function(){function n(){var t,e,p,v,d=!1;Object(s.a)(n,this,(function(n){n._extensions=new Array,e=new r.a,n.logger=i.a.objCreate({throwInternal:function(n,t,e,i,r){void 0===r&&(r=!1)},warnToConsole:function(n){},resetInternalMessageCount:function(){}}),t=[],n.isInitialized=function(){return d},n.initialize=function(t,i,r,s){if(n.isInitialized())throw Error("Core should not be initialized more than once");if(!t||l(t.instrumentationKey))throw Error("Please provide instrumentation key");p=s,n[g]=s,n.config=t||{},t.extensions=l(t.extensions)?[]:t.extensions,(t.extensionConfig=l(t.extensionConfig)?{}:t.extensionConfig).NotificationManager=s,r&&(n.logger=r);var a=[];a.push.apply(a,i.concat(t.extensions)),a=Object(u.b)(a);var v=[],y=[],h={};if(f(a,(function(n){if(l(n)||l(n.initialize))throw Error(c);var t=n.priority,i=n.identifier;n&&t&&(l(h[t])?h[t]=i:r.warnToConsole("Two extensions have same priority #"+t+" - "+h[t]+", "+i)),!t||t<e.priority?v.push(n):y.push(n)})),a.push(e),v.push(e),a=Object(u.b)(a),n._extensions=a,Object(u.a)(new o.a([e],t,n),a),Object(u.a)(new o.a(v,t,n),a),n._extensions=v,0===n.getTransmissionControls().length)throw new Error("No channels available");d=!0,n.releaseQueue()},n.getTransmissionControls=function(){return e.getChannelControls()},n.track=function(e){e.iKey||(e.iKey=n.config.instrumentationKey),e.time||(e.time=i.a.toISOString(new Date)),l(e.ver)&&(e.ver="4.0"),n.isInitialized()?n.getProcessTelContext().processNext(e):t.push(e)},n.getProcessTelContext=function(){var t=n._extensions,i=t;return t&&0!==t.length||(i=[e]),new o.a(i,n.config,n)},n.getNotifyMgr=function(){return p||(p=i.a.objCreate({addNotificationListener:function(n){},removeNotificationListener:function(n){},eventsSent:function(n){},eventsDiscarded:function(n,t){},eventsSendRequest:function(n,t){}}),n[g]=p),p},n.getPerfMgr=function(){return v||n.config&&n.config.enablePerfMgr&&(v=new a.a(n.getNotifyMgr())),v},n.setPerfMgr=function(n){v=n},n.eventCnt=function(){return t.length},n.releaseQueue=function(){t.length>0&&(f(t,(function(t){n.getProcessTelContext().processNext(t)})),t=[])}}))}return n.prototype.initialize=function(n,t,e,i){},n.prototype.getTransmissionControls=function(){return null},n.prototype.track=function(n){},n.prototype.getProcessTelContext=function(){return null},n.prototype.getNotifyMgr=function(){return null},n.prototype.getPerfMgr=function(){return null},n.prototype.setPerfMgr=function(n){},n.prototype.eventCnt=function(){return 0},n.prototype.releaseQueue=function(){},n}()},12338:function(n,t,e){"use strict";(function(n){e.d(t,"a",(function(){return l}));var i=e(4044),r=e(10555),o=e(8585),u=e(10563),s=e(3297),a=500,c="Channel has invalid priority",f=i.a.objDefineAccessors,l=function(t){function e(){var n=t.call(this)||this;n.identifier="ChannelControllerPlugin",n.priority=a;var r,f=i.a.arrForEach;function l(n){n&&n.length>0&&(function(n){f(n,(function(n){if(n.priority<a)throw Error(c+n.identifier)}))}(n=n.sort((function(n,t){return n.priority-t.priority}))),r.push(n))}return Object(s.a)(e,n,(function(t,e){t.setNextPlugin=function(n){},t.processTelemetry=function(t,e){r&&f(r,(function(i){i.length>0&&n._getTelCtx(e).createNew(i).processNext(t)}))},t.getChannelControls=function(){return r},t.initialize=function(n,s,c){t.isInitialized()||(e.initialize(n,s,c),n.isCookieUseDisabled&&i.a.disableCookies(),function(n,t){r=[],n&&f(n,(function(n){return l(n)}));if(t){var e=[];f(t,(function(n){n.priority>a&&e.push(n)})),l(e)}}((n||{}).channels,c),f(r,(function(t){return Object(u.a)(new o.a(t,n,s),c)})))}})),n}return n(e,t),e.prototype.processTelemetry=function(n,t){},e.prototype.getChannelControls=function(){return null},e.prototype.initialize=function(n,t,e){},e._staticInit=(f(e.prototype,"ChannelControls",e.prototype.getChannelControls),void f(e.prototype,"channelQueue",e.prototype.getChannelControls)),e}(r.a)}).call(this,e(3126).__extendsFn)},17958:function(n,t,e){"use strict";(function(n){e.d(t,"a",(function(){return f}));var i=e(12337),r=e(10560),o=e(10562),u=e(4044),s=e(6405),a=e(8659),c=e(3297),f=function(t){function e(){var n=t.call(this)||this;return Object(c.a)(e,n,(function(n,t){function e(t){var e=n.getNotifyMgr();e&&e.eventsDiscarded([t],r.a.InvalidEvent)}n.initialize=function(n,e,i,r){t.initialize(n,e,i||new a.a(n),r||new o.a(n))},n.track=function(i){Object(s.b)(n.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){if(null===i)throw e(i),Error("Invalid telemetry item");!function(n){if(u.a.isNullOrUndefined(n.name))throw e(n),Error("telemetry name required")}(i),t.track(i)}),(function(){return{item:i}}),!i.sync)},n.addNotificationListener=function(t){var e=n.getNotifyMgr();e&&e.addNotificationListener(t)},n.removeNotificationListener=function(t){var e=n.getNotifyMgr();e&&e.removeNotificationListener(t)},n.pollInternalLogs=function(t){var e=n.config.diagnosticLogInterval;return e&&e>0||(e=1e4),setInterval((function(){var e=n.logger?n.logger.queue:[];u.a.arrForEach(e,(function(e){var i={name:t||"InternalMessageId: "+e.messageId,iKey:n.config.instrumentationKey,time:u.a.toISOString(new Date),baseType:a.b.dataType,baseData:{message:e.message}};n.track(i)})),e.length=0}),e)}})),n}return n(e,t),e.prototype.initialize=function(n,t,e,i){},e.prototype.track=function(n){},e.prototype.addNotificationListener=function(n){},e.prototype.removeNotificationListener=function(n){},e.prototype.pollInternalLogs=function(n){return 0},e}(i.a)}).call(this,e(3126).__extendsFn)},3297:function(n,t,e){"use strict";
/*!
 * Microsoft Dynamic Proto Utility, 1.1.0
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */var i="constructor",r="prototype",o="function",u="_dynInstFuncs",s="_isDynProxy",a="_dynClass",c="_dynCls$",f="_dynInstChk",l=f,g="_dfOpts",p="_unknown_",v="__proto__",d="useBaseInst",y="setInstFuncs",h=Object.getPrototypeOf,C=0;function x(n,t){return n&&Object[r].hasOwnProperty.call(n,t)}function m(n){return typeof n===o}function w(n){return n&&(n===Object[r]||n===Array[r])}function N(n){return w(n)||n===Function[r]}function I(n){if(n){if(h)return h(n);var t=n[v]||n[r]||n[i];if(t)return t}return null}function b(n,t,e){return t!==i&&m(n[t])&&(e||x(n,t))}function T(n){throw new TypeError("DynamicProto: "+n)}function L(n,t){for(var e=n.length-1;e>=0;e--)if(n[e]===t)return!0;return!1}function P(n,t,e,i){var r=null;if(n&&x(e,a)){var s=n[u]||{};if((r=(s[e[a]]||{})[t])||T("Missing ["+t+"] "+o),!r[f]&&!1!==s[l]){for(var c=!x(n,t),g=I(n),p=[];c&&g&&!N(g)&&!L(p,g);){var v=g[t];if(v){c=v===i;break}p.push(g),g=I(g)}try{c&&(n[t]=r),r[f]=1}catch(n){s[l]=!1}}}return r}function E(n,t,e){var i=t[n];return i===e&&(i=I(t)[n]),m(i)||T("["+n+"] is not a "+o),i}function _(n,t){return x(n,r)?n.name||t||p:((n||{})[i]||{}).name||t||p}function M(n,t,e,i){x(n,r)||T("theClass is an invalid class definition.");var o=n[r];(function(n,t){for(var e=I(t);e&&!N(e);){if(e===n)return!0;e=I(e)}return!1})(o,t)||T("["+_(n)+"] is not in class hierarchy of ["+_(t)+"]");var f=null;x(o,a)?f=o[a]:(f=c+_(n,"_")+"$"+C,C++,o[a]=f);var p=M[g],v=!!p[d];v&&i&&void 0!==i[d]&&(v=!!i[d]);var m=function(n){var t={};for(var e in n)!t[e]&&b(n,e,!1)&&(t[e]=n[e]);return t}(t);e(t,function(n,t,e,i){function r(n,t,e){var r=t[c];if(r[s]&&i){var o=n[u]||{};!1!==o[l]&&(r=(o[t[a]]||{})[e]||r)}return function(){return r.apply(n,arguments)}}var o={};for(var c in e)o[c]=r(t,e,c);for(var f=I(n),g=[];f&&!N(f)&&!L(g,f);){for(var c in f)!o[c]&&b(f,c,!h)&&(o[c]=r(t,f,c));g.push(f),f=I(f)}return o}(o,t,m,v));var O=!!h&&!!p[y];O&&i&&(O=!!i[y]),function(n,t,e,i,r){function o(n,t){var e=function(){var i=P(this,t,n,e)||E(t,n,e);return i.apply(this,arguments)};return e[s]=1,e}if(!w(n)){var a=e[u]=e[u]||{},c=a[t]=a[t]||{};for(var f in!1!==a[l]&&(a[l]=!!r),e)b(e,f,!1)&&e[f]!==i[f]&&(c[f]=e[f],delete e[f],(!x(n,f)||n[f]&&!n[f][s])&&(n[f]=o(n,f)))}}(o,f,t,m,!1!==O)}M[g]={setInstFuncs:!0,useBaseInst:!0},t.a=M},6405:function(n,t,e){"use strict";e.d(t,"a",(function(){return s})),e.d(t,"b",(function(){return c}));var i=e(3297),r=e(4044),o="ctx",u=function(){function n(t,e,i){var u,s=this,a=!1;(s.start=r.a.dateNow(),s.name=t,s.isAsync=i,s.isChildEvt=function(){return!1},r.a.isFunction(e))&&(a=r.a.objDefineAccessors(s,"payload",(function(){return!u&&r.a.isFunction(e)&&(u=e(),e=null),u})));s.getCtx=function(t){return t?t===n.ParentContextKey||t===n.ChildrenContextKey?s[t]:(s[o]||{})[t]:null},s.setCtx=function(t,e){if(t)if(t===n.ParentContextKey)s[t]||(s.isChildEvt=function(){return!0}),s[t]=e;else if(t===n.ChildrenContextKey)s[t]=e;else{(s[o]=s[o]||{})[t]=e}},s.complete=function(){var t=0,i=s.getCtx(n.ChildrenContextKey);if(r.a.isArray(i))for(var o=0;o<i.length;o++){var u=i[o];u&&(t+=u.time)}s.time=r.a.dateNow()-s.start,s.exTime=s.time-t,s.complete=function(){},!a&&r.a.isFunction(e)&&(s.payload=e())}}return n.ParentContextKey="parent",n.ChildrenContextKey="childEvts",n}(),s=function(){function n(t){this.ctx={},Object(i.a)(n,this,(function(n){n.create=function(n,t,e){return new u(n,t,e)},n.fire=function(n){n&&(n.complete(),t&&t.perfEvent(n))},n.setCtx=function(t,e){t&&((n[o]=n[o]||{})[t]=e)},n.getCtx=function(t){return(n[o]||{})[t]}}))}return n.prototype.create=function(n,t,e){return null},n.prototype.fire=function(n){},n.prototype.setCtx=function(n,t){},n.prototype.getCtx=function(n){},n}(),a="CoreUtils.doPerf";function c(n,t,e,i,o){if(n){var s=n;if(s&&r.a.isFunction(s.getPerfMgr)&&(s=s.getPerfMgr()),s){var c=void 0,f=s.getCtx(a);try{if(c=s.create(t(),i,o)){if(f&&c.setCtx&&(c.setCtx(u.ParentContextKey,f),f.getCtx&&f.setCtx)){var l=f.getCtx(u.ChildrenContextKey);l||(l=[],f.setCtx(u.ChildrenContextKey,l)),l.push(c)}return s.setCtx(a,c),e(c)}}catch(n){c&&c.setCtx&&c.setCtx("exception",n)}finally{c&&s.fire(c),s.setCtx(a,f)}}}return e()}},8585:function(n,t,e){"use strict";var i=e(4044),r=e(8659),o=e(6405),u=e(8654),s=i.a.isFunction,a=function(n,t){var e=this,i=null,r=s(n.processTelemetry),a=s(n.setNextPlugin);e._hasRun=!1,e.getPlugin=function(){return n},e.getNext=function(){return i},e.setNext=function(n){i=n},e.processTelemetry=function(s,c){c||(c=t);var f=n?n.identifier:"TelemetryPluginChain";Object(o.b)(c?c.core():null,(function(){return f+":processTelemetry"}),(function(){if(n&&r){e._hasRun=!0;try{c.setNext(i),a&&n.setNextPlugin(i),i&&(i._hasRun=!1),n.processTelemetry(s,c)}catch(e){var t=i&&i._hasRun;i&&t||c.diagLog().throwInternal(u.a.CRITICAL,u.b.PluginException,"Plugin ["+n.identifier+"] failed during processTelemetry - "+e),i&&!t&&i.processTelemetry(s,c)}}else i&&(e._hasRun=!0,i.processTelemetry(s,c))}),(function(){return{item:s}}),!s.sync)}};e.d(t,"a",(function(){return l}));var c=i.a.isNullOrUndefined;function f(n,t){var e=[];if(n&&n.length>0)for(var r=null,o=0;o<n.length;o++){var u=n[o];if(u&&i.a.isFunction(u.processTelemetry)){var s=new a(u,t);e.push(s),r&&r.setNext(s),r=s}}return e.length>0?e[0]:null}var l=function n(t,e,o,u){var s=this,a=null;null!==u&&(t&&i.a.isFunction(t.getPlugin)?a=function(n,t,e){var i=[],r=!e;if(n)for(;n;){var o=n.getPlugin();(r||o===e)&&(r=!0,i.push(o)),n=n.getNext()}return r||i.push(e),f(i,t)}(t,s,u||t.getPlugin()):u?a=function(n,t,e){var r=n,o=!1;return e&&n&&(r=[],i.a.arrForEach(n,(function(n){(o||n===e)&&(o=!0,r.push(n))}))),e&&!o&&(r||(r=[]),r.push(e)),f(r,t)}(t,s,u):i.a.isUndefined(u)&&(a=f(t,s))),s.core=function(){return o},s.diagLog=function(){var n=(o||{}).logger;return n||(n=new r.a(e||{})),n},s.getCfg=function(){return e},s.getExtCfg=function(n,t){var i;if(void 0===t&&(t={}),e){var r=e.extensionConfig;r&&n&&(i=r[n])}return i||t},s.getConfig=function(n,t,i){var r;void 0===i&&(i=!1);var o=s.getExtCfg(n,null);return o&&!c(o[t])?r=o[t]:e&&!c(e[t])&&(r=e[t]),c(r)?i:r},s.hasNext=function(){return null!=a},s.getNext=function(){return a},s.setNext=function(n){a=n},s.processNext=function(n){var t=a;t&&(a=t.getNext(),t.processTelemetry(n,s))},s.createNew=function(t,i){return void 0===t&&(t=null),new n(t||a,e,o,i)}}},8659:function(n,t,e){"use strict";e.d(t,"b",(function(){return l})),e.d(t,"a",(function(){return g}));var i=e(8654),r=e(4044),o=e(3620),u=e(3297),s="AI (Internal): ",a="AI: ",c="AITR_";function f(n){return n?'"'+n.replace(/\"/g,"")+'"':""}var l=function(){function n(n,t,e,i){void 0===e&&(e=!1);this.messageId=n,this.message=(e?a:s)+n;var r="";Object(o.l)()&&(r=Object(o.f)().stringify(i));var u=(t?" message:"+f(t):"")+(i?" props:"+f(r):"");this.message+=u}return n.dataType="MessageData",n}(),g=function(){function n(t){this.identifier="DiagnosticLogger",this.queue=[];var e=0,s={};Object(u.a)(n,this,(function(n){var u=r.a.isNullOrUndefined,a=r.a.isUndefined,f=r.a.isFunction;function g(n,e){var i=t[n];return u(i)?e:i}u(t)&&(t={}),n.consoleLoggingLevel=function(){return g("loggingLevelConsole",0)},n.telemetryLoggingLevel=function(){return g("loggingLevelTelemetry",1)},n.maxInternalMessageLimit=function(){return g("maxMessageLimit",25)},n.enableDebugExceptions=function(){return g("enableDebugExceptions",!1)},n.throwInternal=function(t,e,r,o,u){void 0===u&&(u=!1);var c=new l(e,r,u,o);if(n.enableDebugExceptions())throw c;if(!a(c)&&c&&!a(c.message)){if(u){var f=+c.messageId;!s[f]&&n.consoleLoggingLevel()>=i.a.WARNING&&(n.warnToConsole(c.message),s[f]=!0)}else n.consoleLoggingLevel()>=i.a.WARNING&&n.warnToConsole(c.message);n.logInternalMessage(t,c)}},n.warnToConsole=function(n){var t=Object(o.a)();if(t){var e="log";t.warn&&(e="warn"),f(t[e])&&t[e](n)}},n.resetInternalMessageCount=function(){e=0,s={}},n.logInternalMessage=function(t,r){if(!(e>=n.maxInternalMessageLimit())){var o=!0,u=c+r.messageId;if(s[u]?o=!1:s[u]=!0,o&&(t<=n.telemetryLoggingLevel()&&(n.queue.push(r),e++),e===n.maxInternalMessageLimit())){var a="Internal events throttle limit per PageView reached for this app.",f=new l(i.b.MessageLimitPerPVExceeded,a,!1);n.queue.push(f),n.warnToConsole(a)}}}}))}return n.prototype.enableDebugExceptions=function(){return!1},n.prototype.consoleLoggingLevel=function(){return 0},n.prototype.telemetryLoggingLevel=function(){return 1},n.prototype.maxInternalMessageLimit=function(){return 25},n.prototype.throwInternal=function(n,t,e,i,r){void 0===r&&(r=!1)},n.prototype.warnToConsole=function(n){},n.prototype.resetInternalMessageCount=function(){},n.prototype.logInternalMessage=function(n,t){},n}()}}]);
//# sourceMappingURL=owa.MailBoot~Analytics~ProofingPlugin~otel~otellogger.js.map
self.scriptsLoaded['owa.MailBoot~Analytics~ProofingPlugin~otel~otellogger.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Analytics~ProofingPlugin~otel~otellogger.js'] = (new Date()).getTime();