self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentFilePicker.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[537],{1969:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1992:function(e,t,n){"use strict";var r=n(1963),i=n(2210),o=n(6);function a(e){var t;return e>=1073741824?(e/=1073741824,t=Object(o.b)(i.b)):e>=1048576?(e/=1048576,t=Object(o.b)(i.d)):e>=1024?(e/=1024,t=Object(o.b)(i.c)):t=Object(o.b)(i.a),Object(o.c)(t,Math.round(e))}var c,u=n(2061),l=n(24),s=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function f(e){if(!Object(l.i)("doc-attachment-documentThumbnail"))return!1;var t=Object(r.a)(e);return!!t&&s.indexOf(t.toLowerCase())>=0}function d(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return c.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return c.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return c.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(c||(c={}));var p=n(2019);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return a})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return f})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return p.b})),n.d(t,"a",(function(){return c}))},2019:function(e,t,n){"use strict";function r(e){return t=e||"",(n=o.exec(t))&&n.length>1&&i[n[1].toLowerCase()];var t,n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},o=/^\s*([^;\s]*)(?:;|\s|$)/;function a(e){var t="";return Object.entries(i).forEach((function(n){n[1]===e&&(t=n[0])})),t}},2061:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(1963),i=n(2019),o=n(102),a=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],c=[".tiff",".tif"];function u(e,t,n){return void 0===n&&(n=!0),l(Object(r.a)(e)||Object(i.a)(t),n)}function l(e,t){return void 0===t&&(t=!0),!!e&&(a.indexOf(e.toLowerCase())>=0||t&&c.indexOf(e.toLowerCase())>=0&&(Object(o.e)()||Object(o.d)()||Object(o.h)()||Object(o.g)()&&!Object(o.l)()))}},2065:function(e,t,n){"use strict";var r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function i(e){var t=null,n=r.exec(e);if(n){var i=n[1],o=n[2],a=null;try{a=atob(o)}catch(e){}if(a){for(var c=new ArrayBuffer(a.length),u=new Uint8Array(c),l=0;l<a.length;l++)u[l]=a.charCodeAt(l);t=new File([c],"image.png",{type:i})}}return t}var o=n(1969),a=n(1992);function c(e){return e.map((function(e){return{fileType:o.a.Uri,name:e.name,type:Object(a.b)(e.url)||"",size:0,uri:e.url}}))}var u=n(23);function l(e,t,n){if(e.length!=t.length)return u.d("The sizes of subjects and latestItemIds are different"),null;for(var r=[],i=0;i<e.length;i++){var a={fileType:o.a.MailItem,name:e[i],size:(null==n?void 0:n[i])||0,itemId:t[i]};r.push(a)}return r}function s(e,t,n){var r=[],i={fileType:o.a.MailItem,name:e,size:n||0,mimeContent:t};return r.push(i),r}function f(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],i={fileType:o.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};t.push(i)}return t}function d(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(i)}return t}function p(e){var t,n;return null===e?null:{fileType:o.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function h(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:o.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var m={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function b(e){switch(e?e.toLowerCase():null){case m.ONE_DRIVE_PRO.toLowerCase():return 0;case m.GDRIVE.toLowerCase():return 5;case m.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case m.DROPBOX.toLowerCase():return 2;case m.BOX.toLowerCase():return 3;case m.WOPI_BOX.toLowerCase():return 7;case m.WOPI_EGNYTE.toLowerCase():return 8;case m.MAILBOX.toLowerCase():return 4;case m.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"f",(function(){return i})),n.d(t,"j",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return f})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return o.a}))},2210:function(e){e.exports=JSON.parse('{"b":"Nea","d":"Oea","c":"Pea","a":"Qea"}')},5745:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n(2065),o=n(24),a=n(2092);function c(e,t,n,r){u(e,Object(i.g)(t),r,n)}function u(e,t,n,r,i){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=null),e({files:t,shouldShare:n,isInline:r,dataProviderType:i})}function l(e,t,n,r,l,s,f,d){if(r===a.h.LocalComputerFiles)l===a.b.Share&&d&&t?t({files:Object(i.g)(n),dataProviderType:null,targetWindow:f}):c(e,n,l===a.b.InsertInlineImage,l===a.b.Share);else if(r===a.h.ProviderFiles)if(t&&function(e,t){return!!e&&(Object(o.i)("cmp-hyperlinkContextMenu")?t===a.b.InsertAsLink:t===a.b.Share&&Object(o.i)("doc-link-filePicker"))}(s,l))!function(e,t,n,r){if(t&&0!==t.length&&n===a.h.ProviderFiles){var o=t,c=o[0].model.ProviderType;e({files:o.map((function(e){return Object(i.e)(e.model)})),dataProviderType:c,targetWindow:r})}}(t,n,r,f);else{var p=n;l!==a.b.AttachAndShare?function(e,t,n){if(t&&0!==t.length){var r=t[0].model.ProviderType,o=null;if(r&&10===r){var a=[],c=[];t.forEach((function(e){a.push(e.model.Subject),c.push(e.model.Id)})),o=Object(i.i)(a,c)}else o=t.map((function(e){return Object(i.e)(e.model)}));u(e,o,n,!1,r)}}(e,p,l===a.b.Share):function(e,t){var n=t.length>0?t[0].model.ProviderType:null,r=t.filter((function(e){return null!==e.location})),o=t.filter((function(e){return null===e.location}));r.length>0&&u(e,r.map((function(e){return Object(i.e)(e.model)})),!0,!1,n),o.length>0&&u(e,o.map((function(e){return Object(i.c)(e.model)})),!1,!1,n)}(e,p)}}var s=n(19),f=n(197),d=1,p=2,h=3;function m(){switch(Object(s.a)().ViewStateConfiguration.AttachmentsFilePickerViewTypeForMouse){case d:return a.d.List;case p:return a.d.Tile;default:return Object(f.a)()?a.d.Tile:a.d.List}}var b=n(94);var v=n(57),g=n(121);function O(e){var t=function(e){switch(e){case a.d.List:return d;case a.d.Tile:return p;case a.d.Groups:return h;default:return Object(b.a)(e)}}(e);Object(g.s)("AFPChangePreferredViewType",[]),Object(v.A)((function(e){e.ViewStateConfiguration.AttachmentsFilePickerViewTypeForMouse=t}),[{key:"AttachmentsFilePickerViewTypeForMouse",valuetype:"Integer32",value:[""+t]}],"OWA.ViewStateConfiguration")}var I="OWA.ViewStateConfiguration";function w(e){Object(g.s)("AFPSetUserPrefferdAction",[e]),Object(v.A)((function(t){t.ViewStateConfiguration.AttachOrShareCloudFiles=e}),[{key:"AttachOrShareCloudFiles",valuetype:"Integer32",value:[""+e]}],I)}function j(e){Object(g.s)("AFPSetUserPreferredActionGroups",[e]),Object(v.A)((function(t){t.ViewStateConfiguration.AttachOrShareGroupsFiles=e}),[{key:"AttachOrShareGroupsFiles",valuetype:"Integer32",value:[""+e]}],I)}function S(){var e=Object(s.a)();return{preferredViewType:{value:m(),valueSetter:O},attachOrShareCloudFiles:{value:e.ViewStateConfiguration.AttachOrShareCloudFiles,valueSetter:w},attachOrShareGroupsFiles:{value:e.ViewStateConfiguration.AttachOrShareGroupsFiles,valueSetter:j}}}var C=n(23);function P(e,t,n,i,o,c,u,s,f){return Object(r.c)(this,void 0,void 0,(function(){var d,p;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,a.k.import()];case 1:d=r.sent(),p=S();try{if(!n||0==n.length)throw new Error("files length cannot be 0.");return[2,d(n,c,i,n[0].type===a.e.Group,n.length>1,o,s,p,u).then((function(r){l(e,t,n,o,r,!0,s,f)})).catch((function(){}))]}catch(e){C.d("Error creating the action panel. Attaching or sharing files might not work! "+e)}return[2]}}))}))}function y(e,t,n){return Object(r.c)(this,void 0,void 0,(function(){var i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,a.l.import()];case 1:i=r.sent(),n.userConfiguration||(n.userConfiguration=S());try{return[2,i(n).then((function(r){l(e,t,r.files,r.source,r.action,r.supportsInsertLink,n.targetWindow,!1)})).catch((function(){}))]}catch(e){C.d("Error creating the file picker. Attaching or sharing files might not work! "+e)}return[2]}}))}))}var A=n(858),F=n(2970),x=n(0),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.localComputerFilePicker=x.createRef(),t.onFilesSelected=function(e){var n=t.props,r=n.action;c(n.createAttachmentHandler,e,r===F.c.InsertInlineImage,r===F.c.Share)},t}return Object(r.e)(t,e),t.prototype.render=function(){return x.createElement(a.g,{ref:this.localComputerFilePicker,onFilesSelected:this.onFilesSelected,fileSelectionFilter:this.props.fileSelectionFilter})},t.prototype.click=function(){this.localComputerFilePicker.current&&this.localComputerFilePicker.current.click()},t=Object(r.d)([A.observer],t)}(x.Component),T=n(1992);function L(e,t){for(var n=e.files,r=e.shouldShare,i=e.isInline,o=e.dataProviderType,a=[],c=0;n[c];)a=a.concat(n[c].size),c++;var u=function(e){for(var t=[],n=0;e[n];)t=t.concat(Object(T.b)(e[n].name)),n++;return t}(n);Object(g.s)("AFPAttachOrShare",[r,i,a.join(","),n.length,o,u.join(","),!1,t],{isCore:!0,excludeFromKusto:!0})}n.d(t,"attachmentActionsPanel",(function(){return P})),n.d(t,"attachmentFilePicker",(function(){return y})),n.d(t,"AttachmentLocalComputerFilePicker",(function(){return E})),n.d(t,"logAttachOrShareDatapoint",(function(){return L}))}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentFilePicker.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentFilePicker.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentFilePicker.js'] = (new Date()).getTime();