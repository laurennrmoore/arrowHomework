self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~bdaa698b.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[42],{2518:function(e,t,n){"use strict";var r=n(3167),o=n(4860);function i(e){var t;try{t=btoa(e)}catch(n){t=btoa(unescape(encodeURIComponent(e)))}finally{return"u!"+t.replace(/=+$/,"").replace("/","_").replace("+","-")}}n.d(t,"d",(function(){return r.d})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"e",(function(){return r.e})),n.d(t,"c",(function(){return r.c})),n.d(t,"f",(function(){return o.a})),n.d(t,"g",(function(){return i}))},2774:function(e,t,n){"use strict";var r=n(1),o="https://www.googleapis.com/drive/v3/files",i=n(3426);function s(e,t,n){return void 0===n&&(n={forceTokenRefresh:!1,requestInit:{}}),Object(r.c)(this,void 0,void 0,(function(){var o,s,c;return Object(r.f)(this,(function(r){switch(r.label){case 0:return o=n.forceTokenRefresh,s=n.requestInit||{},[4,Object(i.d)(t,o,e)];case 1:return c=r.sent(),s.headers||(s.headers=new Headers),s.headers.set("Authorization",c),[4,fetch(e,s)];case 2:return[2,r.sent()]}}))}))}function c(e,t){return void 0===t&&(t=!1),Object(r.c)(this,void 0,void 0,(function(){var n,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,s(o+"?"+e,5,{forceTokenRefresh:t})];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i)}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}function u(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,s(o+"/"+e+"?fields=id,mimeType,name,size,modifiedTime,createdTime,thumbnailLink,webViewLink,webContentLink,fileExtension",5)];case 1:return(t=r.sent()).ok?[4,t.text()]:[3,3];case 2:return n=r.sent(),[2,{errorResponse:null,result:JSON.parse(n)}];case 3:return[2,{errorResponse:t,result:null}]}}))}))}var a=n(94),l=n(2518),d=n(295),f=Object.freeze({name:"name",size:"size",lastModifiedBy:"lastModifiedBy",lastModifiedDateTime:"lastModifiedDateTime",file:"file",folder:"folder",id:"id",webDavUrl:"webDavUrl",package:"package",shared:"shared"});function h(){return Object.keys(f).map((function(e){return f[e]})).join(",")}var b,p="_api/v2.0",v="/v1.0",O="root";function m(e){switch(e){case 1:return v;case 0:return p;default:return Object(a.a)(e)}}function j(e){return m(e)+"/drive"}function w(e){return m(e)+"/shares"}function y(e){return j(e)+"/items"}function k(e,t,n,o,i,s,c){return void 0===s&&(s=b.None),Object(r.c)(this,void 0,void 0,(function(){var u,p,v,m,j,w,k,S,g;return Object(r.f)(this,(function(r){switch(r.label){case 0:return i=i||O,u=function(e){switch(e){case 0:return f.name;case 1:return f.size;default:return f.lastModifiedDateTime}}(n),p=function(e){switch(e){case 0:return"asc";case 1:return"desc";default:return Object(a.a)(e)}}(o),v=function(e,t,n){switch(e){case 0:return"folder,"+t+" "+n;case 1:return t+" "+n;default:return Object(a.a)(e)}}(t,u,p),m="expand=thumbnails(select=medium)&orderby="+v+"&select="+h(),s!==b.None&&(m=m+"&filter="+function(e){switch(e){case b.None:return"";case b.Folder:return"("+f.folder+" ne null)";default:return Object(a.a)(e)}}(s)),c&&(m=m+"&$top="+c.maxEntries,c.skipToken&&(m=m+"&$skiptoken="+c.skipToken)),j=e+"/"+y(t)+"/"+i+"/children?"+m,w={Prefer:"HonorNonIndexedQueriesWarningMayFailRandomly"},[4,Object(l.f)(t,encodeURI(j),j,{method:l.b,mode:l.a,datapointNamePrefix:"getOneDriveItems"},w)];case 1:return k=r.sent(),S=JSON.parse(k),g=S["@odata.nextLink"]?function(e){var t=Object(d.parse)(e,!0);return t.query?t.query.$skiptoken:null}(decodeURI(S["@odata.nextLink"])):null,[2,{errorResponse:null,result:{items:S.value,skipToken:g}}]}}))}))}function S(e,t,n,o){return Object(r.c)(this,void 0,void 0,(function(){var i,s,c,u,a;return Object(r.f)(this,(function(r){switch(r.label){case 0:o=o||O,i="expand=thumbnails(select=medium)&select="+h(),s=t+"/"+y(e)+"/"+o+"/children?"+i,c={name:n,folder:{}},(u=new Headers).append("Content-Type","application/json"),u.append("Accept","application/json"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l.f)(e,encodeURI(s),s,{method:l.d,mode:l.a,body:JSON.stringify(c),datapointNamePrefix:"createNewFolder"},null)];case 2:return a=r.sent(),[2,{errorResponse:null,result:JSON.parse(a)}];case 3:return[2,{errorResponse:r.sent(),result:null}];case 4:return[2]}}))}))}!function(e){e[e.None=0]="None",e[e.Folder=1]="Folder"}(b||(b={}));var g=n(7759),T=n(4860),R=n(217);var P=Object.freeze({folderInfo:{type:0,identifier:O},sliceSize:10485760,conflictBehavior:"rename",onProgress:function(){}});function x(e,t,n){var o=this,i=function(){return Promise.resolve({errorResponse:null,result:null})};return{uploadPromise:Object(r.c)(o,void 0,void 0,(function(){var o,s,c,u,d,f,h,b,p,v,O,m,w,k,S;return Object(r.f)(this,(function(x){switch(x.label){case 0:switch(function(e){Object.keys(P).forEach((function(t){e[t]=e[t]||P[t]}))}(n),o=n.fileToUpload,s=o.fileName,c=o.fileBlob,u=n.folderInfo,d=u.type,f=u.identifier,h=n.conflictBehavior,b=n.sliceSize,p=n.onProgress,d){case 0:v=t+"/"+y(e)+"/"+f+":/"+encodeURI(s)+":/createUploadSession";break;case 1:v=t+"/"+j(e)+"/"+f+":/"+encodeURI(s)+":/createUploadSession";break;default:Object(a.a)(d)}return O={item:{"@name.conflictBehavior":h}},[4,Object(T.a)(e,v,v,{method:l.d,mode:l.a,body:JSON.stringify(O),datapointNamePrefix:"createUploadSession"},null)];case 1:return m=x.sent(),w=function(e,t,n,o){var i=this,s=e.uploadUrl,c=t.size,u=null,l=null,d=function(e,t,n,o,i,s){var c=this;return function(u,a){return Object(r.c)(c,void 0,void 0,(function(){var c,l,d,f,h;return Object(r.f)(this,(function(r){switch(r.label){case 0:return c=function(e,t,n){var r=N(e,t,n),o=r.rangeStart,i=r.rangeEnd;return new Headers({"Content-Range":"bytes "+o+"-"+i+"/"+n,Accept:"application/json"})}(a,t,n),l=function(e){var r=N(e,t,n).rangeStart;return function(e){var t=e.loaded;o({loaded:r+t,total:n})}}(a),[4,(b=e,p=l,v={method:"PUT",body:u,headers:c},void 0===v&&(v={method:"POST"}),new Promise((function(e,t){var n=v.method,r=v.body,o=v.headers,i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&e({status:i.status,text:function(){return Promise.resolve(i.responseText)}})},i.ontimeout=function(){t(new Error("Request timed out"))},i.onerror=function(){t(new Error("Request failed"))},i.onabort=function(){t(new Error("Request aborted"))},p&&(i.upload.onprogress=p),i.open(n,b,!0),new Headers(o).forEach((function(e,t){i.setRequestHeader(t,e)})),r?i.send(r):i.send()})))];case 1:return 201!==(d=r.sent()).status&&200!==d.status?[3,3]:[4,d.text()];case 2:f=r.sent(),h=JSON.parse(f),i(h),r.label=3;case 3:if(!Object(R.a)(d.status))throw s(d),new Error("Unable to upload file");return[2]}var b,p,v}))}))}}(s,n,c,o,(function(e){u=e}),(function(e){l=e})),f=Object(g.a)(t,d,{sliceSize:n,numberOfSlicesToParallelize:1}),h=f.onCompletePromise,b=f.cancel,p=Object(r.c)(i,void 0,void 0,(function(){var e;return Object(r.f)(this,(function(t){switch(t.label){case 0:e=null,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,h];case 2:return e=t.sent(),[3,4];case 3:return t.sent(),[2,{errorResponse:l,result:null}];case 4:switch(e){case 0:return u?[2,{errorResponse:null,result:u}]:[2,{errorResponse:l,result:null}];case 1:throw new Error("Upload was cancelled");default:return[2,Object(a.a)(e)]}return[2]}}))}));return{uploadPromise:p,cancel:function(){return Object(r.c)(i,void 0,void 0,(function(){return Object(r.f)(this,(function(e){switch(e.label){case 0:b(),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,p];case 2:return e.sent(),[3,4];case 3:return[2,D(s)];case 4:return[2]}}))}))}}}(JSON.parse(m),c,b,p),k=w.uploadPromise,S=w.cancel,i=S,[2,k]}}))})),cancel:function(){return i()}}}function N(e,t,n){var r=e*t;return{rangeStart:r,rangeEnd:Math.min(r+t,n)-1}}function D(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,fetch(e,{method:"DELETE"})];case 1:return t=n.sent(),Object(R.a)(t.status)?[2,{errorResponse:null,result:null}]:[2,{errorResponse:t,result:null}]}}))}))}var E="https://api.dropboxapi.com/2/files";function A(e,t){switch(e){case 0:return t;case 1:return null;default:Object(a.a)(e)}return null}function z(e,t,n){return void 0===n&&(n=!1),Object(r.c)(this,void 0,void 0,(function(){var o,i,s;return Object(r.f)(this,(function(r){switch(r.label){case 0:switch(t){case 1:o="https://api.onedrive.com/v2.1/drive/recent?top=50";break;case 0:o=e+"/_api/v2.1/drive/recent?top=50";break;default:throw Error("OneDriveMRUItems only supports OneDrive providers!")}r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l.f)(t,o,o,{method:l.b,mode:l.a,datapointNamePrefix:"getOneDriveMRUItems"},null,n)];case 2:return s=r.sent(),i=JSON.parse(s),[3,4];case 3:return r.sent(),[3,4];case 4:return i?[2,{errorResponse:null,result:i}]:[2,{errorResponse:null,result:null}]}}))}))}function I(e){return"file"===e[".tag"]}function C(e){return"folder"===e[".tag"]}function U(e){return"deleted"===e[".tag"]}function F(e){return"folder"===e.type}function J(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n,o,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return e.path=e.path||"",t=E+"/list_folder",n={method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(e)},[4,s(t,2,{requestInit:n})];case 1:return(o=r.sent()).ok?[4,o.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i).entries}];case 3:return[2,{errorResponse:o,result:null}]}}))}))}var _,M="https://api.box.com/2.0",B=2e3;function q(e,t){return void 0===t&&(t=B),Object(r.c)(this,void 0,void 0,(function(){var n,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,s(M+"/folders/"+(e=e||"0")+"/items?fields=id,size,name,type,path_collection,modified_at,modified_by&limit="+t+"&offset=0",3)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return o=r.sent(),[2,{errorResponse:null,result:JSON.parse(o).entries}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}!function(e){e.Uploaded="uploaded",e.Tagged="tagged"}(_||(_={}));var H=_,L="https://graph.facebook.com/v2.7",V=200;function W(e,t){return void 0===t&&(t=V),Object(r.c)(this,void 0,void 0,(function(){var n,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,s(L+"/me/photos/?fields=id,name,images,from,link,album,place,created_time&type="+e.toString()+"&limit="+t,6)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return o=r.sent(),[2,{errorResponse:null,result:JSON.parse(o).data}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}var G=n(1302),$=n(1304),X=n(613),Q=n(1244),K=n(2067),Y=n(981),Z=n(180),ee=n(23);function te(e,t){var n=function(e,t){return Object($.a)({ParentFolderIds:[Object(X.a)({Id:e})],ItemShape:Object(Y.a)({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:"Shallow",Paging:t,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:null})}(e,t);return Object(G.a)({Header:Object(Z.b)(),Body:n})}function ne(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,o,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=Object(K.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),[4,te(e=e||Object(Q.a)("inbox"),n)];case 1:return o=r.sent(),(i=o.Body.ResponseMessages.Items[0])&&"Success"===i.ResponseClass&&i.RootFolder.Items?[2,{errorResponse:null,result:i.RootFolder.Items}]:(ee.g.warn("Find Item Response of get mail messages failed with "+i),[2,{errorResponse:{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},result:null}])}}))}))}n.d(t,"m",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"o",(function(){return k})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return S})),n.d(t,"w",(function(){return x})),n.d(t,"i",(function(){return j})),n.d(t,"r",(function(){return w})),n.d(t,"e",(function(){return"https://api.onedrive.com"})),n.d(t,"b",(function(){return"https://api.dropboxapi.com/2/sharing"})),n.d(t,"d",(function(){return o})),n.d(t,"q",(function(){return A})),n.d(t,"p",(function(){return z})),n.d(t,"u",(function(){return I})),n.d(t,"v",(function(){return C})),n.d(t,"t",(function(){return U})),n.d(t,"j",(function(){return J})),n.d(t,"s",(function(){return F})),n.d(t,"h",(function(){return q})),n.d(t,"a",(function(){return M})),n.d(t,"c",(function(){return H})),n.d(t,"k",(function(){return W})),n.d(t,"n",(function(){return ne}))},3167:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return c}));var r="POST",o="cors",i="GET",s="PUT",c="PATCH"},3262:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){return Object(r.a)({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},3426:function(e,t,n){"use strict";var r=n(1),o=n(5088),i=n.n(o),s=n(6),c=n(197),u=n(440),a=n(295),l=n(33);function d(e){return Object(r.a)({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}function f(e,t){return void 0===e||e.__type||(e=d(e)),Object(l.a)("GetAccessTokenforDataProvider",e,t)}function h(e,t,n,o){return Object(r.c)(this,void 0,void 0,(function(){var i,s,c,u;return Object(r.f)(this,(function(r){switch(r.label){case 0:return i=d({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1,ClaimsChallenge:o?atob(o):null}),s=n?"getAccessTokenForDataProvider_"+n:"getAccessTokenForDataProvider",(c=new Headers).append("X-OWA-ActionName",s),[4,f(i,{headers:c,datapoint:{customData:{actionSource:n},headersCustomData:function(e){return{tokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){return{tokenStatus:e.TokenResultCode.toString()}}},returnFullResponseOnSuccess:!0})];case 1:return[4,(u=r.sent()).json()];case 2:return[2,{token:r.sent(),response:u}]}}))}))}var b="onedrive_implicit.access",p="Bearer ",v=n(24),O=function(e,t,n){return Object(r.a)({resultCode:t,isAdalException:n,_typeSpec:"TokenRetrievalError"},e)},m=function(e){return"TokenRetrievalError"===e._typeSpec},j=[],w={},y=1,k=30,S="",g="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function T(e){w[e]=null}function R(e,t,n,o){return Object(r.c)(this,void 0,void 0,(function(){var i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,h(e,t,n,o)];case 1:return i=r.sent(),function(e,t,n){j=j.filter((function(e){return e!==t}));var r=n.token;if(0!==r.TokenResultCode||!r.AccessToken||""===r.AccessToken){var o="Access token request failed for token key "+e+" with response code "+r.TokenResultCode,i=n.response.headers.get("x-tokenresult"),s=null!=i&&i.indexOf(g)>0;throw O(new Error(o),r.TokenResultCode,s)}var c=w[e]||{};c[t]=r,w[e]=c}(e,t,i),[2,i.token]}}))}))}function P(e,t,n,o){return Object(r.c)(this,void 0,void 0,(function(){var i,c;return Object(r.f)(this,(function(r){return i=S,0===e&&n&&(c=Object(a.parse)(n),i=Object(s.c)("{0}//{1}/",c.protocol,c.hostname)),Object(v.i)("doc-attachment-testAuthFallback")?[2,""]:[2,N(e,i,t,null,o)]}))}))}function x(e,t,n){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(r){return[2,N(0,e,t,n)]}))}))}function N(e,t,n,o,s){return Object(r.c)(this,void 0,void 0,(function(){var c,u;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n||!function(e,t){var n=w[e];if(!n)return!1;var r=n[t];if(!r||!r.AccessTokenExpiry)return!1;var o=new Date(r.AccessTokenExpiry),s=i()(new Date(Date.now()),y);return null!=o&&s<o}(e,t)?[3,1]:(c=w[e],u=c[t],i()(new Date(Date.now()),k)>new Date(u.AccessTokenExpiry)&&-1===j.indexOf(t)&&(j.push(t),R(e,t,o)),[2,u.AccessToken]);case 1:return[4,R(e,t,o,s)];case 2:return[2,(u=r.sent()).AccessToken]}}))}))}function D(e,t,n,o){return Object(r.c)(this,void 0,void 0,(function(){var i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return Object(c.a)()&&1===e?[4,Object(u.getDelegationTokenForOwa)(b)]:[3,2];case 1:return i=r.sent(),[3,4];case 2:return[4,P(e,t,n,o)];case 3:i=r.sent(),r.label=4;case 4:return[2,p+i]}}))}))}n.d(t,"d",(function(){return D})),n.d(t,"c",(function(){return P})),n.d(t,"e",(function(){return x})),n.d(t,"b",(function(){return T})),n.d(t,"f",(function(){return m})),n.d(t,"a",(function(){return p}))},3691:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(33),o=n(3262);function i(e,t){return void 0===e||e.__type||(e=Object(o.a)(e)),Object(r.a)("FetchDataProviderResource",e,t)}},4598:function(e,t,n){var r=n(2243);e.exports=function(e,t){var n=r(e).getTime(),o=Number(t);return new Date(n+o)}},4860:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(1),o=n(121),i=n(3426),s=n(217),c=n(3262),u=n(3691),a=n(24),l=n(23),d=n(5089),f=n(3167);function h(e,t,n,s,c,u){return void 0===u&&(u=!1),Object(r.c)(this,void 0,void 0,(function(){var d;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(i.d)(e,!1,n)];case 1:return d=r.sent(),[3,3];case 2:return r.sent(),[3,3];case 3:if(Object(a.i)("doc-authContext")&&0===e&&(c?c["x-ms-cc"]="t":c={"x-ms-cc":"t"}),d&&d.split(i.a)[1])return Object(o.s)("fetchServiceViaDataProvider",[e]),l.g.info("fetchServiceViaDataProvider"),[2,b(e,t,n,d,s,u,c)];if(Object(o.s)("fetchServiceFailedToGetToken",[e]),0===e)return Object(o.s)("fetchServiceViaOWAServer"),l.g.info("fetchServiceViaOWAServer"),[2,p(e,t,s,c)];throw new Error("Fetch service has failed to retrieve client token.")}}))}))}function b(e,t,n,c,u,l,f){return Object(r.c)(this,void 0,void 0,(function(){var h,p,v,O,m,j,w,y,k;return Object(r.f)(this,(function(r){switch(r.label){case 0:return h=u.datapointNamePrefix+"DataProvider",(p=new o.b(h)).addCustomData({dataProviderType:e}),v={Authorization:c,"Content-Type":"application/json",Accept:"application/json"},f&&Object.keys(f).forEach((function(e){v[e]=f[e]})),[4,fetch(t,{method:u.method,mode:u.mode,headers:v,body:u.body})];case 1:return O=r.sent(),Object(s.a)(O.status)?(p.end(),[4,O.json()]):[3,3];case 2:return m=r.sent(),[2,JSON.stringify(m)];case 3:if(j=new Error(h+" : Response status = "+O.status+", body = "+O.body),p.endWithError("ServerError",j),w={datapointName:h,responseStatus:O.status,responseBody:O.body,headers:O.headers,claims:null},!Object(a.i)("doc-authContext")||0!==e||l)return[3,12];if(!(y=O.headers.get("www-authenticate")))return[3,12];k=void 0,r.label=4;case 4:return r.trys.push([4,7,,8]),[4,d.a.import()];case 5:return[4,r.sent()(y)];case 6:return k=r.sent(),[3,8];case 7:throw r.sent(),JSON.stringify(w);case 8:return r.trys.push([8,10,,11]),[4,Object(i.d)(e,!0,n,k)];case 9:return c=r.sent(),[3,11];case 10:return r.sent(),[3,11];case 11:return[2,b(e,t,n,c,u,!0,f)];case 12:throw JSON.stringify(w)}}))}))}function p(e,t,n,i){return Object(r.c)(this,void 0,void 0,(function(){var a,l,d,h,b,p;return Object(r.f)(this,(function(r){switch(r.label){case 0:return a=n.datapointNamePrefix+"OWA",l=new o.b(a),d=Object(c.a)({ProviderType:e,Url:t,Method:n.method,Body:n.body?n.body:JSON.stringify({}),Headers:JSON.stringify(i),IsJsonPost:n.method===f.d}),[4,Object(u.a)(d)];case 1:if(h=r.sent(),Object(s.a)(h.Status))return l.end(),[2,h.Body];throw b=new Error(a+" : Response status = "+h.Status+", ServerTraceLog = "+h.ServerTraceLog),l.endWithError("ServerError",b),p={datapointName:a,responseStatus:h.Status,responseServerTraceLog:h.ServerTraceLog},JSON.stringify(p)}}))}))}},5088:function(e,t,n){var r=n(4598),o=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*o)}},5089:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(31),o=new r.c((function(){return n.e(355).then(n.bind(null,10375))})),i=(new r.b(o,(function(e){return e.launchRemediateAuthDialogAndRefresh})),new r.b(o,(function(e){return e.remediateAuth})))},7759:function(e,t,n){"use strict";function r(e,t,n,r,o,i){var s=!1;return{task:function(){return new Promise((function(c,u){for(var a=0,l=0,d=0,f=function(){var h,b,p,v,O;s&&c(1),a<n&&d<t.length&&((h=d,b=t[h],p=b.start,v=b.end,O=e.slice(p,v),r(O,i(h),o)).then((function(){return a-=1,(l+=1)===t.length&&c(0),void f()})).catch(u),d+=1,a+=1)},h=0;h<n;h++)f()}))},cancelTask:function(){return s=!0}}}var o=Object.freeze({sliceSize:14680064,numberOfSlicesToParallelize:2});function i(e,t,n){void 0===n&&(n=o),function(e){e.sliceSize=e.sliceSize||o.sliceSize,e.numberOfSlicesToParallelize=e.numberOfSlicesToParallelize||o.numberOfSlicesToParallelize}(n);var i=n.sliceSize,u=n.numberOfSlicesToParallelize,a=Math.ceil(e.size/i),l=function(e,t,n){for(var r=[],o=0,i=0;i<e;i++){var s=Math.min(o+t,n);r.push({start:o,end:s}),o=s}return r}(a,i,e.size),d=r(e,[l[0]],1,t,a,(function(){return 0})),f=l.length>2?r(e,l.slice(1,l.length-1),u,t,a,(function(e){return e+1})):c(),h=l.length>1?r(e,[l[l.length-1]],1,t,a,(function(){return l.length-1})):c();return{onCompletePromise:d.task().then(s(f.task)).then(s(h.task)),cancel:function(){d.cancelTask(),f.cancelTask(),h.cancelTask()}}}function s(e){return function(t){return 0===t?e():Promise.resolve(t)}}function c(){var e=!1;return{task:function(){return e?Promise.resolve(1):Promise.resolve(0)},cancelTask:function(){return e=!0}}}n.d(t,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~bdaa698b.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~bdaa698b.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentFileProviderFolderPicker~AttachmentModelStore~AttachmentOps~AttachmentPreviewSxS~~bdaa698b.js'] = (new Date()).getTime();