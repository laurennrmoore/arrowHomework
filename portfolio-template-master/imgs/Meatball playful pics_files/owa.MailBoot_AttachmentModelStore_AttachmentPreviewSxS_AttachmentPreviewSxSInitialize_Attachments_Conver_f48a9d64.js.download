self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentModelStore~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~Conver~f48a9d64.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[77],{2644:function(e,t,n){"use strict";var r,i=n(1992),a=n(2495),c=n(19),o=n(2061),u=n(3942),s=n(2212);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.AccessDisabled=4]="AccessDisabled"}(r||(r={}));var l=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?(this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled,this.linkPreviewEnabled=this.attachmentPolicy.WacViewingOnPublicComputersEnabled):(this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.linkPreviewEnabled=this.attachmentPolicy.WacViewingOnPrivateComputersEnabled),this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=r[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}return e.prototype.getPolicyInfo=function(e,t,n,i){e&&(e=e.toLowerCase());var a=this.getFileAccessLevel(e,t),c=!1,s=!1,l=!1,d=1===i||3===i;a!==r.Block&&n&&(this.isWacViewingEnabled(e)&&(c=!0),!this.directFileAccessEnabled&&d&&(c=!1),s=this.isForceBrowserViewingFirst(c),c&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(l=0===i?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),c||Object(o.b)(e)||Object(u.a)(e)||this.directFileAccessEnabled||(a=r.AccessDisabled));return{directFileAccessEnabled:this.directFileAccessEnabled,level:a,useWac:c,forceBrowserViewingFirst:s,wacEdit:l}},e.prototype.isPdfPreviewEnabled=function(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=r.Undefined),n===r.Block)return r.Block;var i=this.mimeTypeToPolicyMap[t];return i===r.Block?r.Block:n===r.ForceSave||i===r.ForceSave?r.ForceSave:n===r.Allow||i===r.Allow?r.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach((function(t){e[t]=n}))},e.prototype.createPolicyMap=function(e,t,n){var i={};return this.addPolicyIntoMap(i,n,r.Allow),this.addPolicyIntoMap(i,t,r.ForceSave),this.addPolicyIntoMap(i,e,r.Block),i},e}(),d=null,f=null;function b(){if(!d){var e=Object(c.a)(),t=Object(a.c)(),n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;d=new l(t,n),n&&(f=d)}return d}function h(e,t){var n=Object(i.b)(e.Name),r=e.ContentType;return b().getPolicyInfo(n,r,t,Object(s.a)(e))}function p(e,t){var n=Object(i.b)(e.Name),r=e.ContentType;return function(){if(!f){var e=Object(c.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return b();f=new l(Object(a.c)(),!0)}return f}().getPolicyInfo(n,r,t,Object(s.a)(e))}function m(e,t,n,i){if(i)return!1;var a=h(e,!0),c=b();return a.level!==r.Block&&c.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return b}))},3339:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return o}));var r="originalsrc",i="shash",a="data-auth",c="&reserved=0",o="Verified"},3608:function(e,t,n){"use strict";function r(e,t){if(null===e)return[];var n=[];if(0===t){var r=e;r.CanShareInternally&&(n.push(2),n.push(1)),r.CanCreateOrganizationEditLink&&n.push(6),r.CanCreateOrganizationViewLink&&n.push(5)}return e.CanCreateAnonymousEditLink&&n.push(4),e.CanCreateAnonymousViewLink&&n.push(3),n.length>0?n:[]}function i(e,t,n){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;case 6:return n?t?2:1:0;default:return 0}}function a(e,t,n){var r=i(e,n);if(0===r)switch(t){case 2:return n?4:3;case 1:return n?6:5;case 5:return n?2:1;default:return 0}return r}var c=n(6004),o=n(6),u="OneDrivePro",s=n(94),l=n(19);function d(e,t){switch(e){case 3:return Object(o.b)(c.b);case 4:return Object(o.b)(c.a);case 6:return Object(o.b)(c.d);case 5:return Object(o.b)(c.e);case 1:return t===u?Object(o.b)(c.g):Object(o.b)(c.b);case 2:return t===u?Object(o.b)(c.f):Object(o.b)(c.a);case 0:return Object(o.b)(c.c);default:return Object(s.a)(e)}}function f(e,t){return 0===t?function(e){var t,n=null===(t=Object(l.a)().SessionSettings)||void 0===t?void 0:t.CompanyName;switch(e){case 3:return Object(o.b)(c.i);case 4:return Object(o.b)(c.h);case 6:return Object(o.c)(Object(o.b)(c.j),n);case 5:return Object(o.c)(Object(o.b)(c.k),n);case 1:return Object(o.b)(c.g);case 2:return Object(o.b)(c.f);case 0:return Object(o.b)(c.c);default:return Object(s.a)(e)}}(e):d(e,null)}function b(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return b}))},3942:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(1963),i=[".txt",".xml",".log"];function a(e){return c(Object(r.a)(e))}function c(e){return!!e&&i.indexOf(e.toLowerCase())>=0}},4213:function(e,t,n){"use strict";var r=n(1),i=n(4410),a=n(5890),c=n(94);var o=Object(i.a)((function(e){switch(e){case 0:return Object(r.a)(Object(r.a)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportedPermissionLevels:[2,1],requiresFetchingSharingInformation:!0});case 1:return Object(r.a)(Object(r.a)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportImageThumbnail:!0,supportPreview:function(e,t){return t},supportedPermissionLevels:[2,1]});case 3:return Object(r.a)(Object(r.a)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:function(e,t){return!1}});case 2:return Object(r.a)(Object(r.a)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportPreview:function(e,t){return!1}});case 6:return{supportDownload:!1,supportImageThumbnail:!0,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};case 5:return Object(r.a)(Object(r.a)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e){return Object(a.a)(e)},supportedPermissionLevels:[4,3]});case 7:case 8:case 9:return Object(r.a)(Object(r.a)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:function(e,t){return!1}});case 4:case 10:return{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};default:return Object(c.a)(e)}})),u=o.getDataProviderInfo;o.getDefaultDataProviderInfo;t.a=u},4302:function(e,t,n){"use strict";n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return o}));var r=n(31),i=n(3339);n.d(t,"b",(function(){return i.b})),n.d(t,"d",(function(){return i.d})),n.d(t,"a",(function(){return i.a})),n.d(t,"c",(function(){return i.c})),n.d(t,"e",(function(){return i.e}));var a=new r.c((function(){return n.e(439).then(n.bind(null,10339))})),c=new r.b(a,(function(e){return e.evaluateSafeLink})),o=(new r.b(a,(function(e){return e.evaluateSafeLinks})),new r.b(a,(function(e){return e.isSafeLink})))},4355:function(e,t,n){"use strict";var r=n(1),i=n(24),a=n(6),c=n(6347),o=n(8508),u=n(4213),s=n(7394),l=n(7393),d=n(7395),f=n(6604),b=n(2359),h=n(4708),p=n(2644),m=n(23),v=n(183),O=n(2143);var P=n(2212),g=n(2110);t.a=Object(v.action)("addAndInitializeAttachments")((function(e,t,n,j){void 0===n&&(n=!1),void 0===j&&(j=!1);var w=Object(O.a)();n||(e=e.filter((function(e){return!w.attachments.has(e.attachment.AttachmentId.Id)}))),e.map((function(e){var n=e.attachmentId,w=e.attachment,y=e.permissionInfo,A=e.modelInitializationValues,I=function(e,t){var n={id:e,type:Object(P.a)(t),download:{url:null},attachmentClass:0,previewImage:{url:null},thumbnailImage:{url:null},info:{allowDownload:!1,supportedPermissionLevels:[],sharingInfo:null},model:t};return 1===n.type&&Object(g.a)(t)?Object(r.a)(Object(r.a)({},n),{type:1,openUrl:null,originalUrl:null,isFolder:t.AttachmentIsFolder,requiresFetchingSharingInformation:!1}):n}(n,w);return j||function(e,t,n){Object(r.c)(this,void 0,void 0,(function(){var P,g,j,w,y,A,I;return Object(r.f)(this,(function(r){switch(r.label){case 0:return P=Object(b.a)(e),g=Object(p.b)(e.model,!0),j=Object(o.a)(g,e.model),e.attachmentClass=j,e.info=Object(c.a)(g,j,e.model,P,P?e.model.ProviderType:null,t),e.info.allowDownload&&(e.download.url=Object(d.a)(e.id,e.model,!0,!0)),P?(e.openUrl=Object(f.a)(e.model),Object(i.i)("doc-unwrap-safelinks")?(w=e,[4,Object(l.a)(e.model)]):[3,2]):[3,3];case 1:w.originalUrl=r.sent(),r.label=2;case 2:n||(y=e.model,(null==(A=Object(u.a)(y.ProviderType))?void 0:A.requiresFetchingSharingInformation)&&!Object(a.f)(y.AttachLongPathName)&&(e.requiresFetchingSharingInformation=!0)),r.label=3;case 3:return Object(h.a)(e.model)&&(I=e.id.Id,Object(s.a)(e.id,e.model,P).then(Object(v.action)("updateAttachmentThumbnailUrl")((function(e){Object(O.a)().attachments.has(I)&&(Object(O.a)().attachments.get(I).thumbnailImage.url=e)})),(function(e){m.g.warn(e)}))),[2]}}))}))}(I,y,t),function(e,t){t=t||{},Object.keys(t).forEach((function(n){t[n]&&(e[n]=t[n])}))}(I,A||{}),I})).forEach((function(e){var t,n=e.model;n&&!n.AttachmentOriginalUrl&&((null===(t=null==(i=w.attachments.get(e.id.Id))?void 0:i.model)||void 0===t?void 0:t.AttachmentOriginalUrl)&&(n.AttachmentOriginalUrl=i.model.AttachmentOriginalUrl));if(n&&Object(b.b)(n)){var r=n;if(!r.AttachLongPathName){var i,a=null==(i=w.attachments.get(e.id.Id))?void 0:i.model;(null==a?void 0:a.AttachLongPathName)&&(r.AttachLongPathName=a.AttachLongPathName)}}w.attachments.set(e.id.Id,e)}))}))},4410:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1),i=n(2230),a=n(2065),c=[0,1,3,2,6,5,7,8,4];function o(e){var t=null,n=function(n){var i=Object(a.b)(n);return null===i?null:function(){var n,i;if(!t){t={};try{for(var a=Object(r.k)(c),o=a.next();!o.done;o=a.next()){var u=o.value;t[u]=e(u)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}return t}()[i]};return{getDataProviderInfo:n,getDefaultDataProviderInfo:function(e){return n(e?i.h:i.i)}}}},4607:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2060);function i(e){return(e.__type||e.OwsTypeName)===r.b}},4708:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(4213),i=n(2214),a=n(2644),c=n(1992),o=n(2110),u=n(4866),s=n(7117);function l(e){if(!Object(a.b)(e,!0).directFileAccessEnabled&&!e.IsInline||Object(i.b)(e.AttachmentId.Id))return!1;if(e.Thumbnail)return!0;var t=Object(c.g)(e.Name,e.ContentType,!1),n=Object(c.h)(e.Name);if((Object(u.a)(e)||Object(s.a)(e))&&(t||n))return!0;if(Object(o.a)(e)){var l=Object(r.a)(e.ProviderType);if(e.AttachmentThumbnailUrl||t&&l&&l.supportImageThumbnail)return!0}return!1}},4865:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1),i=n(2774),a=n(6488);function c(e){var t;return Object(r.c)(this,void 0,void 0,(function(){var n,c;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=Object(a.a)(e.AttachLongPathName),[4,Object(i.l)(n)];case 1:return c=r.sent(),[2,(null===(t=c.result)||void 0===t?void 0:t.thumbnailLink)||null]}}))}))}},4866:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2060);function i(e){return(e.__type||e.OwsTypeName)===r.a}},5890:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"];function i(e){return!!e.ContentType&&r.indexOf(e.ContentType.toLowerCase())>-1}},6004:function(e){e.exports=JSON.parse('{"b":"doa","a":"eoa","d":"foa","e":"goa","g":"hoa","f":"ioa","c":"joa","i":"koa","h":"loa","j":"moa","k":"noa"}')},6140:function(e,t,n){"use strict";var r=n(1996),i=n(7395),a=n(183);t.a=Object(a.action)("refreshDownloadUrl")((function(e,t,n){void 0===n&&(n=!1);var a=Object(r.a)(e),c=Object(i.a)(e,a.model,t,n);a.download.url=c}))},6347:function(e,t,n){"use strict";var r=n(3608),i=n(1992),a=n(5),c=n(24);var o=n(6450),u=n(4213);function s(e,t,n,s,l,d){if(void 0===d&&(d=null),1===t)return{allowDownload:!1,supportedPermissionLevels:null,sharingInfo:null};var f,b=Object(i.b)(n.Name),h=Object(o.a)(e,n,b),p=function(e,t,n){if(!e)return null;if(n&&n.length>0)return n;var r=Object(u.a)(t);return null==r?void 0:r.supportedPermissionLevels}(s,l,Object(r.a)(d,0)),m=(f=d)&&0===f.ResultCode?(Object(c.i)("doc-attachment-referenceAttachmentExpiration")||(f.ExpirationDate=null),{getSharingInfoSucceeded:!0,blocksDownload:f.BlocksDownload,canonicalUrl:f.CanonicalUrl,canShareInternally:f.CanShareInternally,canShareExternally:f.CanShareExternally,expirationDate:f.ExpirationDate?Object(a.nc)(f.ExpirationDate):null,canRefresh:!1,shareId:f.ShareId,siteUrl:f.SiteUrl,linkType:f.Type,itemUniqueId:f.ItemUniqueId,mimeType:f.MimeType}):null;return s?function(e,t,n){return{allowDownload:e,supportedPermissionLevels:t,sharingInfo:n}}(h,p,m):function(e){return{allowDownload:e,supportedPermissionLevels:null,sharingInfo:null}}(h)}n.d(t,"a",(function(){return s}))},6449:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(67);function i(e,t){return r.e()||r.f()||r.j()?function(e){e=e||(null===navigator||void 0===navigator?void 0:navigator.plugins);try{return"function"==typeof(null==e?void 0:e.namedItem)&&["Chrome PDF Viewer","Microsoft Edge PDF Viewer","WebKit built-in PDF"].some((function(t){return null!==e.namedItem(t)}))}catch(e){}return!1}(t):r.i()?function(e){try{return null!==e("AcroPDF.PDF")}catch(e){return!1}}(e||function(e){return new ActiveXObject(e)}):(r.g()||r.h(),!1)}},6450:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2110),i=n(4213),a=n(2644),c=n(67),o=n(24);function u(e,t,n){var u=e.level!==a.a.Block&&e.directFileAccessEnabled;return u&&Object(r.a)(t)&&(u=function(e,t){if(e.AttachLongPathName){var n=document.createElement("a");if(n.href=e.AttachLongPathName,(!Object(o.i)("doc-unwrap-safelinks")||Object(c.i)())&&n.host.indexOf(s,0)>0||n.search.indexOf(l,0)>0)return!1}if(r=e.ProviderType,a=Object(i.a)(r),(null==a?void 0:a.supportDownload)&&!e.AttachmentIsFolder)return".fluid"!==t&&!function(e,t){return!(e||t&&"application/onenote"!==t&&"image/png"!==t)}(t,e.ContentType);var r,a;return!1}(t,n)),u}var s="safelinks.protection.outlook.com",l="b7780972f918485c8cfc32b1ba7438eb"},6488:function(e,t,n){"use strict";function r(e){var t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}n.d(t,"a",(function(){return r}))},6604:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(6),i=n(2230),a=n(3608),c=n(19);function o(e){return Object(r.f)(e)?null:("/"!=(e=e.trim())[e.length-1]&&(e+="/"),e)}function u(e){var t=e.AttachLongPathName;if(Object(a.f)(e.PermissionType)||e.ProviderType!==i.i)return t;var n=Object(c.a)(),r=n.ApplicationSettings;if(null!==t&&null!==r){var u=void 0;null!==(u=o(r.VDirIsPublicProperty||n.PublicComputersDetectionEnabled&&n.SessionSettings.IsPublicComputerSession?r.ExternalSPMySiteHostURL:r.InternalSPMySiteHostURL))&&(t=function(e,t){var n,r,i,a=new RegExp("^(https?)\\:[\\/\\\\]{2}([\\w\\.-]+)(\\:[0-9]{1,4})?(.*)$","i"),c=a.exec(e),o=a.exec(t);return c&&o&&c.length>=5&&o.length>=5&&(o[1]&&o[2]&&(i=o[1]+"://"+o[2],n=!0),o[3]&&(i+=o[3]),c[4]&&(r=!0,i+=c[4])),n&&r?i:null}(t,u))}return null!==t?t:e.AttachLongPathName}},7117:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2060);function i(e){return(e.__type||e.OwsTypeName)===r.c}},7393:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1),i=n(4302);function a(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,i.f.import()];case 1:return(n=r.sent())?[4,n(e.AttachLongPathName)]:[3,3];case 2:t=r.sent(),r.label=3;case 3:return[2,t]}}))}))}},7394:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1),i=n(2230),a=n(4865),c=n(2704);function o(e,t,n){return Object(r.c)(this,void 0,void 0,(function(){var o;return Object(r.f)(this,(function(r){return n?(o=t).ProviderType===i.e&&o.AttachLongPathName?[2,Object(a.a)(o)]:[2,o.AttachmentThumbnailUrl||null]:[2,Object(c.a)(e,t,2,n,!0)]}))}))}},7395:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2230),i=n(2359),a=n(2704);function c(e,t,n,c){if(void 0===c&&(c=!1),Object(i.b)(t))switch(t.ProviderType){case r.c:return function(e){var t=e.AttachLongPathName,n=t.lastIndexOf("?");return t.substring(0,n)+"?dl=1"}(t)}return Object(a.a)(e,t,0,Object(i.b)(t),n,c)}},8508:function(e,t,n){"use strict";var r=n(4213),i=n(1992);function a(e){var t=Object(i.b)(e.Name);return t&&".pdf"===t.toLowerCase()}var c=[".mp3"];var o=[".ics",".ical",".ifb",".icalendar"];var u=[".eml",".msg"];var s=n(5890),l=n(2110),d=["image/jpeg","image/png","image/gif","image/bmp"];function f(e){return Object(i.g)(e.Name)||!Object(l.a)(e)&&function(e){if(e)return d.indexOf(e.toLowerCase())>=0;return!1}(e.ContentType)}var b=n(6449),h=n(2644);function p(e,t){if(a(e)&&Object(b.a)()){if(t)return!0;var n=Object(h.c)(e,!0);return Object(h.b)(e,!0).directFileAccessEnabled&&n.directFileAccessEnabled}return!1}var m=n(3942),v=[".mp4"],O=[".mov"];var P=n(197),g=n(4866),j=n(7117),w=n(4607),y=n(2752);function A(e,t){var n;Object(l.a)(t)||Object(y.a)(t)?n=function(e){var t=Object(r.a)(e.ProviderType);return t&&t.supportPreview(e,Object(P.a)())}(t)?f(t)?e.directFileAccessEnabled?2:0:Object(s.a)(t)?6:p(t,!0)?e.directFileAccessEnabled?3:0:e.useWac?4:0:0:n=Object(g.a)(t)?e.level===h.a.Block?1:e.level===h.a.AccessDisabled?0:f(t)?2:a(t)?function(e,t){if(!Object(h.e)().isPdfPreviewEnabled())return 1;if(p(t,!1))return 3;if(function(e){return a(e)}(t))return 7;if(e.useWac)return 4;return 0}(e,t):e.useWac?4:function(e){var t=Object(i.b)(e.Name);return!!t&&c.indexOf(t.toLowerCase())>=0}(t)?5:function(e){var t=Object(i.b)(e.Name);return!!t&&u.indexOf(t.toLowerCase())>=0}(t)?10:Object(m.b)(t.Name)?11:function(e,t){var n,r=Object(i.b)(e.Name);if(r){var a=t||((null===(n=null===window||void 0===window?void 0:window.navigator)||void 0===n?void 0:n.userAgent)?window.navigator.userAgent:""),c=-1!==a.indexOf("Safari")&&-1===a.indexOf("Chrome");return v.indexOf(r.toLowerCase())>=0||c&&O.indexOf(r.toLowerCase())>=0}return!1}(t)?12:function(e){var t=Object(i.b)(e.Name);return!!t&&-1!==o.indexOf(t.toLowerCase())}(t)?13:0:Object(w.a)(t)?8:Object(j.a)(t)?9:0;return n}n.d(t,"a",(function(){return A}))}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentModelStore~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~Conver~f48a9d64.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentModelStore~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~Conver~f48a9d64.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentModelStore~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~Conver~f48a9d64.js'] = (new Date()).getTime();