self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentPreviewSxSInitialize~Attachments~HtmlEditorLinkPlugin~OwaFluidLink~OwaInsertLink~~78567fbf.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[111],{11519:function(e){e.exports=JSON.parse('{"a":"t4a"}')},11523:function(e){e.exports=JSON.parse('{"a":"q4a"}')},11524:function(e){e.exports=JSON.parse('{"a":"j4a"}')},1281:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){return Object(r.a)({__type:"FindItemJsonRequest:#Exchange"},e)}},1302:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(33),o=n(1281);function i(e,t){return void 0===e||e.__type||(e=Object(o.a)(e)),Object(r.a)("FindItem",e,t)}},1304:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){return Object(r.a)({__type:"FindItemRequest:#Exchange"},e)}},1388:function(e){e.exports=JSON.parse('{"a":"I4a"}')},1551:function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},1969:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1992:function(e,t,n){"use strict";var r=n(1963),o=n(2210),i=n(6);function a(e){var t;return e>=1073741824?(e/=1073741824,t=Object(i.b)(o.b)):e>=1048576?(e/=1048576,t=Object(i.b)(o.d)):e>=1024?(e/=1024,t=Object(i.b)(o.c)):t=Object(i.b)(o.a),Object(i.c)(t,Math.round(e))}var c,u=n(2061),s=n(24),d=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function f(e){if(!Object(s.i)("doc-attachment-documentThumbnail"))return!1;var t=Object(r.a)(e);return!!t&&d.indexOf(t.toLowerCase())>=0}function l(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return c.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return c.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return c.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(c||(c={}));var b=n(2019);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return a})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return f})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return b.b})),n.d(t,"a",(function(){return c}))},2019:function(e,t,n){"use strict";function r(e){return t=e||"",(n=i.exec(t))&&n.length>1&&o[n[1].toLowerCase()];var t,n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var o={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},i=/^\s*([^;\s]*)(?:;|\s|$)/;function a(e){var t="";return Object.entries(o).forEach((function(n){n[1]===e&&(t=n[0])})),t}},2061:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(1963),o=n(2019),i=n(102),a=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],c=[".tiff",".tif"];function u(e,t,n){return void 0===n&&(n=!0),s(Object(r.a)(e)||Object(o.a)(t),n)}function s(e,t){return void 0===t&&(t=!0),!!e&&(a.indexOf(e.toLowerCase())>=0||t&&c.indexOf(e.toLowerCase())>=0&&(Object(i.e)()||Object(i.d)()||Object(i.h)()||Object(i.g)()&&!Object(i.l)()))}},2065:function(e,t,n){"use strict";var r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function o(e){var t=null,n=r.exec(e);if(n){var o=n[1],i=n[2],a=null;try{a=atob(i)}catch(e){}if(a){for(var c=new ArrayBuffer(a.length),u=new Uint8Array(c),s=0;s<a.length;s++)u[s]=a.charCodeAt(s);t=new File([c],"image.png",{type:o})}}return t}var i=n(1969),a=n(1992);function c(e){return e.map((function(e){return{fileType:i.a.Uri,name:e.name,type:Object(a.b)(e.url)||"",size:0,uri:e.url}}))}var u=n(23);function s(e,t,n){if(e.length!=t.length)return u.d("The sizes of subjects and latestItemIds are different"),null;for(var r=[],o=0;o<e.length;o++){var a={fileType:i.a.MailItem,name:e[o],size:(null==n?void 0:n[o])||0,itemId:t[o]};r.push(a)}return r}function d(e,t,n){var r=[],o={fileType:i.a.MailItem,name:e,size:n||0,mimeContent:t};return r.push(o),r}function f(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],o={fileType:i.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};t.push(o)}return t}function l(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],o={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(o)}return t}function b(e){var t,n;return null===e?null:{fileType:i.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function v(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:i.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var p={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function O(e){switch(e?e.toLowerCase():null){case p.ONE_DRIVE_PRO.toLowerCase():return 0;case p.GDRIVE.toLowerCase():return 5;case p.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case p.DROPBOX.toLowerCase():return 2;case p.BOX.toLowerCase():return 3;case p.WOPI_BOX.toLowerCase():return 7;case p.WOPI_EGNYTE.toLowerCase():return 8;case p.MAILBOX.toLowerCase():return 4;case p.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"f",(function(){return o})),n.d(t,"j",(function(){return c})),n.d(t,"i",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return b})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return i.a}))},2067:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){return Object(r.a)({__type:"IndexedPageView:#Exchange"},e)}},2101:function(e,t,n){"use strict";var r=n(2),o=n(14),i=n(2193),a={providers:new o.ObservableMap,loadState:i.a.NotLoaded,removalPending:new o.ObservableMap},c=Object(r.createStore)("fileProviderStore",a);t.a=c},2102:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a}));var r=n(2),o=Object(r.action)("FILE_PROVIDER_ADDED",(function(e){return{providerViewState:e}})),i=Object(r.action)("FILE_PROVIDER_REMOVED",(function(e){return{providerType:e}})),a=Object(r.action)("PROVIDERS_LOADED",(function(e){return{providers:e}}))},2118:function(e,t,n){"use strict";n.d(t,"l",(function(){return b})),n.d(t,"n",(function(){return v})),n.d(t,"k",(function(){return p})),n.d(t,"m",(function(){return O}));var r=n(31),o=n(2329);n.d(t,"b",(function(){return o.a}));var i=n(2294);n.d(t,"i",(function(){return i.a}));n(2101);var a=n(2102);n.d(t,"d",(function(){return a.a})),n.d(t,"e",(function(){return a.b})),n.d(t,"o",(function(){return a.c}));var c=n(2295);n.d(t,"a",(function(){return c.b}));var u=n(2175);n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return u.b}));var s=n(2282);n.d(t,"j",(function(){return s.a}));var d=n(2193);n.d(t,"c",(function(){return d.a}));var f=n(2279);n.d(t,"f",(function(){return f.b}));var l=new r.c((function(){return Promise.all([n.e(4),n.e(635)]).then(n.bind(null,3603))})),b=new r.b(l,(function(e){return e.loadProviders})),v=new r.b(l,(function(e){return e.removeFileProvider})),p=new r.b(l,(function(e){return e.addFileProvider})),O=new r.b(l,(function(e){return e.removeAndAddFileProvider}))},2175:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(1),o=n(2101),i=function(){return Object(r.j)([],Object(r.g)(Object(o.a)().providers.values()))},a=function(e){return Object(o.a)().providers.get(e)||null}},2193:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded",e[e.Throttled=3]="Throttled"}(r||(r={}))},2210:function(e){e.exports=JSON.parse('{"b":"Nea","d":"Oea","c":"Pea","a":"Qea"}')},2279:function(e,t,n){"use strict";var r=n(1),o=n(33);function i(e){return Object(r.a)({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}function a(e){var t,n,r=i({ProviderType:e});return void 0===(t=r)||t.__type||(t=i(t)),Object(o.a)("GetNewAttachmentDataProviderCreationInfo",t,n)}function c(e){return Object(r.a)({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}function u(e){var t,n,r=c({ProviderType:e});return void 0===(t=r)||t.__type||(t=c(t)),Object(o.a)("GetAttachmentDataProviderCreator",t,n)}var s=n(2594),d=n(2541);n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return g}));var f="code",l="token",b=3e3,v=3;function p(e){return{state:e}}function O(e){return e.state}function m(e){return e.code}function h(e,t,n,o,i){var c={providerType:e,getAuthUrlInfo:null,getCSRFToken:O,getOAuthCode:m};return function e(t,n,o,i,c,d,f){return Object(r.c)(this,void 0,void 0,(function(){var l,v;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),l=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,u(t)];case 1:return v=r.sent(),l=v.AttachmentDataProviderCreator.ProviderAppKey,o=v.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,a(t)];case 3:v=r.sent(),l=v.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(s.d)(t,o,i,l,c,d),[3,6];case 5:return r.sent(),f>0&&setTimeout((function(){return e(t,n,o,i,c,d,--f)}),b),[3,6];case 6:return[2]}}))}))}(e,c,t,n,o,i,v),c}var j=null;function w(){if(!j){if(j={},Object(d.a)(3)&&(j[3]=h(3,"https://app.box.com/api/oauth2/authorize",Object(s.c)(3),f,p)),Object(d.a)(2)&&(j[2]=h(2,"https://www.dropbox.com/oauth2/authorize",Object(s.b)(2),f,p)),Object(d.a)(6)){var e=h(6,"https://www.facebook.com/dialog/oauth",Object(s.b)(6),l,(function(e){return{state:e,scope:"user_photos,email"}}));e.getCSRFToken=O,e.getOAuthCode=function(e){return e.access_token},j[6]=e}if(Object(d.a)(5)){var t=h(5,"https://accounts.google.com/o/oauth2/auth",s.a+"/ADPRedirect.aspx",f,(function(e){var t={state:e,provider:5..toString(),url:Object(s.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}}));t.getCSRFToken=function(e){return JSON.parse(e.state).state},j[5]=t}Object(d.a)(1)&&(j[1]=h(1,"https://login.live.com/oauth20_authorize.srf",Object(s.c)(1),f,(function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}))),Object(d.a)(7)&&(j[7]=h(7,"",Object(s.c)(7),f,p)),Object(d.a)(8)&&(j[8]=h(8,"",Object(s.c)(8),f,p)),Object(d.a)(9)&&(j[9]=h(9,"",Object(s.c)(9),f,p))}return j}function g(e){var t=w();return e in t?t[e]:null}},2282:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2101);function o(){return Object(r.a)().loadState}},2294:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2630),o=n(2564),i=n(2605),a=n(6),c=n(94);function u(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(a.b)(i.b);case 1:return Object(a.b)(i.a);case 2:case 9:return Object(a.b)(r.b);case 3:case 7:return Object(a.b)(r.a);case 5:return Object(a.b)(r.e);case 6:return Object(a.b)(r.d);case 4:return Object(a.b)(r.f);case 10:return Object(a.b)(o.b);case 8:return Object(a.b)(r.c);default:return Object(c.a)(e)}}},2295:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a}));var r,o=n(1);!function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),a=Object.freeze(Object(o.j)(Object(o.j)([],Object(o.g)(i)),[0,4,10]))},2329:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},2360:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(209),o=n(374);function i(e){if("ArchiveMailbox"==e.type)return Object(r.a)();var t=e.userIdentity&&Object(o.r)(e.userIdentity),n="GroupMailbox"===e.type;return t&&!n?Object(r.b)(e.mailboxSmtpAddress)+e.userIdentity:"UserMailbox"===e.type?Object(r.a)():e.mailboxSmtpAddress}},2361:function(e,t,n){"use strict";var r=n(374),o=n(1),i={};function a(e){return i[e]}function c(e,t){var n=i[e];i[e]=Object(o.a)(Object(o.a)({},n),t)}var u=n(57),s=n(33);var d=n(121),f=n(23),l=n(742),b=n(1986),v=n(1989);function p(e){return Object(o.c)(this,void 0,void 0,(function(){var t,n;return Object(o.f)(this,(function(r){switch(r.label){case 0:return(t={}).headers=new Headers,[4,Object(b.a)(e)];case 1:return n=r.sent(),Object(v.b)(t.headers,n),[2,t]}}))}))}var O=Object(l.b)({timeBetweenRetryInMS:function(){return 3e4}});function m(e,t){t=t<1?1:t,setInterval((function(){!function(e){Object(o.c)(this,void 0,void 0,(function(){var t,n,i,u,l,b,v=this;return Object(o.f)(this,(function(m){switch(m.label){case 0:if(t=function(){return Object(o.c)(v,void 0,void 0,(function(){var t,n;return Object(o.f)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),t={},Object(r.r)(e.userIdentity)?[4,p(e.userIdentity)]:[3,2];case 1:t=o.sent(),o.label=2;case 2:return[2,(i=t,Object(s.a)("GetAttachmentDownloadToken",{},i))];case 3:throw n=o.sent(),f.g.warn("Unable to get the download token "+n),n.networkError=!0,n;case 4:return[2]}var i}))}))},null==(n=a(e.userIdentity))?void 0:n.isRefreshingDownloadToken)return[3,4];c(e.userIdentity,{isRefreshingDownloadToken:!0}),i=0,u=O((function(){return Object(o.c)(v,void 0,void 0,(function(){var n;return Object(o.f)(this,(function(r){switch(r.label){case 0:return i++,[4,t()];case 1:return n=r.sent(),f.g.info("update new token"),c(e.userIdentity,{downloadToken:n,isRefreshingDownloadToken:!1}),[2]}}))}))})).retriableFunc,l=new d.c("AttachmentRefreshDownloadToken"),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,u()];case 2:return m.sent(),l.addCustomData([i]),l.end(),[3,4];case 3:return b=m.sent(),f.g.warn("Retry to refresh token failed: "+b),l.addCustomData([i]),l.endWithError("ServerError",b),c(e.userIdentity,{isRefreshingDownloadToken:!1}),[3,4];case 4:return[2]}}))}))}(e)}),6e4*t)}var h=n(94);function j(e){var t=Object(r.j)(null==e?void 0:e.userIdentity),n=a(null==e?void 0:e.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(t){case null:case"Outlook":!function(e){var t=Object(r.r)(e.userIdentity)?Object(u.i)(e.userIdentity):Object(u.h)(),n=null==t?void 0:t.ApplicationSettings;if(n){var o=n.DownloadUrlBase;c(e.userIdentity,{downloadUrlBase:o,downloadToken:n.FirstDownloadToken}),o&&m(e,n.DownloadTokenRefreshMinutes)}}(e);break;case"Google":case"ICloud":break;default:Object(h.a)(t)}var o=a(e.userIdentity);return o||(Object(d.s)("FilesUrlDataNotFound",{accountProviderType:t}),f.g.warn("Unable to get the url data")),o}function w(e){if(!e)return null;var t=j(e);return null==t?void 0:t.downloadToken}n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return w}))},2444:function(e,t,n){"use strict";var r=n(0),o=r.createContext(window);t.a=o},2508:function(e,t,n){"use strict";var r=n(2551);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var o=n(2361);n.d(t,"c",(function(){return o.a}));var i=n(2360);n.d(t,"d",(function(){return i.a}))},2541:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2004),o=n(197),i=n(94),a=n(24);function c(e){var t=Object(r.a)();switch(e){case 5:return(null==t?void 0:t.GoogleDriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==t?void 0:t.BoxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-box");case 2:return(null==t?void 0:t.DropboxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-dropbox");case 6:return(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-facebook");case 1:return!!Object(o.a)()||(null==t?void 0:t.OnedriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled);case 10:return Object(a.i)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(a.i)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},2551:function(e,t,n){"use strict";var r=n(94),o=n(6),i=n(65),a="/owa/",c="service.svc/s/GetFileAttachment?id={0}",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",f="service.svc/s/GetAttachmentThumbnail?id={0}",l="pdfprint.aspx?id={0}",b="pdfprint.aspx?id={0}&location={1}",v=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var p=n(197),O=n(67),m=n(4),h=n(34),j=n(2361),w=n(2360);function g(e,t,n,r,c){if(void 0===r&&(r=!1),void 0===c&&(c=null),!e||!e.Id||!e.mailboxInfo)return null;var u=Object(j.b)(e.mailboxInfo),s=null==u?void 0:u.downloadUrlBase,d=Object(w.a)(e.mailboxInfo);if(c=c||Object(o.c)(t,encodeURIComponent(e.Id)),!s||r&&"Firefox"===Object(O.a)().browser){var f=a+c+"&X-OWA-CANARY="+Object(i.a)();return Object(h.a)(f)}var l="{0}{1}/{2}";Object(p.a)()&&(l+="&isc=1");var b=Object(o.c)(l,s,d,c);return n&&(b+="&token="+(null==u?void 0:u.downloadToken),b+="&X-OWA-CANARY="+Object(i.a)()),Object(O.i)()||(b+="&owa="+window.location.hostname,b+="&scriptVer="+Object(m.r)()||!1),b}function I(e,t,n,c,s,f,l,p,O){var m;switch(void 0===s&&(s=0),void 0===f&&(f=0),void 0===l&&(l=!0),void 0===p&&(p=null),void 0===O&&(O=null),n){case 0:m=u;break;case 3:m=b;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&v.indexOf(t.toLowerCase())>=0}(p))return null;m=d;break;default:Object(r.a)(n)}var j=c?f:s;!j&&s&&(j=s);var w=Object(o.c)("{0}&permissionLevel={1}",Object(o.c)(m,encodeURIComponent(e.Id),encodeURIComponent(t)),j),I=g(e,m,!0,3===n,w);if(I)return I;var A=Object(o.c)("{0}{1}{2}",a,O,w);l&&(A=A+"&X-OWA-CANARY="+Object(i.a)());return Object(h.a)(A)}function A(e,t,n,i){var a;switch(void 0===n&&(n=!1),void 0===i&&(i=!0),t){case 0:a=c;break;case 1:a=s;break;case 2:a=f;break;case 3:a=l;break;default:return Object(r.a)(t)}if(!Object(o.f)(a)){var u=g(e,a,i,3===t);return Object(o.c)("{0}{1}{2}",u,n?"&isDownload=true":"","&animation=true")}return null}n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return A}))},2564:function(e){e.exports=JSON.parse('{"a":"Vna","b":"Wna"}')},2594:function(e,t,n){"use strict";var r=n(514),o=n(4);function i(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s}));var a=Object(o.K)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){var t=e?encodeURIComponent("?provider="+e):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.m)()+"/mail/"+n+t}function u(e){var t=Object(r.m)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+e+"&url="+t);return a+"/ADPRedirect.aspx?"+n}function s(e,t,n,r,o,a){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[],r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}(),c=i(t,"client_id",r);if(c=i(c,"redirect_uri",n),c=i(c,"response_type",o),a){var u=a(e);c=Object.keys(u).reduce((function(e,t){return i(e,t,u[t])}),c)}return{authUrl:c,redirectUrl:n,csrfToken:e}}}},2605:function(e){e.exports=JSON.parse('{"b":"Tna","a":"Una"}')},2630:function(e){e.exports=JSON.parse('{"b":"Nna","a":"Ona","e":"Pna","d":"Qna","f":"Rna","c":"Sna"}')},2704:function(e,t,n){"use strict";var r=n(94),o=n(2508),i=n(65),a=n(3159);function c(e,t,n,i,c){var u;void 0===c&&(c=!0);var s=t,d=s.Name,f=s.OriginalPermissionType,l=s.PermissionType,b=Object(a.a)(t),v="GroupMailbox"===(null===(u=null==e?void 0:e.mailboxInfo)||void 0===u?void 0:u.type)?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return o.b(e,b,n,i,l,f,c,d,v);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:o.b(e,b,1,i,l,f,c,d,v);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function u(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),o.a(e,t,n,r)}function s(e,t,n,r,a){void 0===a&&(a=!1);var s=n?c(e,t,1,r,!1):u(e,1,a,!1);if(n)return{url:s,init:{credentials:"include"}};var d=Object(o.c)(e.mailboxInfo),f=new Headers;return f.set("X-Token",d),f.set("X-OWA-CANARY",Object(i.a)()),{url:s,init:{headers:f}}}function d(e,t,n,r,o,i){return void 0===i&&(i=!1),r?c(e,t,n,o):u(e,n,i)}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s}))},3159:function(e,t,n){"use strict";function r(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},3290:function(e,t,n){"use strict";var r="OLK_Beautified_",o="olkBeautifulLink",i="true",a=n(1388),c=n(6),u=n(24);function s(e,t,n){return{name:Object(c.b)(a.a),key:"OpenInNewTab",iconProps:Object(u.i)("wvn-chicletEditOptions")||Object(u.i)("wvn-chicletEditOptionsNoDownload")?{iconName:"TabCenter"}:void 0,onClick:function(){(t||window).open(e,"_blank"),n&&n()}}}function d(e){var t;return"a"===e.tagName.toLowerCase()&&0===(null===(t=e.id)||void 0===t?void 0:t.indexOf(r))}function f(e,t,n){return d(t)&&t.setAttribute(o,i),null}n.d(t,"a",(function(){return"owaAttachmentRemoveOnSend"})),n.d(t,"b",(function(){return"OWALink"})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return"OWAAutoLink"})),n.d(t,"g",(function(){return"OWA"})),n.d(t,"h",(function(){return"OWAInsertLinkPlaceHolder"})),n.d(t,"i",(function(){return"x_OWAAutoLink"})),n.d(t,"j",(function(){return s})),n.d(t,"l",(function(){return f})),n.d(t,"k",(function(){return d}))},6606:function(e){e.exports=JSON.parse('{"a":"s4a"}')},6607:function(e){e.exports=JSON.parse('{"a":"r4a"}')},742:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,o=!1,i=function(a,c){o?c(new Error("The function retry was cancelled")):(r++,e().then((function(e){return a(e)})).catch((function(e){t&&r>=t?c(e):setTimeout((function(){return i(a,c)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return i(e,t)}))},cancel:function(){return o=!0}}}}function o(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},8167:function(e){e.exports=JSON.parse('{"a":"d4a"}')},8168:function(e){e.exports=JSON.parse('{"a":"Goa"}')}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentPreviewSxSInitialize~Attachments~HtmlEditorLinkPlugin~OwaFluidLink~OwaInsertLink~~78567fbf.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentPreviewSxSInitialize~Attachments~HtmlEditorLinkPlugin~OwaFluidLink~OwaInsertLink~~78567fbf.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentPreviewSxSInitialize~Attachments~HtmlEditorLinkPlugin~OwaFluidLink~OwaInsertLink~~78567fbf.js'] = (new Date()).getTime();