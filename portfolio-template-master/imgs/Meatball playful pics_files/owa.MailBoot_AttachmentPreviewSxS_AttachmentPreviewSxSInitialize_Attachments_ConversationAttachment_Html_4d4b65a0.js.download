self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~ConversationAttachment~Html~4d4b65a0.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[82],{2217:function(t,e,n){"use strict";var r=n(1),a=n(8163),c=n(4703),o=n(2997),i={},u=function(){function t(t,e,n){var r=this;this.estimatedTimeToCompleteInMS=t,this.updateIntervalInPercent=e,this.updatePropertyHandler=n,this.start=function(){r.currentTimePercent+=r.updateIntervalInPercent;var t=r.getActionCompletePercent();t<=r.maxPercent?(r.updatePropertyHandler(t),r.nextUpdateTimer=setTimeout(r.start,r.estimatedTimeToCompleteInMS*r.updateIntervalInPercent)):r.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent}return t.prototype.complete=function(){var t=this;this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout((function(){return t.updatePropertyHandler(1.1)}),500)},t.prototype.abort=function(){this.clearUpdateTimer(),this.updatePropertyHandler(0)},t.prototype.clearUpdateTimer=function(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)},t.prototype.getActionCompletePercent=function(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)},t}();function s(t,e){var n=i[t.Id];n&&(e?n.complete():n.abort(),delete i[t.Id])}function d(t,e,n,r){var a=new u(t,e,n);i[r.Id]=a,a.start()}var l=n(6800),f=n(2);Object(f.orchestrator)(a.a,(function(t){return Object(r.c)(void 0,void 0,void 0,(function(){var e,n;return Object(r.f)(this,(function(r){switch(r.label){case 0:a=t.attachment,Object(o.a)(a,7,13),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l.a)(null,null,t.attachment.attachmentId.Id)];case 2:return e=r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:return n=e&&"Success"===e.ResponseClass?14:15,function(t,e,n,r,a){s(t,!0),Object(c.a)(n,a),Object(o.a)(n,r,e)}(t.attachment.attachmentId,n,t.attachment,0,7),[2]}var a}))}))}));var h=n(2796),m=n(5185);function v(t){return Object(r.a)({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},t)}var p=n(33);function b(t,e,n,r,a){var c,o,i=function(t,e,n,r,a){return v({ewsAttachmentId:{RootItemChangeKey:e.ChangeKey,RootItemId:e.Id,Id:t},itemId:t,subscriptionId:n,channelId:r,cancellationId:a})}(t,e,n,r,a);return void 0===(c={requestObject:i}).requestObject||c.requestObject.__type||(c.requestObject=v(c.requestObject)),Object(p.a)("ConvertLocalToRefAttachment",c,o)}var O=n(121),j=n(1996),I=n(4517),C=n(869),y=n(183),w={},S=Object(y.action)("convertClassicToCloudy")((function(t,e,n){return Object(r.c)(this,void 0,void 0,(function(){var a,c,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return a=new O.b("AttachmentConvertClassicToCloudy"),function(t){Object(o.a)(t,5,8)}(t),c=function(e){if(P(t,e.ResultCode),g(a,t.attachmentId,e.ResultCode,e.Exception),0===e.ResultCode&&e.Response&&e.Response.ResponseMessages&&e.Response.ResponseMessages.Items&&e.Response.ResponseMessages.Items.length>0&&"NoError"===e.Response.ResponseMessages.Items[0].ResponseCode){var r=e.Response.ResponseMessages.Items[0];n(!0,r.Attachments[0])}else n(!1,null);return!0},i=function(e){P(t,1),n(!1,null),g(a,t.attachmentId,1,e)},[4,T(t.attachmentId,e,c,i)];case 1:return r.sent(),[2]}}))}))}));function T(t,e,n,a){return Object(r.c)(this,void 0,void 0,(function(){var c,o,i,u,s,d;return Object(r.f)(this,(function(l){switch(l.label){case 0:return[4,Object(I.a)(n)];case 1:c=r.g.apply(void 0,[l.sent(),4]),o=c[0],i=c[1],u=c[2],s=c[3],w[t.Id]=o,l.label=2;case 2:return l.trys.push([2,4,,5]),[4,b(t.Id,e,o,s,o)];case 3:return l.sent(),[3,5];case 4:return d=l.sent(),a(d.message),C.i.importAndExecute(i,u),[3,5];case 5:return[2]}}))}))}function P(t,e){switch(e){case 0:break;case 11:Object(o.a)(t,0,0);break;default:Object(o.a)(t,0,9)}delete w[t.attachmentId.Id]}function g(t,e,n,r){var a=Object(j.a)(e);t.addCosmosOnlyData(JSON.stringify({size:a.model.Size})),t.addCustomData([n]),0===n||11===n?t.end():t.endWithError("ServerError",new Error(r))}var A={name:"CancelConvertClassicToCloudy"},R={name:"CancelConvertCloudyToClassic"};function E(t){return Object(r.a)({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},t)}function x(t){var e,n,r=function(t){return E({cancellationId:t})}(t);return void 0===(e=r)||e.__type||(e=E(e)),Object(p.a)("CancelConvertLocalToRefAttachment",e,n)}var D=n(44),_=Object(D.d)("cancelConvertClassicToCloudy",A)((function(t){var e,n=(e=t.attachmentId.Id,w[e]);if(!n)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(o.a)(t,5,10),x(n)})),L=n(4159),N=Object(y.action)("setActionCompletePercent")((function(t,e){t.actionCompletePercent=e})),k=n(5187),U=n(4303),q=n(3433),M=n(4709),W=n(2099),B=n(4355),z=n(4466),H=n(6140),V=n(2359),F=Object(y.action)("updateAttachment")((function(t,e,n,a,c){Object(z.a)(t.attachmentId);var i=Object(r.a)(Object(r.a)({},a.AttachmentId),{mailboxInfo:e.mailboxInfo});if(n.AttachmentId=i,a.Name&&(n.Name=a.Name),a.Size&&(n.Size=a.Size),a.ContentType&&(n.ContentType=a.ContentType),a.__type&&(n.__type=a.__type),n.IsInline&&(n.ContentId=a.ContentId),Object(V.b)(a)){var u=n;u.AttachLongPathName=a.AttachLongPathName,u.PermissionType=a.PermissionType,u.ProviderType=a.ProviderType,u.AttachmentThumbnailUrl=a.AttachmentThumbnailUrl,u.AttachmentPreviewUrl=a.AttachmentPreviewUrl}if(Object(B.a)([{attachmentId:i,attachment:n,permissionInfo:c}],!1),t.attachmentId=i,Object(M.a)(t))Object(U.a)(t,1);else{Object(W.h)(t,!1),setTimeout((function(){N(t,1.1)}),500),Object(o.a)(t,0,0);var s=Object(j.a)(i);Object(q.a)(t,s,!1,t.strategy.supportedMenuActions),s.download.url||Object(H.a)(i,t.isReadOnly,!0)}}));function G(t){return Object(r.a)({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},t)}function J(t,e,n,r,a,c,o,i){var u,s,d=function(t,e,n,r,a,c,o,i){return G({ewsAttachmentId:t,emailId:e,subscriptionId:n,channelId:r,cancellationId:a,fullPathLocation:c,attachmentDataProviderId:i,PermissionLevel:o})}(t,e,n,r,a,c,o,i);return void 0===(u={requestObject:d}).requestObject||u.requestObject.__type||(u.requestObject=G(u.requestObject)),Object(p.a)("ConvertRefToLocalAttachment",u,s)}function $(t){return Z(Object(j.a)(t).model.Size)}function K(t){return 2856+.00145*t}function X(t){return 4*Z(t)}function Q(t){return 4*Z(t)}function Y(t){return 2*Z(t)}function Z(t){return Math.round(t/256)}var tt=n(4907),et={},nt=Object(f.action)("convertCloudyToClassic",(function(t,e,n,r,a,c){return{attachment:t,parentItemId:e,fullPathLocation:n,permissionLevel:r,replaceAttachmentHandler:a,source:c}})),rt=nt;function at(t,e,n,a,c,o){return Object(r.c)(this,void 0,void 0,(function(){var i,u,s,d,l,f;return Object(r.f)(this,(function(h){switch(h.label){case 0:return[4,Object(I.a)(c)];case 1:i=r.g.apply(void 0,[h.sent(),4]),u=i[0],s=i[1],d=i[2],l=i[3],et[t.Id]=u,h.label=2;case 2:return h.trys.push([2,4,,5]),[4,J(t.Id,e,u,l,u,n,a)];case 3:return h.sent(),[3,5];case 4:return f=h.sent(),o(f.message),C.i.importAndExecute(s,d),[3,5];case 5:return[2]}}))}))}function ct(t,e){switch(e){case 0:break;case 11:Object(o.a)(t,0,0);break;default:Object(o.a)(t,0,12)}delete et[t.attachmentId.Id]}function ot(t,e,n,r,a){var c,o=Object(j.a)(e);t.addCosmosOnlyData(JSON.stringify({size:o.model.Size,attachmentId:null===(c=o.model.AttachmentId)||void 0===c?void 0:c.Id})),t.addCustomData([n,a]),0===n||11===n?t.end():t.endWithError("ServerError",new Error(r))}function it(t){return Object(r.a)({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},t)}function ut(t){var e,n,r=function(t){return it({cancellationId:t})}(t);return void 0===(e=r)||e.__type||(e=it(e)),Object(p.a)("CancelConvertRefToLocalAttachment",e,n)}Object(f.orchestrator)(nt,(function(t){var e=t.attachment;!function(t,e,n,a,c,i){Object(r.c)(this,void 0,void 0,(function(){var u,s,d;return Object(r.f)(this,(function(r){switch(r.label){case 0:return u=new O.b("AttachmentConvertCloudyToClassic"),function(t){Object(o.a)(t,6,11)}(t),s=function(e){if(ct(t,e.ResultCode),ot(u,t.attachmentId,e.ResultCode,e.Exception,i),0===e.ResultCode){var n=Object(tt.a)({Name:e.Item.Name,Size:e.Item.Size,AttachmentId:e.NewAttachmentId});c(!0,n)}else c(!1,null);return!0},d=function(e){ct(t,1),c(!1,null),ot(u,t.attachmentId,1,e,i)},[4,at(t.attachmentId,e,n,a,s,d)];case 1:return r.sent(),[2]}}))}))}(e,t.parentItemId,t.fullPathLocation,t.permissionLevel,(function(n,r){n?t.replaceAttachmentHandler(e,r,!1,!0):s(e.attachmentId,n)}),t.source),d($(e.attachmentId),.1,(function(t){N(e,t)}),e.attachmentId)}));var st=Object(f.action)("cancel_ConvertCloudyToClassic",(function(t){return Object(D.c)(R,{attachmentViewState:t})})),dt=st;Object(f.orchestrator)(st,(function(t){var e,n=(e=t.attachmentViewState.attachmentId.Id,et[e]);if(!n)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(o.a)(t.attachmentViewState,6,10),ut(n)}));var lt=n(2070),ft=n(2644),ht=n(2860),mt=n(2399);function vt(t){return Object(r.c)(this,void 0,void 0,(function(){var e,n,a=this;return Object(r.f)(this,(function(c){switch(c.label){case 0:return[4,mt.h.import()];case 1:return e=c.sent(),(n=t.model).ProviderType!==lt.a.providers.ONE_DRIVE_PRO?[2]:(e(n.AttachLongPathName,ht.a.OneDrivePro,!1).then((function(e){return Object(r.c)(a,void 0,void 0,(function(){var n,a;return Object(r.f)(this,(function(r){switch(r.label){case 0:return e&&0===e.ResultCode?(n=Object(ft.b)(t.model,!0),[4,lt.g.importAndExecute(n,t.attachmentClass,t.model,!0,t.model.ProviderType,e)]):[2];case 1:return a=r.sent(),lt.l.importAndExecute(t.id,a),Object(lt.o)(t.id),[2]}}))}))})),[2])}}))}))}var pt=n(24),bt=n(1992);function Ot(t,e,n){if(t&&e===lt.a.providers.ONE_DRIVE_PRO&&(Object(pt.i)("doc-SxS-jsApi-ODB-Base")||Object(pt.i)("doc-SxS-jsApi-ODB-BaseNoEditString")||Object(pt.i)("doc-SxS-jsApi-ODB-Readonly"))){var r=n&&n.substring(n.lastIndexOf("."));switch(Object(bt.f)(r)){case bt.a.Word:return Object(pt.i)("doc-SxS-jsApi-ODB-Word");case bt.a.Excel:return Object(pt.i)("doc-SxS-jsApi-ODB-Excel");case bt.a.PowerPoint:return!Object(pt.i)("doc-SxS-jsApi-ODB-Readonly")&&Object(pt.i)("doc-SxS-jsApi-ODB-PowerPoint")}}return!1}var jt=n(4707),It=n(2065);function Ct(t,e,n,r,a){return void 0===n&&(n=!1),void 0===r&&(r=0),void 0===a&&(a=!1),{attachmentType:1,attachmentId:t,isInline:!0,isHiddenInline:n,placeholderId:e,status:r,fileType:It.a.Inline,skipProcessInlineImage:a}}function yt(t){return!!t.strategy.isSaveToCloudSupported&&-1===t.completedActions.indexOf(2)}var wt=n(4705);n.d(e,"a",(function(){return h.a})),n.d(e,"h",(function(){return m.a})),n.d(e,"c",(function(){return _})),n.d(e,"e",(function(){return S})),n.d(e,"u",(function(){return L.a})),n.d(e,"w",(function(){return L.c})),n.d(e,"v",(function(){return L.b})),n.d(e,"D",(function(){return L.d})),n.d(e,"x",(function(){return N})),n.d(e,"y",(function(){return k.a})),n.d(e,"z",(function(){return U.a})),n.d(e,"A",(function(){return o.a})),n.d(e,"E",(function(){return F})),n.d(e,"r",(function(){return q.a})),n.d(e,"o",(function(){return q.b})),n.d(e,"d",(function(){return dt})),n.d(e,"f",(function(){return rt})),n.d(e,"m",(function(){return vt})),n.d(e,"b",(function(){return Ot})),n.d(e,"B",(function(){return d})),n.d(e,"C",(function(){return s})),n.d(e,"k",(function(){return K})),n.d(e,"l",(function(){return Q})),n.d(e,"q",(function(){return X})),n.d(e,"j",(function(){return Y})),n.d(e,"g",(function(){return jt.a})),n.d(e,"i",(function(){return Ct})),n.d(e,"p",(function(){return $})),n.d(e,"t",(function(){return yt})),n.d(e,"s",(function(){return M.a})),n.d(e,"n",(function(){return wt.a}))},2796:function(t,e,n){"use strict";var r;!function(t){t[t.ChangePermissions=0]="ChangePermissions",t[t.CopyLink=1]="CopyLink",t[t.Download=2]="Download",t[t.OpenInNewTab=3]="OpenInNewTab",t[t.Preview=4]="Preview",t[t.SaveToCloud=5]="SaveToCloud",t[t.ViewInProvider=6]="ViewInProvider",t[t.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",t[t.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",t[t.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",t[t.MoveAttachmentToInline=10]="MoveAttachmentToInline",t[t.RefreshLink=11]="RefreshLink",t[t.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),e.a=r},2860:function(t,e,n){"use strict";n.d(e,"e",(function(){return o})),n.d(e,"b",(function(){return i})),n.d(e,"f",(function(){return u})),n.d(e,"g",(function(){return s})),n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return l}));var r=n(31),a=n(3340);n.d(e,"a",(function(){return a.a}));var c=new r.c((function(){return Promise.all([n.e(42),n.e(81),n.e(634)]).then(n.bind(null,6775))})),o=new r.b(c,(function(t){return t.createGetSharingInfoResponse})),i=new r.b(c,(function(t){return t.checkSharingLinkUrlDomain})),u=new r.b(c,(function(t){return t.getLinkProviderType})),s=new r.b(c,(function(t){return t.isOneDriveProRelatedLink})),d=new r.b(c,(function(t){return t.convertToAttachmentDataProviderType})),l=new r.b(c,(function(t){return t.convertToLinkProviderType}))},3340:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.OneDrivePro=0]="OneDrivePro",t[t.OneDriveConsumer=1]="OneDriveConsumer",t[t.Dropbox=2]="Dropbox",t[t.Box=3]="Box",t[t.GDrive=5]="GDrive",t[t.OfficeOneDrivePro=31]="OfficeOneDrivePro"}(r||(r={}))},3822:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c}));var r=n(1992);function a(t){var e="";return(null==t?void 0:t.model)&&(e=Object(r.c)(t.model.Name||"")||t.model.ContentType||""),e}function c(t){var e;return(null===(e=a(t))||void 0===e?void 0:e.substring(0,4))||""}},4303:function(t,e,n){"use strict";var r=n(183);e.a=Object(r.action)("setInlineAttachmentStatus")((function(t,e){t.status=e}))},4466:function(t,e,n){"use strict";var r=n(2143),a=n(183);e.a=Object(a.action)("deleteAttachment")((function(t){Object(r.a)().attachments.delete(t.Id)}))},4702:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1),a=n(121),c=n(3262),o=n(3691),i=n(23);function u(t,e,n,u,s){return Object(r.c)(this,void 0,void 0,(function(){var d,l,f,h,m,v,p,b,O,j,I,C,y,w;return Object(r.f)(this,(function(r){switch(r.label){case 0:d=new a.b("getWacInfoForOneDriveJsApi",{isCore:!0}),u&&d.addCustomData({redeemSharingLinkIfNecessary:u}),r.label=1;case 1:return r.trys.push([1,3,,4]),l=btoa(e),f="u!"+l.replace(/^\=+|\=+$/g,"").replace("/","_").replace("+","-"),h=new RegExp(/.+?\:\/\/.+?(\/)/g).exec(e)[0],m=h+"_api/v2.0/shares/"+f+"/root?select=openWith/wac,officeBundle,@content.downloadUrl,name,size,currentUserRole&action="+(n?"Open":"View"),v=new Object,u&&(v.prefer="redeemSharingLinkIfNecessary"),p=Object(c.a)({ProviderType:t,Url:m,Headers:JSON.stringify(v)}),b=(new Date).getTime(),[4,Object(o.a)(p)];case 2:if(200===(O=r.sent()).Status&&O.Body)return j=(new Date).getTime(),(I=JSON.parse(O.Body)).fetchStartTime=b,I.responseStartTime=j,!I.openWith.wac&&s||(I.openWith.wac.fileGetUrl=I["@content.downloadUrl"],I.openWith.wac.accessTokenExpiry&&(I.openWith.wac.accessTokenExpiry=new Date(Number(I.openWith.wac.accessTokenExpiry))),!n&&I.currentUserRole&&(I.currentUserRole.readOnly=!0)),d.end(),[2,I];throw d.addCustomData({StatusCode:O.Status}),(C=O.Headers)&&(y=JSON.parse(C))&&d.addCustomData({SharePointError:y.SharePointError,SPClientServiceRequestDuration:y.SPClientServiceRequestDuration,SPRequestGuid:y.SPRequestGuid}),new Error("Result status is: "+O.Status+" or empty response body.");case 3:return w=r.sent(),d.endWithError("ServerError",w),i.g.warn("Something went wrong while calling fetchDataProviderResourceOperation: "+w),[3,4];case 4:return[2,null]}}))}))}},4706:function(t,e,n){"use strict";function r(t,e){e&&t&&(t.addCustomData({httpStatusCode:e.status}),function(t,e){e&&t&&t.addCustomData({frontendServer:e.get("x-feserver"),requestId:e.get("request-id"),backendServer:e.get("x-beserver"),backendHttpStatus:e.get("x-backendhttpstatus"),serverVersion:e.get("x-owa-version")})}(t,e.headers))}function a(t){return t&&void 0!==t.fetchErrorType}function c(t,e){t.addCustomProperty("ErrorInformation",e)}function o(t,e){c(t,e?"Empty response from server":"Null response from server")}n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return a})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return o}))},4707:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1),a=n(2099),c=n(2065);function o(t,e,n,o,i,u,s){void 0===i&&(i=c.a.Unknown),void 0===u&&(u=!1),void 0===s&&(s=null);var d=Object(a.d)(t,e,o,u,i,s),l=d.strategy;return Object(r.a)(Object(r.a)({},d),{attachmentType:0,strategy:Object(r.a)(Object(r.a)({},l),{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),shouldShowContextMenu:!1,shouldShowImageOverlay:!1,shouldShowActionsContainer:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},4709:function(t,e,n){"use strict";function r(t){return 1===t.attachmentType}n.d(e,"a",(function(){return r}))},4907:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1);function a(t){return Object(r.a)({__type:"FileAttachment:#Exchange"},t)}},5185:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(3433),a=n(8164),c=n(8165),o=n(4707),i=n(2065),u=n(2217),s=n(4355),d=n(1996);function l(t,e,n,l,f,h,m,v,p){void 0===m&&(m=null),void 0===p&&(p=!1),Object(s.a)([{attachmentId:t,attachment:e}],n,f);var b=Object(d.a)(t),O=Object(o.a)(t,n,l,1===b.type,i.a.Unknown,!1,m);if(Object(r.a)(O,b,!1,v,h),p){var j=b.model.ProviderType;Object(u.b)(O.isCloudy,j,b.model.Name)?Object(c.a)(b,O):Object(a.a)(O)}return O}},5187:function(t,e,n){"use strict";var r=n(183);e.a=Object(r.action)("setAttachmentShouldShowContextMenu")((function(t,e){t.shouldShowContextMenu=e}))},6129:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(33);function a(t,e){return Object(r.a)("GetWacAttachmentInfo",t,e)}},6602:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(1),a=n(121),c=n(4706),o=n(6603),i=n(419),u={},s={},d=[],l=0,f=2;function h(t,e,n,c){return Object(r.c)(this,void 0,void 0,(function(){var o,i;return Object(r.f)(this,(function(u){return o=new a.b("InitializeWacUrl"),n&&o.addCustomProperty("actionSource",n),(i=v(t,e,o))?[2,i]:[2,new Promise((function(a,i){var u={attachmentId:t,isEdit:e,actionSource:n,datapoint:o,resolve:a,reject:i};c?m(u):(d.push(u),function t(){return Object(r.c)(this,void 0,void 0,(function(){var e;return Object(r.f)(this,(function(n){switch(n.label){case 0:if(!d.length)return[2];if(l>=f)return[2];e=d.shift(),l++,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,m(e)];case 2:return n.sent(),[3,4];case 3:return l--,t(),[7];case 4:return[2]}}))}))}())}))]}))}))}function m(t){var e;return Object(r.c)(this,void 0,void 0,(function(){var n,a,d,l,f,h,m,p,b;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(n=t.attachmentId,a=t.isEdit,d=t.actionSource,l=t.datapoint,f=t.resolve,h=t.reject,m=v(n,a,l))return f(m),[2];l.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(o.a)(n.Id,a,null,Object(i.a)(n.mailboxInfo),d)];case 2:return 0===(p=r.sent()).Status&&((a?s:u)[n.Id]={expireTime:(new Date).getTime()+36e5,value:p}),p.WacUrl||l.addCustomProperty("WacUrlIsEmpty",!0),l.addCustomProperty("WacAttachmentResponseStatus",null===(e=p.Status)||void 0===e?void 0:e.toString()),l.end(),f(p),[3,4];case 3:return b=r.sent(),Object(c.a)(b)&&Object(c.c)(l,b.response),Object(c.d)(l,b.toString()),l.endWithError("ServerError"),h(b),[3,4];case 4:return[2]}}))}))}function v(t,e,n){var r=e?s:u,a=r[t.Id];if(a){if(a.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),a.value;delete r[t.Id]}return null}},6603:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(6129);function a(t,e,n,a,c){if(c){var o="getWacAttachmentInfo"+c;(a=a||{}).headers=a.headers||new Headers,a.headers.set("X-OWA-ActionName",o)}return Object(r.a)({attachmentId:t,isEdit:e,draftId:n,appId:null},a)}},6800:function(t,e,n){"use strict";var r=n(1),a=n(613),c=n(33);function o(t,e){var n;return void 0===t||t.__type||(n=t,t=Object(r.a)({__type:"ImportCalendarEventJsonRequest:#Exchange"},n)),Object(c.a)("ImportCalendarEvent",t,e)}var i=n(984),u=n(180),s=n(419);function d(t,e,n,c){var d,l;return c&&(d=Object(s.a)(c)),o({Header:Object(u.b)(),Body:(l={Content:t,ImportedItemFolderId:Object(i.a)({BaseFolderId:Object(a.a)({Id:e})}),AttachmentId:n},Object(r.a)({__type:"ImportCalendarEventRequest:#Exchange"},l))},Object(r.a)({datapoint:{jsonCustomData:function(t){return{status:t.ResponseClass,numberOfEventsImported:t.NumberOfEventsImported}}}},d)).then((function(t){if(null!=t&&null!=t.Body)return t.Body;throw new Error("[importCalendarOperation failed]")}))}n.d(e,"a",(function(){return d}))},7392:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2293),a=n(2276);function c(t){t.previewMethod===a.a.Wac&&(t.previewMethod=a.a.Unsupported,t.supportedOpenActions=t.supportedOpenActions.filter((function(t){return t!==r.a.Preview})))}},8163:function(t,e,n){"use strict";var r=n(2),a=n(44),c=Object(r.action)("addCalendarEventsAttachment",(function(t,e){return Object(a.c)({name:"AttachmentAddCalendarEvent",customData:{addToCalendarSource:e}},{attachment:t})}));e.a=c},8164:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1),a=n(7392),c=n(2276),o=n(6602);function i(t){return Object(r.c)(this,void 0,void 0,(function(){var e;return Object(r.f)(this,(function(n){switch(n.label){case 0:return t.strategy.previewMethod!==c.a.Wac?[3,2]:[4,Object(o.a)(t.attachmentId,!1)];case 1:9!==(e=n.sent()).Status&&6!==e.Status||Object(a.a)(t.strategy),n.label=2;case 2:return[2]}}))}))}},8165:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1),a=n(7392),c=n(7393),o=n(4702),i=n(24);function u(t,e){return Object(r.c)(this,void 0,void 0,(function(){var n,u,s;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=t,Object(i.i)("doc-unwrap-safelinks")?[4,Object(c.a)(t.model)]:[3,2];case 1:return s=r.sent(),[3,3];case 2:s=n.openUrl,r.label=3;case 3:return u=s,[4,Object(o.a)(0,u,!1,!1,!0)];case 4:return r.sent()||Object(a.a)(e.strategy),[2]}}))}))}}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~ConversationAttachment~Html~4d4b65a0.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~ConversationAttachment~Html~4d4b65a0.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentPreviewSxS~AttachmentPreviewSxSInitialize~Attachments~ConversationAttachment~Html~4d4b65a0.js'] = (new Date()).getTime();