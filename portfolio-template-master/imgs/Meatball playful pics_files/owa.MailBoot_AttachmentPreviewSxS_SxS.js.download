self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentPreviewSxS~SxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[229],{10108:function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return a}));var r=n(31),u=n(6719);n.d(e,"a",(function(){return u.a}));var i=new r.c((function(){return Promise.all([n.e(5),n.e(7),n.e(13),n.e(14),n.e(22),n.e(94),n.e(230),n.e(679)]).then(n.bind(null,17841))})),o=new r.b(i,(function(t){return t.addToCalendar})),c=(new r.b(i,(function(t){return t.getIcsCalendarItem})),new r.b(i,(function(t){return t.getIcsCalendarItemOrchestrator}))),a=Object(r.d)(i,(function(t){return t.IcsPreview}))},10456:function(t,e,n){"use strict";var r=n(33),u=n(1);function i(t,e){var n;return void 0===t||t.__type||(n=t,t=Object(u.a)({__type:"GetAttachmentTextPreviewRequest:#Exchange"},n)),Object(r.a)("GetAttachmentTextPreview",t,e)}n.d(e,"a",(function(){return i}))},11629:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1),u=n(10456),i=n(23);function o(t,e,n,o){return Object(r.c)(this,void 0,void 0,(function(){var c,a,s,d,f;return Object(r.f)(this,(function(r){switch(r.label){case 0:c={error:null,errorMessage:"Something went wrong while the document preview was being created. Please try again later."},r.label=1;case 1:return r.trys.push([1,3,,4]),o&&(a="getAttachmentTextPreview"+o,(e=e||{}).headers=e.headers||new Headers,e.headers.set("X-OWA-ActionName",a)),[4,Object(u.a)({AttachmentId:t,ReadMode:n},e)];case 2:if((s=r.sent())&&0===s.Status)return[2,s.Content];switch(d=(null==s?void 0:s.Status)||1){case 2:c.errorMessage="The attachment has been moved or deleted.";break;case 3:c.errorMessage="Something went wrong while the document preview was being created. Please try again later.";break;case 1:default:c.errorMessage="Something went wrong while the document preview was being created. Please try again later."}return c.error=new Error("getAttachmentTextPreview failed with status: "+d),[3,4];case 3:return f=r.sent(),i.g.warn("getAttachmentTextPreview failed with error: "+f),c.error=f,[3,4];case 4:throw c}}))}))}},11955:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1),u=n(4921),i=n(6),o=n(7414),c=n(6602);function a(t,e,n){return Object(r.c)(this,void 0,void 0,(function(){var a,s;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(c.a)(t,e,n,!0)];case 1:return a=r.sent(),[3,3];case 2:throw s=r.sent(),{errorMessage:Object(i.b)(u.a),error:s};case 3:if(0===a.Status)return[2,{wacUrl:a.WacUrl,bootScriptUrl:a.BootScriptUrl,wopiSrcUrl:a.WopiSrcUrl,accessToken:a.AccessToken,accessTokenTtl:a.AccessTokenTtl,additionalParameters:a.AdditionalParameters,deprecatedTokenAndParameters:a.Token}];throw{errorMessage:Object(o.a)(a.Status),error:new Error("GetWacAttachmentInfo failed with status: "+a.Status)}}}))}))}},1281:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1);function u(t){return Object(r.a)({__type:"FindItemJsonRequest:#Exchange"},t)}},1302:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(33),u=n(1281);function i(t,e){return void 0===t||t.__type||(t=Object(u.a)(t)),Object(r.a)("FindItem",t,e)}},1304:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1);function u(t){return Object(r.a)({__type:"FindItemRequest:#Exchange"},t)}},186:function(t,e,n){"use strict";function r(){var t=Object.create(null),e=0,n=0,r=0,u=!1;function i(e){r--,delete t[e]}this.put=function(e,n,u,o){if(void 0!==u&&("number"!=typeof u||isNaN(u)||u<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var c=t[e];c?clearTimeout(c.timeout):r++;var a={value:n,expire:u+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){i(e),o&&o(e,n)}.bind(this),u)),t[e]=a,n},this.del=function(e){var n=!0,r=t[e];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(e),n},this.clear=function(){for(var i in t)clearTimeout(t[i].timeout);r=0,t=Object.create(null),u&&(e=0,n=0)},this.get=function(i){var o=t[i];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return u&&e++,o.value;u&&n++,r--,delete t[i]}else u&&n++;return null},this.size=function(){return r},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){u=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var r=t[n];e[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var r=JSON.parse(e),u=Date.now(),i=n&&n.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(i)if(t[o])continue;var c=r[o],a=c.expire-u;if(a<=0){this.del(o);continue}a=a>0?a:void 0,this.put(o,c.value,a)}return this.size()}}t.exports=new r,t.exports.Cache=r},1969:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Base64InlineImage=0]="Base64InlineImage",t[t.Cloud=1]="Cloud",t[t.Local=2]="Local",t[t.MailItem=3]="MailItem",t[t.Uri=4]="Uri",t[t.AttachmentItem=5]="AttachmentItem",t[t.CloudSuggestion=6]="CloudSuggestion",t[t.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",t[t.Inline=8]="Inline",t[t.Smime=9]="Smime",t[t.FilesHub=10]="FilesHub",t[t.GroupFilesHub=11]="GroupFilesHub",t[t.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",t[t.Unknown=13]="Unknown",t[t.ContextualSuggestion=14]="ContextualSuggestion",t[t.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",t[t.SmartDoc=16]="SmartDoc",t[t.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1986:function(t,e,n){"use strict";var r=n(1),u=n(2051),i=n(374),o=n(730),c=n(121),a=n(5),s="X-AnchorMailbox",d="Authorization",f="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";function b(t,e){return Object(r.c)(this,void 0,void 0,(function(){var n,b,v,O,p;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(i.k)(t)){if(b.accountState==i.b.AccessRevoked)return[2,null];if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.c)(b.accountState,b.accountProviderType),[2,null]}return e?(n[s]=e,n[l]=e):b&&(n[s]=b.anchorMailbox),b?(v=b.token,!(O=Object(o.g)(b.tokenExpiry))&&v?[3,2]:(Object(c.s)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(b.tokenExpiry,Object(a.Rb)()),isTokenExpired_1:O,isTokenInvalid_2:!v},{isCore:!0}),[4,u.a.importAndExecute(b.accountId,t,v)])):[3,3];case 1:(v=r.sent())||(v=""),r.label=2;case 2:p=void 0,"Outlook"==b.accountProviderType?(p='MSAuth1.0 usertoken="'+v+'", type="MSACT"',n[f]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(p="Bearer "+v,n[f]=2..toString()),n[d]=p,r.label=3;case 3:return[2,n]}}))}))}var v=n(1989),O=n(23);function p(t,e){return Object(r.c)(this,void 0,void 0,(function(){var n,u;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=Object(v.a)(),u=n,[4,m(t,e)];case 1:return u.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function m(t,e){var n;return Object(r.c)(this,void 0,void 0,(function(){var u,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return u=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,[4,b(t.mailboxInfo.userIdentity,h(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(v.b)(u,i),[2,u]}}))}))}function h(t,e){var n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&O.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return h}))},1989:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach((function(n){return t.set(n,e[n])}))}function u(t){var e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return u}))},1991:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2),u=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},2051:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(31),u=n(1991);n.d(e,"b",(function(){return u.a}));var i=new r.c((function(){return n.e(1286).then(n.bind(null,2298))})),o=new r.a(i,(function(t){return t.getAndUpdateAccessToken}))},2065:function(t,e,n){"use strict";var r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function u(t){var e=null,n=r.exec(t);if(n){var u=n[1],i=n[2],o=null;try{o=atob(i)}catch(t){}if(o){for(var c=new ArrayBuffer(o.length),a=new Uint8Array(c),s=0;s<o.length;s++)a[s]=o.charCodeAt(s);e=new File([c],"image.png",{type:u})}}return e}var i=n(1969),o=n(1992);function c(t){return t.map((function(t){return{fileType:i.a.Uri,name:t.name,type:Object(o.b)(t.url)||"",size:0,uri:t.url}}))}var a=n(23);function s(t,e,n){if(t.length!=e.length)return a.d("The sizes of subjects and latestItemIds are different"),null;for(var r=[],u=0;u<t.length;u++){var o={fileType:i.a.MailItem,name:t[u],size:(null==n?void 0:n[u])||0,itemId:e[u]};r.push(o)}return r}function d(t,e,n){var r=[],u={fileType:i.a.MailItem,name:t,size:n||0,mimeContent:e};return r.push(u),r}function f(t){if(!t)return null;for(var e=[],n=0;n<t.length;n++){var r=t[n],u={fileType:i.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};e.push(u)}return e}function l(t){if(!t)return null;for(var e=[],n=0;n<t.length;n++){var r=t[n],u={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};e.push(u)}return e}function b(t){var e,n;return null===t?null:{fileType:i.a.Cloud,name:t.Name,size:t.Size,providerId:t.AttachmentProviderId,providerType:t.ProviderType,location:t.Location,providerEndpointUrl:t.ProviderEndpointUrl,isFolder:1===t.Type,fileId:t.Id,fileParentId:t.ParentId,thumbnailUrl:(null===(e=t.Thumbnail)||void 0===e?void 0:e.Url)||"",previewUrl:(null===(n=t.Preview)||void 0===n?void 0:n.Url)||"",type:t.MimeType}}function v(t){return null===t?null:{attachmentItemId:t.Id,name:t.Name,size:t.Size,fileType:i.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var O={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function p(t){switch(t?t.toLowerCase():null){case O.ONE_DRIVE_PRO.toLowerCase():return 0;case O.GDRIVE.toLowerCase():return 5;case O.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case O.DROPBOX.toLowerCase():return 2;case O.BOX.toLowerCase():return 3;case O.WOPI_BOX.toLowerCase():return 7;case O.WOPI_EGNYTE.toLowerCase():return 8;case O.MAILBOX.toLowerCase():return 4;case O.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(e,"f",(function(){return u})),n.d(e,"j",(function(){return c})),n.d(e,"i",(function(){return s})),n.d(e,"h",(function(){return d})),n.d(e,"g",(function(){return f})),n.d(e,"d",(function(){return l})),n.d(e,"e",(function(){return b})),n.d(e,"c",(function(){return v})),n.d(e,"b",(function(){return p})),n.d(e,"a",(function(){return i.a}))},2067:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1);function u(t){return Object(r.a)({__type:"IndexedPageView:#Exchange"},t)}},217:function(t,e,n){"use strict";var r=n(859);n.d(e,"a",(function(){return r.a}))},2292:function(t,e,n){"use strict";var r=n(2);e.a=Object(r.action)("DELETE_ITEMS_STORE_UPDATE",(function(t,e,n){return{itemContexts:t,parentFolderId:e,actionType:n}}))},2350:function(t,e,n){"use strict";var r=n(31),u=n(2750),i=n(2392),o=n(2292),c=n(2423),a=n(2524),s=n(2525),d=n(2626),f=n(2751),l=n(2656),b=n(2036),v=n(24),O=n(1955);function p(t,e){return!!t&&(1!==e&&!!O.a.conversations.get(t))}function m(t,e){return 2!=e&&(Object(v.i)("rp-persistedReadingPaneTabs")?b.a.loadedItemReadingPaneViewStates.has(t):b.a.itemReadingPaneViewState&&b.a.itemReadingPaneViewState.itemId==t)}var h=n(2440),w=n(2441),j=n(2377),I=n(2093);n.d(e,"l",(function(){return g})),n.d(e,"p",(function(){return T})),n.d(e,"m",(function(){return y})),n.d(e,"q",(function(){return A})),n.d(e,"s",(function(){return P})),n.d(e,"n",(function(){return E})),n.d(e,"o",(function(){return k})),n.d(e,"i",(function(){return x})),n.d(e,"j",(function(){return R})),n.d(e,"k",(function(){return C})),n.d(e,"g",(function(){return _})),n.d(e,"r",(function(){return N})),n.d(e,"h",(function(){return L})),n.d(e,"d",(function(){return p})),n.d(e,"e",(function(){return m})),n.d(e,"f",(function(){return h.a})),n.d(e,"a",(function(){return w.a})),n.d(e,"t",(function(){return b.a})),n.d(e,"c",(function(){return j.a})),n.d(e,"b",(function(){return I.a}));var S=new r.c((function(){return Promise.all([n.e(4),n.e(6),n.e(7),n.e(13),n.e(14),n.e(19),n.e(22),n.e(24),n.e(25),n.e(32),n.e(69),n.e(72),n.e(75),n.e(94),n.e(136),n.e(154),n.e(192),n.e(194),n.e(289),n.e(299),n.e(302),n.e(786)]).then(n.bind(null,18185))})),g=new r.a(S,(function(t){return t.loadConversationReadingPane})),T=new r.a(S,(function(t){return t.moveReadingPaneToTab})),y=new r.a(S,(function(t){return t.loadConversationReadingPaneForSingleMailItemSelected})),A=new r.a(S,(function(t){return t.print})),P=new r.a(S,(function(t){return t.setItemIdToScrollTo})),E=new r.a(S,(function(t){return t.loadItemReadingPane})),k=new r.a(S,(function(t){return t.loadItemReadingPaneForSingleMailItemSelected})),x=new r.a(S,(function(t){return t.expandCollapseAllItemParts}));Object(r.f)(o.a,S,(function(t){return t.deleteItemsStoreUpdateOrchestrator})),Object(r.f)(a.a,S,(function(t){return t.markConversationsAsReadStoreUpdateOrchestrator})),Object(r.f)(s.a,S,(function(t){return t.markItemsAsReadStoreUpdateOrchestrator})),Object(r.f)(c.a,S,(function(t){return t.markAllAsReadOrchestrator})),Object(r.f)(u.a,S,(function(t){return t.applyConversationFlagStateStoreUpdateOrchestrator})),Object(r.f)(i.a,S,(function(t){return t.deleteConversationStoreUpdateOrchestrator})),Object(r.f)(l.a,S,(function(t){return t.conversationReadyToLoadOrchestrator})),Object(r.f)(l.b,S,(function(t){return t.updateAttachmentsOrchestrator})),Object(r.f)(l.c,S,(function(t){return t.updateItemMandatoryPropertiesOrchestrator})),Object(r.f)(d.a,S,(function(t){return t.updateInternetMessageIdOrchestrator})),Object(r.f)(f.a,S,(function(t){return t.initializeExtendedCardForItemReadingPaneOrchestrator}));new r.b(S,(function(t){return t.getLastestNonDraftItemId}));var R=new r.b(S,(function(t){return t.getLatestNonDraftItemIdFromConversation})),C=new r.b(S,(function(t){return t.isUnsupportedItem})),_=new r.a(S,(function(t){return t.clearReadingPaneStore})),N=new r.a(S,(function(t){return t.replyByMeeting})),L=new r.a(S,(function(t){return t.ensureSecondaryReadingPaneTabHandler}))},2377:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2036),u=n(24),i=n(2442);function o(t){return Object(u.i)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedItemReadingPaneViewStates.get(t||Object(i.a)()):Object(r.b)().itemReadingPaneViewState}},2382:function(t,e,n){"use strict";n.d(e,"u",(function(){return d})),n.d(e,"g",(function(){return f})),n.d(e,"i",(function(){return l})),n.d(e,"j",(function(){return b})),n.d(e,"k",(function(){return v})),n.d(e,"l",(function(){return O})),n.d(e,"m",(function(){return p})),n.d(e,"n",(function(){return m})),n.d(e,"o",(function(){return h})),n.d(e,"p",(function(){return w})),n.d(e,"q",(function(){return j})),n.d(e,"r",(function(){return I})),n.d(e,"s",(function(){return S})),n.d(e,"t",(function(){return g})),n.d(e,"v",(function(){return T})),n.d(e,"h",(function(){return y}));var r=n(31),u=n(3589);n.d(e,"a",(function(){return u.a}));var i=n(3062);n.d(e,"b",(function(){return i.a})),n.d(e,"e",(function(){return i.d}));var o=n(3037);n.d(e,"f",(function(){return o.a}));var c=n(3084);n.d(e,"d",(function(){return c.a}));var a=n(3590);n.d(e,"c",(function(){return a.a}));var s=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5),n.e(16),n.e(22),n.e(24),n.e(41),n.e(42),n.e(69),n.e(77),n.e(78),n.e(75),n.e(82),n.e(142),n.e(170),n.e(309),n.e(229),n.e(300),n.e(835)]).then(n.bind(null,6770))})),d=new r.b(s,(function(t){return t})),f=new r.b(s,(function(t){return t.resetPreviewPane})),l=(new r.b(s,(function(t){return t.setAudioPreviewState})),new r.b(s,(function(t){return t.setBlankPreviewState})),new r.b(s,(function(t){return t.setCustomPreviewState})),new r.b(s,(function(t){return t.setIframePreviewState}))),b=(new r.b(s,(function(t){return t.setImageGalleryItems})),new r.b(s,(function(t){return t.setImagePreviewLoaded}))),v=new r.b(s,(function(t){return t.setImagePreviewState})),O=new r.b(s,(function(t){return t.setImagePreviewStateFromImageGalleryItem})),p=(new r.b(s,(function(t){return t.setNativePdfPreviewState})),new r.b(s,(function(t){return t.setPanesSize}))),m=(new r.b(s,(function(t){return t.setPdfJsPreviewState})),new r.b(s,(function(t){return t.setPdfJsPreviewStateByData})),new r.b(s,(function(t){return t.setPreviewError}))),h=new r.b(s,(function(t){return t.setPreviewLoading})),w=new r.b(s,(function(t){return t.setRightPaneDisplayAndUpdateSize})),j=new r.b(s,(function(t){return t.setSaveStatusText})),I=new r.b(s,(function(t){return t.setTextPreviewState})),S=(new r.b(s,(function(t){return t.setVideoPreviewState})),new r.b(s,(function(t){return t.setWacPreviewState}))),g=new r.b(s,(function(t){return t.setWacReadOnly})),T=new r.b(s,(function(t){return t.updatePanesSize})),y=new r.b(s,(function(t){return t.saveHideReadingPaneOption}));new r.b(s,(function(t){return t.saveDefaultEditCommandOption}))},2392:function(t,e,n){"use strict";var r=n(2);e.a=Object(r.action)("DELETE_CONVERSATION_STORE_UPDATE",(function(t,e,n){return{conversationIds:t,tableView:e,actionType:n}}))},2423:function(t,e,n){"use strict";var r=n(2);e.a=Object(r.action)("MARK_ALL_AS_READ_STORE_UPDATE",(function(t,e,n){return{tableView:t,markAsRead:e,rowIdsToExclude:n}}))},2440:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(24);function u(){return Object(r.i)("rp-linkedInViewProfile")||Object(r.i)("rp-linkedInViewProfileV1_1")}},2441:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r="displaylinkedindataprebind"},2508:function(t,e,n){"use strict";var r=n(2551);n.d(e,"a",(function(){return r.a})),n.d(e,"b",(function(){return r.b}));var u=n(2361);n.d(e,"c",(function(){return u.a}));var i=n(2360);n.d(e,"d",(function(){return i.a}))},2524:function(t,e,n){"use strict";var r=n(2);e.a=Object(r.action)("MARK_CONVERSATIONS_AS_READ_STORE_UPDATE",(function(t,e,n,r){return{conversationIds:t,tableViewId:e,isReadValue:n,isExplicit:r}}))},2525:function(t,e,n){"use strict";var r=n(2);e.a=Object(r.action)("MARK_ITEMS_AS_READ_STORE_UPDATE",(function(t,e,n,r){return{itemIds:t,isReadValue:e,isExplicit:n,tableViewId:r}}))},2626:function(t,e,n){"use strict";var r=n(2);e.a=Object(r.action)("updateInternetMessageId",(function(t,e,n){return{conversationId:t,itemId:e,internetMessageId:n}}))},2704:function(t,e,n){"use strict";var r=n(94),u=n(2508),i=n(65),o=n(3159);function c(t,e,n,i,c){var a;void 0===c&&(c=!0);var s=e,d=s.Name,f=s.OriginalPermissionType,l=s.PermissionType,b=Object(o.a)(e),v="GroupMailbox"===(null===(a=null==t?void 0:t.mailboxInfo)||void 0===a?void 0:a.type)?t.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return u.b(t,b,n,i,l,f,c,d,v);case 1:return e.AttachmentPreviewUrl?e.AttachmentPreviewUrl:u.b(t,b,1,i,l,f,c,d,v);case 2:return e.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function a(t,e,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),u.a(t,e,n,r)}function s(t,e,n,r,o){void 0===o&&(o=!1);var s=n?c(t,e,1,r,!1):a(t,1,o,!1);if(n)return{url:s,init:{credentials:"include"}};var d=Object(u.c)(t.mailboxInfo),f=new Headers;return f.set("X-Token",d),f.set("X-OWA-CANARY",Object(i.a)()),{url:s,init:{headers:f}}}function d(t,e,n,r,u,i){return void 0===i&&(i=!1),r?c(t,e,n,u):a(t,n,i)}n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s}))},2750:function(t,e,n){"use strict";var r=n(2);e.a=Object(r.action)("APPLY_CONVERSATION_FLAG_STATE_STORE_UPDATE",(function(t,e,n){return{conversationIds:t,flagType:e,tableViewId:n}}))},2861:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1),u=n(2043),i=n(1962),o=n(2119),c=n(94);function a(t,e,n,a){var l,b;void 0===e&&(e=0);var v=function(t){switch(t){case 0:return s;case 1:return d;case 2:return f;default:return Object(c.a)(t)}}(e),O=Object(o.b)();try{for(var p=Object(r.k)(Object(i.a)().tabs),m=p.next();!m.done;m=p.next()){var h=m.value;if(h.type==u.a.MailCompose&&0==h.state){var w=O.viewStates.get(h.data);if((null==w?void 0:w.isInlineCompose)&&v(w,t)&&(0==w.asyncSendState||n&&6==w.asyncSendState)&&(!a&&!h.projectionRPTabId||h.projectionRPTabId==a))return w}}}catch(t){l={error:t}}finally{try{m&&!m.done&&(b=p.return)&&b.call(p)}finally{if(l)throw l.error}}return null}function s(t,e){return t.conversationId===e}function d(t,e){return t.referenceItemId.Id===e}function f(t,e){return!1}},3062:function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"e",(function(){return c})),n.d(e,"f",(function(){return a}));var r=600,u=600,i=650,o=1/2.89*100,c=420,a=420/1300*100},3159:function(t,e,n){"use strict";function r(t){var e=null;return(e=t.AttachLongPathName)||(e=t.WebUrl),e}n.d(e,"a",(function(){return r}))},326:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r,u=n(1);function i(t){r=t}function o(){var t,e;return Object(u.c)(this,void 0,void 0,(function(){var n,i;return Object(u.f)(this,(function(u){switch(u.label){case 0:return(i=r)?[4,r()]:[3,2];case 1:i=u.sent(),u.label=2;case 2:if((n=i)&&n.length>0){if("bearer"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},3589:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r="autoHideEmail"},3590:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Default=0]="Default",t[t.NeedPassword=1]="NeedPassword",t[t.IncorrectPassword=2]="IncorrectPassword"}(r||(r={}))},374:function(t,e,n){"use strict";var r,u=n(2);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var i,o=n(44),c=Object(u.action)("addAccount",(function(t){return{userIdentity:t.userIdentity,account:t}})),a=Object(u.action)("removeAccount",(function(t){return{userIdentity:t}})),s=Object(u.action)("updateAccount",(function(t,e,n){return{userIdentity:t,accountToken:e,accountTokenExpiresIn:n}})),d=Object(u.action)("updateOWAConnectedAccountStatus",(function(t,e){return{userIdentity:t,accountState:e}})),f=Object(u.action)("accountIsInErrorState",(function(t,e){return Object(o.c)({name:"accountIsInErrorState",customData:{accountState_1:r[t],accountProvider_2:e}},{accountState:t})})),l=Object(u.action)("retryAccountUpdateToken",(function(t,e,n){return{accountId:t,userIdentity:e,currentToken:n}})),b=Object(u.action)("connectedAccountsListRequested",(function(t){return{isSuccess:t}})),v=Object(u.action)("setAccountsStoreState",(function(t){return{state:t}})),O=n(1),p=n(14);!function(t){t[t.None=0]="None",t[t.Loading=1]="Loading",t[t.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",t[t.AccountsLoadError=3]="AccountsLoadError"}(i||(i={}));var m=Object(u.createStore)("OWAAccountsStore",{accountsMap:new p.ObservableMap({}),accountsLoadedState:i.None}),h=n(94),w=n(57);function j(t){return t!=Object(w.b)()&&void 0!==S(t)}function I(){return Object(O.j)([],Object(O.g)(m().accountsMap.values()))}function S(t){return m().accountsMap.get(t)}function g(){var t;return(null===(t=I())||void 0===t?void 0:t.length)>0?I()[0]:null}function T(){return I().filter((function(t){return t.accountState!=r.Valid}))}function y(t){return I().filter((function(e){return t.includes(e.accountState)}))}function A(t){return I().filter((function(e){return e.accountProviderType==t}))}function P(t){return j(t)?S(t).accountProviderType:null}function E(t){return"Outlook"==t.accountProviderType?'MSAuth1.0 usertoken="'+t.token+'", type="MSACT"':"Google"==t.accountProviderType||"ICloud"==t.accountProviderType?"Bearer "+t.token:Object(h.a)(t.accountProviderType)}function k(t,e){return function(n){var r=S(n);return r?r[t]:e}}k("accountUniqueId","0");var x=k("accountState",r.Valid),R=function(){return I().some((function(t){return!N(t.userIdentity)}))},C=k("accountProviderType",null),_=function(t){return"Outlook"==C(t)},N=function(t){return x(t)==r.Valid},L=function(){return I().length>0};function M(){return m().accountsLoadedState}var U=n(5),D=n(121);Object(u.mutator)(c,(function(t){var e=t.account;Object(D.s)("owaAccountAdded",{accountStatus_1:r[e.accountState]}),m().accountsMap.set(e.userIdentity,e)})),Object(u.mutator)(a,(function(t){var e=t.userIdentity;m().accountsMap.delete(e)})),Object(u.mutator)(s,(function(t){var e=t.userIdentity,n=t.accountToken,r=t.accountTokenExpiresIn,u=m().accountsMap.get(e);u.token=n,u.tokenExpiry=Object(U.j)(Object(U.Rb)(),parseInt(r))})),Object(u.mutator)(d,(function(t){var e=t.userIdentity,n=t.accountState,u=m().accountsMap.get(e);u.accountState==r.Valid&&n!=r.Valid&&Object(D.s)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[n]}),u.accountState=n})),Object(u.mutator)(b,(function(t){var e=t.isSuccess?i.AccountsLoadSuccessful:i.AccountsLoadError;m().accountsLoadedState=e})),Object(u.mutator)(v,(function(t){m().accountsLoadedState=t.state})),n.d(e,"d",(function(){return c})),n.d(e,"u",(function(){return a})),n.d(e,"y",(function(){return s})),n.d(e,"x",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"v",(function(){return l})),n.d(e,"e",(function(){return b})),n.d(e,"w",(function(){return v})),n.d(e,"n",(function(){return I})),n.d(e,"k",(function(){return S})),n.d(e,"i",(function(){return g})),n.d(e,"f",(function(){return T})),n.d(e,"g",(function(){return y})),n.d(e,"o",(function(){return A})),n.d(e,"j",(function(){return P})),n.d(e,"m",(function(){return E})),n.d(e,"l",(function(){return x})),n.d(e,"q",(function(){return R})),n.d(e,"t",(function(){return _})),n.d(e,"s",(function(){return N})),n.d(e,"p",(function(){return L})),n.d(e,"h",(function(){return M})),n.d(e,"r",(function(){return j})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}))},419:function(t,e,n){"use strict";var r=n(1);function u(t,e){return t?Object(r.a)({mailboxInfo:t},e):null!=e?e:void 0}n.d(e,"a",(function(){return u}))},518:function(t,e,n){"use strict";var r=function(){function t(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();n.d(e,"a",(function(){return r}))},6719:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.SINGLE_EVENT_ICS=1]="SINGLE_EVENT_ICS",t[t.MULTIPLE_EVENT_ICS=2]="MULTIPLE_EVENT_ICS"}(r||(r={}))},730:function(t,e,n){"use strict";var r=n(2),u=Object(r.action)("initializeOwaObservableDateTime"),i=Object(r.action)("observableNowChanged"),o=Object(r.action)("observableTodayChanged"),c=n(5),a=n(14),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),d=Object(a.computed)((function(){return Object(c.nc)(s().now)})),f=function(){return d.get()},l=Object(a.computed)((function(){return Object(c.nc)(s().today)})),b=function(){return l.get()},v=function(t){return Object(c.Hb)(t,f())},O=function(t){return Object(c.Fb)(t,f())},p=function(t){return h(t,c.Hb)},m=function(t){return h(t,c.Ib)},h=function(t,e){return e(Object(c.Yb)(Object(c.nc)(t)),b())};function w(t){if(!t)return"";var e=Object(c.nc)(t);return function(t,e){var n=Object(c.Yb)(t);if(Object(c.Jb)(n,e))return c.ab;var r=function(t){return Object(c.Ob)(n,Object(c.e)(e,-t),e)};if(r(3))return c.ib;if(r(30))return c.hb;return c.Y}(e,b())(e)}function j(t){if(!t)return"";var e=Object(c.nc)(t);return function(t,e){var n=Object(c.Yb)(t);if(Object(c.Jb)(n,e))return c.T;return c.U}(e,b())(e)}function I(t){return t?function(t,e){var n=Object(c.Yb)(t);return Object(c.Jb)(n,e)?Object(c.ab)(t):S(n,e,2)?Object(c.lb)(t):S(n,e,7)?Object(c.H)(Object(c.bb)(t),Object(c.ab)(t)):Object(c.H)(Object(c.J)(t),Object(c.ab)(t))}(Object(c.nc)(t),b()):""}function S(t,e,n){return Object(c.Ob)(t,Object(c.e)(e,-n),e)}var g=Object(r.action)("updateTimes"),T=Object(r.action)("setNow"),y=Object(r.action)("setToday",(function(t){return{today:t}}));Object(r.mutator)(T,(function(){s().now=Object(c.lc)()})),Object(r.mutator)(y,(function(t){var e=t.today;s().today=e}));var A=n(21),P=n(79),E=!1;Object(r.orchestrator)(u,(function(){if(g(),!E){var t=Object(c.Rb)(),e=Object(c.ac)(Object(c.h)(t,1)),n=Object(c.w)(e,t);setTimeout((function(){return setInterval(g,A.g)}),n),document&&document.addEventListener("visibilitychange",g),E=!0}})),Object(r.orchestrator)(P.l,(function(){g()})),Object(r.orchestrator)(g,(function(){T();var t=Object(c.Ab)(Object(c.mc)()),e=s().today!=t;e&&y(t),i(),e&&o()})),n.d(e,"d",(function(){return u})),n.d(e,"j",(function(){return i})),n.d(e,"l",(function(){return o})),n.d(e,"i",(function(){return f})),n.d(e,"k",(function(){return b})),n.d(e,"g",(function(){return v})),n.d(e,"e",(function(){return O})),n.d(e,"f",(function(){return p})),n.d(e,"h",(function(){return m})),n.d(e,"a",(function(){return w})),n.d(e,"b",(function(){return j})),n.d(e,"c",(function(){return I}))},7414:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(8189),u=n(9526),i=n(4921),o=n(6);function c(t){switch(t){case 2:return Object(o.b)(u.d);case 3:return Object(o.b)(u.e);case 5:return Object(o.b)(u.c);case 6:return Object(o.b)(r.a);case 7:return Object(o.b)(u.g);case 4:return Object(o.b)(u.f);case 10:return Object(o.b)(u.a);case 11:return Object(o.b)(u.b);default:return Object(o.b)(i.a)}}},8189:function(t){t.exports=JSON.parse('{"a":"H6a"}')},8357:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n(31),u=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5),n.e(16),n.e(22),n.e(24),n.e(41),n.e(42),n.e(69),n.e(77),n.e(78),n.e(75),n.e(82),n.e(142),n.e(170),n.e(309),n.e(229),n.e(300),n.e(835)]).then(n.bind(null,12139))})),i=new r.b(u,(function(t){return t.getSxSViewStateFromElement})),o=Object(r.d)(u,(function(t){return t.SxSLayerView}));Object(r.d)(u,(function(t){return t.SxSView}))},859:function(t,e,n){"use strict";function r(t){return t>=200&&t<300}n.d(e,"a",(function(){return r}))},9526:function(t){t.exports=JSON.parse('{"d":"b_a","e":"c_a","c":"d_a","g":"e_a","f":"f_a","a":"g_a","b":"h_a"}')},984:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(1);function u(t){return Object(r.a)({__type:"TargetFolderId:#Exchange"},t)}}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentPreviewSxS~SxS.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentPreviewSxS~SxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentPreviewSxS~SxS.js'] = (new Date()).getTime();