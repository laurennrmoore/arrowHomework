self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AttachmentSuggestions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[543],{1551:function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},15607:function(e){e.exports=JSON.parse('{"b":"i8a","a":"j8a","c":"k8a","d":"l8a"}')},15608:function(e,t,n){var r=n(15609),i=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},15609:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._1_RVgWKT13Of8m-6JD216D{position:relative;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;color:inherit;width:100%;height:48px;line-height:32px;display:block;cursor:pointer;outline:transparent}html[dir] ._1_RVgWKT13Of8m-6JD216D{background-color:transparent;padding-top:0;padding-bottom:0;border-width:initial;border-style:none;border-color:initial;-o-border-image:initial;border-image:initial}html[dir=ltr] ._1_RVgWKT13Of8m-6JD216D{padding-right:12px;padding-left:12px;text-align:left}html[dir=rtl] ._1_RVgWKT13Of8m-6JD216D{padding-left:12px;padding-right:12px;text-align:right}html[dir] ._1_RVgWKT13Of8m-6JD216D:hover{background-color:"[theme:neutralLighter, default:#f3f2f1]"}html[dir] ._1_RVgWKT13Of8m-6JD216D:active{background-color:"[theme:neutralLight, default:#edebe9]"}._3xMR3Es0pceOJoC4AFuF2z{white-space:nowrap;height:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%}._3kBQTqhaV4iUtKcufkVeO_{display:inline-block;color:"[theme:themePrimary, default:#0078D4]";height:32px;width:32px;vertical-align:middle;-ms-flex-negative:0;flex-shrink:0;overflow:hidden}html[dir=ltr] ._3kBQTqhaV4iUtKcufkVeO_{margin-right:8px}html[dir=rtl] ._3kBQTqhaV4iUtKcufkVeO_{margin-left:8px}._27LyKuPbcUOZRqJr0LTLk3{max-width:276px;width:100%;height:100%}._3tCFNbcqTVWfLjndWn_HR{font-size:14px;color:"[theme:neutralPrimary, default:#323130]";line-height:19px;max-width:100%}._3tCFNbcqTVWfLjndWn_HR,._2Dqu0Dvz1bVPvC4skREKGT{font-weight:400;display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}._2Dqu0Dvz1bVPvC4skREKGT{font-size:11px;color:"[theme:neutralSecondary, default:#605e5c]";line-height:15px;max-width:276px}html[dir] ._2Dqu0Dvz1bVPvC4skREKGT{padding-top:1px}._3zX90JDzBiC8P1sbIFlsI6{max-width:340px}._3st6kn7_XMVJlHwQAoF9xY{font-size:12px;font-weight:400;font-weight:600;color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] ._3st6kn7_XMVJlHwQAoF9xY{margin-left:1px}html[dir=rtl] ._3st6kn7_XMVJlHwQAoF9xY{margin-right:1px}._1-B-5uUC3kcMGsQqWDzdnh{font-size:12px;font-weight:400;font-weight:600;color:"[theme:themePrimary, default:#0078D4]";height:32px;line-height:32px;width:100%}html[dir=ltr] ._1-B-5uUC3kcMGsQqWDzdnh{margin-left:11px;margin-right:4px}html[dir=rtl] ._1-B-5uUC3kcMGsQqWDzdnh{margin-right:11px;margin-left:4px}._1kNYqY2OL-q4v9-S09AAfv{position:absolute;top:20px}html[dir=ltr] ._1kNYqY2OL-q4v9-S09AAfv{left:24px}html[dir=rtl] ._1kNYqY2OL-q4v9-S09AAfv{right:24px}html[dir] ._2GPgIoy696jOqypNjKKcX3{margin:0}',""]),t.locals={attachmentSuggestionButton:"_1_RVgWKT13Of8m-6JD216D",attachmentSuggestionButtonContent:"_3xMR3Es0pceOJoC4AFuF2z",attachmentSuggestionButtonImageContainer:"_3kBQTqhaV4iUtKcufkVeO_",attachmentSuggestionButtonTextContainer:"_27LyKuPbcUOZRqJr0LTLk3",attachmentSuggestionPrimaryText:"_3tCFNbcqTVWfLjndWn_HR",attachmentSuggestionSecondaryText:"_2Dqu0Dvz1bVPvC4skREKGT",attachmentSuggestionButtonRoot:"_3zX90JDzBiC8P1sbIFlsI6",replyWithHeaderForBottomBar:"_3st6kn7_XMVJlHwQAoF9xY",replyWithHeaderForCommandingBar:"_1-B-5uUC3kcMGsQqWDzdnh",fileIcon:"_1kNYqY2OL-q4v9-S09AAfv",cloudyIcon:"_2GPgIoy696jOqypNjKKcX3"}},186:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function a(t){r--,delete e[t]}this.put=function(t,n,i,o){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var u={value:n,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){a(t),o&&o(t,n)}.bind(this),i)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&a(t),n},this.clear=function(){for(var a in e)clearTimeout(e[a].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(a){var o=e[a];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return i&&t++,o.value;i&&n++,r--,delete e[a]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),a=n&&n.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(a)if(e[o])continue;var c=r[o],u=c.expire-i;if(u<=0){this.del(o);continue}u=u>0?u:void 0,this.put(o,c.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},1969:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1992:function(e,t,n){"use strict";var r=n(1963),i=n(2210),a=n(6);function o(e){var t;return e>=1073741824?(e/=1073741824,t=Object(a.b)(i.b)):e>=1048576?(e/=1048576,t=Object(a.b)(i.d)):e>=1024?(e/=1024,t=Object(a.b)(i.c)):t=Object(a.b)(i.a),Object(a.c)(t,Math.round(e))}var c,u=n(2061),s=n(24),l=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function d(e){if(!Object(s.i)("doc-attachment-documentThumbnail"))return!1;var t=Object(r.a)(e);return!!t&&l.indexOf(t.toLowerCase())>=0}function f(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return c.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return c.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return c.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(c||(c={}));var h=n(2019);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return o})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return h.b})),n.d(t,"a",(function(){return c}))},2019:function(e,t,n){"use strict";function r(e){return t=e||"",(n=a.exec(t))&&n.length>1&&i[n[1].toLowerCase()];var t,n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},a=/^\s*([^;\s]*)(?:;|\s|$)/;function o(e){var t="";return Object.entries(i).forEach((function(n){n[1]===e&&(t=n[0])})),t}},2061:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(1963),i=n(2019),a=n(102),o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],c=[".tiff",".tif"];function u(e,t,n){return void 0===n&&(n=!0),s(Object(r.a)(e)||Object(i.a)(t),n)}function s(e,t){return void 0===t&&(t=!0),!!e&&(o.indexOf(e.toLowerCase())>=0||t&&c.indexOf(e.toLowerCase())>=0&&(Object(a.e)()||Object(a.d)()||Object(a.h)()||Object(a.g)()&&!Object(a.l)()))}},2065:function(e,t,n){"use strict";var r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function i(e){var t=null,n=r.exec(e);if(n){var i=n[1],a=n[2],o=null;try{o=atob(a)}catch(e){}if(o){for(var c=new ArrayBuffer(o.length),u=new Uint8Array(c),s=0;s<o.length;s++)u[s]=o.charCodeAt(s);t=new File([c],"image.png",{type:i})}}return t}var a=n(1969),o=n(1992);function c(e){return e.map((function(e){return{fileType:a.a.Uri,name:e.name,type:Object(o.b)(e.url)||"",size:0,uri:e.url}}))}var u=n(23);function s(e,t,n){if(e.length!=t.length)return u.d("The sizes of subjects and latestItemIds are different"),null;for(var r=[],i=0;i<e.length;i++){var o={fileType:a.a.MailItem,name:e[i],size:(null==n?void 0:n[i])||0,itemId:t[i]};r.push(o)}return r}function l(e,t,n){var r=[],i={fileType:a.a.MailItem,name:e,size:n||0,mimeContent:t};return r.push(i),r}function d(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],i={fileType:a.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};t.push(i)}return t}function f(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(i)}return t}function h(e){var t,n;return null===e?null:{fileType:a.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function m(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:a.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var p={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function g(e){switch(e?e.toLowerCase():null){case p.ONE_DRIVE_PRO.toLowerCase():return 0;case p.GDRIVE.toLowerCase():return 5;case p.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case p.DROPBOX.toLowerCase():return 2;case p.BOX.toLowerCase():return 3;case p.WOPI_BOX.toLowerCase():return 7;case p.WOPI_EGNYTE.toLowerCase():return 8;case p.MAILBOX.toLowerCase():return 4;case p.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"f",(function(){return i})),n.d(t,"j",(function(){return c})),n.d(t,"i",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return a.a}))},2101:function(e,t,n){"use strict";var r=n(2),i=n(14),a=n(2193),o={providers:new i.ObservableMap,loadState:a.a.NotLoaded,removalPending:new i.ObservableMap},c=Object(r.createStore)("fileProviderStore",o);t.a=c},2102:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n(2),i=Object(r.action)("FILE_PROVIDER_ADDED",(function(e){return{providerViewState:e}})),a=Object(r.action)("FILE_PROVIDER_REMOVED",(function(e){return{providerType:e}})),o=Object(r.action)("PROVIDERS_LOADED",(function(e){return{providers:e}}))},2118:function(e,t,n){"use strict";n.d(t,"l",(function(){return h})),n.d(t,"n",(function(){return m})),n.d(t,"k",(function(){return p})),n.d(t,"m",(function(){return g}));var r=n(31),i=n(2329);n.d(t,"b",(function(){return i.a}));var a=n(2294);n.d(t,"i",(function(){return a.a}));n(2101);var o=n(2102);n.d(t,"d",(function(){return o.a})),n.d(t,"e",(function(){return o.b})),n.d(t,"o",(function(){return o.c}));var c=n(2295);n.d(t,"a",(function(){return c.b}));var u=n(2175);n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return u.b}));var s=n(2282);n.d(t,"j",(function(){return s.a}));var l=n(2193);n.d(t,"c",(function(){return l.a}));var d=n(2279);n.d(t,"f",(function(){return d.b}));var f=new r.c((function(){return Promise.all([n.e(4),n.e(635)]).then(n.bind(null,3603))})),h=new r.b(f,(function(e){return e.loadProviders})),m=new r.b(f,(function(e){return e.removeFileProvider})),p=new r.b(f,(function(e){return e.addFileProvider})),g=new r.b(f,(function(e){return e.removeAndAddFileProvider}))},2175:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=n(1),i=n(2101),a=function(){return Object(r.j)([],Object(r.g)(Object(i.a)().providers.values()))},o=function(e){return Object(i.a)().providers.get(e)||null}},2185:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Mail="owa.react",e.MailCompose="owa.react.compose",e.Calendar="owa.react.calendar",e.FilesHub="owa.react.filesHub",e.MailSubject="owa.react.mail.subject",e.MailEmailAttachmentPicker="owa.react.mail.emailPicker",e.SuggestedAttachments="suggestedattachments",e.MeetingPrep="MeetingPrep",e.MeetingPrepPrefetch="MeetingPrep.Prefetch",e.MeetingPrepPeek="MeetingPrep.Peek",e.MeetingPrepReminder="MeetingPrep.Reminder",e.MeetingPrepAgenda="MeetingPrep.AgendaView",e.MeetingPrepMailCalendarCard="MeetingPrep.MailCalendarCard",e.MeetingPrepDesktop="OutlookDesktopOPX.MeetingPrep",e.MeetingPrepShell="ShellOPX.MeetingPrep",e.ContextualInsights="ContextualInsights",e.FileSuggestions="owa.react.filepicker",e.SonoraFilePicker="outlook.inlinefilepicker",e.SonoraHoneybee="owa.honeybee"}(r||(r={})),t.b=r},2193:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded",e[e.Throttled=3]="Throttled"}(r||(r={}))},2210:function(e){e.exports=JSON.parse('{"b":"Nea","d":"Oea","c":"Pea","a":"Qea"}')},2229:function(e,t,n){"use strict";n.d(t,"g",(function(){return a})),n.d(t,"j",(function(){return o})),n.d(t,"v",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"o",(function(){return s})),n.d(t,"r",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return h})),n.d(t,"h",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"f",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"m",(function(){return O})),n.d(t,"p",(function(){return j})),n.d(t,"q",(function(){return I})),n.d(t,"n",(function(){return x})),n.d(t,"u",(function(){return S})),n.d(t,"a",(function(){return y})),n.d(t,"s",(function(){return C})),n.d(t,"t",(function(){return w}));var r=n(31),i=new r.c((function(){return Promise.all([n.e(21),n.e(68),n.e(811)]).then(n.bind(null,3511))})),a=new r.a(i,(function(e){return e.logEntityClicked})),o=new r.a(i,(function(e){return e.logResponseReceived})),c=new r.a(i,(function(e){return e.logSessionEnd})),u=new r.a(i,(function(e){return e.logResponseRendered})),s=new r.a(i,(function(e){return e.logSearchBoxStateChanged})),l=new r.a(i,(function(e){return e.logSearchResultInteraction})),d=new r.a(i,(function(e){return e.logResponseNeverRendered})),f=new r.a(i,(function(e){return e.flushNonRenderedResponseReceivedItemsFromCache})),h=new r.a(i,(function(e){return e.logCachedContentRendered})),m=new r.a(i,(function(e){return e.logFeedback})),p=new r.a(i,(function(e){return e.logClientLayout})),g=new r.a(i,(function(e){return e.logClientDataSource})),b=new r.a(i,(function(e){return e.logEntitiesFromFilePicker})),v=new r.a(i,(function(e){return e.logResponseRecievedV2})),O=new r.a(i,(function(e){return e.logResultsRendered})),j=new r.a(i,(function(e){return e.logSearchEntityActions})),I=new r.a(i,(function(e){return e.logSearchFeedbackActions})),x=new r.a(i,(function(e){return e.logSearchActions})),S=new r.a(i,(function(e){return e.logSecondaryEntityActionClicked})),y=new r.a(i,(function(e){return e.clearProcessedTraceIds})),C=new r.a(i,(function(e){return e.logSearchSuggestionsClientLayoutEvent})),w=new r.a(i,(function(e){return e.logSearchSuggestionsResultsRenderedEvent}))},2279:function(e,t,n){"use strict";var r=n(1),i=n(33);function a(e){return Object(r.a)({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}function o(e){var t,n,r=a({ProviderType:e});return void 0===(t=r)||t.__type||(t=a(t)),Object(i.a)("GetNewAttachmentDataProviderCreationInfo",t,n)}function c(e){return Object(r.a)({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}function u(e){var t,n,r=c({ProviderType:e});return void 0===(t=r)||t.__type||(t=c(t)),Object(i.a)("GetAttachmentDataProviderCreator",t,n)}var s=n(2594),l=n(2541);n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return I}));var d="code",f="token",h=3e3,m=3;function p(e){return{state:e}}function g(e){return e.state}function b(e){return e.code}function v(e,t,n,i,a){var c={providerType:e,getAuthUrlInfo:null,getCSRFToken:g,getOAuthCode:b};return function e(t,n,i,a,c,l,d){return Object(r.c)(this,void 0,void 0,(function(){var f,m;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),f=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,u(t)];case 1:return m=r.sent(),f=m.AttachmentDataProviderCreator.ProviderAppKey,i=m.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,o(t)];case 3:m=r.sent(),f=m.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(s.d)(t,i,a,f,c,l),[3,6];case 5:return r.sent(),d>0&&setTimeout((function(){return e(t,n,i,a,c,l,--d)}),h),[3,6];case 6:return[2]}}))}))}(e,c,t,n,i,a,m),c}var O=null;function j(){if(!O){if(O={},Object(l.a)(3)&&(O[3]=v(3,"https://app.box.com/api/oauth2/authorize",Object(s.c)(3),d,p)),Object(l.a)(2)&&(O[2]=v(2,"https://www.dropbox.com/oauth2/authorize",Object(s.b)(2),d,p)),Object(l.a)(6)){var e=v(6,"https://www.facebook.com/dialog/oauth",Object(s.b)(6),f,(function(e){return{state:e,scope:"user_photos,email"}}));e.getCSRFToken=g,e.getOAuthCode=function(e){return e.access_token},O[6]=e}if(Object(l.a)(5)){var t=v(5,"https://accounts.google.com/o/oauth2/auth",s.a+"/ADPRedirect.aspx",d,(function(e){var t={state:e,provider:5..toString(),url:Object(s.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}}));t.getCSRFToken=function(e){return JSON.parse(e.state).state},O[5]=t}Object(l.a)(1)&&(O[1]=v(1,"https://login.live.com/oauth20_authorize.srf",Object(s.c)(1),d,(function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}))),Object(l.a)(7)&&(O[7]=v(7,"",Object(s.c)(7),d,p)),Object(l.a)(8)&&(O[8]=v(8,"",Object(s.c)(8),d,p)),Object(l.a)(9)&&(O[9]=v(9,"",Object(s.c)(9),d,p))}return O}function I(e){var t=j();return e in t?t[e]:null}},2282:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2101);function i(){return Object(r.a)().loadState}},2294:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2630),i=n(2564),a=n(2605),o=n(6),c=n(94);function u(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(o.b)(a.b);case 1:return Object(o.b)(a.a);case 2:case 9:return Object(o.b)(r.b);case 3:case 7:return Object(o.b)(r.a);case 5:return Object(o.b)(r.e);case 6:return Object(o.b)(r.d);case 4:return Object(o.b)(r.f);case 10:return Object(o.b)(i.b);case 8:return Object(o.b)(r.c);default:return Object(c.a)(e)}}},2295:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o}));var r,i=n(1);!function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));var a=Object.freeze([1,3,2,6,5,7,8,9]),o=Object.freeze(Object(i.j)(Object(i.j)([],Object(i.g)(a)),[0,4,10]))},2329:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},2541:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2004),i=n(197),a=n(94),o=n(24);function c(e){var t=Object(r.a)();switch(e){case 5:return(null==t?void 0:t.GoogleDriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==t?void 0:t.BoxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-box");case 2:return(null==t?void 0:t.DropboxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-dropbox");case 6:return(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-facebook");case 1:return!!Object(i.a)()||(null==t?void 0:t.OnedriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled);case 10:return Object(o.i)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.i)("doc-fileProvider-wopiClient");default:return Object(a.a)(e)}}},2553:function(e,t,n){"use strict";var r=n(1),i=n(210);var a=n(24),o=n(8);n.d(t,"a",(function(){return s}));var c=null,u="searchtesthook";function s(e){void 0===e&&(e={});var t,n=Object(r.a)(Object(r.a)(Object(r.a)({},e),function(){if(!c){c={};var e=Object(o.a)(u),t=decodeURIComponent(e||"").trim();if(Object(a.i)("sea-debugHook")&&t.length>0){var n=t.split("&");c=n.reduce((function(e,t){var n=Object(r.g)(t.split("="),2),i=n[0],a=n[1];return e[i]=a,e}),{})}}return c}()),Object(i.a)("includePartnerIn3SRequest")?((t={}).partner="exchangeshared",t):null);return Object.keys(n).filter((function(e){return null!==n[e]})).reduce((function(e,t){var i;return Object(r.a)(Object(r.a)({},e),((i={})[t]=n[t],i))}),{})}},2564:function(e){e.exports=JSON.parse('{"a":"Vna","b":"Wna"}')},2594:function(e,t,n){"use strict";var r=n(514),i=n(4);function a(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s}));var o=Object(i.K)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){var t=e?encodeURIComponent("?provider="+e):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.m)()+"/mail/"+n+t}function u(e){var t=Object(r.m)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+e+"&url="+t);return o+"/ADPRedirect.aspx?"+n}function s(e,t,n,r,i,o){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[],r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}(),c=a(t,"client_id",r);if(c=a(c,"redirect_uri",n),c=a(c,"response_type",i),o){var u=o(e);c=Object.keys(u).reduce((function(e,t){return a(e,t,u[t])}),c)}return{authUrl:c,redirectUrl:n,csrfToken:e}}}},2605:function(e){e.exports=JSON.parse('{"b":"Tna","a":"Una"}')},2630:function(e){e.exports=JSON.parse('{"b":"Nna","a":"Ona","e":"Pna","d":"Qna","f":"Rna","c":"Sna"}')},2969:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(42),i=n(41),a=n(57);function o(){var e=Object(r.a)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.a)(t)}function c(){var e,t,n=(e="",(t=Object(i.a)().pathname.split("/").filter((function(e){return e.length}))).length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e);if(0===n.length){var r=Object(a.h)();if(null==r?void 0:r.SessionSettings){var c=r.SessionSettings.ExternalDirectoryTenantGuid,u=r.SessionSettings.UserPuid;u&&c&&(n="PUID:"+u+"@"+c)}}return 0===n.length&&(n=o()),n}},326:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r,i=n(1);function a(e){r=e}function o(){var e,t;return Object(i.c)(this,void 0,void 0,(function(){var n,a;return Object(i.f)(this,(function(i){switch(i.label){case 0:return(a=r)?[4,r()]:[3,2];case 1:a=i.sent(),i.label=2;case 2:if((n=a)&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},3262:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},3691:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(33),i=n(3262);function a(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FetchDataProviderResource",e,t)}},518:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();n.d(t,"a",(function(){return r}))},744:function(e,t,n){"use strict";function r(e){if(!e)return e;var t=e.replace(/\+/g,"_");return t=t.replace(/\//g,"-")}function i(e){if(!e)return e;var t=e.replace(/_/g,"+");return t=t.replace(/-/g,"/")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},7733:function(e,t,n){"use strict";n.r(t);var r=n(2),i=Object(r.action)("clearCachedAttachmentSuggestions",(function(e,t){return{referenceItemId:e,composeId:t}})),a=Object(r.action)("getAttachmentSuggestionsAction",(function(e,t,n,r){return{referenceItem:e,composeId:t,isPrefetch:n,message:r}})),o=n(14),c={attachments:[],traceId:null,contextualAttachmentSuggestions:new o.ObservableMap({}),referenceItemIdAndComposeIdMap:new o.ObservableMap({})},u=Object(r.createStore)("MRUAttachmentStore",c),s=3,l=5,d="KEY_NULLREFERENCEITEMID";Object(r.mutator)(i,(function(e){var t,n=u(),r=e.composeId,i=e.referenceItemId||d,a=n.referenceItemIdAndComposeIdMap,o=null===(t=a.get(i))||void 0===t?void 0:t.filter((function(e){return e!==r}));(null==o?void 0:o.length)>0?a.set(i,o):(a.delete(i),i!==d&&n.contextualAttachmentSuggestions.delete(i))}));Object(r.mutator)(a,(function(e){var t,n,r=e.composeId,i=(null===(n=null===(t=e.referenceItem)||void 0===t?void 0:t.ItemId)||void 0===n?void 0:n.Id)||d,a=u().referenceItemIdAndComposeIdMap,o=a.get(i);o?o.push(r):a.set(i,[r])}));var f=Object(r.action)("getContextualMRUSuggestionsAction",(function(e,t,n){return{referenceItemId:e,isPrefetch:t,message:n}})),h=Object(r.action)("getMRUSuggestionsAction",(function(e,t){return{isPrefetch:e,message:t}})),m=Object(r.action)("storeContextualMRUSuggestionsOnItemAction",(function(e,t,n){return{referenceItemId:e,contextualSuggestions:t,traceId:n}})),p=Object(r.action)("storeMRUSuggestionsAction",(function(e,t){return{mruAttachments:e,traceId:t}})),g=(Object(r.mutator)(m,(function(e){u().contextualAttachmentSuggestions.set(e.referenceItemId,{attachments:e.contextualSuggestions,traceId:e.traceId})})),Object(r.mutator)(p,(function(e){var t=u();t.attachments=e.mruAttachments,t.traceId=e.traceId})),n(24));Object(r.orchestrator)(a,(function(e){var t,n;Object(g.i)("doc-suppressAttachmentSuggestions")||((null===(n=null===(t=e.referenceItem)||void 0===t?void 0:t.ItemId)||void 0===n?void 0:n.Id)?f(e.referenceItem.ItemId.Id,e.isPrefetch,e.message):h(e.isPrefetch,e.message))}));var b=n(1),v=n(23),O=n(295),j=n(3574),I=n(744),x=n(121);var S=n(2969),y=n(2229),C=n(2185),w=n(2553),A=n(440),E=n(514),R="application/json;charset=utf-8",T="/search/api/v1/recommendations";function P(e,t,n){var r;return Object(b.c)(this,void 0,void 0,(function(){var i,a,o,c,u,s,l,d,f,h,m,p,g;return Object(b.f)(this,(function(b){switch(b.label){case 0:i=[],a=0,o="",c=null,u=null,s=0,b.label=1;case 1:return b.trys.push([1,7,8,9]),Object(x.s)("MRUQueryExecuted"),c=new x.b("QueryResponseInformation",{logVerbose:!0}),e?c.addCustomData({endpoint:j.a.MRUContextual}):c.addCustomData({endpoint:j.a.MRUCloudy}),[4,k()];case 2:return l=b.sent(),d=function(e,t,n,r){var i={};i.headers=new Headers,i.headers.set("Authorization","Bearer "+e),i.headers.set("Content-Type",R),i.method="POST";var a=Object(S.b)();a&&i.headers.append("X-AnchorMailbox",a);i.headers.set("X-Client-LocalTime",(new Date).toISOString());var o={EntityRequests:[{Context:{EntityId:t||void 0,EntityContext:r?[r]:void 0}}],Scenario:{Name:n?"AttachFile.Prefetch":"AttachFile"}};return i.body=JSON.stringify(o),i}(l,e,t,n),c.addCheckmark("Request"),f=(new Date).getTime(),[4,fetch(Object(E.v)(T,Object(w.a)()),d)];case 3:return h=b.sent(),c.addCheckmark("Response"),s=(new Date).getTime()-f,h?[3,4]:(o="No response",[3,6]);case 4:return[4,h.text()];case 5:m=b.sent(),p=null;try{p=JSON.parse(m)}catch(e){}c.addCustomData({statusCode:h.status}),u=null===(r=null==p?void 0:p.Instrumentation)||void 0===r?void 0:r.TraceId,200==h.status?(i=function(e,t){try{return e.EntitySets[0].ResultSets[0].Results.map((function(t){var n;return function(e,t){var n,r,i,a;try{var o="Exchange"===e.ContentSource,c=null;if(o){if(!(c=null===(n=e.Source.LastShared)||void 0===n?void 0:n.AttachmentId)){var u=Object(O.parse)(e.Source.Url,!0);c=Object(I.b)(null===(r=null==u?void 0:u.query)||void 0===r?void 0:r.AttachmentId)}if(!c)return null}return{DateAccessed:e.Source.LastAccessDateTime||(null===(i=e.Source.UserRelationship)||void 0===i?void 0:i.LastAccessDateTime),DateModified:e.Source.LastModifiedDateTime,Endpoint:"Implicit"===(null===(a=e.SubstrateSearchExtendedProperties)||void 0===a?void 0:a.RelevanceRelationship)?o?j.a.MRUClassicContextual:j.a.MRUContextual:o?j.a.MRUClassic:j.a.MRUCloudy,FileExtension:e.Source.FileExtension,FileName:e.Source.FileName,FileSize:e.Source.FileSize,FileSourceType:e.ContentSource||e.Provenance,Id:o?c:e.Id,ReferenceId:e.ReferenceId,SourceTitle:e.Source.SiteTitle||e.Source.LastShared.SharingSubject,Url:e.Source.Url,TraceId:t}}catch(n){return v.g.info("[convertMRUAttachmentToReplyWithAttachmentSuggestion] Error accessing MRUAttachment properties: "+n.message),Object(x.s)("convertMRUAttachmentToReplyWithAttachmentSuggestionError",{id:null==e?void 0:e.Id,traceId:t,error:n.message},{isCore:!0}),null}}(t,null===(n=null==e?void 0:e.Instrumentation)||void 0===n?void 0:n.TraceId)})).filter((function(e){return!!e}))}catch(e){return v.g.info("[fetchMRUSuggestions_getAttachmentsFromResponse] Error: "+e.message),t.addCustomData({fetchMRUSuggestions_getAttachmentsFromResponseError:e.message}),[]}}(p,c),a=i.length):o=h.status+"-"+h.statusText,u&&y.k.importAndExecute(C.b.SuggestedAttachments,u,s,h.status),b.label=6;case 6:return[3,9];case 7:return g=b.sent(),o=g.message,[3,9];case 8:return o&&v.g.info("getMRUSuggestions: Error "+o),c.addCustomData({numResults:a,traceId:u,fetchTimeSpent:s}),o?c.endWithError("ServerError",new Error(o)):c.end(),[2,{suggestions:i,traceId:u}];case 9:return[2]}}))}))}function k(){return Object(b.c)(this,void 0,void 0,(function(){var e,t,n;return Object(b.f)(this,(function(r){switch(r.label){case 0:return e=Object(b.g)(Object(A.getAccessTokenforResourceAsLazy)(window.location.origin),2),t=e[0],n=e[1],t?[3,2]:[4,n];case 1:t=r.sent(),r.label=2;case 2:return[2,t]}}))}))}Object(r.orchestrator)(f,(function(e){return Object(b.c)(void 0,void 0,void 0,(function(){var t;return Object(b.f)(this,(function(n){switch(n.label){case 0:return[4,P(e.referenceItemId,e.isPrefetch,e.message)];case 1:return t=n.sent(),m(e.referenceItemId,t.suggestions,t.traceId),[2]}}))}))})),Object(r.orchestrator)(h,(function(e){return Object(b.c)(void 0,void 0,void 0,(function(){var t;return Object(b.f)(this,(function(n){switch(n.label){case 0:return[4,P(null,e.isPrefetch,e.message)];case 1:return t=n.sent(),p(t.suggestions,t.traceId),[2]}}))}))}));var D=n(2065),M=n(2118);function _(e,t){return Object(b.c)(this,void 0,void 0,(function(){var n;return Object(b.f)(this,(function(r){switch(r.label){case 0:return n=null,Object(M.j)()!==M.c.NotLoaded?[3,2]:[4,M.l.import()];case 1:return r.sent()((function(r){n=F(Object(M.h)(),e),t(n)})),[3,3];case 2:n=F(Object(M.h)(),e),t(n),r.label=3;case 3:return[2]}}))}))}function F(e,t){var n=function(e){for(var t=0;t<e.length;t++)if(0==e[t].type)return e[t].model.Id;return v.g.warn("createCloudFileFromAttachmentData: Could not get OneDrive Pro provider ID. Attachment will not upload."),""}(e);return{fileType:t.Endpoint===j.a.MRUContextual?D.a.ContextualSuggestion:D.a.CloudSuggestion,name:t.FileName,size:null,providerId:n,providerType:0,location:t.Url,providerEndpointUrl:null,isFolder:!1,fileId:t.Id,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:null}}var U=n(20),N=n(143),L=n(441),B=n(94),z=n(5),V=n(2601),q=n(203),W=n(6),J=n(730),K=n(2004),G=n(0);var H=n(15607),X=n(19);function Q(e){var t=[],n=[],r=[],i=[],a=[];return e&&e.forEach((function(e,o){t.push(e.Endpoint),n.push(e.Id),r.push(o),i.push(e.FileSourceType),a.push(e.FileExtension)})),[t.join(","),n.join(","),r.join(","),i.join(","),a.join(",")]}function Y(e){var t;return((null==e?void 0:e.Id)?null===(t=u().contextualAttachmentSuggestions.get(null==e?void 0:e.Id))||void 0===t?void 0:t.traceId:u().traceId)||null}function $(e,t,n){var r=[];e.forEach((function(e,t){r.push({type:"Entity",name:"Files",referenceId:null==e?void 0:e.ReferenceId,providerId:null==e?void 0:e.TraceId,position:t+1,entityType:"File",placementType:"Visible"})}));var i=Object(X.a)().SessionSettings;y.e.importAndExecute(C.b.SuggestedAttachments,i.UserPuid,i.ExternalDirectoryTenantGuid,n,t,"Vertical",r)}function Z(e){var t,n,r=u().referenceItemIdAndComposeIdMap;try{for(var i=Object(b.k)(r.keys()),a=i.next();!a.done;a=i.next()){var o=a.value;if(r.get(o).some((function(t){return t===e})))return Y(o===d?null:{Id:o})}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return null}var ee="...",te=35,ne=50,re=" > ",ie=" < ",ae=n(15608);function oe(e){var t=Object(q.a)(),n=null,r=0,i=function(e,t,n,r){var i=function(e){var t;return((null==e?void 0:e.Id)?null===(t=u().contextualAttachmentSuggestions.get(null==e?void 0:e.Id))||void 0===t?void 0:t.attachments:u().attachments)||[]}(t);return e&&(null==i?void 0:i.length)?function(e){var t=[],n=Object(g.i)("doc-attachment-suggestedAttsFive")?l:s;if(e)for(var r=0;r<e.length&&t.length<n;r++){var i=e[r];i?t.push(i):v.g.info("[extractAttachmentSuggestions] mru suggestion is null")}return t}(i=i.filter((function(e){return function(e,t,n){if(!e)return!1;switch(e.Endpoint){case j.a.Contextual:case j.a.MRUCloudy:case j.a.MRUContextual:return Object(K.a)().ReferenceAttachmentsEnabled&&t;case j.a.MRUClassic:case j.a.MRUClassicContextual:return Object(K.a)().ClassicAttachmentsEnabled&&n;default:return Object(B.a)(e.Endpoint)}}(e,n,r)}))):[]};return{getContextualMenuItems:function(e,a,o,c,u,s){var l=i(e,a,o,c);return n&&function(e,t,n,r,i,a){var o=Y(a);n&&o!==n&&(y.m.importAndExecute(C.b.SuggestedAttachments,t,o,(new Date).getTime()-i),$(e,o,t),r())}(l,t,n,(function(){n=null}),r,a),function(e,t,n){if(e.length>0){var r=0,i=e.map((function(e){return function(e,t,n){return{key:"suggestion"+t,className:ae.attachmentSuggestionButtonRoot,onRender:function(r,i){var a={suggestion:e,keyIndex:t,dismissMenu:i,onAttachmentClicked:n};return G.createElement(ue,Object(b.a)({},a))}}}(e,r++,t)}));return[ce(n)].concat(i)}return[]}(l,s,u)},onMenuOpened:function(e,o,c,u,s,l,d){r=(new Date).getTime(),e&&a(o,c,!1,d);var f=i(e,null==o?void 0:o.ItemId,s,l),h=t,m=Object(q.a)();t=h,function(e,t,n,r,i,a){var o=Q(e),c=Y(t);if(Object(x.s)("AttachButtonMenuOpened",Object(b.j)(Object(b.j)([],Object(b.g)(o)),[n,!0,c]),{isCore:!0,excludeFromKusto:!0}),c){var u=Object(X.a)().SessionSettings;y.c.importAndExecute(C.b.SuggestedAttachments,u.UserPuid,u.ExternalDirectoryTenantGuid,r,i,Object(q.a)(),c),$(e,c,i)}}(f,null==o?void 0:o.ItemId,u,h,m),n=Y(null==o?void 0:o.ItemId)},onMenuDismissed:function(e,t,r,a){!function(e,t,n){var r=Q(e),i=Y(n);Object(x.s)("AttachButtonMenuClosed",Object(b.j)(Object(b.j)([!0],Object(b.g)(r)),[i]),{isCore:!0,excludeFromKusto:!0})}(i(e,t,r,a),0,t),n=null}}}function ce(e){return{key:"replyWithHeader",name:e?Object(W.b)(H.d):Object(W.b)(H.c),itemType:N.a.Header,iconProps:{iconName:null,styles:{root:{margin:"0px",width:"0px"}}},className:ae.replyWithHeaderForBottomBar}}var ue=Object(U.a)((function(e){var t=e.suggestion,n=e.keyIndex,r=e.dismissMenu,i=e.onAttachmentClicked,a=G.useCallback((function(){i(t,n),r(),function(e){var t=Object(X.a)().SessionSettings;y.p.importAndExecute(C.b.SuggestedAttachments,t.UserPuid,t.ExternalDirectoryTenantGuid,Object(q.a)(),e.TraceId,e.ReferenceId,"EntityClicked",null,e.TraceId)}(t)}),[t]);return G.createElement("button",{className:ae.attachmentSuggestionButton,title:he(t),name:t.FileName,"aria-label":Object(W.b)(H.c)+"  "+t.FileName,"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:a,tabIndex:0},G.createElement("div",{className:ae.attachmentSuggestionButtonContent},G.createElement("div",{className:ae.attachmentSuggestionButtonImageContainer,role:"presentation","aria-hidden":"true"},function(e){var t=e.FileName+pe(e);if(e.Endpoint===j.a.MRUClassic||e.Endpoint===j.a.MRUClassicContextual){var n=Object(V.d)(t,null,!1,!1,null).medium;return G.createElement("div",{className:n})}return G.createElement(V.a,{fileName:t,contentType:null,isBlocked:!1,isFolder:!1,embeddedItemClass:null,cloudyIconStyle:ae.cloudyIcon,fileIconStyle:ae.fileIcon})}(t)),G.createElement("div",null,G.createElement("div",{className:ae.attachmentSuggestionButtonTextContainer},G.createElement("div",{className:ae.attachmentSuggestionPrimaryText},me(function(e){var t="."+e.FileExtension;return e.FileName.indexOf(t)>=0?e.FileName.replace(t,""):e.FileName}(t)+pe(t),te))),G.createElement("div",{className:ae.attachmentSuggestionSecondaryText},function(e){return e.Endpoint===j.a.MRUClassic||e.Endpoint===j.a.MRUClassicContextual?de(e):se(e)}(t)))))}));function se(e){if(e.Endpoint===j.a.MRUClassic||e.Endpoint===j.a.MRUClassicContextual)return null;var t=e.DateAccessed;if(!t)return Object(x.s)("AttachmentSuggestionNoAccessDate",void 0,{cosmosOnlyData:JSON.stringify({suggestionId:e.Id}),excludeFromKusto:!0}),null;var n=Object(z.Sb)("UTC",t),r=Object(z.N)(n,Object(J.i)());return Object(W.c)(Object(W.b)(H.a),r)}function le(e){var t=e.DateModified;if(!t)return Object(x.s)("AttachmentSuggestionNoModifiedDate",void 0,{cosmosOnlyData:JSON.stringify({suggestionId:e.Id}),excludeFromKusto:!0}),null;var n=Object(z.Sb)("UTC",t),r=Object(z.Z)(n);return Object(W.c)(Object(W.b)(H.b),r)}function de(e,t){void 0===t&&(t=!1);var n=null;try{if(e.Endpoint===j.a.MRUClassic||e.Endpoint===j.a.MRUClassicContextual)n=e.SourceTitle;else{var r=function(e){try{if(e.Endpoint===j.a.MRUClassic||e.Endpoint===j.a.MRUClassicContextual)return null;var t=document.createElement("a");t.href=e.Url;var n=decodeURIComponent(t.hostname),r=Object(b.g)(decodeURIComponent(t.pathname).split("/")).slice(1);return r.pop(),Object(b.j)([n],Object(b.g)(r))}catch(e){return v.g.info("[breadcrumbedFileOrEmailPath] Failed to parse attachment data, message: "+e.message),[]}}(e);n=t?me(fe(r),ne):fe(r)}}catch(e){v.g.info("[breadcrumbedFileOrEmailPath] Failed to parse attachment data, message: "+e.message)}finally{return n}}function fe(e){return Object(L.a)()?e.reverse().join(ie):e.join(re)}function he(e){var t=null;try{t=[e.FileName,de(e),se(e),le(e)].filter((function(e){return e})).join("\n")}catch(e){v.g.info("[getTooltipForAttachmentSuggestion] Failed to parse attachment data, message: "+e.message)}finally{return t}}function me(e,t){if(e.length<=t)return e;var n=t-ee.length,r=Math.ceil(n/2),i=Math.floor(n/2);return e.substr(0,r)+ee+e.substr(e.length-i)}function pe(e){return"."+e.FileExtension}var ge=n(3262),be=n(3691);function ve(e,t){return Object(b.c)(this,void 0,void 0,(function(){var n,r,i,a,o,c;return Object(b.f)(this,(function(u){switch(u.label){case 0:n=Object(X.a)().SessionSettings,r=[],i=[],a=0,u.label=1;case 1:return a<e.length?(o=e[a],r.push(o.fileType),c=null,o.fileType!==D.a.Cloud&&o.fileType!==D.a.CloudSuggestion&&o.fileType!==D.a.ContextualSuggestion||0!==o.providerType?[3,3]:[4,Oe(o.providerType,o.location)]):[3,5];case 2:c=u.sent(),u.label=3;case 3:i.push(c),u.label=4;case 4:return a++,[3,1];case 5:return y.f.importAndExecute(C.b.SuggestedAttachments,n.UserPuid,n.ExternalDirectoryTenantGuid,Y(t),JSON.stringify(r),JSON.stringify(i)),[2]}}))}))}function Oe(e,t){return Object(b.c)(this,void 0,void 0,(function(){var n,r,i,a,o,c,u,s;return Object(b.f)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),n=btoa(t),r="u!"+n.replace(/^\=+|\=+$/g,"").replace("/","_").replace("+","-"),i=new RegExp(/.+?\:\/\/.+?(\/)/g).exec(t)[0],a=i+"_api/v2.0/shares/"+r+"/?expand=sharepointIds",o=Object(ge.a)({ProviderType:e,Url:a}),[4,Object(be.a)(o)];case 1:return 200===(c=l.sent()).Status&&c.Body&&(null==(u=JSON.parse(c.Body))?void 0:u.sharepointIds)?[2,{ListId:u.sharepointIds.listId,UniqueId:u.sharepointIds.listItemUniqueId,SiteId:u.sharepointIds.siteId,WebId:u.sharepointIds.webId}]:[3,3];case 2:return s=l.sent(),v.g.warn("Something went wrong while calling fetchDataProviderResourceOperation: "+s),[3,3];case 3:return[2,null]}}))}))}n.d(t,"clearCachedAttachmentSuggestions",(function(){return i})),n.d(t,"getAttachmentSuggestionsAction",(function(){return a})),n.d(t,"createCloudFileFromAttachmentData",(function(){return _})),n.d(t,"getAttachmentSuggestionsMenuItems",(function(){return oe})),n.d(t,"getAttachmentSuggestionsTraceId",(function(){return Y})),n.d(t,"getAttachmentSuggestionsTraceIdByComposeId",(function(){return Z})),n.d(t,"logEntitiesFromFilePicker",(function(){return ve}))}}]);
//# sourceMappingURL=owa.MailBoot~AttachmentSuggestions.js.map
self.scriptsLoaded['owa.MailBoot~AttachmentSuggestions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AttachmentSuggestions.js'] = (new Date()).getTime();