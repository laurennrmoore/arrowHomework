self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Attachments~ConversationAttachment~SxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[170],{10023:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"g",(function(){return s}));var a=n(31),r=n(10024);n.d(t,"f",(function(){return r.a}));var i=n(5233);n.d(t,"e",(function(){return i.a}));var o=n(10376);n.d(t,"a",(function(){return o.a}));var c=n(4943);n.d(t,"c",(function(){return c.a})),n.d(t,"d",(function(){return c.e}));var u=new a.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(15),n.e(17),n.e(16),n.e(21),n.e(22),n.e(29),n.e(34),n.e(37),n.e(41),n.e(42),n.e(52),n.e(57),n.e(72),n.e(77),n.e(78),n.e(82),n.e(111),n.e(143),n.e(170),n.e(353)]).then(n.bind(null,17836))})),d=Object(a.d)(u,(function(e){return e.AttachmentView})),s=new a.b(u,(function(e){return e.getContextMenus}))},10024:function(e,t,n){"use strict";t.a={OnClick:{name:"AttachmentOnClick",customData:function(e){return[e]}}}},10025:function(e){e.exports=JSON.parse('{"a":"hwb"}')},10026:function(e){e.exports=JSON.parse('{"a":"ibb"}')},10027:function(e,t,n){"use strict";var a=n(1956);t.a=function(e){var t,n,r=e&&Object(a.v)(e);return null===(n=null===(t=(null==r?void 0:r.From)||(null==r?void 0:r.Sender))||void 0===t?void 0:t.Mailbox)||void 0===n?void 0:n.EmailAddress}},10109:function(e){e.exports=JSON.parse('{"a":"kwb"}')},10110:function(e){e.exports=JSON.parse('{"a":"Jwb"}')},10376:function(e,t,n){"use strict";var a=n(20),r=n(1260),i=n(66),o=n(2087),c=n(23),u=n(0),d=n(5233),s=n(7590),l=n(94),f=n(6),m=n(10025),b=n(10026),h=n(16380),v=n(8327);var p=n(8328),O=n(1),w=n(121),g=n(2217),S=n(11812),j=n(11813),I=n(1996),A=n(3822),C=n(3880),x=n(203),T=n(5186),y=n(706),W=n(41),P="/"+Object(O.j)(["mail"],Object(O.g)(Object(y.a)().split("/").slice(1))).join("/")+"deeplink/saveAndEdit/";var D=n(10027);function R(e,t,n,a){var r,i,u,s=Object(o.k)(a);switch(e){case d.a.addToCalendar:Object(j.a)(t,S.a.SurfaceAction);break;case d.a.download:!function(e,t){var n,a;Object(O.c)(this,void 0,void 0,(function(){var r,i,o,u,d,s,l,f;return Object(O.f)(this,(function(m){switch(m.label){case 0:return(r=Object(I.a)(e.attachmentId))?[4,Object(C.b)(e.attachmentId,e.isCloudy,document.body)]:(c.d("AttachmentSurfaceActionButton.downloadAttachment attachmentModel is null"),[2]);case 1:return m.sent(),i=Object(A.a)(r),Object(w.s)("AttachmentDownload",{entryPoint:"SurfaceAction",isCloudy:e.isCloudy,isCompose:!e.isReadOnly},{cosmosOnlyData:JSON.stringify({size:r.model.Size,fileType:i,attachmentId:null===(n=r.model.AttachmentId)||void 0===n?void 0:n.Id})}),o=null==t?void 0:t.Id,d=(u=w.p).importAndExecute,s=["SavedAttachment"],f={},(l=o)?[4,Object(T.a)(o)]:[3,3];case 2:l=m.sent(),m.label=3;case 3:return d.apply(u,s.concat([(f.itemId=l,f.customProperties={FileId:null===(a=r.model.AttachmentId)||void 0===a?void 0:a.Id,FileType:i,Destination:"Local",Sender:Object(D.a)(o)},f)])),[2]}}))}))}(t,n);break;case d.a.saveToCloud:!function(e,t,n){var a,r=Object(I.a)(e.attachmentId);if(!r)return void c.d("AttachmentSurfaceActionButton.saveToCloud attachmentModel is null");Object(w.s)("AttachmentSaveToCloud",{entryPoint:"SurfaceAction"},{cosmosOnlyData:JSON.stringify({size:r.model.Size,fileType:Object(A.a)(r),attachmentId:null===(a=r.model.AttachmentId)||void 0===a?void 0:a.Id}),isCore:!0}),Object(g.B)(Object(g.p)(e.attachmentId),.1,(function(t){Object(g.x)(e,t)}),e.attachmentId),Object(g.u)(e,(function(t){Object(g.C)(e.attachmentId,t)}),"SurfaceAction",t,Object(D.a)(null==t?void 0:t.Id),n)}(t,n,s);break;case d.a.editAndReply:!function(e,t,n){Object(O.c)(this,void 0,void 0,(function(){var n,a;return Object(O.f)(this,(function(r){switch(r.label){case 0:return[4,C.d.import()];case 1:return n=r.sent(),Object(w.s)("WovenEditAndReplyFromSurface",{},{isCore:!0}),a={viewState:e,attachmentSelectionSource:o.b.ReadingPane,parentItemId:t,isDraft:!1,isEdit:!0,onBeforePreview:function(){return null},createImageGallery:function(){return null},instrumentationContext:null,targetWindow:window},n(a),[2]}}))}))}(t,n);break;case d.a.openNewTabAndSaveToCloud:!function(e,t,n){var a=Object(x.a)();!function(e,t,n){var a=""+P;a+=encodeURIComponent(null==n?void 0:n.Id)+"/"+encodeURIComponent(e)+"/"+encodeURIComponent(t)+"/"+Object(W.a)().search,window.open(a,"_blank")}(e.attachmentId.Id,a,t);var r=new w.b("WovenNewTabSaveToCloud",{isCore:!0});Object(g.B)(4*Object(g.p)(e.attachmentId),.1,(function(t){Object(g.x)(e,t)}),e.attachmentId),Object(g.D)(e,(function(t){Object(g.C)(e.attachmentId,t),t?r.end():r.endWithError("ServerError")}),"PencilExperiment",t,a,Object(D.a)(null==t?void 0:t.Id),n)}(t,n,s);break;case d.a.openAndEdit:r=t,i=Object(I.a)(r.attachmentId).model.AttachmentOriginalUrl,u=-1===i.indexOf("?")?"?":"&",window.open(i+u+"web=1","_blank"),Object(w.s)("WovenOpenAndEditFromSurface",{},{isCore:!0});break;default:Object(l.a)(e)}}var _=n(2444),E=n(16381),N=n(378).bind(E);t.a=Object(a.a)((function(e){var t=u.useContext(_.a),n=e.action,a=e.attachmentViewState,O=e.customClassName,w=e.isForImageView,g=e.previewState;if(Object(p.a)(n,a))return null;var S=void 0,j=function(e){switch(e){case o.a.Edit:return E.edit;case o.a.NotSelectedAndSaving:return E.notSelectedAndSaving;case o.a.OtherSaving:return E.attachmentView;case o.a.Selected:return E.selected;case o.a.SelectedAndPending:return E.selectedAndPending;case o.a.SelectedAndSaving:return E.selectedAndSaving;default:return E.default}}(g);if(w){var I={extraRightPadding:z(n,a)};S=N([E.actionButton,E.actionButtonForImageView,O,I])}else S=a.isReadOnly?N([E.actionButton,j,O]):N([E.actionButton,j,E.actionButtonForDocViewInCompose,O]);var A=function(e,t){switch(e){case d.a.addToCalendar:return"AddEvent";case d.a.download:return"Download";case d.a.saveToCloud:return"CloudUpload";case d.a.openNewTabAndSaveToCloud:return"Edit";case d.a.editAndReply:return"PencilReply";case d.a.openAndEdit:return Object(v.a)(t)?"CloudEdit":"Cloud";default:return Object(l.a)(e)}}(n,a.attachmentId),C=function(e,t){switch(e){case d.a.addToCalendar:return Object(f.b)(m.a);case d.a.download:return Object(f.b)(b.a);case d.a.saveToCloud:return Object(f.b)(h.d);case d.a.openNewTabAndSaveToCloud:return Object(f.b)(h.c);case d.a.editAndReply:return Object(f.b)(h.a);case d.a.openAndEdit:return Object(v.a)(t)?Object(f.b)(h.b):Object(f.b)(h.e);default:return Object(l.a)(e)}}(n,a.attachmentId);return u.createElement(r.a,{onFocus:function(){return Object(s.b)(e.attachmentViewState,e.isForImageView)},onBlur:function(){e.shouldNotHandleOnBlur||Object(s.a)(e.attachmentViewState,e.isForImageView)},onKeyDown:function(n){n.keyCode!==i.a.enter&&n.keyCode!==i.a.space||(c.g.info("AttachmentSurfaceActionButton.keyDown enter|space"),n.stopPropagation(),R(e.action,e.attachmentViewState,e.parentItemId,t))},ariaLabel:C,title:C,onClick:function(n){c.g.info("AttachmentSurfaceActionButton.onclick"),n.stopPropagation(),R(e.action,e.attachmentViewState,e.parentItemId,t)},className:S,iconProps:{iconName:A,styles:{root:E.icon}}})}));function z(e,t){return(e===d.a.saveToCloud||e===d.a.editAndReply||e===d.a.openNewTabAndSaveToCloud||e===d.a.openAndEdit)&&!Object(p.a)(d.a.download,t)}},11810:function(e,t,n){"use strict";var a=n(183);t.a=Object(a.action)("setShouldShowActionsContainer")((function(e,t){e.shouldShowActionsContainer=t}))},11811:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2070),r=n(1996);function i(e){var t=Object(r.a)(e.attachmentId);return!!t&&(!!Object(a.d)(t.model)||t.download.url&&t.info&&t.info.allowDownload)}},11812:function(e,t,n){"use strict";t.a={SurfaceAction:"Surface action",ContextMenu:"Context menu"}},11813:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var a=n(10025),r=n(6),i=n(121),o=n(2217),c=n(8163),u=n(2997),d=n(11812),s=n(1996),l=n(3822),f=n(3680);function m(e,t){var n=Object(s.a)(e.attachmentId),a=Object(l.a)(n);Object(i.s)("AddToCalendar",[t],{cosmosOnlyData:JSON.stringify({size:n.model.Size,fileType:a})}),n.model.Size>10485760||!e.attachmentId||!e.attachmentId.Id?Object(u.a)(e,0,15):(Object(o.B)(Object(o.j)(n.model.Size),.1,(function(t){Object(o.x)(e,t)}),e.attachmentId),Object(c.a)(e,0))}function b(e){var t=Object(s.a)(e.attachmentId);return Object(f.a)(o.a.ImportCalendarEventAttachment,e)&&t&&13===t.attachmentClass?{name:Object(r.b)(a.a),key:"AddToCalendar",onClick:function(){m(e,d.a.ContextMenu)}}:null}},16380:function(e){e.exports=JSON.parse('{"a":"Nwb","c":"Owb","d":"Pwb","b":"Qwb","e":"Rwb"}')},16381:function(e,t,n){var a=n(16382),r=n(78);"string"==typeof a&&(a=[[e.i,a]]);for(var i=0;i<a.length;i++)r.loadStyles(a[i][1],!1);a.locals&&(e.exports=a.locals)},16382:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._2KRgryadS8K-_TLdBoNKmd{font-size:14px;color:"[theme:neutralSecondary, default:#605e5c]";height:25px;width:28px}html[dir] ._2KRgryadS8K-_TLdBoNKmd{padding:4px;text-align:center}._2KRgryadS8K-_TLdBoNKmd:focus,._2KRgryadS8K-_TLdBoNKmd:hover,._1eq1P1PoHUzBriyfNWVd1T{color:"[theme:neutralSecondary, default:#605e5c]"}._1eq1P1PoHUzBriyfNWVd1T{display:block}.HDG8P1QaVRBOeSU0W5zmW{bottom:0;position:absolute;color:"[theme:white, default:#ffffff]"}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW{right:28px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW{left:28px}.HDG8P1QaVRBOeSU0W5zmW:focus,.HDG8P1QaVRBOeSU0W5zmW:hover{color:"[theme:white, default:#ffffff]"}html[dir] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir] .HDG8P1QaVRBOeSU0W5zmW:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW:hover{border-bottom-right-radius:2px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW:focus,html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW:hover{border-bottom-left-radius:2px}html[dir=ltr] .HDG8P1QaVRBOeSU0W5zmW._2RdXhaKvBvt2MX9AyW7pcR{right:56px}html[dir=rtl] .HDG8P1QaVRBOeSU0W5zmW._2RdXhaKvBvt2MX9AyW7pcR{left:56px}._2ebptdF8eCnt_2-FT7dzaH{font-size:14px}html[dir] ._2ebptdF8eCnt_2-FT7dzaH{margin:0}html[dir] .IPPU7NtLHAzlPwHTIXmXp:focus,html[dir] .IPPU7NtLHAzlPwHTIXmXp:hover{background:"[theme:neutralTertiaryAlt, default:#c8c6c4]"}html[dir] .rPIl3tr-13EegQ4JcXUy_,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq,html[dir] ._17q1sDoo-1SD8o99_vx_Wl,html[dir] ._1H8nRWpPKM9iogJAm6ze6p,html[dir] ._3bO0ii_CywH_7ysZAUsxkB,html[dir] ._1E-xlZkNQ0oWd42XQohXqv{margin:0;background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] .rPIl3tr-13EegQ4JcXUy_:focus,html[dir] .rPIl3tr-13EegQ4JcXUy_:hover,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq:focus,html[dir] ._3vsJWDG9Ae71RWCd-gnOXq:hover,html[dir] ._17q1sDoo-1SD8o99_vx_Wl:focus,html[dir] ._17q1sDoo-1SD8o99_vx_Wl:hover,html[dir] ._1H8nRWpPKM9iogJAm6ze6p:focus,html[dir] ._1H8nRWpPKM9iogJAm6ze6p:hover,html[dir] ._3bO0ii_CywH_7ysZAUsxkB:focus,html[dir] ._3bO0ii_CywH_7ysZAUsxkB:hover,html[dir] ._1E-xlZkNQ0oWd42XQohXqv:focus,html[dir] ._1E-xlZkNQ0oWd42XQohXqv:hover{background:"[theme:themeTertiary, default:#71AFE5]"}html[dir] .rPIl3tr-13EegQ4JcXUy_{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}',""]),t.locals={actionButton:"_2KRgryadS8K-_TLdBoNKmd",actionButtonForDocViewInCompose:"_1eq1P1PoHUzBriyfNWVd1T",actionButtonForImageView:"HDG8P1QaVRBOeSU0W5zmW",extraRightPadding:"_2RdXhaKvBvt2MX9AyW7pcR",icon:"_2ebptdF8eCnt_2-FT7dzaH",default:"IPPU7NtLHAzlPwHTIXmXp",edit:"rPIl3tr-13EegQ4JcXUy_",notSelectedAndSaving:"_3vsJWDG9Ae71RWCd-gnOXq",selected:"_17q1sDoo-1SD8o99_vx_Wl",selectedAndPending:"_1H8nRWpPKM9iogJAm6ze6p",selectedAndSaving:"_3bO0ii_CywH_7ysZAUsxkB",thematic:"_1E-xlZkNQ0oWd42XQohXqv"}},1996:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2143);function r(e){return Object(a.a)().attachments.get(e.Id)}},2161:function(e,t,n){"use strict";var a;function r(){return[a.noPermissionToShare,a.getSharingInfoFailed,a.linkHasExpired,a.linkWillExpire,a.noPermissionToShareExternally,a.externalRecipientCSL,a.noPermissionSet,a.sharingWithLargeDL]}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(a||(a={}))},2179:function(e,t){e.exports=function(e){return e instanceof Date}},2243:function(e,t,n){var a=n(2179),r=36e5,i=6e4,o=2,c=/[T ]/,u=/:/,d=/^(\d{2})$/,s=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],m=/^-(\d{2})$/,b=/^-?(\d{3})$/,h=/^-?(\d{2})-?(\d{2})$/,v=/^-?W(\d{2})$/,p=/^-?W(\d{2})-?(\d{1})$/,O=/^(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,j=/^(Z)$/,I=/^([+-])(\d{2})$/,A=/^([+-])(\d{2}):?(\d{2})$/;function C(e,t,n){t=t||0,n=n||0;var a=new Date(0);a.setUTCFullYear(e,0,4);var r=7*t+n+1-(a.getUTCDay()||7);return a.setUTCDate(a.getUTCDate()+r),a}e.exports=function(e,t){if(a(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var x=function(e){var t,n={},a=e.split(c);u.test(a[0])?(n.date=null,t=a[0]):(n.date=a[0],t=a[1]);if(t){var r=S.exec(t);r?(n.time=t.replace(r[1],""),n.timezone=r[1]):n.time=t}return n}(e),T=function(e,t){var n,a=s[t],r=f[t];if(n=l.exec(e)||r.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=d.exec(e)||a.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(x.date,n),y=T.year,W=function(e,t){if(null===t)return null;var n,a,r,i;if(0===e.length)return(a=new Date(0)).setUTCFullYear(t),a;if(n=m.exec(e))return a=new Date(0),r=parseInt(n[1],10)-1,a.setUTCFullYear(t,r),a;if(n=b.exec(e)){a=new Date(0);var o=parseInt(n[1],10);return a.setUTCFullYear(t,0,o),a}if(n=h.exec(e)){a=new Date(0),r=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return a.setUTCFullYear(t,r,c),a}if(n=v.exec(e))return i=parseInt(n[1],10)-1,C(t,i);if(n=p.exec(e)){i=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return C(t,i,u)}return null}(T.restDateString,y);if(W){var P,D=W.getTime(),R=0;return x.time&&(R=function(e){var t,n,a;if(t=O.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*r;if(t=w.exec(e))return n=parseInt(t[1],10),a=parseFloat(t[2].replace(",",".")),n%24*r+a*i;if(t=g.exec(e)){n=parseInt(t[1],10),a=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*r+a*i+1e3*o}return null}(x.time)),x.timezone?P=function(e){var t,n;if(t=j.exec(e))return 0;if(t=I.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=A.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(x.timezone):(P=new Date(D+R).getTimezoneOffset(),P=new Date(D+R+P*i).getTimezoneOffset()),new Date(D+R+P*i)}return new Date(e)}},2309:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(a||(a={}))},2330:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),r=Object(a.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},2331:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(a||(a={}))},2359:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n(2212);function r(e){return o(e.type)}function i(e){return o(Object(a.a)(e))}function o(e){return 1===e||3===e}},2399:function(e,t,n){"use strict";n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"l",(function(){return p}));var a=n(31),r=n(2330);n.d(t,"n",(function(){return r.a}));var i=n(2309);n.d(t,"a",(function(){return i.a}));var o=n(2161);n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return o.a}));var c=n(2331);n.d(t,"b",(function(){return c.a}));var u=new a.c((function(){return Promise.all([n.e(4),n.e(42),n.e(81),n.e(819)]).then(n.bind(null,3601))})),d=new a.b(u,(function(e){return e.getSharingInformation})),s=new a.b(u,(function(e){return e.getSharingIssuesForSharingData})),l=new a.b(u,(function(e){return e.getInfoBarCreator})),f=new a.b(u,(function(e){return e.hasLargeDLRecipient})),m=new a.b(u,(function(e){return e.hasRecipientExpansionFailure})),b=new a.b(u,(function(e){return e.getGroupsAndSmallDLs})),h=new a.b(u,(function(e){return e.getInvididualRecipients})),v=new a.b(u,(function(e){return e.hasGetRecipientPermissionFailed})),p=new a.b(u,(function(e){return e.logSharingTipChangesForLinkRemoval}))},2966:function(e,t,n){"use strict";function a(e,t){(t||window).open(e,"_blank")}n.d(t,"a",(function(){return a}))},3083:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2966),r=n(121),i=n(102),o=function(e){e.stopPropagation()};function c(e,t,n,c){var u;if(Object(r.s)("downloadFileFromUrl",{isBrowserIE:Object(i.g)(),urlLength:e.length}),t||Object(i.g)())Object(a.a)(e);else{var d=document.createElement("a");d.style.display="none",d.href=e,d.download=c||"",n||(n=(null===(u=document.activeElement)||void 0===u?void 0:u.parentElement)||document.body),n.appendChild(d),d.addEventListener("click",o),d.click(),d.removeEventListener("click",o),n.removeChild(d)}}},3680:function(e,t,n){"use strict";function a(e,t){return-1!==t.strategy.supportedMenuActions.indexOf(e)}n.d(t,"a",(function(){return a}))},3880:function(e,t,n){"use strict";var a=n(31),r=n(2099),i=n(1),o=n(2070),c=n(1996),u=n(3083),d=n(210),s=n(2603),l=n(4699),f=n(24);function m(e,t,n){return Object(i.c)(this,void 0,void 0,(function(){var a,r;return Object(i.f)(this,(function(i){switch(i.label){case 0:return(a=Object(c.a)(e))?Object(d.a)("nativeHostAttachmentHijack")&&Object(f.i)("mon-rp-downloadAttachmentsOverHx")?[4,l.c.import()]:[3,3]:[2];case 1:return i.sent()(e)?[4,l.a.import()]:[3,3];case 2:return i.sent()(e.Id),[2];case 3:return Object(o.d)(a.model)?[4,s.e.import()]:[3,5];case 4:return i.sent()(a.model),[3,6];case 5:(r=a.download.url)&&Object(u.a)(r,t,n),i.label=6;case 6:return[2]}}))}))}n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return v})),n.d(t,"a",(function(){return r.c})),n.d(t,"b",(function(){return m}));var b=new a.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(15),n.e(17),n.e(16),n.e(21),n.e(22),n.e(29),n.e(34),n.e(37),n.e(41),n.e(42),n.e(52),n.e(57),n.e(72),n.e(77),n.e(78),n.e(82),n.e(111),n.e(143),n.e(170),n.e(353)]).then(n.bind(null,18530))})),h=new a.a(b,(function(e){return e.clickAttachment})).importAndExecute,v=new a.a(b,(function(e){return e.previewAttachment}))},4699:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var a=n(9),r=new a.d((function(){return Promise.all([n.e(9),n.e(11),n.e(12),n.e(545)]).then(n.bind(null,6814))})),i=new a.a(r,(function(e){return e.isHxAttachment})),o=new a.a(r,(function(e){return e.downloadAttachmentFromHx})),c=new a.a(r,(function(e){return e.getHxAttachmentUri}))},4943:function(e){e.exports=JSON.parse('{"f":"Svb","a":"Tvb","e":"Uvb","d":"Vvb","c":"Wvb","b":"Xvb","g":"Yvb"}')},5147:function(e){e.exports=JSON.parse('{"a":"zbb"}')},5209:function(e,t,n){"use strict";function a(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}n.d(t,"a",(function(){return a}))},5233:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.saveToCloud=0]="saveToCloud",e[e.download=1]="download",e[e.addToCalendar=2]="addToCalendar",e[e.editAndReply=3]="editAndReply",e[e.openNewTabAndSaveToCloud=4]="openNewTabAndSaveToCloud",e[e.openAndEdit=5]="openAndEdit"}(a||(a={}))},7590:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return l}));var a=n(11810),r=n(5634),i=n(5635),o={},c=null;function u(e,t){o[e.attachmentId.Id]&&(clearTimeout(o[e.attachmentId.Id]),o[e.attachmentId.Id]=null),c=e.attachmentId.Id,Object(a.a)(e,!0),t&&!Object(i.a)(e)&&Object(r.a)(e,!0)}function d(e,t){o[e.attachmentId.Id]&&clearTimeout(o[e.attachmentId.Id]),o[e.attachmentId.Id]=setTimeout((function(){Object(a.a)(e,!1),t&&!Object(i.a)(e)&&Object(r.a)(e,!1),e.attachmentId.Id===c&&(c=null),o[e.attachmentId.Id]=null}),40)}function s(e,t){Object(a.a)(e,!0),t&&!Object(i.a)(e)&&Object(r.a)(e,!0)}function l(e,t){e.attachmentId.Id!==c&&(Object(a.a)(e,!1),t&&!Object(i.a)(e)&&Object(r.a)(e,!1))}},7591:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(711),r=n(24);function i(){return Object(r.i)("woven-newTabExperiment")&&Object(a.d)()}},8327:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1996),r=n(1992),i=n(5209);function o(e){var t=Object(a.a)(e),n=Object(r.c)(t.model.Name||"");return""!==Object(i.a)(n)&&"Visio"!==Object(i.a)(n)}},8328:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(94),r=n(2217),i=n(11811),o=n(24),c=n(197),u=n(5233),d=n(3680),s=n(8327),l=n(7591);function f(e,t){if(0!==t.ongoingAction||!t.strategy.showActionsMenu)return!0;switch(e){case u.a.addToCalendar:return!1;case u.a.download:return!Object(d.a)(r.a.Download,t)||!Object(i.a)(t);case u.a.saveToCloud:case u.a.openNewTabAndSaveToCloud:return!t.isReadOnly||!function(e,t){var n,a=Object(c.a)()&&"GroupMailbox"===(null===(n=e.attachmentId.mailboxInfo)||void 0===n?void 0:n.type),i=!1;i=t===u.a.openNewTabAndSaveToCloud?Object(l.a)()&&Object(s.a)(e.attachmentId):Object(o.i)("woven-saveToCloud2-viewInOneDrive")||Object(o.i)("woven-saveToCloud2-editInOneDrive")||Object(o.i)("woven-saveToCloud2-editInApp")||Object(o.i)("woven-saveToCloud2-editOnline")||Object(o.i)("woven-saveToCloud2-openFolder")||Object(o.i)("wvn-productizeSTCHoverActionOnly")||m()||Object(o.i)("wvn-productizeSTCHoverAndCloudWithTeaching")||Object(o.i)("wvn-productizeSTCChicletAndPreview")||Object(l.a)();return i&&Object(d.a)(r.a.SaveToCloud,e)&&Object(r.t)(e)&&!a}(t,e);case u.a.editAndReply:return!t.isReadOnly||!Object(s.a)(t.attachmentId);case u.a.openAndEdit:return!t.isReadOnly||!(m()||Object(o.i)("wvn-productizeSTCHoverAndCloudWithTeaching")||Object(o.i)("wvn-productizeSTCChicletAndPreview"))||2!==t.actionMessage&&3!==t.actionMessage;default:return Object(a.a)(e)}}function m(){var e=Object(o.i)("wvn-chicletEditOptions")||Object(o.i)("wvn-chicletEditOptionsNoDownload");return Object(o.i)("wvn-productizeSTCHoverAndCloud")&&!e}},869:function(e,t,n){"use strict";var a=n(31),r={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return r}));var i=new a.c((function(){return Promise.all([n.e(4),n.e(21),n.e(739)]).then(n.bind(null,18223))})),o=new a.a(i,(function(e){return e.subscribe})),c=new a.a(i,(function(e){return e.unsubscribe})),u=new a.b(i,(function(e){return e.getChannelId})),d=new a.a(i,(function(e){return e.getChannelReady})),s=new a.a(i,(function(e){return e.setup})),l=new a.a(i,(function(e){return e.handleNotification})),f=new a.a(i,(function(e){return e.initializeNotificationManager})),m=new a.b(i,(function(e){return e.getNotificationEmitter}))}}]);
//# sourceMappingURL=owa.MailBoot~Attachments~ConversationAttachment~SxS.js.map
self.scriptsLoaded['owa.MailBoot~Attachments~ConversationAttachment~SxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Attachments~ConversationAttachment~SxS.js'] = (new Date()).getTime();