self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~CalendarBootstrapUtils.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[563],{1303:function(t,n,e){"use strict";var r=e(448),i=e(303);n.a=function(t){return Object(i.a)(t)&&Object(r.a)(t)}},1352:function(t,n,e){"use strict";var r;function i(t){return r=null==t?void 0:t.getCalendarFolders,t}function c(){var t=r;return r=void 0,t}e.d(n,"b",(function(){return i})),e.d(n,"a",(function(){return c}))},2080:function(t,n,e){"use strict";function r(t,n){return!t.some((function(t){return t&&n&&t.calculatedFolderId===n.calculatedFolderId}))}function i(t,n){return t.indexOf(n)<0}function c(t,n){if(void 0===n&&(n=i),!t)return[];var e=[];return t&&t.forEach((function(t){n(e,t)&&e.push(t)})),e}var o=e(14);function u(t,n){if(void 0===n&&(n=i),!t)return t;var e=new o.ObservableMap;return t.forEach((function(t,r){e.set(r,c(t,n))})),e}function a(t,n){if(void 0===n&&(n=i),!t)return[];var e=[];return t.forEach((function(t){t&&t.forEach((function(t){n(e,t)&&e.push(t)}))})),e}e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return c})),e.d(n,"c",(function(){return u})),e.d(n,"d",(function(){return a}))},215:function(t,n,e){"use strict";var r=e(2),i=e(482),c=e(533),o={settings:i.a,overrides:Object(c.a)(),configIDs:void 0,lastError:void 0,initialized:!1,report:void 0,searchKey:void 0};n.a=Object(r.createStore)("applicationSettings",o)},2286:function(t,n,e){"use strict";var r=e(2),i=Object(r.action)("UPDATE_SELECTED_CALENDARS_IN_STORE",(function(t,n){return{calendarIds:t,userIdentity:n}})),c=Object(r.action)("ADD_SELECTED_CALENDAR_IN_STORE",(function(t,n){return{calendarId:t,userIdentity:n}})),o={selectedCalendars:new(e(14).ObservableMap)},u=Object(r.createStore)("selectedCalendarsStore",o),a=e(2080);Object(r.mutator)(i,(function(t){var n=t.calendarIds,e=t.userIdentity;u().selectedCalendars.set(e,Object(a.b)(n))}));var s=e(1);function d(){return Object(a.c)(u().selectedCalendars)}function f(){return Object(a.d)(d())}function l(t){var n=d().get(t);return n||[]}Object(r.mutator)(c,(function(t){var n=t.calendarId,e=t.userIdentity;u().selectedCalendars.set(e,Object(a.b)(Object(s.j)(Object(s.j)([],Object(s.g)(l(e))),[n])))}));var b=Object(r.action)("UPDATE_SELECTED_CALENDARS",(function(t,n){return{calendarIds:t,userIdentity:n}})),v=Object(r.action)("ADD_SELECTED_CALENDAR",(function(t,n){return{calendarId:t,userIdentity:n}})),O=(Object(r.action)("INITIALIZE_SELECTED_CALENDARS",(function(t,n){return{calendarIds:t,userIdentity:n}})),Object(r.action)("SELECTED_CALENDARS_UPDATED",(function(t,n){return{calendarIds:t,userIdentity:n}}))),j=e(209),g=e(23),E=e(57),p=e(419),h="OWA.ViewStateConfiguration";function y(t,n){t&&E.w.importAndExecute([{key:"SelectedCalendarsDesktop",valuetype:"StringArray",value:Object(a.b)(t)}],h,Object(p.a)(Object(j.d)(n))).catch((function(t){g.g.warn("Could not save new selected calendars list to user configuration")}))}function A(t){return t?function(t){var n=d().get(t);return n?n.length:0}(t):(n=d(),e=0,n.forEach((function(t,n){t&&(e+=t.length)})),e);var n,e}Object(r.orchestrator)(b,(function(t){var n=t.calendarIds,e=t.userIdentity;i(n,e),O(n,e),y(n,e)})),Object(r.orchestrator)(v,(function(t){var n=t.calendarId,e=t.userIdentity;c(n,e);var r=l(e);O(r,e),y(r,e)})),Object(r.orchestrator)(E.B,(function(t){var n=t.userConfiguration,e=t.userIdentity,r=n.ViewStateConfiguration.SelectedCalendarsDesktop,c=e||Object(j.d)().userIdentity;i(r,c),O(r,c)})),e.d(n,"g",(function(){return b})),e.d(n,"a",(function(){return v})),e.d(n,"f",(function(){return O})),e.d(n,"e",(function(){return l})),e.d(n,"c",(function(){return A})),e.d(n,"b",(function(){return d})),e.d(n,"d",(function(){return f}))},325:function(t,n,e){"use strict";var r;e.d(n,"a",(function(){return r})),function(t){t[t.None=0]="None",t[t.Hx=1]="Hx",t[t.Web=2]="Web",t[t.Remote=4]="Remote",t[t.All=7]="All"}(r||(r={}))},419:function(t,n,e){"use strict";var r=e(1);function i(t,n){return t?Object(r.a)({mailboxInfo:t},n):null!=n?n:void 0}e.d(n,"a",(function(){return i}))},482:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(325),i={Loki:{resourceUrl:"https://loki.delve.office.com/"},Analytics:{disabledDatapoints:[]},EnabledResolvers:{Query:{},Mutation:{markItemAsRead:r.a.Hx|r.a.Remote},Subscription:{}}}},533:function(t,n,e){"use strict";e.d(n,"a",(function(){return i})),e.d(n,"c",(function(){return c})),e.d(n,"b",(function(){return o}));var r=e(11),i=function(){var t=Object(r.a)(window,"applicationSettingOverrides");if(t)try{return JSON.parse(t)}catch(t){return{}}return{}},c=function(t,n){var e=i();e[t]=n,Object(r.e)(window,"applicationSettingOverrides",JSON.stringify(e))},o=function(){Object(r.d)(window,"applicationSettingOverrides")}},539:function(t,n,e){"use strict";var r=e(2),i=Object(r.action)("initializeApplicationSettings",(function(t){return{config:t}})),c=e(482),o=e(215);var u=function(t,n,e){var r={},i=0,c=function t(n,e){void 0===e&&(e={});var r=0,i=[];return Object.keys(n).forEach((function(c){var o=n[c];if("object"==typeof o&&null!==o&&!Array.isArray(o)){var u=t(n[c],e[c]),a=u.count,s=u.keys;a&&(r+=a,i.push({group:c,settings:s}))}else e.hasOwnProperty(c)||(r+=1,i.push(c))})),{count:r,keys:i}}(t,n),o=c.count,u=c.keys;if(o&&(r.MissingSettings=u,i=o),i&&(r.MissingSettingsCount=i),e&&(r.LastError=e),i)return r},a=(Object(r.mutator)(i,(function(t){var n=t.config,e=Object(o.a)();if(e.initialized=!0,n){if(!n.settings)return e.lastError=n.lastError,void(e.report={NoSettings:!0});var r={};Object.keys(c.a).forEach((function(t){r[t]={};var e=n.settings[t];Object.keys(c.a[t]).forEach((function(n){r[t][n]=e&&e.hasOwnProperty(n)?e[n]:c.a[t][n]}))})),e.configIDs=n.configIDs,e.lastError=n.lastError,e.settings=r,e.report=u(c.a,n.settings,n.lastError)}else e.report={NoSettings:!0}})),e(1)),s=Object(r.action)("setApplicationSettingOverride",(function(t,n){return{setting:t,value:n}})),d=(Object(r.mutator)(s,(function(t){var n,e=t.setting,r=t.value,i=Object(o.a)();i.overrides=Object(a.a)(Object(a.a)({},i.overrides),((n={})[e]=r,n))})),Object(r.action)("setApplicationSettingsSearchKey",(function(t){return{key:t}}))),f=(Object(r.mutator)(d,(function(t){var n=t.key;Object(o.a)().searchKey=n})),Object(r.action)("resetApplicationSettingOverrides")),l=(Object(r.mutator)(f,(function(){Object(o.a)().overrides={}})),e(533)),b=(Object(r.orchestrator)(s,(function(t){var n=t.setting,e=t.value;Object(l.c)(n,e)})),Object(r.orchestrator)(f,l.b),e(636));function v(t){return Object(o.a)().overrides[t]}function O(){return Object(o.a)().report}function j(){return Object(o.a)().searchKey}var g=e(865),E=e(325),p=e(24);function h(t,n){return(S(t,n)&E.a.Hx)==E.a.Hx}function y(t,n){return(S(t,n)&E.a.Web)==E.a.Web}function A(t,n){return(S(t,n)&E.a.Remote)==E.a.Remote}function S(t,n){var e,r=E.a.All;if(Object(p.i)("fwk-graphql-resolvers-config")&&Object(p.i)("fwk-application-settings")){var i=Object(b.a)("EnabledResolvers"),c=null===(e=null==i?void 0:i[t])||void 0===e?void 0:e[n];return null==c?r:c}return r}e.d(n,"f",(function(){return b.a})),e.d(n,"e",(function(){return v})),e.d(n,"g",(function(){return O})),e.d(n,"h",(function(){return j})),e.d(n,"d",(function(){return g.a})),e.d(n,"i",(function(){return i})),e.d(n,"k",(function(){return s})),e.d(n,"l",(function(){return d})),e.d(n,"j",(function(){return f})),e.d(n,"a",(function(){return h})),e.d(n,"c",(function(){return y})),e.d(n,"b",(function(){return A}))},613:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(1);function i(t){return Object(r.a)({__type:"FolderId:#Exchange"},t)}},636:function(t,n,e){"use strict";(function(t){e.d(n,"a",(function(){return u}));var r=e(1),i=e(23),c=e(24),o=e(215);function u(n){var e=Object(o.a)();return e.initialized||t.env.JEST_WORKER_ID||i.d("Attempted to read "+n+" before application settings were initialized."),Object(c.i)("fwk-devTools")?function t(n,e,i){var c={};return Object.keys(n).forEach((function(o){var u,a;if("object"==typeof o&&null!==o&&!Array.isArray(o))c=Object(r.a)(Object(r.a)({},c),((u={})[i.shift()]=t(n[o],e,i),u));else{var s=Object(r.j)(Object(r.j)([],Object(r.g)(i)),[o]).join("."),d=e[s];c=Object(r.a)(Object(r.a)({},c),((a={})[o]=void 0===d?n[o]:d,a))}})),c}(e.settings[n],e.overrides,[n]):e.settings[n]}}).call(this,e(226))},6371:function(t,n,e){"use strict";e.r(n);var r=e(1),i=e(1096),c=e(2),o=e(2286),u=e(209),a=e(76),s=e(1309);Object(c.orchestrator)(i.c,(function(t){return Object(r.c)(void 0,void 0,void 0,(function(){var n,e;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=t.userId,e=Object(o.e)(n||Object(u.d)().userIdentity),[4,Promise.all(e.filter((function(t){return Object(a.d)(t)&&Object(a.c)(t)})).map(s.c))];case 1:return r.sent(),[2]}}))}))}));var d=e(6926),f=e(8572);e.d(n,"initializeAccountAndCalendars",(function(){return d.a})),e.d(n,"initializeCalendarsDataForModule",(function(){return f.a}))},6926:function(t,n,e){"use strict";e.d(n,"a",(function(){return s}));var r=e(1),i=e(57),c=e(1096),o=e(1283),u=e(24),a=e(210);function s(){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,Object(c.d)()];case 1:return n.sent(),t=Object(i.h)(),Object(u.g)("cal-multiAccounts",(function(){var n,e;Object(a.a)("multiAccounts")&&!Object(i.s)()&&!(null===(n=null==t?void 0:t.SessionSettings)||void 0===n?void 0:n.IsExplicitLogon)&&(null===(e=null==t?void 0:t.PolicySettings)||void 0===e?void 0:e.PersonalAccountCalendarsEnabled)&&o.a.importAndExecute()})),[2]}}))}))}},8572:function(t,n,e){"use strict";var r=e(1),i=e(6914),c=e(6926),o=e(31),u=new o.c((function(){return e.e(876).then(e.bind(null,18511))})),a=new o.a(u,(function(t){return t.loadWorkloadScenarioSettings}));e.d(n,"a",(function(){return d}));var s=!1;function d(){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return s?[2]:(s=!0,t=[Object(c.a)(),a.importAndExecute()],i.a.import(),[4,Promise.all(t)]);case 1:return n.sent(),[2]}}))}))}},865:function(t,n,e){"use strict";(function(t){e.d(n,"a",(function(){return c}));var r=e(23),i=e(215);function c(){var n=Object(i.a)();return n.initialized||t.env.JEST_WORKER_ID||r.d("Attempted to read settings before application settings were initialized."),n.settings}}).call(this,e(226))},871:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(1);function i(t){return Object(r.a)({__type:"DistinguishedFolderId:#Exchange"},t)}}}]);
//# sourceMappingURL=owa.MailBoot~CalendarBootstrapUtils.js.map
self.scriptsLoaded['owa.MailBoot~CalendarBootstrapUtils.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~CalendarBootstrapUtils.js'] = (new Date()).getTime();