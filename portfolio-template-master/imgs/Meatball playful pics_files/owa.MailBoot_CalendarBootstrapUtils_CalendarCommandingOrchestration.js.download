self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~CalendarBootstrapUtils~CalendarCommandingOrchestration.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[239],{1086:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(2),u=Object(r.action)("initializeOwaAccountsStore"),o=Object(r.action)("owaConnectedAccountAdded",(function(e,t){return{userIdentity:e,accountProviderType:t}})),i=Object(r.action)("removeAccount",(function(e){return{userIdentity:e}})),a=Object(r.action)("owaAccountStoreInitializationFailed",(function(e,t,n,r){return{userIdentity:e,isRetry:t,accountProvider:n,error:r}}))},1096:function(e,t,n){"use strict";var r,u=n(2),o=Object(u.createStore)("cacheLoaderStore",{loadedCalendarAccounts:[]});!function(e){e[e.Outlook=0]="Outlook",e[e.OutlookGroup=1]="OutlookGroup",e[e.TeamsCalendars=2]="TeamsCalendars"}(r||(r={}));var i=n(94),a=n(209);function c(e,t){switch(e){case r.Outlook:case r.OutlookGroup:return(t||Object(a.d)().userIdentity)+e.toString();case r.TeamsCalendars:return e.toString();default:return Object(i.a)(e)}}var s=n(57),d=n(24);function l(e,t){var n=c(e,t);return o().loadedCalendarAccounts.some((function(e){return e===n}))}function f(e){return function(e){if(e&&e!==Object(s.b)()){var t=[r.Outlook];return Object(d.i)("cal-multiAccounts-groups")&&t.push(r.OutlookGroup),t}return[r.Outlook,r.OutlookGroup,r.TeamsCalendars]}(e).every((function(t){return l(t,e)}))}var b=Object(u.action)("addToLoadedCalendarAccounts",(function(e){return{calendarAccountData:e}}));Object(u.mutator)(b,(function(e){o().loadedCalendarAccounts.push(e.calendarAccountData)}));var p=n(1283),v=n(23),O=Object(u.action)("calendarCacheInitializedForAccount",(function(e,t){return{calendarEndpointType:e,userId:t}})),m=n(1),j=n(1309),h=n(1323),y=n(1318);var w=n(742),C=Object(w.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(w.a)(1e3)}),G={};function I(e,t){if(t=t||Object(a.d)().userIdentity,l(e,t))return Promise.resolve();var n=c(e,t),u=G[n];if(u)return u.requestPromise;var o=C((function(){return function(e,t){return Object(m.c)(this,void 0,void 0,(function(){return Object(m.f)(this,(function(n){switch(n.label){case 0:switch(e){case r.Outlook:return[3,1];case r.OutlookGroup:return[3,3];case r.TeamsCalendars:return[3,5]}return[3,8];case 1:return[4,Object(j.f)(t)];case 2:return n.sent(),[3,9];case 3:return[4,Object(h.b)(t)];case 4:return n.sent(),[3,9];case 5:return Object(d.i)("cal-showAddTeamsCalendars")?[4,y.d.importAndExecute()]:[3,7];case 6:n.sent(),n.label=7;case 7:return[3,9];case 8:Object(i.a)(e),n.label=9;case 9:return[2]}}))}))}(e,t)})).retriableFunc();return G[n]={requestPromise:o},o.then((function(){b(n),O(e,t)})).catch((function(e){v.d("initializeCalendarsCacheForAccount: failed to initialize calendar cache",e)}))}Object(u.orchestrator)(p.e,(function(e){I(r.Outlook,e.userIdentity),Object(d.i)("cal-multiAccounts-groups")&&I(r.OutlookGroup,e.userIdentity)}));var S=n(374);function g(){return Object(m.c)(this,void 0,void 0,(function(){var e,t,n,u,o,i;return Object(m.f)(this,(function(a){switch(a.label){case 0:return e=I(r.Outlook),t=Object(S.n)().map((function(e){Object(s.i)(e.userIdentity)&&I(r.Outlook,e.userIdentity)})),n=I(r.OutlookGroup),u=I(r.TeamsCalendars),o=Object(m.j)(Object(m.j)([e,n],Object(m.g)(t)),[u]),Object(d.i)("cal-multiAccounts-groups")&&(i=Object(S.n)().map((function(e){Object(s.i)(e.userIdentity)&&I(r.OutlookGroup,e.userIdentity)})),o=o.concat(i)),[4,Promise.all(o)];case 1:return a.sent(),[2]}}))}))}n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return I})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return g}))},1283:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c}));var r=n(1086);n.d(t,"e",(function(){return r.c})),n.d(t,"d",(function(){return r.b}));var u=n(31),o=new u.c((function(){return n.e(899).then(n.bind(null,1881))})),i=new u.a(o,(function(e){return e.initializeOwaAccountsStore})),a=new u.a(o,(function(e){return e.initializeOwaConnectedAccount})),c=new u.a(o,(function(e){return e.removeOWAConnectedAccount}))},1310:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(33),u=n(1314);function o(e,t){return void 0===e||e.__type||(e=Object(u.a)(e)),Object(r.a)("GetUserUnifiedGroups",e,t)}},1311:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1);function u(e){return Object(r.a)({__type:"GetUserUnifiedGroupsRequest:#Exchange"},e)}},1314:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1);function u(e){return Object(r.a)({__type:"GetUserUnifiedGroupsJsonRequest:#Exchange"},e)}},1318:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(31),u=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(19),n.e(25),n.e(840)]).then(n.bind(null,1883))})),o=new r.a(u,(function(e){return e.initializeSelectedTeamsCalendars})),i=new r.a(u,(function(e){return e.getSelectedTeamsCalendars})),a=new r.a(u,(function(e){return e.createCalendarFromTeamsChannel})),c=new r.a(u,(function(e){return e.createCalendarCacheInfoFromTeamsChannel}))},1323:function(e,t,n){"use strict";var r=n(1),u=n(121),o=n(76),i="Groups",a=n(183),c=n(209),s=n(180),d=n(419),l=n(1310),f=n(1311),b=n(1325),p=n(6);function v(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n,u;return Object(r.f)(this,(function(r){switch(r.label){case 0:return 4,(t=[]).push({FilterType:1,SortType:4,SortDirection:"Descending"}),t.push({FilterType:2,SortType:4,SortDirection:"Descending"}),(n=Object(s.b)()).RequestServerVersion="V2018_01_08",u=Object(d.a)(Object(c.d)(e)),[4,Object(l.a)({Header:n,Body:Object(f.a)({RequestedGroupsSets:t})},u)];case 1:return[2,r.sent()]}}))}))}var O=Object(a.action)("getGroupCalendarsService")((function(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,v(e)];case 1:return null!=(t=n.sent())&&t.Body.GroupsSets&&t.Body.GroupsSets.length>0?[2,m(t.Body.GroupsSets,e)]:[2,null]}}))}))}));function m(e,t){var n=[],r=[],u=Object(o.r)(t,i);if(e.forEach((function(e){e.Groups.forEach((function(e){var o,i=e.SmtpAddress.toLowerCase(),a={type:"GroupMailbox",userIdentity:t,mailboxSmtpAddress:i},c={calendarId:{itemId:{Id:i},mailboxInfo:a},CalendarColor:-1,CalendarName:e.DisplayName,OwnerEmailAddress:i,OwnerName:e.DisplayName,IsGroupMailboxCalendar:!0,IsGeneralScheduleCalendar:!0,ParentGroupId:u,CanShare:!1,DistinguishedFolderId:i,__typename:"LinkedCalendarEntry"};n.push({entry:c,groupMailboxGuid:null===(o=e.MailboxGuid)||void 0===o?void 0:o.toLowerCase()});var s={id:{id:i,mailboxInfo:a},calculatedFolderId:i,displayName:e.DisplayName,colorScheme:null};r.push(s)}))})),r.length>0){var a={calendarGroupId:{itemId:{Id:u},mailboxInfo:{type:"GroupMailbox",userIdentity:t,mailboxSmtpAddress:t}},serverGroupId:u,GroupName:Object(p.b)(b.a),GroupType:3};return{groupCalendars:n,calendarGroup:a,calendars:r}}return null}var j=n(426);var h=n(197),y=Object(a.action)("getGroupCalendars")((function(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,O(e)];case 1:return t=r.sent(),null!=(n=Object(h.a)(e)?function(e){var t,n=Object(o.k)().filter((function(e){return Object(j.f)(e)}));if(0==n.length)return e;for(var r=[],u=[],i=function(t){var o=e.groupCalendars[t];n.some((function(e){var t,n,r=e;return(null===(t=r.OwnerEmailAddress)||void 0===t?void 0:t.toLowerCase())===o.entry.calendarId.mailboxInfo.mailboxSmtpAddress&&(null===(n=r.SharedOwnerMailboxGuid)||void 0===n?void 0:n.toLowerCase())===o.groupMailboxGuid}))||(r.push(o),u.push(e.calendars[t]))},a=0;a<(null===(t=null==e?void 0:e.groupCalendars)||void 0===t?void 0:t.length);a++)i(a);return(null==r?void 0:r.length)>0?{groupCalendars:r,calendarGroup:e.calendarGroup,calendars:u}:null}(t):t)&&null!=n.groupCalendars?(n.groupCalendars.forEach((function(e){Object(o.b)(e.entry)})),Object(o.a)(n.calendarGroup),[2,{group:n.calendarGroup,calendars:n.calendars}]):[2,null]}}))}))})),w=n(57),C=Object(a.action)("initializeGroupCalendars")((function(e,t){var n;return Object(r.c)(this,void 0,void 0,(function(){var a,s,d,l,f,b;return Object(r.f)(this,(function(r){switch(r.label){case 0:a=new u.b("initializeGroupCalendars"),e||(e=Object(c.d)().userIdentity),s=!!(null===(n=Object(w.i)(e))||void 0===n?void 0:n.GroupsEnabled),d=Object(o.r)(e,i),l=!Object(o.s)().some((function(t){return t.serverGroupId===d&&t.calendarGroupId.mailboxInfo.userIdentity===e})),f=s&&(t||l),a.addCustomData({issueServiceCall:f,GroupsEnabled:s,featureEnabled:!0,refresh:t,initialLoad:l}),r.label=1;case 1:return r.trys.push([1,4,,5]),f?[4,y(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return a.end(),[3,5];case 4:throw b=r.sent(),a.endWithError("ServerError",Error(b)),b;case 5:return[2]}}))}))})),G=n(2),I=n(23),S=n(992),g=null;Object(G.orchestrator)(o.C,(function(e){var t=e.payload,n=t.id,r=t.EventType,u=t.Group;I.g.info(n+": "+r+", "+(null==u?void 0:u.SmtpAddress)),"Reload"!=r&&(g||(g=Object(S.a)(C.bind(null,Object(c.d)().userIdentity,!0),2e3)),g())})),n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return i}))},1325:function(e){e.exports=JSON.parse('{"a":"sZa"}')},531:function(e,t,n){"use strict";var r=n(311),u=n(303),o="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(u.a)(e)&&Object(r.a)(e)==o}},6914:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return o}));var r=n(31),u=new r.c((function(){return n.e(365).then(n.bind(null,12186)).then((function(e){return e.initialize(),e}))})),o=new r.a(u,(function(e){return e.tryAutoSelect}))},699:function(e,t,n){"use strict";var r=/\s/;var u=function(e){for(var t=e.length;t--&&r.test(e.charAt(t)););return t},o=/^\s+/;var i=function(e){return e?e.slice(0,u(e)+1).replace(o,""):e},a=n(216),c=n(531),s=NaN,d=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,f=/^0o[0-7]+$/i,b=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(c.a)(e))return s;if(Object(a.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(a.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=i(e);var n=l.test(e);return n||f.test(e)?b(e.slice(2),n?2:8):d.test(e)?s:+e}},742:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,u=!1,o=function(i,a){u?a(new Error("The function retry was cancelled")):(r++,e().then((function(e){return i(e)})).catch((function(e){t&&r>=t?a(e):setTimeout((function(){return o(i,a)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return o(e,t)}))},cancel:function(){return u=!0}}}}function u(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return u}))},992:function(e,t,n){"use strict";var r=n(216),u=n(184),o=function(){return u.a.Date.now()},i=n(699),a="Expected a function",c=Math.max,s=Math.min;t.a=function(e,t,n){var u,d,l,f,b,p,v=0,O=!1,m=!1,j=!0;if("function"!=typeof e)throw new TypeError(a);function h(t){var n=u,r=d;return u=d=void 0,v=t,f=e.apply(r,n)}function y(e){var n=e-p;return void 0===p||n>=t||n<0||m&&e-v>=l}function w(){var e=o();if(y(e))return C(e);b=setTimeout(w,function(e){var n=t-(e-p);return m?s(n,l-(e-v)):n}(e))}function C(e){return b=void 0,j&&u?h(e):(u=d=void 0,f)}function G(){var e=o(),n=y(e);if(u=arguments,d=this,p=e,n){if(void 0===b)return function(e){return v=e,b=setTimeout(w,t),O?h(e):f}(p);if(m)return clearTimeout(b),b=setTimeout(w,t),h(p)}return void 0===b&&(b=setTimeout(w,t)),f}return t=Object(i.a)(t)||0,Object(r.a)(n)&&(O=!!n.leading,l=(m="maxWait"in n)?c(Object(i.a)(n.maxWait)||0,t):l,j="trailing"in n?!!n.trailing:j),G.cancel=function(){void 0!==b&&clearTimeout(b),v=0,u=p=d=b=void 0},G.flush=function(){return void 0===b?f:C(o())},G}}}]);
//# sourceMappingURL=owa.MailBoot~CalendarBootstrapUtils~CalendarCommandingOrchestration.js.map
self.scriptsLoaded['owa.MailBoot~CalendarBootstrapUtils~CalendarCommandingOrchestration.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~CalendarBootstrapUtils~CalendarCommandingOrchestration.js'] = (new Date()).getTime();