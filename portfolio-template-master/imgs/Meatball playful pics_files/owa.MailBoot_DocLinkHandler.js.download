self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~DocLinkHandler.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[615],{1963:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function c(e){var t=r(e);return t?t.replace(".",""):null}function i(e){var t;return(null===(t=c(e))||void 0===t?void 0:t.substring(0,4))||""}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i}))},1992:function(e,t,n){"use strict";var r=n(1963),c=n(2210),i=n(6);function a(e){var t;return e>=1073741824?(e/=1073741824,t=Object(i.b)(c.b)):e>=1048576?(e/=1048576,t=Object(i.b)(c.d)):e>=1024?(e/=1024,t=Object(i.b)(c.c)):t=Object(i.b)(c.a),Object(i.c)(t,Math.round(e))}var o,u=n(2061),s=n(24),l=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function f(e){if(!Object(s.i)("doc-attachment-documentThumbnail"))return!1;var t=Object(r.a)(e);return!!t&&l.indexOf(t.toLowerCase())>=0}function d(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return o.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return o.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return o.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(o||(o={}));var b=n(2019);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return a})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return f})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return b.b})),n.d(t,"a",(function(){return o}))},2019:function(e,t,n){"use strict";function r(e){return t=e||"",(n=i.exec(t))&&n.length>1&&c[n[1].toLowerCase()];var t,n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var c={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},i=/^\s*([^;\s]*)(?:;|\s|$)/;function a(e){var t="";return Object.entries(c).forEach((function(n){n[1]===e&&(t=n[0])})),t}},2029:function(e,t,n){"use strict";var r,c,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return i})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(c||(c={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(i||(i={}))},2060:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return o}));var r="FileAttachment:#Exchange",c="ItemAttachment:#Exchange",i="ItemIdAttachment:#Exchange",a="ReferenceAttachment:#Exchange",o="LinkAttachment:#Exchange"},2061:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(1963),c=n(2019),i=n(102),a=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],o=[".tiff",".tif"];function u(e,t,n){return void 0===n&&(n=!0),s(Object(r.a)(e)||Object(c.a)(t),n)}function s(e,t){return void 0===t&&(t=!0),!!e&&(a.indexOf(e.toLowerCase())>=0||t&&o.indexOf(e.toLowerCase())>=0&&(Object(i.e)()||Object(i.d)()||Object(i.h)()||Object(i.g)()&&!Object(i.l)()))}},2110:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2060);function c(e){return(e.__type||e.OwsTypeName)===r.e}},2140:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(94);function c(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},2210:function(e){e.exports=JSON.parse('{"b":"Nea","d":"Oea","c":"Pea","a":"Qea"}')},2212:function(e,t,n){"use strict";var r=n(2060),c=n(6),i=function(e){return e&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(e)};function a(e){var t=e.__type||e.OwsTypeName;switch(t){case r.a:return 0;case r.e:return e.IsLink?3:1;case r.d:return 3;case r.b:return 2;case r.c:var n=e,a=e.EmbeddedItemClass;return a&&i(a)||Object(c.f)(n.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+t)}}n.d(t,"a",(function(){return a}))},2253:function(e,t,n){"use strict";var r=n(2004);function c(){var e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var i=n(2140),a=n(2110);function o(){return c()}function u(e){return(e&&e.length>0&&function(e){return e.some((function(e){return!((t=e).IsInline&&!Object(a.a)(t));var t}))}(e)?c():[]).map(i.a)}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}))},2416:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(31),c=new r.c((function(){return n.e(1025).then(n.bind(null,3289))})),i=new r.b(c,(function(e){return e.extractFileUrlFromOfficeSharePointLink})),a=new r.b(c,(function(e){return e.isLinkPrefixedWithBaseUrl})),o=new r.b(c,(function(e){return e.isSharePointLink})),u=new r.b(c,(function(e){return e.isSharePointServiceGeneratedLink})),s=new r.b(c,(function(e){return e.isOfficeSharePointLink})),l=new r.b(c,(function(e){return e.getParsedQueryStringFromUrl}))},2458:function(e){e.exports=JSON.parse('{"a":"Cda"}')},2495:function(e,t,n){"use strict";var r=n(31),c=[0,1],i=n(2505),a=n(2458),o=n(6),u=n(94),s=n(2029);function l(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(o.b)(a.a),messageParts:[Object(o.b)(a.a),f()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(o.b)(i.b),messageParts:[Object(o.b)(i.b),f()],color:s.a.Red};default:return Object(u.a)(e)}}function f(){return{text:Object(o.b)(i.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var d=n(2253),b=n(2140),p=n(1),h=n(24),O=n(2004);function m(){var e=Object(O.a)();if(Object(h.i)("fwk-devTools")){if(Object(h.i)("doc-attachment-CA-readOnlyAccessIssues"))return Object(p.a)(Object(p.a)({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(h.i)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(p.a)(Object(p.a)({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function v(){var e=m();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return P})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return d.a})),n.d(t,"e",(function(){return b.a})),n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return m}));var w=new r.c((function(){return n.e(1708).then(n.bind(null,18005))})),P=new r.b(w,(function(e){return e.getAccessIssuesForAttachments}))},2505:function(e){e.exports=JSON.parse('{"a":"Ada","b":"Bda"}')},2644:function(e,t,n){"use strict";var r,c=n(1992),i=n(2495),a=n(19),o=n(2061),u=n(3942),s=n(2212);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.AccessDisabled=4]="AccessDisabled"}(r||(r={}));var l=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?(this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled,this.linkPreviewEnabled=this.attachmentPolicy.WacViewingOnPublicComputersEnabled):(this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.linkPreviewEnabled=this.attachmentPolicy.WacViewingOnPrivateComputersEnabled),this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=r[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}return e.prototype.getPolicyInfo=function(e,t,n,c){e&&(e=e.toLowerCase());var i=this.getFileAccessLevel(e,t),a=!1,s=!1,l=!1,f=1===c||3===c;i!==r.Block&&n&&(this.isWacViewingEnabled(e)&&(a=!0),!this.directFileAccessEnabled&&f&&(a=!1),s=this.isForceBrowserViewingFirst(a),a&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(l=0===c?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),a||Object(o.b)(e)||Object(u.a)(e)||this.directFileAccessEnabled||(i=r.AccessDisabled));return{directFileAccessEnabled:this.directFileAccessEnabled,level:i,useWac:a,forceBrowserViewingFirst:s,wacEdit:l}},e.prototype.isPdfPreviewEnabled=function(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=r.Undefined),n===r.Block)return r.Block;var c=this.mimeTypeToPolicyMap[t];return c===r.Block?r.Block:n===r.ForceSave||c===r.ForceSave?r.ForceSave:n===r.Allow||c===r.Allow?r.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach((function(t){e[t]=n}))},e.prototype.createPolicyMap=function(e,t,n){var c={};return this.addPolicyIntoMap(c,n,r.Allow),this.addPolicyIntoMap(c,t,r.ForceSave),this.addPolicyIntoMap(c,e,r.Block),c},e}(),f=null,d=null;function b(){if(!f){var e=Object(a.a)(),t=Object(i.c)(),n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;f=new l(t,n),n&&(d=f)}return f}function p(e,t){var n=Object(c.b)(e.Name),r=e.ContentType;return b().getPolicyInfo(n,r,t,Object(s.a)(e))}function h(e,t){var n=Object(c.b)(e.Name),r=e.ContentType;return function(){if(!d){var e=Object(a.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return b();d=new l(Object(i.c)(),!0)}return d}().getPolicyInfo(n,r,t,Object(s.a)(e))}function O(e,t,n,c){if(c)return!1;var i=p(e,!0),a=b();return i.level!==r.Block&&a.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"d",(function(){return O})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return h})),n.d(t,"e",(function(){return b}))},3262:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1);function c(e){return Object(r.a)({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},3339:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return o}));var r="originalsrc",c="shash",i="data-auth",a="&reserved=0",o="Verified"},3691:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(33),c=n(3262);function i(e,t){return void 0===e||e.__type||(e=Object(c.a)(e)),Object(r.a)("FetchDataProviderResource",e,t)}},3942:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(1963),c=[".txt",".xml",".log"];function i(e){return a(Object(r.a)(e))}function a(e){return!!e&&c.indexOf(e.toLowerCase())>=0}},4301:function(e,t,n){"use strict";n.d(t,"j",(function(){return c})),n.d(t,"i",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return b}));var r=n(2),c=Object(r.action)("tryQueueGetWacInfo",(function(e){return{url:e}})),i=Object(r.action)("queueGetWacInfo",(function(e){return{url:e}})),a=Object(r.action)("processGetWacInfoQueue"),o=Object(r.action)("getWacInfoQueueShift"),u=Object(r.action)("onStartGetWacInfoOperation",(function(e){return{url:e}})),s=Object(r.action)("onFinishGetWacInfoOperation",(function(e){return{url:e}})),l=Object(r.action)("pushSupressedUrl",(function(e){return{url:e}})),f=Object(r.action)("onGetWacInfoSuccess",(function(e,t,n){return{url:e,wacUrlInfo:t,needRedeem:n}})),d=Object(r.action)("addGenericLinkClickListener",(function(e,t,n){return{element:e,isSafeLinkWrapped:t,isSafeLinkVerified:n}})),b=Object(r.action)("addOpenDocumentPreviewEventListener",(function(e,t,n,r,c,i){return{element:e,href:t,itemId:n,isSafeLinkWrapped:r,isSafeLinkVerified:c,isOfficeSPLink:i}}))},4302:function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return o}));var r=n(31),c=n(3339);n.d(t,"b",(function(){return c.b})),n.d(t,"d",(function(){return c.d})),n.d(t,"a",(function(){return c.a})),n.d(t,"c",(function(){return c.c})),n.d(t,"e",(function(){return c.e}));var i=new r.c((function(){return n.e(439).then(n.bind(null,10339))})),a=new r.b(i,(function(e){return e.evaluateSafeLink})),o=(new r.b(i,(function(e){return e.evaluateSafeLinks})),new r.b(i,(function(e){return e.isSafeLink})))},4701:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return s}));var r=18e5,c=2,i=2,a=1,o="OD_LINK_CLICK_EVENT_LISTENER",u="OD_LINK_MOUSEUP_EVENT_LISTENER",s="https://1drv.ms"},4702:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1),c=n(121),i=n(3262),a=n(3691),o=n(23);function u(e,t,n,u,s){return Object(r.c)(this,void 0,void 0,(function(){var l,f,d,b,p,h,O,m,v,w,P,j,y,g;return Object(r.f)(this,(function(r){switch(r.label){case 0:l=new c.b("getWacInfoForOneDriveJsApi",{isCore:!0}),u&&l.addCustomData({redeemSharingLinkIfNecessary:u}),r.label=1;case 1:return r.trys.push([1,3,,4]),f=btoa(t),d="u!"+f.replace(/^\=+|\=+$/g,"").replace("/","_").replace("+","-"),b=new RegExp(/.+?\:\/\/.+?(\/)/g).exec(t)[0],p=b+"_api/v2.0/shares/"+d+"/root?select=openWith/wac,officeBundle,@content.downloadUrl,name,size,currentUserRole&action="+(n?"Open":"View"),h=new Object,u&&(h.prefer="redeemSharingLinkIfNecessary"),O=Object(i.a)({ProviderType:e,Url:p,Headers:JSON.stringify(h)}),m=(new Date).getTime(),[4,Object(a.a)(O)];case 2:if(200===(v=r.sent()).Status&&v.Body)return w=(new Date).getTime(),(P=JSON.parse(v.Body)).fetchStartTime=m,P.responseStartTime=w,!P.openWith.wac&&s||(P.openWith.wac.fileGetUrl=P["@content.downloadUrl"],P.openWith.wac.accessTokenExpiry&&(P.openWith.wac.accessTokenExpiry=new Date(Number(P.openWith.wac.accessTokenExpiry))),!n&&P.currentUserRole&&(P.currentUserRole.readOnly=!0)),l.end(),[2,P];throw l.addCustomData({StatusCode:v.Status}),(j=v.Headers)&&(y=JSON.parse(j))&&l.addCustomData({SharePointError:y.SharePointError,SPClientServiceRequestDuration:y.SPClientServiceRequestDuration,SPRequestGuid:y.SPRequestGuid}),new Error("Result status is: "+v.Status+" or empty response body.");case 3:return g=r.sent(),l.endWithError("ServerError",g),o.g.warn("Something went wrong while calling fetchDataProviderResourceOperation: "+g),[3,4];case 4:return[2,null]}}))}))}},4906:function(e,t,n){"use strict";var r=n(14),c=n(2),i={activeGetWacInfoOperations:[],getWacInfoQueue:[],suppressedUrls:[],docLinkPreviewInfoMap:new r.ObservableMap},a=Object(c.createStore)("sharePointDocLinkPreview",i);t.a=a()},5369:function(e,t,n){"use strict";n.r(t);var r=n(4301),c=n(4906),i=n(2);Object(i.mutator)(r.f,(function(e){var t=e.url;c.a.activeGetWacInfoOperations.push(t)})),Object(i.mutator)(r.d,(function(e){var t=e.url;c.a.activeGetWacInfoOperations.splice(c.a.activeGetWacInfoOperations.indexOf(t),1)})),Object(i.mutator)(r.e,(function(e){var t=e.url,n=e.wacUrlInfo,r=e.needRedeem,i={time:Date.now(),wacUrlInfo:n,needRedeem:r};c.a.docLinkPreviewInfoMap.set(t,i)})),Object(i.mutator)(r.i,(function(e){var t=e.url;c.a.getWacInfoQueue.push(t)})),Object(i.mutator)(r.c,(function(){c.a.getWacInfoQueue.shift()})),Object(i.mutator)(r.h,(function(e){var t=e.url;c.a.suppressedUrls.push(t)}));var a=n(4701),o=n(9465),u=n(9466);Object(i.orchestrator)(r.a,(function(e){var t=e.element,n=e.isSafeLinkWrapped,r=e.isSafeLinkVerified,c=function(e){Object(u.a)(e,n,r,null)};t.addEventListener("click",c),t[a.c]=c;var i=function(e){Object(o.a)(e,n,r)};t.addEventListener("mouseup",i),t[a.d]=i}));var s=n(1),l=n(6138);Object(i.orchestrator)(r.g,(function(){return Object(s.c)(void 0,void 0,void 0,(function(){var e;return Object(s.f)(this,(function(t){switch(t.label){case 0:if(!c.a.getWacInfoQueue.length)return[2];if(c.a.activeGetWacInfoOperations.length>=a.g)return[2];e=c.a.getWacInfoQueue[0],Object(r.f)(e),Object(r.c)(),t.label=1;case 1:return t.trys.push([1,,3,4]),[4,Object(l.a)(e,!1)];case 2:return t.sent(),[3,4];case 3:return Object(r.d)(e),Object(r.g)(),[7];case 4:return[2]}}))}))}));var f=n(121),d=n(2644),b=n(24),p=n(4302),h=n(2416),O=n(2676),m=[/unsubscribealert\.aspx/i];var v=function(e){for(var t=0;t<m.length;t++){if(m[t].test(e))return!1}return!0};function w(e,t,n,r){return Object(s.c)(this,void 0,void 0,(function(){var c,i;return Object(s.f)(this,(function(o){switch(o.label){case 0:return[4,h.c.import()];case 1:return o.sent()(t,a.e)&&(c=function(e){P(n,r)},e.addEventListener("click",c),e[a.c]=c,i=function(e){e.button===a.a&&P(n,r)},e.addEventListener("mouseup",i),e[a.d]=i),[2]}}))}))}function P(e,t){Object(f.s)("ODCLinkClick",{isSafeLinkWrapped:e,isSafeLinkVerified:t})}Object(i.orchestrator)(O.b,(function(e){return Object(s.c)(void 0,void 0,void 0,(function(){var t,n,c,i,a,o,u,l,f,O,m,P,j,g,S,E,k,A;return Object(s.f)(this,(function(s){switch(s.label){case 0:return t=e.element,n=e.itemId,c=Object(d.e)(),i=c.linkPreviewEnabled,"a"!==t.tagName.toLowerCase()||function e(t){if("OwaReferenceAttachments"===t.id)return!0;return!!t.parentElement&&e(t.parentElement)}(t)?[3,22]:(a=t,[4,h.e.import()]);case 1:return o=s.sent(),[4,h.f.import()];case 2:return u=s.sent(),[4,p.g.import()];case 3:return l=s.sent(),[4,h.d.import()];case 4:return f=s.sent(),[4,p.f.import()];case 5:return O=s.sent(),[4,l(a)];case 6:return s.sent()?(g=t.getAttribute(p.b),E=t.getAttribute(p.a)===p.e,m=a.href,S=!0,o(g)?v(g)?(P=void 0,u(g)?(Object(r.a)(t,S,E),[3,11]):[3,7]):[3,11]:[3,12]):[3,18];case 7:return Object(b.i)("doc-SxS-jsApi-ODB-Links")&&i&&E?(Object(r.b)(t,g,n,S,E,!1),[3,11]):[3,8];case 8:return(j=Object(b.i)("doc-SxS-jsApi-ODB-Links")&&i&&!E)?[4,O(m)]:[3,10];case 9:j=!!(P=s.sent()),s.label=10;case 10:j?Object(r.b)(t,P,n,S,E,!1):Object(r.a)(t,S,E),s.label=11;case 11:return y(),[3,17];case 12:return f(g)?E?[3,14]:[4,O(m)]:[3,16];case 13:g=s.sent(),s.label=14;case 14:return[4,h.a.import()];case 15:return k=s.sent(),(A=k(g))&&i&&Object(r.b)(t,A,n,S,E,!0),[3,17];case 16:w(a,g,S,E),s.label=17;case 17:return[3,22];case 18:return g=a.href,S=!1,E=!1,o(g)?(v(g)&&(u(g)?Object(r.a)(t,S,E):Object(b.i)("doc-SxS-jsApi-ODB-Links")&&i?Object(r.b)(t,g,n,S,E,!1):Object(r.a)(t,S,E)),y(),[3,22]):[3,19];case 19:return f(g)?[4,h.a.import()]:[3,21];case 20:return k=s.sent(),(A=k(g))&&i&&Object(r.b)(t,A,n,S,E,!0),[3,22];case 21:w(a,g,S,E),s.label=22;case 22:return[2]}}))}))}));var j=!1;function y(){j||(j=!0,Object(f.s)("SharePointLinkFound"))}var g=n(6139);function S(e){var t=c.a.docLinkPreviewInfoMap.get(e),n=!!t;return(!t||t.time+a.f<=Date.now())&&Object(r.j)(e),n}Object(i.orchestrator)(r.j,(function(e){var t=e.url;c.a.getWacInfoQueue.some((function(e){return e===t}))||c.a.activeGetWacInfoOperations.some((function(e){return e===t}))||c.a.suppressedUrls.some((function(e){return e===t}))||Object(g.a)(t)||(Object(r.i)(t),Object(r.g)())})),Object(i.orchestrator)(O.c,(function(e){var t=e.elements;t&&t.forEach((function(e){var t=e[a.c];t&&(e.removeEventListener("click",t),e[a.c]=null);var n=e[a.d];n&&(e.removeEventListener("mouseup",n),e[a.d]=null)}))})),n.d(t,"tryProcessOneDriveLink",(function(){return O.b})),n.d(t,"tryUndoProcessOneDriveLink",(function(){return O.c})),n.d(t,"docLinkHadPreviewInfo",(function(){return S})),n.d(t,"forceGetWacInfoOperation",(function(){return l.a})),n.d(t,"getValidDocLinkPreviewInfo",(function(){return g.a}))},6138:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(1),c=n(6350),i=n(4702),a=n(24),o=n(1992),u=n(4301),s=n(6139);function l(e,t,n,c){return Object(r.c)(this,void 0,void 0,(function(){var l,d,b,p;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,,9,10]),Object(u.f)(e),l=null,Object(a.i)("doc-SxS-jsApi-ODB-Links")?[4,Object(i.a)(0,e,!0,n,!0)]:[3,6];case 1:return(d=r.sent())?[3,2]:(Object(u.h)(e),[2,null]);case 2:return b=Object(o.b)(d.name),p=Object(o.f)(b),".fluid"===b||".note"===b||".whiteboard"===b?(Object(u.h)(e),[2,null]):(c&&(c.fileExt=b),p!==o.a.Word&&p!==o.a.Excel&&p!==o.a.PowerPoint?[3,3]:(d.openWith.wac?l={wacUrl:d.openWith.wac.applicationUrl,jsApiInfo:{bootScriptUrl:d.openWith.wac.bootstrapperUrl,wopiSrcUrl:d.openWith.wac.wopiSrc,accessToken:d.openWith.wac.accessToken,accessTokenExpiry:d.openWith.wac.accessTokenExpiry,fileSize:d.size,fileGetUrl:d.openWith.wac.fileGetUrl,bundleInfo:d.officeBundle,fetchStartTime:d.fetchStartTime,responseStartTime:d.responseStartTime,openUrl:e,fileName:d.name,userId:d.openWith.wac.userId,clientThrottlingProtection:d.openWith.wac.clientThrottlingProtection,requestedCallThrottling:d.openWith.wac.requestedCallThrottling},readOnly:d.currentUserRole.readOnly}:Object(u.e)(e,null,!0),[3,5]));case 3:return[4,f(e)];case 4:l=r.sent(),r.label=5;case 5:return[3,8];case 6:return[4,f(e)];case 7:l=r.sent(),r.label=8;case 8:return l&&Object(u.e)(e,l),t?[2,Object(s.a)(e)]:[2,null];case 9:return Object(u.d)(e),[7];case 10:return[2]}}))}))}function f(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,Object(c.a)(e,0)];case 1:if(9===(t=n.sent()).Status||6===t.Status||5===t.Status)Object(u.h)(e);else if(0===t.Status)return[2,{wacUrl:t.WacUrl,bootScriptUrl:t.BootScriptUrl,wopiSrcUrl:t.WopiSrcUrl,accessToken:t.AccessToken,deprecatedTokenAndParameters:t.Token}];return[2,null]}}))}))}},6139:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(4701),c=n(4906);function i(e){return a(e).docLinkPreviewInfo||null}function a(e){var t=c.a.docLinkPreviewInfoMap.get(e);return t?t.time+r.f>Date.now()?{docLinkPreviewInfo:t}:{reason:"Expired"}:c.a.getWacInfoQueue.some((function(t){return t===e}))||c.a.activeGetWacInfoOperations.some((function(t){return t===e}))?{reason:"InQueue"}:c.a.suppressedUrls.some((function(t){return t===e}))?{reason:"FileTypeNotSupportedOrSuppressedAfterError"}:{reason:"Unknown"}}},6350:function(e,t,n){"use strict";var r=n(33),c=n(1);function i(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(c.a)({__type:"GetWacInfoRequest:#Exchange"},n))),Object(r.a)("GetWacInfo",e,t)}function a(e,t,n,r,c){return void 0===n&&(n=!1),void 0===r&&(r=!1),i({request:{Url:e,IsEdit:r,ProviderType:t,ShouldGrantAccess:n}},c)}n.d(t,"a",(function(){return a}))},6601:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(121);function c(e,t,n,c,i,a,o){Object(r.s)("SharePointLinkClick",{newTabReason:e,isSafeLinkWrapped:t,isSafeLinkVerified:n,extraInfo:c,isOfficeSPLink:i,isServiceGeneratedLink:a,fileExtension:o})}},9465:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(6601),c=n(4701);function i(e,t,n){e.button===c.a?Object(r.a)("MouseMiddleButton",t,n):e.button===c.b&&Object(r.a)("MouseRightButton",t,n)}},9466:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(121),c=n(203),i=n(4302),a=n(6601),o=n(2416),u=n(6138);function s(e,t,n,s){var l,f,d=Date.now(),b=new r.b("ServiceGeneratedLinkClickHandler"),p="CT="+d+"&OR=OWA-"+(e?e.ctrlKey||1===e.button?"NTB":e.shiftKey?"NW":"NT":"NT")+"&CID="+Object(c.a)(),h=e.currentTarget,O=(f=new URL(h.href),["CID","OR","CT"].forEach((function(e){var t;(null===(t=f.searchParams)||void 0===t?void 0:t.get(e))&&f.searchParams.delete(e)})),f);if(t){var m=O.href,v=m.indexOf(i.c);if(-1===v)return;var w=encodeURIComponent(btoa(p));l=m.substr(0,v)+"&xdata="+w+i.c}else{var P=O.href.indexOf("?")>=0?"&":"?";l=O.href+P+p}b.end(),window.open(l),e.preventDefault();var j={fileExt:""};Object(u.a)(t?h.getAttribute(i.b):O.toString(),!0,!0,j).then((function(r){o.f.import().then((function(r){Object(a.a)(s||(e.altKey?"AltKey":e.ctrlKey?"CtrlKey":e.metaKey?"MetaKey":e.shiftKey?"ShiftKey":"Default"),t,n,void 0,void 0,r(t?h.getAttribute(i.b):O.toString()),j.fileExt)}))}))}}}]);
//# sourceMappingURL=owa.MailBoot~DocLinkHandler.js.map
self.scriptsLoaded['owa.MailBoot~DocLinkHandler.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~DocLinkHandler.js'] = (new Date()).getTime();