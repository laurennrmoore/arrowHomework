self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~EmojiPickerPlugin.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[618],{10028:function(e,t,n){"use strict";var i=n(2);t.a=Object(i.mutatorAction)("Picker_setIsSuggesting",(function(e,t){e.isSuggesting=t}))},10351:function(e,t,n){"use strict";var i=n(1),r=n(4367);var o=n(9018),s=n(23),a="Popular gif searches",c="https://www.bing.com/api/v6/images/trending?appId=D41D8CD98F00B204E9800998ECF8427E61385B59&setmkt=en-us";var l=function(){return new Promise((function(e,t){var n=c,i=new XMLHttpRequest;i.open("GET",n,!0),i.onreadystatechange=function(){if(4===i.readyState){var n=[];if(200===i.status)try{JSON.parse(i.response).categories.forEach((function(e){e.title==a&&e.tiles.forEach((function(e){n.push(e.image)}))}));var r=Object(o.c)(n);e(r)}catch(e){s.g.warn("Unable to parse gif trending response"),t(e)}else i.status==o.a&&Object(o.d)(),t(new Error("Request failed with status "+i.status+". Message: "+i.responseText))}},i.send()}))},u=n(19);function d(){return Object(i.c)(this,void 0,void 0,(function(){var e;return Object(i.f)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,l()];case 1:return e=t.sent(),[3,3];case 2:return t.sent(),e=null,[3,3];case 3:return[2,{culture:Object(u.a)().SessionSettings.UserCulture,gifTrending:e}]}}))}))}var h=n(5105),g=n(2981),f=n(2),p=Object(f.mutatorAction)("setExpressionPickerViewStateToExpressionId",(function(e,t){g.a.expressionPickerViewStates.set(e,t)}));function m(e){return Object(i.c)(this,void 0,void 0,(function(){var t;return Object(i.f)(this,(function(n){switch(n.label){case 0:return!(t=g.a.expressionPickerViewStates.get(e))||Object(h.a)()&&!t.gifPickerViewState?[4,v(e)]:[3,2];case 1:t=n.sent(),p(e,t),n.label=2;case 2:return[2,t]}}))}))}function v(e){return Object(i.c)(this,void 0,void 0,(function(){var t,n;return Object(i.f)(this,(function(i){switch(i.label){case 0:return n={expressionId:e,isOpen:!1,isSearching:!1,searchTerm:"",page:Object(h.a)()?0:1,wordToReplace:"",emojiPickerViewState:{emojiResults:Object(r.a)()}},Object(h.a)()?[4,d()]:[3,2];case 1:return t=i.sent(),[3,3];case 2:t=null,i.label=3;case 3:return[2,(n.gifPickerViewState=t,n.source=null,n.paneType=null,n.numSearchesToInsertEmoji=0,n.emojiCategoryIndex=0,n.shouldRestoreSelectionAfterInsertNode=!1,n.editorAdapter=null,n)]}}))}))}n.d(t,"a",(function(){return m}))},10402:function(e,t,n){"use strict";var i="'Apple Color Emoji','Segoe UI Emoji', NotoColorEmoji,'Segoe UI Symbol','Android Emoji',EmojiSymbols",r="EmojiFont";var o=n(6012),s=n(7130),a=n(102);function c(e){var t,n,c,l=Object(o.a)(e);if(l){var u=document.createElement("span");return u.id=l.codePoint,u.innerText=Object(s.a)(l),Object(a.g)()&&(n=r,(c=(t=u).style.fontFamily)&&c.toLowerCase().indexOf("emoji")<0&&(n+=","+c),n+=","+i,t.style.fontFamily=n),u}return null}var l=n(8014),u=n(8010),d=n(121),h=n(2981),g=n(6013);function f(e,t,n,i){var r=c(e);if(r){t(r);var o=h.a.expressionPickerViewStates.get(i),s=n===g.c;return Object(d.s)("ExpressionPicker_EmojiInserted",[r.id,!s&&""!==o.searchTerm,!1,n===g.b,n===g.e,!s&&0===o.page,o?o.numSearchesToInsertEmoji:0,s]),Object(l.a)(e),o&&Object(u.a)(o),r}return null}n.d(t,"a",(function(){return f}))},11814:function(e,t,n){var i=n(16394),r=n(78);"string"==typeof i&&(i=[[e.i,i]]);for(var o=0;o<i.length;o++)r.loadStyles(i[o][1],!1);i.locals&&(e.exports=i.locals)},16394:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'.U8GSApeDg_c3nvxhEL4SX{max-width:235px;max-height:84px;overflow-y:visible}html[dir] .U8GSApeDg_c3nvxhEL4SX{background-color:"[theme:white, default:#ffffff]";padding:3px}.U8GSApeDg_c3nvxhEL4SX div:first-child{height:100%;overflow:visible!important}._2kyQBf6ntcUm0fPHhfz7Nc{overflow:hidden;max-height:68px}button._3tFF3MCpsfHJUEwJs8Hm6e,button._28MoGMGiAfxrTvILU0xsO1{width:32px;white-space:nowrap;height:32px}html[dir] button._3tFF3MCpsfHJUEwJs8Hm6e,html[dir] button._28MoGMGiAfxrTvILU0xsO1{border-radius:2px;margin:0}html[dir] ._1Qzt-18L0MUkDW3nCtEfpy{background-color:"[theme:neutralLighter, default:#f3f2f1]";margin:-3px;margin-top:3px;padding-bottom:2px}html[dir=ltr] ._1Qzt-18L0MUkDW3nCtEfpy{left:0;padding-left:5px;padding-right:5px}html[dir=rtl] ._1Qzt-18L0MUkDW3nCtEfpy{right:0;padding-right:5px;padding-left:5px}._3tFF3MCpsfHJUEwJs8Hm6e div:first-child,._28MoGMGiAfxrTvILU0xsO1 div:first-child{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;height:100%;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}html[dir=ltr] ._3tFF3MCpsfHJUEwJs8Hm6e div:first-child,html[dir=ltr] ._28MoGMGiAfxrTvILU0xsO1 div:first-child{margin-right:3px}html[dir=rtl] ._3tFF3MCpsfHJUEwJs8Hm6e div:first-child,html[dir=rtl] ._28MoGMGiAfxrTvILU0xsO1 div:first-child{margin-left:3px}html[dir] ._3tFF3MCpsfHJUEwJs8Hm6e._2C_au3JsBJSnWTbDxCY7jo,html[dir] ._3tFF3MCpsfHJUEwJs8Hm6e:hover,html[dir] ._28MoGMGiAfxrTvILU0xsO1._2C_au3JsBJSnWTbDxCY7jo,html[dir] ._28MoGMGiAfxrTvILU0xsO1:hover{background-color:"[theme:neutralLighter, default:#f3f2f1]"}',""]),t.locals={callout:"U8GSApeDg_c3nvxhEL4SX",emojiResults:"_2kyQBf6ntcUm0fPHhfz7Nc",emojiIcon:"_3tFF3MCpsfHJUEwJs8Hm6e",more:"_28MoGMGiAfxrTvILU0xsO1",shortcode:"_1Qzt-18L0MUkDW3nCtEfpy",isSelected:"_2C_au3JsBJSnWTbDxCY7jo"}},18306:function(e,t,n){"use strict";n.r(t);var i=n(1),r=n(5614);function o(e){return Math.min(e.length,r.f)}var s=n(2),a=Object(s.mutatorAction)("updateEmojiSelectedIndex",(function(e,t){var n=o(e.emojiResults)+1,i=(e.selectedEmojiIndex+n+t)%n;e.selectedEmojiIndex=i})),c=Object(s.mutatorAction)("setEmojiResults",(function(e,t){e.emojiResults=t})),l=Object(s.mutatorAction)("setEmojiSelectedIndex",(function(e,t){e.selectedEmojiIndex=t})),u=Object(s.mutatorAction)("setQueryString",(function(e,t){e.queryString=t})),d=n(4367),h=n(8528),g=Object(s.action)("updateInlineSearch",(function(e,t){return{viewState:e,queryString:t}}));Object(s.orchestrator)(g,(function(e){var t=e.viewState,n=e.queryString;u(t,n||""),l(t,0);var i=n?Object(h.a)(n):Object(d.a)();c(t,i)}));var f=g,p=n(121),m=n(10028),v=n(6240),b=n(4534),E=n(8012),y=n(10402),j=n(6012),S=n(10351),w=n(8011),x=n(4808),O=n(11333),I=n(5105),k=300,C=":",P=function(){function e(e,t,n,s){var c=this;this.adapter=e,this.editorAdapter=t,this.useFlexPane=n,this.expressionId=s,this.onIsSuggestingChanged=function(e){Object(m.a)(c.adapter(),e),e||Object(v.a)(c.adapter(),null,0)},this.queryStringUpdated=function(e,t){var n,o,s=c.adapter(),a=s.isSuggesting,l=s.emojiResults;if(a){var u=e.length;if(u<=0)c.handleInlineEmojiSearch(s);else{var d=e.charAt(u-1);if(d===C){var h=e.substring(0,u-1).toLowerCase();try{for(var g=Object(i.k)(l),f=g.next();!f.done;f=g.next()){var p=f.value,m=Object(j.a)(p);if(h===m.description.toLowerCase())return void c.insertEmoji(m.key,"shortcode")}}catch(e){n={error:e}}finally{try{f&&!f.done&&(o=g.return)&&o.call(g)}finally{if(n)throw n.error}}}else if(t&&Object(O.b)(d)){var v=Object(O.a)(r.c+e);if(v)return void c.insertEmoji(v,"shortcut")}c.resetTimer(),c.timer=setTimeout((function(){s.isSuggesting&&c.handleInlineEmojiSearch(s,e),c.timer=null}),k)}}},this.selectOption=function(){var e=c.adapter(),t=e.selectedEmojiIndex,n=e.emojiResults;if(t<o(n)){var i=n[t];c.insertEmoji(i,"inlinePicker")}else c.openExpressionPicker()},this.onRemove=function(e,t){return null},this.setCursorPoint=function(e,t){Object(v.a)(c.adapter(),e,t),Object(p.s)("ExpressionPicker_EmojiInlinePickerOpened")},this.shiftHighlight=function(e){var t=e?1:-1;a(c.adapter(),t)},this.getSelectedIndex=function(){return c.adapter().selectedEmojiIndex},this.onScroll=function(){c.adapter().isSuggesting&&c.setIsSuggesting(!1)},this.insertEmoji=function(e,t){var n=Object(y.a)(e,c.insertNode,"inlineSearch",c.expressionId);n&&(Object(p.s)("ExpressionPicker_EmojiInsertedFromInlinePicker",[n.id,""!==c.adapter().queryString,t]),c.setIsSuggesting(!1))},this.openExpressionPicker=function(){x.b.importAndExecute(c.useFlexPane,c.adapter().queryString,"inlineSearch",c.editorAdapter,c.expressionId,c.targetWindow),c.setIsSuggesting(!1)},this.handleInlineEmojiSearch=function(e,t){return Object(i.c)(c,void 0,void 0,(function(){var n,r,o,s,a;return Object(i.f)(this,(function(i){switch(i.label){case 0:return[4,Object(S.a)(this.expressionId)];case 1:return n=i.sent(),f(e,t),r=e.emojiResults,Object(I.a)()&&t?[4,Object(w.a)(n.gifPickerViewState,t,E.b)]:[3,3];case 2:return s=i.sent(),[3,4];case 3:s=null,i.label=4;case 4:return o=s,a=(null==r?void 0:r.length)>0||(null==o?void 0:o.length)>0,this.setIsSuggesting(a),[2]}}))}))}}return e.prototype.onInitalize=function(e,t,n){var i;window.addEventListener("resize",this.onScroll),this.insertNode=e,this.setIsSuggesting=t,this.targetWindow=null===(i=null==n?void 0:n.getDocument())||void 0===i?void 0:i.defaultView},e.prototype.onDispose=function(){b.a.importAndExecute(this.expressionId,this.targetWindow),window.removeEventListener("resize",this.onScroll),this.resetTimer()},e.prototype.resetTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},e}(),L=n(5227),A=n(20),_=n(1260),D=n(8013),U=n(0),R=n(11814),N=n(378).bind(R),M=Object(A.a)((function(e){var t=e.viewState,n=e.plugin,i=e.currentIndex,o=e.emoji,s=t.selectedEmojiIndex,a=U.useCallback((function(){n.dataProvider.selectOption()}),[]),c=U.useCallback((function(){l(t,i)}),[t,i]);return o?U.createElement("span",{id:r.e+i.toString(),role:"listitem",key:i,onMouseOver:c},U.createElement(D.a,{key:o,name:o,isSelected:s===i,cssClassName:N(R.emojiIcon),onClick:a})):U.createElement(_.a,{className:N(R.more,R.emojiIcon,{isSelected:s===i}),onMouseOver:c,onClick:a,iconProps:{iconName:"More"}})})),T=n(1115),H=n(60),F=n(441),J=n(6),G=n(8015),K=n(11814),B=Object(A.a)((function(e){var t=e.viewState,n=t.targetPoint,s=t.bufferZone,a=o(t.emojiResults);return n?U.createElement(T.a,{className:K.callout,gapSpace:s,target:n,isBeakVisible:!1,setInitialFocus:!1,directionalHint:Object(F.a)()?H.a.bottomRightEdge:H.a.bottomLeftEdge},function(t){var n=e.viewState.emojiResults;return U.createElement("div",{id:r.d,className:K.emojiResults,role:"list"},n.slice(0,r.f).map((function(t,n){return U.createElement(M,Object(i.a)({key:t,currentIndex:n,emoji:t},e))})),U.createElement(M,Object(i.a)({currentIndex:t},e)))}(a),U.createElement("div",{className:K.shortcode},t.selectedEmojiIndex<a?function(e){var t="",n=Object(j.a)(e.emojiResults[e.selectedEmojiIndex]),i=null==n?void 0:n.description;return i&&(t=":"+i.replace(new RegExp(" ","g"),"_")+":"),t}(t):Object(J.b)(G.a))):null})),W=function(e){function t(t,n,i,o){var s=this,a=new P(t,n,i,o),c={elementIdPrefix:r.b,changeSource:r.a,triggerCharacter:r.c,isHorizontal:!0,handleAutoComplete:!0,suggestionsLabel:r.d,suggestionLabelPrefix:r.e};return(s=e.call(this,a,c)||this).adapter=t,s.editorAdapter=n,s}return Object(i.e)(t,e),t.prototype.getUIComponentClass=function(){return B},t.prototype.getName=function(){return"EmojiPicker"},t}(L.PickerPlugin);n.d(t,"EmojiPickerPlugin",(function(){return W}))},4534:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(31),r=new i.c((function(){return Promise.all([n.e(150),n.e(626)]).then(n.bind(null,7124))})),o=new i.a(r,(function(e){return e.closeExpressionPane}))},5227:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(5228))},5228:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5229);t.PickerPlugin=i.default},5229:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2634),r=n(2001),o=r.Browser.isIE?"Esc":"Escape",s=r.Browser.isIE?"Left":"ArrowLeft",a=r.Browser.isIE?"Up":"ArrowUp",c=r.Browser.isIE?"Right":"ArrowRight",l=r.Browser.isIE?"Down":"ArrowDown",u=r.Browser.isIE?"Del":"Delete",d=[0,229],h=function(){function e(e,t){this.dataProvider=e,this.pickerOptions=t,this.isPendingInputEventHandling=!1}return e.prototype.getName=function(){return"Picker"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.dataProvider.onInitalize((function(e){t.editor.focus();var n=t.getWord(null);n&&0!=n.length||!t.lastKnownRange||(t.editor.select(t.lastKnownRange),n=t.getWord(null));t.editor.addUndoSnapshot((function(){n?i.replaceWithNode(t.editor,n,e,!0):t.editor.insertNode(e),t.setIsSuggesting(!1)}),t.pickerOptions.changeSource,t.pickerOptions.handleAutoComplete)}),(function(e){t.setIsSuggesting(e)}),e)},e.prototype.dispose=function(){this.editor=null,this.dataProvider.onDispose()},e.prototype.willHandleEventExclusively=function(e){return this.isSuggesting&&(0==e.eventType||2==e.eventType||3==e.eventType)},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 7:if("SetContent"==e.source&&this.dataProvider.onContentChanged){this.isSuggesting&&this.setIsSuggesting(!1);var t=[];this.editor.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",(function(e){e.id&&t.push(e.id)})),this.dataProvider.onContentChanged(t)}break;case 0:this.eventHandledOnKeyDown=!1,this.isAndroidKeyboardEvent(e)?(this.currentInputLength=this.calcInputLength(e),this.isPendingInputEventHandling=!0):(this.onKeyDownEvent(e),this.isPendingInputEventHandling=!1);break;case 3:this.isPendingInputEventHandling&&this.onAndroidInputEvent(e);break;case 2:!this.eventHandledOnKeyDown&&this.shouldHandleKeyUpEvent(e)&&(this.onKeyUpDomEvent(e),this.isPendingInputEventHandling=!1);break;case 6:this.isSuggesting&&this.setIsSuggesting(!1);break;case 14:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer)}},e.prototype.setLastKnownRange=function(e){this.lastKnownRange=e},e.prototype.setIsSuggesting=function(e){this.isSuggesting=e,e||this.setLastKnownRange(null),this.dataProvider.onIsSuggestingChanged(e),this.setAriaOwns(e),this.setAriaActiveDescendant(e?0:null)},e.prototype.cancelDefaultKeyDownEvent=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},e.prototype.getIdValue=function(e){var t=e;return t.attributes&&t.attributes.getNamedItem("id")?t.attributes.getNamedItem("id").value:null},e.prototype.getWordBeforeCursor=function(e){var t=this.editor.getContentSearcherOfCursor(e);return t?t.getWordBefore():null},e.prototype.replaceNode=function(e,t){e&&this.editor.deleteNode(e),t&&this.editor.insertNode(t)},e.prototype.getRangeUntilAt=function(e){var t,n,i=this;return this.editor.getContentSearcherOfCursor(e).forEachTextInlineElement((function(e){for(var r=!1,o=e.getTextContent(),s=o?o.length:-1;s>=0;){if(o[s]==i.pickerOptions.triggerCharacter){t=e.getStartPosition().move(s),r=!0;break}s--}return r&&(n=e.getEndPosition()),r})),r.createRange(t,n)||this.editor.getDocument().createRange()},e.prototype.shouldHandleKeyUpEvent=function(e){return this.isAndroidKeyboardEvent(e)||r.isCharacterValue(e.rawEvent)||this.isSuggesting&&!r.isModifierKey(e.rawEvent)},e.prototype.onKeyUpDomEvent=function(e){if(this.isSuggesting){var t=(i=(n=this.getWord(e)).substring(1)).trim();n==this.pickerOptions.triggerCharacter||t&&t.length>0&&t.split(" ").length<=4?(this.dataProvider.queryStringUpdated(t,i==t),this.setLastKnownRange(this.editor.getSelectionRange())):this.setIsSuggesting(!1)}else{var n=this.getWordBeforeCursor(e);if(this.blockSuggestions)null!=n&&n[0]!=this.pickerOptions.triggerCharacter&&(this.blockSuggestions=!1);else if(null!=n&&n.split(" ").length<=4&&n[0]==this.pickerOptions.triggerCharacter){this.setIsSuggesting(!0);var i;t=(i=n.substring(1)).trim();if(this.dataProvider.queryStringUpdated(t,i==t),this.setLastKnownRange(this.editor.getSelectionRange()),this.dataProvider.setCursorPoint){var r=this.editor.getContentSearcherOfCursor(e),o=this.editor.getDocument().createRange(),s=r.getInlineElementBefore().getContainerNode();if(!this.setRangeStart(o,s,n)){var a=s.previousSibling;this.setRangeStart(o,a,this.pickerOptions.triggerCharacter)}var c=o.getBoundingClientRect();if(0==c.left&&0==c.bottom&&0==c.top&&(c=o.getClientRects()[0]),c){o.detach();var l={x:c.left,y:(c.bottom+c.top)/2},u=(c.bottom-c.top)/2;this.dataProvider.setCursorPoint(l,u)}}}}},e.prototype.onKeyDownEvent=function(e){var t=e.rawEvent;if(this.isSuggesting)if(t.key==o)this.setIsSuggesting(!1),this.blockSuggestions=!0,this.cancelDefaultKeyDownEvent(e);else if("Backspace"==t.key){this.getWord(e)==this.pickerOptions.triggerCharacter&&this.setIsSuggesting(!1)}else this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?t.key==s||t.key==c:t.key==a||t.key==l)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?t.key==c:t.key==l),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=t.key&&"Tab"!=t.key||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e));else if("Backspace"==t.key)this.tryRemoveNode(e)&&this.cancelDefaultKeyDownEvent(e);else if(t.key==u){var n=this.editor.getContentSearcherOfCursor(e),i=n.getInlineElementAfter()?n.getInlineElementAfter().getContainerNode():null,r=i?this.getIdValue(i):null;if(r&&0==r.indexOf(this.pickerOptions.elementIdPrefix)){var d=this.dataProvider.onRemove(i,!1);this.replaceNode(i,d),this.cancelDefaultKeyDownEvent(e)}}},e.prototype.onAndroidInputEvent=function(e){(this.newInputLength=this.calcInputLength(e),this.newInputLength<this.currentInputLength||"deleteContentBackwards"===e.rawEvent.inputType)&&(this.tryRemoveNode(e)&&(this.eventHandledOnKeyDown=!0))},e.prototype.calcInputLength=function(e){var t=this.getInlineElementBeforeCursor(e);return t?t.length:0},e.prototype.tryRemoveNode=function(e){var t=this.editor.getContentSearcherOfCursor(e),n=t.getInlineElementBefore(),i=n?n.getContainerNode():null,o=i?this.getIdValue(i):null,s=t.getInlineElementAfter();if(o&&0==o.indexOf(this.pickerOptions.elementIdPrefix)&&(null==s||!(s instanceof r.PartialInlineElement))){var a=this.dataProvider.onRemove(i,!0);return a?(this.replaceNode(i,a),this.isPendingInputEventHandling?this.editor.runAsync((function(e){e.select(a,-3)})):this.editor.select(a,-3)):this.editor.deleteNode(i),!0}return!1},e.prototype.getWord=function(e){var t=this.getRangeUntilAt(e).toString(),n=this.getWordBeforeCursor(e);return t==this.pickerOptions.triggerCharacter&&t!=n?n:t},e.prototype.setRangeStart=function(e,t,n){var i=t?t.textContent.lastIndexOf(n):-1;return i>-1&&(e.setStart(t,i),!0)},e.prototype.setAriaOwns=function(e){this.editor.setEditorDomAttribute("aria-owns",e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null)},e.prototype.setAriaActiveDescendant=function(e){this.editor.setEditorDomAttribute("aria-activedescendant",null!=e&&this.pickerOptions.suggestionLabelPrefix?this.pickerOptions.suggestionLabelPrefix+e.toString():null)},e.prototype.getInlineElementBeforeCursor=function(e){var t=this.editor.getContentSearcherOfCursor(e),n=t?t.getInlineElementBefore():null;return n?n.getTextContent():null},e.prototype.isAndroidKeyboardEvent=function(e){return"Unidentified"==e.rawEvent.key||null==e.rawEvent.key&&d.indexOf(e.rawEvent.charCode)>-1},e}();t.default=h},6012:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(1),r=n(7129),o=n(14),s=Object(o.computed)((function(){var e,t,n={};try{for(var o=Object(i.k)(Object(r.a)()),s=o.next();!s.done;s=o.next()){var a=s.value;n[a.key]=a}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return n}));function a(e){return s.get()[e]}},6240:function(e,t,n){"use strict";var i=n(2);t.a=Object(i.mutatorAction)("Picker_SetTargetPoint",(function(e,t,n){e.targetPoint=t,e.bufferZone=n}))},7130:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(2981),r=n(102);function o(e){if(!Object(r.g)()&&i.a.selectedSkinTone&&e.hasSkinTone){var t=e.codePoint.charAt(0)+e.codePoint.charAt(1);return e.codePoint.replace(t,t+i.a.selectedSkinTone)}return e.codePoint}},8013:function(e,t,n){"use strict";var i=n(20),r=n(1550),o=n(6012),s=n(7130),a=n(0),c=n(66),l=n(9019),u=n(378).bind(l),d=Object(i.a)((function(e){var t=e.name,n=e.onClick,i=e.onKeyDown,d=e.isSelected,h=e.cssClassName,g=u(l.icon,h,{isSelected:d}),f=a.useCallback((function(){return n(t)}),[t]),p=a.useCallback((function(e){e.keyCode!==c.a.enter&&e.keyCode!==c.a.space||(e.stopPropagation(),i&&i(t))}),[t]),m=Object(o.a)(t);return m?a.createElement(r.a,{className:g,onClick:f,onKeyDown:p,text:Object(s.a)(m),"data-is-focusable":!0}):null}));t.a=d},8014:function(e,t,n){"use strict";var i=n(1),r=n(6),o=n(19),s=n(451),a=n(4608),c=n(183);t.a=Object(c.action)("addEmojiToMru")((function(e){var t,n;if(e){var c=Object(r.c)("csimg image-emoji_{0}-png",e),l=[c],u=Object(o.a)().UserOptions.MruEmojis;if(u&&u.length>0)try{for(var d=Object(i.k)(u),h=d.next();!h.done;h=d.next()){var g=h.value;if(g!=c&&(l.push(g),l.length>=a.a))break}}catch(e){t={error:e}}finally{try{h&&!h.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}Object(s.a)((function(e){e.UserOptions.MruEmojis=l}),[{key:"MruEmojis",valuetype:"StringArray",value:l}])}}))},8015:function(e){e.exports=JSON.parse('{"a":"c5b"}')},9019:function(e,t,n){var i=n(9020),r=n(78);"string"==typeof i&&(i=[[e.i,i]]);for(var o=0;o<i.length;o++)r.loadStyles(i[o][1],!1);i.locals&&(e.exports=i.locals)},9020:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._1mjdyFL9XrIOlG5LJwQNh1{height:32px;width:32px;cursor:pointer;font-family:EmojiFont,Apple Color Emoji,Segoe UI Emoji,NotoColorEmoji,Segoe UI Symbol,Android Emoji,EmojiSymbols!important;font-size:17px;-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto}html[dir] ._1mjdyFL9XrIOlG5LJwQNh1{background:transparent;border-width:0;padding:0}html[dir=ltr] ._1mjdyFL9XrIOlG5LJwQNh1{margin:4px 4px 0 0}html[dir=rtl] ._1mjdyFL9XrIOlG5LJwQNh1{margin:4px 0 0 4px}html[dir] ._1mjdyFL9XrIOlG5LJwQNh1:hover{background-color:"[theme:neutralLighter, default:#f3f2f1]"}html[dir] ._1mjdyFL9XrIOlG5LJwQNh1._3pNvbVIt_gPsOLRlRrQSf0{background-color:"[theme:themeLighter, default:#DEECF9]"}._1mjdyFL9XrIOlG5LJwQNh1>div{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;font-family:EmojiFont,Apple Color Emoji,Segoe UI Emoji,NotoColorEmoji,Segoe UI Symbol,Android Emoji,EmojiSymbols!important}',""]),t.locals={icon:"_1mjdyFL9XrIOlG5LJwQNh1",isSelected:"_3pNvbVIt_gPsOLRlRrQSf0"}}}]);
//# sourceMappingURL=owa.MailBoot~EmojiPickerPlugin.js.map
self.scriptsLoaded['owa.MailBoot~EmojiPickerPlugin.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~EmojiPickerPlugin.js'] = (new Date()).getTime();