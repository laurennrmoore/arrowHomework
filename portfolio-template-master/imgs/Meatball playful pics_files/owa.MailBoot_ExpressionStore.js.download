self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ExpressionStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[626],{1080:function(e,n,t){"use strict";var a=t(31),i=t(1259),o=t(198),r=t(2),s=[o.b.SurfaceActions];Object(r.orchestrator)(i.a,(function(e){var n=e.defaultOptions;s.forEach((function(e){n[e]&&Object(o.g)(Number(e),n[e])}))}));var c=t(980),d=t(1249);t.d(n,"h",(function(){return l})),t.d(n,"k",(function(){return f})),t.d(n,"i",(function(){return p})),t.d(n,"j",(function(){return b})),t.d(n,"e",(function(){return c.a})),t.d(n,"f",(function(){return o.e})),t.d(n,"d",(function(){return o.c})),t.d(n,"c",(function(){return o.b})),t.d(n,"a",(function(){return o.a})),t.d(n,"b",(function(){return d.a})),t.d(n,"g",(function(){return d.b}));var u=new a.c((function(){return t.e(960).then(t.bind(null,18362))})),l=new a.a(u,(function(e){return e.createOrUpdateOptionsForFeature})),f=new a.a(u,(function(e){return e.updateAddinPinStatus})),p=(new a.a(u,(function(e){return e.updateAddInArray})),new a.b(u,(function(e){return e.getServerOptionsForFeature}))),b=new a.a(u,(function(e){return e.loadOptions}))},1249:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return r}));var a,i=t(2);!function(e){e[e.OptionsNotLoaded=0]="OptionsNotLoaded",e[e.OptionsLoading=1]="OptionsLoading",e[e.OptionsLoaded=2]="OptionsLoaded"}(a||(a={}));var o={loadState:a.OptionsNotLoaded},r=Object(i.createStore)("owsOptionsLoadStateStore",o)},1259:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(2),i=t(980),o=Object(a.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",(function(e){return void 0===e&&(e=Object(i.a)()),{defaultOptions:e}}))},198:function(e,n,t){"use strict";var a,i,o,r=t(2),s=Object(r.action)("setOptionValue",(function(e,n){return{feature:e,value:n}})),c=Object(r.action)("assignOptionValue",(function(e,n){return{feature:e,value:n}})),d=Object(r.action)("verifyAndSetOptionValues",(function(e){return{potentialOptionValues:e}})),u=Object(r.action)("setOptionValue",(function(e,n){return{feature:e,value:n}})),l=t(1);!function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance",e[e.ActivityFeed=19]="ActivityFeed",e[e.AmpDeveloper=20]="AmpDeveloper",e[e.CalendarHelp=21]="CalendarHelp",e[e.LinkedInViewProfile=22]="LinkedInViewProfile",e[e.Bohemia=23]="Bohemia",e[e.GdprAdsV2=24]="GdprAdsV2",e[e.Proofing=25]="Proofing",e[e.ActiveProxyAddress=26]="ActiveProxyAddress",e[e.OutlookSpaces=27]="OutlookSpaces",e[e.GdprAdsV3=28]="GdprAdsV3",e[e.SxS=29]="SxS",e[e.ReadingPaneConversation=30]="ReadingPaneConversation",e[e.AdsAggregate=31]="AdsAggregate",e[e.ListViewColumnHeaders=32]="ListViewColumnHeaders",e[e.MailLayoutOptions=33]="MailLayoutOptions",e[e.Commanding=34]="Commanding"}(a||(a={})),function(e){e[e.EditInBrowser=0]="EditInBrowser",e[e.EditInDesktop=1]="EditInDesktop",e[e.EditAndReply=2]="EditAndReply"}(i||(i={}));var f=Object(r.createStore)("owsOptionsStore",{options:(o={},o[a.SmartSuggestions]={feature:a.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},o[a.DiverseEmojis]={feature:a.DiverseEmojis,diverseEmojisSelectedSkinTone:""},o[a.SurfaceActions]={feature:a.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},o[a.SkypeNotifications]={feature:a.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},o[a.WebPushNotifications]={feature:a.WebPushNotifications,enabled:!1,applicationServerKey:null},o[a.Confetti]={feature:a.Confetti,confettiEnabled:!1},o[a.GdprAdsV3]={feature:a.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},o[a.CalendarSurfaceAddins]={feature:a.CalendarSurfaceAddins,calendarSurfaceAddins:[]},o[a.ExternalImages]={feature:a.ExternalImages,externalImagesSelectedOption:null},o[a.EventCapture]={autoCollectionEnabled:!1},o[a.Translation]={feature:a.Translation,translationMode:0,targetLanguage:"",excludedLanguages:[]},o[a.CalendarSurfaceOptions]={feature:a.CalendarSurfaceOptions,agendaPaneIsClosed:!0,lastKnownRoamingTimeZone:void 0,roamingTimeZoneNotificationsIsDisabled:void 0,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},o[a.MentionEventNotifications]={feature:a.MentionEventNotifications,enabled:!1},o[a.TxpEventNotifications]={feature:a.TxpEventNotifications,enabled:!1},o[a.ComposeAssistance]={feature:a.ComposeAssistance,composeAssistanceEnabled:!1},o[a.AmpDeveloper]={feature:a.AmpDeveloper,enabled:!0,allowedSender:[]},o[a.ActivityFeed]={feature:a.ActivityFeed,OWASurfaceOptions:{SupportedTypes:[],DisabledInFeedPanel:[]}},o[a.LinkedInViewProfile]={dismissed:!1},o[a.CalendarHelp]={feature:a.CalendarHelp,calendarHelpEnabled:!1},o[a.Bohemia]={feature:a.Bohemia,bohemiaEnabled:!1,fluidEnabledForTenant:!1},o[a.Proofing]={feature:a.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!1,proofingLocale:void 0,overriddenOptions:void 0},o[a.ActiveProxyAddress]={feature:a.ActiveProxyAddress,activeProxyAddresses:[]},o[a.OutlookSpaces]={feature:a.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},o[a.SxS]={feature:a.SxS,hideReadingPane:!1,defaultEditCommand:i.EditInBrowser},o[a.ReadingPaneConversation]={feature:a.ReadingPaneConversation,conversationEnabled:!0,conversationEnabledNativeHost:!1},o)}),p=t(14);function b(e){return(null==e?void 0:e.feature)in a}var S,v=t(319);function A(e,n){f().options[e]=n}function g(e){return f().options[e]}Object(r.mutator)(c,(function(e){var n=e.feature,t=e.value;v(f().options[n],t)})),Object(r.mutator)(s,(function(e){A(e.feature,e.value)})),Object(r.mutator)(u,(function(e){var n=e.feature,t=e.value;Object(p.extendObservable)(f().options[n],t)})),Object(r.mutator)(d,(function(e){var n,t,a=e.potentialOptionValues;try{for(var i=Object(l.k)(a),o=i.next();!o.done;o=i.next()){var r=o.value;r&&b(r)&&A(r.feature,r)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(n)throw n.error}}})),function(e){e[e.Work=1]="Work",e[e.Life=2]="Life"}(S||(S={})),t.d(n,"h",(function(){return s})),t.d(n,"d",(function(){return c})),t.d(n,"i",(function(){return d})),t.d(n,"g",(function(){return u})),t.d(n,"f",(function(){return f})),t.d(n,"e",(function(){return g})),t.d(n,"c",(function(){return S})),t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return i}))},2981:function(e,n,t){"use strict";var a=t(14),i=t(2),o=t(1080),r={expressionPickerViewStates:new a.ObservableMap,selectedSkinTone:Object(o.f)(o.c.DiverseEmojis).diverseEmojisSelectedSkinTone,useFlexPane:null,isSxSDisplayed:null,primaryExpressionId:null},s=Object(i.createStore)("expression",r)();n.a=s},3563:function(e,n,t){"use strict";t.d(n,"b",(function(){return o})),t.d(n,"a",(function(){return r}));var a=t(31),i=new a.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(6),t.e(640)]).then(t.bind(null,5379))})),o=new a.a(i,(function(e){return e.mountAndShowFlexPane})),r=new a.a(i,(function(e){return e.hideFlexPane}))},4609:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.action)("toggleExpressionSidePane",(function(e){return{showExpressionPane:e}}))},5546:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.mutatorAction)("updateExpressionPage",(function(e,n){if(e.page.toString()!=n)switch(n){case"0":e.page=0;break;case"1":e.page=1;break;case"2":e.page=2}}))},6011:function(e,n,t){"use strict";var a=t(183);n.a=Object(a.action)("setExpressionPickerIsOpen")((function(e,n){e.isOpen=n}))},6499:function(e,n,t){"use strict";var a=t(183);n.a=Object(a.action)("setEmojiCategoryIndex")((function(e,n){e.emojiCategoryIndex=n}))},7124:function(e,n,t){"use strict";t.r(n);var a=t(8558);t.d(n,"closeExpressionPane",(function(){return a.a}))},7125:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.mutatorAction)("setExpressionPickerOpenedSource",(function(e,n){e.source=n}))},7126:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.mutatorAction)("setShouldRestoreSelectionAfterInsertNode",(function(e,n){e.shouldRestoreSelectionAfterInsertNode=n}))},7127:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.mutatorAction)("setWordToReplace",(function(e,n){e.wordToReplace=n}))},7128:function(e,n,t){"use strict";var a=t(1),i=t(4367),o=t(8528),r=t(8011),s=t(183);n.a=Object(s.action)("updateSearch")((function(e,n,t,s){return Object(a.c)(this,void 0,void 0,(function(){var c;return Object(a.f)(this,(function(a){switch(a.label){case 0:return n===e.searchTerm?[2]:(e.isSearching=!0,e.searchTerm=n,n?e.gifPickerViewState?(c=e.gifPickerViewState,[4,Object(r.a)(e.gifPickerViewState,n,t,s)]):[3,2]:[3,3]);case 1:c.gifResults=a.sent(),a.label=2;case 2:return e.emojiPickerViewState.emojiResults=Object(o.a)(n),2!==e.page&&e.numSearchesToInsertEmoji++,[3,4];case 3:e.gifPickerViewState&&(e.gifPickerViewState.gifResults=null),e.emojiPickerViewState.emojiResults=Object(i.a)(),a.label=4;case 4:return e.isSearching=!1,[2]}}))}))}))},8558:function(e,n,t){"use strict";var a=t(6499),i=t(6011),o=t(7125),r=t(7126),s=t(7127),c=t(5546),d=t(8010),u=t(2981),l=t(183),f=t(1080),p=t(121),b=Object(l.action)("saveEmojiSkinToneToServer")((function(e){var n=Object(f.f)(f.c.DiverseEmojis);if(n.diverseEmojisSelectedSkinTone!=u.a.selectedSkinTone){n.diverseEmojisSelectedSkinTone=u.a.selectedSkinTone;var t=f.h.importAndExecute(f.c.DiverseEmojis,n);if(e){var a="ExpressionPicker_EmojiSkinToneSavedToServer";t.then((function(){Object(p.s)(a,[!0])})).catch((function(e){Object(p.s)(a,[!1,u.a.selectedSkinTone,S(e.toString())])}))}}}));function S(e){switch(e){case"Options are not loaded. Cannot update options.":return 0;case"Error: Error processing options response":return 1;default:return 2}}var v=t(7128),A=t(5105),g=t(102),m=t(2),O=Object(m.action)("resetExpressionPickerViewState",(function(e){return{viewState:e}}));Object(m.orchestrator)(O,(function(e){var n=e.viewState;Object(i.a)(n,!1),n.searchTerm&&Object(v.a)(n,"",null),Object(c.a)(n,Object(A.a)()?(0).toString():1..toString()),Object(s.a)(n,""),Object(d.a)(n),Object(a.a)(n,0),Object(o.a)(n,null),Object(r.a)(n,!1),Object(g.g)()||b(!0)}));var P=O,w=t(4609),E=t(3563),j=t(514);function C(e,n){var t=u.a.expressionPickerViewStates.get(e||u.a.primaryExpressionId);(null==t?void 0:t.isOpen)&&(Object(i.a)(t,!1),P(t),u.a.useFlexPane?Object(j.w)()||n&&n!==window?E.a.importAndExecute(n):window.O365Shell.FlexPane.CloseFlexPaneForProvider("Expressions"):Object(w.a)(!1))}t.d(n,"a",(function(){return C}))},980:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(24),i=t(197),o=t(198);function r(){var e;return(e={})[o.b.AdsAggregate]={feature:o.b.AdsAggregate,nativeAdsSeenRunningSum:0,nativeAdsClickedRunningSum:0,nativeCPMRunningSum:0,wasAdSeenInLastSession:!1,startOfAdFreeTrial:""},e[o.b.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[o.b.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[o.b.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(i.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddClassicAttachment","InsertLink","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","QuickUse","ToggleRibbon","FluidHeroButton"],composeSurfaceAddins:[]},e[o.b.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[o.b.Confetti]={confettiEnabled:!0},e[o.b.ComposeAssistance]={composeAssistanceEnabled:!0},e[o.b.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[o.b.ExternalImages]={externalImagesSelectedOption:0},e[o.b.EventCapture]={autoCollectionEnabled:!1},e[o.b.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[o.b.CalendarSurfaceOptions]={agendaPaneIsClosed:!1,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},e[o.b.AmpDeveloper]={enabled:Object(a.i)("rp-ampDefault"),allowedSender:[]},e[o.b.CalendarHelp]={calendarHelpEnabled:!1},e[o.b.LinkedInViewProfile]={dismissed:!1},e[o.b.Bohemia]={bohemiaEnabled:Object(a.i)("cmp-prague")},e[o.b.GdprAdsV3]={feature:o.b.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},e[o.b.Proofing]={feature:o.b.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0,overriddenOptions:void 0},e[o.b.ActiveProxyAddress]={feature:o.b.ActiveProxyAddress,activeProxyAddresses:[]},e[o.b.OutlookSpaces]={feature:o.b.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},e[o.b.SxS]={feature:o.b.SxS,hideReadingPane:!1,defaultEditCommand:o.a.EditInBrowser},e[o.b.ReadingPaneConversation]={feature:o.b.ReadingPaneConversation,conversationEnabled:!0,conversationEnabledNativeHost:!1},e[o.b.ListViewColumnHeaders]={feature:o.b.ListViewColumnHeaders,senderColumnWidth:332,subjectColumnWidth:1e3,receivedColumnWidth:80},e[o.b.MailLayoutOptions]={feature:o.b.MailLayoutOptions,useSingleLineMessageListWithRightReadingPane:!1},e}}}]);
//# sourceMappingURL=owa.MailBoot~ExpressionStore.js.map
self.scriptsLoaded['owa.MailBoot~ExpressionStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ExpressionStore.js'] = (new Date()).getTime();