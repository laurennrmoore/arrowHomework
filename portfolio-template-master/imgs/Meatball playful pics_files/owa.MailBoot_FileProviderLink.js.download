self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~FileProviderLink.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[634],{1281:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var t=r(1);function i(e){return Object(t.a)({__type:"FindItemJsonRequest:#Exchange"},e)}},1302:function(e,n,r){"use strict";r.d(n,"a",(function(){return a}));var t=r(33),i=r(1281);function a(e,n){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(t.a)("FindItem",e,n)}},1304:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var t=r(1);function i(e){return Object(t.a)({__type:"FindItemRequest:#Exchange"},e)}},1992:function(e,n,r){"use strict";var t=r(1963),i=r(2210),a=r(6);function c(e){var n;return e>=1073741824?(e/=1073741824,n=Object(a.b)(i.b)):e>=1048576?(e/=1048576,n=Object(a.b)(i.d)):e>=1024?(e/=1024,n=Object(a.b)(i.c)):n=Object(a.b)(i.a),Object(a.c)(n,Math.round(e))}var o,u=r(2061),s=r(24),f=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function d(e){if(!Object(s.i)("doc-attachment-documentThumbnail"))return!1;var n=Object(t.a)(e);return!!n&&f.indexOf(n.toLowerCase())>=0}function p(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return o.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return o.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return o.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(o||(o={}));var l=r(2019);r.d(n,"b",(function(){return t.a})),r.d(n,"c",(function(){return t.b})),r.d(n,"d",(function(){return t.c})),r.d(n,"i",(function(){return c})),r.d(n,"g",(function(){return u.a})),r.d(n,"h",(function(){return d})),r.d(n,"f",(function(){return p})),r.d(n,"e",(function(){return l.b})),r.d(n,"a",(function(){return o}))},2019:function(e,n,r){"use strict";function t(e){return n=e||"",(r=a.exec(n))&&r.length>1&&i[r[1].toLowerCase()];var n,r}r.d(n,"a",(function(){return t})),r.d(n,"b",(function(){return c}));var i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},a=/^\s*([^;\s]*)(?:;|\s|$)/;function c(e){var n="";return Object.entries(i).forEach((function(r){r[1]===e&&(n=r[0])})),n}},2061:function(e,n,r){"use strict";r.d(n,"a",(function(){return u})),r.d(n,"b",(function(){return s}));var t=r(1963),i=r(2019),a=r(102),c=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],o=[".tiff",".tif"];function u(e,n,r){return void 0===r&&(r=!0),s(Object(t.a)(e)||Object(i.a)(n),r)}function s(e,n){return void 0===n&&(n=!0),!!e&&(c.indexOf(e.toLowerCase())>=0||n&&o.indexOf(e.toLowerCase())>=0&&(Object(a.e)()||Object(a.d)()||Object(a.h)()||Object(a.g)()&&!Object(a.l)()))}},2067:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var t=r(1);function i(e){return Object(t.a)({__type:"IndexedPageView:#Exchange"},e)}},2179:function(e,n){e.exports=function(e){return e instanceof Date}},2210:function(e){e.exports=JSON.parse('{"b":"Nea","d":"Oea","c":"Pea","a":"Qea"}')},2243:function(e,n,r){var t=r(2179),i=36e5,a=6e4,c=2,o=/[T ]/,u=/:/,s=/^(\d{2})$/,f=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],d=/^(\d{4})/,p=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],l=/^-(\d{2})$/,v=/^-?(\d{3})$/,m=/^-?(\d{2})-?(\d{2})$/,h=/^-?W(\d{2})$/,b=/^-?W(\d{2})-?(\d{1})$/,w=/^(\d{2}([.,]\d*)?)$/,x=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,g=/([Z+-].*)$/,y=/^(Z)$/,D=/^([+-])(\d{2})$/,k=/^([+-])(\d{2}):?(\d{2})$/;function j(e,n,r){n=n||0,r=r||0;var t=new Date(0);t.setUTCFullYear(e,0,4);var i=7*n+r+1-(t.getUTCDay()||7);return t.setUTCDate(t.getUTCDate()+i),t}e.exports=function(e,n){if(t(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var r=(n||{}).additionalDigits;r=null==r?c:Number(r);var C=function(e){var n,r={},t=e.split(o);u.test(t[0])?(r.date=null,n=t[0]):(r.date=t[0],n=t[1]);if(n){var i=g.exec(n);i?(r.time=n.replace(i[1],""),r.timezone=i[1]):r.time=n}return r}(e),F=function(e,n){var r,t=f[n],i=p[n];if(r=d.exec(e)||i.exec(e)){var a=r[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(r=s.exec(e)||t.exec(e)){var c=r[1];return{year:100*parseInt(c,10),restDateString:e.slice(c.length)}}return{year:null}}(C.date,r),P=F.year,T=function(e,n){if(null===n)return null;var r,t,i,a;if(0===e.length)return(t=new Date(0)).setUTCFullYear(n),t;if(r=l.exec(e))return t=new Date(0),i=parseInt(r[1],10)-1,t.setUTCFullYear(n,i),t;if(r=v.exec(e)){t=new Date(0);var c=parseInt(r[1],10);return t.setUTCFullYear(n,0,c),t}if(r=m.exec(e)){t=new Date(0),i=parseInt(r[1],10)-1;var o=parseInt(r[2],10);return t.setUTCFullYear(n,i,o),t}if(r=h.exec(e))return a=parseInt(r[1],10)-1,j(n,a);if(r=b.exec(e)){a=parseInt(r[1],10)-1;var u=parseInt(r[2],10)-1;return j(n,a,u)}return null}(F.restDateString,P);if(T){var L,S=T.getTime(),I=0;return C.time&&(I=function(e){var n,r,t;if(n=w.exec(e))return(r=parseFloat(n[1].replace(",",".")))%24*i;if(n=x.exec(e))return r=parseInt(n[1],10),t=parseFloat(n[2].replace(",",".")),r%24*i+t*a;if(n=O.exec(e)){r=parseInt(n[1],10),t=parseInt(n[2],10);var c=parseFloat(n[3].replace(",","."));return r%24*i+t*a+1e3*c}return null}(C.time)),C.timezone?L=function(e){var n,r;if(n=y.exec(e))return 0;if(n=D.exec(e))return r=60*parseInt(n[2],10),"+"===n[1]?-r:r;if(n=k.exec(e))return r=60*parseInt(n[2],10)+parseInt(n[3],10),"+"===n[1]?-r:r;return 0}(C.timezone):(L=new Date(S+I).getTimezoneOffset(),L=new Date(S+I+L*a).getTimezoneOffset()),new Date(S+I+L*a)}return new Date(e)}},2416:function(e,n,r){"use strict";r.d(n,"a",(function(){return a})),r.d(n,"c",(function(){return c})),r.d(n,"e",(function(){return o})),r.d(n,"f",(function(){return u})),r.d(n,"d",(function(){return s})),r.d(n,"b",(function(){return f}));var t=r(31),i=new t.c((function(){return r.e(1025).then(r.bind(null,3289))})),a=new t.b(i,(function(e){return e.extractFileUrlFromOfficeSharePointLink})),c=new t.b(i,(function(e){return e.isLinkPrefixedWithBaseUrl})),o=new t.b(i,(function(e){return e.isSharePointLink})),u=new t.b(i,(function(e){return e.isSharePointServiceGeneratedLink})),s=new t.b(i,(function(e){return e.isOfficeSharePointLink})),f=new t.b(i,(function(e){return e.getParsedQueryStringFromUrl}))},6775:function(e,n,r){"use strict";r.r(n);var t=r(3354);function i(e,n){var r=!e.link.scope||e.link.scope===t.a,i=e.link.type===t.e,a=e.link.type===t.d;if(1===n&&!r)throw new Error("CreateSharingLinkFromFileProviderResult: OneDriveConsumer link must use anonymous scope");if(r){if(i)return 4;if(a)return 5;throw new Error("CreateSharingLinkFromFileProviderResult: unexpected type "+e.link.type+" for anonymous link")}switch(e.link.scope){case t.b:if(i)return 2;if(a)return 3;throw new Error("CreateSharingLinkFromFileProviderResult: unexpected type "+e.link.type+" for org link");case t.c:if(i||a)return 6;throw new Error("CreateSharingLinkFromFileProviderResult: unexpected type "+e.link.type+" for PSL");default:throw new Error("CreateSharingLinkFromFileProviderResult: unexpected scope "+e.link.scope+" with type "+e.link.type)}}function a(e,n){switch(e.providerType){case 1:return function(e,n){return{ResultCode:0,FileName:e.name,MimeType:e.isFolder?t.f:e.type,SharingLinkKind:i(n,e.providerType),BlocksDownload:!1,CanShareExternally:!0,CanCreateAnonymousEditLink:!0,CanCreateAnonymousViewLink:!0,ExpirationDate:n.expirationDateTime===t.g?null:n.expirationDateTime,OriginalUrl:null,Type:n.link.type,providerFileId:e.fileId,location:e.location}}(e,n);case 2:case 3:return function(e,n){return{ResultCode:0,FileName:e.name,MimeType:e.isFolder?t.f:e.type,SharingLinkKind:i(n,e.providerType),BlocksDownload:!1,CanShareExternally:!0,ExpirationDate:null,OriginalUrl:null,Type:n.link.type,providerFileId:e.fileId,location:e.location}}(e,n);case 5:return function(e,n){return{ResultCode:0,FileName:e.name,MimeType:e.isFolder?t.f:e.type,SharingLinkKind:i(n,e.providerType),BlocksDownload:!1,CanShareExternally:!0,CanCreateAnonymousEditLink:!0,CanCreateAnonymousViewLink:!0,ExpirationDate:null,OriginalUrl:null,Type:n.link.type,providerFileId:e.fileId}}(e,n);default:throw new Error("createGetSharingInfoResponse does not support "+e.providerType)}}var c=r(1),o=r(121),u=r(2416),s=r(295),f="https://1drv.ms",d="https://www.dropbox.com",p="https://app.box.com",l="https://drive.google.com",v="https://docs.google.com";function m(e){return Object(c.c)(this,void 0,void 0,(function(){return Object(c.f)(this,(function(n){switch(n.label){case 0:return[4,u.c.import()];case 1:return[2,n.sent()(e,f)]}}))}))}function h(e){return Object(c.c)(this,void 0,void 0,(function(){return Object(c.f)(this,(function(n){switch(n.label){case 0:return[4,u.c.import()];case 1:return[2,n.sent()(e,d)]}}))}))}function b(e){return Object(c.c)(this,void 0,void 0,(function(){return Object(c.f)(this,(function(n){switch(n.label){case 0:return[4,u.c.import()];case 1:return[2,n.sent()(e,p)]}}))}))}function w(e){return Object(c.c)(this,void 0,void 0,(function(){var n;return Object(c.f)(this,(function(r){switch(r.label){case 0:return[4,u.c.import()];case 1:return[2,(n=r.sent())(e,l)||n(e,v)]}}))}))}function x(e,n){return Object(c.c)(this,void 0,void 0,(function(){var r,t;return Object(c.f)(this,(function(i){switch(i.label){case 0:switch(r=!1,n){case 0:return[3,1];case 1:return[3,3];case 2:return[3,5];case 3:return[3,7];case 5:return[3,9]}return[3,11];case 1:return[4,u.e.import()];case 2:return t=i.sent(),r=t(e),[3,12];case 3:return[4,m(e)];case 4:return r=i.sent(),[3,12];case 5:return[4,h(e)];case 6:return r=i.sent(),[3,12];case 7:return[4,b(e)];case 8:return r=i.sent(),[3,12];case 9:return[4,w(e)];case 10:return r=i.sent(),[3,12];case 11:throw new Error("checkSharingLinkUrlDomain do not support "+n);case 12:return r||function(e,n){var r=Object(s.parse)(e).hostname;Object(o.s)("FileProviderSharingLinkUnknownDomain",{},{cosmosOnlyData:JSON.stringify({unknownDomain:r,fileProviderType:n})})}(e,n),[2]}}))}))}var O=r(24),g=r(3340);function y(e){return Object(c.c)(this,void 0,void 0,(function(){return Object(c.f)(this,(function(n){switch(n.label){case 0:return[4,u.e.import()];case 1:return n.sent()(e)?[2,g.a.OneDrivePro]:[4,u.d.import()];case 2:return n.sent()(e)?[2,g.a.OfficeOneDrivePro]:[4,m(e)];case 3:return n.sent()?[2,g.a.OneDriveConsumer]:Object(O.i)("doc-link-filePicker")?[4,h(e)]:[2,null];case 4:return n.sent()?[2,g.a.Dropbox]:[4,b(e)];case 5:return n.sent()?[2,g.a.Box]:[4,w(e)];case 6:return n.sent()?[2,g.a.GDrive]:[2,null]}}))}))}var D=r(94);function k(e){switch(e){case g.a.OneDrivePro:case g.a.OfficeOneDrivePro:return!0;case g.a.OneDriveConsumer:case g.a.Dropbox:case g.a.Box:case g.a.GDrive:return!1;default:Object(D.a)(e)}}function j(e){switch(e){case g.a.OneDrivePro:case g.a.OfficeOneDrivePro:return 0;case g.a.OneDriveConsumer:return 1;case g.a.Dropbox:return 2;case g.a.Box:return 3;case g.a.GDrive:return 5;default:return Object(D.a)(e)}}function C(e){switch(e){case 0:return g.a.OneDrivePro;case 1:return g.a.OneDriveConsumer;case 2:case 9:return g.a.Dropbox;case 3:case 7:return g.a.Box;case 5:return g.a.GDrive;default:throw new Error("Link does not support "+e)}}r.d(n,"createGetSharingInfoResponse",(function(){return a})),r.d(n,"checkSharingLinkUrlDomain",(function(){return x})),r.d(n,"getLinkProviderType",(function(){return y})),r.d(n,"isOneDriveProRelatedLink",(function(){return k})),r.d(n,"convertToAttachmentDataProviderType",(function(){return j})),r.d(n,"convertToLinkProviderType",(function(){return C}))},981:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var t=r(1);function i(e){return Object(t.a)({__type:"ItemResponseShape:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.MailBoot~FileProviderLink.js.map
self.scriptsLoaded['owa.MailBoot~FileProviderLink.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~FileProviderLink.js'] = (new Date()).getTime();