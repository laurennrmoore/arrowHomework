self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~FolderOperationNode.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[646],{1253:function(e,n,t){"use strict";n.a=function(e,n,t){return e==e&&(void 0!==t&&(e=e<=t?e:t),void 0!==n&&(e=e>=n?e:n)),e}},14251:function(e){e.exports=JSON.parse('{"a":"q8b","b":"r8b","c":"s8b"}')},18526:function(e,n,t){"use strict";t.r(n);var i=t(1),a=t(2902),r=t(57),o=t(0),c=t(4148),u=t(20),l=t(6963),d=t(378).bind(l),s=Object(u.a)((function(e){return o.createElement(a.a,{className:d(Object(r.d)(),l.nodeHeight),depth:e.nestDepth,defaultValue:e.defaultValue,key:"folderTextField",onEntry:e.onEntry,onDismiss:f,folderId:e.folderId})}));function f(){c.b.importAndExecute()}var v=t(14251),b=t(6),m=t(2321),p=t(1959),O=t(6429),k=t(3762),y=t(4353),j=t(5195),N=t(9595),h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"RenameFolder"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"newDisplayName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"renameFolder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"newDisplayName"},value:{kind:"Variable",name:{kind:"Name",value:"newDisplayName"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"DisplayName"}}]}}]}}]};n.default=Object(u.a)((function(e){var n,t=Object(i.g)(o.useState(""),2),a=t[0],r=t[1],u=Object(i.g)(Object(y.a)(N.a),1)[0],l=Object(i.g)(Object(y.a)(h),1)[0],d=o.useCallback((function(n){c.b.importAndExecute();var t=e.folderId;j.a.importAndExecute(u,{parentId:t,displayName:n,mailboxInfo:e.mailboxInfo}),r(Object(b.c)(Object(b.b)(v.b),n))}),[r,e.folderId]),f=o.useCallback((function(n,t){c.b.importAndExecute();var i=e.originalValue,a=(n||"").trim();if(a&&a!==i){l({variables:{id:t,newDisplayName:a,mailboxInfo:e.mailboxInfo},optimisticResponse:{__typename:"Mutation",renameFolder:{id:t,__typename:"MailFolder",DisplayName:a}}});var o=e.ariaAnnouncementLabel||v.c;r(Object(b.c)(Object(b.b)(o),n))}}),[r]),g=o.useCallback((function(n){n.stopPropagation(),n.preventDefault(),Object(k.b)(e.folderId,"new",e.treeType)}),[e.folderId,e.treeType]);return"new"==e.operationType||"newNode"==e.operationType&&Object(O.a)(e.folderId,"new")?n=o.createElement(s,{nestDepth:e.nestDepth,onEntry:d}):"rename"==e.operationType?n=o.createElement(s,{nestDepth:e.nestDepth,onEntry:f,defaultValue:e.originalValue,folderId:e.folderId}):"newNode"!=e.operationType||e.treeType!==p.i&&e.treeType!==p.c&&e.treeType!==p.k||(n=o.createElement(m.a,{displayName:Object(b.b)(v.a),isCustomActionNode:!0,isRootNode:!1,key:"newFolder",onClick:g})),n?o.createElement(o.Fragment,null,n,o.createElement("span",{className:"screenReaderOnly","aria-live":"assertive","aria-atomic":"true"},a)):null}))},2183:function(e,n,t){"use strict";var i=t(1003);n.a=function(e,n){return Object(i.a)(e,n)}},2794:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return r}));var i=t(2),a=Object(i.action)("ON_FILES_FOLDER_SHOWN",(function(e){return{isExpanded:e}})),r=Object(i.action)("FILES_TREE_ROOT_NODE_CLICKED",(function(e){return{isExpanded:e}}))},3382:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var i="filesFolderId"},3552:function(e,n,t){"use strict";var i=t(2);n.a=Object(i.action)("EMPTY_FOLDER_STORE_UPDATE",(function(e,n,t,i){return{folderId:e,clientLastSyncTime:n,deletedItemsFolderId:t,rowKeysToExclude:i}}))},3762:function(e,n,t){"use strict";t.d(n,"b",(function(){return u})),t.d(n,"a",(function(){return l}));var i=t(1951),a=t(183),r=t(2),o=t(2448),c=t(3858),u=Object(a.action)("initiateMailFolderTextField")((function(e,n,t,a){void 0===a&&(a={folderTable:i.d.folderTable,viewState:o.a}),"new"===n&&Object(c.a)(e,!0),a.viewState.folderTextFieldViewState={folderId:e,operation:n,folderNodeType:t}})),l=Object(r.action)("dismissMailFolderTextField")},3858:function(e,n,t){"use strict";var i=t(183),a=t(2457);n.a=Object(i.action)("setFolderViewExpansionState")((function(e,n){Object(a.a)(e).isExpanded=n}))},3939:function(e,n,t){"use strict";var i=t(2),a=Object(i.action)("setFolderSortBy",(function(e,n,t){return{folderId:e,sortColumn:n,sortDirection:t}}));n.a=a},3945:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(0),a=t(4348);function r(e,n){var t={query:e,variables:null==n?void 0:n.variables,context:null==n?void 0:n.context};Object(i.useEffect)((function(){return a.a.addRef(t),function(){return a.a.releaseRef(t)}}))}},3948:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return r}));var i=t(1),a=function(e){var n=e||{},t=n.context||{};return n.fetchPolicy=n.fetchPolicy||"cache-first",Object(i.a)(Object(i.a)({},n),{context:Object(i.a)(Object(i.a)({},t),{isManagedQuery:!0})})},r=function(e){var n=e||{},t=n.context||{};return Object(i.a)(Object(i.a)({},n),{context:Object(i.a)(Object(i.a)({},t),{isManagedQuery:!0})})}},4148:function(e,n,t){"use strict";var i=t(2794),a=t(3939),r=t(4400),o=t(31),c=t(3552),u=t(2423),l=t(731);function d(e,n){return Object(l.b)(e,n,!1,{hideCancelButton:!0})}var s=t(1),f=t(3215),v=t(2657),b=t(2159),m=t(1984),p=t(3809),O=t(19),k=t(1244),y=t(1951),j=t(197);function N(e,n){if(n==Object(k.a)("msgfolderroot"))return!Object(O.a)().UserOptions.IsMailRootFolderTreeCollapsed;var t=e[n];return!t||t.IsExpanded}function h(){return Object(s.c)(this,void 0,void 0,(function(){return Object(s.f)(this,(function(e){switch(e.label){case 0:return[4,Object(y.w)()];case 1:return e.sent(),Object(j.a)()||(Object(O.a)().SessionSettings.HasArchive&&Object(y.A)(),Object(y.B)()),n=Object(f.c)(),Object.keys(n).forEach((function(e){var t=Object(v.a)(e),i=t.sortColumn,a=t.sortDirection,r={isExpanded:N(n,e),sortColumn:i,sortOrder:a,drag:Object(b.a)(),drop:Object(m.a)()};Object(p.a)(e,r)})),[2]}var n}))}))}var g=t(3382),x=t(3147),I=t(2),S=t(4210),E=(Object(I.orchestrator)(S.a,(function(e){h()})),t(3938));Object(I.orchestrator)(i.b,(function(){Object(E.a)(g.a)}));t.d(n,"b",(function(){return w})),t.d(n,"g",(function(){return d})),t.d(n,"e",(function(){return i.b})),t.d(n,"d",(function(){return i.a})),t.d(n,"c",(function(){return h})),t.d(n,"a",(function(){return g.a})),t.d(n,"f",(function(){return a.a}));var F=new o.c((function(){return t.e(923).then(t.bind(null,18319))}));Object(o.f)(r.a,F,(function(e){return e.onNewFolderSuccessOrchestrator})),Object(o.f)(i.a,F,(function(e){return e.onFilesFolderShownOrchestrator})),Object(o.f)(x.a,F,(function(e){return e.onNewFolderRowNotificationOrchestrator})),Object(o.f)(u.a,F,(function(e){return e.markAllAsReadOrchestrator})),Object(o.f)(c.a,F,(function(e){return e.emptyFolderStoreUpdateOrchestrator})),Object(o.f)(a.a,F,(function(e){return e.setFolderSortByOrchestrator}));var w=new o.a(F,(function(e){return e.dismissMailFolderTextField}))},4210:function(e,n,t){"use strict";var i=t(2);n.a=Object(i.action)("SELECT_CATEGORIES_OPTIONS")},4348:function(e,n,t){"use strict";var i=t(1),a=t(2162),r=t(23),o=t(121),c=t(2183),u=500,l=-1;function d(){var e=new Map;return{upsert:function(n){return function(e,n){var t=e.get(n.key)||[],i=s(t,n);return i!==l?t[i]:(t.push(n),e.set(n.key,t),t.length>u&&Object(o.s)("KVMap.TooBig",{size:t.length,name:n.diag(n.key)}),n)}(e,n)},remove:function(n){return function(e,n){var t=e.get(n.key),i=s(t,n);t.splice(i,1)}(e,n)},get:function(n){return function(e,n){var t=e.get(n.key)||[];return t[s(t,n)]}(e,n)},clear:function(){return e.clear()},count:function(){return e.size},forEach:function(n){e.forEach((function(e,t){e.forEach((function(e){return n(e)}))}))}}}function s(e,n){var t=l;return e.some((function(e,i){var a=Object(c.a)(e.variables,n.variables);return a&&(t=i),a})),t}var f=t(1250);function v(e){var n,t,a;try{for(var r=Object(i.k)(e.definitions),o=r.next();!o.done;o=r.next()){var c=o.value;if("OperationDefinition"===c.kind)return c.operation+":"+((null===(a=c.name)||void 0===a?void 0:a.value)||"unknown")}}catch(e){n={error:e}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}return"unknown"}var b=d(),m=d(),p=new Map,O=3e4;function k(e){e.count=e.count?e.count+1:1}function y(e){e.count=e.count?e.count-1:0}function j(e){var n,t,a=new Array;try{for(var o=Object(i.k)(e.key.definitions),c=o.next();!c.done;c=o.next()){var u=c.value;if("OperationDefinition"===u.kind){if("query"!=u.operation&&"mutation"!=u.operation){Object(r.c)("cannot track operation of type "+u.operation);break}u.selectionSet.selections.forEach((function(n){if("Field"===n.kind){var t=n.name.value,i={};(n.arguments||[]).forEach((function(n){var t;if("Variable"===n.value.kind){var a=n.value.name.value;i[a]=null===(t=e.variables)||void 0===t?void 0:t[a]}})),a.push({key:t,variables:i,diag:N,count:0})}}))}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(t=o.return)&&t.call(o)}finally{if(n)throw n.error}}return a}var N=function(e){return e};var h={addRef:function(e){var n=b.upsert({key:e.query,variables:e.variables,context:e.context,diag:v,count:0}),t=j(n).map(m.upsert);k(n),t.forEach(k)},releaseRef:function(e){var n=b.get({key:e.query,variables:e.variables}),t=j(n).map(m.get);y(n),t.forEach(y),0===n.count&&self.setTimeout((function(){return e=n,i=t,void(null===(r=Object(f.a)())||void 0===r||r.then((function(n){if(!e.disposed&&0===e.count){e.sessionId&&(Object(a.c)().activeSet.releaseSession(e.sessionId),p.delete(e.sessionId)),e.disposed=!0,b.remove(e);var t=!1;i.forEach((function(e){if(!e.disposed&&0===e.count){var i={id:"ROOT_QUERY",fieldName:e.key,broadcast:!1};e.variables&&!Object(c.a)({},e.variables)&&(i.args=e.variables),n.cache.evict(i),m.remove(e),t=!0,e.disposed=!0}})),t&&n.cache.gc()}})));var e,i,r}),O)},getSessionId:function(e){var n=b.upsert({key:e.query,variables:e.variables,context:e.context,diag:v,count:0});if(j(n).forEach(m.upsert),!n.sessionId){var t=Object(a.c)().activeSet.createSession();n.sessionId=t,p.set(t,{query:n.key,variables:n.variables,context:n.context})}return n.sessionId},getQueryFromSessionId:function(e){return p.get(e)},resetStateForTests:function(){b.clear(),m.clear(),p.clear()}};t.d(n,"a",(function(){return h})),t.d(n,"b",(function(){return d})),t.d(n,"c",(function(){return v}))},4353:function(e,n,t){"use strict";var i=t(4413),a=t(308),r=t(3945),o=(t(4570),t(3948));function c(e,n){var t=Object(o.a)(n);return Object(r.a)(e,t),Object(a.useMutation)(e,t)}t.d(n,"b",(function(){return i.a})),t.d(n,"a",(function(){return c}))},4400:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(2),a=Object(i.action)("onNewFolderSuccess",(function(e,n,t){return{folderId:e,parentFolderId:n,displayName:t}}))},4413:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var i=t(308),a=t(3945),r=t(4570),o=t(3948);function c(e,n){var t=Object(o.b)(n);return Object(a.a)(e,t),Object(r.a)(e,t),Object(i.useQuery)(e,t)}},4570:function(e,n,t){"use strict";t.d(n,"a",(function(){return f}));var i=t(1),a=t(1987),r=t(4348),o=t(4506),c=t(1250),u=t(210),l=t(121),d=Object(r.b)(),s=!1;function f(e,n){Object(u.a)("nativeResolvers")&&(s||(Object(o.a)().activeSet.registerHandler(v),s=!0))}var v={onActiveSetChanged:function(e){e.forEach((function(e){e.type!==a.HxActiveSetEventType.ObjectChanged&&e.type!==a.HxActiveSetEventType.ObjectDeleted&&e.type!==a.HxActiveSetEventType.CollectionChanged||e.sessionIds.forEach((function(e){var n=r.a.getQueryFromSessionId(e);n&&d.upsert(Object(i.a)(Object(i.a)({},n),{key:n.query,diag:r.c}))}))})),d.count()>0&&self.setTimeout(b,500)}};function b(){return Object(i.c)(this,void 0,void 0,(function(){var e;return Object(i.f)(this,(function(n){switch(n.label){case 0:return[4,Object(c.a)()];case 1:return e=n.sent(),d.forEach((function(n){var t=(Object(r.c)(n.key)||"unknown")+"_requery",i=new l.b("ApolloLiveQuery");i.addCustomData({opName:t}),e.query({query:n.key,variables:n.variables,context:n.context,fetchPolicy:"network-only"}).then((function(e){return i.end()})).catch((function(e){return i.endWithError("ClientError",e)}))})),d.clear(),[2]}}))}))}},5195:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(31),a=new i.a(new i.c((function(){return t.e(1094).then(t.bind(null,7628))})),(function(e){return e.createNewFolder}))},531:function(e,n,t){"use strict";var i=t(311),a=t(303),r="[object Symbol]";n.a=function(e){return"symbol"==typeof e||Object(a.a)(e)&&Object(i.a)(e)==r}},6963:function(e,n,t){var i=t(6964),a=t(78);"string"==typeof i&&(i=[[e.i,i]]);for(var r=0;r<i.length;r++)a.loadStyles(i[r][1],!1);i.locals&&(e.exports=i.locals)},6964:function(e,n,t){(n=e.exports=t(77)(!1)).push([e.i,"._18ze-w-t88rwZv0403rvPg.DBK6RDiFurUg3gg-V45BC{height:40px}._18ze-w-t88rwZv0403rvPg._1PIY0tyZF9nxP3tVebMhJN{height:36px}._18ze-w-t88rwZv0403rvPg._1Bhfu7vneLnaeh4a2UUEcI{height:28px}html[dir] ._1NxbrVecx_6iZABaN-ePoz{padding-bottom:8px}",""]),n.locals={nodeHeight:"_18ze-w-t88rwZv0403rvPg",full:"DBK6RDiFurUg3gg-V45BC",medium:"_1PIY0tyZF9nxP3tVebMhJN",compact:"_1Bhfu7vneLnaeh4a2UUEcI",monarchFavoriteList:"_1NxbrVecx_6iZABaN-ePoz"}},699:function(e,n,t){"use strict";var i=/\s/;var a=function(e){for(var n=e.length;n--&&i.test(e.charAt(n)););return n},r=/^\s+/;var o=function(e){return e?e.slice(0,a(e)+1).replace(r,""):e},c=t(216),u=t(531),l=NaN,d=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,f=/^0o[0-7]+$/i,v=parseInt;n.a=function(e){if("number"==typeof e)return e;if(Object(u.a)(e))return l;if(Object(c.a)(e)){var n="function"==typeof e.valueOf?e.valueOf():e;e=Object(c.a)(n)?n+"":n}if("string"!=typeof e)return 0===e?e:+e;e=o(e);var t=s.test(e);return t||f.test(e)?v(e.slice(2),t?2:8):d.test(e)?l:+e}},731:function(e,n,t){"use strict";t.d(n,"b",(function(){return c}));var i=t(31),a=t(863);t.d(n,"a",(function(){return a.a}));var r=new i.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(5),t.e(32),t.e(215),t.e(596)]).then(t.bind(null,1555))})),o=new i.b(r,(function(e){return e.confirmAction}));function c(e,n,t,i){return o.import().then((function(a){return a(e,n,t,i)}))}},732:function(e,n,t){"use strict";var i=t(312),a=t(861),r=t(292),o=t(531),c=1/0,u=i.a?i.a.prototype:void 0,l=u?u.toString:void 0;n.a=function e(n){if("string"==typeof n)return n;if(Object(r.a)(n))return Object(a.a)(n,e)+"";if(Object(o.a)(n))return l?l.call(n):"";var t=n+"";return"0"==t&&1/n==-c?"-0":t}},861:function(e,n,t){"use strict";n.a=function(e,n){for(var t=-1,i=null==e?0:e.length,a=Array(i);++t<i;)a[t]=n(e[t],t,e);return a}},863:function(e,n,t){"use strict";var i;t.d(n,"a",(function(){return i})),function(e){e[e.ok=0]="ok",e[e.cancel=1]="cancel",e[e.dismiss=2]="dismiss",e[e.continue=3]="continue"}(i||(i={}))},864:function(e,n,t){"use strict";var i=t(732);n.a=function(e){return null==e?"":Object(i.a)(e)}},866:function(e,n,t){"use strict";var i=t(699),a=1/0,r=17976931348623157e292;var o=function(e){return e?(e=Object(i.a)(e))===a||e===-a?(e<0?-1:1)*r:e==e?e:0:0===e?e:0};n.a=function(e){var n=o(e),t=n%1;return n==n?t?n-t:n:0}},9595:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CreateFolder"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createFolder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"parentId"},value:{kind:"Variable",name:{kind:"Name",value:"parentId"}}},{kind:"ObjectField",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FolderId"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AccessDenied"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}}]}}}]);
//# sourceMappingURL=owa.MailBoot~FolderOperationNode.js.map
self.scriptsLoaded['owa.MailBoot~FolderOperationNode.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~FolderOperationNode.js'] = (new Date()).getTime();