self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~GetItemManager.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[650],{10124:function(e,t,r){"use strict";r.d(t,"b",(function(){return u}));var n=r(7630),i=r(24),a=r(1955),o=r(979),u="UserHighlight",s=Object(o.a)({FieldURI:"UserHighlightData"}),c={featureId:u,propertyPaths:[s],isPropertyExistedOnItem:function(e){var t=a.a.items.get(e);return t&&null!=t.userHighlightData},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(i.i)("rp-userMarkup"))return!1;var r=a.a.items.get(e);return r&&!Object(n.a)(r)}};t.a=c},10125:function(e,t,r){"use strict";r.d(t,"c",(function(){return u})),r.d(t,"a",(function(){return s}));var n=r(7630),i=r(24),a=r(1955),o=r(4922),u="UserNote",s="UserNoteData",c={featureId:u,propertyPaths:[o.f],isPropertyExistedOnItem:function(e){var t=a.a.items.get(e);return t&&null!=t.userNoteData},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(i.i)("rp-userMarkup"))return!1;var r=a.a.items.get(e);return r&&!Object(n.a)(r)}};t.b=c},10138:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return s}));var n=r(24),i=r(1955),a=r(449),o="EntityExtraction/ExtractLanguage1.0",u="EntityExtraction/ExtractQuotedTextLanguages1.0",s="InlineTranslationLocale",c=[Object(a.a)({PropertyName:o,DistinguishedPropertySetId:"Common",PropertyType:"String"}),Object(a.a)({PropertyName:u,DistinguishedPropertySetId:"Common",PropertyType:"String"})],d={featureId:s,propertyPaths:c,isPropertyExistedOnItem:function(e){var t=i.a.items.get(e);return(null==t?void 0:t.TranslationData)&&null!=t.TranslationData.itemLocale},shouldGetItemPropertiesFromServer:function(e,t){if(!(Object(n.i)("rp-inlineTranslation")&&0==t||Object(n.i)("rp-inlineTranslation-conversationViewOff")))return!1;var r=i.a.items.get(e);return!!r&&!r.RightsManagementLicenseData}};t.c=d},10139:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return s})),r.d(t,"e",(function(){return c}));var n=r(24),i=r(1955),a=r(449),o="TranslationData",u="TranslationStatus",s="DisplayTranslation",c="InlineTranslationDataAndStatus",d=[Object(a.a)({PropertyName:o,DistinguishedPropertySetId:"Common",PropertyType:"String"}),Object(a.a)({PropertyName:u,DistinguishedPropertySetId:"Common",PropertyType:"String"}),Object(a.a)({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"Boolean"})],l={featureId:c,propertyPaths:d,isPropertyExistedOnItem:function(e){var t=i.a.items.get(e);return(null==t?void 0:t.TranslationData)&&null!=t.TranslationData.translationText},shouldGetItemPropertiesFromServer:function(e,t){return!!(Object(n.i)("rp-inlineTranslation")&&Object(n.i)("tra-cacheTranslation")&&0==t||Object(n.i)("rp-inlineTranslation-conversationViewOff")&&Object(n.i)("tra-cacheTranslation"))}};t.d=l},16999:function(e,t,r){"use strict";r.r(t);var n=r(7833);r.d(t,"getAdditionalPropertiesFromServer",(function(){return n.b})),r.d(t,"getItemProperties",(function(){return n.c})),r.d(t,"cleanUpByItemId",(function(){return n.a}))},18322:function(e,t,r){"use strict";r.r(t);var n=r(7833),i=r(10139),a=r(10138),o=r(1955),u=r(449),s=r(1244),c={featureId:"rp-omeRevocation",propertyPaths:[Object(u.a)({PropertyName:"x-ms-exchange-organization-ome-messagestate",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})],isPropertyExistedOnItem:function(e){return!1},shouldGetItemPropertiesFromServer:function(e){var t,r=o.a.items.get(e);return(null===(t=null==r?void 0:r.ParentFolderId)||void 0===t?void 0:t.Id)===Object(s.a)("sentitems")}},d=r(6722),l=r(1956),f=r(4150),m=r(24),g=r(6155),p=r(2163),v=r(7441),y=r(2054);function b(e,t){var r,n=Object(p.a)(e);if(n){if(1===t||Object(y.a)())return Object(m.i)("mc-smartPillsMessageView");if(0===t&&Object(v.a)(null===(r=n.ConversationId)||void 0===r?void 0:r.Id))return Object(g.a)(n.ConversationId.Id)===e}return!1}var P={featureId:f.a.LanguageAndLocale,propertyPaths:[d.f],isPropertyExistedOnItem:function(e){var t=l.u.items.get(e);return t&&!!t.stampedLanguage},shouldGetItemPropertiesFromServer:b},I={featureId:f.a.SmartDoc,propertyPaths:[d.g],isPropertyExistedOnItem:function(e){var t=l.u.items.get(e);return t&&!!t.SmartDocData},shouldGetItemPropertiesFromServer:b},S={featureId:f.a.SmartReply,propertyPaths:[d.h],isPropertyExistedOnItem:function(e){var t=l.u.items.get(e);return t&&!!t.SmartReplyData},shouldGetItemPropertiesFromServer:b},O={featureId:f.a.SmartTime,propertyPaths:[d.i],isPropertyExistedOnItem:function(e){var t=l.u.items.get(e);return t&&!!t.SmartTimeData},shouldGetItemPropertiesFromServer:b},h=r(9588),j=r(10124),x=r(10125),T=r(8359),w={featureId:"extractedUrl",propertyPaths:[Object(u.a)({PropertyName:T.a,DistinguishedPropertySetId:"Common",PropertyType:"String"}),Object(u.a)({PropertyName:T.b,DistinguishedPropertySetId:"Common",PropertyType:"String"})],isPropertyExistedOnItem:function(e){var t=o.a.items.get(e);return!!(null==t?void 0:t.ExtractedUrlData)},shouldGetItemPropertiesFromServer:function(e){return!0}};function E(){Object(n.d)([i.d,a.c,j.a,x.b,P,I,S,O,h.a,c,w])}r.d(t,"initializeGetItemManagerForRP",(function(){return E}))},1962:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return u}));var n=r(1971),i=r(2),a={tabs:[{id:"primaryTab",type:n.a.Primary,state:2,blink:!1,sxsId:"primaryTab"}],tabBarWidth:0,isOverflowMenuShown:!1},o=Object(i.createStore)("tab",a),u=(o(),o().tabs[0])},1971:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.MailCompose=3]="MailCompose",e[e.FloatingChat=4]="FloatingChat",e[e.SxS=5]="SxS",e[e.CalendarCompose=6]="CalendarCompose"}(n||(n={}))},2036:function(e,t,r){"use strict";r.d(t,"b",(function(){return c}));var n=r(1),i=r(14),a=r(24),o=r(2066),u=r(2),s={conversationReadingPaneViewState:null,loadedItemReadingPaneViewStates:new i.ObservableMap({}),loadedConversationReadingPaneViewStates:new i.ObservableMap({}),itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1,primaryReadingPaneTabId:null,sxsItemId:null},c=Object(u.createStore)("readingpane",s),d=c();o.a.registerReference((function(){var e,t;return Object(a.i)("rp-persistedReadingPaneTabs")?Object(n.j)([],Object(n.g)(d.loadedConversationReadingPaneViewStates.keys())):null===(t=null===(e=d.conversationReadingPaneViewState)||void 0===e?void 0:e.conversationId)||void 0===t?void 0:t.Id})),t.a=d},2043:function(e,t,r){"use strict";var n=r(31),i=r(1962),a=r(2116),o=r(1),u=r(1971);function s(e){var t,r,n=Object(i.a)();try{for(var a=Object(o.k)(n.tabs),s=a.next();!s.done;s=a.next()){var c=s.value;if(c.type!==u.a.Primary&&c.type!==u.a.SxS&&c.data==e)return c}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return null}function c(e){var t,r,n=Object(i.a)();try{for(var a=Object(o.k)(n.tabs),u=a.next();!u.done;u=a.next()){var s=u.value;if(s.sxsId===e)return s.id}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return null}var d=r(2358);function l(e){var t,r,n=Object(d.a)(e);if(n){var a=Object(i.a)();try{for(var u=Object(o.k)(a.tabs),s=u.next();!s.done;s=u.next()){var c=s.value;if(c.id===n)return c.sxsId}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}}return null}function f(e){var t,r,n,a,s=Object(i.a)();try{for(var c=Object(o.k)(s.tabs),d=c.next();!d.done;d=c.next()){var l=d.value;if(l.type!==u.a.Primary&&l.type!==u.a.SxS&&(null===(a=null===(n=l.data)||void 0===n?void 0:n.id)||void 0===a?void 0:a.Id)==e)return!0}}catch(e){t={error:e}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}return!1}var m=r(2122);r(2191);r.d(t,"g",(function(){return p})),r.d(t,"h",(function(){return v})),r.d(t,"i",(function(){return y})),r.d(t,"k",(function(){return b})),r.d(t,"j",(function(){return P})),r.d(t,"e",(function(){return i.a})),r.d(t,"l",(function(){return i.b})),r.d(t,"d",(function(){return a.a})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"f",(function(){return l})),r.d(t,"n",(function(){return f})),r.d(t,"a",(function(){return u.a})),r.d(t,"m",(function(){return m.b}));var g=new n.c((function(){return Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(29),r.e(32),r.e(41),r.e(72),r.e(192),r.e(309),r.e(302),r.e(839)]).then(r.bind(null,18596))})),p=new n.a(g,(function(e){return e.activateTab})),v=new n.a(g,(function(e){return e.addTab})),y=new n.a(g,(function(e){return e.closeTab})),b=new n.a(g,(function(e){return e.setTabIsShown})),P=new n.b(g,(function(e){return e.getTabById}))},2093:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2036),i=r(24),a=r(2442);function o(e){return Object(i.i)("rp-persistedReadingPaneTabs")?Object(n.b)().loadedConversationReadingPaneViewStates.get(e||Object(n.b)().sxsItemId||Object(a.a)()):Object(n.b)().conversationReadingPaneViewState}},2116:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(1),i=r(1971),a=r(1962),o=r(23);function u(){var e,t,r=Object(a.a)();try{for(var u=Object(n.k)(r.tabs),s=u.next();!s.done;s=u.next()){var c=s.value;if(2==c.state&&c.type!=i.a.FloatingChat)return c}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}return o.d("There is no active tab. Something went very wrong."),null}},2122:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return o}));var n=r(1971),i={};function a(e,t){i[n.a[e]]=t}function o(e){return i[n.a[e]]}},2191:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(1962);function i(){return Object(n.a)().tabs.filter((function(e){return 3===e.state}))}},2269:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(988);function i(e){var t;return null===(t=n.a.projections)||void 0===t?void 0:t.filter((function(t){return t.tabId==e||t.window==e}))[0]}},2358:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(2269);function i(e){var t=Object(n.a)(e);return t?t.tabId:null}},2442:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(2043),i=r(2627);function a(){var e=Object(n.d)();switch(e.type){case n.a.SecondaryReadingPane:return e.data.id.Id;case n.a.Primary:default:return Object(i.a)()}}},2627:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(2036),i=r(514);function a(){var e,t;return Object(i.w)()?null===(e=Object(n.b)().deeplinkId)||void 0===e?void 0:e.id:null===(t=Object(n.b)().primaryReadingPaneTabId)||void 0===t?void 0:t.Id}},2921:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(19);function i(){var e=Object(n.a)();return"ChronologicalNewestOnBottom"==(e.UserOptions?e.UserOptions.ConversationSortOrderReact:"ChronologicalNewestOnBottom")}},4090:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.None=0]="None",e[e.FileSuggestion=1]="FileSuggestion",e[e.LocalFiles=2]="LocalFiles",e[e.CloudFiles=3]="CloudFiles",e[e.UploadAndShare=4]="UploadAndShare"}(n||(n={}))},4150:function(e,t,r){"use strict";var n,i=r(31),a=r(5564),o=r(2),u=r(1956);Object(o.mutator)(a.a,(function(e){var t=e.itemId,r=e.isSmartSuggestionsRendered,n=e.suggestionTypesRendered,i=e.suggestionsRendered,a=e.extractionId,o=Object(u.g)().items.get(t);(null==o?void 0:o.SIGSData)&&(o.SIGSData.SmartPillData={IsSmartSuggestionsRendered:r,SuggestionTypesRendered:n,SuggestionsRendered:i,ExtractionId:a})}));!function(e){e.LanguageAndLocale="SmartPill_LanguageAndLocale",e.SmartDoc="SmartPill_SmartDoc",e.SmartReply="SmartPill_SmartReply",e.SmartTime="SmartPill_SmartTime"}(n||(n={}));var s=r(4090);function c(e){return{smartReplyComposeSIGSData:{isSmartSuggestionsClicked:!1,suggestionsClickedTime:null,clickIndex:-1},smartDocOption:e||s.a.None}}r.d(t,"c",(function(){return l})),r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return c}));var d=new i.c((function(){return r.e(1032).then(r.bind(null,18108))})),l=new i.a(d,(function(e){return e.logToSIGSOnMessageSent}))},4922:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return o})),r.d(t,"f",(function(){return u})),r.d(t,"c",(function(){return s})),r.d(t,"e",(function(){return c}));var n=r(449),i="userHighlightEvent",a="existingHighlight",o="newHighlight",u=Object(n.a)({PropertyName:"UserNoteData",PropertyType:"String",DistinguishedPropertySetId:"Common"}),s=500,c=10},5564:function(e,t,r){"use strict";var n=r(2);t.a=Object(n.action)("initializeSIGSDataAction",(function(e,t,r,n,i){return{itemId:e,isSmartSuggestionsRendered:t,suggestionTypesRendered:r,suggestionsRendered:n,extractionId:i}}))},6155:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1955),i=r(2093),a=r(2921);function o(e){var t=n.a.conversations.get(e),r=t?t.conversationNodeIds:[],o=r.length,u=Object(i.a)(e);if(0==o||!u)return null;for(var s=u.itemPartsMap,c=Object(a.a)()?o-1:0,d=Object(a.a)()?-1:1;c>=0&&c<o;){var l=s.get(r[c]),f=l?n.a.items.get(l.itemId):null;if(f&&!f.IsDraft&&!l.isInRollUp)return f.ItemId.Id;c+=d}return null}},6722:function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"e",(function(){return o})),r.d(t,"d",(function(){return u})),r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return c})),r.d(t,"f",(function(){return d})),r.d(t,"h",(function(){return l})),r.d(t,"i",(function(){return m})),r.d(t,"g",(function(){return g}));var n=r(449),i=r(24),a="Language",o="Locale",u="LanguageScores",s="@EntityId",c="EntityExtraction/ExtractLanguage1.0",d=Object(n.a)({PropertyName:c,DistinguishedPropertySetId:"Common",PropertyType:"String"}),l=Object(n.a)({PropertyName:"EntityExtraction/SmartReplyForEmail",DistinguishedPropertySetId:"Common",PropertyType:"String"}),f=Object(i.i)("mc-smartReplyWithMeeting-MeetingScheduler")?"EntityExtraction/CalendarRelated1.0":"EntityExtraction/Events1.0",m=Object(n.a)({PropertyName:f,DistinguishedPropertySetId:"Common",PropertyType:"String"}),g=Object(n.a)({PropertyName:"EntityExtraction/SendContentRequestV21.0",DistinguishedPropertySetId:"Common",PropertyType:"String"})},7441:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(1955);function i(e){var t,r,i=null===(r=null===(t=n.a.conversations)||void 0===t?void 0:t.get(e))||void 0===r?void 0:r.conversationNodeIds;return(null==i?void 0:i.length)>0}},7630:function(e,t,r){"use strict";function n(e){return(null==e?void 0:e.MailboxInfo)&&"GroupMailbox"==e.MailboxInfo.type}r.d(t,"a",(function(){return n}))},7833:function(e,t,r){"use strict";var n=r(1),i=r(2),a=r(1956),o=Object(i.mutatorAction)("updateItemInStore",(function(e,t){var r=a.u.items.get(e);r&&Object.keys(t).forEach((function(e){"ExtendedProperty"==e?r.ExtendedProperty=Object(n.j)(Object(n.j)([],Object(n.g)(t.ExtendedProperty)),Object(n.g)(r.ExtendedProperty)):"ItemId"!=e&&(r[e]=t[e])}))})),u=r(121),s=r(2045),c=r(1955),d=r(981),l=r(23),f=r(419);r.d(t,"d",(function(){return v})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return b})),r.d(t,"a",(function(){return P}));var m={},g={},p="GetItemManagerFailure";function v(e){e.forEach((function(e){g[e.featureId]=e}))}function y(e,t){if(!m[e]||"Pending"!=m[e].requestStatus){var r=function(e,t){var r=[],i={};if(Object.keys(g).forEach((function(a){var o=g[a],u=o.isPropertyExistedOnItem,s=o.shouldGetItemPropertiesFromServer,c=o.propertyPaths,d=o.getDefaultValues;!u(e)&&s(e,t)&&(r.push.apply(r,Object(n.j)([],Object(n.g)(c))),i=Object(n.a)(Object(n.a)({},i),null==d?void 0:d()))})),r.length>0)return{itemShape:Object(d.a)({BaseShape:"IdOnly",AdditionalProperties:r}),defaultValues:i};return{itemShape:null,defaultValues:null}}(e,t),i=r.itemShape,a=r.defaultValues;if(i){var v=c.a.items.get(e);if(v){var y={itemId:e,listViewType:t,requestStatus:"Pending",pendingPromise:null};m[e]=y;var b=Object(f.a)(v.MailboxInfo);y.pendingPromise=Object(s.a)(e,i,null,null,v.MailboxInfo,b).then((function(t){if(!t||t instanceof Error)return t?(t.fetchErrorType="ServerFailure",Promise.reject(t)):Promise.resolve(null);y.requestStatus="Success";var r=Object(n.a)(Object(n.a)({},a),t);return o(e,r),Promise.resolve(c.a.items.get(e))})).catch((function(e){return y.requestStatus="Error",Object(u.s)(p,{errorMessage:e.message}),l.g.warn("[GetItemManager_getAdditionalPropertiesFromServer] Error: "+e.message),Promise.reject(e)}))}}}}function b(e,t){var r=g[t];if(!r)return Promise.reject("GetItemManager: The featureId is not registered in GetItemManager.");if(r.isPropertyExistedOnItem(e))return Promise.resolve(c.a.items.get(e));if(!m[e])return Promise.reject("GetItemManager: Please trigger getItem after the container finished loading.");var n=m[e];switch(n.requestStatus){case"Success":return Promise.resolve(c.a.items.get(e));case"Pending":case"Error":return n.pendingPromise;default:return Promise.reject("GetItemManager: The request status is unknown.")}}function P(e){delete m[e]}},8359:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));var n="EntityExtraction/EmbeddedUrl1.0",i="EntityExtraction/Url1.0"},9588:function(e,t,r){"use strict";r.d(t,"b",(function(){return o}));var n=r(2339),i=r(1955),a=r(979),o="MeetingConflicts",u=Object(a.a)({FieldURI:"ConflictingMeetings"}),s=Object(a.a)({FieldURI:"AdjacentMeetings"}),c={featureId:o,propertyPaths:[s,u],isPropertyExistedOnItem:function(e){return!1},shouldGetItemPropertiesFromServer:function(e){var t=i.a.items.get(e);return!(!t||!Object(n.a)(t.ItemClass))},getDefaultValues:function(){return{AdjacentMeetings:{Items:[]},ConflictingMeetings:{Items:[]}}}};t.a=c}}]);
//# sourceMappingURL=owa.MailBoot~GetItemManager.js.map
self.scriptsLoaded['owa.MailBoot~GetItemManager.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~GetItemManager.js'] = (new Date()).getTime();