self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~GroupAddMemberV2~MailFavoritesStore~MailFilterActions~MailFolderTreesParent~PublicFolderPic~115da03e.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[117],{2044:function(e,t,n){"use strict";var r=n(2),o=n(44),u=n(1947),i=Object(r.action)("selectFocusedViewFilter",(function(e,t){return Object(o.c)({name:0===e?"TnS_SelectFocusedPivot":"TnS_SelectOtherPivot",options:{isCore:!0},customData:[e,t,null!=u.ab.inboxPausedDateTime]},{focusedViewFilter:e,actionSource:t})})),a=Object(r.action)("ON_INITIAL_TABLE_LOAD_COMPLETE",(function(e){return{tableView:e}})),c=n(3148),d=n(14);var l=Object(r.mutatorAction)("addTableViewToStore",(function(e,t){t.set(e.id,e)}));function s(e,t){var n=Object(u.M)().tableViews,r=Object(c.a)(e),o=n.get(r);if(!o&&(o=function(e,t){return{currentLoadedIndex:0,loadErrorStatus:0,id:e,isInCheckedMode:!1,isInVirtualSelectAllMode:!1,isInitialLoadComplete:!1,isLoading:!0,rowKeys:[],rowIdToRowKeyMap:new d.ObservableMap,lastEmptiedTime:null,selectAllModeTimeStamp:null,selectedRowKeys:new d.ObservableMap,serverFolderId:t.folderId,tableQuery:t,totalRowsInView:0,virtualSelectAllExclusionList:[],selectionAnchorRowKey:null,focusedRowKey:null,multiSelectionAnchorRowKey:null}}(r,e),!t)){var i=o.id;l(o,n),o=n.get(i)}return o}n.d(t,"a",(function(){return 25})),n.d(t,"b",(function(){return 25})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return s}))},2367:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2272),o=n(2657),u=n(1947),i=n(1964),a=n(2645);function c(e,t,n,c,d,l,s){var f,b=d||"All",O=s||Object(o.a)(e),S=null==c?function(e){if("inbox"!==Object(i.a)(e))return-1;if(!Object(a.a)())return-1;return 0}(e):c;switch(t){case 0:f=Object(r.e)(e,Object(u.U)(n));break;case 1:f=Object(r.f)()}return{folderId:e,focusedViewFilter:S,listViewType:t,viewFilter:b,sortBy:O,requestShapeName:f,type:0,shouldTryToUseSessionDataResponse:!0,categoryName:l,scenarioType:n}}},2401:function(e,t,n){"use strict";var r=n(2),o=Object(r.action)("ON_NUDGE_REMOVED",(function(e){return{rowKey:e}})),u=Object(r.action)("ON_GET_NUDGES_COMPLETED",(function(e,t){return{nudgedRows:e,tableView:t}})),i=Object(r.createStore)("nudgeStore",{nudgedRows:[]}),a=i();Object(r.mutator)(u,(function(e){a.nudgedRows=e.nudgedRows})),Object(r.mutator)(o,(function(e){for(var t=a.nudgedRows.length-1;t>=0;t--)a.nudgedRows[t].rowKey===e.rowKey&&a.nudgedRows.splice(t,1)}));var c=n(3674),d=n(6);function l(e){var t=a.nudgedRows.filter((function(t){return t.rowKey===e}))[0],n=t.daysAgo,r=0==t.reason;return 0==n?r?Object(d.b)(c.c):Object(d.b)(c.f):1==n?r?Object(d.b)(c.b):Object(d.b)(c.e):r?Object(d.c)(Object(d.b)(c.a),n):Object(d.c)(Object(d.b)(c.d),n)}var s=n(1947);function f(e,t){return a.nudgedRows.some((function(n){return n.rowKey===e&&n.tableViewId===t||"testNudgeRowKey"==e}))}var b=n(3547);function O(e,t,n){return!!f(e,t)&&(!!Object(b.c)(t)&&!Object(s.w)(n))}function S(e){var t=a.nudgedRows.filter((function(t){return t.conversationId===e}));return t.length>0&&v(t[0])?t[0].rowKey:null}function w(e){var t=a.nudgedRows.filter((function(t){return t.itemId===e}));return t.length>0&&v(t[0])?t[0].rowKey:null}function v(e){var t=e.tableViewId,n=Object(s.M)().tableViews.get(t);if(!n||n.id!=Object(s.K)())return!1;var r=e.rowKey;return O(r,t,s.b.getLastDeliveryOrRenewTimeStamp(r,n))}function p(e){var t=a.nudgedRows.filter((function(t){return t.rowKey===e}));return t.length>0?t[0].itemId:null}n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return w})),n.d(t,"d",(function(){return S})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return O})),n.d(t,"g",(function(){return f})),n.d(t,"f",(function(){return i})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return o}))},2448:function(e,t,n){"use strict";var r=n(2),o=n(14),u=n(1951),i=n(3455),a=n(3147),c=n(2031);Object(r.mutator)(i.a,(function(e){d(e.unreadCount,e.totalCount,e.folderId,e.isDeltaChange)})),Object(r.mutator)(a.b,(function(e){d(e.unreadCount,e.totalCount,e.folderId,!1)}));function d(e,t,n,r){var o=u.d.folderTable.get(n);o&&(r?(o.UnreadCount+=e,o.TotalCount+=t):(o.UnreadCount=e,o.TotalCount=t),o.pausedTotalCount&&Object(c.b)()===n&&(o.pausedTotalCount=o.TotalCount),o.UnreadCount=Math.max(o.UnreadCount,0),o.TotalCount=Math.max(o.TotalCount,0))}var l={folderNodeViewStates:new o.ObservableMap({}),contextMenuState:null,folderTextFieldViewState:null,isDraggedOver:!1,withContextMenuFolderId:null},s=Object(r.createStore)("folderViewState",l)();t.a=s},2457:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3809),o=n(2448),u=n(2159),i=n(1984),a=n(1947);function c(e){if(!o.a.folderNodeViewStates.has(e)){var t=a.c.getDefaultSortBy();Object(r.a)(e,{isExpanded:!1,sortColumn:t.sortColumn,sortOrder:t.sortDirection,drag:Object(u.a)(),drop:Object(i.a)()})}return o.a.folderNodeViewStates.get(e)}},2645:function(e,t,n){"use strict";var r=n(19);function o(){return Object(r.a)().UserOptions.IsFocusedInboxEnabled}n.d(t,"a",(function(){return o}))},2657:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3215),o=n(1947),u=n(3671),i=n(121);function a(e){var t=Object(r.c)()[e];if(t){var n=Object(u.getSupportedSortColumns)(e),a=t.SortColumn,c=t.SortOrder;if(n.includes(a)){var d=c;return(!c||c!=o.c.DESCENDING_SORT_DIR&&c!=o.c.ASCENDING_SORT_DIR)&&(d=o.c.getDefaultSortDirectionForSortColumn(a),Object(i.s)("getSortByFolderId_invalidSortOrder",{sortColumn:a,sortOrder:c})),{sortColumn:a,sortDirection:d}}}return o.c.getDefaultSortBy()}},3147:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var r=n(2),o=Object(r.action)("onNewFolderNotification",(function(e,t,n,r,o){return void 0===r&&(r=0),void 0===o&&(o=0),{folderId:e,parentFolderId:t,displayName:n,unreadCount:r,totalCount:o}})),u=Object(r.action)("onUpdateFolderNotification",(function(e,t,n,r,o){return{unreadCount:e,totalCount:t,folderId:n,displayName:r,parentFolderId:o}}))},3148:function(e,t,n){"use strict";function r(e,t){void 0===t&&(t=!1);var n=[];switch(e.type){case 0:n.push("folderId:"+e.folderId);var r=e;n.push("lVT:"+e.listViewType),n.push("vF:"+r.viewFilter),n.push("fVF:"+r.focusedViewFilter),t||(n.push("sC:"+r.sortBy.sortColumn),n.push("sD:"+r.sortBy.sortDirection)),r.categoryName&&n.push("catName:"+r.categoryName),n.push("sT:"+r.scenarioType);break;case 1:n.push("folderId:"+e.folderId);var o=e;n.push("id:"+o.searchNumber),n.push("query:"+o.queryString),n.push("lVT:"+e.listViewType),n.push("sT:"+o.scenarioType);break;case 2:n.push("gId:"+e.folderId);var u=e;n.push("lVT:"+e.listViewType),n.push("vF:"+u.viewFilter)}return n.join(";").toString()}n.d(t,"a",(function(){return r}))},3150:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var r=n(57);function o(e){return!!(e&Object(r.h)().ViewStateConfiguration.FocusedInboxBitFlags)}function u(e,t){o(t)!==e&&Object(r.z)((function(n){e?n.ViewStateConfiguration.FocusedInboxBitFlags|=t:n.ViewStateConfiguration.FocusedInboxBitFlags&=~t}))}},3215:function(e,t,n){"use strict";var r=n(1),o=n(2457),u=n(19),i=n(57),a="OWA.ViewStateConfiguration",c=1e4,d=null;var l=n(1947),s=n(296),f=n(1951),b=n(2964),O=n(1964),S=n(1956);function w(e){var t=Object(O.a)(e);return Object(b.a)(e)||Object(f.G)(e)?j.DateViewOnly:"drafts"==t||"junkemail"==t||"outbox"==t||"notes"==t?j.DateViewOnly:"deleteditems"==t||Object(S.k)(e)?j.DateView:j.ConversationView}function v(e){return"inbox"!=Object(O.a)(e)||Object(b.a)(e)?p.SearchRefinerScopeCurrentFolder:p.SearchRefinerScopeAll}var p,j,I=n(2178);function g(e){return JSON.parse(e,(function(e,t){return"SortOrder"!==e||1!==t&&0!==t?t:1===t?l.c.DESCENDING_SORT_DIR:l.c.ASCENDING_SORT_DIR}))}function C(){for(var e=Object(u.a)().ViewStateConfiguration.FolderViewState||[],t={},n=0;n<e.length;n++){var r=g(e[n]);t[r.FolderId.Id]=r}return t}function V(e){return JSON.stringify(e,(function(e,t){return"SortOrder"!==e||t!==l.c.DESCENDING_SORT_DIR&&t!==l.c.ASCENDING_SORT_DIR?t:t===l.c.DESCENDING_SORT_DIR?1:0}))}function h(e){var t=!1;Object(s.a)((function(n){for(var i=n.ViewStateConfiguration.FolderViewState||[],a=Object(o.a)(e),c=null,d=-1,l=0;l<i.length;l++){var s=g(i[l]);if(s.FolderId.Id===e){c=s,d=l;break}}var b=function(e,t,n){var o=n.sortOrder,i=n.sortColumn,a=n.isExpanded;if(t)return Object(r.a)(Object(r.a)({},t),{SortOrder:o,SortColumn:i,IsExpanded:a});var c=f.d.folderTable.get(e);return c?{FolderId:c.FolderId,View:w(c.FolderId.Id),Width:I.b,SortOrder:o,SortColumn:i,IsExpanded:a,ReadingPanePosition:Object(u.a)().UserOptions.GlobalReadingPanePositionReact,SearchScope:v(c.FolderId.Id)}:null}(e,c,a);b&&(-1!==d?(t=c!==b)&&(i[d]=V(b)):(t=!0,i.push(V(b))))})),t&&function(){var e=Object(u.a)().ViewStateConfiguration.FolderViewState;if(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);d||(d=setTimeout((function(){d=null,i.w.importAndExecute([{key:"FolderViewState",valuetype:"StringArray",value:t}],a)}),c))}}()}n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return j})),n.d(t,"c",(function(){return C})),n.d(t,"d",(function(){return h})),function(e){e[e.SearchRefinerScopeAll=0]="SearchRefinerScopeAll",e[e.SearchRefinerScopePrimaryMailbox=1]="SearchRefinerScopePrimaryMailbox",e[e.SearchRefinerScopeCurrentFolder=2]="SearchRefinerScopeCurrentFolder",e[e.SearchRefinerScopeCurrentFolderAndSubfolders=3]="SearchRefinerScopeCurrentFolderAndSubfolders"}(p||(p={})),function(e){e[e.ConversationView=1]="ConversationView",e[e.DateView=2]="DateView",e[e.DateViewOnly=3]="DateViewOnly",e[e.ItemGroupView=4]="ItemGroupView",e[e.BundledView=5]="BundledView"}(j||(j={}))},3455:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("UPDATE_FOLDER_COUNTS",(function(e,t,n,r){return{unreadCount:e,totalCount:t,folderId:n,isDeltaChange:r}}))},3547:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return S})),n.d(t,"a",(function(){return w}));var r,o=n(24),u=n(3671),i=n(1244),a=n(1947),c=n(3150),d=n(19),l=n(197),s=n(121);function f(){var e=Object(l.a)(),t=e&&Object(o.i)("tri-nudge-consumer"),n=!e&&Object(o.i)("tri-nudge"),u=Object(d.a)().UserOptions.MessageRemindersEnabled;return r||(r=!0,Object(s.s)("Nudge_TenantSetting",{owa_1:u})),u&&(n||t)&&!Object(c.a)(32)}function b(e){return e===Object(i.a)("inbox")||e===Object(i.a)("sentitems")}function O(e,t){if(0!=e.tableQuery.type)return!1;if("All"!=Object(a.R)(e))return!1;var n=Object(a.m)(e);if(0!=n&&-1!=n)return!1;var r=Object(a.L)(e);return 1==r.sortColumn&&r.sortDirection==u.DESCENDING_SORT_DIR}function S(e){var t=a.ab.tableViews.get(e),n=t.tableQuery.folderId;return!!b(n)&&O(t)}function w(e){return!!b(e)&&O(Object(a.J)())}},3674:function(e){e.exports=JSON.parse('{"c":"Rzb","b":"Szb","a":"Tzb","f":"Uzb","e":"Vzb","d":"Wzb"}')},3809:function(e,t,n){"use strict";var r=n(2448),o=n(183);t.a=Object(o.action)("setFolderViewState")((function(e,t){r.a.folderNodeViewStates.set(e,t)}))}}]);
//# sourceMappingURL=owa.MailBoot~GroupAddMemberV2~MailFavoritesStore~MailFilterActions~MailFolderTreesParent~PublicFolderPic~115da03e.js.map
self.scriptsLoaded['owa.MailBoot~GroupAddMemberV2~MailFavoritesStore~MailFilterActions~MailFolderTreesParent~PublicFolderPic~115da03e.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~GroupAddMemberV2~MailFavoritesStore~MailFilterActions~MailFolderTreesParent~PublicFolderPic~115da03e.js'] = (new Date()).getTime();