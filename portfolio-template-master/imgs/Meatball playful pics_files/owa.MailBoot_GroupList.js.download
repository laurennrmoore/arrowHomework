self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~GroupList.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[661],{10434:function(e,t,r){"use strict";var n=r(869),o=r(6001);function i(e){n.b.import().then((function(t){n.h.importAndExecute({subscriptionId:"GroupAssociationNotification",requiresExplicitSubscribe:!0,subscriptionParameters:Object(o.a)({NotificationType:"GroupAssociationNotification",ChannelId:t()})},e)}))}r.d(t,"a",(function(){return i}))},1970:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={FavoriteNode:"favoritenode",InboxRule:"inboxrule",LocalFile:"Files",MailFolderNode:"mailfoldernode",MailListItemPart:"maillistitempart",MailListRow:"maillistrow",MultiMailListConversationRows:"multimaillistconversationrows",MultiMailListMessageRows:"multimaillistmessagerows",ReadWriteRecipient:"recipient",NoteFeedItem:"notefeeditem",Todo:"todo",Attachment:"attachment",CommandBarEditorButton:"commandbareditorbutton",CalendarNode:"calendarnode",CalendarGroupNode:"calendargroupnode",CalendarItem:"calendaritem"}},1986:function(e,t,r){"use strict";var n=r(1),o=r(2051),i=r(374),a=r(730),u=r(121),c=r(5),s="X-AnchorMailbox",p="Authorization",d="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";function f(e,t){return Object(n.c)(this,void 0,void 0,(function(){var r,f,b,v,g;return Object(n.f)(this,(function(n){switch(n.label){case 0:if(r={},f=Object(i.k)(e)){if(f.accountState==i.b.AccessRevoked)return[2,null];if(f.accountState==i.b.AccountDeprovisioned||f.accountState==i.b.AccountNotFound)return Object(i.c)(f.accountState,f.accountProviderType),[2,null]}return t?(r[s]=t,r[l]=t):f&&(r[s]=f.anchorMailbox),f?(b=f.token,!(v=Object(a.g)(f.tokenExpiry))&&b?[3,2]:(Object(u.s)("getAndUpdateAccessToken",{tokenExpiry:Object(c.y)(f.tokenExpiry,Object(c.Rb)()),isTokenExpired_1:v,isTokenInvalid_2:!b},{isCore:!0}),[4,o.a.importAndExecute(f.accountId,e,b)])):[3,3];case 1:(b=n.sent())||(b=""),n.label=2;case 2:g=void 0,"Outlook"==f.accountProviderType?(g='MSAuth1.0 usertoken="'+b+'", type="MSACT"',r[d]=1..toString()):"Google"!=f.accountProviderType&&"ICloud"!=f.accountProviderType||(g="Bearer "+b,r[d]=2..toString()),r[p]=g,n.label=3;case 3:return[2,r]}}))}))}var b=r(1989),v=r(23);function g(e,t){return Object(n.c)(this,void 0,void 0,(function(){var r,o;return Object(n.f)(this,(function(n){switch(n.label){case 0:return r=Object(b.a)(),o=r,[4,O(e,t)];case 1:return o.headers=n.sent(),r.authNeededOnUnAuthorized=!1,r.datapoint=r.datapoint||{},r.datapoint.mailbox="Connected",[2,r]}}))}))}function O(e,t){var r;return Object(n.c)(this,void 0,void 0,(function(){var o,i;return Object(n.f)(this,(function(n){switch(n.label){case 0:return o=t&&(null===(r=e.headers)||void 0===r?void 0:r.set)?new Headers(e.headers):new Headers,[4,f(e.mailboxInfo.userIdentity,m(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=n.sent(),Object(b.b)(o,i),[2,o]}}))}))}function m(e,t){var r="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return r&&null==t&&v.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),r}r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return m}))},1989:function(e,t,r){"use strict";function n(e,t){Object.keys(t).forEach((function(r){return e.set(r,t[r])}))}function o(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return o}))},1991:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),o=Object(n.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},2023:function(e,t,r){"use strict";var n=r(0),o=r(1970);var i=r(183),a=Object(i.action)("setDropState")((function(e,t,r){e.isDragOver=t,e.draggableItemType=r})),u=r(2075),c=r(102);r.d(t,"a",(function(){return p}));var s=50,p=function(){function e(e){var t=this;this.props=e,this.onDragEnter=function(e){e.preventDefault(),t.props.preventBubblingDragEvents&&e.stopPropagation();var r=t.getDragData(e);(Object(c.e)()||Object(c.g)())&&t.setDropEffectInternal(e,t.getDesiredDropEffect(r)),t.props.onDragEnter&&t.props.onDragEnter(r)},this.onDragLeave=function(e){if(t.props.preventBubblingDragEvents&&e.stopPropagation(),!t.props.greedy||t.isReallyLeavingDroppable(e)){var r=t.props.dropViewState.draggableItemType;r||(r=t.getDragType(e));var n={itemType:r,itemData:Object(u.a)()};if("none"!=t.getDesiredDropEffect(n)){var o=function(r){return function(){t.props.onDragLeave&&t.props.onDragLeave(r,e.currentTarget),a(t.props.dropViewState,!1,null),t.pendingDragLeaveHandler=null}};t.props.shouldIgnoreTransientOnDragLeave?t.pendingDragLeaveHandler||(e.persist(),t.pendingDragLeaveHandler=setTimeout(o(n),s)):o(n)(),(Object(c.e)()||Object(c.g)())&&t.setDropEffectInternal(e,"none")}}},this.onDragOver=function(e){t.props.preventBubblingDragEvents&&e.stopPropagation();var r=t.props.dropViewState.draggableItemType;r||(r=t.getDragType(e));var n={itemType:r,itemData:Object(u.a)()},o=t.getDesiredDropEffect(n);"none"!=o?(t.props.bypassActOnDrop||(e.preventDefault(),t.setDropEffectInternal(e,o)),t.props.shouldUseCopyAsDropEffect&&t.setDropEffectInternal(e,"copy"),t.props.onDragOver&&t.props.onDragOver(n,e.pageX,e.pageY,e.currentTarget),t.cancelPendingDragLeaveHandler(),t.props.dropViewState.isDragOver&&t.props.dropViewState.draggableItemType==r||a(t.props.dropViewState,!0,r)):t.props.bypassActOnDrop||t.setDropEffectInternal(e,"none")},this.onDrop=function(e){t.props.preventBubblingDragEvents&&e.stopPropagation();var r=t.getDragData(e);e.preventDefault(),"none"!=t.getDesiredDropEffect(r)&&(t.props.onDrop(r,e.pageX,e.pageY,e.currentTarget),t.props.onDragLeave&&t.props.onDragLeave(r,e.currentTarget),t.cancelPendingDragLeaveHandler(),Object(u.d)(null,null),a(t.props.dropViewState,!1,null))},this.refCallback=function(e){t.div=e}}return e.prototype.getDiv=function(){return this.div},e.prototype.cancelPendingDragLeaveHandler=function(){this.pendingDragLeaveHandler&&(clearTimeout(this.pendingDragLeaveHandler),this.pendingDragLeaveHandler=null)},e.prototype.isReallyLeavingDroppable=function(e){var t=document.elementFromPoint(e.pageX,e.pageY);return!this.isDescendantOrSelf(t,e.currentTarget)},e.prototype.isDescendantOrSelf=function(e,t){if(!e||!t)return!1;if(e==t)return!0;for(var r=e;r=r.parentElement;)if(r==t)return!0;return!1},e.prototype.getDesiredDropEffect=function(e){return e?this.props.canDrop?"boolean"==typeof this.props.canDrop(e)?this.props.canDrop(e)?"move":"none":this.props.canDrop(e):"move":"none"},e.prototype.getDragData=function(e){var t,r=null;if(e.dataTransfer.files&&e.dataTransfer.files.length>0)t=e.dataTransfer.files,r={itemType:o.a.LocalFile,files:t};else{for(var n=e.dataTransfer.types,i=null,a=!1,u=0;u<n.length;u++){var c=n[u];if("text"!=c){i=e.dataTransfer.getData(c),a=!0;break}}a||(i=e.dataTransfer.getData("text"));try{r=JSON.parse(i)}catch(e){r={itemType:"nothing"}}}return r},e.prototype.getDragType=function(e){var t=Object(u.b)(),r=e.dataTransfer?e.dataTransfer:e.nativeEvent.dataTransfer;if(!t&&r&&r.types&&r.types.length>0){var n=Array.prototype.slice.apply(e.dataTransfer.types),i=Object.values(o.a),a=n.filter((function(e){return i.indexOf(e)>=0}));a.length>0&&(t=a[0])}return t},e.prototype.setDropEffectInternal=function(e,t){e.dataTransfer&&(e.dataTransfer.dropEffect=t),Object(u.e)(t)},e}();t.b=n.forwardRef((function(e,t){var r=n.useRef(new p(e));return n.useImperativeHandle(t,(function(){return{getDiv:function(){return r.current.getDiv()}}}),[]),n.createElement("div",{ref:r.current.refCallback,className:e.classNames,style:e.style,onDrop:r.current.onDrop,onDragOver:r.current.onDragOver,onDragEnter:r.current.onDragEnter,onDragLeave:r.current.onDragLeave},e.children)}))},2030:function(e,t,r){"use strict";var n=r(1),o=r(1989);function i(e,t){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":t||e}}function a(e,t,r){t&&(e||r)&&Object(o.b)(t,i(e,r))}function u(e,t){var r,o=null!=t?t:{},i=(null===(r=o.headers)||void 0===r?void 0:r.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",a(e,i),Object(n.a)(Object(n.a)({},o),{headers:i})}var c=r(374),s=r(1986),p=r(87),d=r(319);function l(e){return Object(n.c)(this,void 0,void 0,(function(){var t=this;return Object(n.f)(this,(function(r){return[2,Object(p.b)().then((function(r){return Object(n.c)(t,void 0,void 0,(function(){var t,o;return Object(n.f)(this,(function(n){switch(n.label){case 0:return e?Object(c.r)(e.userIdentity)?[4,Object(s.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return t=n.sent(),d(r,t),[3,3];case 2:"GroupMailbox"!=e.type&&"TeamsMailbox"!=e.type||(o=i(e.mailboxSmtpAddress),d(r,o)),n.label=3;case 3:return[2,r]}}))}))}))]}))}))}function f(){return Object(p.b)().then((function(e){return e.prefer='exchange.Behavior="CalendarInternal"',e}))}function b(e){return void 0===e&&(e=null),Object(c.r)(e)?f().then((function(t){return Object(s.a)(e).then((function(e){return Object.keys(e).forEach((function(r){return t[r]=e[r]})),t}))})):Promise.resolve({})}var v=r(65);function g(e,t,r,n){var o=new Headers;return r&&o.set("X-OWA-CANARY",Object(v.a)()),t&&o.set("X-OWA-ActionName",t),(e||n)&&(n?a(e,o,n):a(e,o)),o}r.d(t,"a",(function(){return u})),r.d(t,"d",(function(){return l})),r.d(t,"b",(function(){return b})),r.d(t,"c",(function(){return f})),r.d(t,"f",(function(){return a})),r.d(t,"e",(function(){return g}))},2051:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(31),o=r(1991);r.d(t,"b",(function(){return o.a}));var i=new n.c((function(){return r.e(1286).then(r.bind(null,2298))})),a=new n.a(i,(function(e){return e.getAndUpdateAccessToken}))},2075:function(e,t,r){"use strict";var n,o,i;function a(e,t){n=e,o=t}function u(){return n}function c(){return o}function s(e){i=e}function p(){return i}r.d(t,"d",(function(){return a})),r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return c})),r.d(t,"e",(function(){return s})),r.d(t,"c",(function(){return p}))},2094:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),o=Object(n.createStore)("currentGroupInformationStore",{smtpAddress:"",groupId:"",tenantId:""})},2117:function(e,t,r){"use strict";r.d(t,"b",(function(){return i}));var n=r(2),o={myOrgGroups:[],withContextMenuGroup:null,shouldShowAllGroups:!1,hasLoadedFromServer:!1,loadGroupsError:!1,groupNodeViewStates:new(r(14).ObservableMap)({})},i=Object(n.createStore)("leftNavGroupsStore",o),a=i();t.a=a},2190:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1);function o(e){return Object(n.a)({__type:"UnifiedGroupIdentity:#Exchange"},e)}},2255:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1);function o(e){return Object(n.a)({__type:"BodyContentType:#Exchange"},e)}},2672:function(e,t,r){"use strict";function n(e,t,r){var n,o,i,a,u,c=e.groups.get(t.toLowerCase());if(c||(r.unreadMessageCount=null,r.groupDetailsError=r.groupDetailsError||!1),!r.groupDetailsError||c&&c.basicInformation||(r.basicInformation={SmtpAddress:t,DisplayName:t}),r.groupDetails){var s=r.groupDetails;c&&c.basicInformation&&!c.groupDetailsError||(r.basicInformation={SmtpAddress:s.SmtpAddress,DisplayName:s.DisplayName,AccessType:s.AccessType,LegacyDN:s.LegacyDN,MailboxGuid:s.MailboxGuid}),r.groupDetails.UserGroupRelationship={SubscriptionType:(null===(n=s.UserGroupRelationship)||void 0===n?void 0:n.SubscriptionType)||0,IsSubscribed:(null===(o=s.UserGroupRelationship)||void 0===o?void 0:o.IsSubscribed)||!1,ShouldIgnoreReply:(null===(i=s.UserGroupRelationship)||void 0===i?void 0:i.ShouldIgnoreReply)||!1,IsMember:(null===(a=s.UserGroupRelationship)||void 0===a?void 0:a.IsMember)||!1,IsOwner:(null===(u=s.UserGroupRelationship)||void 0===u?void 0:u.IsOwner)||!1}}return r}var o=r(183),i=r(2094),a=Object(o.action)("addOrUpdateGroup")((function(e,t,r,o,a){var u;t=t.toLowerCase();var c=void 0!==o&&""!==o;if(c&&(o=o.toLowerCase(),t=r.groupDetails.SmtpAddress),r=n(e,c?o:t,r),e.groups.has(t)||c&&e.groups.has(o)){var s=e.groups.has(t)?e.groups.get(t):e.groups.get(o);r.basicInformation&&(s.basicInformation=r.basicInformation),r.groupDetails&&((null===(u=s.groupDetails)||void 0===u?void 0:u.MailboxSettings)&&!r.groupDetails.MailboxSettings&&(r.groupDetails.MailboxSettings=s.groupDetails.MailboxSettings),s.groupDetails=r.groupDetails),r.members&&(s.members=r.members),null!=r.groupDetailsError&&(s.groupDetailsError=r.groupDetailsError),c&&t!==o&&(void 0!==a&&a(t,o),e.groups.set(t,s),e.groups.delete(o),Object(i.a)().smtpAddress=t)}else e.groups.set(t,r)}));t.a=a},2841:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(19),o=r(24);function i(){var e;return(null===(e=Object(n.a)().UserOptions)||void 0===e?void 0:e.SendFromAliasEnabled)&&Object(o.i)("cmp-proxy-address")}},3428:function(e,t,r){"use strict";var n=r(183),o=r(2245),i=r(2426),a=r(2046),u=r(2672),c=r(2149),s=r(2073);var p=function(e,t){var r=Object(s.b)(t,"Site");r?!function(e){return-1==e.indexOf("_layouts/groupstatus.aspx")}(r)?Object(c.a)(e,1):Object(c.a)(e,2):Object(c.a)(e,0)},d=r(2),l=Object(d.action)("beforeGetGroupDetailsStartAction",(function(e){return{groupSmtpAddress:e}}));Object(d.orchestrator)(l,(function(e){3==Object(a.h)(e.groupSmtpAddress)&&Object(a.n)(e.groupSmtpAddress,1)}));var f=l,b=r(2094),v=Object(d.mutatorAction)("updateCurrentGroupIdAndTenantIdAction",(function(e,t){Object(b.a)().groupId=e,Object(b.a)().tenantId=t})),g=function(e,t){Object(u.a)(Object(a.j)(),e,{basicInformation:null,groupDetails:null,members:null,groupDetailsError:!0}),Object(a.n)(e,0),t&&t()},O=Object(n.action)("getGroupDetailsAction")((function(e,t,r,n){f(e),(o.g||i.f)(e,t).then((function(t){return function(e,t,r,n){if(e&&e.Body&&Object(i.i)(e.Body)){var o=e.Body.GroupDetails;o?(Object(u.a)(Object(a.j)(),o.SmtpAddress,{basicInformation:null,groupDetails:o,members:null,groupDetailsError:!1}),v(o.ExternalDirectoryObjectId,o.ExternalDirectoryOrganizationId),p(t,o),r&&r()):g(t,n)}else g(t,n)}(t,e,r,n)})).catch((function(t){g(e,n)}))}));t.a=O},3551:function(e,t,r){"use strict";var n=r(1),o=r(2117),i=r(14),a=r(858),u=r(214),c=r(2321),s=r(0),p=r(3815),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){e.stopPropagation(),t.props.selectGroup(t.props.groupId,t.props.customData)},t.toggleFavorite=function(){Object(p.a)(t.props.groupId)},t.onKeyDown=function(e){switch(e.keyCode){case 13:case 32:e.stopPropagation(),t.props.selectGroup(t.props.groupId,t.props.customData)}},t.renderRightCharm=function(){return t.props.renderRightCharm(t.props.groupId,t.props.customData)},t.renderRightCharmHover=function(){return t.props.renderRightCharmHover(t.props.groupId,t.props.customData)},t}return Object(n.e)(t,e),Object.defineProperty(t.prototype,"isSelected",{get:function(){return this.props.isSelected(this.props.groupId,this.props.customData)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isWithContextMenuOpen",{get:function(){return o.a.withContextMenuGroup&&this.props.groupId==o.a.withContextMenuGroup.groupId},enumerable:!1,configurable:!0}),t.prototype.shouldComponentUpdate=function(e,t){return!Object(u.e)(this.props,e)},t.prototype.render=function(){return s.createElement(c.a,{chevronProps:this.props.chevronProps,customIcon:this.props.customIcon,depth:1,displayName:this.props.displayName,isBeingDragged:this.props.isBeingDragged,isDroppedOver:this.props.isDroppedOver,isRootNode:!1,isSelected:this.isSelected,isWithContextMenuOpen:this.isWithContextMenuOpen,key:this.props.groupId,onClick:this.onClick,onContextMenu:this.props.onContextMenu,onKeyDown:this.onKeyDown,renderCustomTreeNodeDisplay:this.props.renderCustomTreeNodeDisplay,renderRightCharm:this.renderRightCharm,renderRightCharmHover:this.renderRightCharmHover,showAsHoverOnDroppedOver:this.props.showHoverStateOnDroppedOver,isFavorited:this.props.isFavorited,toggleFavorite:this.toggleFavorite})},Object(n.d)([i.computed],t.prototype,"isSelected",null),Object(n.d)([i.computed],t.prototype,"isWithContextMenuOpen",null),t=Object(n.d)([a.observer],t)}(s.Component);t.a=d},3815:function(e,t,r){"use strict";var n=r(2);t.a=Object(n.action)("TOGGLE_FAVORITE_GROUPNODE_FROM_LEFTNAV",(function(e){return{groupId:e}}))},419:function(e,t,r){"use strict";var n=r(1);function o(e,t){return e?Object(n.a)({mailboxInfo:e},t):null!=t?t:void 0}r.d(t,"a",(function(){return o}))},5744:function(e,t,r){"use strict";r.r(t);var n=r(1),o=r(33);function i(e){return Object(n.a)({__type:"UpdateUserGroupsSetConfigurationRequest:#Exchange"},e)}function a(e){var t,r;void 0===(t={request:i({GroupsSet:e})}).request||t.request.__type||(t.request=i(t.request)),Object(o.a)("UpdateUserGroupsSetConfiguration",t,r)}var u=r(121),c=r(24),s=r(2943),p=r(7806),d=r(183),l=Object(d.action)("removeGroupFromLeftNav")((function(e,t){var r=t.myOrgGroups.indexOf(e);r>=0&&t.myOrgGroups.splice(r,1)})),f=r(3428),b=r(1993),v=r(1947),g=r(2384),O=r(2027),m=r(3212),j=r(7426),h=r(10434);function y(e){if(("RowModified"==e.EventType||"RowAdded"==e.EventType)&&null!=e.IsMember&&null!=e.Group){var t=e.Group.SmtpAddress.toLowerCase();j.d.importAndExecute(t,e.IsMember);var r=Object(s.b)();e.IsMember?r.myOrgGroups.includes(t)||($(),function(e){var t=Object(v.J)(),r=t&&Object(O.b)(t.tableQuery);r&&r.toLowerCase()===e&&Object(m.a)(t.tableQuery)}(t)):r.myOrgGroups.includes(t)&&(l(t,r),Object(p.c)(t),Object(f.a)(t),function(e){var t,r=Object(v.J)(),n=r&&Object(O.b)(r.tableQuery);if((null==n?void 0:n.toLowerCase())!==e)return;var o=Object(b.a)().groups.get(e);3!==(null===(t=null==o?void 0:o.basicInformation)||void 0===t?void 0:t.AccessType)&&(g.a.clear(r,null),Object(m.b)(r,"ErrorAccessDenied"))}(t))}}var D=r(4292),S=r(2672),I=r(1311),T=r(1310),w=r(180),G=r(23),A=r(44),E=r(2046),x=r(5),C=r(1985),L=r(3279),M=r(3361),R=r(3878),N=r(2272),F=r(2013),U=r(2578),H=r(419),P=5,k=1e4,_=30,B="GroupModulePrefetch",V="X-OWA-ActionSource",q="GroupMailbox_WarmUp",W="X-OWA-ActionName",X=!1;function Y(){var e=Object(E.j)();X||(X=!0,setTimeout((function(){if(function(e){var t,r;try{for(var o=Object(n.k)(s.c.myOrgGroups),i=o.next();!i.done;i=o.next()){var a=i.value;if(J(e,a,_))return!0}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return!1}(e)){Object(R.b)(Date.now());var t=function(e){var t=s.c.myOrgGroups.filter((function(t,r){return Object(C.isGroupInFavorites)(t)&&J(e,t,_)})).slice(0,P);if(t.length<P){var r=s.c.myOrgGroups.filter((function(t,r){return r<L.a&&!Object(C.isGroupInFavorites)(t)&&J(e,t,_)}));t=t.concat(r).slice(0,P)}return t}(e);t.forEach((function(e){(function(e){var t=Object(M.b)(),r=Object(M.a)(e,t);switch(t){case 0:return function(e){var t=new Headers;return t.set(V,B),t.set(W,q),Object(N.d)("inbox",1,e.viewFilter,e.sortBy,!1,e.focusedViewFilter,e.requestShapeName,Object(F.d)(e),void 0,e.categoryName,void 0,{headers:t})}(r);case 1:return function(e){return Object(c.i)("mon-messageList-useGqlForFindItem")?Object(N.h)(Object(v.j)(e),1,e.viewFilter,e.sortBy,!1,e.focusedViewFilter,e.requestShapeName,Object(F.d)(e),e.shouldTryToUseSessionDataResponse,z(e),e.categoryName):Object(N.c)(Object(v.j)(e),0,1,e.viewFilter,Object(U.a)(e),e.focusedViewFilter,e.requestShapeName,e.shouldTryToUseSessionDataResponse,z(e),e.categoryName)}(r)}return Promise.resolve()})(e).catch((function(e){}))})),Object(R.c)(t)}}),k))}function J(e,t,r){var n=e.groups.get(t.toLowerCase());if(!n||!n.basicInformation)return!1;var o=n.basicInformation;if(!o.LastVisitedTimeUtc)return!1;var i=Object(x.nc)(o.LastVisitedTimeUtc),a=Object(x.Yb)(i),u=Object(x.mc)();return Object(x.Ob)(a,Object(x.e)(u,-r),u)}function z(e){var t=Object(H.a)(Object(F.d)(e))||{};return t.headers=new Headers,t.headers.set(V,B),t.headers.set(W,q),t}var K=r(8987),Q=!1;var $=Object(d.action)("loadGroups")((function(e){return Object(n.c)(this,void 0,void 0,(function(){var t,r,o,i,p;return Object(n.f)(this,(function(n){switch(n.label){case 0:return Q?[2]:(t=new u.b("loadGroups"),Q=!0,d=new Array,Object(c.i)("tri-favorites-roaming")?d.push({FilterType:0,SortType:4,SortDirection:"Descending"}):(d.push({FilterType:1,SortType:4,SortDirection:"Descending"}),d.push({FilterType:2,SortType:4,SortDirection:"Descending"})),r=Object(I.a)({RequestedGroupsSets:d,AdditionalProperties:[4]}),[4,Object(T.a)({Header:Object(w.b)(),Body:r})]);case 1:return"Success"==(o=n.sent()).Body.ResponseClass?(t.end(),s.c.loadGroupsError=!1,s.c.hasLoadedFromServer=!0,ee(i=o.Body.GroupsSets),a(i),e&&Y()):(p="There was an error loading groups: "+Object(D.b)(o),t.addCustomData({error:p}),t.endWithError("ServerError",new Error(p)),s.c.loadGroupsError=!0),Q=!1,[2,Promise.resolve()]}var d}))}))})),Z=Object(A.d)("loadGroupsFromSessionData",{name:"LoadGroupsInLeftNavFromSessionData",options:{}})((function(){if(!Q){Q=!0;var e=Object(K.a)();if(!e)return G.g.info("GroupsSets data is not available in session data"),void(Q=!1);ee(e.UnifiedGroupsSets),Q=!1}}));function ee(e){if(e){s.c.myOrgGroups=[];var t=Object(E.j)();e.forEach((function(e){e.Groups.forEach((function(e){s.c.myOrgGroups.push(e.SmtpAddress.toLowerCase()),Object(S.a)(t,e.SmtpAddress,{basicInformation:e,groupDetails:null,members:null})}))}))}Object(p.b)(),Object(h.a)(y)}var te=r(19),re=r(451);function ne(){var e=!Object(te.a)().UserOptions.IsGroupsTreeCollapsed;Object(re.a)((function(t){t.UserOptions.IsGroupsTreeCollapsed=e}),[{key:"IsGroupsTreeCollapsed",valuetype:"Boolean",value:[String(e)]}])}function oe(e){return Object(n.a)({__type:"SetUnifiedGroupLastVisitedTimeJsonRequest:#Exchange"},e)}var ie=r(2190);function ae(e){var t,r,i,a=Object(ie.a)({Type:0,Value:e});void 0===(t=oe({Header:Object(w.b)(),Body:(i={GroupIdentity:a,LastVisitedTimeUtc:(new Date).toISOString(),PreserveReadState:!0},Object(n.a)({__type:"SetUnifiedGroupLastVisitedTimeRequest:#Exchange"},i))}))||t.__type||(t=oe(t)),Object(o.a)("SetUnifiedGroupLastVisitedTime",t,r)}r.d(t,"loadGroups",(function(){return $})),r.d(t,"loadGroupsFromSessionData",(function(){return Z})),r.d(t,"removeGroupFromLeftNav",(function(){return l})),r.d(t,"toggleGroupTreeExpansion",(function(){return ne})),r.d(t,"unsubscribeFromUnreadNotifications",(function(){return p.c})),r.d(t,"setGroupLastVisitedTime",(function(){return ae}))},730:function(e,t,r){"use strict";var n=r(2),o=Object(n.action)("initializeOwaObservableDateTime"),i=Object(n.action)("observableNowChanged"),a=Object(n.action)("observableTodayChanged"),u=r(5),c=r(14),s=Object(n.createStore)("ObservableDateTime",{now:0,today:0}),p=Object(c.computed)((function(){return Object(u.nc)(s().now)})),d=function(){return p.get()},l=Object(c.computed)((function(){return Object(u.nc)(s().today)})),f=function(){return l.get()},b=function(e){return Object(u.Hb)(e,d())},v=function(e){return Object(u.Fb)(e,d())},g=function(e){return m(e,u.Hb)},O=function(e){return m(e,u.Ib)},m=function(e,t){return t(Object(u.Yb)(Object(u.nc)(e)),f())};function j(e){if(!e)return"";var t=Object(u.nc)(e);return function(e,t){var r=Object(u.Yb)(e);if(Object(u.Jb)(r,t))return u.ab;var n=function(e){return Object(u.Ob)(r,Object(u.e)(t,-e),t)};if(n(3))return u.ib;if(n(30))return u.hb;return u.Y}(t,f())(t)}function h(e){if(!e)return"";var t=Object(u.nc)(e);return function(e,t){var r=Object(u.Yb)(e);if(Object(u.Jb)(r,t))return u.T;return u.U}(t,f())(t)}function y(e){return e?function(e,t){var r=Object(u.Yb)(e);return Object(u.Jb)(r,t)?Object(u.ab)(e):D(r,t,2)?Object(u.lb)(e):D(r,t,7)?Object(u.H)(Object(u.bb)(e),Object(u.ab)(e)):Object(u.H)(Object(u.J)(e),Object(u.ab)(e))}(Object(u.nc)(e),f()):""}function D(e,t,r){return Object(u.Ob)(e,Object(u.e)(t,-r),t)}var S=Object(n.action)("updateTimes"),I=Object(n.action)("setNow"),T=Object(n.action)("setToday",(function(e){return{today:e}}));Object(n.mutator)(I,(function(){s().now=Object(u.lc)()})),Object(n.mutator)(T,(function(e){var t=e.today;s().today=t}));var w=r(21),G=r(79),A=!1;Object(n.orchestrator)(o,(function(){if(S(),!A){var e=Object(u.Rb)(),t=Object(u.ac)(Object(u.h)(e,1)),r=Object(u.w)(t,e);setTimeout((function(){return setInterval(S,w.g)}),r),document&&document.addEventListener("visibilitychange",S),A=!0}})),Object(n.orchestrator)(G.l,(function(){S()})),Object(n.orchestrator)(S,(function(){I();var e=Object(u.Ab)(Object(u.mc)()),t=s().today!=e;t&&T(e),i(),t&&a()})),r.d(t,"d",(function(){return o})),r.d(t,"j",(function(){return i})),r.d(t,"l",(function(){return a})),r.d(t,"i",(function(){return d})),r.d(t,"k",(function(){return f})),r.d(t,"g",(function(){return b})),r.d(t,"e",(function(){return v})),r.d(t,"f",(function(){return g})),r.d(t,"h",(function(){return O})),r.d(t,"a",(function(){return j})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return y}))},7426:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return u})),r.d(t,"e",(function(){return c})),r.d(t,"d",(function(){return s}));var n=r(31),o=new n.c((function(){return Promise.all([r.e(54),r.e(152),r.e(664)]).then(r.bind(null,10399))})),i=new n.a(o,(function(e){return e.loadGroupAction})),a=new n.a(o,(function(e){return e.onAfterNewGroupSelectedAction})),u=new n.a(o,(function(e){return e.onAfterGroupDetailsSucceededAction})),c=new n.a(o,(function(e){return e.setGroupIsSubscribedAction})),s=new n.a(o,(function(e){return e.setGroupIsMemberAction}))},8987:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(298);function o(){return Object(n.a)().groups}}}]);
//# sourceMappingURL=owa.MailBoot~GroupList.js.map
self.scriptsLoaded['owa.MailBoot~GroupList.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~GroupList.js'] = (new Date()).getTime();