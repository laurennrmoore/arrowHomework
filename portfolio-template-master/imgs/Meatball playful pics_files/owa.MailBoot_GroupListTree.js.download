self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~GroupListTree.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[662],{14242:function(e){e.exports=JSON.parse('{"a":"mXc"}')},14243:function(e){e.exports=JSON.parse('{"a":"kXc"}')},14244:function(e){e.exports=JSON.parse('{"a":"lXc"}')},14245:function(e){e.exports=JSON.parse('{"a":"_Wc"}')},14246:function(e){e.exports=JSON.parse('{"c":"$Wc","b":"aXc","a":"bXc"}')},14247:function(e,t,n){var r=n(14248),o=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var c=0;c<r.length;c++)o.loadStyles(r[c][1],!1);r.locals&&(e.exports=r.locals)},14248:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'.-pJvQw8WCSS64u4yeesBP{color:#e81123}html[dir] .-pJvQw8WCSS64u4yeesBP{padding-top:8px}html[dir=ltr] .-pJvQw8WCSS64u4yeesBP{padding-left:5px}html[dir=rtl] .-pJvQw8WCSS64u4yeesBP{padding-right:5px}.-pJvQw8WCSS64u4yeesBP:hover{color:"[theme:redDark, default:#a80000]"}',""]),t.locals={errorIcon:"-pJvQw8WCSS64u4yeesBP"}},17846:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n(2),c=Object(o.action)("openCreateGroup"),i=Object(o.action)("openDiscoverGroups"),u=n(6093),a=n(6094),s=n(2943),d=n(2836),l=n(2236),p=n(19),b=n(197),f=n(24),m=n(2014);function O(e){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(t){switch(t.label){case 0:return e?Object(s.b)().myOrgGroups.includes(e)?[3,2]:[4,d.a.import()]:[3,4];case 1:t.sent()(),t.label=2;case 2:return[4,l.h.importAndExecute(e,"groups")];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))}Object(o.orchestrator)(c,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var e,t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return!Object(f.i)("grp-shareable-crud")&&!Object(m.a)().isSensitivityLabelsEnabled||Object(b.a)()?[3,2]:[4,a.a.import()];case 1:return t=n.sent(),e=Object(p.a)().SessionSettings,t(e.ExternalDirectoryUserGuid,e.UserLanguage,e.UserCulture,"OWA_LeftNav",O),[3,4];case 2:return[4,u.b.import()];case 3:(t=n.sent())(Object(b.a)()?u.a.Consumer:u.a.Enterprise,Object(p.a)().SessionSettings.UserCulture,"OWA",O),n.label=4;case 4:return[2]}}))}))}));var j=n(9445),g=n(2245);function v(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return e?(t=e.smtpAddress.toLowerCase(),Object(s.b)().myOrgGroups.includes(t)?[3,2]:[4,d.a.import()]):[3,3];case 1:n.sent()(),n.label=2;case 2:l.h.importAndExecute(t,"groups"),n.label=3;case 3:return[2]}}))}))}Object(o.orchestrator)(i,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var e,t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,j.b.import()];case 1:return e=n.sent(),t=Object(p.a)(),Object(g.k)(t.SessionSettings.UserEmailAddress,t.SessionSettings.UserCulture),e(Object(b.a)()?j.a.Consumer:j.a.Enterprise,t.SessionSettings.UserCulture,"OWA",v),[2]}}))}))}));var h=n(20),C=n(14242),I=n(8222),y=n(6),E=n(1082),w=n(14243),S=n(4204),x=n(6606),G=n(6607),M=n(5474),N=n(4825),R=n(1985),A=n(5205),D=n(3361),k=n(2046),L=n(2406),P=n(2044),J=n(102),F=n(0),B=n(805),T=n(60),_=Object(h.a)((function(e){var t,n,o=this,c=Object(E.a)((function(){var t=e.groupId.toLowerCase();return Object(k.j)().groups.get(t)})),i=function(){var t=c.get().basicInformation.SmtpAddress,n=Object(D.a)(t,Object(D.b)()),r=Object(P.c)(n);L.b.importAndExecute("ContextMenu",r.virtualSelectAllExclusionList,!0,!0,[],r),e.onDismiss()},u=function(){return Object(r.c)(o,void 0,void 0,(function(){return Object(r.f)(this,(function(t){switch(t.label){case 0:return[4,A.b.import()];case 1:return t.sent()(c.get().basicInformation.SmtpAddress),e.onDismiss(),[2]}}))}))},a=function(){var t=document.createElement("input"),n=c.get().basicInformation.DisplayName+" <"+c.get().basicInformation.SmtpAddress+">";t.className="screenReaderOnly",document.body.appendChild(t);try{if(t.value=n,t.select(),!document.execCommand("copy"))throw new Error}catch(e){var r=Object(J.l)()?Object(y.b)(G.a):Object(y.b)(x.a);window.prompt(r,n)}finally{document.body.removeChild(t)}e.onDismiss()},s=e.anchorPoint,d=e.onDismiss,l=(t=Object(R.isGroupInFavorites)(c.get().basicInformation.SmtpAddress),n=[W("markAllAsRead",Object(y.b)(S.a),!1,i),W("copyEmailAddress",Object(y.b)(w.a),!1,a)],Object(f.i)("tri-favorites-roaming")&&n.push(W(t?"removeFromFavorites":"addToFavorites",t?Object(y.b)(N.a):Object(y.b)(M.a),!1,u)),n);return e.commonContextMenuItems&&(l=l.concat(e.commonContextMenuItems)),F.createElement(B.a,{shouldFocusOnMount:!0,target:s,directionalHint:T.a.bottomLeftEdge,onDismiss:d,items:l})}));function W(e,t,n,r){return{key:e,name:t,disabled:n,onClick:r}}var U=n(514),X=n(41),H=n(121),Q=n(1993),K=n(2117);function q(){var e,t=Object(K.b)(),n=Object(Q.a)().groups,r=t.myOrgGroups.some((function(t){var r,o,c;return(null===(r=(e=n.get(t)).groupDetails)||void 0===r?void 0:r.UserGroupRelationship)?e.groupDetails.UserGroupRelationship.IsOwner:null===(c=null===(o=e.basicInformation)||void 0===o?void 0:o.AdditionalProperties)||void 0===c?void 0:c.IsOwner}))||0===t.myOrgGroups.length;Object(H.s)("ManageGroupClicked");var o=Object(X.a)().search,c=Object(U.i)(r)+o;c+=(o?"&":"?")+"source=ManageGroups",window.open(c.toString(),"_blank")}var z=n(57),V=Object(h.a)((function(e){var t,n,r,o,u=function(){c(),e.onDismiss()},a=function(){i(),e.onDismiss()},s=e.anchorPoint,d=e.onDismiss,l=(t=Object(k.l)().groupCreationEnabled,n=!Object(z.s)()&&Object(f.i)("grp-discovery-leftnav"),r=!Object(z.s)(),o=[],t&&o.push($("newGroup",Object(y.b)(I.e),!1,u)),n&&o.push($("discoverGroups",Object(y.b)(I.a),!1,a)),r&&o.push($("manageGroups",Object(y.b)(I.b),!1,Y)),o);return F.createElement(B.a,{shouldFocusOnMount:!0,target:s,directionalHint:T.a.bottomLeftEdge,onDismiss:d,items:l})}));function $(e,t,n,r){return{key:e,name:t,disabled:n,onClick:r}}function Y(){q()}var Z=n(3435),ee=n(4398),te=Object(h.a)((function(e){var t=e.groupId,n=Object(k.j)().groups.get(e.groupId.toLowerCase()),r=n?n.unreadMessageCount:null;return F.createElement(ee.a,{count:r,isSelected:Object(l.a)(t,"groups")})})),ne=n(14244),re=n(1553),oe=n(1301),ce=n(265),ie=Object(h.a)((function(e){return F.createElement(re.a,{content:Object(y.b)(ne.a),calloutProps:{gapSpace:0}},F.createElement(oe.a,{size:ce.a.small,title:""}))})),ue=Object(h.a)((function(e){return Object(Z.a)(e.groupId).isDroppingMessage?F.createElement(ie,null):F.createElement(te,{groupId:e.groupId,key:e.groupId+Object(z.d)()})})),ae=Object(h.a)((function(e){return Object(Z.a)(e.groupId).isDroppingMessage?F.createElement(ie,null):F.createElement(te,{groupId:e.groupId})})),se=n(14245),de=n(731),le=n(3279),pe=n(14246),be=Object(o.mutatorAction)("setGroupDragDropActionState",(function(e,t){Object(K.b)().groupNodeViewStates.get(e).isDroppingMessage=t})),fe=n(2133),me=n(7891),Oe=n(5870),je=n(4920),ge=n(8717),ve=n(4088),he=n(6801),Ce=n(984);function Ie(e,t,n,r){n.addCustomData({error:r}),n.endWithError("ServerError",new Error(r)),Object(de.b)(1==t?Object(y.b)(pe.c):Object(y.b)(I.c),1==t?Object(y.c)(Object(y.b)(pe.b),e):Object(y.c)(Object(y.b)(pe.a),e),!1,{hideCancelButton:!0}),be(e,!1)}function ye(e,t){e.rowKeys.length>le.b?Object(de.b)(Object(y.b)(I.c),Object(y.c)(Object(y.b)(se.a),le.b),!1,{hideCancelButton:!0}):function(e,t){var n=new H.b("dragDropToGroup");be(t,!0);var r=e.rowKeys,o=e.tableViewId,c=fe.a.tableViews.get(o),i=Object(D.a)(t,Object(D.b)()),u=Object(Oe.a)(c)?Object(je.a)(r,o):Object(ge.a)(r,o),a={headers:{"X-OWA-ExplicitLogonUser":i.folderId,"X-AnchorMailbox":i.folderId,"X-OWA-ActionName":"GroupMailbox"}};Object(he.a)(u,Object(Ce.a)({BaseFolderId:Object(me.a)(i)}),!0,a).then((function(e){var r=function(e){if(!e||!e.ResponseMessages||!e.ResponseMessages.Items)return null;for(var t={successfulItems:[],failedItemCount:0},n=0;n<e.ResponseMessages.Items.length;n++){var r=e.ResponseMessages.Items[n];r&&"Success"==r.ResponseClass?t.successfulItems.push(r.Items[0].ItemId.Id):(t.failedItemCount++,r&&(t.lastResponseCode=r.ResponseCode))}return t}(e);if(r&&r.failedItemCount<1){n.end();var o=u.map((function(e){return{Id:e}}));Object(ve.a)(o,"HardDelete"),be(t,!1)}else Ie(t,u.length,n,r.lastResponseCode?r.lastResponseCode:"UnknownError")})).catch((function(e){Ie(t,u.length,n,JSON.stringify(e))}))}(e,t)}var Ee=n(7806),we=n(2434),Se=n(2597),xe=n(2321),Ge=n(183),Me=Object(Ge.action)("showGroupContextMenu")((function(e,t,n,r,o){e.withContextMenuGroup={groupId:t,group:n,anchor:r,isRootNode:o}})),Ne=Object(Ge.action)("hideGroupContextMenu")((function(e){e.withContextMenuGroup=null})),Re=n(1970),Ae=n(424),De=n(14247),ke=Object(K.b)(),Le=Object(k.j)(),Pe=1e3,Je=Object(h.a)((function(e){var t=Object(p.a)().UserOptions.IsGroupsTreeCollapsed;return F.createElement(s.a,{className:e.className,selectGroup:We,isSelected:Ue,isGroupsTreeCollapsed:t,toggleGroupTreeExpansion:Xe,renderGroupListCustomNodes:ut,renderRightCharm:Te,renderRightCharmHover:_e,onChildNodeContextMenuOpened:Qe,renderChildNodeContextMenu:tt,onRootNodeContextMenuOpened:Ke,renderRootNodeContextMenu:nt,renderRootNodeRightCharm:Fe,renderRootNodeRightCharmHover:Fe,onListNodeDrop:Ze,canDropOnListNode:et,onMouseEnterShowMoreButton:He,onShowMoreEvent:He,setSize:e.setSize,positionInSet:e.positionInSet})}));function Fe(){return ke.loadGroupsError?F.createElement(re.a,{content:Object(y.b)(C.a),directionalHint:T.a.bottomCenter},F.createElement(Ae.a,{className:De.errorIcon,title:"",iconName:"Error",ariaLabel:Object(y.b)(C.a)})):null}function Be(){Ne(ke)}function Te(e,t){return F.createElement(ue,{groupId:e})}function _e(e,t){return F.createElement(ae,{groupId:e})}function We(e,t){l.h.importAndExecute(e,"groups"),Object(f.i)("tri-floodgateForConsumerGroups")&&Object(z.s)()&&setTimeout((function(){Se.b.import().then((function(e){e("ConsumerGroupsClicked")}))}),Pe)}function Ue(e,t){return Object(l.a)(e,"groups")}function Xe(){d.e.importAndExecute()}function He(){Object(f.i)("grp-unreadCountTop5AndFavorites")&&Object(Ee.a)()}function Qe(e,t){Me(ke,t.basicInformation.SmtpAddress,t,Object(we.a)(e),!1)}function Ke(e){var t=Object(m.a)().groupCreationEnabled,n=!Object(z.s)()&&Object(f.i)("grp-discovery-leftnav");if(!t&&!n)return null;Me(ke,null,null,Object(we.a)(e),!0)}function qe(e){e.stopPropagation(),e.preventDefault()}function ze(e){e.stopPropagation(),c()}function Ve(e){e.stopPropagation();window.open("https://account.microsoft.com/family/")}function $e(e){e.stopPropagation(),i()}function Ye(e){e.stopPropagation(),q()}function Ze(e,t){switch(e.itemType){case Re.a.MultiMailListMessageRows:case Re.a.MailListRow:ye(e,t)}}function et(e){switch(e.itemType){case Re.a.MultiMailListMessageRows:case Re.a.MailListRow:return"move";default:return"none"}}function tt(e){return F.createElement(_,{anchorPoint:e.anchor,groupId:e.group.basicInformation.SmtpAddress,onDismiss:Be})}function nt(e){return F.createElement(V,{anchorPoint:e.anchor,onDismiss:Be})}function rt(e){return Object(m.a)().groupCreationEnabled?F.createElement("div",null,!e&&F.createElement(xe.a,{displayName:Object(y.b)(I.e),isCustomActionNode:!0,isRootNode:!1,key:"NewGroup",onClick:ze,onContextMenu:qe})):null}function ot(e){if(!(Object(z.s)()&&Object(f.i)("grp-create-family-group")))return null;var t=ke.hasLoadedFromServer&&function(){var e,t,n;try{for(var o=Object(r.k)(ke.myOrgGroups),c=o.next();!c.done;c=o.next()){var i=c.value,u=Le.groups.get(i);if(3==(null===(n=null==u?void 0:u.basicInformation)||void 0===n?void 0:n.Kind))return!0}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return!1}();return F.createElement("div",null,!e&&!t&&F.createElement(xe.a,{displayName:Object(y.b)(I.d),isCustomActionNode:!0,isRootNode:!1,key:"NewFamilyGroup",onClick:Ve,onContextMenu:qe}))}function ct(e){return!Object(z.s)()&&Object(f.i)("grp-discovery-leftnav")?F.createElement("div",null,!e&&F.createElement(xe.a,{displayName:Object(y.b)(I.a),isCustomActionNode:!0,isRootNode:!1,key:"DiscoverGroups",onClick:$e,onContextMenu:qe})):null}function it(e){return Object(z.s)()?null:(Object(H.s)("ManageGroupsRendered"),F.createElement("div",null,!e&&F.createElement(xe.a,{displayName:Object(y.b)(I.b),isCustomActionNode:!0,isRootNode:!1,key:"ManageGroups",onClick:Ye,onContextMenu:qe})))}function ut(){var e=Object(p.a)().UserOptions.IsGroupsTreeCollapsed;return[rt(e),ot(e),ct(e),it(e)]}n.d(t,"GroupListTree",(function(){return Je})),n.d(t,"GroupRightCharm",(function(){return ue})),n.d(t,"GroupRightCharmHover",(function(){return ae})),n.d(t,"GroupDragDropSpinner",(function(){return ie})),n.d(t,"GroupContextMenu",(function(){return _})),n.d(t,"dropMailListRowsOnGroup",(function(){return ye}))},2235:function(e,t,n){"use strict";var r,o;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),function(e){e[e.Consumer=0]="Consumer",e[e.Enterprise=1]="Enterprise"}(r||(r={})),function(e){e[e.SmtpAddress=0]="SmtpAddress",e[e.ExternalDirectoryObjectId=1]="ExternalDirectoryObjectId"}(o||(o={}))},2597:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return i}));var r=n(31),o=new r.c((function(){return Promise.all([n.e(21),n.e(24),n.e(64),n.e(68),n.e(641)]).then(n.bind(null,4145))})),c=new r.a(o,(function(e){return e.loadAndInitializeFloodgateEngine})),i=new r.b(o,(function(e){return e.logFloodgateActivity}))},3704:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){return Object(r.a)({__type:"DeleteItemJsonRequest:#Exchange"},e)}},3846:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){return Object(r.a)({__type:"DeleteItemRequest:#Exchange"},e)}},3847:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(33),o=n(3704);function c(e,t){return void 0===e||e.__type||(e=Object(o.a)(e)),Object(r.a)("DeleteItem",e,t)}},4088:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3846),o=n(439),c=n(3847),i=n(180);function u(e,t){return Object(r.a)({ItemIds:e.map((function(e){return t=e,Object(o.a)({Id:t.Id,ChangeKey:t.ChangeKey});var t})),DeleteType:t,SuppressReadReceipts:!0,ReturnMovedItemIds:!0,SendMeetingCancellations:"SendToNone",AffectedTaskOccurrences:"AllOccurrences"})}function a(e,t,n){var r=u(e,t);return Object(c.a)({Header:Object(i.b)(),Body:r},n).then((function(e){return e.Body.ResponseMessages.Items}))}},4920:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2559);function o(e,t){var n={};return e.forEach((function(e){var o,c=null===(o=Object(r.a)(e,t))||void 0===o?void 0:o.itemIds;c&&c.forEach((function(e){n[e]||(n[e]=!0)}))})),Object.keys(n)}},5205:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return i}));var r=n(31),o=new r.c((function(){return n.e(474).then(n.bind(null,7767))})),c=Object(r.d)(o,(function(e){return e.GroupFavoriteButton})),i=new r.b(o,(function(e){return e.toggleFavoriteGroup}))},6093:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(31),o=n(2235);n.d(t,"a",(function(){return o.b}));var c=new r.c((function(){return Promise.all([n.e(4),n.e(5),n.e(6),n.e(8),n.e(10),n.e(18),n.e(20),n.e(23),n.e(54),n.e(70),n.e(85),n.e(95),n.e(184),n.e(185),n.e(260),n.e(262),n.e(652)]).then(n.bind(null,8505))})),i=new r.b(c,(function(e){return e.createGroup}))},6094:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(31),o=new r.c((function(){return Promise.all([n.e(4),n.e(6),n.e(8),n.e(30),n.e(33),n.e(35),n.e(36),n.e(39),n.e(44),n.e(51),n.e(54),n.e(62),n.e(67),n.e(74),n.e(73),n.e(79),n.e(83),n.e(86),n.e(88),n.e(101),n.e(115),n.e(151),n.e(261),n.e(653)]).then(n.bind(null,8562))})),c=new r.b(o,(function(e){return e.createGroup}))},6598:function(e,t,n){"use strict";var r,o;n.d(t,"a",(function(){return r})),function(e){e[e.Consumer=0]="Consumer",e[e.Enterprise=1]="Enterprise"}(r||(r={})),function(e){e[e.SmtpAddress=0]="SmtpAddress",e[e.ExternalDirectoryObjectId=1]="ExternalDirectoryObjectId"}(o||(o={}))},6606:function(e){e.exports=JSON.parse('{"a":"s4a"}')},6607:function(e){e.exports=JSON.parse('{"a":"r4a"}')},6801:function(e,t,n){"use strict";var r=n(8182),o=n(1);var c=n(33);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(o.a)({__type:"CopyItemJsonRequest:#Exchange"},n)),Object(c.a)("CopyItem",e,t)}var u=n(180);function a(e,t,n,c){var a=function(e,t,n){return c={ToFolderId:t,ItemIds:Object(r.a)(e),ReturnNewItemIds:!0,RemoteExecute:n},Object(o.a)({__type:"CopyItemRequest:#Exchange"},c);var c}(e,t,n);return i({Header:Object(u.b)(),Body:a},c).then((function(e){return e.Body}))}n.d(t,"a",(function(){return a}))},8182:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(439);function o(e){return e.map((function(e){return Object(r.a)({Id:e})}))}},8222:function(e){e.exports=JSON.parse('{"c":"cXc","e":"dXc","d":"eXc","a":"fXc","b":"gXc"}')},9445:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(31),o=n(6598);n.d(t,"a",(function(){return o.a}));var c=new r.c((function(){return Promise.all([n.e(4),n.e(10),n.e(13),n.e(14),n.e(20),n.e(54),n.e(149),n.e(253),n.e(476)]).then(n.bind(null,12227))})),i=new r.b(c,(function(e){return e.discoverGroups}))}}]);
//# sourceMappingURL=owa.MailBoot~GroupListTree.js.map
self.scriptsLoaded['owa.MailBoot~GroupListTree.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~GroupListTree.js'] = (new Date()).getTime();