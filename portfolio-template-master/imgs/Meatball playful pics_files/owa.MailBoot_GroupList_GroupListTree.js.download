self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~GroupList~GroupListTree.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[265],{1993:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2),o=n(14),u=Object(r.createStore)("groupsStore",{groups:new o.ObservableMap})},2009:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1993);function o(t){var e=Object(r.a)().groups.get(t.toLowerCase());return e?e.groupDetails:null}},2014:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2),o=n(2068),u=Object(r.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:o.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},2020:function(t,e,n){"use strict";var r;!function(t){t[t.None=0]="None",t[t.Executing=1]="Executing",t[t.Succeed=2]="Succeed",t[t.FailureNotice=3]="FailureNotice",t[t.FailureRetry=4]="FailureRetry"}(r||(r={})),e.a=r},2046:function(t,e,n){"use strict";var r=n(2),o=n(14),u=(Object(r.createStore)("personaPhotoStore",{personaPhotoUrls:new o.ObservableMap})(),n(2139),n(2068),n(1993)),i=n(2014),a=n(2009);function c(t){var e=Object(u.a)().groups.get(t.toLowerCase());return!!e&&!e.groupDetailsError}var s=n(2073),p=n(2180),d=n(2047),f=Object(r.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(t,e,n,r){if(2==e){var o=Object(a.a)(t);Object(s.a)(o,"Site")[0].Url=n,Object(s.a)(o,"Files")[0].Url=r}})),l=n(2149);function b(t){return t=t.toLocaleLowerCase(),Object(d.a)().groupSiteStatus.has(t)?Object(d.a)().groupSiteStatus.get(t):0}var g=function(t){var e="string"==typeof t?Object(a.a)(t):t;return e?e.ExternalDirectoryObjectId:null},v=(n(2020),n(2144),n(2134),n(2150),n(2145),n(2393)),h=n(2394),O=n(2411),S=n(2379),m=n(2380),j=n(6);function C(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(j.b)(S.a);if(3===e)return Object(j.b)(m.a)}return""}function N(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(j.b)(O.b);if(3===e)return Object(j.b)(O.c)}return""}function w(t){var e=0;return t.members?e=t.members.totalCount:t.groupDetails&&(e=t.groupDetails.MemberCount),e?e>1?Object(j.c)(Object(j.b)(h.a),e.toString()):Object(j.c)(Object(j.b)(v.a),e.toString()):Object(j.b)(O.a)}n.d(e,"j",(function(){return u.a})),n.d(e,"l",(function(){return i.a})),n.d(e,"d",(function(){return a.a})),n.d(e,"m",(function(){return c})),n.d(e,"f",(function(){return s.a})),n.d(e,"g",(function(){return s.b})),n.d(e,"c",(function(){return p.a})),n.d(e,"i",(function(){return d.a})),n.d(e,"o",(function(){return f})),n.d(e,"n",(function(){return l.b})),n.d(e,"h",(function(){return b})),n.d(e,"e",(function(){return g})),n.d(e,"a",(function(){return C})),n.d(e,"b",(function(){return N})),n.d(e,"k",(function(){return w}))},2047:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2),o=n(14),u=Object(r.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new o.ObservableMap})},2068:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Private=0]="Private",t[t.Public=1]="Public"}(r||(r={}))},2073:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return u}));var r=n(2009),o=function(t,e){var n="string"==typeof t?Object(r.a)(t):t;if(!n||!n.GroupResources)return null;var o=n.GroupResources.filter((function(t){return t.Name===e}));return!o||o.length<1?null:o},u=function(t,e){var n=o(t,e);return n&&0!=n.length?n[0].Url:null}},2134:function(t,e,n){"use strict";var r=n(2),o=n(2198),u=Object(r.mutatorAction)("setJoinButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=u},2139:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(24),o=n(2014),u=n(57);function i(){return(Object(r.i)("grp-shareable-crud")||Object(o.a)().isSensitivityLabelsEnabled)&&!Object(u.s)()}},2144:function(t,e,n){"use strict";var r=n(2),o=n(2197),u=Object(r.mutatorAction)("setFollowButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=u},2145:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2020),o=n(2198);function u(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},2149:function(t,e,n){"use strict";n.d(e,"b",(function(){return u}));var r=n(2),o=n(2047),u=Object(r.mutatorAction)("setGroupSiteStatus",(function(t,e){t=t.toLocaleLowerCase(),Object(o.a)().groupSiteStatus.has(t)&&e==Object(o.a)().groupSiteStatus.get(t)||Object(o.a)().groupSiteStatus.set(t,e)}));e.a=u},2150:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2020),o=n(2197);function u(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},2180:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2094),o=function(){return Object(r.a)().smtpAddress}},2197:function(t,e,n){"use strict";var r=n(2),o=n(14);e.a=Object(r.createStore)("followButtonStore",{groupActionState:new o.ObservableMap})()},2198:function(t,e,n){"use strict";var r=n(2),o=n(14);e.a=Object(r.createStore)("joinButtonStore",{groupActionState:new o.ObservableMap})()},2245:function(t,e,n){"use strict";var r,o,u,i,a,c,s,p,d,f,l,b,g,v,h;var O;n(6);function S(t,e){e,O=t}function m(){return O}n.d(e,"o",(function(){return r})),n.d(e,"n",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"g",(function(){return c})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return p})),n.d(e,"l",(function(){return d})),n.d(e,"m",(function(){return f})),n.d(e,"q",(function(){return l})),n.d(e,"r",(function(){return b})),n.d(e,"h",(function(){return g})),n.d(e,"j",(function(){return v})),n.d(e,"e",(function(){return h})),n.d(e,"p",(function(){})),n.d(e,"k",(function(){return S})),n.d(e,"i",(function(){return m}))},2379:function(t){t.exports=JSON.parse('{"a":"T1a"}')},2380:function(t){t.exports=JSON.parse('{"a":"S1a"}')},2393:function(t){t.exports=JSON.parse('{"a":"R1a"}')},2394:function(t){t.exports=JSON.parse('{"a":"X1a"}')},2411:function(t){t.exports=JSON.parse('{"b":"U1a","c":"V1a","a":"W1a"}')},2943:function(t,e,n){"use strict";var r=n(2117),o=n(2),u=Object(o.mutatorAction)("toggleIsShowingAllGroups",(function(){Object(r.b)().shouldShowAllGroups=!Object(r.b)().shouldShowAllGroups})),i=n(1),a=n(20),c=n(3490),s=n(6),p=n(3551),d=n(858),f=n(214),Droppable=n(2023),l=n(2046),b=n(0),g=n(1970),v=n(3435),h=n(1985),O=n(24),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onContextMenu=function(t,n){var r=e.props,o=r.onContextMenu,u=r.groupId;if(o){t.stopPropagation(),t.preventDefault();var i=u.toLowerCase(),a=Object(l.j)().groups;if(a.has(i))o(t,a.get(i))}},e.onDrop=function(t){e.props.onListNodeDrop&&e.props.onListNodeDrop(t,e.props.groupId)},e}return Object(i.e)(e,t),e.prototype.shouldComponentUpdate=function(t,e){return!Object(f.e)(this.props,t)},e.prototype.render=function(){var t=Object(v.a)(this.props.groupId);return b.createElement(Droppable.b,{dropViewState:t.drop,onDrop:this.onDrop,canDrop:this.props.canDropOnListNode},b.createElement(p.a,{selectGroup:this.props.selectGroup,isSelected:this.props.isSelected,renderRightCharm:this.props.renderRightCharm,renderRightCharmHover:this.props.renderRightCharmHover,chevronProps:null,customIcon:null,displayName:this.props.displayName,groupId:this.props.groupId,isDroppedOver:t.drop.isDragOver,onContextMenu:this.onContextMenu,renderCustomTreeNodeDisplay:null,customData:this.props.customData,showHoverStateOnDroppedOver:t.drop.draggableItemType==g.a.MailListRow||t.drop.draggableItemType==g.a.MultiMailListMessageRows,isFavorited:Object(O.i)("mon-tri-leftNavChanges")&&Object(h.isGroupInFavorites)(this.props.groupId)}))},e=Object(i.d)([d.observer],e)}(b.Component),m=n(3279),j=n(1977),C=n(121),N=n(2321),w=n(1984),D=Object(l.j)(),y=Object(r.b)(),A=Object(a.a)((function(t){var e,n,o,a=b.useRef(!1),p=function(e){return b.createElement(S,{selectGroup:t.selectGroup,isSelected:t.isSelected,renderRightCharm:t.renderRightCharm,renderRightCharmHover:t.renderRightCharmHover,displayName:e.DisplayName,groupId:e.SmtpAddress,key:e.SmtpAddress,onContextMenu:t.onChildNodeContextMenuOpened,customData:t.customData,onListNodeDrop:t.onListNodeDrop,canDropOnListNode:t.canDropOnListNode})},d=function(e){e.stopPropagation(),t.toggleGroupTreeExpansion()},f=function(e){var n=t.onRootNodeContextMenuOpened;n&&(e.stopPropagation(),e.preventDefault(),n(e))},l=function(e){return!(y.shouldShowAllGroups||!t.canDropOnListNode)&&t.canDropOnListNode(e)},g=function(t){a.current=!0,setTimeout((function(){a.current&&!Object(r.b)().shouldShowAllGroups&&O()}),1e3)},v=function(){a.current=!1},h=function(t){t.stopPropagation(),O()},O=function(){var e=y.myOrgGroups.length;Object(C.s)("GroupList_ToggleShouldShowAllGroups",{isShowMore:!y.shouldShowAllGroups,joinedGroupCount:e>=21?"21+":e}),t.onShowMoreEvent&&t.onShowMoreEvent(),u()},A=y.myOrgGroups,E={role:j.a.tree},R=t.isGroupsTreeCollapsed;return b.createElement("div",Object(i.a)({style:t.style,className:t.className},Object(j.b)(E)),function(e){var n={isExpanded:!e,onClick:d};return b.createElement(N.a,{chevronProps:n,depth:0,displayName:Object(s.b)(c.a),isRootNode:!0,key:"Groups_root",onClick:n.onClick,onContextMenu:f,renderRightCharm:t.renderRootNodeRightCharm,renderRightCharmHover:t.renderRootNodeRightCharmHover,setSize:t.setSize,positionInSet:t.positionInSet})}(R),function(t,e){var n=[];if(e)return n;if(y.shouldShowAllGroups){var r=[];t.forEach((function(t){var e=D.groups.get(t);r.push(e)})),r.sort((function(t,e){return t.basicInformation.DisplayName.localeCompare(e.basicInformation.DisplayName)})).forEach((function(t){n.push(p(t.basicInformation))}))}else t.slice(0,m.a).forEach((function(t){var e=D.groups.get(t);n.push(p(e.basicInformation))}));return n}(A,R),y.withContextMenuGroup&&(y.withContextMenuGroup.isRootNode?null===(e=t.renderRootNodeContextMenu)||void 0===e?void 0:e.call(t,y.withContextMenuGroup):null===(n=t.renderChildNodeContextMenu)||void 0===n?void 0:n.call(t,y.withContextMenuGroup)),A.length>m.a&&function(e){if(e)return null;var n=y.shouldShowAllGroups?Object(s.b)(c.b):Object(s.b)(c.c),r=Object(w.a)();return b.createElement(Droppable.b,{dropViewState:r,onDrop:G,canDrop:l,onDragOver:g,onDragLeave:v},b.createElement(N.a,{displayName:n,isCustomActionNode:!0,isRootNode:!1,key:"groupsCollapseExpandNode",onClick:h,onContextMenu:M,onMouseEnter:t.onMouseEnterShowMoreButton}))}(R),null===(o=t.renderGroupListCustomNodes)||void 0===o?void 0:o.call(t))}));function G(){}function M(t){t.stopPropagation(),t.preventDefault()}n.d(e,"c",(function(){return r.a})),n.d(e,"b",(function(){return r.b})),n.d(e,"a",(function(){return A}))},3279:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var r=5,o=100},3435:function(t,e,n){"use strict";var r=n(2117),o=n(2159),u=n(1984),i=n(2),a=Object(i.mutatorAction)("setGroupNodeViewStateMutator",(function(t,e){Object(r.b)().groupNodeViewStates.set(t,e)}));function c(t){return Object(r.b)().groupNodeViewStates.has(t)||a(t,{drag:Object(o.a)(),drop:Object(u.a)(),isDroppingMessage:!1}),Object(r.b)().groupNodeViewStates.get(t)}n.d(e,"a",(function(){return c}))},3490:function(t){t.exports=JSON.parse('{"a":"n2a","b":"o2a","c":"p2a"}')},6001:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1);function o(t){return Object(r.a)({__type:"SubscriptionParameters:#Exchange"},t)}},7412:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a}));var r=n(31),o=new r.c((function(){return n.e(477).then(n.bind(null,11954))})),u=new r.b(o,(function(t){return t.addMarkAsReadDiagnostics})),i=new r.b(o,(function(t){return t.addUnreadCountNotificationDiagnostics})),a=new r.b(o,(function(t){return t.addUnreadCountSubscriptionDiagnostics}))},7806:function(t,e,n){"use strict";var r=n(7412),o=n(6001),u=n(869),i=n(121),a=n(1985),c=n(24),s=n(2943),p=n(3279),d=n(2),f=n(1993),l=Object(d.mutatorAction)("UPDATE_GROUP_UNREAD_COUNT",(function(t,e){var n=Object(f.a)().groups.get(t.toLowerCase());n&&(n.unreadMessageCount=e)}));n.d(e,"b",(function(){return v})),n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return S}));var b={};function g(t){var e=t.id.replace("UnreadCountNotification_","");if(r.b.import().then((function(n){return n(e,t)})),"0"==t.EventType.toString()){var n=b[e];n&&(l(e.toLowerCase(),t.UnreadCount),n.firstNotificationReceived||(n.unreadCountDataPoint.end(),n.unreadCountDataPoint=null,n.firstNotificationReceived=!0))}}function v(){Object(c.i)("grp-unreadCountTop5AndFavorites")?s.c.myOrgGroups.filter((function(t,e){return e<p.a||Object(a.isGroupInFavorites)(t)})).forEach((function(t){O(t)})):h()}function h(){s.c.myOrgGroups.forEach((function(t){O(t)}))}function O(t){(function(t){return!b[t]})(t=t.toLowerCase())&&u.b.import().then((function(e){var n=Object(o.a)({NotificationType:"UnreadCountNotification",ChannelId:e(),MailboxId:t}),a={subscriptionId:m(t),requiresExplicitSubscribe:!0,subscriptionParameters:n};u.h.importAndExecute(a,g);var s={notificationSubscription:a,firstNotificationReceived:!1,unreadCountDataPoint:new i.b("UnreadCountNotification",{logEvery:Object(c.i)("ring-dogfood")?1:20})};b[t]=s,r.c.import().then((function(e){return e(t,a,!1)}))}))}function S(t){t=t.toLowerCase();var e=b[t];if(e){var n=e.notificationSubscription;n&&(u.i.importAndExecute(n,g),delete b[t],r.c.import().then((function(e){return e(t,n,!0)})))}}function m(t){return"UnreadCountNotification_"+t}}}]);
//# sourceMappingURL=owa.MailBoot~GroupList~GroupListTree.js.map
self.scriptsLoaded['owa.MailBoot~GroupList~GroupListTree.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~GroupList~GroupListTree.js'] = (new Date()).getTime();