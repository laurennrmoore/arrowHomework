self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~HtmlEditorLinkPlugin.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[672],{1270:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"GetItemRequest:#Exchange"},e)}},1273:function(e,t,n){"use strict";var r=n(33),i=n(1);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.a)({__type:"GetItemJsonRequest:#Exchange"},n)),Object(r.a)("GetItem",e,t)}n.d(t,"a",(function(){return o}))},158:function(e,t,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r)&&r.length){var u=i.apply(null,r);u&&e.push(u)}else if("object"===o)for(var a in r)n.call(r,a)&&r[a]&&e.push(a)}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},18203:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n(3290),o=n(4138),u=n(5765),a=n(2860),c=n(2155),s=n(23),d=n(2001),l=n(3994),f=n(121),h=n(3054);function p(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n;return Object(r.f)(this,(function(r){return e?(n={},v(i.f,e,n),v(i.i,e,n),function(e,t){var n=[];e.sharingLinkIds.forEach((function(e){t[e]||(n=n.concat(e))})),n.length>0&&(Object(l.a)(n),h.d.importAndExecute(e.composeId),Object(f.s)("AttachmentComposeSPLinkRemove"))}(t,n),[2]):[2]}))}))}function v(e,t,n){t.queryElements("."+e,(function(e){n[e.id]=!0}))}var b=n(2091),m=n(4302),g="a",O="img",w="div",C="OWALinkSpinner",y="UpgradeCompose",k="LINK_TEMP_INSERTED_CLASS",E="RestoreCursor",A="span[fluid-url], div[fluid-url]",j="sharepoint.com",I="sharepoint-df.com",S="text/html;content=titled-hyperlink",P=n(24);var L=n(3403),T=n(1992),D=n(5760),x=n(6),R=n(2229),N=n(2185),F=n(19);var M=n(2416),U=n(197);function W(e){switch(e){case a.a.OneDrivePro:case a.a.OfficeOneDrivePro:return!0;case a.a.OneDriveConsumer:return Object(U.a)()||Object(P.i)("doc-link-filePicker");case a.a.Dropbox:case a.a.Box:case a.a.GDrive:return Object(P.i)("doc-link-filePicker");default:return!1}}function B(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,m.g.import()];case 1:return[4,r.sent()(e)];case 2:return r.sent()?t?(n=e.getAttribute(m.b),[4,a.f.import()]):[3,5]:[3,8];case 3:return[4,r.sent()(n)];case 4:if(!W(r.sent()))return[2,null];r.label=5;case 5:return[4,m.f.import()];case 6:return[4,r.sent()(e.href)];case 7:if((null==(i=r.sent())?void 0:i.length)>0)return[2,i];r.label=8;case 8:return[2,e.href]}}))}))}function _(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,B(e,!1)];case 1:return n=r.sent(),t!==a.a.OfficeOneDrivePro?[3,3]:[4,M.a.import()];case 2:if(i=r.sent(),!(n=i(n)))throw new Error("Can not get ODB URL from Office link.");r.label=3;case 3:return[2,n]}}))}))}function H(e,t,n,r){var u;return e&&(t.editor.addUndoSnapshot(),n.push(r.id),u=function(e){e.setAttribute("contenteditable","false"),e.style.pointerEvents="none",e.addEventListener("click",(function(e){e.preventDefault()}));var t=document.createElement("span");return t.className=C+" "+i.a,e.appendChild(t),Object(o.i)(t),[t]}(r),t.editor.select(r,-3),t.editor.triggerContentChangedEvent("Link"),Object(f.s)("AttachmentComposeSPLinksShouldReplaceText")),u}var V=n(11521);function G(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,c.B.import()];case 1:return n.sent(),(t=Object(c.l)(e.id))&&e.href!==t.url&&(t=null,s.d("Stored url is different from the href on anchor element")),V.b.import(),[2,t]}}))}))}var q=n(3376);function K(e){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(t){switch(t.label){case 0:return Object(P.i)("doc-SxS-jsApi-ODB-Links")?[4,q.a.import()]:[3,2];case 1:t.sent()(e),t.label=2;case 2:return[2]}}))}))}var $=[];function z(e,t,n,u,d,l,p,v,b,m,g,O){return Object(r.c)(this,void 0,void 0,(function(){var w,C,y,k,E,A,j,I,S,P,M,U,W,B,V,q,z,Y,J;return Object(r.f)(this,(function(r){switch(r.label){case 0:return e.editor?(C={anchorElementsSource:m,canceledReason:"",didBeautifyOrRehydrate:!1,shouldBeautify:n,shouldRehydrate:u,extension:"",hasValidFileName:!0},s.g.info("LinkPlugin.getSharingInfoToTryUpdateLink: shouldBeautify="+n+" isPreviouslyBeautified="+d+", anchorElementsSource="+m),y=H(n,e,b,l),k=l.id,E=Object(c.i)(l.id),[4,G(l)]):[2];case 1:return A=r.sent(),I=!1,A?[3,4]:-1!==$.indexOf(E)?[2]:(w=new f.b("BeautifyLinkE2E"),$.push(E),Object(f.s)("AttachmentComposeSPLinks",{anchorElementSource:m}),w.addCheckmark("GetSharingInfoStart"),[4,_(l,t)]);case 2:return S=r.sent(),[4,Object(D.b)(S,m,n,u,t,E,null)];case 3:return j=r.sent(),w.addCheckmark("GetSharingInfoEnd"),P=Object(T.d)(j.FileName),C.extension=P,(M=$.indexOf(E))>0&&$.splice(M,1),function(e,t,n,r){if(e){var i=t.indexOf(n.id);t.splice(i,1),function(e,t){t.forEach((function(t){try{e.removeChild(t)}catch(e){}})),e.setAttribute("contenteditable","true"),e.style.pointerEvents="auto",e.removeEventListener("click",(function(e){e.preventDefault()}))}(n,r)}}(n,b,l,y),(U=function(e,t,n,r){if(!e.editor)return Object(f.s)("ComposeEditorIsNullDuringProcessSPLinks",[n<20?n:20]),"editorDisposed";if(i=t,o=r.id,i!==o)return s.g.warn("LinkId changes during server call LinkIdBefore: "+t+", LinkIdNow: "+r.id),"linkIdChanged";var i,o,u=e.editor.queryElements("#"+r.id);return u&&1===u.length&&u[0]===r?null:(s.g.warn("The result from querying the editor is not matching the original anchor element with id: "+r.id),"userCanceledOperation")}(e,k,v,l))?(C.canceledReason=U,w.addCustomData(C),w.end(),[2]):t===a.a.OneDriveConsumer&&4!==j.SharingLinkKind&&5!==j.SharingLinkKind?[2]:(e.editor.addUndoSnapshot(),W=j&&0===j.ResultCode,B=!Object(x.f)(j.FileName),C.hasValidFileName=B,I=ie(l)&&m===c.a.PasteHtml&&W&&l.text===j.FileName,(n||I)&&W&&B&&function(e){e.id=i.c+e.id}(l),[3,5]);case 4:n&&s.d("We should not pass true for shouldBeautifyLink when processing the same link again."),r.label=5;case 5:return E=Object(c.i)(l.id),A?(d||A.sharingInfo.getSharingInfoSucceeded)&&(Object(o.f)(E),Object(c.d)(l.id,p.sharingLinkIds)):(V=(n||u)&&(j&&0==j.ResultCode||d),Object(D.c)(E,l.href,p.sharingLinkIds,j,V,d,m,t,S!==l.href?S:null)),[4,h.f.import()];case 6:return r.sent()(E,e.getRecipientWells(),e.fromAddress,p.composeId,O),n||u?(A||(A=Object(c.l)(E)),q=A&&!Object(x.f)(A.fileName),A&&A.sharingInfo.getSharingInfoSucceeded||d?(function(e,t){if(e&&Object(c.p)(t)&&0===e.permissionLevel){var n="edit"===e.sharingInfo.linkType?2:1;Object(c.G)(e.linkId,n)}}(A,k),Object(o.h)(e.editor,e.editorViewState,e.getRecipientWells,e.fromAddress,p.composeId,l,A,q,n||I,d,g),C.didBeautifyOrRehydrate=!0,null==w||w.addCustomData(C),[4,K(l.href)]):[3,8]):(C.didBeautifyOrRehydrate=!1,C.shouldBeautify=!1,C.shouldRehydrate=!1,null==w||w.addCustomData(C),null==w||w.end(),[2]);case 7:return r.sent(),[3,9];case 8:null==w||w.addCustomData(C),r.label=9;case 9:return null==w||w.end(),m!==c.a.PasteHtml&&m!==c.a.InsertLinkFromToolbar&&m!==c.a.InsertLinkFromAttachMenu&&m!==c.a.AutoLink&&m!==c.a.LinkContextMenu?[3,11]:(z=j)?(Y=Object(F.a)().SessionSettings,[4,L.g.import()]):[3,11];case 10:J=r.sent(),R.f.importAndExecute(N.b.SuggestedAttachments,Y.UserPuid,Y.ExternalDirectoryTenantGuid,J(p.composeId),null,JSON.stringify([{ListId:z.ListId,SiteId:z.SiteId,UniqueId:z.ItemUniqueId,WebId:z.WebId}])),r.label=11;case 11:return[2]}}))}))}function Y(e,t){return t?e.getAttribute(i.d)===i.e:Object(i.k)(e)}var J="OwaReferenceAttachments",X=["OWAHT","OWAAM",J,"OwaReferenceAttachmentsEnd","LPUrlAnchor","LPImageAnchor"],Z="OLK-Hidden";function Q(e,t){for(var n=t;n=n.parentNode;)if(n===e)return!0;return!1}var ee=n(203),te=n(158);function ne(e,t,n){e.id&&0!==e.id.length&&!n||(Y(e,t===c.a.PasteHtml)?e.id=i.c+Object(ee.a)():e.id=i.g+Object(ee.a)()),-1===e.className.indexOf(i.f)&&(e.className=te(e.className,i.f))}function re(e,t,n,i,u,d,l,h,p,v){return Object(r.c)(this,void 0,void 0,(function(){var b,g,O,w,C,y,k,E,A,j,I,S;return Object(r.f)(this,(function(P){switch(P.label){case 0:b=[],C=0,P.label=1;case 1:return C<e.length?function(e,t){if(e.id&&X.filter((function(t){return 0===e.id.indexOf(t)})).length>0)return!1;if(-1!==e.className.indexOf(Z))return!1;if(!e.href)return!1;if(t)for(var n=0;n<t.length;n++)if(Q(t[n],e))return!1;return!0}(g=e[C],t)?[4,B(g,!0)]:[3,5]:[3,6];case 2:return(O=P.sent())?[4,a.f.import()]:[3,5];case 3:return[4,P.sent()(O)];case 4:if(!W(w=P.sent()))return[3,5];ne(g,n,l),b.push({id:g.id,url:g.href,anchorElement:g,providerType:w}),P.label=5;case 5:return C++,[3,1];case 6:s.g.info("process anchor elements total count: "+b.length),C=0,P.label=7;case 7:return C<b.length?(y=b[C],k=Y(y.anchorElement,n===c.a.PasteHtml),E=ie(y.anchorElement),A=function(e){return e.children&&1===e.children.length&&e.children[0].tagName.toUpperCase()===o.e&&(!e.children[0].children||0===e.children[0].children.length)}(y.anchorElement),j=function(e){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(t){switch(t.label){case 0:return[4,B(e,!1)];case 1:return[2,t.sent().toLowerCase()===e.text.toLowerCase()]}}))}))}(y.anchorElement)&&E&&h,I=k||E||A,[4,m.g.import()]):[3,11];case 8:return[4,P.sent()(y.anchorElement)];case 9:S=P.sent(),function(e,t,n,r,i,o,u){var a="";r?a="shouldBeautify":t?a="isLinkPreviouslyBeautified":n?a="isLinkPureAnchorElement":i&&(a="isLinkWithOnlyOneSpanChild");e===c.a.PasteHtml?(Object(f.s)("ComposeSPLinksFromPaste",[a]),o&&Object(f.s)("ComposeSafeLinkFromPaste",{linkType:a,providerType:u})):Object(f.s)("ComposeSPLinksFromDraft",[a])}(n,k,E,j,A,S,y.providerType),z(i,y.providerType,j,I,k,y.anchorElement,u,C,d,n,p,v),P.label=10;case 10:return C++,[3,7];case 11:return[2]}}))}))}function ie(e){return!e.children||0===e.children.length}var oe=["fluid-url","owaLinkId"];function ue(e,t,n,r,o,u){if(s.g.info("LinkPlugin.handleBeforePasteEvent"),Object(b.d)(1)){var a=e.fragment.querySelector(A);if(a){var l=document.createElement(g);l.href=a.getAttribute("fluid-url"),l.textContent=l.href,a.parentNode.replaceChild(l,a)}}var h=e.fragment.querySelectorAll(g),p=e.fragment.querySelectorAll(O);!function(e,t,n){var r;if(Object(P.i)("doc-edge-link")){var i=null===(r=e.clipboardData)||void 0===r?void 0:r.linkPreview;if(0===n.length&&1===t.length&&(null==i?void 0:i.preferred_format)===S&&(Object(f.s)("EdgeLinkPaste",{domain:i.domain}),i.domain===j||i.domain===I)){var o=t[0];o.innerText=o.href}}}(e,h,p);var v=function(e,t){for(var n=e.replace(/\s/g,""),r="",i=0;i<t.length;i++){var o=t[i];r+=ce(o)}return n.toLowerCase()===r.toLowerCase()}(e.fragment.textContent,h);re(h,null,c.a.PasteHtml,t,n,r,!0,v&&0===p.length,o,u);var m=e.sanitizingOption,w=m.additionalAllowedAttributes,C=m.attributeCallbacks,y=m.additionalAllowedCssClasses;w.push.apply(w,oe),y.push(i.a),Object(d.chainSanitizerCallback)(C,"id",i.l),Object(d.chainSanitizerCallback)(C,"shash",ae)}function ae(e,t,n){return t.getAttribute(m.d)}function ce(e){var t=e.getAttribute(m.b);return(null==t?void 0:t.length)>0?t:e.href}var se=n(9508),de=n(5),le=n(2892),fe=n(102),he=75,pe=Object(fe.l)()?function(e){return e.metaKey}:function(e){return e.ctrlKey};var ve=8,be=46;function me(e){if(Object(u.a)(e)){var t=e;if(Object(i.k)(t)){var n=t.getAttribute("contenteditable");return!!n&&"false"===n.toLowerCase()}}return!1}var ge=n(2930);function Oe(e,t,n,i,o){return Object(r.c)(this,void 0,void 0,(function(){var u,d,l,f,h;return Object(r.f)(this,(function(r){switch(r.label){case 0:return 1!==(u=e.editor.queryElements(w)).length?[3,4]:(s.g.info("shareLinkComposeHandling: only one div element"),d=u[0].innerHTML,[4,M.e.import()]);case 1:return l=r.sent(),0===u[0].childElementCount&&l(d)&&-1===d.indexOf(" ")?((f=document.createElement("a")).href=d,f.innerText=d,ne(f,c.a.ShareLinkCompose,!1),e.editor.deleteNode(u[0]),e.editor.insertNode(f),[4,a.d.import()]):[3,4];case 2:return h=r.sent(),[4,z(e,h(0),!0,!1,!1,f,t,0,n,c.a.ShareLinkCompose,i,o)];case 3:return r.sent(),[2,!0];case 4:return[2,!1]}}))}))}var we=".",Ce="#";function ye(e,t,n,i,o,u,a){return Object(r.c)(this,void 0,void 0,(function(){var s,d;return Object(r.f)(this,(function(r){switch(r.label){case 0:return e.editor?o!==c.a.EditorLoadedOrDraftOrReply&&o!==c.a.Undo?[3,2]:[4,Oe(e,t,n,u,a)]:(Object(f.s)("processAllLinksInNullEditor",{source:o}),[2]);case 1:if(r.sent())return[2];r.label=2;case 2:return e.editor?(s=e.editor.queryElements(g),d=e.editor.queryElements(Ce+J),function(e,t){e.editor.queryElements(we+C,(function(e){-1===t.indexOf(e.parentElement.id)&&e.parentElement.removeChild(e)}))}(e,n),[4,re(s,d,o,e,t,n,i,!1,u,a)]):[2];case 3:return r.sent(),[4,ge.j.import()];case 4:return r.sent()(e.editor,e.editorViewState,e.getRecipientWells,t,e.fromAddress,u),[2]}}))}))}function ke(e,t,n,i,u,a){return Object(r.c)(this,void 0,void 0,(function(){var d,l;return Object(r.f)(this,(function(r){switch(r.label){case 0:return d=e,s.g.info("LinkPlugin.processContentChangedEvent: "+d.source),"SetContent"!==d.source&&d.source!==y&&d.source!==o.d&&d.source!==E?[3,2]:(l=function(e){if("SetContent"===e)return c.a.Undo;if(e===y)return c.a.ReplyOrForward;if(e===o.d)return c.a.LinkContextMenu;if(e===E)return c.a.RestoreCursor;return s.d("anchor element source was not detected"),c.a.Unknown}(d.source),[4,ye(t,n,i,d.source===y,l,u,a)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}var Ee=n(67);function Ae(e,t){switch(e.rawEvent.which){case 40:!function(e,t){var n=t.getContentSearcherOfCursor(e),r=null==n?void 0:n.getInlineElementAfter(),i=null==n?void 0:n.getInlineElementBefore(),o=t.getSelectionRange();if(!i&&r&&o&&o.collapsed){var u=r.getContainerNode();if(me(u)){s.g.info("down arrow to move select to next line");var a=t.getBodyTraverser(u);if(a){var c=a.getNextBlockElement();c&&(t.select(c.getStartNode(),-2),e.rawEvent.preventDefault())}}}}(e,t);break;case 8:!function(e,t){var n=t.getContentSearcherOfCursor(e),r=null==n?void 0:n.getInlineElementBefore(),i=t.getSelectionRange();if(r&&i&&i.collapsed){var o=r.getContainerNode();if(me(o))return t.deleteNode(o),Object(d.clearEventDataCache)(e),void e.rawEvent.preventDefault()}je()&&Ie(t)}(e,t);break;case 46:!function(e,t){if(je()){var n=t.getContentSearcherOfCursor(e),r=null==n?void 0:n.getInlineElementAfter(),i=null==n?void 0:n.getInlineElementBefore(),o=t.getSelectionRange();if(!i&&r&&o&&o.collapsed)if(me(r.getContainerNode()))return;Ie(t)}}(e,t);break;default:return}}function je(){return Object(Ee.e)()||Object(Ee.f)()}function Ie(e){e.queryElements('[contenteditable="false"]',(function(t){if(me(t)){var n=e.getDocument().createElement("span");n.innerText="​",n.className=k,t.parentNode.insertBefore(n,t.nextSibling)}})),e.runAsync((function(){e.isDisposed()||e.queryElements("."+k,(function(e){e.parentNode&&e.parentNode.removeChild(e)}))}))}var Se=n(212);function Pe(e){var t,n=null===(t=e.querySelectorAll("."+i.f))||void 0===t?void 0:t[0];n&&Se.unmountComponentAtNode(n.parentElement)}var Le=function(){function e(e,t,n,r,i,u){var a=this;void 0===u&&(u=!1),this.editorViewState=e,this.linkIdContainer=t,this.getRecipientWells=n,this.fromAddress=r,this.isCalendar=i,this.allowCtrlK=u,this.tryGetAllSPLinks=function(){a.pendingSPLinksTask||(a.pendingSPLinksTask=setTimeout((function(){a.getAllSPLinks()}),500))},this.onScroll=function(){Object(c.j)()>0&&Object(o.g)()},this.linkIdsWithSpinner=[]}return e.prototype.getName=function(){return"Link"},e.prototype.initialize=function(e){if(s.g.info("LinkPlugin.initialize"),this.editor=e,this.onCutDisposer=this.editor.addDomEventHandler("cut",this.tryGetAllSPLinks),window.addEventListener("resize",this.onScroll),this.allowCtrlK){var t=this.getRecipientWells(),n={toRecipientWell:t[0],ccRecipientWell:t[1],bccRecipientWell:t[2],attachmentWell:this.linkIdContainer};this.editor.addContentEditFeature(function(e,t,n,r){return{keys:[he],allowFunctionKeys:!0,shouldHandleEvent:function(e){var t=e.rawEvent;return!t.altKey&&!t.shiftKey&&pe(t)},handleEvent:function(i){var o=i.rawEvent;o.preventDefault(),o.stopPropagation(),se.b.import().then((function(i){return i(t,e.getDocument().defaultView,le.b.ShortKey,Object(de.Sb)(),n,r)}))}}}(this.editor,this.editorViewState,this.fromAddress,n))}},e.prototype.onPluginEvent=function(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n,l,f,h,p,v,b;return Object(r.f)(this,(function(r){switch(r.label){case 0:return 15===e.eventType&&e.entity.type===i.b&&this.onEntityEvent(e),14!==e.eventType?[3,1]:(this.onScroll(),[3,9]);case 1:return 10!==e.eventType?[3,2]:(ue(e,this,this.linkIdContainer,this.linkIdsWithSpinner,this.editor.getDocument().defaultView,this.isCalendar),[3,9]);case 2:return 11!==e.eventType?[3,3]:(s.g.info("LinkPlugin.EditorReady"),ye(this,this.linkIdContainer,this.linkIdsWithSpinner,!1,c.a.EditorLoadedOrDraftOrReply,this.editor.getDocument().defaultView,this.isCalendar),[3,9]);case 3:return 7!==e.eventType?[3,8]:"AutoLink"!==(t=e).source&&"CreateLink"!==t.source&&"TextPrediction"!==t.source||!t.data||!Object(u.a)(t.data)?[3,6]:[4,a.f.import()];case 4:return[4,r.sent()(t.data.href)];case 5:return W(n=r.sent())?(l=c.a.Unknown,"AutoLink"===t.source||"TextPrediction"===t.source?l=c.a.AutoLink:"CreateLink"===t.source&&(l=c.a.InsertLinkFromToolbar),s.g.info("LinkPlugin.handleLink"),ne(t.data,c.a.AutoLink,!0),z(this,n,"AutoLink"===t.source||"TextPrediction"===t.source,!0,!1,t.data,this.linkIdContainer,0,this.linkIdsWithSpinner,l,this.editor.getDocument().defaultView,this.isCalendar),[3,7]):[2];case 6:ke(e,this,this.linkIdContainer,this.linkIdsWithSpinner,this.editor.getDocument().defaultView,this.isCalendar),r.label=7;case 7:return[3,9];case 8:if(8===e.eventType)return s.g.info("LinkPlugin.ExtractContentWithDom"),function(e){for(var t,n=e.querySelectorAll("."+i.a),r=0;r<n.length;r++)null===(t=n[r].parentNode)||void 0===t||t.removeChild(n[r]);var u=e.querySelectorAll("["+o.a+"]");for(r=0;r<u.length;r++)u[r].removeAttribute(o.a)}(e.clonedRoot),[2];2===e.eventType||6===e.eventType?(f=this.editor.getSelectionRange())&&(h=f.startContainer,p=f.endContainer,h===p&&"a"===h.nodeName.toLowerCase()&&me(v=h)&&f.startOffset===f.endOffset&&(f.startOffset!==h.childNodes.length?(s.g.info("move select before the anchor element."),this.editor.select(v,-2)):(s.g.info("move select after the anchor element."),this.editor.select(v,-3)))):0===e.eventType?Ae(e,this.editor):12===e.eventType&&(b=Object(d.getEntitySelector)(i.b),this.editor.queryElements(b).forEach((function(e){Pe(e)}))),r.label=9;case 9:return this.processLinkRemovalRelatedEvents(e),[2]}}))}))},e.prototype.onEntityEvent=function(e){var t=this;switch(e.operation){case 4:case 5:case 6:this.editor.addUndoSnapshot((function(){var n=e.entity.wrapper;t.editor.deleteNode(n),e.rawEvent&&(e.rawEvent.preventDefault(),e.rawEvent.stopPropagation()),Pe(n)}));break;case 8:e.entity.wrapper.parentNode.replaceChild(e.entity.wrapper.firstChild,e.entity.wrapper)}},e.prototype.processLinkRemovalRelatedEvents=function(e){(function(e,t){if(7===e.eventType)return!0;if(0===e.eventType){var n=e.rawEvent;return n.which===ve||n.which===be}return 1===e.eventType&&(t&&t.getSelectionRange()&&!t.getSelectionRange().collapsed)})(e,this.editor)&&this.tryGetAllSPLinks()},e.prototype.getAllSPLinks=function(){this.pendingSPLinksTask=null,p(this.editor,this.linkIdContainer)},e.prototype.dispose=function(){var e;if(s.g.info("LinkPlugin.dispose"),this.onCutDisposer&&(this.onCutDisposer(),this.onCutDisposer=null),this.pendingSPLinksTask&&(clearTimeout(this.pendingSPLinksTask),this.pendingSPLinksTask=null),this.editor=null,window.removeEventListener("resize",this.onScroll),Object(c.j)()>0){Object(o.g)();var t=null===(e=this.linkIdContainer)||void 0===e?void 0:e.sharingLinkIds;(null==t?void 0:t.length)>0&&t.forEach((function(e){Object(o.l)(e)}))}},e}();n.d(t,"LinkPlugin",(function(){return Le}))},2029:function(e,t,n){"use strict";var r,i,o;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(o||(o={}))},2070:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"m",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"l",(function(){return h})),n.d(t,"k",(function(){return p})),n.d(t,"j",(function(){return v})),n.d(t,"h",(function(){return b})),n.d(t,"f",(function(){return m})),n.d(t,"n",(function(){return g}));var r=n(31),i=n(2113);n.d(t,"o",(function(){return i.a})),n.d(t,"p",(function(){return i.b})),n.d(t,"q",(function(){return i.c}));var o=n(2143);n.d(t,"b",(function(){return o.a}));var u=n(2214);n.d(t,"d",(function(){return u.a})),n.d(t,"c",(function(){return u.b}));var a=n(2230);n.d(t,"a",(function(){return a.a}));var c=new r.c((function(){return Promise.all([n.e(4),n.e(21),n.e(42),n.e(77),n.e(539),n.e(352)]).then(n.bind(null,3605))})),s=new r.a(c,(function(e){return e.addAndInitializeAttachments})),d=new r.a(c,(function(e){return e.setPreviewImageUrl})),l=new r.a(c,(function(e){return e.refreshDownloadUrl})),f=new r.a(c,(function(e){return e.createAttachmentInfo})),h=new r.a(c,(function(e){return e.setAttachmentInfo})),p=new r.a(c,(function(e){return e.refreshThumbnailImageUrl})),v=new r.a(c,(function(e){return e.refreshPreviewImageUrl})),b=new r.b(c,(function(e){return e.getAttachment})),m=new r.b(c,(function(e){return e.checkPendingAttachmentOperation})),g=new r.b(c,(function(e){return e.shouldShowImageView}))},2099:function(e,t,n){"use strict";var r=n(2293),i=n(2276),o=n(2070),u=n(2212),a=n(2752),c=n(2110);function s(e,t,n,s){if(Object(o.d)(n))return function(e){return 2===Object(u.a)(e)?f():d()}(n);if(3===Object(u.a)(n)&&!s)return l();var h;switch(t){case 2:h={allowEdit:!1,previewMethod:i.a.Image,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 3:h={allowEdit:!1,previewMethod:i.a.NativeView,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 6:h={allowEdit:!1,previewMethod:i.a.GoogleDoc,supportedOpenActions:[r.a.Preview]};break;case 4:h={allowEdit:e.wacEdit,previewMethod:i.a.Wac,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 5:h={allowEdit:!1,previewMethod:i.a.Audio,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 7:h={allowEdit:!1,previewMethod:i.a.PdfJs,supportedOpenActions:[r.a.Preview]};break;case 8:case 9:case 10:h=f();break;case 11:h={allowEdit:!1,previewMethod:i.a.Text,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 12:h={allowEdit:!1,previewMethod:i.a.Video,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 1:h={allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[]};break;case 13:h={allowEdit:!1,previewMethod:i.a.CalendarEvent,supportedOpenActions:[r.a.Preview,r.a.Download]};break;default:h=function(e){return Object(a.a)(e)||Object(c.a)(e)}(n)?l():d()}return h}function d(){return{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[r.a.Download]}}function l(){return{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[r.a.OpenInNewTab]}}function f(){return{allowEdit:!1,previewMethod:i.a.ItemAttachment,supportedOpenActions:[r.a.Preview,r.a.Download]}}var h=n(183),p=Object(h.action)("setIsPlaceholderAttachment")((function(e,t){e.isPlaceholderAttachment=t})),v=Object(h.action)("setThumbnailLoadState")((function(e,t){e.thumbnailLoadState=t}));function b(e,t,n,r,o,u){return void 0===u&&(u=null),{attachmentId:e,thumbnailLoadState:0,previewLoaded:!1,isCloudy:n,isReadOnly:t,isPlaceholderAttachment:r,strategy:{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[]},parentItemId:u,fileType:o}}var m,g=n(19);function O(){return Object(g.a)().SessionSettings.CompanyName}function w(e){return e.supportedOpenActions.length&&e.supportedOpenActions[0]||r.a.NoAction}!function(e){e[e.MailList=0]="MailList",e[e.ReadingPane=1]="ReadingPane",e[e.FilesHub=2]="FilesHub",e[e.PhotoHub=3]="PhotoHub",e[e.GroupFilesHub=4]="GroupFilesHub",e[e.ConversationAttachmentWell=5]="ConversationAttachmentWell",e[e.Deeplink=6]="Deeplink",e[e.FileSuggestion=7]="FileSuggestion",e[e.LinkSuggestion=8]="LinkSuggestion",e[e.ComposeDocLink=9]="ComposeDocLink",e[e.ReadingPaneDocLink=10]="ReadingPaneDocLink",e[e.ConsumerGroupFilesHub=11]="ConsumerGroupFilesHub",e[e.FolderTree=12]="FolderTree"}(m||(m={})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return v})),n.d(t,"d",(function(){return b})),n.d(t,"g",(function(){return O})),n.d(t,"f",(function(){return w})),n.d(t,"b",(function(){return i.a})),n.d(t,"a",(function(){return r.a})),n.d(t,"c",(function(){return m}))},2113:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return u}));var r=n(2),i=Object(r.action)("REFRESH_SHARING_TIPS_FOR_ATTACHMENT",(function(e){return{attachmentId:e}})),o=Object(r.action)("SET_ATTACHMENT_CONTENTID",(function(e,t){return{attachmentId:e,attachmentContentId:t}})),u=Object(r.action)("SET_ATTACHMENT_ISINLINE",(function(e,t){return{attachmentId:e,isInline:t}}))},2140:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(94);function i(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},217:function(e,t,n){"use strict";var r=n(859);n.d(t,"a",(function(){return r.a}))},2179:function(e,t){e.exports=function(e){return e instanceof Date}},2212:function(e,t,n){"use strict";var r=n(2060),i=n(6),o=function(e){return e&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(e)};function u(e){var t=e.__type||e.OwsTypeName;switch(t){case r.a:return 0;case r.e:return e.IsLink?3:1;case r.d:return 3;case r.b:return 2;case r.c:var n=e,u=e.EmbeddedItemClass;return u&&o(u)||Object(i.f)(n.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+t)}}n.d(t,"a",(function(){return u}))},2214:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.AttachmentId)&&i(e.AttachmentId.Id)}function i(e){return e&&-1!==e.indexOf("smime-")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},2230:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return h})),n.d(t,"a",(function(){return p}));var r="Box",i="Dropbox",o="Facebook",u="GDrive",a="Mailbox",c="MailMessage",s="OneDriveConsumer",d="OneDrivePro",l="WopiBox",f="WopiDropbox",h="WopiEgnyte",p={providers:{BOX:r,DROPBOX:i,FACEBOOK:o,GDRIVE:u,MAILBOX:a,ONE_DRIVE_CONSUMER:s,ONE_DRIVE_PRO:d,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:l,WOPI_EGNYTE:h}}},2243:function(e,t,n){var r=n(2179),i=36e5,o=6e4,u=2,a=/[T ]/,c=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],h=/^-(\d{2})$/,p=/^-?(\d{3})$/,v=/^-?(\d{2})-?(\d{2})$/,b=/^-?W(\d{2})$/,m=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,C=/([Z+-].*)$/,y=/^(Z)$/,k=/^([+-])(\d{2})$/,E=/^([+-])(\d{2}):?(\d{2})$/;function A(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?u:Number(n);var j=function(e){var t,n={},r=e.split(a);c.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var i=C.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),I=function(e,t){var n,r=d[t],i=f[t];if(n=l.exec(e)||i.exec(e)){var o=n[1];return{year:parseInt(o,10),restDateString:e.slice(o.length)}}if(n=s.exec(e)||r.exec(e)){var u=n[1];return{year:100*parseInt(u,10),restDateString:e.slice(u.length)}}return{year:null}}(j.date,n),S=I.year,P=function(e,t){if(null===t)return null;var n,r,i,o;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=h.exec(e))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(t,i),r;if(n=p.exec(e)){r=new Date(0);var u=parseInt(n[1],10);return r.setUTCFullYear(t,0,u),r}if(n=v.exec(e)){r=new Date(0),i=parseInt(n[1],10)-1;var a=parseInt(n[2],10);return r.setUTCFullYear(t,i,a),r}if(n=b.exec(e))return o=parseInt(n[1],10)-1,A(t,o);if(n=m.exec(e)){o=parseInt(n[1],10)-1;var c=parseInt(n[2],10)-1;return A(t,o,c)}return null}(I.restDateString,S);if(P){var L,T=P.getTime(),D=0;return j.time&&(D=function(e){var t,n,r;if(t=g.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*i;if(t=O.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*i+r*o;if(t=w.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var u=parseFloat(t[3].replace(",","."));return n%24*i+r*o+1e3*u}return null}(j.time)),j.timezone?L=function(e){var t,n;if(t=y.exec(e))return 0;if(t=k.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=E.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(j.timezone):(L=new Date(T+D).getTimezoneOffset(),L=new Date(T+D+L*o).getTimezoneOffset()),new Date(T+D+L*o)}return new Date(e)}},225:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(572);function i(e,t){return void 0===t&&(t=!0),e&&(t&&Object(r.a)(e)||e.parentNode&&e.parentNode)}},2253:function(e,t,n){"use strict";var r=n(2004);function i(){var e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var o=n(2140),u=n(2110);function a(){return i()}function c(e){return(e&&e.length>0&&function(e){return e.some((function(e){return!((t=e).IsInline&&!Object(u.a)(t));var t}))}(e)?i():[]).map(o.a)}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}))},2276:function(e,t,n){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),t.a=r},2293:function(e,t,n){"use strict";var r;!function(e){e[e.NoAction=0]="NoAction",e[e.Preview=1]="Preview",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab"}(r||(r={})),t.a=r},2359:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(2212);function i(e){return u(e.type)}function o(e){return u(Object(r.a)(e))}function u(e){return 1===e||3===e}},2458:function(e){e.exports=JSON.parse('{"a":"Cda"}')},2495:function(e,t,n){"use strict";var r=n(31),i=[0,1],o=n(2505),u=n(2458),a=n(6),c=n(94),s=n(2029);function d(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(a.b)(u.a),messageParts:[Object(a.b)(u.a),l()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(a.b)(o.b),messageParts:[Object(a.b)(o.b),l()],color:s.a.Red};default:return Object(c.a)(e)}}function l(){return{text:Object(a.b)(o.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=n(2253),h=n(2140),p=n(1),v=n(24),b=n(2004);function m(){var e=Object(b.a)();if(Object(v.i)("fwk-devTools")){if(Object(v.i)("doc-attachment-CA-readOnlyAccessIssues"))return Object(p.a)(Object(p.a)({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(v.i)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(p.a)(Object(p.a)({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function g(){var e=m();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return w})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return f.a})),n.d(t,"e",(function(){return h.a})),n.d(t,"d",(function(){return g})),n.d(t,"c",(function(){return m}));var O=new r.c((function(){return n.e(1708).then(n.bind(null,18005))})),w=new r.b(O,(function(e){return e.getAccessIssuesForAttachments}))},2505:function(e){e.exports=JSON.parse('{"a":"Ada","b":"Bda"}')},2752:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2060);function i(e){return(e.__type||e.OwsTypeName)===r.d}},287:function(e,t,n){"use strict";var r=n(295),i=n(18);function o(e){return Object(r.resolve)(Object(i.g)(),e)}function u(e){return o("resources/images/"+e)}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}))},2892:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return l}));var r=n(31),i=n(2991);n.d(t,"b",(function(){return i.a}));var o=n(3104);n.d(t,"d",(function(){return o.a}));var u=new r.c((function(){return Promise.all([n.e(3),n.e(26),n.e(43),n.e(47),n.e(107),n.e(674)]).then(n.bind(null,5747))})),a=Object(r.d)(u,(function(e){return e.Ribbon})),c=Object(r.d)(u,(function(e){return e.ContextualFormatBar})),s=new r.a(u,(function(e){return e.updateRibbonWidth})),d=new r.b(u,(function(e){return e.formatPainterFinish})),l=new r.b(u,(function(e){return e.showInsertLinkDialog}))},2930:function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return a})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"j",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return h})),n.d(t,"d",(function(){return p}));var r=n(31),i=n(3055);n.d(t,"a",(function(){return i.a})),n.d(t,"c",(function(){return i.c})),n.d(t,"b",(function(){return i.b}));var o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(37),n.e(42),n.e(47),n.e(77),n.e(78),n.e(85),n.e(82),n.e(81),n.e(111),n.e(123),n.e(757)]).then(n.bind(null,7729))})),u=(new r.b(o,(function(e){return e.insertLinksIntoComposeEditor})),new r.b(o,(function(e){return e.getAllInsertLinksIds}))),a=new r.b(o,(function(e){return e.getAtLeastOneInsertLinkPendingOrFailed})),c=new r.b(o,(function(e){return e.getBlockDialogOnSendStrings})),s=new r.b(o,(function(e){return e.getBlockDialogOnSaveStrings})),d=new r.b(o,(function(e){return e.insertLinkPlaceholdersRemoveOrRehydrate})),l=new r.b(o,(function(e){return e.getPendingInsertLinkIds})),f=new r.b(o,(function(e){return e.insertLinks})),h=new r.b(o,(function(e){return e.updateUpsellUserSelectionText})),p=Object(r.d)(o,(function(e){return e.InsertLinksBlockDialog}))},2991:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.OriginalRibbon="OriginalRibbon",e.FilePickerLinkContextMenu="FilePickerLinkContextMenu",e.ShortKey="ShortKey",e.FlightedRibbon="FlightedRibbon"}(r||(r={}))},3055:function(e){e.exports=JSON.parse('{"c":"C3a","a":"D3a","b":"E3a"}')},3104:function(e,t,n){"use strict";function r(e){var t="";if(null==e||"I"===e.nodeName)return"";if("#text"===e.nodeName)return e.textContent.trim();for(var n=0;n<e.childNodes.length;n++)t+=r(e.childNodes[n]);return t}n.d(t,"a",(function(){return r}))},320:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(225);function i(e,t,n){void 0===n&&(n=!0);var i=!1;if(e&&t)if(n)if(e===t)i=!0;else for(i=!1;t;){var o=Object(r.a)(t);if(o===e){i=!0;break}t=o}else e.contains&&(i=e.contains(t));return i}},3403:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return f}));var r=n(31),i=n(3574);n.d(t,"a",(function(){return i.a}));var o=new r.c((function(){return Promise.all([n.e(4),n.e(37),n.e(543)]).then(n.bind(null,7733))})),u=new r.b(o,(function(e){return e.clearCachedAttachmentSuggestions})),a=new r.b(o,(function(e){return e.getAttachmentSuggestionsAction})),c=new r.b(o,(function(e){return e.createCloudFileFromAttachmentData})),s=new r.b(o,(function(e){return e.getAttachmentSuggestionsMenuItems})),d=new r.b(o,(function(e){return e.getAttachmentSuggestionsTraceId})),l=new r.b(o,(function(e){return e.getAttachmentSuggestionsTraceIdByComposeId})),f=new r.a(o,(function(e){return e.logEntitiesFromFilePicker}))},3574:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Contextual=0]="Contextual",e[e.MRUCloudy=1]="MRUCloudy",e[e.MRUClassic=2]="MRUClassic",e[e.MRUContextual=3]="MRUContextual",e[e.MRUClassicContextual=4]="MRUClassicContextual"}(r||(r={}))},375:function(e,t,n){"use strict";n.d(t,"e",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return p})),n.d(t,"i",(function(){return v})),n.d(t,"c",(function(){return b})),n.d(t,"k",(function(){return m})),n.d(t,"j",(function(){return g})),n.d(t,"o",(function(){return O})),n.d(t,"n",(function(){return w})),n.d(t,"m",(function(){return C})),n.d(t,"l",(function(){return y})),n.d(t,"a",(function(){return k})),n.d(t,"p",(function(){return E})),n.d(t,"b",(function(){return j})),n.d(t,"g",(function(){return I})),n.d(t,"d",(function(){return S}));var r=n(705),i=n(320),o=n(225),u=n(43),a=n(100),c="data-is-focusable",s="data-is-visible",d="data-focuszone-id",l="data-is-sub-focuszone";function f(e,t,n){return g(e,t,!0,!1,!1,n)}function h(e,t,n){return m(e,t,!0,!1,!0,n)}function p(e,t,n,r){return void 0===r&&(r=!0),g(e,t,r,!1,!1,n,!1,!0)}function v(e,t,n,r){return void 0===r&&(r=!0),m(e,t,r,!1,!0,n,!1,!0)}function b(e){var t=g(e,e,!0,!1,!1,!0);return!!t&&(j(t),!0)}function m(e,t,n,r,i,o,u,a){if(!t||!u&&t===e)return null;var c=O(t);if(i&&c&&(o||!C(t)&&!y(t))){var s=m(e,t.lastElementChild,!0,!0,!0,o,u,a);if(s){if(a&&w(s,!0)||!a)return s;var d=m(e,s.previousElementSibling,!0,!0,!0,o,u,a);if(d)return d;for(var l=s.parentElement;l&&l!==t;){var f=m(e,l.previousElementSibling,!0,!0,!0,o,u,a);if(f)return f;l=l.parentElement}}}if(n&&c&&w(t,a))return t;var h=m(e,t.previousElementSibling,!0,!0,!0,o,u,a);return h||(r?null:m(e,t.parentElement,!0,!1,!1,o,u,a))}function g(e,t,n,r,i,o,u,a){if(!t||t===e&&i&&!u)return null;var c=O(t);if(n&&c&&w(t,a))return t;if(!i&&c&&(o||!C(t)&&!y(t))){var s=g(e,t.firstElementChild,!0,!0,!1,o,u,a);if(s)return s}if(t===e)return null;var d=g(e,t.nextElementSibling,!0,!0,!1,o,u,a);return d||(r?null:g(e,t.parentElement,!1,!1,!0,o,u,a))}function O(e){if(!e||!e.getAttribute)return!1;var t=e.getAttribute(s);return null!=t?"true"===t:0!==e.offsetHeight||null!==e.offsetParent||!0===e.isVisible}function w(e,t){if(!e||e.disabled)return!1;var n=0,r=null;e&&e.getAttribute&&(r=e.getAttribute("tabIndex"))&&(n=parseInt(r,10));var i=e.getAttribute?e.getAttribute(c):null,o=null!==r&&n>=0,u=!!e&&"false"!==i&&("A"===e.tagName||"BUTTON"===e.tagName||"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||"true"===i||o);return t?-1!==n&&u:u}function C(e){return!!(e&&e.getAttribute&&e.getAttribute(d))}function y(e){return!(!e||!e.getAttribute||"true"!==e.getAttribute(l))}function k(e){var t=Object(a.a)(e),n=t&&t.activeElement;return!(!n||!Object(i.a)(e,n))}function E(e,t){return"true"!==Object(r.a)(e,t)}var A=void 0;function j(e){if(e){if(A)return void(A=e);A=e;var t=Object(u.a)(e);t&&t.requestAnimationFrame((function(){A&&A.focus(),A=void 0}))}}function I(e,t){for(var n=e,r=0,i=t;r<i.length;r++){var o=i[r],u=n.children[Math.min(o,n.children.length-1)];if(!u)break;n=u}return n=w(n)&&O(n)?n:g(e,n,!0)||m(e,n)}function S(e,t){for(var n=[];t&&e&&t!==e;){var r=Object(o.a)(t,!0);if(null===r)return[];n.unshift(Array.prototype.indexOf.call(r.children,t)),t=r}return n}},378:function(e,t,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(this&&this[r]||r);else if(Array.isArray(r))e.push(i.apply(this,r));else if("object"===o)for(var u in r)n.call(r,u)&&r[u]&&e.push(this&&this[u]||u)}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},381:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return a}));var r=n(0),i=r.createContext({window:"object"==typeof window?window:void 0}),o=function(){return r.useContext(i).window},u=function(){var e;return null===(e=r.useContext(i).window)||void 0===e?void 0:e.document},a=function(e){return r.createElement(i.Provider,{value:e},e.children)}},420:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(225);function i(e,t){return e&&e!==document.body?t(e)?e:i(Object(r.a)(e),t):null}},4567:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a}));var r=n(31),i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(15),n.e(17),n.e(16),n.e(21),n.e(22),n.e(29),n.e(34),n.e(37),n.e(41),n.e(42),n.e(52),n.e(57),n.e(72),n.e(77),n.e(78),n.e(82),n.e(111),n.e(143),n.e(170),n.e(353)]).then(n.bind(null,6776))})),o=new r.a(i,(function(e){return e.prefetchAllWacResources})),u=new r.a(i,(function(e){return e.prefetchWacResourcesForAttachments})),a=new r.a(i,(function(e){return e.prefetchWacResourcesForFiles}))},483:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r="data-portal-element";function i(e){e.setAttribute(r,"true")}},532:function(e,t,n){"use strict";function r(e){return e&&!!e._virtual}n.d(t,"a",(function(){return r}))},572:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(532);function i(e){var t;return e&&Object(r.a)(e)&&(t=e._virtual.parent),t}},5760:function(e,t,n){"use strict";var r=n(1),i=n(2),o=Object(i.action)("ON_SHARING_LINK_DETECTED",(function(e,t,n,r,i,o,u,a,c,s){return{linkId:e,linkUrl:t,sharingLinkIds:n,response:r,shouldAddComposeLinkViewState:i,isPreviouslyBeautified:o,source:u,providerType:a,unwrappedUrl:c,creationDateTime:s}})),u=n(4138),a=n(2155),c=n(2860),s=n(4567);Object(i.orchestrator)(o,(function(e){Object(a.c)(e.linkId,e.linkUrl,e.sharingLinkIds,e.response,e.source,e.providerType,e.unwrappedUrl,e.creationDateTime),e.shouldAddComposeLinkViewState&&Object(u.f)(e.linkId)})),Object(i.orchestrator)(o,(function(e){var t,n;(null===(t=e.response)||void 0===t?void 0:t.FileName)&&function(e,t){Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,c.g.import()];case 1:return n.sent()(t)&&s.c.importAndExecute([e]),[2]}}))}))}(null===(n=e.response)||void 0===n?void 0:n.FileName,e.providerType)}));var d=n(121),l=n(1992),f=n(2399),h=n(5);function p(e){var t=!1;if(e){try{var n=Object(h.nc)(e);t=Object(h.Fb)(n,Object(h.h)(Object(h.Rb)(),-10))&&Object(h.Hb)(n,Object(h.Rb)())}catch(e){}Object(d.s)("validlinkCreatedDateTime",{isNewlyCreatedLink:t})}return t}function v(e,t,n,i,o,u,a){return Object(r.c)(this,void 0,void 0,(function(){var s,h,v,b,m,g;return Object(r.f)(this,(function(O){switch(O.label){case 0:return h="",v=function(e){var t,n,i=e.toLowerCase();try{for(var o=Object(r.k)(["onedrive.aspx","onenote.aspx","allitems.aspx","all.aspx","sites"]),u=o.next();!u.done;u=o.next()){var a=u.value;if(-1!==i.indexOf(a))return a}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return"NoErrorExpected"}(e),b=new d.b("GetSharingInformationForLink"),[4,c.g.import()];case 1:m=O.sent(),b.addCustomData({anchorElementsSource:t.toString(),shouldBeautify:n,shouldRehydrate:i,expectedErrorType:v,providerType:o}),O.label=2;case 2:return O.trys.push([2,5,,6]),[4,f.h.import()];case 3:return[4,O.sent()(e,o,p(a))];case 4:return s=O.sent(),[3,6];case 5:return g=O.sent(),h=g.fetchErrorType,s={ResultCode:1},[3,6];case 6:return 0!==s.ResultCode||m(o)&&!s.CanonicalUrl?(0===s.ResultCode&&m(o)&&!s.CanonicalUrl&&(s.ResultCode=1,h="NullCanonicalUrlFromSuccessResponse"),Object(d.s)("GetSharingInformationFailure",{errorType:h,resultCode:s.ResultCode||-1,anchorElementsSource:t.toString(),shouldBeautify:n,shouldRehydrate:i,expectedErrorType:v}),b.addCustomData({errorType:h,resultCode:s.ResultCode||-1,extension:""}),b.endWithError("ServerError")):(b.addCustomData({errorType:"",resultCode:s.ResultCode||-1,extension:Object(l.d)(s.FileName||""),sharingLinkKind:s.SharingLinkKind,linkId:u}),b.end()),[2,s]}}))}))}n.d(t,"a",(function(){return"contenteditable"})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return v})),n.d(t,"d",(function(){return p}))},5765:function(e,t,n){"use strict";var r=n(2953),i=n.n(r);function o(e){return i()(e,"HTMLAnchorElement")}function u(e){return i()(e,"HTMLElement")}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}))},643:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return v})),n.d(t,"f",(function(){return b}));var r,i=n(100),o=n(464),u=n(43),a=0,c=Object(o.b)({overflow:"hidden !important"}),s="data-is-scrollable",d=function(e,t){if(e){var n=0,r=null;t.on(e,"touchstart",(function(e){1===e.targetTouches.length&&(n=e.targetTouches[0].clientY)}),{passive:!1}),t.on(e,"touchmove",(function(e){if(1===e.targetTouches.length&&(e.stopPropagation(),r)){var t=e.targetTouches[0].clientY-n,i=b(e.target);i&&(r=i),0===r.scrollTop&&t>0&&e.preventDefault(),r.scrollHeight-Math.ceil(r.scrollTop)<=r.clientHeight&&t<0&&e.preventDefault()}}),{passive:!1}),r=e}},l=function(e,t){if(e){t.on(e,"touchmove",(function(e){e.stopPropagation()}),{passive:!1})}},f=function(e){e.preventDefault()};function h(){var e=Object(i.a)();e&&e.body&&!a&&(e.body.classList.add(c),e.body.addEventListener("touchmove",f,{passive:!1,capture:!1})),a++}function p(){if(a>0){var e=Object(i.a)();e&&e.body&&1===a&&(e.body.classList.remove(c),e.body.removeEventListener("touchmove",f)),a--}}function v(){if(void 0===r){var e=document.createElement("div");e.style.setProperty("width","100px"),e.style.setProperty("height","100px"),e.style.setProperty("overflow","scroll"),e.style.setProperty("position","absolute"),e.style.setProperty("top","-9999px"),document.body.appendChild(e),r=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return r}function b(e){for(var t=e,n=Object(i.a)(e);t&&t!==n.body;){if("true"===t.getAttribute(s))return t;t=t.parentElement}for(t=e;t&&t!==n.body;){if("false"!==t.getAttribute(s)){var r=getComputedStyle(t),o=r?r.getPropertyValue("overflow-y"):"";if(o&&("scroll"===o||"auto"===o))return t}t=t.parentElement}return t&&t!==n.body||(t=Object(u.a)(e)),t}},705:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(420);function i(e,t){var n=Object(r.a)(e,(function(e){return e.hasAttribute(t)}));return n&&n.getAttribute(t)}},859:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},869:function(e,t,n){"use strict";var r=n(31),i={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"d",(function(){return h})),n.d(t,"a",(function(){return i}));var o=new r.c((function(){return Promise.all([n.e(4),n.e(21),n.e(739)]).then(n.bind(null,18223))})),u=new r.a(o,(function(e){return e.subscribe})),a=new r.a(o,(function(e){return e.unsubscribe})),c=new r.b(o,(function(e){return e.getChannelId})),s=new r.a(o,(function(e){return e.getChannelReady})),d=new r.a(o,(function(e){return e.setup})),l=new r.a(o,(function(e){return e.handleNotification})),f=new r.a(o,(function(e){return e.initializeNotificationManager})),h=new r.b(o,(function(e){return e.getNotificationEmitter}))},883:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(56);function i(e,t){for(var n=Object(r.a)({},t),i=0,o=Object.keys(e);i<o.length;i++){var u=o[i];void 0===n[u]&&(n[u]=e[u])}return n}},9508:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var r=n(31),i=new r.c((function(){return Promise.all([n.e(107),n.e(594)]).then(n.bind(null,12160))})),o=Object(r.d)(i,(function(e){return e.ComposeRibbon})),u=new r.b(i,(function(e){return e.showInsertLinkDialog}))}}]);
//# sourceMappingURL=owa.MailBoot~HtmlEditorLinkPlugin.js.map
self.scriptsLoaded['owa.MailBoot~HtmlEditorLinkPlugin.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~HtmlEditorLinkPlugin.js'] = (new Date()).getTime();