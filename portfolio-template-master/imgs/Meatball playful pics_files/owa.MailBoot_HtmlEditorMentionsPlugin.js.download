self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~HtmlEditorMentionsPlugin.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[673],{10493:function(e,t,n){"use strict";var r=n(20),i=n(8294),a=n(424),o=n(49),s=n(1247),l=n(0),c=n(713),u=n(7),d=function(e){var t=e.theme,n=e.isHighlighted,r=t.palette;return{container:[{height:"48px",width:"300px",maxWidth:"100%",overflow:"hidden",position:"relative"},n&&{backgroundColor:r.themeLighter},[{selectors:{":hover":{backgroundColor:r.neutralLighter},":hover .FindRecipient-maskRecipientButton":{opacity:1}}},n&&{selectors:{":hover":{backgroundColor:r.themeLight}}}]],maskRecipientButton:["FindRecipient-maskRecipientButton",{height:"48px",width:"calc(15% - 12px)",position:"absolute",top:0,right:0,opacity:0},[{selectors:{":hover":{backgroundColor:r.neutralLight}}},n&&{selectors:{"hover:":{backgroundColor:r.themeTertiary}}}]],personaContainer:[{marginLeft:"12px",marginTop:"8px",display:"inline-block",tableLayout:"fixed",overflow:"hidden",textOverflow:"ellipsis",width:"85%"}],personaImage:[{position:"relative",display:"inline-block",verticalAlign:"middle",width:"32px"}],personaText:[{paddingLeft:"12px",display:"inline-block",verticalAlign:"middle",width:"80%"}],memberPersonaImage:[{position:"relative",display:"table-cell",verticalAlign:"middle",width:"20px"}],personaTextLine:[{width:"100%",display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}],personaLineOne:[{fontSize:u.FontSizes.medium,fontWeight:u.FontWeights.regular,color:r.neutralPrimary}],personaLineTwo:[{fontSize:u.FontSizes.small,fontWeight:u.FontWeights.regular,color:r.neutralSecondary,textOverflow:"ellipsis",position:"relative",top:"-2px"}],cancelIcon:[{fontSize:u.FontSizes.small,color:r.neutralPrimary,position:"relative",top:"18px",left:"10px"}],linkedInIcon:[{fontSize:u.FontSizes.small,position:"relative",color:"#106ebe",verticalAlign:"bottom",paddingLeft:"5px"}]}},f=n(132),h=n(158),p=Object(c.a)();t.a=Object(r.a)((function(e){var t=e.findRecipient,n=e.maskRecipientAction,r=e.isHighlighted,c=e.theme,u=void 0===c?Object(f.d)():c,g=p(d,{theme:u,isHighlighted:r}),v=Object(i.a)(t),m=t.EmailAddress.EmailAddress,b=!1;t.PersonaTypeString&&"ImplicitGroup"==t.PersonaTypeString&&t.Members&&t.Members.length>0&&(b=!0);var y=t.EmailAddress.MailboxType;return l.createElement("div",{className:g.container,onClick:function(t){t.preventDefault(),e.addRecipientAction(e.findRecipient)}},l.createElement("div",{className:g.personaContainer},l.createElement("div",{className:g.personaImage},function(e,t,n){return e?l.createElement(s.a,{name:"Implicit Group",emailAddress:n,size:o.c.size32,showPersonaDetails:!1,initialsColor:o.a.lightBlue}):l.createElement(s.a,{name:t,emailAddress:n,size:o.c.size32,showPersonaDetails:!1})}(b,v,m)),l.createElement("div",{className:g.personaText},l.createElement("span",{className:h(g.personaLineOne,g.personaTextLine)},v,"LinkedIn"==y&&l.createElement(a.a,{className:g.linkedInIcon,iconName:"LinkedInLogo"})),function(e,t,n,r,i,a){return r?function(e,t){return e.Members.map((function(e){return l.createElement("div",{className:t,key:e.EmailAddress},l.createElement(s.a,{key:e.EmailAddress,name:e.Name,emailAddress:e.EmailAddress,size:o.c.size16,showPersonaDetails:!1,mailboxType:e.MailboxType}))}))}(i,n):l.createElement("span",{className:h(e,t)},a)}(g.personaLineTwo,g.personaTextLine,g.memberPersonaImage,b,t,m))),n&&l.createElement("div",{className:g.maskRecipientButton,onClick:function(t){t.preventDefault(),t.stopPropagation(),e.maskRecipientAction&&e.maskRecipientAction(e.findRecipient)}},l.createElement(a.a,{className:g.cancelIcon,iconName:"Cancel"})))}))},1090:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=/[\(\[\{][^\)\]\}]*[\)\]\}]/g,i=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,a=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,o=/\s+/g,s=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function l(e,t,n){return e?(e=function(e){return e=(e=(e=(e=e.replace(r,"")).replace(i,"")).replace(o," ")).trim()}(e),s.test(e)||!n&&a.test(e)?"":function(e,t){var n="",r=e.split(" ");return 2===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[1].charAt(0).toUpperCase()):3===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[2].charAt(0).toUpperCase()):0!==r.length&&(n+=r[0].charAt(0).toUpperCase()),t&&n.length>1?n.charAt(1)+n.charAt(0):n}(e,t)):""}},1091:function(e,t,n){"use strict";function r(e){return e.clientWidth<e.scrollWidth}function i(e){return e.clientHeight<e.scrollHeight}function a(e){return r(e)||i(e)}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a}))},11742:function(e,t,n){var r=n(15550),i=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},1247:function(e,t,n){"use strict";var r=n(1),i=n(814),a=n(211),o=n(1257),s=n(20),l=n(0),c=n(49),u=n(1867),d=n(1238),f=n(31),h=new f.c((function(){return n.e(1406).then(n.bind(null,1873))})),p=new f.a(h,(function(e){return e.getPersonaPhoto})),g=n(1547),v=n(378).bind(g);t.a=Object(s.a)((function(e){var t;e=Object(r.a)({emailAddress:"",name:"",size:c.c.regular,secondaryText:"",showPresence:!1,mailboxType:""},e);var n=Object(o.a)(e.emailAddress,e.personaId,e.size,e.mailboxType,e.name);l.useEffect((function(){!function(e){(e.emailAddress||e.name||e.personaId)&&p.importAndExecute(e.name,e.emailAddress,e.personaId,e.size,e.hexConsumerIdForUser||Object(i.a)(e.emailAddress),e.mailboxType,e.skipLoadingPhoto)}(e)}),[n]);var s=a.a.viewStates.get(n);if(!s)return null;var f=e.className,h=e.size,m=e.name,b=e.statusText,y=e.showPersonaDetails,S=e.secondaryText,k=e.showSecondaryText,w=e.presence,E=e.onRenderPrimaryText,T=e.onRenderCoin,A=e.initialsColor,O=e.onRenderInitials,x=e.styleProps,C=e.coinProps,I=e.showUnknownPersonaCoin,R=e.imageInitials,_=(null===(t=s.personaBlob)||void 0===t?void 0:t.blobUrl)?{imageUrl:s.personaBlob.blobUrl,imageShouldFadeIn:!1,imageShouldStartVisible:!0}:{};return y||k||b?l.createElement(u.a,Object(r.a)({className:v(f,g.persona),presence:w||c.b.none,hidePersonaDetails:!y,size:h,text:m,secondaryText:S,showSecondaryText:k,tertiaryText:b,onRenderPrimaryText:E,onRenderCoin:T,onRenderInitials:O},_,{initialsColor:A,showUnknownPersonaCoin:I,styles:x,coinProps:C,imageInitials:R})):l.createElement(d.a,Object(r.a)({},C,{className:v(f,g.persona),presence:w||c.b.none,size:h,text:m,onRenderCoin:T,onRenderInitials:O},_,{initialsColor:A,showUnknownPersonaCoin:I,showInitialsUntilImageLoads:!0,imageInitials:R}))}))},1257:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(477);function i(e,t,n,i,a){var o="",s=Object(r.a)();return e?o+=e.toLowerCase():t?o+=t:a&&(o+=a.toLowerCase()),i&&s&&(o+=i),n&&!s&&(o+=n),o}},1285:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(49),i=[r.a.lightBlue,r.a.blue,r.a.darkBlue,r.a.teal,r.a.green,r.a.darkGreen,r.a.lightPink,r.a.pink,r.a.magenta,r.a.purple,r.a.orange,r.a.lightRed,r.a.darkRed,r.a.violet,r.a.gold,r.a.burgundy,r.a.warmGray,r.a.cyan,r.a.rust,r.a.coolGray],a=i.length;function o(e){var t=e.primaryText,n=e.text,o=e.initialsColor;return"string"==typeof o?o:function(e){switch(e){case r.a.lightBlue:return"#4F6BED";case r.a.blue:return"#0078D4";case r.a.darkBlue:return"#004E8C";case r.a.teal:return"#038387";case r.a.lightGreen:case r.a.green:return"#498205";case r.a.darkGreen:return"#0B6A0B";case r.a.lightPink:return"#C239B3";case r.a.pink:return"#E3008C";case r.a.magenta:return"#881798";case r.a.purple:return"#5C2E91";case r.a.orange:return"#CA5010";case r.a.red:return"#EE1111";case r.a.lightRed:return"#D13438";case r.a.darkRed:return"#A4262C";case r.a.transparent:return"transparent";case r.a.violet:return"#8764B8";case r.a.gold:return"#986F0B";case r.a.burgundy:return"#750B1C";case r.a.warmGray:return"#7A7574";case r.a.cyan:return"#005B70";case r.a.rust:return"#8E562E";case r.a.coolGray:return"#69797E";case r.a.black:return"#1D1D1D";case r.a.gray:return"#393939"}}(o=void 0!==o?o:function(e){var t=r.a.blue;if(!e)return t;for(var n=0,o=e.length-1;o>=0;o--){var s=e.charCodeAt(o),l=o%8;n^=(s<<l)+(s>>8-l)}return t=i[n%a]}(n||t))}},1287:function(e,t,n){"use strict";t.a=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},1288:function(e,t,n){"use strict";t.a=function(e,t){return e.has(t)}},1292:function(e,t,n){"use strict";var r=n(624),i="__lodash_hash_undefined__";var a=function(e){return this.__data__.set(e,i),this};var o=function(e){return this.__data__.has(e)};function s(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r.a;++t<n;)this.add(e[t])}s.prototype.add=s.prototype.push=a,s.prototype.has=o;t.a=s},1359:function(e,t,n){"use strict";t.a=function(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}},1547:function(e,t,n){var r=n(1548),i=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},1548:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,"._3fxSw_KFta16t28JP70e_s .ms-Persona-initials{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage)}html[dir] ._3fxSw_KFta16t28JP70e_s .ms-Persona-initials{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground)}",""]),t.locals={persona:"_3fxSw_KFta16t28JP70e_s"}},1553:function(e,t,n){"use strict";var r=n(768),i=n(3),a=n(0),o=n(7),s=n(713),l=n(261),c=n(1091),u=n(799),d=n(66),f=n(470),h=n(309),p=n(214),g=n(63),v=n(735),m=n(1115),b=n(60),y=Object(s.a)(),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderContent=function(e){return a.createElement("p",{className:t._classNames.subText},e.content)},t}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.calloutProps,r=e.directionalHint,o=e.directionalHintForRTL,s=e.styles,l=e.id,c=e.maxWidth,u=e.onRenderContent,d=void 0===u?this._onRenderContent:u,f=e.targetElement,h=e.theme;return this._classNames=y(s,{theme:h,className:t||n&&n.className,beakWidth:n&&n.beakWidth,gapSpace:n&&n.gapSpace,maxWidth:c}),a.createElement(m.a,Object(i.__assign)({target:f,directionalHint:r,directionalHintForRTL:o},n,Object(g.j)(this.props,g.h,["id"]),{className:this._classNames.root}),a.createElement("div",{className:this._classNames.content,id:l,role:"tooltip",onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},d(this.props,this._onRenderContent)))},t.defaultProps={directionalHint:b.a.topCenter,maxWidth:"364px",calloutProps:{isBeakVisible:!0,beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1}},t}(a.Component),k=Object(r.a)(S,(function(e){var t=e.className,n=e.beakWidth,r=void 0===n?16:n,i=e.gapSpace,a=void 0===i?0:i,s=e.maxWidth,l=e.theme,c=l.semanticColors,u=l.fonts,d=l.effects,f=-(Math.sqrt(r*r/2)+a)+1/window.devicePixelRatio;return{root:["ms-Tooltip",l.fonts.medium,o.AnimationClassNames.fadeIn200,{background:c.menuBackground,boxShadow:d.elevation8,padding:"8px",maxWidth:s,selectors:{":after":{content:"''",position:"absolute",bottom:f,left:f,right:f,top:f,zIndex:0}}},t],content:["ms-Tooltip-content",u.small,{position:"relative",zIndex:1,color:c.menuItemText,wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden"}],subText:["ms-Tooltip-subtext",{fontSize:"inherit",fontWeight:"inherit",color:"inherit",margin:0}]}}),void 0,{scope:"Tooltip"}),w=n(578),E=Object(s.a)(),T=function(e){function t(n){var r=e.call(this,n)||this;return r._tooltipHost=a.createRef(),r._defaultTooltipId=Object(l.a)("tooltip"),r.show=function(){r._toggleTooltip(!0)},r.dismiss=function(){r._hideTooltip()},r._getTargetElement=function(){if(r._tooltipHost.current){var e=r.props.overflowMode;if(void 0!==e)switch(e){case v.a.Parent:return r._tooltipHost.current.parentElement;case v.a.Self:return r._tooltipHost.current}return r._tooltipHost.current}},r._onTooltipMouseEnter=function(e){var n=r.props,i=n.overflowMode,a=n.delay;if(t._currentVisibleTooltip&&t._currentVisibleTooltip!==r&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=r,void 0!==i){var o=r._getTargetElement();if(o&&!Object(c.b)(o))return}if(!e.target||!Object(u.a)(e.target,r._getTargetElement()))if(r._clearDismissTimer(),r._clearOpenTimer(),a!==w.a.zero){r.setState({isAriaPlaceholderRendered:!0});var s=r._getDelayTime(a);r._openTimerId=r._async.setTimeout((function(){r._toggleTooltip(!0)}),s)}else r._toggleTooltip(!0)},r._onTooltipMouseLeave=function(e){var n=r.props.closeDelay;r._clearDismissTimer(),r._clearOpenTimer(),n?r._dismissTimerId=r._async.setTimeout((function(){r._toggleTooltip(!1)}),n):r._toggleTooltip(!1),t._currentVisibleTooltip===r&&(t._currentVisibleTooltip=void 0)},r._onTooltipKeyDown=function(e){(e.which===d.a.escape||e.ctrlKey)&&r.state.isTooltipVisible&&(r._hideTooltip(),e.stopPropagation())},r._clearDismissTimer=function(){r._async.clearTimeout(r._dismissTimerId)},r._clearOpenTimer=function(){r._async.clearTimeout(r._openTimerId)},r._hideTooltip=function(){r._clearOpenTimer(),r._clearDismissTimer(),r._toggleTooltip(!1)},r._toggleTooltip=function(e){r.state.isTooltipVisible!==e&&r.setState({isAriaPlaceholderRendered:!1,isTooltipVisible:e},(function(){return r.props.onTooltipToggle&&r.props.onTooltipToggle(e)}))},r._getDelayTime=function(e){switch(e){case w.a.medium:return 300;case w.a.long:return 500;default:return 0}},Object(f.a)(r),r.state={isAriaPlaceholderRendered:!1,isTooltipVisible:!1},r._async=new h.a(r),r}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.calloutProps,n=e.children,r=e.content,s=e.directionalHint,l=e.directionalHintForRTL,c=e.hostClassName,u=e.id,d=e.setAriaDescribedBy,f=void 0===d||d,h=e.tooltipProps,v=e.styles,m=e.theme;this._classNames=E(v,{theme:m,className:c});var b=this.state,y=b.isAriaPlaceholderRendered,S=b.isTooltipVisible,w=u||this._defaultTooltipId,T=!!(r||h&&h.onRenderContent&&h.onRenderContent()),A=S&&T,O=f&&S&&T?w:void 0;return a.createElement("div",Object(i.__assign)({className:this._classNames.root,ref:this._tooltipHost},{onFocusCapture:this._onTooltipMouseEnter},{onBlurCapture:this._hideTooltip},{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,onKeyDown:this._onTooltipKeyDown,"aria-describedby":O}),n,A&&a.createElement(k,Object(i.__assign)({id:w,content:r,targetElement:this._getTargetElement(),directionalHint:s,directionalHintForRTL:l,calloutProps:Object(p.a)({},t,{onDismiss:this._hideTooltip,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave}),onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave},Object(g.j)(this.props,g.h),h)),y&&a.createElement("div",{id:w,style:o.hiddenContentStyle},r))},t.prototype.componentWillUnmount=function(){t._currentVisibleTooltip&&t._currentVisibleTooltip===this&&(t._currentVisibleTooltip=void 0),this._async.dispose()},t.defaultProps={delay:w.a.medium},t}(a.Component),A={root:"ms-TooltipHost",ariaPlaceholder:"ms-TooltipHost-aria-placeholder"};n.d(t,"a",(function(){return O}));var O=Object(r.a)(T,(function(e){var t=e.className,n=e.theme;return{root:[Object(o.getGlobalClassNames)(A,n).root,{display:"inline"},t]}}),void 0,{scope:"TooltipHost"})},15550:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._1OtrSZdhKXVv3UhaivrdJ4{text-decoration:inherit;color:"[theme:black, default:#000000]"}html[dir] ._1OtrSZdhKXVv3UhaivrdJ4{border-radius:2px;padding:0 1px;background-color:"[theme:neutralLighter, default:#f3f2f1]"}html[dir] ._1OtrSZdhKXVv3UhaivrdJ4:hover{background-color:"[theme:neutralLight, default:#edebe9]"}',""]),t.locals={mentionsCompose:"_1OtrSZdhKXVv3UhaivrdJ4"}},15551:function(e,t,n){var r=n(15552),i=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},15552:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'.HyBZfr2RFL7OVXifbvzJV{width:300px}html[dir] .HyBZfr2RFL7OVXifbvzJV{background-color:"[theme:white, default:#ffffff]"}._2Q4dKdxSizYaUL2S93J9jc{max-height:470px;overflow-x:hidden}._2tarRb2T3ruY31bYx2guV{overflow:hidden}',""]),t.locals={callout:"HyBZfr2RFL7OVXifbvzJV",scrollContainer:"_2Q4dKdxSizYaUL2S93J9jc",recipientCollection:"_2tarRb2T3ruY31bYx2guV"}},158:function(e,t,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var a=typeof r;if("string"===a||"number"===a)e.push(r);else if(Array.isArray(r)&&r.length){var o=i.apply(null,r);o&&e.push(o)}else if("object"===a)for(var s in r)n.call(r,s)&&r[s]&&e.push(s)}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},211:function(e,t,n){"use strict";var r=n(579),i=n(574),a=n(2),o=n(14),s={viewStates:new o.ObservableMap,livePersonaCardInitializationStatus:{state:r.a.NotInitialized,timestamp:Date.now()},isLivePersonaCardInitialized:!1,isPersonaCardDisabled:!1,brandList:null,brandListLoadState:i.a.unloaded,dynamicBrandSets:{unverifiedBrands:new o.ObservableMap,verifiedBrands:new o.ObservableMap}},l=Object(a.createStore)("personacontrol",s)();t.a=l},225:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(572);function i(e,t){return void 0===t&&(t=!0),e&&(t&&Object(r.a)(e)||e.parentNode&&e.parentNode)}},261:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(43),i=n(118),a="__currentId__",o="id__",s=Object(r.a)()||{};void 0===s[a]&&(s[a]=0);var l=!1;function c(e){if(!l){var t=i.b.getInstance();t&&t.onReset&&t.onReset(u),l=!0}var n=s[a]++;return(void 0===e?o:e)+n}function u(e){void 0===e&&(e=0),s[a]=e}},2661:function(e){e.exports=JSON.parse('{"a":"Wua"}')},2662:function(e){e.exports=JSON.parse('{"a":"Uua"}')},2692:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,i=n(2978),a=n(2974),o=n(2976),s=n(2661),l=n(2662),c=n(2977),u=n(2975),d=n(6),f=n(424),h=n(1301),p=n(197),g=n(0),v=n(3693),m=n(378).bind(v);!function(e){e[e.Default=0]="Default",e[e.Searching=1]="Searching",e[e.TypeToSearch=2]="TypeToSearch",e[e.SearchDirectory=3]="SearchDirectory",e[e.TopNResults=4]="TopNResults",e[e.UseAddress=5]="UseAddress",e[e.SuggestedContacts=6]="SuggestedContacts",e[e.FindPeopleFeedback=7]="FindPeopleFeedback"}(r||(r={}));var b=function(e){switch(e.infoType){case r.Searching:return g.createElement("div",{className:v.container},g.createElement("div",{className:v.iconContainer},g.createElement(h.a,{className:v.loadingSpinner})),g.createElement("div",{className:v.textContainer},Object(d.c)(Object(d.b)(u.a),e.queryString)));case r.TypeToSearch:return g.createElement("div",{className:v.container},g.createElement("div",{className:m(v.textContainer,v.centered)},Object(d.b)(c.a)));case r.SearchDirectory:return e.searchDirectoryAction&&g.createElement("div",{className:m(v.container,v.hoverable,{isHighlighted:e.highlighted}),onClick:e.searchDirectoryAction},g.createElement("div",{className:v.iconContainer},g.createElement(f.a,{className:v.searchIcon,iconName:"Search"})),g.createElement("div",{className:v.textContainer},Object(p.a)()?Object(d.b)(l.a):Object(d.b)(s.a)));case r.TopNResults:return g.createElement("div",{className:v.container},g.createElement("div",{className:m(v.textContainer,v.centered)},e.numberOfResults?Object(d.c)(Object(d.b)(o.a),e.numberOfResults):Object(d.b)(a.a)));case r.UseAddress:return e.useTypedAddressAction&&g.createElement("div",null,g.createElement("div",{className:m(v.hoverable,{isHighlighted:e.highlighted})},g.createElement("div",{className:m(v.textContainer,v.useAddressContainer),onClick:e.useTypedAddressAction},Object(d.c)(Object(d.b)(i.a),e.queryString))),g.createElement(b,{infoType:r.TopNResults,highlighted:!1,queryString:e.queryString,numberOfResults:e.numberOfResults}));default:return null}};t.b=b},2974:function(e){e.exports=JSON.parse('{"a":"Tua"}')},2975:function(e){e.exports=JSON.parse('{"a":"Vua"}')},2976:function(e){e.exports=JSON.parse('{"a":"Sua"}')},2977:function(e){e.exports=JSON.parse('{"a":"Pua"}')},2978:function(e){e.exports=JSON.parse('{"a":"Rua"}')},320:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(225);function i(e,t,n){void 0===n&&(n=!0);var i=!1;if(e&&t)if(n)if(e===t)i=!0;else for(i=!1;t;){var a=Object(r.a)(t);if(a===e){i=!0;break}t=a}else e.contains&&(i=e.contains(t));return i}},3429:function(e,t,n){"use strict";var r=n(1359);var i=function(e){return e!=e};var a=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1};t.a=function(e,t,n){return t==t?a(e,t,n):Object(r.a)(e,i,n)}},3568:function(e,t,n){"use strict";function r(e,t){return null!=e&&null!=t&&(e==t||e.EmailAddress&&t.EmailAddress&&null!=e.EmailAddress.EmailAddress&&null!=t.EmailAddress.EmailAddress&&e.EmailAddress.EmailAddress.toLowerCase()==t.EmailAddress.EmailAddress.toLowerCase()||e.ADObjectId&&t.ADObjectId&&e.ADObjectId==t.ADObjectId||e.PersonaId&&t.PersonaId&&e.PersonaId==t.PersonaId)}n.d(t,"a",(function(){return r}))},3693:function(e,t,n){var r=n(3694),i=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},3694:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._3XTe71uhdRChCr1dRUw5Ps{height:48px;width:300px;overflow:hidden;display:table}html[dir] ._3XTe71uhdRChCr1dRUw5Ps{border-top:1px solid "[theme:neutralLight, default:#edebe9]"}._32gFw3jblWwvQfeLgBwada{font-size:12px;font-weight:400;width:calc(100% - 46px);display:table-cell;vertical-align:middle}html[dir=ltr] ._32gFw3jblWwvQfeLgBwada{text-align:left;padding-left:12px}html[dir=rtl] ._32gFw3jblWwvQfeLgBwada{text-align:right;padding-right:12px}._32gFw3jblWwvQfeLgBwada.dv3CIcvVMXpT21T9XHete{width:100%}html[dir] ._32gFw3jblWwvQfeLgBwada.dv3CIcvVMXpT21T9XHete{text-align:center;padding:0}._2q8XY7ndqTvhZ5CDlgQw--{width:32px;display:table-cell}html[dir] ._2q8XY7ndqTvhZ5CDlgQw--{padding-top:14px;text-align:center}html[dir=ltr] ._2q8XY7ndqTvhZ5CDlgQw--{padding-left:12px}html[dir=rtl] ._2q8XY7ndqTvhZ5CDlgQw--{padding-right:12px}html[dir] ._3_7F1stjskPxVf1n1R8EY1:hover{background-color:"[theme:neutralLighter, default:#f3f2f1]"}html[dir] ._3_7F1stjskPxVf1n1R8EY1:hover._3cIj55rShf02QTJNXT1qty{background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] ._3_7F1stjskPxVf1n1R8EY1._3cIj55rShf02QTJNXT1qty{background-color:"[theme:themeLighter, default:#DEECF9]"}._1wm3wZ7g_2DyeIpcFB_UpA{font-size:21px;font-weight:100;color:"[theme:themePrimary, default:#0078D4]"}._38lQWUuwztVEGkiWX0-V-u{height:36px}',""]),t.locals={container:"_3XTe71uhdRChCr1dRUw5Ps",textContainer:"_32gFw3jblWwvQfeLgBwada",centered:"dv3CIcvVMXpT21T9XHete",iconContainer:"_2q8XY7ndqTvhZ5CDlgQw--",hoverable:"_3_7F1stjskPxVf1n1R8EY1",isHighlighted:"_3cIj55rShf02QTJNXT1qty",searchIcon:"_1wm3wZ7g_2DyeIpcFB_UpA",useAddressContainer:"_38lQWUuwztVEGkiWX0-V-u"}},375:function(e,t,n){"use strict";n.d(t,"e",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"c",(function(){return v})),n.d(t,"k",(function(){return m})),n.d(t,"j",(function(){return b})),n.d(t,"o",(function(){return y})),n.d(t,"n",(function(){return S})),n.d(t,"m",(function(){return k})),n.d(t,"l",(function(){return w})),n.d(t,"a",(function(){return E})),n.d(t,"p",(function(){return T})),n.d(t,"b",(function(){return O})),n.d(t,"g",(function(){return x})),n.d(t,"d",(function(){return C}));var r=n(705),i=n(320),a=n(225),o=n(43),s=n(100),l="data-is-focusable",c="data-is-visible",u="data-focuszone-id",d="data-is-sub-focuszone";function f(e,t,n){return b(e,t,!0,!1,!1,n)}function h(e,t,n){return m(e,t,!0,!1,!0,n)}function p(e,t,n,r){return void 0===r&&(r=!0),b(e,t,r,!1,!1,n,!1,!0)}function g(e,t,n,r){return void 0===r&&(r=!0),m(e,t,r,!1,!0,n,!1,!0)}function v(e){var t=b(e,e,!0,!1,!1,!0);return!!t&&(O(t),!0)}function m(e,t,n,r,i,a,o,s){if(!t||!o&&t===e)return null;var l=y(t);if(i&&l&&(a||!k(t)&&!w(t))){var c=m(e,t.lastElementChild,!0,!0,!0,a,o,s);if(c){if(s&&S(c,!0)||!s)return c;var u=m(e,c.previousElementSibling,!0,!0,!0,a,o,s);if(u)return u;for(var d=c.parentElement;d&&d!==t;){var f=m(e,d.previousElementSibling,!0,!0,!0,a,o,s);if(f)return f;d=d.parentElement}}}if(n&&l&&S(t,s))return t;var h=m(e,t.previousElementSibling,!0,!0,!0,a,o,s);return h||(r?null:m(e,t.parentElement,!0,!1,!1,a,o,s))}function b(e,t,n,r,i,a,o,s){if(!t||t===e&&i&&!o)return null;var l=y(t);if(n&&l&&S(t,s))return t;if(!i&&l&&(a||!k(t)&&!w(t))){var c=b(e,t.firstElementChild,!0,!0,!1,a,o,s);if(c)return c}if(t===e)return null;var u=b(e,t.nextElementSibling,!0,!0,!1,a,o,s);return u||(r?null:b(e,t.parentElement,!1,!1,!0,a,o,s))}function y(e){if(!e||!e.getAttribute)return!1;var t=e.getAttribute(c);return null!=t?"true"===t:0!==e.offsetHeight||null!==e.offsetParent||!0===e.isVisible}function S(e,t){if(!e||e.disabled)return!1;var n=0,r=null;e&&e.getAttribute&&(r=e.getAttribute("tabIndex"))&&(n=parseInt(r,10));var i=e.getAttribute?e.getAttribute(l):null,a=null!==r&&n>=0,o=!!e&&"false"!==i&&("A"===e.tagName||"BUTTON"===e.tagName||"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||"true"===i||a);return t?-1!==n&&o:o}function k(e){return!!(e&&e.getAttribute&&e.getAttribute(u))}function w(e){return!(!e||!e.getAttribute||"true"!==e.getAttribute(d))}function E(e){var t=Object(s.a)(e),n=t&&t.activeElement;return!(!n||!Object(i.a)(e,n))}function T(e,t){return"true"!==Object(r.a)(e,t)}var A=void 0;function O(e){if(e){if(A)return void(A=e);A=e;var t=Object(o.a)(e);t&&t.requestAnimationFrame((function(){A&&A.focus(),A=void 0}))}}function x(e,t){for(var n=e,r=0,i=t;r<i.length;r++){var a=i[r],o=n.children[Math.min(a,n.children.length-1)];if(!o)break;n=o}return n=S(n)&&y(n)?n:b(e,n,!0)||m(e,n)}function C(e,t){for(var n=[];t&&e&&t!==e;){var r=Object(a.a)(t,!0);if(null===r)return[];n.unshift(Array.prototype.indexOf.call(r.children,t)),t=r}return n}},378:function(e,t,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var a=typeof r;if("string"===a||"number"===a)e.push(this&&this[r]||r);else if(Array.isArray(r))e.push(i.apply(this,r));else if("object"===a)for(var o in r)n.call(r,o)&&r[o]&&e.push(this&&this[o]||o)}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},381:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(0),i=r.createContext({window:"object"==typeof window?window:void 0}),a=function(){return r.useContext(i).window},o=function(){var e;return null===(e=r.useContext(i).window)||void 0===e?void 0:e.document},s=function(e){return r.createElement(i.Provider,{value:e},e.children)}},420:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(225);function i(e,t){return e&&e!==document.body?t(e)?e:i(Object(r.a)(e),t):null}},4267:function(e,t,n){"use strict";var r=n(3429);t.a=function(e,t){return!!(null==e?0:e.length)&&Object(r.a)(e,t,0)>-1}},4268:function(e,t,n){"use strict";t.a=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}},4438:function(e,t,n){"use strict";t.a=function(){}},463:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(546);function i(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=Object(r.a)(e,e[n],t[n]))}},470:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(463);function i(e){Object(r.a)(e,{componentDidMount:a,componentDidUpdate:o,componentWillUnmount:s})}function a(){l(this.props.componentRef,this)}function o(e){e.componentRef!==this.props.componentRef&&(l(e.componentRef,null),l(this.props.componentRef,this))}function s(){l(this.props.componentRef,null)}function l(e,t){e&&("object"==typeof e?e.current=t:"function"==typeof e&&e(t))}},477:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(19),i=n(197),a=n(24);function o(){return Object(i.a)()&&Object(a.i)("rp-imageApiConsumer")&&!Object(r.a)().SessionSettings.IsShadowMailbox}},4786:function(e,t,n){"use strict";var r=n(1292),i=n(4267),a=n(4268),o=n(1288),s=n(645),l=n(4438),c=n(1287),u=s.a&&1/Object(c.a)(new s.a([,-0]))[1]==1/0?function(e){return new s.a(e)}:l.a,d=200;t.a=function(e,t,n){var s=-1,l=i.a,f=e.length,h=!0,p=[],g=p;if(n)h=!1,l=a.a;else if(f>=d){var v=t?null:u(e);if(v)return Object(c.a)(v);h=!1,l=o.a,g=new r.a}else g=t?[]:p;e:for(;++s<f;){var m=e[s],b=t?t(m):m;if(m=n||0!==m?m:0,h&&b==b){for(var y=g.length;y--;)if(g[y]===b)continue e;t&&g.push(b),p.push(m)}else l(g,b,n)||(g!==p&&g.push(b),p.push(m))}return p}},480:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r,i=n(66),a=((r={})[i.a.up]=1,r[i.a.down]=1,r[i.a.left]=1,r[i.a.right]=1,r[i.a.home]=1,r[i.a.end]=1,r[i.a.tab]=1,r[i.a.pageUp]=1,r[i.a.pageDown]=1,r);function o(e){return!!a[e]}function s(e){a[e]=1}},483:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r="data-portal-element";function i(e){e.setAttribute(r,"true")}},49:function(e,t,n){"use strict";var r,i,a;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(r||(r={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(i||(i={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(a||(a={}))},5227:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(5228))},5228:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5229);t.PickerPlugin=r.default},5229:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2634),i=n(2001),a=i.Browser.isIE?"Esc":"Escape",o=i.Browser.isIE?"Left":"ArrowLeft",s=i.Browser.isIE?"Up":"ArrowUp",l=i.Browser.isIE?"Right":"ArrowRight",c=i.Browser.isIE?"Down":"ArrowDown",u=i.Browser.isIE?"Del":"Delete",d=[0,229],f=function(){function e(e,t){this.dataProvider=e,this.pickerOptions=t,this.isPendingInputEventHandling=!1}return e.prototype.getName=function(){return"Picker"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.dataProvider.onInitalize((function(e){t.editor.focus();var n=t.getWord(null);n&&0!=n.length||!t.lastKnownRange||(t.editor.select(t.lastKnownRange),n=t.getWord(null));t.editor.addUndoSnapshot((function(){n?r.replaceWithNode(t.editor,n,e,!0):t.editor.insertNode(e),t.setIsSuggesting(!1)}),t.pickerOptions.changeSource,t.pickerOptions.handleAutoComplete)}),(function(e){t.setIsSuggesting(e)}),e)},e.prototype.dispose=function(){this.editor=null,this.dataProvider.onDispose()},e.prototype.willHandleEventExclusively=function(e){return this.isSuggesting&&(0==e.eventType||2==e.eventType||3==e.eventType)},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 7:if("SetContent"==e.source&&this.dataProvider.onContentChanged){this.isSuggesting&&this.setIsSuggesting(!1);var t=[];this.editor.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",(function(e){e.id&&t.push(e.id)})),this.dataProvider.onContentChanged(t)}break;case 0:this.eventHandledOnKeyDown=!1,this.isAndroidKeyboardEvent(e)?(this.currentInputLength=this.calcInputLength(e),this.isPendingInputEventHandling=!0):(this.onKeyDownEvent(e),this.isPendingInputEventHandling=!1);break;case 3:this.isPendingInputEventHandling&&this.onAndroidInputEvent(e);break;case 2:!this.eventHandledOnKeyDown&&this.shouldHandleKeyUpEvent(e)&&(this.onKeyUpDomEvent(e),this.isPendingInputEventHandling=!1);break;case 6:this.isSuggesting&&this.setIsSuggesting(!1);break;case 14:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer)}},e.prototype.setLastKnownRange=function(e){this.lastKnownRange=e},e.prototype.setIsSuggesting=function(e){this.isSuggesting=e,e||this.setLastKnownRange(null),this.dataProvider.onIsSuggestingChanged(e),this.setAriaOwns(e),this.setAriaActiveDescendant(e?0:null)},e.prototype.cancelDefaultKeyDownEvent=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},e.prototype.getIdValue=function(e){var t=e;return t.attributes&&t.attributes.getNamedItem("id")?t.attributes.getNamedItem("id").value:null},e.prototype.getWordBeforeCursor=function(e){var t=this.editor.getContentSearcherOfCursor(e);return t?t.getWordBefore():null},e.prototype.replaceNode=function(e,t){e&&this.editor.deleteNode(e),t&&this.editor.insertNode(t)},e.prototype.getRangeUntilAt=function(e){var t,n,r=this;return this.editor.getContentSearcherOfCursor(e).forEachTextInlineElement((function(e){for(var i=!1,a=e.getTextContent(),o=a?a.length:-1;o>=0;){if(a[o]==r.pickerOptions.triggerCharacter){t=e.getStartPosition().move(o),i=!0;break}o--}return i&&(n=e.getEndPosition()),i})),i.createRange(t,n)||this.editor.getDocument().createRange()},e.prototype.shouldHandleKeyUpEvent=function(e){return this.isAndroidKeyboardEvent(e)||i.isCharacterValue(e.rawEvent)||this.isSuggesting&&!i.isModifierKey(e.rawEvent)},e.prototype.onKeyUpDomEvent=function(e){if(this.isSuggesting){var t=(r=(n=this.getWord(e)).substring(1)).trim();n==this.pickerOptions.triggerCharacter||t&&t.length>0&&t.split(" ").length<=4?(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange())):this.setIsSuggesting(!1)}else{var n=this.getWordBeforeCursor(e);if(this.blockSuggestions)null!=n&&n[0]!=this.pickerOptions.triggerCharacter&&(this.blockSuggestions=!1);else if(null!=n&&n.split(" ").length<=4&&n[0]==this.pickerOptions.triggerCharacter){this.setIsSuggesting(!0);var r;t=(r=n.substring(1)).trim();if(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange()),this.dataProvider.setCursorPoint){var i=this.editor.getContentSearcherOfCursor(e),a=this.editor.getDocument().createRange(),o=i.getInlineElementBefore().getContainerNode();if(!this.setRangeStart(a,o,n)){var s=o.previousSibling;this.setRangeStart(a,s,this.pickerOptions.triggerCharacter)}var l=a.getBoundingClientRect();if(0==l.left&&0==l.bottom&&0==l.top&&(l=a.getClientRects()[0]),l){a.detach();var c={x:l.left,y:(l.bottom+l.top)/2},u=(l.bottom-l.top)/2;this.dataProvider.setCursorPoint(c,u)}}}}},e.prototype.onKeyDownEvent=function(e){var t=e.rawEvent;if(this.isSuggesting)if(t.key==a)this.setIsSuggesting(!1),this.blockSuggestions=!0,this.cancelDefaultKeyDownEvent(e);else if("Backspace"==t.key){this.getWord(e)==this.pickerOptions.triggerCharacter&&this.setIsSuggesting(!1)}else this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?t.key==o||t.key==l:t.key==s||t.key==c)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?t.key==l:t.key==c),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=t.key&&"Tab"!=t.key||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e));else if("Backspace"==t.key)this.tryRemoveNode(e)&&this.cancelDefaultKeyDownEvent(e);else if(t.key==u){var n=this.editor.getContentSearcherOfCursor(e),r=n.getInlineElementAfter()?n.getInlineElementAfter().getContainerNode():null,i=r?this.getIdValue(r):null;if(i&&0==i.indexOf(this.pickerOptions.elementIdPrefix)){var d=this.dataProvider.onRemove(r,!1);this.replaceNode(r,d),this.cancelDefaultKeyDownEvent(e)}}},e.prototype.onAndroidInputEvent=function(e){(this.newInputLength=this.calcInputLength(e),this.newInputLength<this.currentInputLength||"deleteContentBackwards"===e.rawEvent.inputType)&&(this.tryRemoveNode(e)&&(this.eventHandledOnKeyDown=!0))},e.prototype.calcInputLength=function(e){var t=this.getInlineElementBeforeCursor(e);return t?t.length:0},e.prototype.tryRemoveNode=function(e){var t=this.editor.getContentSearcherOfCursor(e),n=t.getInlineElementBefore(),r=n?n.getContainerNode():null,a=r?this.getIdValue(r):null,o=t.getInlineElementAfter();if(a&&0==a.indexOf(this.pickerOptions.elementIdPrefix)&&(null==o||!(o instanceof i.PartialInlineElement))){var s=this.dataProvider.onRemove(r,!0);return s?(this.replaceNode(r,s),this.isPendingInputEventHandling?this.editor.runAsync((function(e){e.select(s,-3)})):this.editor.select(s,-3)):this.editor.deleteNode(r),!0}return!1},e.prototype.getWord=function(e){var t=this.getRangeUntilAt(e).toString(),n=this.getWordBeforeCursor(e);return t==this.pickerOptions.triggerCharacter&&t!=n?n:t},e.prototype.setRangeStart=function(e,t,n){var r=t?t.textContent.lastIndexOf(n):-1;return r>-1&&(e.setStart(t,r),!0)},e.prototype.setAriaOwns=function(e){this.editor.setEditorDomAttribute("aria-owns",e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null)},e.prototype.setAriaActiveDescendant=function(e){this.editor.setEditorDomAttribute("aria-activedescendant",null!=e&&this.pickerOptions.suggestionLabelPrefix?this.pickerOptions.suggestionLabelPrefix+e.toString():null)},e.prototype.getInlineElementBeforeCursor=function(e){var t=this.editor.getContentSearcherOfCursor(e),n=t?t.getInlineElementBefore():null;return n?n.getTextContent():null},e.prototype.isAndroidKeyboardEvent=function(e){return"Unidentified"==e.rawEvent.key||null==e.rawEvent.key&&d.indexOf(e.rawEvent.charCode)>-1},e}();t.default=f},532:function(e,t,n){"use strict";function r(e){return e&&!!e._virtual}n.d(t,"a",(function(){return r}))},546:function(e,t,n){"use strict";function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.length<2?t[0]:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];t.forEach((function(t){return t&&t.apply(e,n)}))}}n.d(t,"a",(function(){return r}))},572:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(532);function i(e){var t;return e&&Object(r.a)(e)&&(t=e._virtual.parent),t}},574:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.unloaded=0]="unloaded",e[e.loading=1]="loading",e[e.loadSucceeded=2]="loadSucceeded",e[e.loadFailed=3]="loadFailed"}(r||(r={}))},578:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.zero=0]="zero",e[e.medium=1]="medium",e[e.long=2]="long"}(r||(r={}))},579:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.NotInitialized="NotInitialized",e.Initializing="Initializing",e.Initialized="Initialized",e.Failed="Failed"}(r||(r={}))},622:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(0),i=n(43),a=n(480),o=n(283),s=new WeakMap;function l(e,t){var n,r=s.get(e);return n=r?r+t:1,s.set(e,n),n}function c(e){r.useEffect((function(){var t,n,r=Object(i.a)(null===(t=e)||void 0===t?void 0:t.current);if(r&&!0!==(null===(n=r.FabricConfig)||void 0===n?void 0:n.disableFocusRects)){var a=l(r,1);return a<=1&&(r.addEventListener("mousedown",d,!0),r.addEventListener("pointerdown",f,!0),r.addEventListener("keydown",h,!0)),function(){var e;r&&!0!==(null===(e=r.FabricConfig)||void 0===e?void 0:e.disableFocusRects)&&0===(a=l(r,-1))&&(r.removeEventListener("mousedown",d,!0),r.removeEventListener("pointerdown",f,!0),r.removeEventListener("keydown",h,!0))}}}),[e])}var u=function(e){return c(e.rootRef),null};function d(e){Object(o.b)(!1,e.target)}function f(e){"mouse"!==e.pointerType&&Object(o.b)(!1,e.target)}function h(e){Object(a.b)(e.which)&&Object(o.b)(!0,e.target)}},6240:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.mutatorAction)("Picker_SetTargetPoint",(function(e,t,n){e.targetPoint=t,e.bufferZone=n}))},643:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"f",(function(){return v}));var r,i=n(100),a=n(464),o=n(43),s=0,l=Object(a.b)({overflow:"hidden !important"}),c="data-is-scrollable",u=function(e,t){if(e){var n=0,r=null;t.on(e,"touchstart",(function(e){1===e.targetTouches.length&&(n=e.targetTouches[0].clientY)}),{passive:!1}),t.on(e,"touchmove",(function(e){if(1===e.targetTouches.length&&(e.stopPropagation(),r)){var t=e.targetTouches[0].clientY-n,i=v(e.target);i&&(r=i),0===r.scrollTop&&t>0&&e.preventDefault(),r.scrollHeight-Math.ceil(r.scrollTop)<=r.clientHeight&&t<0&&e.preventDefault()}}),{passive:!1}),r=e}},d=function(e,t){if(e){t.on(e,"touchmove",(function(e){e.stopPropagation()}),{passive:!1})}},f=function(e){e.preventDefault()};function h(){var e=Object(i.a)();e&&e.body&&!s&&(e.body.classList.add(l),e.body.addEventListener("touchmove",f,{passive:!1,capture:!1})),s++}function p(){if(s>0){var e=Object(i.a)();e&&e.body&&1===s&&(e.body.classList.remove(l),e.body.removeEventListener("touchmove",f)),s--}}function g(){if(void 0===r){var e=document.createElement("div");e.style.setProperty("width","100px"),e.style.setProperty("height","100px"),e.style.setProperty("overflow","scroll"),e.style.setProperty("position","absolute"),e.style.setProperty("top","-9999px"),document.body.appendChild(e),r=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return r}function v(e){for(var t=e,n=Object(i.a)(e);t&&t!==n.body;){if("true"===t.getAttribute(c))return t;t=t.parentElement}for(t=e;t&&t!==n.body;){if("false"!==t.getAttribute(c)){var r=getComputedStyle(t),a=r?r.getPropertyValue("overflow-y"):"";if(a&&("scroll"===a||"auto"===a))return t}t=t.parentElement}return t&&t!==n.body||(t=Object(o.a)(e)),t}},645:function(e,t,n){"use strict";var r=n(293),i=n(184),a=Object(r.a)(i.a,"Set");t.a=a},705:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(420);function i(e,t){var n=Object(r.a)(e,(function(e){return e.hasAttribute(t)}));return n&&n.getAttribute(t)}},735:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Parent=0]="Parent",e[e.Self=1]="Self"}(r||(r={}))},7531:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(31),i=new r.c((function(){return Promise.all([n.e(66),n.e(990)]).then(n.bind(null,10206))})),a=new r.a(i,(function(e){return e.findReadWriteRecipient})),o=new r.b(i,(function(e){return e.getGroupInfo}))},799:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(420),i=n(483);function a(e,t){var n=Object(r.a)(e,(function(e){return t===e||e.hasAttribute(i.a)}));return null!==n&&n.hasAttribute(i.a)}},814:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19),i=n(197);function a(e){if(Object(i.a)()&&e){var t,n,a=Object(r.a)();if(a&&a.SessionSettings)return t=e,n=a.SessionSettings.UserEmailAddress,t&&n&&t.toLowerCase()==n.toLowerCase()?a.HexCID:void 0}}},8294:function(e,t,n){"use strict";function r(e){return e.EmailAddress.Name||e.DisplayName}n.d(t,"a",(function(){return r}))},8491:function(e,t,n){"use strict";n.r(t);var r=n(1),i="@",a="AtMention",o="OWAAM",s="suggestedRecipients",l="suggestedRecipient-",c=n(4786);var u=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Object(c.a)(e,void 0,t):[]},d=n(3568),f=n(183),h=Object(f.action)("insertRecipientsShownAtFront")((function(e,t,n){var i=t.map((function(e){return e.persona})).concat(e.slice()),a=u(i,d.a);e.splice.apply(e,Object(r.j)([0,0],Object(r.g)(a))),e.length=Math.min(e.length,n)})),p=n(9818),g=Object(f.action)("setIsSearching")((function(e,t,n){e.isSearching=t,null!=n&&(e.queryString=n)})),v=Object(f.action)("setSuggestedContacts")((function(e,t){Object(p.a)(e.findResultSet),t&&h(e.findResultSet,t,5),g(e,!1)})),m=n(121),b=n(44),y=n(7531),S=Object(b.d)("findReadWriteRecipient",{name:"MentionsFindPeople"})((function(e,t,n,i){return Object(r.c)(this,void 0,void 0,(function(){var a,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return e.queryString=t,t?[3,1]:(v(e,i),(a=Object(m.u)())&&a.addCustomData({zeroState:(!0).toString()}),[3,3]);case 1:return[4,y.a.importAndExecute(e,t,n,!1,null,i,!0)];case 2:return r.sent(),(o=e.queryString.trim()==t)&&(e.selectedRecipientIndex=0),(a=Object(m.u)())&&a.addCustomData({zeroState:(!1).toString(),sameQueryString:o.toString(),searchDirectory:n.toString()}),[2,Promise.resolve()];case 3:return[2,Promise.resolve()]}}))}))})),k=Object(f.action)("addMentionAddedRecipient")((function(e,t){e.mentionsAddedRecipients.push(t.EmailAddress.EmailAddress)})),w=Object(f.action)("removeMentionTuple")((function(e,t,n){e.atMentionTuples[t]=n})),E=Object(f.action)("removeMentionAddedRecipient")((function(e,t){e.mentionsAddedRecipients.splice(t,1)})),T=Object(f.action)("removeMentionTuple")((function(e,t){delete e.atMentionTuples[t]})),A=n(2007),O=Object(f.action)("setIsSuggesting")((function(e,t,n){void 0===n&&(n=""),e.isSuggesting=t,t||(e.queryString="",e.isSearching=!1,e.directorySearchType=A.a.None)})),x=Object(f.action)("shiftAtMentionsHighlight")((function(e,t){var n=e.findResultSet.length;t?e.selectedRecipientIndex++:e.selectedRecipientIndex--;var r=n+(e.queryString&&e.directorySearchType==A.a.None?1:0);e.selectedRecipientIndex=(e.selectedRecipientIndex+r)%r})),C=n(8294),I=n(6240),R=300,_=n(11742),P=function(){function e(e,t,n,r,i,a){var o=this;this.adapter=e,this.addSelectedPersonaToWell=t,this.removePersonaFromWell=n,this.onRecipientAdded=r,this.canModifyRecipients=i,this.getAllRecipients=a,this.onIsSuggestingChanged=function(e){var t=o.adapter();O(t,e),e?t.queryString||v(t,o.getAllRecipients()):Object(I.a)(o.adapter(),null,0)},this.queryStringUpdated=function(e){var t=o.adapter();o.timer&&(clearTimeout(o.timer),o.timer=null),e?(g(t,!0,e),o.timer=setTimeout((function(){S(t,e,!1,o.getAllRecipients()),o.timer=null}),R)):v(t,o.getAllRecipients())},this.selectOption=function(){var e=o.adapter();e.isSearching||0!=e.findResultSet.length?e.selectedRecipientIndex==e.findResultSet.length?S(e,e.queryString,!0,o.getAllRecipients()):o.addRecipient():o.setIsSuggestingCallback(!1)},this.shiftHighlight=function(e){x(o.adapter(),e)},this.onRemove=function(e,t){return t&&e.textContent.split(" ").length>1?o.deleteLastSegment(e):(o.deleteAtMention(e),null)},this.setCursorPoint=function(e,t){Object(I.a)(o.adapter(),e,t)},this.getSelectedIndex=function(){return o.adapter().selectedRecipientIndex},this.onScroll=function(){o.adapter().isSuggesting&&o.setIsSuggestingCallback(!1)},this.addRecipient=function(e){void 0===e&&(e=null);var t=o.adapter();e||(e=t.findResultSet[t.selectedRecipientIndex]),o.commitMention(o.createInlineFromPersona(e)),!o.doesWellContainRecipient(e)&&o.canModifyRecipients&&(e=null!=e?e:t.findResultSet[t.selectedRecipientIndex],o.addSelectedPersonaToWell(e),e.EmailAddress&&k(t,e)),O(t,!1),o.onRecipientAdded&&o.onRecipientAdded(),Object(m.s)("MentionsAdded")}}return e.prototype.onInitalize=function(e,t){window.addEventListener("resize",this.onScroll),this.commitMention=e,this.setIsSuggestingCallback=t},e.prototype.onDispose=function(){window.removeEventListener("resize",this.onScroll),clearTimeout(this.timer),this.timer=null},e.prototype.doesWellContainRecipient=function(e){var t=this.adapter();e||(e=t.findResultSet[t.selectedRecipientIndex]);return this.getAllRecipients().some((function(t){return Object(d.a)(t.persona,e)}))},e.prototype.createInlineFromPersona=function(e){var t=document.createElement("a"),n=this.generateAtMentionId(),r=Object(C.a)(e);t.id=n,t.innerText="@"+r,t.className=_.mentionsCompose+" mention ms-bgc-nlr ms-fcl-b";var i=e.EmailAddress.EmailAddress;return t.href="mailto:"+i,w(this.adapter(),n,e),t},e.prototype.generateAtMentionId=function(){return o+Math.round(1e6*Math.random()).toString()},e.prototype.deleteLastSegment=function(e){var t=e.textContent.split(" ");return t.pop(),e.textContent=t.join(" ").trim(),e},e.prototype.getIdValue=function(e){var t=e;return t.attributes&&t.attributes.getNamedItem("id")?t.attributes.getNamedItem("id").value:null},e.prototype.deleteAtMention=function(e){var t=this.getIdValue(e),n=this.adapter(),r=n.atMentionTuples,i=n.mentionsAddedRecipients;if(r[t]){if(r[t].EmailAddress){var a=i.indexOf(r[t].EmailAddress.EmailAddress);if(a>-1)!Object.keys(r).some((function(e){return!(e==t||!r[e])&&(r[e].EmailAddress&&r[e].EmailAddress.EmailAddress==r[t].EmailAddress.EmailAddress)}))&&this.canModifyRecipients&&(this.removePersonaFromWell(r[t]),E(n,a))}T(n,t)}},e}(),j=n(5227),D=n(20),B=n(1115),N=n(60),L=n(441),F=n(10493),M=n(0),z=n(2692),H=n(15551),U=n(378).bind(H),W=Object(D.a)((function(e){var t=function(t){e.plugin.dataProvider.addRecipient(t)},n=e.viewState,r=n.targetPoint,i=n.bufferZone;return r?M.createElement(B.a,{className:H.callout,gapSpace:i,target:r,isBeakVisible:!1,setInitialFocus:!1,directionalHint:Object(L.a)()?N.a.bottomRightEdge:N.a.bottomLeftEdge},0!=n.findResultSet.length&&M.createElement("div",{className:U(H.scrollContainer,"customScrollBar")},M.createElement("div",{id:s,className:H.recipientCollection,role:"list"},n.findResultSet.map((function(e,r){return M.createElement("div",{key:e.EmailAddress.EmailAddress,id:l+r.toString(),role:"listitem"},M.createElement(F.a,{findRecipient:e,isHighlighted:n.selectedRecipientIndex==r,addRecipientAction:t,maskRecipientAction:null}))})))),M.createElement(z.b,{infoType:function(e){var t=!!e.queryString;return e.isSearching?z.a.Searching:t||0!=e.findResultSet.length?t?e.directorySearchType==A.a.None?z.a.SearchDirectory:z.a.TopNResults:z.a.Default:z.a.TypeToSearch}(n),queryString:n.queryString,highlighted:n.findResultSet.length==n.selectedRecipientIndex,numberOfResults:n.findResultSet.length,searchDirectoryAction:function(){S(e.viewState,e.viewState.queryString,!0)}})):null})),V=n(11742);var K=function(e){function t(t,n,r,c,u,d,f){var h=this,p=new P(t,r,c,u,d,f),g={elementIdPrefix:o,changeSource:a,triggerCharacter:i,suggestionsLabel:s,suggestionLabelPrefix:l};return(h=e.call(this,p,g)||this).adapter=t,h.editorAdapter=n,h}return Object(r.e)(t,e),t.prototype.getUIComponentClass=function(){return W},t.prototype.getName=function(){return"AtMentionsPicker"},t.prototype.onPluginEvent=function(t){var n;10==t.eventType&&t.sanitizingOption.additionalAllowedCssClasses.push(V.mentions),null===(n=e.prototype.onPluginEvent)||void 0===n||n.call(this,t)},t}(j.PickerPlugin),q=n(19),X=23;function J(e,t,n){if(t){var r=Object(q.a)().SessionSettings,i=function(e,t){var n=e.atMentionTuples,r=[];if(Object.keys(n).forEach((function(e){var i=n[e];r.push({Mentioned:i.EmailAddress,CreatedBy:t})})),r.length>0){var i=r.length;Object(m.s)("MentionsTotalSend",{totalMentions:(i>=X?X:i).toString()})}return r}(e,{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:r.UserEmailAddress,Name:r.UserDisplayName});i&&i.length>0&&(n.MentionsEx=i)}else{var a=function(e){var t=[],n=e.atMentionTuples,r=e.mentionsAddedRecipients;Object.keys(n).forEach((function(e){var r=n[e];t.push(JSON.stringify({b:e,a:JSON.stringify({_type:"MentionActionWrapper:#Exchange",Mentioned:r.EmailAddress})}))})),r.length>0&&t.push(JSON.stringify({b:"MentionAddedRecipients",a:JSON.stringify(r)}));if(t.length>0){var i=Object.keys(n).length,a=r.length;Object(m.s)("MentionsTotalSave",{totalMentions:(i>=X?X:i).toString(),numberAddedViaMentions:(a>=X?X:a).toString()})}return t}(e);a.length>0&&(n.PendingSocialActivityTagIds=a)}}n.d(t,"AtMentionPickerPlugin",(function(){return K})),n.d(t,"loadAtMentionsData",(function(){return J}))},883:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(56);function i(e,t){for(var n=Object(r.a)({},t),i=0,a=Object.keys(e);i<a.length;i++){var o=a[i];void 0===n[o]&&(n[o]=e[o])}return n}},9818:function(e,t,n){"use strict";var r=n(1),i=n(2215),a=n(183);t.a=Object(a.action)("getAndPopulateSuggestedContacts")((function(e,t){var n=Object(i.a)("",5,t).map((function(e){return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId}}));e.splice.apply(e,Object(r.j)([0,e.length],Object(r.g)(n)))}))}}]);
//# sourceMappingURL=owa.MailBoot~HtmlEditorMentionsPlugin.js.map
self.scriptsLoaded['owa.MailBoot~HtmlEditorMentionsPlugin.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~HtmlEditorMentionsPlugin.js'] = (new Date()).getTime();