self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~InlineImageLoader.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[685],{1087:function(t,e,n){"use strict";n.d(e,"e",(function(){return"{id}"})),n.d(e,"f",(function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"})),n.d(e,"a",(function(){return"data-custom"})),n.d(e,"c",(function(){return"originalsrc"})),n.d(e,"b",(function(){return"data-loadstatus"})),n.d(e,"d",(function(){return"pending"}))},131:function(t,e,n){"use strict";var r=n(294),o=n(24);function i(){return Object(o.i)("fwk-suiteThemes")}var c=n(213);function u(){var t,e;return i()?null!==(e=null===(t=Object(c.d)())||void 0===t?void 0:t.Id)&&void 0!==e?e:"base":Object(r.a)()}function a(t,e){var n,o;if(i())return null!==(o=e?null===(n=Object(c.d)())||void 0===n?void 0:n.DarkTheme:Object(c.d)())&&void 0!==o?o:{};var u=Object(r.e)(t,e);return{BackgroundImageUrl:u.primary,BackgroundImageRepeat:u.repeat}}var s=n(47);function d(){if(i()){var t=Object(c.c)();if(Object(s.e)()){var e={};return Object.keys(t).forEach((function(t){e[t]="var(--"+t+")"})),e}return t}return Object(r.f)()}function f(t,e){return i()?Object(c.c)():Object(r.g)(t,e)}var l=n(132),b=n(45);function v(){var t=u(),e=Object(l.e)();return!e&&(t===b.a.BASE_OFFICE_THEME_ID||t==b.a.BASE_THEME_ID&&!Object(s.i)(t,e))}function m(){var t=u(),e=Object(l.e)();return e&&(t===b.a.BASE_OFFICE_THEME_ID||t==b.a.BASE_THEME_ID&&!Object(s.i)(t,e))}n.d(e,"d",(function(){return u})),n.d(e,"a",(function(){return"#0078D4"})),n.d(e,"e",(function(){return a})),n.d(e,"h",(function(){return d})),n.d(e,"i",(function(){return f})),n.d(e,"g",(function(){return v})),n.d(e,"f",(function(){return m})),n.d(e,"b",(function(){return s.c})),n.d(e,"j",(function(){return s.e})),n.d(e,"l",(function(){return s.g})),n.d(e,"k",(function(){return s.f})),n.d(e,"c",(function(){return s.d}))},159:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(41);function o(){var t=Object(r.a)(),e=t.origin;return e||(e=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")),e}},18216:function(t,e,n){"use strict";n.r(e);var r=n(2390),o=n(183),i=Object(o.action)("clearInlineImageStore")((function(){r.a.inlineImages={}})),c=n(2649),u=n(2911),a=n(4644),s=Object(o.action)("addInlineImageToStore")((function(t,e){r.a.inlineImages[t]=e})),d=n(1087);function f(t){var e=Object(u.a)(t,c.f),n=Object(u.a)(t,d.c);if(e.length>0&&n.length>0){var r=Object(a.a)(t);r&&s(n,r)}}function l(t,e,n,r,o,i,c){void 0===r&&(r=""),void 0===o&&(o=""),void 0===i&&(i=""),void 0===c&&(c=""),t.addCustomData([e,n,r,o,i,c]),r&&r.length>0?t.endWithError("ClientError"):t.end()}var b="RequestError",v="RequestTimeout",m="RequestAbort",h="ImageZeroBytes",p="ImageInvalidLength",O=[{format:"JPEG",signature:new Uint8Array([255,216,255,224]),mime:/^image\/p?jpe?g$/i,expectedMime:"image/jpeg"},{format:"EXIF",signature:new Uint8Array([255,216,255,225]),mime:/^image\/p?jpe?g$/i},{format:"SPIFF",signature:new Uint8Array([255,216,255,232]),mime:/^image\/p?jpe?g$/i},{format:"CannonEOS",signature:new Uint8Array([255,216,255,226]),mime:/^image\/p?jpe?g$/i},{format:"SamsungD500",signature:new Uint8Array([255,216,255,227]),mime:/^image\/p?jpe?g$/i},{format:"PNG",signature:new Uint8Array([137,80,78,71,13,10,26,10]),mime:/^image\/png$/i,expectedMime:"image/png"},{format:"GIF",signature:new Uint8Array([71,73,70,56]),mime:/^image\/gif$/i,expectedMime:"image/gif"},{format:"TIFF1",signature:new Uint8Array([73,32,73]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF2",signature:new Uint8Array([73,73,42,0]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF3",signature:new Uint8Array([77,77,0,42]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF4",signature:new Uint8Array([77,77,0,43]),mime:/^image\/(x-)?tiff$/i},{format:"BMP",signature:new Uint8Array([66,77]),mime:/^image\/bmp$/i}];function g(t,e){return void 0===e&&(e=!1),new Promise((function(n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){var t=r.status,e=r.getResponseHeader("Content-Type")||"";if(e.length>0){var o=e.indexOf(";");o>0&&(e=e.substr(0,o))}var i="",u=null,a="",s=!1,d="";if(200==t){var f=r.response;if(f&&0!=f.byteLength)if(f.byteLength<10)i=p;else{var l=function(t){for(var e=0;e<O.length;e++)for(var n=O[e],r=0;r<n.signature.length&&n.signature[r]==t[r];r++)if(r==n.signature.length-1)return n;return null}(u=new Uint8Array(r.response,0,10));l&&(a=l.format,(s=e&&l.mime.test(e))||(i=c.l,d=l.expectedMime))}else i=h}n({status:i,responseCode:t,contentType:e,detectedFormat:a,first10BytesBase64:u?j(u):"",mimeMatched:s,expectedMime:d})}},r.ontimeout=function(){n({status:v})},r.onerror=function(){n({status:b})},r.onabort=function(){n({status:m})},e&&(r.withCredentials=!0),r.open("GET",t,!0),r.responseType="arraybuffer",r.send()}))}function j(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}var y=new RegExp("^https?://([^/]*)/.*","i"),w=window.location.hostname.toLowerCase();function A(t){if(t){var e=t.ownerDocument||document;return e&&e.documentElement.contains(t)}return!1}var S="onload";function C(t,e,n,r){t.onload=function(t){var e=t.target;k(e),n&&n(e)},t.onerror=function(t){var e=t.target;k(e),r&&r(e)},t.setAttribute(d.b,d.d),t.src=e}function k(t){t.removeAttribute(S),t.removeAttribute(d.b),t.onload=null,t.onerror=null}var I=n(514),x=n(23),T="deeplink/read/",E="/owa/?debugJS=true&viewmodel=ReadMessageItem&InternetMessageID=";function D(t,e,n,r){var o="Please engage nickhu@microsoft.com with below data:\n",i=Object(u.a)(t,c.e);i&&(o+="Deeplink (React): "+M(i,!0)+"\n");var a=Object(u.a)(t,c.d);a&&(o+="Deeplink (MVVM): "+M(a,!1)+"\n");var s=t.src;s&&(o+="Src: "+s+"\n");var f=Object(u.a)(t,d.c);if(f&&(o+="OriginalSrc: "+f+"\n"),n){var l=n.status,b=n.contentType,v=n.detectedFormat,m=n.first10BytesBase64;l&&(o+="Status: "+l+"\n"),b&&(o+="ContentType: "+b+"\n"),v&&(o+="DetectedFormat: "+v+"\n"),m&&(o+="First10Bytes: "+m+"\n"),o+="MimeMatch: "+n.mimeMatched}r&&r>0&&(o+="Retried: "+r),x.d("Error loading inline image: "+e+".\n"+o)}function M(t,e){void 0===e&&(e=!0);var n=Object(I.m)();return e?n+Object(I.k)()+T+t:n+E+t}var R=n(121),U=new RegExp("[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}","i");function P(t,e,n,r,o,i,c,u,a,s,d,f,l,b){void 0===r&&(r=""),void 0===o&&(o=""),void 0===i&&(i=""),void 0===c&&(c=""),void 0===u&&(u=""),void 0===a&&(a=""),void 0===s&&(s=""),void 0===d&&(d=""),void 0===f&&(f=""),void 0===l&&(l=""),void 0===b&&(b="");var v=[t,e,n,r,o,i,c=function(t){if(!t)return"";var e="",n=t,r=t.indexOf(":");return r>=0&&(e=t.slice(0,r+1),n=t.slice(r+1)),e+(n=n.match(U)?"<GUID>":"<PII>")}(c),u,a,s,d,f,l,b];Object(R.s)("InlineImageLoadError",v),x.g.info("InlineImageLoadError: "+v)}var B,_=n(24),L="DataUri_Success",N="DataUri_RequestFailed",F="DataUri_OnError",G=new RegExp("^data:[a-z]+\\/[a-z-]+;","i");function H(t,e,n,r,o,i){n?r&&r(t):o&&o(t);var c=e.imageType,u=e.perfDataPoint,a=e.howLoad,s=e.context,d=e.loaderCode,f=e.originalSrc,b=e.owaDomain,v=e.downloadDomain,m=e.responseData,h=m.responseCode,p=m.status,O=m.contentType,g=m.detectedFormat,j=m.first10BytesBase64,y=m.mimeMatched,w=n?"":i||p||h.toString();u&&l(u,c,a,w,s,d,n?L:""),n||(P(c,a,w,h.toString(),s,d,f,O,b,v,g,j,y.toString()),Object(_.i)("mc-imageDiagnostics")&&D(t,w,m))}!function(t){t[t.NotStarted=0]="NotStarted",t[t.Pending=1]="Pending",t[t.Completed=2]="Completed"}(B||(B={}));var W=4,z=3,q=1e3,V=2e4,X="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7",$="RetryTimedOut",J=[],Y=null;function Q(t,e,n,r,o){var i={image:t,url:e,retryContext:n,currentRetry:0,status:B.NotStarted,whenQueued:Date.now(),onSuccessCallback:r,onErrorCallback:o};Z(i),J.push(i),Y||(Y=setTimeout((function(){return function t(){if(J.length>0){var e=Date.now(),n=[],r=[],o=[];J.forEach((function(t){t.status!=B.Completed&&(e-t.whenQueued>V?K(t,!1,$):t.status==B.Pending?(o.push(t),n.push(t)):t.status==B.NotStarted&&(r.push(t),n.push(t)))}));var i=W-o.length;i>0&&r.length>0&&(u=r.slice(0,Math.min(i,r.length)))&&u.length>0&&u.forEach((function(t){t.currentRetry++,t.status=B.Pending,A(t.image)?C(t.image,t.url,(function(e){K(t,!0)}),(function(e){t.currentRetry>=z?K(t,!1):Z(t)})):K(t,!1,c.k+"_R"+t.currentRetry)})),J=n}var u;Y=J.length>0?setTimeout((function(){return t()}),q):null}()}),q))}function Z(t){t.status=B.NotStarted,t.image.src=X}function K(t,e,n){if(void 0===n&&(n=""),t.status!=B.Completed){var r=t.image,o=t.onSuccessCallback,i=t.onErrorCallback,c=t.currentRetry;e?o&&o(r):i&&i(r);var u=t.retryContext,a=u.imageType,s=u.perfDataPoint,d=u.howLoad,f=u.context,b=u.loaderCode,v=u.originalSrc,m=u.owaDomain,h=u.downloadDomain,p=u.responseData,O=p.responseCode,g=p.status,j=p.contentType,y=p.detectedFormat,w=p.first10BytesBase64,A=p.mimeMatched,S=e?"":n||g||O.toString();s&&l(s,a,d,S,f,b,c.toString()),e||(P(a,d,S,O.toString(),f,b,v,j,m,h,y,w,A.toString(),c.toString()),Object(_.i)("mc-imageDiagnostics")&&200==O&&D(r,S,p)),t.status=B.Completed}}var tt="InlineImageLoad";function et(){return new R.b(tt,{logEvery:Object(_.i)("ring-dogfood")?1:100})}var nt="ZeroNaturalWidth";function rt(t,e,n,r,o,i){void 0===i&&(i=!1);var a,s=et(),f=null!=(a=e.match(y))&&a.length>1&&a[1].toLowerCase()!=w,b=f?c.o:c.q,v=Object(u.a)(t,d.c),m=Object(u.a)(t,c.c);0==m.length&&(m=c.r);var h="";f&&(t.setAttribute(c.a,c.g),h=c.g),x.g.info("InlineImage: Load attachment, Url: "+e+", crossDomain: "+f+", crossOrigin: "+h);var p=f?w:"",O=f?function(t){var e=t.match(y);return null!=e&&e.length>1?e[1].toLowerCase():w}(e):"";C(t,e,(function(t){r&&r(t);var e=t.naturalWidth>0;l(s,m,b,e?"":nt,n,h),e||P(m,b,nt,"",n,h,v,"",p,O)}),(function(u){var a=c.n;n!=c.h||A(u)?g(e,f).then((function(d){if(i&&200==d.responseCode&&d.mimeMatched)Q(u,e,{imageType:m,howLoad:b,context:n,loaderCode:h,originalSrc:v,owaDomain:p,downloadDomain:O,responseData:d,perfDataPoint:s},r,o);else if(d.status==c.l&&d.expectedMime)!function(t,e,n,r,o){var i=new XMLHttpRequest;i.onload=function(){var e=new FileReader;e.onloadend=function(){if(e.result){var i=e.result.replace(G,"data:"+n.responseData.expectedMime+";");C(t,i,(function(){return H(t,n,!0,r,o)}),(function(){return H(t,n,!1,r,o,F)}))}},e.readAsDataURL(i.response)},i.ontimeout=i.onerror=function(){H(t,n,!1,r,o,N)},t.crossOrigin==c.g&&(i.withCredentials=!0),i.open("GET",e,!0),i.responseType="blob",i.send()}(u,e,{imageType:m,howLoad:b,context:n,loaderCode:h,originalSrc:v,owaDomain:p,downloadDomain:O,responseData:d,perfDataPoint:s},r,o);else{o&&o(u);var f=d.status,g=d.responseCode,j=d.contentType,y=d.detectedFormat,w=d.first10BytesBase64,A=d.mimeMatched;a=f||g.toString(),l(s,m,b,a,n,h),P(m,b,a,g.toString(),n,h,v,j,p,O,y,w,A.toString()),Object(_.i)("mc-imageDiagnostics")&&(404!=g&&0!=g&&200!=g||D(t,a,200==g?d:null))}})):(o&&o(u),a=c.k,l(s,m,b,a,n,h),P(m,b,a,"",n,h,v,"",p,O))}))}var ot=n(1),it=n(131),ct=n(9458),ut=n(2508),at=n(4699),st=n(210),dt="naturalwidth",ft="naturalheight",lt="width",bt="height",vt="px";function mt(t,e,n,o){return void 0===n&&(n=!0),Object(ot.c)(this,void 0,void 0,(function(){var i,a,s,f,b,v,m,h,p,O,g;return Object(ot.f)(this,(function(j){switch(j.label){case 0:return i=Object(u.a)(t,d.a),a=Object(u.a)(t,c.c),s=Object(u.a)(t,d.c),f=s.length>0?r.a.inlineImages[s]:null,0!=i.length||f?f?(b=et(),C(t,f,(function(t){pt(t),l(b,a,c.p,"",e)}),(function(t){l(b,a,c.p,c.n,e),P(a,c.p,c.n,"",e,"",s,"")})),[3,8]):[3,1]:[2,!1];case 1:return v={Id:decodeURIComponent(i),mailboxInfo:Object(ct.a)(t,o)},(p=Object(st.a)("nativeHostAttachmentHijack")&&Object(_.i)("mon-rp-inlineImagesOverHx"))?[4,at.c.import()]:[3,3];case 2:p=j.sent()(v),j.label=3;case 3:return p?[4,at.b.import()]:[3,6];case 4:return[4,j.sent()(v.Id)];case 5:return h=j.sent(),[3,7];case 6:h=Object(ut.a)(v,1),j.label=7;case 7:null!=(m=h)&&m.length>0?(O=t.style.display,g=n?function(t){var e="50px",n="50px";t.style.width&&t.style.height?(e=t.style.width,n=t.style.height):t.getAttribute(lt)&&t.getAttribute(bt)?(e=t.getAttribute(lt)+vt,n=t.getAttribute(bt)+vt):t.getAttribute(dt)&&t.getAttribute(ft)&&(e=t.getAttribute(dt)+vt,n=t.getAttribute(ft)+vt);var r=Object(it.h)(),o=document.createElement("div");o.style.display="inline-block",o.style.width=e,o.style.height=n,o.style.maxWidth="100%",o.style.maxHeight=t.style.maxHeight,o.style.borderWidth="1px",o.style.borderStyle="dashed",o.style.borderColor=r.themePrimary,o.style.boxSizing="border-box",t.style.display="none",t.parentNode&&t.parentNode.insertBefore(o,t);if(t.getAttribute(dt)&&t.getAttribute(ft)){var i=parseInt(o.style.width);o.style.height=Math.ceil(i/parseInt(t.getAttribute(dt))*parseInt(t.getAttribute(ft))).toString()}return o}(t):null,rt(t,m,e,(function(t){ht(g),pt(t),t.style.display=O}),(function(t){ht(g),t.style.display="inline"}),!0)):(P(a,"",c.m,"",e,"",s,""),t.removeAttribute("src")),j.label=8;case 8:return[2,!0]}}))}))}function ht(t){(null==t?void 0:t.parentNode)&&t.parentNode.removeChild(t)}function pt(t){var e=t.style;t.hasAttribute("width")||e.width||t.hasAttribute("height")||e.height||(e.maxWidth="100%",e.height="auto")}var Ot=n(1262);var gt=n(440),jt=n(53),yt=n(217);function wt(t,e,n){return Object(_.i)("rp-imageProxy-loadViaFetch")?function(t,e,n){return Object(ot.c)(this,void 0,void 0,(function(){var r,o=this;return Object(ot.f)(this,(function(i){switch(i.label){case 0:return[4,fetch(e)];case 1:return r=i.sent(),[2,new Promise((function(e){return Object(ot.c)(o,void 0,void 0,(function(){var o,i;return Object(ot.f)(this,(function(c){switch(c.label){case 0:return Object(yt.a)(r.status)?[4,r.blob()]:[3,2];case 1:return o=c.sent(),i=URL.createObjectURL(o),t.src=i,t.onload=function(t){n||URL.revokeObjectURL(i),e({status:r.status,renderSuccess:!0,statusText:r.statusText,headers:r.headers})},t.onerror=function(t){e({status:r.status,renderSuccess:!1,statusText:r.statusText,headers:r.headers})},[3,3];case 2:e({status:r.status,renderSuccess:!1,statusText:r.statusText,headers:r.headers}),c.label=3;case 3:return[2]}}))}))}))]}}))}))}(t,e,n):function(t,e){return new Promise((function(n){t.onload=function(e){At(t),n({status:200,renderSuccess:!0})},t.onerror=function(e){At(t),n({status:500,renderSuccess:!1})},t.src=e}))}(t,e)}function At(t){t.onload=null,t.onerror=null}var St,Ct,kt=n(57),It=n(4),xt=n(899),Tt="loadFromImageProxy";function Et(t,e){if(e.proxyCount%e.logEvery!=0){var n=function(){return Promise.resolve()};return{endWithSuccess:n,endWithError:n,addCustomProperty:n,addCheckmark:n}}var r=(new Date).getTime(),o=new R.b(Tt,{sessionSampleRate:10,logVerbose:!0});return o.addCustomData(Object.values(t)),o.endWithSuccess=function(){o.end(void 0,Object(xt.a)(r)?"BackgroundSuccess":"Success")},o}!function(t){t.ModelD="ModelD",t.ModelB="ModelB",t.Cosmic="Cosmic"}(St||(St={}));var Dt="p",Mt="s",Rt="c",Ut="b",Pt="statusCode",Bt="https://imgproxy-{0}.services.web.outlook.com/proxy/?u={1}&t={2}&r={3}&s={4}",_t="https://cosmic-{0}.office.net/imageproxy/proxy?u={1}&t={2}&r={3}&s={4}",Lt="https://outlookimageproxy.azurewebsites.net",Nt="clientErrorReason",Ft="serverErrorProxyCode",Gt="isShadowTraffic",Ht="isHttps",Wt=((Ct={})[St.Cosmic]={sdf:"sdf",prod:"msit"},Ct[St.ModelD]={sdf:"sdf",prod:"prod"},Ct);function zt(t,e,n,r,o){var i,c;return Object(ot.c)(this,void 0,void 0,(function(){var a,s,f,l,b,v,m,h,p,O,g,j;return Object(ot.f)(this,(function(y){switch(y.label){case 0:if(a=n?document.createElement("img"):e,!(s=Object(u.a)(e,d.c)))return[2,!1];if((f=Et({endpoint:t},r)).addCustomProperty(Gt,n),f.addCustomProperty(Ht,"https:"==s.substring(0,6).toLowerCase()),l=Object(ot.g)(Object(gt.getAccessTokenforResourceAsLazy)(Lt),2),b=l[0],v=l[1],f.addCustomProperty("tokenCache",b?"warm":"cold"),b)return[3,4];y.label=1;case 1:return y.trys.push([1,3,,4]),[4,v];case 2:return b=y.sent(),[3,4];case 3:return y.sent(),f.addCustomProperty(Nt,1),f.endWithError("ClientError"),[2,!1];case 4:if(f.addCheckmark("token_loaded"),!((b?b.length:0)>0))return[3,9];m=Date.now(),h=function(t,e,n,r){var o="Dogfood"==Object(It.y)()?"sdf":"prod";return Object(jt.a)(t==St.Cosmic?_t:Bt,Wt[t][o],encodeURIComponent(e),encodeURIComponent(n),r?Mt:Dt,Object(kt.s)()?Rt:Ut)}(t,s,b,n),y.label=5;case 5:return y.trys.push([5,7,,8]),[4,wt(a,h,o)];case 6:return p=y.sent(),f.addCustomProperty(Pt,p.status),p.renderSuccess?(O="unknown",(g=null===(i=null==p?void 0:p.headers)||void 0===i?void 0:i.get("date"))&&(j=Date.parse(g),isNaN(j)||(O=j-m>-1e3?"NoCache":"BrowserCache")),f.addCustomProperty("loadImgFrom",O),f.endWithSuccess(),[2,!0]):(200===p.status?(f.addCustomProperty(Nt,3),f.endWithError("ClientError")):(f.addCustomProperty(Ft,Object(_.i)("rp-imageProxy-loadViaFetch")?(null===(c=null==p?void 0:p.headers)||void 0===c?void 0:c.get("x-proxy-errorcode"))||"EmptyXProxyErrorCode":"NoXProxyCodeAsViaTag"),f.endWithError("ServerError")),[3,8]);case 7:return y.sent(),f.addCustomProperty(Nt,4),f.endWithError("ClientError"),[3,8];case 8:return[3,10];case 9:f.addCustomProperty(Nt,2),f.endWithError("ClientError"),y.label=10;case 10:return[2,!1]}}))}))}var qt=n(3933),Vt="statusCode";function Xt(t,e,n,r){return Object(ot.c)(this,void 0,void 0,(function(){var o,i,c,u;return Object(ot.f)(this,(function(a){switch(a.label){case 0:(o=Et({endpoint:St.ModelB},n)).addCustomProperty("isShadowTraffic",e),a.label=1;case 1:return a.trys.push([1,6,,7]),[4,Object(qt.a)(t)];case 2:return(i=a.sent())?[4,wt(e?document.createElement("img"):t,i,r)]:[3,4];case 3:return c=a.sent(),o.addCustomProperty(Vt,c.status),200===c.status?(o.endWithSuccess(),[2,!0]):(c.status>=400&&c.status<500?o.endWithError("ClientError"):o.endWithError("ServerError"),[3,5]);case 4:o.endWithError("ClientError"),a.label=5;case 5:return[3,7];case 6:return u=a.sent(),x.d(u),o.endWithError("ClientError"),[3,7];case 7:return[2,!1]}}))}))}var $t=0,Jt=10;function Yt(){var t={proxyCount:$t,logEvery:Jt};return $t++,t}function Qt(t,e,n,r,o){return void 0===n&&(n=!1),void 0===r&&(r=Yt),Object(ot.c)(this,void 0,void 0,(function(){return Object(ot.f)(this,(function(i){return e==St.ModelD||e==St.Cosmic?[2,zt(e,t,n,r(),o)]:[2,Xt(t,n,r(),o)]}))}))}function Zt(t,e,n){return void 0===e&&(e=Qt),Object(ot.c)(this,void 0,void 0,(function(){var r,o,i,a,s,f,l;return Object(ot.f)(this,(function(b){switch(b.label){case 0:return v=t,m=Object(u.a)(v,d.c),h=Object(u.a)(v,c.b),m&&h?Object(Ot.a)()?(r=Object(_.i)("rp-imageProxyOnCosmic")||Object(_.i)("rp-imageProxyOnCosmic-test")?St.Cosmic:Object(_.i)("rp-imageProxyOnModelD")?St.ModelD:St.ModelB,o=Object(ot.j)(Object(ot.j)(Object(ot.j)([],Object(ot.g)(Object(_.i)("rp-imageProxyOnModelBShadowing")?[St.ModelB]:[])),Object(ot.g)(Object(_.i)("rp-imageProxyOnModelDShadowing")?[St.ModelD]:[])),Object(ot.g)(Object(_.i)("rp-imageProxyOnCosmicShadowing")?[St.Cosmic]:[])).filter((function(t){return t!==r})),[4,e(t,r,void 0,void 0,n)]):[3,2]:[2,!1];case 1:b.sent();try{for(i=Object(ot.k)(o),a=i.next();!a.done;a=i.next())s=a.value,e(t,s,!0,void 0,n)}catch(t){f={error:t}}finally{try{a&&!a.done&&(l=i.return)&&l.call(i)}finally{if(f)throw f.error}}return[3,3];case 2:t.src="",b.label=3;case 3:return[2,!0]}var v,m,h}))}))}var Kt="data-imageerror",te="data-outlook-trace",ee="CidTildeWrd",ne="AttNotFound",re=new RegExp("^cid:\\s?~WRD","i"),oe=new RegExp("^cid:","i"),ie=new RegExp("f:([0-9]+)","i"),ce=new RegExp("t:([0-9]+)","i");function ue(t,e){var n=Object(u.a)(t,Kt),r=Object(u.a)(t,c.c),o=Object(u.a)(t,d.c);if(n&&n.length>0){var i=n;if(o&&re.test(o))i=ee;else if(n==ne){var a=function(t){var e="";if(t){var n=ie.exec(t),r=ce.exec(t);if(n&&2==n.length&&r&&2==r.length){var o=parseInt(n[1]),i=parseInt(r[1]);isNaN(o)||isNaN(i)||(0==o?e="PreEWS":o>0&&(o<i?e="MidEWS":o==i&&(e="PostEWS")))}}else e="NoTrace";return e}(Object(u.a)(t,te));a&&(i=ne+"_"+a)}!function(t,e,n,r,o,i){void 0===n&&(n=""),void 0===r&&(r=""),void 0===o&&(o=""),void 0===i&&(i="");var c=et(),u=[t,e,n,r,o,i];c.addCustomData(u),n&&n.length>0?c.endWithError("ClientError"):c.end()}(r,"",i,e),P(r,"",i,"",e,"",o,""),t.onload=null,t.removeAttribute("src"),Object(_.i)("mc-imageDiagnostics")&&(n!=ne&&0!=n.indexOf("NotImage")||D(t,n))}else if(o&&!oe.test(o)){var s=et();C(t,o,(function(t){l(s,r,"","",e)}),(function(t){l(s,r,"",c.n,e),g(o).then((function(t){var n=t.status,i=t.responseCode,c=t.contentType,u=n||i.toString();P(r,"",u,i.toString(),e,"",o,c)}))}))}}function ae(t,e,n,r,o){return Object(ot.c)(this,void 0,void 0,(function(){var i;return Object(ot.f)(this,(function(c){switch(c.label){case 0:return[4,mt(t,i=e||"",!!n,r)];case 1:return c.sent()?[3,3]:[4,Zt(t,Qt,o)];case 2:c.sent()||ue(t,i),c.label=3;case 3:return[2]}}))}))}function se(t){var e=[t];Object(R.s)("InlineImageAttachmentUpload",e),x.g.info("InlineImageAttachmentUpload: "+e)}n.d(e,"clearInlineImageStore",(function(){return i})),n.d(e,"cacheInlineImage",(function(){return f})),n.d(e,"loadFromAttachmentServiceUrl",(function(){return rt})),n.d(e,"loadFromAttachment",(function(){return mt})),n.d(e,"loadFromProxy",(function(){return Zt})),n.d(e,"loadFromImageTag",(function(){return ae})),n.d(e,"logImageLoadError",(function(){return P})),n.d(e,"logImageUpload",(function(){return se})),n.d(e,"tryCreateDataURIFromImage",(function(){return a.a}))},186:function(t,e,n){"use strict";function r(){var t=Object.create(null),e=0,n=0,r=0,o=!1;function i(e){r--,delete t[e]}this.put=function(e,n,o,c){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==c&&"function"!=typeof c)throw new Error("Cache timeout callback must be a function");var u=t[e];u?clearTimeout(u.timeout):r++;var a={value:n,expire:o+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){i(e),c&&c(e,n)}.bind(this),o)),t[e]=a,n},this.del=function(e){var n=!0,r=t[e];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(e),n},this.clear=function(){for(var i in t)clearTimeout(t[i].timeout);r=0,t=Object.create(null),o&&(e=0,n=0)},this.get=function(i){var c=t[i];if(void 0!==c){if(isNaN(c.expire)||c.expire>=Date.now())return o&&e++,c.value;o&&n++,r--,delete t[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){o=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var r=t[n];e[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var r=JSON.parse(e),o=Date.now(),i=n&&n.skipDuplicates;for(var c in r)if(r.hasOwnProperty(c)){if(i)if(t[c])continue;var u=r[c],a=u.expire-o;if(a<=0){this.del(c);continue}a=a>0?a:void 0,this.put(c,u.value,a)}return this.size()}}t.exports=new r,t.exports.Cache=r},1986:function(t,e,n){"use strict";var r=n(1),o=n(2051),i=n(374),c=n(730),u=n(121),a=n(5),s="X-AnchorMailbox",d="Authorization",f="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";function b(t,e){return Object(r.c)(this,void 0,void 0,(function(){var n,b,v,m,h;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(i.k)(t)){if(b.accountState==i.b.AccessRevoked)return[2,null];if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.c)(b.accountState,b.accountProviderType),[2,null]}return e?(n[s]=e,n[l]=e):b&&(n[s]=b.anchorMailbox),b?(v=b.token,!(m=Object(c.g)(b.tokenExpiry))&&v?[3,2]:(Object(u.s)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(b.tokenExpiry,Object(a.Rb)()),isTokenExpired_1:m,isTokenInvalid_2:!v},{isCore:!0}),[4,o.a.importAndExecute(b.accountId,t,v)])):[3,3];case 1:(v=r.sent())||(v=""),r.label=2;case 2:h=void 0,"Outlook"==b.accountProviderType?(h='MSAuth1.0 usertoken="'+v+'", type="MSACT"',n[f]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(h="Bearer "+v,n[f]=2..toString()),n[d]=h,r.label=3;case 3:return[2,n]}}))}))}var v=n(1989),m=n(23);function h(t,e){return Object(r.c)(this,void 0,void 0,(function(){var n,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=Object(v.a)(),o=n,[4,p(t,e)];case 1:return o.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function p(t,e){var n;return Object(r.c)(this,void 0,void 0,(function(){var o,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return o=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,[4,b(t.mailboxInfo.userIdentity,O(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(v.b)(o,i),[2,o]}}))}))}function O(t,e){var n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&m.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return O}))},1989:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach((function(n){return t.set(n,e[n])}))}function o(t){var e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},1991:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2),o=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},203:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c}));var r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function i(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function c(t){return r.test(t)}},2030:function(t,e,n){"use strict";var r=n(1),o=n(1989);function i(t,e){return{"X-OWA-ExplicitLogonUser":t,"X-AnchorMailbox":e||t}}function c(t,e,n){e&&(t||n)&&Object(o.b)(e,i(t,n))}function u(t,e){var n,o=null!=e?e:{},i=(null===(n=o.headers)||void 0===n?void 0:n.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",c(t,i),Object(r.a)(Object(r.a)({},o),{headers:i})}var a=n(374),s=n(1986),d=n(87),f=n(319);function l(t){return Object(r.c)(this,void 0,void 0,(function(){var e=this;return Object(r.f)(this,(function(n){return[2,Object(d.b)().then((function(n){return Object(r.c)(e,void 0,void 0,(function(){var e,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return t?Object(a.r)(t.userIdentity)?[4,Object(s.a)(t.userIdentity,"GroupMailbox"==t.type||"TeamsMailbox"==t.type?t.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return e=r.sent(),f(n,e),[3,3];case 2:"GroupMailbox"!=t.type&&"TeamsMailbox"!=t.type||(o=i(t.mailboxSmtpAddress),f(n,o)),r.label=3;case 3:return[2,n]}}))}))}))]}))}))}function b(){return Object(d.b)().then((function(t){return t.prefer='exchange.Behavior="CalendarInternal"',t}))}function v(t){return void 0===t&&(t=null),Object(a.r)(t)?b().then((function(e){return Object(s.a)(t).then((function(t){return Object.keys(t).forEach((function(n){return e[n]=t[n]})),e}))})):Promise.resolve({})}var m=n(65);function h(t,e,n,r){var o=new Headers;return n&&o.set("X-OWA-CANARY",Object(m.a)()),e&&o.set("X-OWA-ActionName",e),(t||r)&&(r?c(t,o,r):c(t,o)),o}n.d(e,"a",(function(){return u})),n.d(e,"d",(function(){return l})),n.d(e,"b",(function(){return v})),n.d(e,"c",(function(){return b})),n.d(e,"f",(function(){return c})),n.d(e,"e",(function(){return h}))},2051:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(31),o=n(1991);n.d(e,"b",(function(){return o.a}));var i=new r.c((function(){return n.e(1286).then(n.bind(null,2298))})),c=new r.a(i,(function(t){return t.getAndUpdateAccessToken}))},209:function(t,e,n){"use strict";var r=n(19),o=n(575),i=n(24),c=n(23);function u(){var t=Object(r.a)();if(!t||!t.SessionSettings)return c.d("SessionSettings not available"),"no-mailbox-id";var e=t.SessionSettings.UserEmailAddress;return Object(i.i)("doc-attachment-usePrimarySmtpAddressForMailboxId")?e:(t.SessionSettings.IsShadowMailbox?e=t.SessionSettings.LogonEmailAddress:Object(o.c)(t.HexCID,t.SessionSettings.UserEmailAddress)&&(e=Object(o.b)(t.HexCID,t.SessionSettings.NotManagedEmailAddresses,t.SessionSettings.UserProxyAddresses)),e)}var a=n(868),s=n(638);function d(t){var e=Object(s.a)().userMailboxInfoMap;e&&e.delete(t)}function f(t,e){return t===e||null!=t&&null!=e&&t.Id===e.Id}var l=n(476);n.d(e,"c",(function(){return u})),n.d(e,"d",(function(){return a.a})),n.d(e,"f",(function(){return d})),n.d(e,"e",(function(){return f})),n.d(e,"a",(function(){return o.a})),n.d(e,"b",(function(){return l.a}))},2160:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(209),o={};function i(t){var e=t.toLocaleLowerCase();if(!o[e]){var n={type:"GroupMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:t};o[e]=n}return o[e]}},217:function(t,e,n){"use strict";var r=n(859);n.d(e,"a",(function(){return r.a}))},2203:function(t,e,n){"use strict";n.d(e,"k",(function(){return r})),n.d(e,"j",(function(){return o})),n.d(e,"g",(function(){return i})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"a",(function(){return a})),n.d(e,"e",(function(){return s})),n.d(e,"f",(function(){return d})),n.d(e,"i",(function(){return f})),n.d(e,"b",(function(){return l})),n.d(e,"h",(function(){return b}));var r="SwitchGroup",o="NavigateFromMeToWe",i="GroupHeader_SendEmail_Button_Clicked",c="GroupHeader_Email_Button_Clicked",u="GroupHeader_Files_Button_Clicked",a="GroupHeader_Calendar_Button_Clicked",s="GroupHeader_Notebook_Button_Clicked",d="GroupHeader_Planner_Button_Clicked",f="GroupHeader_Site_Button_Clicked",l="GroupHeader_CustomLeaveGroup_Button_Clicked",b="GroupHeader_Settings_Button_Clicked"},2224:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2030);function o(t,e){return{headers:Object(r.e)(t,"GroupMailbox",!1,e)}}},227:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return c}));var r=n(8),o=n(42);function i(){var t,e=Object(o.a)("DefaultAnchorMailbox");return null==e||0==e.trim().length||(t=Object(r.b)(window.location),Object.keys(t).indexOf("anonRetry")>=0)}function c(){var t=Object(r.b)(window.location);return Object.keys(t).indexOf("anonymous")>=0}},2273:function(t,e,n){"use strict";n(2224);var r=n(2160),o=n(2),i=Object(o.action)("EDIT_GROUP_SUCCESS",(function(t,e){return{groupSmtp:t,photoUrl:e}})),c=Object(o.action)("ADD_GROUP_MEMBER_SUCCESS",(function(t){return{groupSmtp:t}})),u=Object(o.action)("MEMBER_MANAGEMENT_SUCCESS",(function(t){return{groupSmtp:t}})),a=Object(o.action)("POPUP_OPENED",(function(){return{isOpen:!0}})),s=Object(o.action)("POPUP_CLOSED",(function(){return{isOpen:!1}})),d=Object(o.action)("DELETE_GROUP_SUCCESS",(function(t){return{groupSmtp:t}})),f=Object(o.action)("EDIT_GROUP_SMTP_SUCCESS",(function(t,e,n,r){return{aadObjectId:t,groupSmtp:e,photoUrl:n,oldGroupSmtp:r}})),l=n(2203);n.d(e,"n",(function(){return r.a})),n.d(e,"m",(function(){return i})),n.d(e,"j",(function(){return c})),n.d(e,"o",(function(){return u})),n.d(e,"q",(function(){return a})),n.d(e,"p",(function(){return s})),n.d(e,"k",(function(){return d})),n.d(e,"l",(function(){return f})),n.d(e,"g",(function(){return l.g})),n.d(e,"c",(function(){return l.c})),n.d(e,"d",(function(){return l.d})),n.d(e,"a",(function(){return l.a})),n.d(e,"e",(function(){return l.e})),n.d(e,"f",(function(){return l.f})),n.d(e,"i",(function(){return l.i})),n.d(e,"b",(function(){return l.b})),n.d(e,"h",(function(){return l.h}))},2360:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(209),o=n(374);function i(t){if("ArchiveMailbox"==t.type)return Object(r.a)();var e=t.userIdentity&&Object(o.r)(t.userIdentity),n="GroupMailbox"===t.type;return e&&!n?Object(r.b)(t.mailboxSmtpAddress)+t.userIdentity:"UserMailbox"===t.type?Object(r.a)():t.mailboxSmtpAddress}},2361:function(t,e,n){"use strict";var r=n(374),o=n(1),i={};function c(t){return i[t]}function u(t,e){var n=i[t];i[t]=Object(o.a)(Object(o.a)({},n),e)}var a=n(57),s=n(33);var d=n(121),f=n(23),l=n(742),b=n(1986),v=n(1989);function m(t){return Object(o.c)(this,void 0,void 0,(function(){var e,n;return Object(o.f)(this,(function(r){switch(r.label){case 0:return(e={}).headers=new Headers,[4,Object(b.a)(t)];case 1:return n=r.sent(),Object(v.b)(e.headers,n),[2,e]}}))}))}var h=Object(l.b)({timeBetweenRetryInMS:function(){return 3e4}});function p(t,e){e=e<1?1:e,setInterval((function(){!function(t){Object(o.c)(this,void 0,void 0,(function(){var e,n,i,a,l,b,v=this;return Object(o.f)(this,(function(p){switch(p.label){case 0:if(e=function(){return Object(o.c)(v,void 0,void 0,(function(){var e,n;return Object(o.f)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),e={},Object(r.r)(t.userIdentity)?[4,m(t.userIdentity)]:[3,2];case 1:e=o.sent(),o.label=2;case 2:return[2,(i=e,Object(s.a)("GetAttachmentDownloadToken",{},i))];case 3:throw n=o.sent(),f.g.warn("Unable to get the download token "+n),n.networkError=!0,n;case 4:return[2]}var i}))}))},null==(n=c(t.userIdentity))?void 0:n.isRefreshingDownloadToken)return[3,4];u(t.userIdentity,{isRefreshingDownloadToken:!0}),i=0,a=h((function(){return Object(o.c)(v,void 0,void 0,(function(){var n;return Object(o.f)(this,(function(r){switch(r.label){case 0:return i++,[4,e()];case 1:return n=r.sent(),f.g.info("update new token"),u(t.userIdentity,{downloadToken:n,isRefreshingDownloadToken:!1}),[2]}}))}))})).retriableFunc,l=new d.c("AttachmentRefreshDownloadToken"),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,a()];case 2:return p.sent(),l.addCustomData([i]),l.end(),[3,4];case 3:return b=p.sent(),f.g.warn("Retry to refresh token failed: "+b),l.addCustomData([i]),l.endWithError("ServerError",b),u(t.userIdentity,{isRefreshingDownloadToken:!1}),[3,4];case 4:return[2]}}))}))}(t)}),6e4*e)}var O=n(94);function g(t){var e=Object(r.j)(null==t?void 0:t.userIdentity),n=c(null==t?void 0:t.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(e){case null:case"Outlook":!function(t){var e=Object(r.r)(t.userIdentity)?Object(a.i)(t.userIdentity):Object(a.h)(),n=null==e?void 0:e.ApplicationSettings;if(n){var o=n.DownloadUrlBase;u(t.userIdentity,{downloadUrlBase:o,downloadToken:n.FirstDownloadToken}),o&&p(t,n.DownloadTokenRefreshMinutes)}}(t);break;case"Google":case"ICloud":break;default:Object(O.a)(e)}var o=c(t.userIdentity);return o||(Object(d.s)("FilesUrlDataNotFound",{accountProviderType:e}),f.g.warn("Unable to get the url data")),o}function j(t){if(!t)return null;var e=g(t);return null==e?void 0:e.downloadToken}n.d(e,"b",(function(){return g})),n.d(e,"a",(function(){return j}))},2508:function(t,e,n){"use strict";var r=n(2551);n.d(e,"a",(function(){return r.a})),n.d(e,"b",(function(){return r.b}));var o=n(2361);n.d(e,"c",(function(){return o.a}));var i=n(2360);n.d(e,"d",(function(){return i.a}))},2551:function(t,e,n){"use strict";var r=n(94),o=n(6),i=n(65),c="/owa/",u="service.svc/s/GetFileAttachment?id={0}",a="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",f="service.svc/s/GetAttachmentThumbnail?id={0}",l="pdfprint.aspx?id={0}",b="pdfprint.aspx?id={0}&location={1}",v=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var m=n(197),h=n(67),p=n(4),O=n(34),g=n(2361),j=n(2360);function y(t,e,n,r,u){if(void 0===r&&(r=!1),void 0===u&&(u=null),!t||!t.Id||!t.mailboxInfo)return null;var a=Object(g.b)(t.mailboxInfo),s=null==a?void 0:a.downloadUrlBase,d=Object(j.a)(t.mailboxInfo);if(u=u||Object(o.c)(e,encodeURIComponent(t.Id)),!s||r&&"Firefox"===Object(h.a)().browser){var f=c+u+"&X-OWA-CANARY="+Object(i.a)();return Object(O.a)(f)}var l="{0}{1}/{2}";Object(m.a)()&&(l+="&isc=1");var b=Object(o.c)(l,s,d,u);return n&&(b+="&token="+(null==a?void 0:a.downloadToken),b+="&X-OWA-CANARY="+Object(i.a)()),Object(h.i)()||(b+="&owa="+window.location.hostname,b+="&scriptVer="+Object(p.r)()||!1),b}function w(t,e,n,u,s,f,l,m,h){var p;switch(void 0===s&&(s=0),void 0===f&&(f=0),void 0===l&&(l=!0),void 0===m&&(m=null),void 0===h&&(h=null),n){case 0:p=a;break;case 3:p=b;break;case 1:if(!function(t){if(!t)return!1;var e=null,n=t.lastIndexOf(".");return n>0&&(e=t.substr(n).toLowerCase()),!!e&&v.indexOf(e.toLowerCase())>=0}(m))return null;p=d;break;default:Object(r.a)(n)}var g=u?f:s;!g&&s&&(g=s);var j=Object(o.c)("{0}&permissionLevel={1}",Object(o.c)(p,encodeURIComponent(t.Id),encodeURIComponent(e)),g),w=y(t,p,!0,3===n,j);if(w)return w;var A=Object(o.c)("{0}{1}{2}",c,h,j);l&&(A=A+"&X-OWA-CANARY="+Object(i.a)());return Object(O.a)(A)}function A(t,e,n,i){var c;switch(void 0===n&&(n=!1),void 0===i&&(i=!0),e){case 0:c=u;break;case 1:c=s;break;case 2:c=f;break;case 3:c=l;break;default:return Object(r.a)(e)}if(!Object(o.f)(c)){var a=y(t,c,i,3===e);return Object(o.c)("{0}{1}{2}",a,n?"&isDownload=true":"","&animation=true")}return null}n.d(e,"b",(function(){return w})),n.d(e,"a",(function(){return A}))},2649:function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i})),n.d(e,"e",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"b",(function(){return a})),n.d(e,"g",(function(){return s})),n.d(e,"r",(function(){return d})),n.d(e,"n",(function(){return f})),n.d(e,"m",(function(){return l})),n.d(e,"k",(function(){return b})),n.d(e,"l",(function(){return v})),n.d(e,"h",(function(){return m})),n.d(e,"p",(function(){return h})),n.d(e,"o",(function(){return p})),n.d(e,"q",(function(){return O})),n.d(e,"j",(function(){return g})),n.d(e,"i",(function(){return j}));var r="src",o="data-imagetype",i="crossorigin",c="data-itemid",u="data-inetid",a="data-imageproxyendpoint",s="use-credentials",d="AttachmentByCid",f="OnError",l="NullAttachmentUrl",b="DOMDetached",v="ImageMismatch",m="RP",h="DataUri",p="CrossDomain",O="SameDomain",g="ImageProxySkipForConsumerChild",j="ImageProxyConnectorsAuthTokenFalse"},287:function(t,e,n){"use strict";var r=n(295),o=n(18);function i(t){return Object(r.resolve)(Object(o.g)(),t)}function c(t){return i("resources/images/"+t)}n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return c}))},2911:function(t,e,n){"use strict";function r(t,e){return t.hasAttribute(e)?t.getAttribute(e):""}n.d(e,"a",(function(){return r}))},2954:function(t,e,n){var r,o;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(i){if(void 0===(o="function"==typeof(r=i)?r.call(e,n,e,t):r)||(t.exports=o),!0,t.exports=i(),!!0){var c=window.Cookies,u=window.Cookies=i();u.noConflict=function(){return window.Cookies=c,u}}}((function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function o(){}function i(e,n,i){if("undefined"!=typeof document){"number"==typeof(i=t({path:"/"},o.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var c=JSON.stringify(n);/^[\{\[]/.test(c)&&(n=c)}catch(t){}n=r.write?r.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var u="";for(var a in i)i[a]&&(u+="; "+a,!0!==i[a]&&(u+="="+i[a].split(";")[0]));return document.cookie=e+"="+n+u}}function c(t,n){if("undefined"!=typeof document){for(var o={},i=document.cookie?document.cookie.split("; "):[],c=0;c<i.length;c++){var u=i[c].split("="),a=u.slice(1).join("=");n||'"'!==a.charAt(0)||(a=a.slice(1,-1));try{var s=e(u[0]);if(a=(r.read||r)(a,s)||e(a),n)try{a=JSON.parse(a)}catch(t){}if(o[s]=a,t===s)break}catch(t){}}return t?o[t]:o}}return o.set=i,o.get=function(t){return c(t,!1)},o.getJSON=function(t){return c(t,!0)},o.remove=function(e,n){i(e,"",t(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}((function(){}))}))},326:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return c}));var r,o=n(1);function i(t){r=t}function c(){var t,e;return Object(o.c)(this,void 0,void 0,(function(){var n,i;return Object(o.f)(this,(function(o){switch(o.label){case 0:return(i=r)?[4,r()]:[3,2];case 1:i=o.sent(),o.label=2;case 2:if((n=i)&&n.length>0){if("bearer"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},3292:function(t,e,n){"use strict";var r,o,i,c=n(1),u=n(121),a=n(3668),s=n(3785),d=n(180),f=n(2954),l="GetConnectorsLTITokenFailure",b="GetConnectorsLTITokenException",v="GetConnectorsLTITokenNull",m="ConnectorsLtiToken",h="40B852DF-9693-420D-AA7D-10072C9CE077",p=5;function O(){return Object(c.c)(this,void 0,void 0,(function(){var t;return Object(c.f)(this,(function(e){switch(e.label){case 0:return(t=function(){if(r){if(Date.now()-o<1e3*(r.TTL-p)*60)return r.TokenValue}return null}())?[3,2]:[4,g()];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))}function g(){return i||(i=new Promise((function(t,e){var n={Header:Object(d.b)(),Body:Object(a.a)({TokenRequests:[{__type:"TokenRequest:#Exchange",Id:h,TokenType:"Connectors"}]})};Object(s.a)(n).then((function(n){i=null,n&&"Success"===n.Body.ResponseMessages.Items[0].ResponseClass?(r=n.Body.ResponseMessages.Items[0].Token,o=Date.now(),function(t){if(!t)throw j(v),new Error("getClientAuthToken null");f.set(m,t,{path:"/actions/"})}(r.TokenValue),t(r.TokenValue)):(j(l),e(new Error("getClientAuthToken failed")))})).catch((function(t){i=null,j(b),e(new Error("getClientAuthToken exception: "+t))}))}))),i}function j(t){Object(u.s)(t),r=void 0}var y=n(24),w=n(197),A=n(440),S="https://outlook.office365.com/connectors",C="User.Read";function k(){return Object(y.i)("rp-actionableMessages-aad-token")&&!Object(w.a)()?function(){return Object(c.c)(this,void 0,void 0,(function(){var t,e,n;return Object(c.f)(this,(function(r){switch(r.label){case 0:return t=Object(c.g)(Object(A.getAccessTokenforResourceAsLazy)(S),2),e=t[0],n=t[1],e?[3,2]:[4,n];case 1:e=r.sent(),r.label=2;case 2:return[2,e]}}))}))}():Object(y.i)("rp-actionableMessages-msa-token")&&Object(w.a)()?function(){return Object(c.c)(this,void 0,void 0,(function(){return Object(c.f)(this,(function(t){switch(t.label){case 0:return[4,Object(A.getDelegationTokenForOwa)(C)];case 1:return[2,t.sent()]}}))}))}():O()}n.d(e,"b",(function(){return O})),n.d(e,"a",(function(){return k}))},3668:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1);function o(t){return Object(r.a)({__type:"GetClientAccessTokenRequest:#Exchange"},t)}},374:function(t,e,n){"use strict";var r,o=n(2);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var i,c=n(44),u=Object(o.action)("addAccount",(function(t){return{userIdentity:t.userIdentity,account:t}})),a=Object(o.action)("removeAccount",(function(t){return{userIdentity:t}})),s=Object(o.action)("updateAccount",(function(t,e,n){return{userIdentity:t,accountToken:e,accountTokenExpiresIn:n}})),d=Object(o.action)("updateOWAConnectedAccountStatus",(function(t,e){return{userIdentity:t,accountState:e}})),f=Object(o.action)("accountIsInErrorState",(function(t,e){return Object(c.c)({name:"accountIsInErrorState",customData:{accountState_1:r[t],accountProvider_2:e}},{accountState:t})})),l=Object(o.action)("retryAccountUpdateToken",(function(t,e,n){return{accountId:t,userIdentity:e,currentToken:n}})),b=Object(o.action)("connectedAccountsListRequested",(function(t){return{isSuccess:t}})),v=Object(o.action)("setAccountsStoreState",(function(t){return{state:t}})),m=n(1),h=n(14);!function(t){t[t.None=0]="None",t[t.Loading=1]="Loading",t[t.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",t[t.AccountsLoadError=3]="AccountsLoadError"}(i||(i={}));var p=Object(o.createStore)("OWAAccountsStore",{accountsMap:new h.ObservableMap({}),accountsLoadedState:i.None}),O=n(94),g=n(57);function j(t){return t!=Object(g.b)()&&void 0!==w(t)}function y(){return Object(m.j)([],Object(m.g)(p().accountsMap.values()))}function w(t){return p().accountsMap.get(t)}function A(){var t;return(null===(t=y())||void 0===t?void 0:t.length)>0?y()[0]:null}function S(){return y().filter((function(t){return t.accountState!=r.Valid}))}function C(t){return y().filter((function(e){return t.includes(e.accountState)}))}function k(t){return y().filter((function(e){return e.accountProviderType==t}))}function I(t){return j(t)?w(t).accountProviderType:null}function x(t){return"Outlook"==t.accountProviderType?'MSAuth1.0 usertoken="'+t.token+'", type="MSACT"':"Google"==t.accountProviderType||"ICloud"==t.accountProviderType?"Bearer "+t.token:Object(O.a)(t.accountProviderType)}function T(t,e){return function(n){var r=w(n);return r?r[t]:e}}T("accountUniqueId","0");var E=T("accountState",r.Valid),D=function(){return y().some((function(t){return!U(t.userIdentity)}))},M=T("accountProviderType",null),R=function(t){return"Outlook"==M(t)},U=function(t){return E(t)==r.Valid},P=function(){return y().length>0};function B(){return p().accountsLoadedState}var _=n(5),L=n(121);Object(o.mutator)(u,(function(t){var e=t.account;Object(L.s)("owaAccountAdded",{accountStatus_1:r[e.accountState]}),p().accountsMap.set(e.userIdentity,e)})),Object(o.mutator)(a,(function(t){var e=t.userIdentity;p().accountsMap.delete(e)})),Object(o.mutator)(s,(function(t){var e=t.userIdentity,n=t.accountToken,r=t.accountTokenExpiresIn,o=p().accountsMap.get(e);o.token=n,o.tokenExpiry=Object(_.j)(Object(_.Rb)(),parseInt(r))})),Object(o.mutator)(d,(function(t){var e=t.userIdentity,n=t.accountState,o=p().accountsMap.get(e);o.accountState==r.Valid&&n!=r.Valid&&Object(L.s)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[n]}),o.accountState=n})),Object(o.mutator)(b,(function(t){var e=t.isSuccess?i.AccountsLoadSuccessful:i.AccountsLoadError;p().accountsLoadedState=e})),Object(o.mutator)(v,(function(t){p().accountsLoadedState=t.state})),n.d(e,"d",(function(){return u})),n.d(e,"u",(function(){return a})),n.d(e,"y",(function(){return s})),n.d(e,"x",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"v",(function(){return l})),n.d(e,"e",(function(){return b})),n.d(e,"w",(function(){return v})),n.d(e,"n",(function(){return y})),n.d(e,"k",(function(){return w})),n.d(e,"i",(function(){return A})),n.d(e,"f",(function(){return S})),n.d(e,"g",(function(){return C})),n.d(e,"o",(function(){return k})),n.d(e,"j",(function(){return I})),n.d(e,"m",(function(){return x})),n.d(e,"l",(function(){return E})),n.d(e,"q",(function(){return D})),n.d(e,"t",(function(){return R})),n.d(e,"s",(function(){return U})),n.d(e,"p",(function(){return P})),n.d(e,"h",(function(){return B})),n.d(e,"r",(function(){return j})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}))},3785:function(t,e,n){"use strict";var r=n(33),o=n(1);function i(t,e){var n;return void 0===t||t.__type||(n=t,t=Object(o.a)({__type:"GetClientAccessTokenJsonRequest:#Exchange"},n)),Object(r.a)("GetClientAccessToken",t,e)}n.d(e,"a",(function(){return i}))},3933:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(1),o=n(2649),i=n(3292),c=n(42),u=n(19),a=n(121),s=n(2911),d=n(1087),f="data-connectorsauthtoken",l="u",b="i",v="d",m="ClientId";function h(t){return Object(r.c)(this,void 0,void 0,(function(){var e,n,i;return Object(r.f)(this,(function(r){return e=Object(s.a)(t,d.c),n=Object(s.a)(t,o.b),i=Object(s.a)(t,f),e&&n?Object(u.a)().IsConsumerChild?(Object(a.s)(o.j),[2,e]):[2,"1"==i?O(n,e):p(n,e)]:[2,""]}))}))}function p(t,e){var n=Object(c.a)(m);return n?"/actions/ei"==t.toLowerCase()?(Object(a.s)(o.i),null):t+"?"+l+"="+encodeURIComponent(e)+"&"+b+"="+encodeURIComponent(n):null}function O(t,e){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Object(i.b)()];case 1:return n.sent(),[3,3];case 2:return n.sent(),[2,null];case 3:return[2,t+"?"+l+"="+encodeURIComponent(e)+"&"+v+"="+encodeURIComponent((new Date).toISOString())]}}))}))}},4644:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(121),o="2d",i="canvas",c="image/png";function u(t){try{var e=document.createElement(i),n=t.naturalWidth,u=t.naturalHeight;if(n>0&&u>0||(Object(r.s)("CreateDataURIMissingNaturalDimensions"),n=t.width,u=t.height),n>0&&u>0)return e.width=n,e.height=u,e.getContext(o).drawImage(t,0,0),e.toDataURL(c)}catch(t){}return null}},4699:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u}));var r=n(9),o=new r.d((function(){return Promise.all([n.e(9),n.e(11),n.e(12),n.e(545)]).then(n.bind(null,6814))})),i=new r.a(o,(function(t){return t.isHxAttachment})),c=new r.a(o,(function(t){return t.downloadAttachmentFromHx})),u=new r.a(o,(function(t){return t.getHxAttachmentUri}))},476:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(57),o=n(24);function i(t){var e=Object(r.i)(t);return e&&e.SessionSettings?0===e.SessionSettings.WebSessionType?Object(o.i)("doc-attachment-routingKeyAadSmtp")?"SMTP:":"":"MSA:":"no-routing-key:"}},478:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(80);function o(t){return Object(r.a)(t,[r.c])}},514:function(t,e,n){"use strict";var r=n(478),o=n(34),i=n(80);function c(t){return Object(i.a)(t,[i.b])}var u=n(29),a=n(71);function s(t){return Object(u.b)(Object(u.c)(Object(u.a)(Object(a.a)()||"",t)))}var d,f,l,b=n(617),v=n(734),m=n(219);function h(){return d||(d=Object(o.a)("/calendar")+"/"),d}function p(){return f||(f=Object(o.a)("/mail")+"/"),f}function O(){return l||(l=Object(o.a)("/files")+"/"),l}var g,j,y,w=n(867);function A(t){return g&&j===t||(j=t,g=t?Object(o.a)("/people/group/owner")+"/":Object(o.a)("/people/group/member")+"/"),g}function S(){return y||(y=Object(o.a)("/people/group/deleted")+"/"),y}function C(t){return window.location.origin+h()+"showPeek/item/"+encodeURIComponent(t)}var k=n(295),I=n(706),x=n(8),T=n(637),E=Object(I.a)().split("/").slice(1).join("/")+"deeplink/";function D(t,e,n,r){n&&((r=r||{}).minus="");var o="";if(r){var i=Object(x.b)();Object(T.a)(i),Object.keys(r).filter((function(t){return t})).forEach((function(t){return i[t]=r[t]})),o="?"+Object(x.i)(i)}var c={pathname:"/"+t+"/"+E+e,search:o};return k.format(c)}var M,R,U=n(220),P=n(1),B=n(19),_="https://to-do.microsoft.com";function L(t,e){var n,r,o,i=Object(B.a)(),c=i.UserOptions,u=null===(r=i.SessionSettings)||void 0===r?void 0:r.UserPrincipalName,a=_,s={};if(null===(o=null==c?void 0:c.ReactOptinSettings)||void 0===o?void 0:o.TasksRedirectUrl){var d;a=(n=Object(P.g)(c.ReactOptinSettings.TasksRedirectUrl.split("?"),2))[0],d=n[1],s=Object(x.g)(d),u&&(s.auth_upn=u)}return t&&(s.utm_source=t),e&&delete s.fromOwa,Object.keys(s).length>0?Object(m.a)(a,s):a}function N(){return M||(M=Object(o.a)("/spaces")+"/"),M}function F(){return R||(R=Object(o.a)("/eventify")+"/"),R}var G=n(159);n.d(e,"j",(function(){return r.a})),n.d(e,"t",(function(){return o.a})),n.d(e,"f",(function(){return c})),n.d(e,"l",(function(){return s})),n.d(e,"s",(function(){return b.a})),n.d(e,"x",(function(){return u.a})),n.d(e,"a",(function(){return u.b})),n.d(e,"b",(function(){return u.c})),n.d(e,"o",(function(){return v.a})),n.d(e,"v",(function(){return m.a})),n.d(e,"d",(function(){return h})),n.d(e,"k",(function(){return p})),n.d(e,"g",(function(){return O})),n.d(e,"p",(function(){return w.a})),n.d(e,"i",(function(){return A})),n.d(e,"h",(function(){return S})),n.d(e,"c",(function(){return C})),n.d(e,"q",(function(){return D})),n.d(e,"w",(function(){return U.a})),n.d(e,"u",(function(){return L})),n.d(e,"n",(function(){return N})),n.d(e,"e",(function(){return F})),n.d(e,"m",(function(){return G.a})),n.d(e,"r",(function(){return a.a}))},518:function(t,e,n){"use strict";var r=function(){function t(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();n.d(e,"a",(function(){return r}))},575:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return d}));var r=n(1),o=n(19),i=n(476),c=n(24),u=n(23);function a(t,e,n){var o,i;if(n)try{for(var c=Object(r.k)(n),u=c.next();!u.done;u=c.next()){var a=u.value;if(!s(t,a))return a}}catch(t){o={error:t}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(o)throw o.error}}return e&&e.length>0?e[0]:"NoResolvableAddress@invalid.outlook.com"}function s(t,e){return("outlook_"+t+"@outlook.com").toLowerCase()===e.toLowerCase()}function d(){var t=function(){var t=Object(o.a)();if(!t||!t.SessionSettings)return u.d("SessionSettings not available"),"no-routing-key";var e=t.SessionSettings.UserEmailAddress;if(0===t.SessionSettings.WebSessionType)return Object(i.a)()+e;if(Object(c.i)("doc-attachment-routingKeyPuid"))return"PUID:"+t.SessionSettings.UserPuid+"@"+t.SessionSettings.TenantGuid;if(t.SessionSettings.IsShadowMailbox)return Object(i.a)()+t.SessionSettings.LogonEmailAddress;if(s(t.HexCID,t.SessionSettings.UserEmailAddress))return Object(i.a)()+a(t.HexCID,t.SessionSettings.NotManagedEmailAddresses,t.SessionSettings.UserProxyAddresses);return Object(i.a)()+e}();return t=encodeURIComponent(t)}},617:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(8),o=n(637);function i(){var t=Object(r.b)();Object(o.a)(t);var e=Object(r.i)(t);return e.length>0?"?"+e:""}},637:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=["hostApp","isanonymous","cspoff","frameName","opxInstanceId","hxVersion"];function o(t){t&&Object.keys(t).forEach((function(e){r.includes(e)&&delete t[e]}))}},638:function(t,e,n){"use strict";var r=n(2),o=n(14);e.a=Object(r.createStore)("OWAClientIdStore",{userMailboxInfoMap:new o.ObservableMap})},707:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(33);function o(t){return Object(r.a)("GetOwaNonBootUserConfiguration",{},t)}},711:function(t,e,n){"use strict";var r,o=n(707),i=n(2),c=Object(i.createStore)("nonBootUserConfiguration",{nonBootUserConfiguration:null})(),u=n(227),a=Object(i.mutatorAction)("setNonBootUserConfiguration",(function(t){c.nonBootUserConfiguration=t}));function s(){return Object(u.b)()?Promise.resolve({}):c.nonBootUserConfiguration?Promise.resolve(c.nonBootUserConfiguration):(r||(r=Object(o.a)().then((function(t){return a(t),t})).catch((function(t){throw r=void 0,t}))),r)}var d=s;function f(){return c.nonBootUserConfiguration||s(),c.nonBootUserConfiguration}function l(){var t=(f()||{}).IsEdu;return void 0!==t&&t}function b(){var t=(f()||{}).ExternalInOutlookEnabled;return void 0!==t&&t}n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return b}))},730:function(t,e,n){"use strict";var r=n(2),o=Object(r.action)("initializeOwaObservableDateTime"),i=Object(r.action)("observableNowChanged"),c=Object(r.action)("observableTodayChanged"),u=n(5),a=n(14),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),d=Object(a.computed)((function(){return Object(u.nc)(s().now)})),f=function(){return d.get()},l=Object(a.computed)((function(){return Object(u.nc)(s().today)})),b=function(){return l.get()},v=function(t){return Object(u.Hb)(t,f())},m=function(t){return Object(u.Fb)(t,f())},h=function(t){return O(t,u.Hb)},p=function(t){return O(t,u.Ib)},O=function(t,e){return e(Object(u.Yb)(Object(u.nc)(t)),b())};function g(t){if(!t)return"";var e=Object(u.nc)(t);return function(t,e){var n=Object(u.Yb)(t);if(Object(u.Jb)(n,e))return u.ab;var r=function(t){return Object(u.Ob)(n,Object(u.e)(e,-t),e)};if(r(3))return u.ib;if(r(30))return u.hb;return u.Y}(e,b())(e)}function j(t){if(!t)return"";var e=Object(u.nc)(t);return function(t,e){var n=Object(u.Yb)(t);if(Object(u.Jb)(n,e))return u.T;return u.U}(e,b())(e)}function y(t){return t?function(t,e){var n=Object(u.Yb)(t);return Object(u.Jb)(n,e)?Object(u.ab)(t):w(n,e,2)?Object(u.lb)(t):w(n,e,7)?Object(u.H)(Object(u.bb)(t),Object(u.ab)(t)):Object(u.H)(Object(u.J)(t),Object(u.ab)(t))}(Object(u.nc)(t),b()):""}function w(t,e,n){return Object(u.Ob)(t,Object(u.e)(e,-n),e)}var A=Object(r.action)("updateTimes"),S=Object(r.action)("setNow"),C=Object(r.action)("setToday",(function(t){return{today:t}}));Object(r.mutator)(S,(function(){s().now=Object(u.lc)()})),Object(r.mutator)(C,(function(t){var e=t.today;s().today=e}));var k=n(21),I=n(79),x=!1;Object(r.orchestrator)(o,(function(){if(A(),!x){var t=Object(u.Rb)(),e=Object(u.ac)(Object(u.h)(t,1)),n=Object(u.w)(e,t);setTimeout((function(){return setInterval(A,k.g)}),n),document&&document.addEventListener("visibilitychange",A),x=!0}})),Object(r.orchestrator)(I.l,(function(){A()})),Object(r.orchestrator)(A,(function(){S();var t=Object(u.Ab)(Object(u.mc)()),e=s().today!=t;e&&C(t),i(),e&&c()})),n.d(e,"d",(function(){return o})),n.d(e,"j",(function(){return i})),n.d(e,"l",(function(){return c})),n.d(e,"i",(function(){return f})),n.d(e,"k",(function(){return b})),n.d(e,"g",(function(){return v})),n.d(e,"e",(function(){return m})),n.d(e,"f",(function(){return h})),n.d(e,"h",(function(){return p})),n.d(e,"a",(function(){return g})),n.d(e,"b",(function(){return j})),n.d(e,"c",(function(){return y}))},734:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(41),o=n(34),i=n(159);function c(t){var e=Object(r.a)(),n=Object(i.a)()+Object(o.a)("/owa")+"/",c=e.search&&e.search.length>0;n+=c?e.search:"?";for(var u=Object.keys(t),a=c,s=0;s<u.length;s++)a?n+="&":a=!0,n+=u[s]+"="+t[u[s]];return n}},742:function(t,e,n){"use strict";function r(t){void 0===t&&(t={}),function(t){t.timeBetweenRetryInMS=t.timeBetweenRetryInMS||function(){return 6e4}}(t);var e=t.maximumAttempts,n=t.timeBetweenRetryInMS;return function(t){var r=0,o=!1,i=function(c,u){o?u(new Error("The function retry was cancelled")):(r++,t().then((function(t){return c(t)})).catch((function(t){e&&r>=e?u(t):setTimeout((function(){return i(c,u)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(t,e){return i(t,e)}))},cancel:function(){return o=!0}}}}function o(t){return function(e){return Math.pow(2,e)*t}}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},859:function(t,e,n){"use strict";function r(t){return t>=200&&t<300}n.d(e,"a",(function(){return r}))},867:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r,o=n(34);function i(){return r||(r=Object(o.a)("/people")+"/"),r}},868:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(57),o=n(638);function i(t){var e=Object(o.a)().userMailboxInfoMap;if(!e||!e.get(t)){var n=!1;t&&(n=t!=Object(r.b)());var i={type:"UserMailbox",userIdentity:n?t:Object(r.b)(),mailboxSmtpAddress:n?t:Object(r.c)()};return e.set(t,i),i}return e.get(t)}},9458:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(6),o=n(2273),i=n(209),c=n(2911),u="explicitlogon";function a(t,e){var n=Object(c.a)(t,u);return Object(r.f)(n)?Object(i.d)(e):Object(o.n)(n)}}}]);
//# sourceMappingURL=owa.MailBoot~InlineImageLoader.js.map
self.scriptsLoaded['owa.MailBoot~InlineImageLoader.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~InlineImageLoader.js'] = (new Date()).getTime();