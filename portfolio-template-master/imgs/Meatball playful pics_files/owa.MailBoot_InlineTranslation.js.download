self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~InlineTranslation.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[686],{10116:function(t,n,a){"use strict";a.d(n,"a",(function(){return o}));var e=a(2897),r=a(4734);function o(t){return!e.a.settings.initialized||e.a.settings.translationMode===r.a.Never||e.a.settings.excludedLanguages.includes(t)}},10117:function(t,n,a){"use strict";a.d(n,"a",(function(){return o}));var e=a(2897),r=a(4734);function o(t){return e.a.settings.translationMode===r.a.Automatic&&!e.a.settings.excludedLanguages.includes(t)}},10138:function(t,n,a){"use strict";a.d(n,"a",(function(){return i})),a.d(n,"b",(function(){return s})),a.d(n,"d",(function(){return l}));var e=a(24),r=a(1955),o=a(449),i="EntityExtraction/ExtractLanguage1.0",s="EntityExtraction/ExtractQuotedTextLanguages1.0",l="InlineTranslationLocale",u=[Object(o.a)({PropertyName:i,DistinguishedPropertySetId:"Common",PropertyType:"String"}),Object(o.a)({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"String"})],c={featureId:l,propertyPaths:u,isPropertyExistedOnItem:function(t){var n=r.a.items.get(t);return(null==n?void 0:n.TranslationData)&&null!=n.TranslationData.itemLocale},shouldGetItemPropertiesFromServer:function(t,n){if(!(Object(e.i)("rp-inlineTranslation")&&0==n||Object(e.i)("rp-inlineTranslation-conversationViewOff")))return!1;var a=r.a.items.get(t);return!!a&&!a.RightsManagementLicenseData}};n.c=c},10139:function(t,n,a){"use strict";a.d(n,"a",(function(){return i})),a.d(n,"b",(function(){return s})),a.d(n,"c",(function(){return l})),a.d(n,"e",(function(){return u}));var e=a(24),r=a(1955),o=a(449),i="TranslationData",s="TranslationStatus",l="DisplayTranslation",u="InlineTranslationDataAndStatus",c=[Object(o.a)({PropertyName:i,DistinguishedPropertySetId:"Common",PropertyType:"String"}),Object(o.a)({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"String"}),Object(o.a)({PropertyName:l,DistinguishedPropertySetId:"Common",PropertyType:"Boolean"})],d={featureId:u,propertyPaths:c,isPropertyExistedOnItem:function(t){var n=r.a.items.get(t);return(null==n?void 0:n.TranslationData)&&null!=n.TranslationData.translationText},shouldGetItemPropertiesFromServer:function(t,n){return!!(Object(e.i)("rp-inlineTranslation")&&Object(e.i)("tra-cacheTranslation")&&0==n||Object(e.i)("rp-inlineTranslation-conversationViewOff")&&Object(e.i)("tra-cacheTranslation"))}};n.d=d},10140:function(t,n,a){"use strict";var e;!function(t){t[t.Automatic=0]="Automatic",t[t.Suggestion=1]="Suggestion",t[t.Manual=2]="Manual",t[t.None=100]="None"}(e||(e={})),n.a=e},17011:function(t){t.exports=JSON.parse('{"l":"dBc","m":"eBc","k":"fBc","i":"gBc","h":"hBc","g":"iBc","f":"jBc","b":"kBc","c":"lBc","d":"mBc","a":"nBc","e":"oBc","j":"pBc"}')},17012:function(t,n,a){var e=a(17013),r=a(78);"string"==typeof e&&(e=[[t.i,e]]);for(var o=0;o<e.length;o++)r.loadStyles(e[o][1],!1);e.locals&&(t.exports=e.locals)},17013:function(t,n,a){(n=t.exports=a(77)(!1)).push([t.i,"html[dir] ._1eN94FfatbCko5uUefAU47{padding-top:10px}html[dir=ltr] ._1eN94FfatbCko5uUefAU47{margin-left:52px}html[dir=rtl] ._1eN94FfatbCko5uUefAU47{margin-right:52px}",""]),n.locals={translationFeedback:"_1eN94FfatbCko5uUefAU47"}},17840:function(t,n,a){"use strict";a.r(n);var e=a(1),r=a(10138),o=a(24),i=a(4309),s=a(3681),l=a(23),u=15,c=40,d="Language",T="Languages",g="Locale",b="BestGuessLanguage",f="fastTextLanguage",m="@EntityId",O=null;function D(t){return Object(e.c)(this,void 0,void 0,(function(){var n,a,D,p,h,j,v;return Object(e.f)(this,(function(e){switch(e.label){case 0:if(t.RightsManagementLicenseData)return[2,["",null]];n=null,e.label=1;case 1:return e.trys.push([1,4,,5]),[4,i.c.import()];case 2:return[4,e.sent()(t.ItemId.Id,r.d)];case 3:return n=e.sent(),[3,5];case 4:return e.sent(),l.g.info("getLocalePropertyForItem: Unable to get item property from GetItemManager."),[3,5];case 5:return a="",D=null,n&&(p=Object(s.b)(n,null,r.a),h=Object(s.b)(n,null,r.b),p?(v=JSON.parse(p.Value)[0],(j=v[d])&&(t.Preview.length<u||(t.Preview.length<c?Object(o.i)("tra-EnableShortMessage")&&(Object(o.i)("tra-useFastTextLanguage")&&j.hasOwnProperty(f)?(t.TranslationData.isFastTextLanguage=!0,a=j[f]):j.hasOwnProperty(b)&&(t.TranslationData.isFastTextLanguage=!1,a=j[b])):Object(o.i)("tra-useFastTextLanguage")&&j.hasOwnProperty(f)?(t.TranslationData.isFastTextLanguage=!0,a=j[f]):(t.TranslationData.isFastTextLanguage=!1,a=j.hasOwnProperty(b)?j[b]:j[g]))),Object(o.i)("tra-logEntityType")&&(O=v[m])):l.g.info("getLocalePropertyForItem: No language property found for first body of item."),h&&(v=JSON.parse(h.Value)[0],D=v[T])),[2,[a||"",D]]}}))}))}var p={name:"InlineTranslationMessageTranslated",cosmosOnlyData:function(t,n){return t}},h={name:"InlineTranslationMessageUntranslated",cosmosOnlyData:function(t){return t}},j={name:"InlineTranslationStoreData",cosmosOnlyData:function(t,n){return t}},v={name:"InlineTranslationStoreStatus",cosmosOnlyData:function(t,n){return t}},w={name:"InlineTranslationLoadDataAndStatus",cosmosOnlyData:function(t){return t.ItemId.Id}},y=a(121),S=a(44),x=a(10139),I=Object(S.d)("storeTranslationData",w)((function(t){return Object(e.c)(this,void 0,void 0,(function(){var n,a,r,l,u;return Object(e.f)(this,(function(e){switch(e.label){case 0:n=null,e.label=1;case 1:return e.trys.push([1,4,,5]),[4,i.c.import()];case 2:return[4,e.sent()(t.ItemId.Id,x.e)];case 3:return n=e.sent(),[3,5];case 4:return a=e.sent(),null==(r=Object(y.u)())||r.endWithError("ServerError",new Error(a.responseMessage)),[3,5];case 5:return n?(l=Object(s.b)(n,null,x.a),u=void 0,Object(o.i)("tra-useTranslationStatusV2")&&(u=Object(s.b)(n,null,x.c)),u||(u=Object(s.b)(n,null,x.b)),[2,[l?l.Value:null,u?u.Value:null]]):[2,[null,null]]}}))}))})),L=a(1956);function C(t,n){return n?t.UniqueBody.Value:t.NormalizedBody.Value}var F=a(7441);function E(t){if(Object(F.a)(t.ConversationId.Id)){var n=t,a=L.u.conversationNodes.get(n.InternetMessageId);if(null==a?void 0:a.quotedTextList)return a.quotedTextList}}var P=18e4;var N=a(10117),M=a(10116),U={Undefined:0,Html:1,TextSelection:2,PlainText:3,RTF:4,Unsupported:5};function A(t,n){var a,e,r=U.Undefined,o=n?null===(a=null==t?void 0:t.UniqueBody)||void 0===a?void 0:a.BodyType:null===(e=null==t?void 0:t.NormalizedBody)||void 0===e?void 0:e.BodyType;return"HTML"===o?r=U.Html:"Text"===o&&(r=U.PlainText),r}var B=a(5111),k=a(449),V=a(819),R=a(2389),_=a(439),W=a(2539);function H(t,n,a){var e;e="DisplayTranslation"===n?Object(k.a)({PropertyName:n,DistinguishedPropertySetId:"Common",PropertyType:"Boolean"}):Object(k.a)({PropertyName:n,DistinguishedPropertySetId:"Common",PropertyType:"String"});var r=Object(V.a)({ExtendedFieldURI:e,Value:a}),o=Object(B.a)(r),i=Object(R.a)({Updates:[o],ItemId:Object(_.a)({Id:t})});return Object(W.a)({ItemChanges:[i],ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly"})}var q,J,G=a(2532),z=a(180),Z=a(2033),$=Object(S.d)("storeTranslationData",j)((function(t,n){return Object(e.c)(this,void 0,void 0,(function(){var a,r;return Object(e.f)(this,(function(e){return a=H(t,"TranslationData",JSON.stringify(n)),r=Object(y.u)(),[2,Object(G.a)({Header:Object(z.b)(),Body:a}).then((function(t){var n=Object(Z.a)(t.Body.ResponseMessages.Items[0]);return n||r.endWithError("ServerError"),n})).catch((function(t){return r.endWithError("ServerError"),!1}))]}))}))})),Q=Object(S.d)("storeTranslationData",v)((function(t,n){return Object(e.c)(this,void 0,void 0,(function(){var a,r,i;return Object(e.f)(this,(function(e){return r=Object(o.i)("tra-useTranslationStatusV2")?"DisplayTranslation":"TranslationStatus",a=H(t,r,""+n),i=Object(y.u)(),[2,Object(G.a)({Header:Object(z.b)(),Body:a}).then((function(t){var n=Object(Z.a)(t.Body.ResponseMessages.Items[0]);return n||i.endWithError("ServerError"),n})).catch((function(t){return i.endWithError("ServerError"),!1}))]}))}))})),X=a(203),Y=a(6246),K=a(2597);!function(t){t[t.Undefined=0]="Undefined",t[t.OWA=1]="OWA",t[t.OutlookWin32=2]="OutlookWin32"}(q||(q={})),function(t){t[t.Default=-2]="Default",t[t.ErrorOrUnexpectedValue=-1]="ErrorOrUnexpectedValue",t[t.ZeroToFiveThousand=5]="ZeroToFiveThousand",t[t.FiveToTenThousand=10]="FiveToTenThousand",t[t.TenToOneHundredThousand=100]="TenToOneHundredThousand",t[t.OneHundredToTwoHundredThousand=200]="OneHundredToTwoHundredThousand",t[t.MaxValue=Number.MAX_VALUE]="MaxValue"}(J||(J={}));var tt=a(10140),nt=Object(S.d)("translateItem",p)((function(t,n,a,r,i){return void 0===a&&(a=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),Object(e.c)(this,void 0,void 0,(function(){var s,u,c,d,T,g,b,f,m,D,p,h,j,v,w,S,x,I,F,P,N,B,k,V;return Object(e.f)(this,(function(e){switch(e.label){case 0:return s=Object(y.u)(),[4,Y.g.import()];case 1:if(u=e.sent(),c=7e3,d=L.u.items.get(t),T=!1,a&&(g=L.u.conversations.get(d.ConversationId.Id)),d.TranslationData.correlationId=Object(X.a)(),d.TranslationData.isTranslating=!0,d.TranslationData.targetLanguageTag=u(),d.TranslationData.translationFailed=!1,b=!1,f=!1,m=!1,D=[],p=function(t,n,a){return!(!a||!t.subjectTranslationData.translationText)||!(a||!n.TranslationData.subjectTranslationText)}(g,d,a),n&&!p&&(D.push(n),b=!0),null==d.TranslationData.translationText&&(d.TranslationData.isTranslatable||r)&&(Object(M.a)(d.TranslationData.itemOgmaLocale)&&!r||(h=C(d,a))&&(D.push(h),f=!0)),a&&(j=E(d))&&(null===d.TranslationData.forwardContentTranslationText&&d.TranslationData.isForwardContentTranslatable&&!Object(M.a)(d.TranslationData.forwardContentLocale)||r)&&(j.forEach((function(t){t&&D.push(t)})),m=!0),!(b||f||m))return[3,7];v=void 0,e.label=2;case 2:return e.trys.push([2,5,,6]),[4,Y.l.import()];case 3:return w=e.sent(),S=function(t,n){if(t)return tt.a.Manual;if(n)return tt.a.Automatic;return tt.a.Suggestion}(r,i),[4,w(D,d.TranslationData.targetLanguageTag,d.TranslationData.correlationId,S)];case 4:return v=e.sent(),T=!0,[3,6];case 5:return x=e.sent(),function(t,n,a,e){if(t.TranslationData.isTranslating=!1,t.TranslationData.translationFailed=!0,a){var r=new Error("[InlineTranslation] TranslateText failed. Error:"+n+" | cid:"+e);a.endWithError("ServerError",r)}}(d,x,s,d.TranslationData.correlationId),[2];case 6:Object(o.i)("tra-logEntityType")&&(I=function(){if(O)return O}(),s&&I&&s.addCustomData({EntityId:I})),d.TranslationData.shouldGetFeedback=!0,b&&(F=v.shift(),a?g.subjectTranslationData.translationText=F:d.TranslationData.subjectTranslationText=F,p=!0),f&&(P=v.shift(),d.TranslationData.translationText=P),m&&(d.TranslationData.forwardContentTranslationText=v),e.label=7;case 7:return d.TranslationData.isTranslating=!1,N=!1,!d.TranslationData.translationText&&!d.TranslationData.forwardContentTranslationText||!p&&n||(!Object(o.i)("tra-cacheTranslation")||d.TranslationData.isShowingTranslation||d.TranslationData.isShowingForwardContentTranslation||(N=!0),null!==d.TranslationData.translationText&&(d.TranslationData.isShowingTranslation=!0),null!==d.TranslationData.forwardContentTranslationText&&(d.TranslationData.isShowingForwardContentTranslation=!0),null!==n&&(a?g.subjectTranslationData.isShowingTranslation=!0:d.TranslationData.isShowingSubjectTranslation=!0),a||s&&s.addCustomData({conversationViewOff:!0}),(d.TranslationData.manuallyTranslated||r&&!function(t){return t.TranslationData.isTranslatable&&!Object(M.a)(t.TranslationData.itemOgmaLocale)||t.TranslationData.isForwardContentTranslatable&&!Object(M.a)(t.TranslationData.forwardContentLocale)}(d))&&(s&&s.addCustomData({manual:!0}),d.TranslationData.manuallyTranslated=!0),i&&s&&s.addCustomData({auto:!0}),d.TranslationData.isFastTextLanguage&&s&&s.addCustomData({fastText:!0}),Object(o.i)("rp-inlineTranslationReportMessageBucketLength")&&(b||f||m)&&(B=function(t){if(!t)return J.ErrorOrUnexpectedValue;for(var n=0,a=0;a<t.length;a++){if(n>0&&t[a].length>Number.MAX_VALUE-n)return J.MaxValue;n+=t[a].length}switch(n>=0){case n>=0&&n<5e3:return J.ZeroToFiveThousand;case n>=5e3&&n<1e4:return J.FiveToTenThousand;case n>=1e4&&n<1e5:return J.TenToOneHundredThousand;case n>=1e5&&n<2e5:return J.OneHundredToTwoHundredThousand;case n>=2e5:return J.MaxValue;default:return J.ErrorOrUnexpectedValue}}(D),s&&s.addCustomData({messageBucket:B}))),Object(o.i)("rp-inlineTranslation-floodgateSurvey")&&setTimeout((function(){K.b.import().then((function(t){t("TranslationCompleted")}))}),c),Object(o.i)("tra-cacheTranslation")&&T&&!d.RightsManagementLicenseData?(k=a?g.subjectTranslationData.translationText:d.TranslationData.subjectTranslationText,(V={language:d.TranslationData.targetLanguageTag,subject:k,body:d.TranslationData.translationText,forward:d.TranslationData.forwardContentTranslationText,isConversation:a,contentType:A(d,a),clientType:q.OWA,dateTime:Date.now()}).contentType!==U.Undefined?[3,8]:(l.d("[InlineTranslation] CacheTranslation ContentType Unknown"),[3,10])):[3,10];case 8:return[4,$(d.ItemId.Id,V)];case 9:e.sent(),e.label=10;case 10:return N?[4,Q(d.ItemId.Id,!0)]:[3,12];case 11:e.sent(),e.label=12;case 12:return[2]}}))}))}));var at=a(183);function et(t){try{var n=(new DOMParser).parseFromString(t,"text/html"),a=n.querySelector('[id$="divRplyFwdMsg"]');a&&a.remove();var e=n.querySelectorAll("style");if(e&&e.length>0)for(var r=0;r<e.length;r++)e[r]&&(e[r].innerText="");return n.body.textContent||""}catch(t){return""}}var rt=a(53),ot=40;var it=Object(at.action)("setItemLocale")((function(t,n,a){return Object(e.c)(this,void 0,void 0,(function(){var r,i,s,l,u,c,d,T,g,b,f,m,O,p,h,j,v,w,S,x,F,M,U,A,B,k;return Object(e.f)(this,(function(e){switch(e.label){case 0:return[4,Y.k.import()];case 1:return r=e.sent(),[4,Y.e.import()];case 2:return i=e.sent(),[4,Y.d.import()];case 3:return s=e.sent(),[4,Y.f.import()];case 4:return l=e.sent(),[4,Y.g.import()];case 5:return u=e.sent(),[4,Y.c.import()];case 6:return c=e.sent(),[4,Y.b.import()];case 7:return d=e.sent(),T=!n.TranslationData.userLanguage,null!=(g=n.TranslationData.itemLocale)?[3,9]:[4,D(n)];case 8:b=e.sent(),g=b[0],n.TranslationData.quotedTextLocales=null!=b[1]?JSON.parse(b[1]):[],e.label=9;case 9:return f=i(g),[4,r()];case 10:return m=e.sent(),O=!T&&(m||l()!=n.TranslationData.userLanguage),T||O?(t&&(p=L.u.conversations.get(n.ConversationId.Id)),c()&&function(t,n){void 0===n&&(n=!1);var a=0,e=L.u.items.get(t),r=C(e,n);if(r&&(a+=r.length),n){var o=E(e);o&&o.forEach((function(t){a+=t.length}))}return a<P}(n.ItemId.Id,t)?(n.TranslationData.userLanguage=l(),n.TranslationData.itemOgmaLocale=f,n.TranslationData.itemLocaleName=s(f),h=d(u(),g),Object(o.i)("rp-inlineTranslationForwardContent2")&&t?(j=[],n.TranslationData.quotedTextLocales.forEach((function(t){j.push(i(t))})),(v=function(t,n,a,e){var r=t,o=L.u.conversationNodes.get(r.InternetMessageId);if((null==o?void 0:o.hasQuotedText)&&o.quotedTextList){if(!n||n.length<=0||o.quotedTextList.length!=n.length)return"";for(var i=0;i<n.length;i++)if(!Object(rt.b)(n[i])){var s=et(o.quotedTextList[i]);if(s&&s.length>=ot&&e(a,n[i]))return n[i]}}return null}(n,j,u(),d))?(n.TranslationData.forwardContentLocale=v,n.TranslationData.forwardContentLocaleName=s(v),n.TranslationData.isForwardContentTranslatable=!0,f||(n.TranslationData.itemOgmaLocale=v,n.TranslationData.itemLocaleName=n.TranslationData.forwardContentLocaleName)):""===v?n.TranslationData.isForwardContentTranslatable=h:(n.TranslationData.isForwardContentTranslatable=!1,n.TranslationData.forwardContentTranslationText=null)):!Object(o.i)("rp-inlineTranslationForwardContent2")&&t?n.TranslationData.isForwardContentTranslatable=h:Object(o.i)("rp-inlineTranslation-conversationViewOff")&&!t?n.TranslationData.isForwardContentTranslatable=h:n.TranslationData.isForwardContentTranslatable=!1,null==n.TranslationData.itemLocale&&(n.TranslationData.itemLocale=g),w=!0,T?Object(o.i)("tra-cacheTranslation")?[4,I(n)]:[3,12]:[3,14]):(n.TranslationData.isTranslatable=!1,n.TranslationData.isShowingTranslation=!1,n.TranslationData.translationText=null,n.TranslationData.isForwardContentTranslatable=!1,n.TranslationData.isShowingForwardContentTranslation=!1,n.TranslationData.forwardContentTranslationText=null,t?(p.subjectTranslationData.isShowingTranslation=!1,p.subjectTranslationData.translationText=null):(n.TranslationData.isShowingSubjectTranslation=!1,n.TranslationData.subjectTranslationText=null),[2])):[3,15];case 11:return x=e.sent(),[3,13];case 12:x=[null,null],e.label=13;case 13:F="true"===(S=x)[1],null!==S[1]&&(w=!1),M=JSON.parse(S[0]),U=u(),A=!0,Object(o.i)("tra-useTranslationClientType")&&M&&(A=function(t){var n=null==t?void 0:t.clientType;if(n===q.OWA)return!0;var a=n?{clientType:n}:{clientType:0};return Object(y.s)("InlineTranslationInvalidCache",a),!1}(M)),A&&M&&M.language==U&&M.isConversation==t?(t?p.subjectTranslationData.translationText||(p.subjectTranslationData.translationText=M.subject):n.TranslationData.subjectTranslationText||(n.TranslationData.subjectTranslationText=M.subject),n.TranslationData.translationText=M.body,M.forward&&M.forward.length>0?n.TranslationData.forwardContentTranslationText=M.forward:n.TranslationData.forwardContentTranslationText=null):(F&&(w=!0,F=!1),n.TranslationData.translationText=null,n.TranslationData.forwardContentTranslationText=null),F&&(n.TranslationData.translationText&&(n.TranslationData.isShowingTranslation=!0),t?p.subjectTranslationData.translationText&&(p.subjectTranslationData.isShowingTranslation=!0):n.TranslationData.subjectTranslationText&&(n.TranslationData.isShowingSubjectTranslation=!0),Object(o.i)("rp-inlineTranslationForwardContent2")&&n.TranslationData.forwardContentTranslationText&&(n.TranslationData.isShowingForwardContentTranslation=!0),h||n.TranslationData.isForwardContentTranslatable||(n.TranslationData.manuallyTranslated=!0)),e.label=14;case 14:n.TranslationData.isTranslatable=h,O&&(n.TranslationData.isShowingTranslation=!1,n.TranslationData.translationText=null,n.TranslationData.isShowingForwardContentTranslation=!1,n.TranslationData.forwardContentTranslationText=null,t?(p.subjectTranslationData.isShowingTranslation=!1,p.subjectTranslationData.translationText=null):(n.TranslationData.isShowingSubjectTranslation=!1,n.TranslationData.subjectTranslationText=null)),Object(o.i)("rp-inlineTranslationAutomatic")&&w&&(B=n.TranslationData.isTranslatable&&Object(N.a)(n.TranslationData.itemOgmaLocale),k=!1,Object(o.i)("rp-inlineTranslationForwardContent2")&&(k=n.TranslationData.isForwardContentTranslatable&&Object(N.a)(n.TranslationData.forwardContentLocale)),(B||k)&&nt(n.ItemId.Id,a,t,!1,!0)),e.label=15;case 15:return[2]}}))}))})),st=Object(S.d)("untranslateItem",h)((function(t,n){return void 0===n&&(n=!1),Object(e.c)(this,void 0,void 0,(function(){var a,r;return Object(e.f)(this,(function(e){switch(e.label){case 0:return a=L.u.items.get(t),n?(r=a.ConversationId.Id,L.u.conversations.get(r).subjectTranslationData.isShowingTranslation=!1):a.TranslationData.isShowingSubjectTranslation=!1,a.TranslationData.isShowingTranslation=!1,a.TranslationData.isShowingForwardContentTranslation=!1,Object(o.i)("tra-cacheTranslation")?[4,Q(a.ItemId.Id,!1)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))})),lt=a(2),ut=Object(lt.mutatorAction)("setWrongLanguage",(function(t){var n=L.u.items.get(t);n.TranslationData.isWrongLanguage=!0;var a=n.TranslationData.isFastTextLanguage?{fastText:!0}:[];Object(y.s)("InlineTranslationWrongLanguage",a,{cosmosOnlyData:JSON.stringify({id:n.ItemId.Id,language:n.TranslationData.itemLocaleName})})})),ct=a(0),dt=a(2767),Tt=a(17011),gt=a(6),bt=a(17012);function ft(){}function mt(){}function Ot(t){var n={correlationId:t.translationData.correlationId,sourceLanguage:t.translationData.itemOgmaLocale,targetLanguage:t.translationData.targetLanguageTag,messageLength:t.messageContent.length};return JSON.stringify(n)}function Dt(t){var n=Object(o.i)("rp-inlineTranslation-feedbackRibbon-newCategories")?[{logString:"IncorrectDifficult",uiString:Object(gt.b)(Tt.c)},{logString:"MissingIncomplete",uiString:Object(gt.b)(Tt.d)},{logString:"AlreadyLang",uiString:Object(gt.b)(Tt.a)},{logString:"Other",uiString:Object(gt.b)(Tt.e)}]:[{logString:"Readability",uiString:Object(gt.b)(Tt.f)},{logString:"Formatting",uiString:Object(gt.b)(Tt.b)},{logString:"Other",uiString:Object(gt.b)(Tt.e)}],a=Object(e.a)({title:Object(gt.b)(Tt.i),subTitle:Object(gt.b)(Tt.h),ghostText:Object(gt.b)(Tt.g),categories:n,odsFeedbackOverrides:{symptomName:"inlineTranslation"}},Object(o.i)("rp-inlineTranslation-DonateContent")&&{donationText:Object(gt.b)(Tt.j),donationJson:{messageContent:t.messageContent}});return ct.createElement("div",{className:bt.translationFeedback},ct.createElement(dt.a,{ribbonMessage:Object(gt.b)(Tt.l),feature:"inlineTranslation",subFeature:"inlineTranslation",metadata:Ot(t),thankYouMessage:Object(gt.b)(Tt.m),moreFeedbackRibbonMessage:Object(gt.b)(Tt.k),noFeedbackDialogParams:a,yesCallBack:ft,noCallBack:mt}))}a.d(n,"setItemLocale",(function(){return it})),a.d(n,"translateItem",(function(){return nt})),a.d(n,"untranslateItem",(function(){return st})),a.d(n,"setWrongLanguage",(function(){return ut})),a.d(n,"TranslationFeedbackRibbon",(function(){return Dt}))},2239:function(t,n,a){"use strict";a.d(n,"a",(function(){return r}));var e=a(1);function r(t){return Object(e.a)({__type:"Message:#Exchange"},t)}},2389:function(t,n,a){"use strict";a.d(n,"a",(function(){return r}));var e=a(1);function r(t){return Object(e.a)({__type:"ItemChange:#Exchange"},t)}},2421:function(t,n,a){"use strict";a.d(n,"a",(function(){return r}));var e=a(1);function r(t){return Object(e.a)({__type:"SetItemField:#Exchange"},t)}},2532:function(t,n,a){"use strict";var e=a(33),r=a(1);function o(t,n){var a;return void 0===t||t.__type||(a=t,t=Object(r.a)({__type:"UpdateItemJsonRequest:#Exchange"},a)),Object(e.a)("UpdateItem",t,n)}a.d(n,"a",(function(){return o}))},2539:function(t,n,a){"use strict";a.d(n,"a",(function(){return r}));var e=a(1);function r(t){return Object(e.a)({__type:"UpdateItemRequest:#Exchange"},t)}},2597:function(t,n,a){"use strict";a.d(n,"a",(function(){return o})),a.d(n,"b",(function(){return i}));var e=a(31),r=new e.c((function(){return Promise.all([a.e(21),a.e(24),a.e(64),a.e(68),a.e(641)]).then(a.bind(null,4145))})),o=new e.a(r,(function(t){return t.loadAndInitializeFloodgateEngine})),i=new e.b(r,(function(t){return t.logFloodgateActivity}))},2767:function(t,n,a){"use strict";a.d(n,"a",(function(){return o})),a.d(n,"b",(function(){return i}));var e=a(31),r=new e.c((function(){return Promise.all([a.e(0),a.e(1),a.e(2),a.e(3),a.e(4),a.e(5),a.e(10),a.e(632)]).then(a.bind(null,4139))})),o=Object(e.d)(r,(function(t){return t.FeedbackRibbon})),i=new e.b(r,(function(t){return t.launchFeedbackDialogWithoutRibbon}));new e.b(r,(function(t){return t.launchFeedbackWithEmbeddedRibbon}))},2897:function(t,n,a){"use strict";var e=a(2),r=a(203);n.a=Object(e.createStore)("TranslationStore",{sessionId:Object(r.a)(),localeOfSupportedLanguageMap:null,supportedLanguageMap:null,isUserLocaleSupported:!1,userLanguageName:null,userLanguageTag:null,settings:{translationMode:null,targetLanguage:null,excludedLanguages:[],initialized:!1}})()},4734:function(t,n,a){"use strict";var e;!function(t){t[t.SuggestAutomatic=0]="SuggestAutomatic",t[t.Automatic=1]="Automatic",t[t.Never=2]="Never",t[t.Suggest=3]="Suggest"}(e||(e={})),n.a=e},5111:function(t,n,a){"use strict";a.d(n,"a",(function(){return s}));var e=a(819),r=a(449),o=a(2239),i=a(2421);function s(t){return Object(i.a)({Path:Object(r.a)(t.ExtendedFieldURI),Item:Object(o.a)({ExtendedProperty:[Object(e.a)(t)]})})}},6246:function(t,n,a){"use strict";a.d(n,"a",(function(){return o})),a.d(n,"b",(function(){return i})),a.d(n,"k",(function(){return s})),a.d(n,"j",(function(){return l})),a.d(n,"e",(function(){return u})),a.d(n,"d",(function(){return c})),a.d(n,"i",(function(){return d})),a.d(n,"f",(function(){return T})),a.d(n,"g",(function(){return g})),a.d(n,"h",(function(){return b})),a.d(n,"c",(function(){return f})),a.d(n,"l",(function(){return m})),a.d(n,"m",(function(){return O})),a.d(n,"n",(function(){return D}));var e=a(31),r=new e.c((function(){return a.e(862).then(a.bind(null,10297))})),o=new e.b(r,(function(t){return t.addExcludedLanguage})),i=new e.b(r,(function(t){return t.checkCanTranslate})),s=new e.b(r,(function(t){return t.initSupportedLanguages})),l=new e.b(r,(function(t){return t.initAndGetSupportedLanguageMap})),u=(new e.b(r,(function(t){return t.getLocaleOfSupportedLanguageMap})),new e.b(r,(function(t){return t.getOgmaSupportedLanguageTag}))),c=(new e.b(r,(function(t){return t.getDetectedLanguage})),new e.b(r,(function(t){return t.getLanguageNameFromTag}))),d=(new e.b(r,(function(t){return t.getUserLanguageName})),new e.b(r,(function(t){return t.getUserLanguageTag}))),T=new e.b(r,(function(t){return t.getTargetLanguageName})),g=new e.b(r,(function(t){return t.getTargetLanguageTag})),b=new e.b(r,(function(t){return t.getTranslationSettings})),f=new e.b(r,(function(t){return t.getIsUserLocaleSupported})),m=new e.b(r,(function(t){return t.translateText})),O=new e.b(r,(function(t){return t.updateTranslationMode})),D=new e.b(r,(function(t){return t.updateTranslationSettings}))},7441:function(t,n,a){"use strict";a.d(n,"a",(function(){return r}));var e=a(1955);function r(t){var n,a,r=null===(a=null===(n=e.a.conversations)||void 0===n?void 0:n.get(t))||void 0===a?void 0:a.conversationNodeIds;return(null==r?void 0:r.length)>0}},819:function(t,n,a){"use strict";a.d(n,"a",(function(){return r}));var e=a(1);function r(t){return Object(e.a)({__type:"ExtendedPropertyType:#Exchange"},t)}}}]);
//# sourceMappingURL=owa.MailBoot~InlineTranslation.js.map
self.scriptsLoaded['owa.MailBoot~InlineTranslation.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~InlineTranslation.js'] = (new Date()).getTime();