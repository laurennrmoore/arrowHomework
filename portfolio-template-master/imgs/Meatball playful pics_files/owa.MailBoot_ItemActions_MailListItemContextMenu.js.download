self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ItemActions~MailListItemContextMenu.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[274],{10492:function(e,t,n){"use strict";var o=n(1),a=n(20),r=n(14437),i=n(3977),s=n(6),c=n(700),l=n(1872),u=n(733),d=n(1254),m=n(9635),p=n(2045),b=n(981);function g(e){return Object(p.a)(e.ItemId.Id,Object(b.a)({BaseShape:"IdOnly",IncludeMimeContent:!0}),null,"V2016_06_24",e.MailboxInfo).then((function(e){return!e||e instanceof Error?null:e.MimeContent}))}var f=n(197),h=n(0),x=n(212);n.d(t,"a",(function(){return S}));var O=n(158),v=n(14438),C=Object(a.a)((function(e,t){var n=Object(o.g)(h.useState(""),2),a=n[0],m=n[1];h.useImperativeHandle(t,(function(){return{setContent:function(e){null!==e&&0!==e.length||(e=Object(s.b)(r.a)),m(e)}}}),[]);var p=function(){e.onClose()};return h.createElement(l.a,{hidden:!1,dialogContentProps:{showCloseButton:!1,title:Object(f.a)()?Object(s.b)(r.c):Object(s.b)(r.b),type:u.a.normal},modalProps:{containerClassName:v.container},onDismiss:p},h.createElement("div",{className:O(v.content,"allowTextSelection"),tabIndex:-1},a),h.createElement(d.a,null,h.createElement(c.a,{onClick:p,className:v.button},Object(s.b)(i.a))))}),{forwardRef:!0});function S(e){var t=document.createElement("div");t.id="ViewMessageSourceDialog",document.body.appendChild(t);var n=h.createRef();x.render(h.createElement(C,{onClose:function(){x.unmountComponentAtNode(t),document.body.removeChild(t)},ref:n}),t),Object(f.a)()?e.MimeContent?n.current.setContent(atob(e.MimeContent.Value)):g(e).then((function(t){e.MimeContent=t,n.current.setContent(atob(e.MimeContent.Value))})):Object(m.a)(e).then((function(e){n.current.setContent(e)}))}},1254:function(e,t,n){"use strict";var o=n(768),a=n(3),r=n(0),i=n(713),s=n(470),c=Object(i.a)(),l=function(e){function t(t){var n=e.call(this,t)||this;return Object(s.a)(n),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,o=e.theme;return this._classNames=c(n,{theme:o,className:t}),r.createElement("div",{className:this._classNames.actions},r.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return r.Children.map(this.props.children,(function(t){return t?r.createElement("span",{className:e._classNames.action},t):null}))},t}(r.Component),u=n(7),d={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"};n.d(t,"a",(function(){return m}));var m=Object(o.a)(l,(function(e){var t=e.className,n=e.theme,o=Object(u.getGlobalClassNames)(d,n);return{actions:[o.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},t],action:[o.action,{margin:"0 4px"}],actionsRight:[o.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0"}]}}),void 0,{scope:"DialogFooter"})},14437:function(e){e.exports=JSON.parse('{"c":"qBc","b":"rBc","a":"sBc"}')},14438:function(e,t,n){var o=n(14439),a=n(78);"string"==typeof o&&(o=[[e.i,o]]);for(var r=0;r<o.length;r++)a.loadStyles(o[r][1],!1);o.locals&&(e.exports=o.locals)},14439:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._1pVbbNWoU3A2KPJ5mTx9ss{width:750px!important;max-width:750px!important;height:550px;overflow:hidden}._2o7RMkbYm39CgXru8bzVk{width:690px;height:410px;overflow:auto;word-wrap:break-word;white-space:pre}._3c9eatHmfdZHfX00YKzcP4{color:"[theme:white, default:#ffffff]"!important}html[dir] ._3c9eatHmfdZHfX00YKzcP4{background-color:"[theme:themePrimary, default:#0078D4]";border-radius:2px}html[dir] ._3c9eatHmfdZHfX00YKzcP4:hover{background-color:"[theme:themeDark, default:#0D62AA]"}html[dir] ._3c9eatHmfdZHfX00YKzcP4:active{background-color:"[theme:themeDarker, default:#004578]"}',""]),t.locals={container:"_1pVbbNWoU3A2KPJ5mTx9ss",content:"_2o7RMkbYm39CgXru8bzVk",button:"_3c9eatHmfdZHfX00YKzcP4"}},1872:function(e,t,n){"use strict";var o=n(768),a=n(3),r=n(0),i=n(713),s=n(261),c=n(733),l=n(1934),u=n(511),d=n(470),m=n(438),p=n(263),b=n(1260),g=n(1254),f=Object(i.a)(),h=r.createElement(g.a,null).type,x="DialogContent",O=function(e){function t(t){var n=e.call(this,t)||this;return Object(d.a)(n),Object(m.a)(x,t,{titleId:"titleProps.id"}),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,o=t.className,i=t.closeButtonAriaLabel,s=t.onDismiss,l=t.subTextId,u=t.subText,d=t.titleProps,m=void 0===d?{}:d,g=t.titleId,h=t.title,x=t.type,O=t.styles,v=t.theme,C=t.draggableHeaderClassName,S=f(O,{theme:v,className:o,isLargeHeader:x===c.a.largeHeader,isClose:x===c.a.close,draggableHeaderClassName:C}),_=this._groupChildren();return u&&(e=r.createElement("p",{className:S.subText,id:l},u)),r.createElement("div",{className:S.content},r.createElement("div",{className:S.header},r.createElement("div",Object(a.__assign)({id:g,role:"heading","aria-level":1},m,{className:Object(p.a)(S.title,m.className)}),h),r.createElement("div",{className:S.topButton},this.props.topButtonsProps.map((function(e,t){return r.createElement(b.a,Object(a.__assign)({key:e.uniqueId||t},e))})),(x===c.a.close||n&&x!==c.a.largeHeader)&&r.createElement(b.a,{className:S.button,iconProps:{iconName:"Cancel"},ariaLabel:i,onClick:s,title:i}))),r.createElement("div",{className:S.inner},r.createElement("div",{className:S.innerContent},e,_.contents),_.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return r.Children.map(this.props.children,(function(t){"object"==typeof t&&null!==t&&t.type===h?e.footers.push(t):e.contents.push(t)})),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},t=Object(a.__decorate)([u.d],t)}(r.Component),v=n(7),C={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},S=Object(o.a)(O,(function(e){var t,n,o,a=e.className,r=e.theme,i=e.isLargeHeader,s=e.isClose,c=e.hidden,l=e.isMultiline,u=e.draggableHeaderClassName,d=r.palette,m=r.fonts,p=r.effects,b=r.semanticColors,g=Object(v.getGlobalClassNames)(C,r);return{content:[i&&[g.contentLgHeader,{borderTop:"4px solid "+d.themePrimary}],s&&g.close,{flexGrow:1,overflowY:"hidden"},a],subText:[g.subText,m.medium,{margin:"0 0 24px 0",color:b.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:v.FontWeights.regular}],header:[g.header,{position:"relative",width:"100%",boxSizing:"border-box"},s&&g.close,u&&[u,{cursor:"move"}]],button:[g.button,c&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:b.buttonText,fontSize:v.IconFontSizes.medium}}}],inner:[g.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: "+v.ScreenWidthMinSmall+"px) and (max-width: "+v.ScreenWidthMaxSmall+"px)"]={padding:"0 16px 16px"},t)}],innerContent:[g.content,{position:"relative",width:"100%"}],title:[g.title,m.xLarge,{color:b.bodyText,margin:"0",minHeight:m.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(n={},n["@media (min-width: "+v.ScreenWidthMinSmall+"px) and (max-width: "+v.ScreenWidthMaxSmall+"px)"]={padding:"16px 46px 16px 16px"},n)},i&&{color:b.menuHeader},l&&{fontSize:m.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(o={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:b.buttonText},".ms-Dialog-button:hover":{color:b.buttonTextHovered,borderRadius:p.roundedCorner2}},o["@media (min-width: "+v.ScreenWidthMinSmall+"px) and (max-width: "+v.ScreenWidthMaxSmall+"px)"]={padding:"15px 8px 0 0"},o)}]}}),void 0,{scope:"DialogContent"}),_=Object(i.a)(),j={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1},y={type:c.a.normal,className:"",topButtonsProps:[]},w=function(e){function t(t){var n=e.call(this,t)||this;return n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,o=e.modalProps,a=e.dialogContentProps,r=e.subText,i=o&&o.subtitleAriaId||t;return i||(i=(a&&a.subText||r)&&n._defaultSubTextId),i},n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,o=e.modalProps,a=e.dialogContentProps,r=e.title,i=o&&o.titleAriaId||t;return i||(i=(a&&a.title||r)&&n._defaultTitleTextId),i},n._id=Object(s.a)("Dialog"),n._defaultTitleTextId=n._id+"-title",n._defaultSubTextId=n._id+"-subText",n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t,n,o,i=this.props,s=i.className,c=i.containerClassName,u=i.contentClassName,d=i.elementToFocusOnDismiss,m=i.firstFocusableSelector,p=i.forceFocusInsideTrap,b=i.styles,g=i.hidden,f=i.ignoreExternalFocusing,h=i.isBlocking,x=i.isClickableOutsideFocusTrap,O=i.isDarkOverlay,v=i.isOpen,C=i.onDismiss,w=i.onDismissed,I=i.onLayerDidMount,N=i.responsiveMode,D=i.subText,T=i.theme,P=i.title,M=i.topButtonsProps,R=i.type,A=i.minWidth,E=i.maxWidth,F=i.modalProps,H=Object(a.__assign)({},F?F.layerProps:{onLayerDidMount:I});I&&!H.onLayerDidMount&&(H.onLayerDidMount=I),F&&F.dragOptions&&!F.dragOptions.dragHandleSelector?(n="ms-Dialog-draggable-header",o=Object(a.__assign)(Object(a.__assign)({},F.dragOptions),{dragHandleSelector:"."+n})):o=F&&F.dragOptions;var k=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},j),{className:s,containerClassName:c,isBlocking:h,isDarkOverlay:O,onDismissed:w}),F),{layerProps:H,dragOptions:o}),B=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({className:u,subText:D,title:P,topButtonsProps:M,type:R},y),this.props.dialogContentProps),{draggableHeaderClassName:n,titleProps:Object(a.__assign)({id:(null===(e=this.props.dialogContentProps)||void 0===e?void 0:e.titleId)||this._defaultTitleTextId},null===(t=this.props.dialogContentProps)||void 0===t?void 0:t.titleProps)}),L=_(b,{theme:T,className:k.className,containerClassName:k.containerClassName,hidden:g,dialogDefaultMinWidth:A,dialogDefaultMaxWidth:E});return r.createElement(l.a,Object(a.__assign)({elementToFocusOnDismiss:d,firstFocusableSelector:m,forceFocusInsideTrap:p,ignoreExternalFocusing:f,isClickableOutsideFocusTrap:x,onDismissed:k.onDismissed,responsiveMode:N},k,{isDarkOverlay:k.isDarkOverlay,isBlocking:k.isBlocking,isOpen:void 0!==v?v:!g,className:L.root,containerClassName:L.main,onDismiss:C||k.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),r.createElement(S,Object(a.__assign)({subTextId:this._defaultSubTextId,title:B.title,subText:B.subText,showCloseButton:k.isBlocking,topButtonsProps:B.topButtonsProps,type:B.type,onDismiss:C||B.onDismiss,className:B.className},B),this.props.children))},t.defaultProps={hidden:!0},t=Object(a.__decorate)([u.d],t)}(r.Component),I={root:"ms-Dialog"};n.d(t,"a",(function(){return N}));var N=Object(o.a)(w,(function(e){var t,n=e.className,o=e.containerClassName,a=e.dialogDefaultMinWidth,r=void 0===a?"288px":a,i=e.dialogDefaultMaxWidth,s=void 0===i?"340px":i,c=e.hidden,l=e.theme;return{root:[Object(v.getGlobalClassNames)(I,l).root,l.fonts.medium,n],main:[{width:r,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: "+v.ScreenWidthMinMedium+"px)"]={width:"auto",maxWidth:s,minWidth:r},t)},!c&&{display:"flex"},o]}}),void 0,{scope:"Dialog"});N.displayName="Dialog"},2218:function(e,t,n){"use strict";var o=n(2432),a=n(31),r=n(2247);function i(){var e=Object(r.a)();return{isFullOptionsShown:e.isFullOptionsShown,areAllAllowedSubCategoriesLoaded:e.areAllAllowedSubCategoriesLoaded,currentCategoryKey:e.currentCategoryKey,currentSubCategoryKey:e.currentSubCategoryKey,currentOptionKey:e.currentOptionKey}}n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return i}));var s=new a.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5),n.e(10),n.e(15),n.e(17),n.e(16),n.e(19),n.e(22),n.e(24),n.e(25),n.e(28),n.e(29),n.e(46),n.e(50),n.e(65),n.e(91),n.e(106),n.e(109),n.e(122),n.e(161),n.e(957)]).then(n.bind(null,18435))})),c=new a.a(s,(function(e){return e.mountAndShowFullOptions})),l=new a.b(s,(function(e){return e.hideFullOptions})),u=new a.b(s,(function(e){return e.confirmDirtyOptionsAndPerformAction})),d=new a.b(s,(function(e){return e.exitOptionsFullPage})),m=Object(a.d)(s,(function(e){return e.QuickOptions}));Object(a.f)(o.a,s,(function(e){return e.mountFullOptionsOrchestrator}))},2247:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(2),a=n(14),r=Object(o.createStore)("optionsViewState",{isFullOptionsShown:!1,areAllAllowedSubCategoriesLoaded:!1,isSaving:!1,currentCategoryKey:null,currentSubCategoryKey:null,subCategoryLoadState:new a.ObservableMap,currentOptionKey:null,allowedOptions:[]})},2432:function(e,t,n){"use strict";var o=n(2);t.a=Object(o.action)("mountFullOptions",(function(e,t,n){return{category:e,subcategory:t,option:n}}))},3307:function(e,t,n){"use strict";var o=n(2);t.a=Object(o.action)("SHOW_IN_IMMERSIVE_READER",(function(e,t,n){return{itemId:e,actionSource:t,subActionSource:n}}))},3805:function(e){e.exports=JSON.parse('{"a":"DJa"}')},3977:function(e){e.exports=JSON.parse('{"a":"G5b"}')},4053:function(e){e.exports=JSON.parse('{"a":"eJa"}')},4054:function(e){e.exports=JSON.parse('{"a":"lJa"}')},4056:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var o=n(31),a=new o.c((function(){return n.e(798).then(n.bind(null,6765))})),r=new o.b(a,(function(e){return e.onArchiveTagForFolderChanged})),i=new o.b(a,(function(e){return e.onDeleteTagForFolderChanged})),s=new o.b(a,(function(e){return e.getRetentionPolicyMenuItem})),c=new o.b(a,(function(e){return e.getAssignPolicyPropertiesForMailContextMenu}))},4205:function(e){e.exports=JSON.parse('{"a":"ZIa"}')},4716:function(e){e.exports=JSON.parse('{"a":"cJa"}')},4963:function(e,t,n){"use strict";var o=n(1),a=n(5032),r=n(6),i=n(2),s=n(3307),c=function(e){return new Promise((function(t){return setTimeout((function(){t()}),e)}))},l=n(33),u=n(439);function d(e,t,n,o){return r=o,void 0===(a={itemId:e,sessionId:t,version:n}).itemId||a.itemId.__type||(a.itemId=Object(u.a)(a.itemId)),Object(l.a)("ImmersiveReaderProcessText",a,r);var a,r}var m=n(121),p=n(731),b=n(2610),g=n(419),f=(Object(i.orchestrator)(s.a,(function(e){return Object(o.c)(void 0,void 0,void 0,(function(){var t,n,i,s,l,O,v,S,_,j,y,w,I;return Object(o.f)(this,(function(o){switch(o.label){case 0:if(t=e.itemId,n=C(),!t||n.isLoading||0!==n.immersiveReaderFrameState)return[2];Object(b.a)(null),(i=new m.b("ShowInImmersiveReader")).addCustomData({sessionId:n.sessionId,subAction:e.subActionSource}),i.addActionSource(e.actionSource),f(!0),h(!0),s=(new Date).getUTCMilliseconds(),l=!0,O=null,v=null,o.label=1;case 1:return o.trys.push([1,7,8,9]),[4,d(Object(u.a)({Id:t.Id}),n.sessionId,"2.0",Object(g.a)(t.mailboxInfo))];case 2:if(S=o.sent(),i.addCheckmark("ImmersiveReaderProcessText_Done"),S&&S.ReaderModelJson?O=JSON.parse(S.ReaderModelJson):(l=!1,v="Response from service call was null or did not contain a ReaderModelJson"),!l)return[3,6];_=(new Date).getUTCMilliseconds(),j=(_-s).toString(),null,O.launchToPostMessageSentDurationInMs=j,x({messageType:"LinguisticModel",messageValue:O}),y=120,w=0,o.label=3;case 3:return w<y&&1===C().immersiveReaderFrameState?[4,c(500)]:[3,5];case 4:return o.sent(),w++,[3,3];case 5:1===C().immersiveReaderFrameState&&(l=!1,v="Frame never got to Ready state"),o.label=6;case 6:return[3,9];case 7:return I=o.sent(),l=!1,i.addCheckmark("CaughtException"),v=I.toString(),[3,9];case 8:return f(!1),[7];case 9:return l?i.end():(h(!1),i.endWithError("ServerError",new Error(v)),Object(p.b)(Object(r.b)(a.b),Object(r.b)(a.a),!1,{hideCancelButton:!0})),[2]}}))}))})),Object(i.mutatorAction)("toggleImmersiveReaderLoadingState",(function(e){C().isLoading=e}))),h=Object(i.mutatorAction)("toggleImmersiveReaderShowingState",(function(e){C().immersiveReaderFrameState=e?1:0})),x=Object(i.mutatorAction)("setImmersiveReaderApiResponse",(function(e){C().apiResponse=e})),O=n(203),v={sessionId:Object(O.a)(),isLoading:!1,immersiveReaderFrameState:0,apiResponse:null},C=Object(i.createStore)("immersivereader",v),S=C(),_=Object(i.mutatorAction)("setImmersiveReaderFrameReady",(function(){C().immersiveReaderFrameState=2})),j=Object(i.mutatorAction)("closeImmersiveReader",(function(){var e=C();e.immersiveReaderFrameState=0,e.apiResponse=null}));n.d(t,"e",(function(){return S})),n.d(t,"b",(function(){return C})),n.d(t,"c",(function(){return _})),n.d(t,"a",(function(){return j})),n.d(t,"d",(function(){return s.a}))},5032:function(e){e.exports=JSON.parse('{"b":"A3a","a":"B3a"}')},733:function(e,t,n){"use strict";var o;n.d(t,"a",(function(){return o})),function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(o||(o={}))},9635:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(2045),a=n(981);function r(e){return Object(o.a)(e.ItemId.Id,Object(a.a)({BaseShape:"IdOnly"}),"MessageDetails","V2016_06_24",e.MailboxInfo).then((function(e){return e&&!(e instanceof Error)&&null!=e.ExtendedProperty&&e.ExtendedProperty.length>=1?e.ExtendedProperty[0].Value:null}))}}}]);
//# sourceMappingURL=owa.MailBoot~ItemActions~MailListItemContextMenu.js.map
self.scriptsLoaded['owa.MailBoot~ItemActions~MailListItemContextMenu.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ItemActions~MailListItemContextMenu.js'] = (new Date()).getTime();