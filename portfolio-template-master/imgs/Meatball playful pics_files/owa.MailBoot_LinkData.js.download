self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~LinkData.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[698],{1255:function(e,n,t){"use strict";t.d(n,"d",(function(){return s})),t.d(n,"c",(function(){return l})),t.d(n,"b",(function(){return f})),t.d(n,"a",(function(){return d}));var r="A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴऀ-५ॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞭꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ0-9٠-٩۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯෦-෯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９",i=new RegExp("^(["+r+"!#$%&'*+/=?^_`{|}~-](?:["+r+".!#$%&'*+/=?^_`{|}~-]*["+r+"!#$%&'*+/=?^_`{|}~-])?)(?=@)"),a=new RegExp('^("['+r+'.!#$%&\'*+\\/=?^_`{|}~\\-(),:;<>@[\\\\\\]" ]*")(?=@)'),o=new RegExp("^["+r+"-]+(?:\\.["+r+"-]+)*$"),c=/[^\\]"/,u=/^[A-Za-z0-9_-]+:.*$/,s=function(e){var n=e.match(i);if(n)return-1!==n[0].indexOf("..")?null:n[0];var t=e.match(a);if(t){var r=c.exec(t[0]);return r&&r.index!==t[0].length-2?null:t[0]}return null};function l(e){if(!e)return!1;var n=s(e);return!!n&&!!e.substring(n.length+1).match(o)}function f(e){return u.test(e)}function d(e){return l(e)||f(e)}},1258:function(e,n,t){"use strict";var r=t(1),i=t(183),a=function(){function e(e){this.maxSize=e,this.references=[],this.mruList=[]}return e.prototype.initialize=function(e,n){var t,i;if(!this.store){this.store=e,this.deleteCallback=n;try{for(var a=Object(r.k)(e.keys()),o=a.next();!o.done;o=a.next()){var c=o.value;this.mruList.push(c)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}}},e.prototype.add=function(e,n){var t=this;Object(i.action)("MruCache_add")((function(){t.store.set(e,n),t.mruList.indexOf(e)>=0?t.touch(e):(t.mruList.push(e),t.purgeIfNecessary())}))()},e.prototype.get=function(e){return this.store.get(e)},e.prototype.getAndTouch=function(e){var n=this.store.get(e);return n&&this.touch(e),n},e.prototype.has=function(e){return this.store.has(e)},e.prototype.remove=function(e){var n=this;Object(i.action)("MruCache_remove")((function(){if(n.store.has(e)&&!n.isReferenced(e))return n.removeItemAtIndex(n.mruList.indexOf(e))}))()},e.prototype.registerReference=function(e){this.references.push(e)},e.prototype.clear=function(){var e=this;Object(i.action)("MruCache_clear")((function(){e.purgeTillSize(0)}))()},e.prototype.getItemIds=function(){return new(Array.bind.apply(Array,Object(r.j)([void 0],Object(r.g)(this.mruList))))},e.prototype.touch=function(e){var n=this.mruList.indexOf(e);if(n<0)throw new Error("Item with key '"+e+"' does not exist in the cache.");this.mruList.splice(n,1),this.mruList.push(e)},e.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},e.prototype.purgeTillSize=function(e){for(var n=0;this.mruList.length>e&&n<this.mruList.length;){var t=this.mruList[n];this.isReferenced(t)?n++:this.removeItemAtIndex(n)}},e.prototype.removeItemAtIndex=function(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);var n=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(n):this.store.delete(n)},e.prototype.isReferenced=function(e){for(var n=0;n<this.references.length;n++){var t=this.references[n]();if(Array.isArray(t)){if(-1!=t.indexOf(e))return!0}else if(t==e)return!0}return!1},e}();t.d(n,"a",(function(){return a}))},1281:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"FindItemJsonRequest:#Exchange"},e)}},1302:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(33),i=t(1281);function a(e,n){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FindItem",e,n)}},1304:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"FindItemRequest:#Exchange"},e)}},18200:function(e,n,t){"use strict";t.r(n);var r=t(2062),i=t(2),a=Object(i.action)("ADD_RECIPIENTS_INTO_LINK",(function(e,n){return{linkId:e,recipients:n}})),o=Object(i.action)("UPDATE_RECIPIENT_PERMISSION_INFO",(function(e,n){return{linkId:e,results:n}})),c=Object(i.action)("REMOVE_RECIPIENTS_FROM_LINK",(function(e,n){return{linkId:e,recipients:n}})),u=Object(i.action)("SET_GET_PERMISSION_INFO_FAILURE",(function(e,n){return{linkId:e,recipients:n}})),s=Object(i.action)("RESET_SHARING_RECIPIENTS_INFO",(function(e){return{linkId:e}})),l=Object(i.action)("SET_ACTION_STATUS",(function(e,n){return{linkId:e,linkActionStatus:n}})),f=Object(i.action)("IGNORE_SHARING_TIP",(function(e,n){return{linkId:e,sharingTipId:n}})),d=t(2104);Object(i.mutator)(r.c,(function(e){var n=Object(d.a)(e.linkId);n&&(n.linkActionStatus=e.actionStatus)})),Object(i.mutator)(l,(function(e){var n=Object(d.a)(e.linkId);n&&(n.linkActionStatus=e.linkActionStatus)})),Object(i.mutator)(r.e,(function(e){Object(d.a)(e.linkId).sharingInfo.blocksDownload=e.sharingDialogResponse.blocksDownload})),Object(i.mutator)(r.g,(function(e){var n=Object(d.a)(e.linkId);n&&(n.sharingInfo.expirationDate=e.expirationDate)})),Object(i.mutator)(r.e,(function(e){Object(d.a)(e.linkId).sharingInfo.linkType=e.sharingDialogResponse.isEdit?"edit":"view"}));var p=t(2040);Object(i.mutator)(r.g,(function(e){var n=Object(d.a)(e.linkId);n&&(n.url=e.newLinkUrl)})),Object(i.mutator)(p.e,(function(e){var n=Object(d.a)(e.linkId);n&&(n.url=e.url)})),Object(i.mutator)(r.e,(function(e){Object(d.a)(e.linkId).permissionLevel=e.sharingDialogResponse.permissionLevel})),Object(i.mutator)(r.f,(function(e){Object(d.a)(e.linkId).permissionLevel=e.newPermission}));var h=t(2399);Object(i.mutator)(a,(function(e){var n=Object(d.a)(e.linkId);n&&e.recipients.forEach((function(e){n.sharingRecipientsInfo.recipientPermissionInfos.some((function(n){return n.emailAddress===e.emailAddress}))||n.sharingRecipientsInfo.recipientPermissionInfos.push(e)}))})),Object(i.mutator)(o,(function(e){var n=Object(d.a)(e.linkId);n&&e.results.forEach((function(e){for(var t=0;t<n.sharingRecipientsInfo.recipientPermissionInfos.length;t++){var r=n.sharingRecipientsInfo.recipientPermissionInfos[t];if(r.emailAddress===e.recipient.alias){r.hasAccess=e.hasAccess,r.canHaveAccess=e.canBeInvited,r.getPermissionInfoStatus=h.a.Succeeded;break}}}))})),Object(i.mutator)(u,(function(e){var n=Object(d.a)(e.linkId);n&&e.recipients.forEach((function(e){for(var t=0;t<n.sharingRecipientsInfo.recipientPermissionInfos.length;t++){var r=n.sharingRecipientsInfo.recipientPermissionInfos[t];if(r.emailAddress===e.emailAddress){r.getPermissionInfoStatus=h.a.Failed;break}}}))})),Object(i.mutator)(c,(function(e){var n=Object(d.a)(e.linkId);n&&(n.sharingRecipientsInfo.recipientPermissionInfos=n.sharingRecipientsInfo.recipientPermissionInfos.filter((function(n){return t=n.emailAddress,!e.recipients.some((function(e){return e.emailAddress===t}));var t})))})),Object(i.mutator)(s,(function(e){var n=Object(d.a)(e.linkId);n&&(n.sharingRecipientsInfo.recipientPermissionInfos=[])})),Object(i.mutator)(r.e,(function(e){Object(d.a)(e.linkId).sharingInfo.shareId=e.sharingDialogResponse.shareId}));var v=t(2462);Object(i.mutator)(r.a,(function(e){Object(v.a)().sharingLinks.set(e.linkId,e.linkModel)})),Object(i.mutator)(p.g,(function(e){Object(v.a)().sharingLinks.delete(e.linkId)})),Object(i.mutator)(p.d,(function(e){Object(v.a)().sharingLinks.delete(e.linkId)})),Object(i.mutator)(f,(function(e){Object(d.a)(e.linkId).sharingTipsIgnored.push(e.sharingTipId)})),Object(i.mutator)(r.g,(function(e){var n=Object(d.a)(e.linkId);n&&(n.unwrappedUrl=null)})),Object(i.mutator)(r.d,(function(e){var n=Object(d.a)(e.linkId);n&&(n.accessTokenAvailable=!1)}));var m=t(1),b=t(121),g=t(5),O=t(53);function I(e){return Object(m.a)({__type:"CreateAttachmentSharingLinkRequest:#Exchange"},e)}var y=t(33);function x(e,n,t){return void 0===(r=function(e,n,t){return I({PermissionLevel:n,ResourceLocation:e,DataProviderType:t||0})}(e,n,t))||r.__type||(r=I(r)),Object(y.a)("CreateAttachmentSharingLink",r,i);var r,i}var j=t(2415);Object(i.orchestrator)(h.n,(function(e){return Object(m.c)(void 0,void 0,void 0,(function(){var n,t;return Object(m.f)(this,(function(i){switch(i.label){case 0:if("string"!=typeof e.id)return[3,2];if(0!==(n=Object(d.a)(e.id)).providerType)throw new Error("refreshExpirationDate only supports OneDrivePro link.");return n?(Object(r.c)(e.id,j.a.refreshing),[4,x(n.sharingInfo.canonicalUrl,n.permissionLevel)]):[3,2];case 1:if(t=i.sent(),Object(O.b)(t.Link))return Object(r.c)(e.id,j.a.refreshFailed),Object(b.s)("LinkRefreshLinkFailed"),[2];Object(r.c)(e.id,j.a.refreshSucceeded),Object(r.g)(n.linkId,t.Link,n.url,t.ExpirationDate?Object(g.nc)(t.ExpirationDate):null),i.label=2;case 2:return[2]}}))}))}));var k=t(3354),T=t(2155),E=t(23);Object(i.orchestrator)(r.b,(function(e){return Object(m.c)(void 0,void 0,void 0,(function(){var n,t,i,a;return Object(m.f)(this,(function(o){switch(o.label){case 0:if(n=e.sharingUrl,t=null,null!==n)return[3,8];switch(e.providerType){case 0:return[3,1];case 1:return[3,3];case 5:return[3,5]}return[3,7];case 1:return[4,x(e.canonicalUrl,e.newPermissionLevel)];case 2:return i=o.sent(),n=i.Link,t=i.ExpirationDate,[3,8];case 3:return[4,Object(k.h)(1,e.currentUrl,e.newPermissionLevel)];case 4:return(a=o.sent())&&(n=a.link.webUrl,a.expirationDateTime!==k.g&&(t=a.expirationDateTime)),[3,8];case 5:return[4,Object(k.h)(5,e.currentUrl,e.newPermissionLevel)];case 6:return o.sent(),[3,8];case 7:E.d("Data provider is not supported"),o.label=8;case 8:return 5!=e.providerType&&Object(r.g)(e.linkId,n,e.currentUrl,t?Object(g.nc)(t):null),Object(T.G)(e.linkId,e.newPermissionLevel),Object(T.A)(e.linkId,e.recipientInfos,e.composeId,e.isCalendar),[2]}}))}))}));var w=t(3426),C=t(2860);function S(e){return{anonymousViewLink:e.AnonymousViewLink,anonymousEditLink:e.AnonymousEditLink,organizationViewLink:e.OrganizationViewLink,organizationEditLink:e.OrganizationEditLink}}var D=t(3608);function L(e,n){var t=Object(D.a)(e,n)||[];return-1===t.indexOf(0)&&0===n&&t.push(0),t}function R(e,n,t,r,i,a,o){switch(i){case C.a.OneDrivePro:case C.a.OfficeOneDrivePro:return function(e,n,t,r,i,a){var o,c=t&&0===t.ResultCode;return o={getSharingInfoSucceeded:c,blocksDownload:!!c&&t.BlocksDownload,canonicalUrl:null==t?void 0:t.CanonicalUrl,canShareInternally:!!c&&t.CanShareInternally,canShareExternally:!!c&&t.CanShareExternally,expirationDate:(null==t?void 0:t.ExpirationDate)?Object(g.nc)(t.ExpirationDate):null,canRefresh:!!c&&(t.CanCreateAnonymousEditLink||t.CanCreateAnonymousViewLink),shareId:c?t.ShareId:null,siteUrl:c?t.SiteUrl:null,linkType:c?t.Type:null,itemUniqueId:c?t.ItemUniqueId:null,mimeType:c?t.MimeType:null},{linkId:e,providerType:0,fileName:null==t?void 0:t.FileName,mimeType:null==t?void 0:t.MimeType,url:n,unwrappedUrl:i||(c?t.OriginalUrl:null),accessTokenAvailable:c,permissionLevel:c?Object(D.b)(t.SharingLinkKind,"edit"===t.Type,r===T.a.InsertLinkFromAttachMenu||r===T.a.NewFluidFile):0,sharingInfo:o,supportedPermissionLevels:c?L(t,0):null,sharingUrls:c?S(t):null,sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:j.a.none,source:r,creationDateTime:a}}(e,n,t,r,a,o);case C.a.OneDriveConsumer:return function(e,n,t,r,i){var a,o=t&&0===t.ResultCode;return a={getSharingInfoSucceeded:o,canShareInternally:o,canShareExternally:o,blocksDownload:!1,expirationDate:(null==t?void 0:t.ExpirationDate)?Object(g.nc)(t.ExpirationDate):null,canRefresh:!1,linkType:o?t.Type:null,providerFileId:o?t.providerFileId:null,location:o?t.location:null},{linkId:e,providerType:1,fileName:null==t?void 0:t.FileName,mimeType:null==t?void 0:t.MimeType,url:n,unwrappedUrl:i,accessTokenAvailable:!1,permissionLevel:o?Object(D.b)(t.SharingLinkKind,"edit"===t.Type,!1):0,sharingInfo:a,supportedPermissionLevels:o?L(t,1):null,sharingUrls:o?S(t):null,sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:j.a.none,source:r}}(e,n,t,r,a);case C.a.Dropbox:return function(e,n,t,r,i){var a,o=t&&0===t.ResultCode;return a={getSharingInfoSucceeded:o,canShareInternally:o,canShareExternally:o,blocksDownload:!!o&&t.BlocksDownload,expirationDate:(null==t?void 0:t.ExpirationDate)?Object(g.nc)(t.ExpirationDate):null,canRefresh:!1,linkType:o?t.Type:null,providerFileId:o?t.providerFileId:null,location:o?t.location:null},{linkId:e,providerType:2,fileName:null==t?void 0:t.FileName,mimeType:null==t?void 0:t.MimeType,url:n,unwrappedUrl:i,accessTokenAvailable:!1,permissionLevel:3,sharingInfo:a,supportedPermissionLevels:o?L(t,2):null,sharingUrls:o?S(t):null,sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:j.a.none,source:r}}(e,n,t,r,a);case C.a.Box:return function(e,n,t,r,i){var a,o=t&&0===t.ResultCode;return a={getSharingInfoSucceeded:o,canShareInternally:o,canShareExternally:o,blocksDownload:!!o&&t.BlocksDownload,expirationDate:(null==t?void 0:t.ExpirationDate)?Object(g.nc)(t.ExpirationDate):null,canRefresh:!1,linkType:o?t.Type:null,providerFileId:o?t.providerFileId:null,location:o?t.location:null},{linkId:e,providerType:3,fileName:null==t?void 0:t.FileName,mimeType:null==t?void 0:t.MimeType,url:n,unwrappedUrl:i,accessTokenAvailable:!1,permissionLevel:3,sharingInfo:a,supportedPermissionLevels:o?L(t,3):null,sharingUrls:o?S(t):null,sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:j.a.none,source:r}}(e,n,t,r,a);case C.a.GDrive:return function(e,n,t,r,i){var a,o=t&&0===t.ResultCode;return a={getSharingInfoSucceeded:o,canShareInternally:o,canShareExternally:o,blocksDownload:!!o&&t.BlocksDownload,expirationDate:(null==t?void 0:t.ExpirationDate)?Object(g.nc)(t.ExpirationDate):null,canRefresh:!1,linkType:o?t.Type:null,providerFileId:o?t.providerFileId:null},{linkId:e,providerType:5,fileName:null==t?void 0:t.FileName,mimeType:null==t?void 0:t.MimeType,url:n,unwrappedUrl:i,accessTokenAvailable:!1,permissionLevel:"edit"===(null==t?void 0:t.Type)?4:3,sharingInfo:a,supportedPermissionLevels:o?L(t,5):null,sharingUrls:o?S(t):null,sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:j.a.none,source:r}}(e,n,t,r,a);default:throw new Error("createLinkModel do not support "+i)}}Object(i.orchestrator)(p.a,(function(e){var n=R(e.linkId,e.url,e.response,e.source,e.providerType,e.unwrappedUrl,e.creationDateTime);Object(r.a)(e.linkId,n),function(e,n,t,i){Object(m.c)(this,void 0,void 0,(function(){var a;return Object(m.f)(this,(function(o){switch(o.label){case 0:return[4,C.g.import()];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,5,,6]),a(t)&&i?[4,Object(w.d)(0,!1,e)]:[3,4];case 3:o.sent(),o.label=4;case 4:return[3,6];case 5:return o.sent(),Object(r.d)(n),[3,6];case 6:return[2]}}))}))}(n.sharingInfo.siteUrl,e.linkId,e.providerType,n.sharingInfo.siteUrl)}));var A=t(2490);Object(i.orchestrator)(r.e,(function(e){return Object(m.c)(void 0,void 0,void 0,(function(){var n,t,i;return Object(m.f)(this,(function(a){switch(a.label){case 0:return n=Object(d.a)(e.linkId),[4,Object(A.a)(n.url)];case 1:return t=a.sent(),i=e.sharingDialogResponse.url,null!=t&&(i+=(-1===i.indexOf("?")?"?":"&")+t),Object(r.g)(e.linkId,i,n.url,e.sharingDialogResponse.expirationDate),[2]}}))}))}));var P=t(2695);var M=t(1255),N=t(2277),F=t(2489);function _(e,n){var t=function(e){if(!e||0===e.length)return[];var n=[];return e.filter((function(e){return!!e})).map((function(e){var t=function(e){if(Object(F.b)(e))return e.recipients.slice();if(Object(F.a)(e))return function(e){return e?e.map((function(e){var n=e.persona?e.persona:{EmailAddress:e.Mailbox,PersonaId:{Id:null}},t=n.EmailAddress;return{persona:n,isValid:Object(M.c)(t.EmailAddress),isSelected:!1,isEditing:!1,isFadedOut:!1,isExpanding:!1,isContextMenuOpen:!1,expansionStatus:N.a.None,members:[],displayText:t.Name?t.Name:t.EmailAddress}})):[]}(e);return[]}(e);n=n.concat(t)})),n}(e),r=[];return t.forEach((function(e){var t=e.persona,i=function(e,n){var t=Object(P.a)().get(e,n);return t?{TotalMemberCount:t.value.TotalMemberCount,ExternalMemberCount:t.value.ExternalMemberCount}:null}(n,t.EmailAddress.EmailAddress);null!==i&&r.push({recipient:e,totalMemberCount:i.TotalMemberCount,externalMemberCount:i.ExternalMemberCount})})),r}var U=t(2065);function z(e,n){var t=null,r=null;switch(e.providerType){case 1:var i=e.sharingInfo;t=i.location,r=i.providerFileId;break;case 0:t=e.sharingInfo.canonicalUrl}return{fileType:U.a.Cloud,name:e.fileName,size:null,providerId:n,providerType:e.providerType,location:t,providerEndpointUrl:null,isFolder:!1,fileId:r,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:e.mimeType}}t.d(n,"ignoreSharingTip",(function(){return f})),t.d(n,"addRecipientsIntoLink",(function(){return a})),t.d(n,"updateRecipientPermissionInfos",(function(){return o})),t.d(n,"removeRecipientsFromLink",(function(){return c})),t.d(n,"setGetPermissionInfoFailure",(function(){return u})),t.d(n,"resetSharingRecipientsInfo",(function(){return s})),t.d(n,"setLinkActionStatus",(function(){return l})),t.d(n,"getSharingTipRecipientInfo",(function(){return _})),t.d(n,"createCloudFileFromSharingLink",(function(){return z})),t.d(n,"getSharingLinkInfo",(function(){return d.a}))},186:function(e,n,t){"use strict";function r(){var e=Object.create(null),n=0,t=0,r=0,i=!1;function a(n){r--,delete e[n]}this.put=function(n,t,i,o){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var c=e[n];c?clearTimeout(c.timeout):r++;var u={value:t,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){a(n),o&&o(n,t)}.bind(this),i)),e[n]=u,t},this.del=function(n){var t=!0,r=e[n];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(t=!1)):t=!1,t&&a(n),t},this.clear=function(){for(var a in e)clearTimeout(e[a].timeout);r=0,e=Object.create(null),i&&(n=0,t=0)},this.get=function(a){var o=e[a];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return i&&n++,o.value;i&&t++,r--,delete e[a]}else i&&t++;return null},this.size=function(){return r},this.memsize=function(){var n,t=0;for(n in e)t++;return t},this.debug=function(e){i=e},this.hits=function(){return n},this.misses=function(){return t},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var n={};for(var t in e){var r=e[t];n[t]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(n)},this.importJson=function(n,t){var r=JSON.parse(n),i=Date.now(),a=t&&t.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(a)if(e[o])continue;var c=r[o],u=c.expire-i;if(u<=0){this.del(o);continue}u=u>0?u:void 0,this.put(o,c.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},1969:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},1992:function(e,n,t){"use strict";var r=t(1963),i=t(2210),a=t(6);function o(e){var n;return e>=1073741824?(e/=1073741824,n=Object(a.b)(i.b)):e>=1048576?(e/=1048576,n=Object(a.b)(i.d)):e>=1024?(e/=1024,n=Object(a.b)(i.c)):n=Object(a.b)(i.a),Object(a.c)(n,Math.round(e))}var c,u=t(2061),s=t(24),l=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function f(e){if(!Object(s.i)("doc-attachment-documentThumbnail"))return!1;var n=Object(r.a)(e);return!!n&&l.indexOf(n.toLowerCase())>=0}function d(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return c.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return c.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return c.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(c||(c={}));var p=t(2019);t.d(n,"b",(function(){return r.a})),t.d(n,"c",(function(){return r.b})),t.d(n,"d",(function(){return r.c})),t.d(n,"i",(function(){return o})),t.d(n,"g",(function(){return u.a})),t.d(n,"h",(function(){return f})),t.d(n,"f",(function(){return d})),t.d(n,"e",(function(){return p.b})),t.d(n,"a",(function(){return c}))},2019:function(e,n,t){"use strict";function r(e){return n=e||"",(t=a.exec(n))&&t.length>1&&i[t[1].toLowerCase()];var n,t}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o}));var i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},a=/^\s*([^;\s]*)(?:;|\s|$)/;function o(e){var n="";return Object.entries(i).forEach((function(t){t[1]===e&&(n=t[0])})),n}},2061:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return s}));var r=t(1963),i=t(2019),a=t(102),o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],c=[".tiff",".tif"];function u(e,n,t){return void 0===t&&(t=!0),s(Object(r.a)(e)||Object(i.a)(n),t)}function s(e,n){return void 0===n&&(n=!0),!!e&&(o.indexOf(e.toLowerCase())>=0||n&&c.indexOf(e.toLowerCase())>=0&&(Object(a.e)()||Object(a.d)()||Object(a.h)()||Object(a.g)()&&!Object(a.l)()))}},2065:function(e,n,t){"use strict";var r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function i(e){var n=null,t=r.exec(e);if(t){var i=t[1],a=t[2],o=null;try{o=atob(a)}catch(e){}if(o){for(var c=new ArrayBuffer(o.length),u=new Uint8Array(c),s=0;s<o.length;s++)u[s]=o.charCodeAt(s);n=new File([c],"image.png",{type:i})}}return n}var a=t(1969),o=t(1992);function c(e){return e.map((function(e){return{fileType:a.a.Uri,name:e.name,type:Object(o.b)(e.url)||"",size:0,uri:e.url}}))}var u=t(23);function s(e,n,t){if(e.length!=n.length)return u.d("The sizes of subjects and latestItemIds are different"),null;for(var r=[],i=0;i<e.length;i++){var o={fileType:a.a.MailItem,name:e[i],size:(null==t?void 0:t[i])||0,itemId:n[i]};r.push(o)}return r}function l(e,n,t){var r=[],i={fileType:a.a.MailItem,name:e,size:t||0,mimeContent:n};return r.push(i),r}function f(e){if(!e)return null;for(var n=[],t=0;t<e.length;t++){var r=e[t],i={fileType:a.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};n.push(i)}return n}function d(e){if(!e)return null;for(var n=[],t=0;t<e.length;t++){var r=e[t],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};n.push(i)}return n}function p(e){var n,t;return null===e?null:{fileType:a.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(n=e.Thumbnail)||void 0===n?void 0:n.Url)||"",previewUrl:(null===(t=e.Preview)||void 0===t?void 0:t.Url)||"",type:e.MimeType}}function h(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:a.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var v={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function m(e){switch(e?e.toLowerCase():null){case v.ONE_DRIVE_PRO.toLowerCase():return 0;case v.GDRIVE.toLowerCase():return 5;case v.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case v.DROPBOX.toLowerCase():return 2;case v.BOX.toLowerCase():return 3;case v.WOPI_BOX.toLowerCase():return 7;case v.WOPI_EGNYTE.toLowerCase():return 8;case v.MAILBOX.toLowerCase():return 4;case v.FACEBOOK.toLowerCase():return 6;default:return null}}t.d(n,"f",(function(){return i})),t.d(n,"j",(function(){return c})),t.d(n,"i",(function(){return s})),t.d(n,"h",(function(){return l})),t.d(n,"g",(function(){return f})),t.d(n,"d",(function(){return d})),t.d(n,"e",(function(){return p})),t.d(n,"c",(function(){return h})),t.d(n,"b",(function(){return m})),t.d(n,"a",(function(){return a.a}))},2067:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"IndexedPageView:#Exchange"},e)}},2161:function(e,n,t){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},217:function(e,n,t){"use strict";var r=t(859);t.d(n,"a",(function(){return r.a}))},2179:function(e,n){e.exports=function(e){return e instanceof Date}},2210:function(e){e.exports=JSON.parse('{"b":"Nea","d":"Oea","c":"Pea","a":"Qea"}')},2243:function(e,n,t){var r=t(2179),i=36e5,a=6e4,o=2,c=/[T ]/,u=/:/,s=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],f=/^(\d{4})/,d=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],p=/^-(\d{2})$/,h=/^-?(\d{3})$/,v=/^-?(\d{2})-?(\d{2})$/,m=/^-?W(\d{2})$/,b=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,I=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,y=/([Z+-].*)$/,x=/^(Z)$/,j=/^([+-])(\d{2})$/,k=/^([+-])(\d{2}):?(\d{2})$/;function T(e,n,t){n=n||0,t=t||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*n+t+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,n){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var t=(n||{}).additionalDigits;t=null==t?o:Number(t);var E=function(e){var n,t={},r=e.split(c);u.test(r[0])?(t.date=null,n=r[0]):(t.date=r[0],n=r[1]);if(n){var i=y.exec(n);i?(t.time=n.replace(i[1],""),t.timezone=i[1]):t.time=n}return t}(e),w=function(e,n){var t,r=l[n],i=d[n];if(t=f.exec(e)||i.exec(e)){var a=t[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(t=s.exec(e)||r.exec(e)){var o=t[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(E.date,t),C=w.year,S=function(e,n){if(null===n)return null;var t,r,i,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(n),r;if(t=p.exec(e))return r=new Date(0),i=parseInt(t[1],10)-1,r.setUTCFullYear(n,i),r;if(t=h.exec(e)){r=new Date(0);var o=parseInt(t[1],10);return r.setUTCFullYear(n,0,o),r}if(t=v.exec(e)){r=new Date(0),i=parseInt(t[1],10)-1;var c=parseInt(t[2],10);return r.setUTCFullYear(n,i,c),r}if(t=m.exec(e))return a=parseInt(t[1],10)-1,T(n,a);if(t=b.exec(e)){a=parseInt(t[1],10)-1;var u=parseInt(t[2],10)-1;return T(n,a,u)}return null}(w.restDateString,C);if(S){var D,L=S.getTime(),R=0;return E.time&&(R=function(e){var n,t,r;if(n=g.exec(e))return(t=parseFloat(n[1].replace(",",".")))%24*i;if(n=O.exec(e))return t=parseInt(n[1],10),r=parseFloat(n[2].replace(",",".")),t%24*i+r*a;if(n=I.exec(e)){t=parseInt(n[1],10),r=parseInt(n[2],10);var o=parseFloat(n[3].replace(",","."));return t%24*i+r*a+1e3*o}return null}(E.time)),E.timezone?D=function(e){var n,t;if(n=x.exec(e))return 0;if(n=j.exec(e))return t=60*parseInt(n[2],10),"+"===n[1]?-t:t;if(n=k.exec(e))return t=60*parseInt(n[2],10)+parseInt(n[3],10),"+"===n[1]?-t:t;return 0}(E.timezone):(D=new Date(L+R).getTimezoneOffset(),D=new Date(L+R+D*a).getTimezoneOffset()),new Date(L+R+D*a)}return new Date(e)}},2277:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={})),n.b=r},2309:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},2330:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2),i=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},2331:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},2399:function(e,n,t){"use strict";t.d(n,"h",(function(){return s})),t.d(n,"i",(function(){return l})),t.d(n,"f",(function(){return f})),t.d(n,"k",(function(){return d})),t.d(n,"m",(function(){return p})),t.d(n,"e",(function(){return h})),t.d(n,"g",(function(){return v})),t.d(n,"j",(function(){return m})),t.d(n,"l",(function(){return b}));var r=t(31),i=t(2330);t.d(n,"n",(function(){return i.a}));var a=t(2309);t.d(n,"a",(function(){return a.a}));var o=t(2161);t.d(n,"d",(function(){return o.b})),t.d(n,"c",(function(){return o.a}));var c=t(2331);t.d(n,"b",(function(){return c.a}));var u=new r.c((function(){return Promise.all([t.e(4),t.e(42),t.e(81),t.e(819)]).then(t.bind(null,3601))})),s=new r.b(u,(function(e){return e.getSharingInformation})),l=new r.b(u,(function(e){return e.getSharingIssuesForSharingData})),f=new r.b(u,(function(e){return e.getInfoBarCreator})),d=new r.b(u,(function(e){return e.hasLargeDLRecipient})),p=new r.b(u,(function(e){return e.hasRecipientExpansionFailure})),h=new r.b(u,(function(e){return e.getGroupsAndSmallDLs})),v=new r.b(u,(function(e){return e.getInvididualRecipients})),m=new r.b(u,(function(e){return e.hasGetRecipientPermissionFailed})),b=new r.b(u,(function(e){return e.logSharingTipChangesForLinkRemoval}))},2695:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(3519);function i(){return Object(r.b)().mailTips}},2860:function(e,n,t){"use strict";t.d(n,"e",(function(){return o})),t.d(n,"b",(function(){return c})),t.d(n,"f",(function(){return u})),t.d(n,"g",(function(){return s})),t.d(n,"c",(function(){return l})),t.d(n,"d",(function(){return f}));var r=t(31),i=t(3340);t.d(n,"a",(function(){return i.a}));var a=new r.c((function(){return Promise.all([t.e(42),t.e(81),t.e(634)]).then(t.bind(null,6775))})),o=new r.b(a,(function(e){return e.createGetSharingInfoResponse})),c=new r.b(a,(function(e){return e.checkSharingLinkUrlDomain})),u=new r.b(a,(function(e){return e.getLinkProviderType})),s=new r.b(a,(function(e){return e.isOneDriveProRelatedLink})),l=new r.b(a,(function(e){return e.convertToAttachmentDataProviderType})),f=new r.b(a,(function(e){return e.convertToLinkProviderType}))},2890:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("updateMailtips",(function(e,n,t){return{composeId:e,fromEmailAddress:n,recipients:t}}))},2983:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("onMailTipRetrieved",(function(e,n){return{composeId:e,fromAddress:n}}))},3003:function(e,n,t){"use strict";var r=t(180),i=t(33),a=t(1);function o(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(a.a)({__type:"GetMailTipsJsonRequest:#Exchange"},t)),Object(i.a)("GetMailTips",e,n)}var c=t(419),u=t(209);function s(e,n){var t,i=Object(c.a)(Object(u.d)(e));return o({Header:Object(r.b)(),Body:(t={MailTipsRequested:1,SendingAs:{EmailAddress:e},Recipients:n.map((function(e){return{EmailAddress:e}}))},Object(a.a)({__type:"GetMailTipsRequest:#Exchange"},t))},i).then((function(e){return(null==e?void 0:e.Body)&&"Success"==e.Body.ResponseClass?e.Body:null})).catch((function(e){return Promise.resolve(null)}))}t.d(n,"a",(function(){return s}))},3007:function(e,n,t){"use strict";var r;!function(e){e.CustomMailTip="CustomMailTip",e.DeliveryRestricted="DeliveryRestricted",e.ExternalMemberCount="ExternalMemberCount",e.GuestMailTipStatus="GuestMailTipStatus",e.IsModerated="IsModerated",e.MailboxFull="MailboxFull",e.MaxMessageSize="MaxMessageSize",e.OutOfOffice="OutOfOffice",e.PreferAccessibleContent="PreferAccessibleContent",e.RecipientAddress="RecipientAddress",e.TotalMemberCount="TotalMemberCount"}(r||(r={}));var i=r,a=t(3099);t.d(n,"a",(function(){return u}));var o=/<!--((.|\n)*?)-->/gi,c=function(e){for(var n=[],t=0;t<e.length;t++)n.push(e[t]);return n};function u(e){if(!e)return null;var n=(new DOMParser).parseFromString(e,"text/xml").firstChild.childNodes;return c(n).reduce((function(e,n){switch(n.localName){case i.RecipientAddress:n.childNodes.length>1&&(e.RecipientAddress=n.childNodes[1].textContent);break;case i.MailboxFull:e.MailboxFull="true"===n.textContent;break;case i.IsModerated:e.IsModerated="true"===n.textContent;break;case i.TotalMemberCount:e.TotalMemberCount=parseInt(n.textContent)||0;break;case i.ExternalMemberCount:e.ExternalMemberCount=parseInt(n.textContent)||0;break;case i.MaxMessageSize:e.MaxMessageSize=parseInt(n.textContent)||0;break;case i.DeliveryRestricted:e.DeliveryRestricted="true"===n.textContent;break;case i.PreferAccessibleContent:e.PreferAccessibleContent="true"===n.textContent;break;case i.OutOfOffice:e.OutOfOffice=s(n);break;case i.CustomMailTip:e.CustomMailTip=d(n);break;case i.GuestMailTipStatus:e.GuestStatus=f(n.textContent)}return e}),{})}var s=function(e){return e.childNodes?d(c(e.childNodes).filter((function(e){return"ReplyBody"===e.localName}))[0]):""},l=function(e){return e.replace(o,"")},f=function(e){var n=e.split(" "),t=a.a.None;return n.map((function(e){t|=a.a[e]})),t};function d(e){var n;if(e){var t=l(e.textContent).replace(/<\/a>/gi,"</a> "),r=(new DOMParser).parseFromString(t,"text/html");if((null===(n=null==r?void 0:r.childNodes)||void 0===n?void 0:n.length)&&r.childNodes[0].textContent)return r.childNodes[0].textContent.replace(/\s\s+/g," ").trim()}return""}},3098:function(e,n,t){"use strict";var r=t(1),i=function(e){function n(n,t,r){var i=e.call(this,t,r)||this;return i.value=n,i}return Object(r.e)(n,e),n}(t(3116).a);n.a=i},3099:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.IsCalculated=1]="IsCalculated",e[e.GuestsEnabled=2]="GuestsEnabled",e[e.GroupHasGuests=4]="GroupHasGuests"}(r||(r={}))},3116:function(e,n,t){"use strict";var r=t(1),i=t(14),a=t(1258),o=300,c=function(){function e(e,n){this.parentCacheKey=e,this.childMruCacheKey=n,this.cacheTime=Date.now()}return e.isExpired=function(e){return Date.now()-e.cacheTime>=72e5},e.compareEntryCacheTime=function(e,n){return e.cacheTime-n.cacheTime},e}(),u=t(183),s=function(){function e(e,n,t){void 0===n&&(n=o),void 0===t&&(t=Date.now()),this.comparer=e,this.cacheLimit=n,this.lastExpiredEntryClearedTime=t,this.cache=new i.ObservableMap}return e.prototype.initialize=function(e){this.cache=e.cache},e.prototype.add=function(e,n){var t=this;Object(u.action)("NestedMruCache_add")((function(){t.clearOldEntriesIfNeeded();var r=null;t.cache.has(e)?r=t.cache.get(e):((r=new a.a(t.cacheLimit)).initialize(new i.ObservableMap),t.cache.set(e,r)),r.add(n.childMruCacheKey,n)}))()},e.prototype.containsValueForKey=function(e,n){if(!this.cache.has(e))return!1;var t=this.cache.get(e).get(n);return!(!t||c.isExpired(t))},e.prototype.get=function(e,n){var t=null;return this.containsValueForKey(e,n)&&(t=this.cache.get(e).get(n)),t},e.prototype.clearUpExpiredEntries=function(){var e,n;if(!(Date.now()-this.lastExpiredEntryClearedTime<12e5)){var t=function(e){e.getItemIds().forEach((function(n){c.isExpired(e.get(n))&&e.remove(n)}))};try{for(var i=Object(r.k)(this.cache.values()),a=i.next();!a.done;a=i.next()){t(a.value)}}catch(n){e={error:n}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}this.lastExpiredEntryClearedTime=Date.now()}},e.prototype.remove=function(e){var n=this;Object(u.action)("NestedMruCache_remove")((function(){if(n.cache.has(e)){var t=n.cache.get(e);t.getItemIds().map((function(e){t.remove(e)}))}}))()},e.prototype.clear=function(){var e=this;Object(u.action)("NestedMruCache_clear")((function(){var n,t,i=e.cache.keys();try{for(var a=Object(r.k)(i),o=a.next();!o.done;o=a.next()){var c=o.value;e.remove(c)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(n)throw n.error}}}))()},e.prototype.countTotalNumberOfEntries=function(){var e,n,t=0;if(this.cache)try{for(var i=Object(r.k)(this.cache.values()),a=i.next();!a.done;a=i.next()){t+=a.value.getItemIds().length}}catch(n){e={error:n}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return t},e.prototype.returnAllMailTipsCacheEntries=function(){var e,n,t=[];if(this.cache){var i=function(e){e&&e.getItemIds().map((function(n){var r=e.get(n);t.push(r)}))};try{for(var a=Object(r.k)(this.cache.values()),o=a.next();!o.done;o=a.next()){i(o.value)}}catch(n){e={error:n}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}}return t},e.prototype.clearOldEntriesIfNeeded=function(){var e,n;if(this.countTotalNumberOfEntries()>=o&&this.clearUpExpiredEntries(),this.countTotalNumberOfEntries()>=o){var t=[],i=function(e){e.getItemIds().forEach((function(n){t.push(e.get(n))}))};try{for(var a=Object(r.k)(this.cache.values()),c=a.next();!c.done;c=a.next()){i(c.value)}}catch(n){e={error:n}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}t.sort(this.comparer);for(var u=0;u<50;u++){var s=t[u].parentCacheKey,l=t[u].childMruCacheKey;this.cache.get(s).remove(l)}}},e}();t.d(n,"b",(function(){return s})),t.d(n,"a",(function(){return c}))},326:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return o}));var r,i=t(1);function a(e){r=e}function o(){var e,n;return Object(i.c)(this,void 0,void 0,(function(){var t,a;return Object(i.f)(this,(function(i){switch(i.label){case 0:return(a=r)?[4,r()]:[3,2];case 1:a=i.sent(),i.label=2;case 2:if((t=a)&&t.length>0){if("bearer"===(null===(e=null==t?void 0:t.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,t.split(" ")[1]];if("msauth1.0"===(null===(n=null==t?void 0:t.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return[2,t]}return[2,void 0]}}))}))}},3340:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.OneDrivePro=0]="OneDrivePro",e[e.OneDriveConsumer=1]="OneDriveConsumer",e[e.Dropbox=2]="Dropbox",e[e.Box=3]="Box",e[e.GDrive=5]="GDrive",e[e.OfficeOneDrivePro=31]="OfficeOneDrivePro"}(r||(r={}))},3519:function(e,n,t){"use strict";var r=t(2),i=t(3098),a=t(3116),o=t(1),c=t(2983),u=t(2890),s=t(2695),l=t(3003);var f=t(3007),d=t(121);Object(r.orchestrator)(u.a,(function(e){return Object(o.c)(void 0,void 0,void 0,(function(){var n,t,r,a,u,p,h,v;return Object(o.f)(this,(function(o){switch(o.label){case 0:return n=e.composeId,t=e.fromEmailAddress,r=e.recipients,t&&r&&r.length?(a=Object(s.a)(),(u=r.filter((function(e){return e&&!a.containsValueForKey(t,e)}))).length?[4,Object(l.a)(t,u)]:[3,2]):[3,3];case 1:(p=o.sent())&&(h=p.ResponseMessages.map((function(e){return Object(f.a)(e.MessageText)})).filter((function(e){return!!e})))&&h.length>0&&(!function(e,n){if(e&&e.length>0&&n){var t=Object(s.a)();e.map((function(e){t.add(n,new i.a(e,n,e.RecipientAddress))}))}}(h,t),Object(c.a)(n,t)),o.label=2;case 2:v=r.filter((function(e){return-1==u.indexOf(e)})),Object(d.s)("UpdateMailtipsDatapoint",{owa_1:v.length>0,rec:r.length,ca:v.length}),o.label=3;case 3:return[2]}}))}))}));t.d(n,"b",(function(){return h}));var p={mailTips:new a.b(i.a.compareEntryCacheTime)},h=Object(r.createStore)("mailTipsCacheStore",p),v=h();n.a=v},3608:function(e,n,t){"use strict";function r(e,n){if(null===e)return[];var t=[];if(0===n){var r=e;r.CanShareInternally&&(t.push(2),t.push(1)),r.CanCreateOrganizationEditLink&&t.push(6),r.CanCreateOrganizationViewLink&&t.push(5)}return e.CanCreateAnonymousEditLink&&t.push(4),e.CanCreateAnonymousViewLink&&t.push(3),t.length>0?t:[]}function i(e,n,t){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;case 6:return t?n?2:1:0;default:return 0}}function a(e,n,t){var r=i(e,t);if(0===r)switch(n){case 2:return t?4:3;case 1:return t?6:5;case 5:return t?2:1;default:return 0}return r}var o=t(6004),c=t(6),u="OneDrivePro",s=t(94),l=t(19);function f(e,n){switch(e){case 3:return Object(c.b)(o.b);case 4:return Object(c.b)(o.a);case 6:return Object(c.b)(o.d);case 5:return Object(c.b)(o.e);case 1:return n===u?Object(c.b)(o.g):Object(c.b)(o.b);case 2:return n===u?Object(c.b)(o.f):Object(c.b)(o.a);case 0:return Object(c.b)(o.c);default:return Object(s.a)(e)}}function d(e,n){return 0===n?function(e){var n,t=null===(n=Object(l.a)().SessionSettings)||void 0===n?void 0:n.CompanyName;switch(e){case 3:return Object(c.b)(o.i);case 4:return Object(c.b)(o.h);case 6:return Object(c.c)(Object(c.b)(o.j),t);case 5:return Object(c.c)(Object(c.b)(o.k),t);case 1:return Object(c.b)(o.g);case 2:return Object(c.b)(o.f);case 0:return Object(c.b)(o.c);default:return Object(s.a)(e)}}(e):f(e,null)}function p(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return a})),t.d(n,"d",(function(){return f})),t.d(n,"e",(function(){return d})),t.d(n,"f",(function(){return p}))},518:function(e,n,t){"use strict";var r=function(){function e(e,n,t){this.maxParallelTasks=e,this.taskCallback=n,this.taskDelay=t,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var n=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(n).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();t.d(n,"a",(function(){return r}))},6004:function(e){e.exports=JSON.parse('{"b":"doa","a":"eoa","d":"foa","e":"goa","g":"hoa","f":"ioa","c":"joa","i":"koa","h":"loa","j":"moa","k":"noa"}')},859:function(e,n,t){"use strict";function r(e){return e>=200&&e<300}t.d(n,"a",(function(){return r}))},981:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"ItemResponseShape:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.MailBoot~LinkData.js.map
self.scriptsLoaded['owa.MailBoot~LinkData.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~LinkData.js'] = (new Date()).getTime();