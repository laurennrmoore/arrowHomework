self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailComposeActions~MailComposeCommand.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[279],{10311:function(e,t,n){"use strict";var r=n(1),i=n(2),a=n(2119),c=n(3272),o=n(8484),s=n(2805),u=n(7402),l=n(11543),d=n(4876),b=n(4871),f=n(5788),m=n(5117),O=n(121),v=n(2128),p=n(209),j=n(2151),h=n(2211),g=n(3479),S=n(2339),I=n(19),y=n(11544),C=5e3,w="UpgradeCompose",A="UpgradeComposeCompleted";function T(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,i,c,o,f,m,g,S,T;return Object(r.f)(this,(function(k){return n=!e.isInlineCompose,i=t.itemToSave,c=t.groupId,o=t.suppressServerMarkReadOnReplyOrForward,f=t.remoteExecute,(m=t.smimeQuotedBody)?(g=3===e.operation,R(e,m),Object(u.a)(e,m,m,1,w,g),[2]):(S=!1,T=null,n&&(Object(O.s)("UpgradeCompose"),T=setTimeout((function(){Object(a.b)().viewStates.has(e.composeId)&&!S&&(x(e),Object(O.s)("UpgradeComposeTimedOut"))}),C)),Object(s.e)(e,Object(y.a)(i,c,o,f).then((function(t){t&&(M(e,t),function(e,t){var n=t.ItemId,r=t.Attachments;r&&v.n.importAndExecute(r,Object(p.d)(),e.attachmentWell,!0,!0,null,n)}(e,t)),n&&(!function(e,t){Object(r.c)(this,void 0,void 0,(function(){var n,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return t?0!=e.asyncSendState||e.isSending?[3,3]:e.quotedBody?(n=3===e.operation,i=function(e,t){var n,r=Object(I.a)();if((null===(n=null==r?void 0:r.UserOptions)||void 0===n?void 0:n.AutoAddSignatureOnReply)||!t){var i=Object(d.a)(e.quotedBody,e.bodyType);return Object(b.a)(e.bodyType)+i}return Object(l.a)(e.quotedBody,e.bodyType)}(e,n),[4,Object(u.a)(e,i,i,2,w,n)]):[3,2]:[3,5];case 1:r.sent(),E(e),Object(h.a)(e,"warningNoQuotedBody"),Object(O.s)(A,[!0]),r.label=2;case 2:return[3,4];case 3:x(e),Object(O.s)(A,[!1,"messageAlreadySending"]),r.label=4;case 4:return[3,6];case 5:!function(e){Object(h.a)(e,"warningNoQuotedBody"),Object(j.a)(e,"warningFailureToShowOriginalMessage")}(e),Object(O.s)(A,[!1,"quotedBodyNotLoaded"]),r.label=6;case 6:return[2]}}))}))}(e,t),S=!0,clearTimeout(T))}))),[2])}))}))}var E=Object(i.mutatorAction)("Compose_DisableSmartResponse",(function(e){e.useSmartResponse=!1})),R=Object(i.mutatorAction)("setSmimeQuotedBody",(function(e,t){e.quotedBody=t})),M=Object(i.mutatorAction)("Compose_ApplySmartRersponseResult",(function(e,t){var n=t.ItemId,r=t.Body,i=t.Subject,a=t.ItemClass,c=t.From;if(e.itemId=n,e.quotedBody=r.Value,e.subject=i,3===e.operation){var o=a&&Object(S.a)(a)?t:null;e.meetingRequestItem=o,Object(m.a)()&&c&&(e.fromViewState=Object(f.a)(c.Mailbox,o,e.referenceItemId,Object(g.a)(e)))}}));function x(e){Object(j.a)(e,"warningNoQuotedBody")}var k=n(33);var D=n(3414),P=n(2584);function L(){var e;Object(D.a)()&&0==Object(P.a)().rmsTemplates.size&&Object(k.a)("GetComplianceConfiguration",{},e).then(F)}var F=Object(i.mutatorAction)("ApplyComplianceConfig",(function(e){var t=Object(P.a)();e.RmsTemplates.forEach((function(e){var n={TemplateDescription:e.Description,TemplateName:e.Name,RmsTemplateId:e.Id};t.rmsTemplates.set(e.Id,n)})),e.MessageClassifications.forEach((function(e){t.messageClassifications.set(e.Id,e)}))})),N="CLPLabel";function V(e,t){var n;(null===(n=null==t?void 0:t.clpViewState)||void 0===n?void 0:n.selectedCLPLabel)&&!t.clpViewState.selectedCLPLabel.isDefault&&Object(j.a)(e,N)}var B=n(7398);function W(e,t){var n=Object(D.a)()&&(null==t?void 0:t.IRMData)?Object(B.a)(t.IRMData.RmsTemplateId):null;n&&e.infoBarIds.indexOf(n)<0&&Object(j.a)(e,n)}var _=n(3463),U=n(24),H=n(8195),z=Object(i.mutatorAction)("updateCLPViewState",(function(e,t){if(e&&t){var n=t.selectedLabel,r=t.nonTenantLabelString;n&&(e.selectedCLPLabel=n,e.originalCLPLabel=n),e.selectedCLPLabel||(e.selectedCLPLabel=Object(H.a)()),e.nonTenantLabelString=r}}));var q=n(9538),G=n(9539),J=n(2065),K=n(4029);var Q=n(2463);function Y(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,i,a,c;return Object(r.f)(this,(function(o){switch(o.label){case 0:return n=t.attachments,i=t.attachmentFilesToUpload,(null==n?void 0:n.length)>0?[4,v.i.import()]:[3,2];case 1:a=o.sent(),c=a(e.composeId,{attachments:n,mailboxInfo:Object(p.d)(),parentItemId:e.itemId||null}),$(e,c),o.label=2;case 2:return(null==i?void 0:i.length)>0&&function(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,i,a,c,o,s,u,l,d;return Object(r.f)(this,(function(b){switch(b.label){case 0:if(!t)return[2];n=[],i=[],b.label=1;case 1:b.trys.push([1,9,10,11]),c=Object(r.k)(t),o=c.next(),b.label=2;case 2:return o.done?[3,8]:(s=o.value).file.fileType!=J.a.Uri?[3,4]:[4,Object(q.a)(e,s.file.name,s.file.uri,s.isInline)];case 3:return b.sent(),[3,7];case 4:return s.file.fileType!=J.a.MailItem?[3,6]:[4,Object(G.a)(e,s.file.name,s.file.itemId,s.isInline)];case 5:return b.sent(),[3,7];case 6:s.file.fileType==J.a.Cloud||s.file.fileType==J.a.CloudSuggestion||s.file.fileType==J.a.ContextualSuggestion?4===s.file.providerType?n.push(s.file):(s.mailboxInfo&&(a=s.mailboxInfo),i.push(s.file)):s.file.fileType!=J.a.AttachmentItem&&s.file.fileType!=J.a.AttachmentItemSuggestion||(s.mailboxInfo&&(a=s.mailboxInfo),i.push(s.file)),b.label=7;case 7:return o=c.next(),[3,2];case 8:return[3,11];case 9:return u=b.sent(),l={error:u},[3,11];case 10:try{o&&!o.done&&(d=c.return)&&d.call(c)}finally{if(l)throw l.error}return[7];case 11:return n.length>0?[4,Object(K.a)(n,e,{isInline:!1,isHiddenInline:!1,shouldShare:!0},null)]:[3,13];case 12:b.sent(),b.label=13;case 13:return i.length>0&&Object(K.a)(i,e,{isInline:!1,isHiddenInline:!1,shouldShare:!1,mailboxInfo:a},null),[2]}}))}))}(e,i).then((function(){(function(e){return null==e?void 0:e.some((function(e){return e.file.fileType==J.a.Uri&&e.isInline}))})(i)&&function(e,t){Object(Q.b)(e,(function(e){e.triggerContentChangedEvent(t||"")}),null)}(e,"Addins")})),[2]}}))}))}var $=Object(i.mutatorAction)("Compose_SetAttachmentWellViewState",(function(e,t){e.attachmentWell=t})),X=n(3403),Z=n(1956),ee=n(8169);var te=n(4428),ne=n(4356),re=n(3700),ie=n(3053),ae=n(6),ce=n(2274),oe=n(2852),se=n(203),ue=n(23),le=n(183),de=Object(le.action)("startSession")((function(e,t){if(e)if(e.hasSessionStarted)ue.g.info(Object(ae.c)("{0} StartSession: failed to start",e.entityScenarioName));else{e.clientSessionId=Object(se.a)();var n={eventType:"SessionStarted",recipientEmailAddresses:t,endSessionAction:null},r=Object(oe.a)(e,n);Object(ce.a)(e,r,!0),e.hasSessionStarted=!0,ue.g.info(Object(ae.c)("{0} StartSession: Session started. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})),be=n(3330),fe=n(2890),me=n(3270),Oe=n(4434),ve=n(6142),pe=n(11542),je=n(2087),he=n(3539),ge=n(7350),Se=n(6515),Ie=n(3480),ye="beforeunload",Ce=!1;function we(e){Object(a.b)().viewStates.forEach((function(t){(Object(Ie.b)(t)||6===t.asyncSendState)&&(e.returnValue=Object(ae.b)(Se.a))}))}var Ae=n(9540);function Te(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n;return Object(r.f)(this,(function(i){switch(i.label){case 0:return Ce||(window.addEventListener(ye,we),Ce=!0),function(e){var t;Object(r.c)(this,void 0,void 0,(function(){var n,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,X.d.import()];case 1:return n=r.sent(),i=Z.u.items.get(null===(t=e.referenceItemId)||void 0===t?void 0:t.Id),n(i,e.composeId,!0,Object(ee.a)(e)),[2]}}))}))}(e),4==e.operation&&(Object(te.a)()&&Object(ne.a)(e,32),Object(re.a)()&&Object(U.i)("cmp-clp-auto-labeling")&&_.g.import().then((function(t){t(e,e.protectionViewState.clpViewState,e.itemId,e.content)}))),t=Object(ie.b)(e),de(e.toRecipientWell.findPeopleFeedbackManager,t),n=Object(be.a)(e.toRecipientWell),Object(fe.a)(e.composeId,n,t),Object(me.a)(e.smimeViewState)&&Object(Oe.b)(e),0===e.operation&&Object(ve.b)()&&Object(Oe.a)(e),Object(pe.a)(Object(je.n)()),e.preferAsyncSend&&he.i.import(),[4,ge.a.importAndExecute()];case 1:return i.sent(),Ae.b.importAndExecute(),[2]}}))}))}var Ee=n(9530),Re=n(9532),Me=n(9476),xe=n(9473),ke=n(9541),De=n(7784),Pe=Object(le.action)("loadComposeInfoBars")((function(e,t){var n,r;Object(Re.a)(e),Object(xe.a)(e),(null===(r=null===(n=e.protectionViewState)||void 0===n?void 0:n.classificationViewState)||void 0===r?void 0:r.messageClassification)&&Object(Me.a)(e),Object(Ee.a)(e),Object(ke.a)(t.unsupportedSmimeAttachmentNames,e),Object(re.a)()||W(e,e.protectionViewState),De.b?De.b.then((function(){V(e,e.protectionViewState)})):V(e,e.protectionViewState)})),Le=n(6141),Fe=n(154),Ne=n(210);var Ve,Be=n(5782),We=n(3614);n.d(t,"a",(function(){return He}));var _e=((Ve={})[0]=function(e,t){return function(e){var t=Object(a.b)(),n=e.originalPrimaryComposeId,r=e.originalInlineComposeId;[n&&t.primaryComposeId!=n&&t.viewStates.get(e.originalPrimaryComposeId),r&&t.viewStates.get(r)].forEach((function(e){e&&Object(Be.a)(e).then((function(){t.viewStates.get(e.composeId)&&Object(We.a)(e,!0,!1)}))}))}(t)},Ve[1]=function(e){return Te(e)},Ve[2]=function(e,t){return Object(Le.a)(e,t)},Ve[3]=function(e,t){return Y(e,t)},Ve[4]=function(e,t){return T(e,t)},Ve[5]=function(){return L()},Ve[6]=function(e){return function(e){var t;return Object(U.i)("cmp-clp")&&(null===(t=e.referenceItemId)||void 0===t?void 0:t.Id)?_.d.importAndExecute(e.referenceItemId.Id).then((function(t){var n=e.protectionViewState.clpViewState;z(n,t);var r=n.selectedCLPLabel;(null==r?void 0:r.isEncryptingLabel)||W(e,e.protectionViewState),V(e,e.protectionViewState)})):null}(e)},Ve[7]=function(e,t){return Pe(e,t)},Ve[8]=function(e,t,n){return Object(o.a)(e,n,t.bypassClientSideValidation).catch((function(e){}))},Ve[9]=function(){Object(Ne.a)("opxComponentLifecycle")&&(Object(Fe.a)().onScenarioLoaderRemoved(),Object(Fe.a)().onPageReady())},Ve[10]=function(e){var t,n;(null==(n=(t=e).protectionViewState.clpViewState.selectedCLPLabel)?void 0:n.isDefault)&&n.isEncryptingLabel&&(t.smimeViewState.shouldEncryptMessageAsSmime||t.smimeViewState.shouldSignMessageAsSmime)&&!Object(ve.a)()&&(Object(Oe.c)(t,!1,!1),Object(j.a)(t,"warningSmimeYieldToCLPDefaultLabel"))},Ve),Ue=Object(i.mutatorAction)("setPostOpenTaskExecuted",(function(e){e.executed=!0}));function He(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,i,c,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:n=e.postOpenTasks.filter((function(e){return!e.executed})),i=Object(a.b)(),c=0,r.label=1;case 1:return c<n.length&&i.viewStates.has(e.composeId)?(o=n[c],Ue(o),[4,_e[o.type](e,o,t)]):[3,4];case 2:r.sent(),r.label=3;case 3:return c++,[3,1];case 4:return[2]}}))}))}Object(i.orchestrator)(c.a,(function(e){var t=e.viewState;0!=e.event||Object(U.i)("mail-popout-projection")||He(t,window)}))},1081:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return u}));var r=n(31),i=n(1264);n.d(t,"a",(function(){return i.a}));var a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(21),n.e(24),n.e(106),n.e(740)]).then(n.bind(null,1877))})),c=Object(r.d)(a,(function(e){return e.NotificationBarHost})),o=new r.a(a,(function(e){return e.showNotification})),s=new r.a(a,(function(e){return e.dismissNotification})),u=new r.b(a,(function(e){return e.clearNotificationBar}))},11542:function(e,t,n){"use strict";var r=n(2981),i=n(2);t.a=Object(i.mutatorAction)("setIsSxSDisplayed",(function(e){r.a.isSxSDisplayed=e}))},11543:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(6609),i=n(4871),a=n(4876);function c(e,t){var n="HTML"==t?Object(r.b)():"\n";return e&&(e=Object(a.a)(e,t),n=n+Object(i.a)(t)+e),n}},11544:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1),i=n(5781),a=n(6797),c=n(19),o=n(4218),s=n(24);function u(e,t,n,u){var l;return Object(r.c)(this,void 0,void 0,(function(){var d,b,f,m;return Object(r.f)(this,(function(r){switch(r.label){case 0:d=Object(c.a)().UserOptions.TimeFormat,b=(null===(l=e.NewBodyContent)||void 0===l?void 0:l.BodyType)||Object(o.c)(),e.ShouldIgnoreChangeKey=!!Object(s.i)("mon-cmp-experimentalGraphQLCompose")||void 0,r.label=1;case 1:return r.trys.push([1,6,,7]),t?[4,Object(a.a)(t,e,b,!1,d)]:[3,3];case 2:return f=r.sent(),[3,5];case 3:return[4,Object(i.a)(e,b,!1,d,!1,null,null,u,n)];case 4:f=r.sent(),r.label=5;case 5:return[2,"Success"===(m=f.ResponseMessages.Items[0]).ResponseClass?m.Items[0]:null];case 6:return r.sent(),[2,null];case 7:return[2]}}))}))}},1264:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.PrimaryActionClicked=0]="PrimaryActionClicked",e[e.SecondaryActionClicked=1]="SecondaryActionClicked",e[e.DismissClicked=2]="DismissClicked",e[e.AutoDismissed=3]="AutoDismissed",e[e.MouseLeaveAfterTimerCompleted=4]="MouseLeaveAfterTimerCompleted",e[e.NotificationBarUnmounted=5]="NotificationBarUnmounted"}(r||(r={}))},14137:function(e){e.exports=JSON.parse('{"a":"Bab"}')},14139:function(e){e.exports=JSON.parse('{"d":"J6a","b":"K6a","a":"L6a","c":"M6a"}')},2009:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1993);function i(e){var t=Object(r.a)().groups.get(e.toLowerCase());return t?t.groupDetails:null}},2012:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),i=Object(r.createStore)("maillayout",{clientReadingPanePosition:null,showReadingPane:!1,showListPane:!0,showFolderPane:!0,senderColumnWidth:null,subjectColumnWidth:null,receivedColumnWidth:null})},2022:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.Init=1]="Init",e[e.LeftNavResizeExpand=2]="LeftNavResizeExpand",e[e.ToggleExpand=3]="ToggleExpand",e[e.ToggleCollapse=4]="ToggleCollapse",e[e.WindowResize=5]="WindowResize",e[e.ToggleFolderPane=6]="ToggleFolderPane",e[e.DateRangeTypeChange=7]="DateRangeTypeChange",e[e.CalendarViewTypeChange=8]="CalendarViewTypeChange",e[e.OwaSuiteHeaderFlexPane=9]="OwaSuiteHeaderFlexPane"}(r||(r={}));var i=r,a=n(2),c=Object(a.createStore)("OwaLayout",{browserWidthBucket:null,areDisplayAdsEnabled:!1}),o=Object(a.mutatorAction)("setBrowserWidthBucket",(function(e){c().browserWidthBucket=e})),s=n(4);function u(e,t,n){var r=Object(s.o)(e);return t&&(r>1900?r-=305:r>990&&(r-=165)),n&&(r-=320),r>=1600?1600:r>=1400?1599:r>=1366?1399:r>=1301?1365:r>=1239?1300:r>=1200?1238:r>=1080?1199:r>=1e3?1079:r>=919?999:r>=900?918:r>=866?899:r>=769?865:r>=692?768:r>=686?691:r>=580?685:r>=555?579:r>=542?554:r>=500?541:r>=419?499:418}var l=Object(a.action)("onAvailableWidthBucketChanged",(function(e,t){return{availableWidthBucket:e,source:t}})),d=Object(a.mutatorAction)("setAreDisplayAdsEnabled",(function(e){c().areDisplayAdsEnabled=e}));function b(){return c().areDisplayAdsEnabled}var f=n(2086);function m(e){window.addEventListener("resize",O),d(e),v(i.Init)}function O(){v(i.WindowResize)}function v(e){var t=u(e!=i.Init,b(),Object(f.a)());c().browserWidthBucket!=t&&(o(t),t<=418?p():j(),l(t,e))}function p(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflowX="auto")}function j(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflow="hidden")}var h=n(67);function g(){return S()}function S(){return Object(h.l)()||Object(h.d)()}function I(){var e=c().browserWidthBucket;return e||void 0}Object(a.orchestrator)(f.d,(function(e){var t=u(!1,b(),e.isShown);o(t),l(t,i.OwaSuiteHeaderFlexPane)})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"e",(function(){return j})),n.d(t,"d",(function(){return g})),n.d(t,"g",(function(){return S})),n.d(t,"h",(function(){return l})),n.d(t,"c",(function(){return I}))},2140:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(94);function i(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},2178:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return c}));var r=350,i=270,a=418,c=48},2223:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2391);function i(e){return e&&Object(r.b)(e.ItemClass)}},2253:function(e,t,n){"use strict";var r=n(2004);function i(){var e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var a=n(2140),c=n(2110);function o(){return i()}function s(e){return(e&&e.length>0&&function(e){return e.some((function(e){return!((t=e).IsInline&&!Object(c.a)(t));var t}))}(e)?i():[]).map(a.a)}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}))},2308:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}));var r=20,i=10,a=100},2338:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"h",(function(){return c})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return l}));var r=228,i=198,a=320,c=370,o=574,s=800,u=350,l=150},2375:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2012);function i(){return Object(r.a)().showFolderPane}},2449:function(e,t,n){"use strict";var r=n(31),i=n(2560),a=n(1956),c=n(183),o=Object(c.action)("setIsPendingDeleteConversationItemParts")((function(e,t,n){void 0===n&&(n={conversationItemParts:a.u.conversations.get(e)});var r=n.conversationItemParts;r&&(r.isPendingDelete=t)})),s=n(2308);n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return b})),n.d(t,"c",(function(){return i.a})),n.d(t,"g",(function(){return o})),n.d(t,"a",(function(){return s.b})),n.d(t,"b",(function(){return s.c}));var u=new r.c((function(){return Promise.all([n.e(15),n.e(17),n.e(16),n.e(286),n.e(722)]).then(n.bind(null,18252))})),l=new r.a(u,(function(e){return e.loadAllRecipientsForItem})),d=new r.a(u,(function(e){return e.loadItem})),b=new r.a(u,(function(e){return e.loadConversation}))},2458:function(e){e.exports=JSON.parse('{"a":"Cda"}')},2487:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(function(e,t){return{itemIdToRemove:e,removeItemSource:t}}))},2495:function(e,t,n){"use strict";var r=n(31),i=[0,1],a=n(2505),c=n(2458),o=n(6),s=n(94),u=n(2029);function l(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:u.c.Compose,rank:u.b.Error,message:Object(o.b)(c.a),messageParts:[Object(o.b)(c.a),d()],color:u.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:u.c.Compose,rank:u.b.Error,message:Object(o.b)(a.b),messageParts:[Object(o.b)(a.b),d()],color:u.a.Red};default:return Object(s.a)(e)}}function d(){return{text:Object(o.b)(a.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var b=n(2253),f=n(2140),m=n(1),O=n(24),v=n(2004);function p(){var e=Object(v.a)();if(Object(O.i)("fwk-devTools")){if(Object(O.i)("doc-attachment-CA-readOnlyAccessIssues"))return Object(m.a)(Object(m.a)({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(O.i)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(m.a)(Object(m.a)({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function j(){var e=p();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return g})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return b.a})),n.d(t,"e",(function(){return f.a})),n.d(t,"d",(function(){return j})),n.d(t,"c",(function(){return p}));var h=new r.c((function(){return n.e(1708).then(n.bind(null,18005))})),g=new r.b(h,(function(e){return e.getAccessIssuesForAttachments}))},2505:function(e){e.exports=JSON.parse('{"a":"Ada","b":"Bda"}')},2511:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),i=Object(r.action)("USERMAIL_INTERACTION",(function(e,t,n){return{interactionType:e,instrumentationContexts:t,triageContext:n}}))},2560:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),i=n(1956),a=n(2487),c=n(3036),o=n(2);function s(e){var t,n,o,s;if(i.u.conversations.has(e)){var d=i.u.conversations.get(e);try{for(var b=Object(r.k)(d.conversationNodeIds),f=b.next();!f.done;f=b.next()){var m=f.value,O=i.u.conversationNodes.get(m);if(O)try{for(var v=(o=void 0,Object(r.k)(O.itemIds)),p=v.next();!p.done;p=v.next()){var j=p.value;Object(a.a)(j,1)}}catch(e){o={error:e}}finally{try{p&&!p.done&&(s=v.return)&&s.call(v)}finally{if(o)throw o.error}}u(m)}}catch(e){t={error:e}}finally{try{f&&!f.done&&(n=b.return)&&n.call(b)}finally{if(t)throw t.error}}l(e)}Object(c.a)()}var u=Object(o.mutatorAction)("deleteConversationNode",(function(e){i.u.conversationNodes.delete(e)})),l=Object(o.mutatorAction)("deleteConversation",(function(e){i.u.conversations.delete(e)}))},2614:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.createStore)("headerToastNotificationViewState",{notificationViewStates:[]})()},2615:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}));var r="Calling",i="UnreadMessage",a="Summary"},2650:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(2338),i=n(2178),a=n(2022),c=n(4),o=n(2375),s=n(24);function u(){var e=Object(a.c)();return e<=999?198:e<=1199?236:e<=1399?254:e<=1599?300:e<=1600?320:r.b}function l(){return Object(s.i)("mon-tri-slvWithRightReadingPane")?Math.max(r.g,Object(c.o)(!0)-(Object(o.a)()?u():0)-r.h-i.c):(e=Object(a.c)())<=999?350:e<=1199?380:e<=1399?452:e<=1599?540:e<=1600?574:r.d;var e}},2677:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(19),i=n(23),a=n(2178),c=n(2338),o=n(2650);function s(){var e=a.b,t=a.a,n=Object(r.a)().ViewStateConfiguration.GlobalFolderViewState;if(n)try{var s=JSON.parse(n),u=s.Width,l=s.Height;e=u||e,t=l||t}catch(e){i.g.warn("GetListViewDimensions: De-serialize globalFolderViewState failed: "+e.Message)}return{listViewWidth:e=Math.min(Object(o.b)(),Math.max(e,c.g)),listViewHeight:t=Math.min(c.c,Math.max(t,c.f))}}},2753:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(2),i=n(2922),a={installationStatus:0,isBrowserSupportActiveX:Object(i.a)(),version:""},c=Object(r.createStore)("SmimeStore",a),o=c();t.a=o},2819:function(e,t,n){"use strict";var r=n(183),i=n(2614);t.a=Object(r.action)("removeNotification")((function(e){var t=i.a.notificationViewStates.indexOf(e);t>=0&&i.a.notificationViewStates.splice(t,1)}))},2861:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),i=n(2043),a=n(1962),c=n(2119),o=n(94);function s(e,t,n,s){var b,f;void 0===t&&(t=0);var m=function(e){switch(e){case 0:return u;case 1:return l;case 2:return d;default:return Object(o.a)(e)}}(t),O=Object(c.b)();try{for(var v=Object(r.k)(Object(a.a)().tabs),p=v.next();!p.done;p=v.next()){var j=p.value;if(j.type==i.a.MailCompose&&0==j.state){var h=O.viewStates.get(j.data);if((null==h?void 0:h.isInlineCompose)&&m(h,e)&&(0==h.asyncSendState||n&&6==h.asyncSendState)&&(!s&&!j.projectionRPTabId||j.projectionRPTabId==s))return h}}}catch(e){b={error:e}}finally{try{p&&!p.done&&(f=v.return)&&f.call(v)}finally{if(b)throw b.error}}return null}function u(e,t){return e.conversationId===t}function l(e,t){return e.referenceItemId.Id===t}function d(e,t){return!1}},2876:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.AsyncSendFailed=0]="AsyncSendFailed",e[e.AddFavoritePersonaFailedNotification=1]="AddFavoritePersonaFailedNotification",e[e.RemoveFavoritePersonaFailedNotification=2]="RemoveFavoritePersonaFailedNotification",e[e.PeopleHubNotification=3]="PeopleHubNotification",e[e.SkypeNotification=4]="SkypeNotification",e[e.SkypeForBusinessNotification=5]="SkypeForBusinessNotification"}(r||(r={}))},3036:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(2),i=Object(r.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),a=Object(r.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},3038:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(31),i=new r.c((function(){return n.e(909).then(n.bind(null,5746))})),a=new r.b(i,(function(e){return e.SmimeAdapter}))},3162:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2753);function i(){var e=Object(r.b)();return 9==e.installationStatus||6==e.installationStatus}},3178:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"g",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return b})),n.d(t,"h",(function(){return a}));var r=n(31),i=n(2982);n.d(t,"i",(function(){return i.a}));var a=new r.c((function(){return Promise.all([n.e(169),n.e(228),n.e(536)]).then(n.bind(null,5771))})),c=new r.b(a,(function(e){return e.getHasSharingIssues})),o=new r.b(a,(function(e){return e.getSharingLinkCountInBody})),s=new r.b(a,(function(e){return e.getPendingAttachmentString})),u=new r.b(a,(function(e){return e.getSharingIssuesString})),l=new r.b(a,(function(e){return e.getPendingPermissionErrorCode})),d=Object(r.d)(a,(function(e){return e.PendingPermissionsDialog})),b=Object(r.d)(a,(function(e){return e.SharingIssueBlockDialog}))},3230:function(e,t,n){"use strict";var r=n(1),i=n(183),a=n(2614),c=0;t.a=Object(i.action)("addNotification")((function(e){var t=Object(r.a)({id:c++},e);a.a.notificationViewStates.push(t)}))},3231:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var r=n(2876),i=n(2819),a={};function c(e,t){var n=r.a[e];a[n]||(a[n]=t)}function o(e){var t=a[r.a[e.actionType]];t&&t(e),Object(i.a)(e)}},3249:function(e,t,n){"use strict";var r=n(3452);t.a=function(e){var t=function(e){var t;return(null===(t=null==e?void 0:e.Attachments)||void 0===t?void 0:t.length)&&e.Attachments[0]}(e);return Object(r.a)(t)?t:null}},3332:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="Addins"},3352:function(e,t,n){"use strict";n.r(t);var r=n(2),i=n(4434),a=(Object(r.mutator)(i.d,(function(e){var t=e.viewState,n=e.shouldEncryptMessageAsSmime,r=e.shouldSignMessageAsSmime,i=t.smimeViewState;i&&(i.shouldEncryptMessageAsSmime=n,i.shouldSignMessageAsSmime=r,t.isDirty=!0)})),Object(r.mutator)(i.e,(function(e){e.viewState.itemId=null})),n(4255)),c=n(2119);Object(r.mutator)(a.a,(function(e){return t=e.isDarkModeEnabled,void Object(c.b)().viewStates.forEach((function(e){e.isDarkMode=t}));var t}));var o,s=n(1),u=n(9475),l=n(19),d=n(197),b=n(2603),f=n(2722),m=n(2223),O=n(6142),v=function(e,t,n){return Object(s.c)(void 0,void 0,void 0,(function(){return Object(s.f)(this,(function(r){switch(r.label){case 0:return function(e,t){return Object(f.i)()&&!Object(d.a)()&&!Object(l.a)().UserOptions.AlwaysShowFrom&&Object(u.a)(e,t)&&(Object(O.b)()||Object(m.a)(t))}(e,t)?4!==e?[3,2]:[4,b.h.import()]:[3,4];case 1:return[2,r.sent()(n)];case 2:return[4,b.g.import()];case 3:return[2,r.sent()(t)];case 4:return[2,null]}}))}))},p=n(3270),j=n(9530),h=n(8193),g=(Object(r.orchestrator)(i.a,(function(e){return Object(s.c)(void 0,void 0,void 0,(function(){var t,n;return Object(s.f)(this,(function(r){switch(r.label){case 0:return t=e.composeViewState,[4,v(t.operation)];case 1:return n=r.sent(),Object(p.a)(n)&&Object(i.c)(t,n.shouldEncryptMessageAsSmime,n.shouldSignMessageAsSmime),(null==n?void 0:n.errorCode)&&(Object(h.a)(t.smimeViewState,n.errorCode,0),Object(j.a)(t)),[2]}}))}))})),n(4029)),S=n(6014),I=n(94);function y(e,t){for(var n=function(e){switch(e){case o.Compose:return A;case o.Attachment:return w;case o.Link:return C;case o.ComposeItem:return T;default:return Object(I.a)(e)}}(t),r=Object(c.b)(),i=Object(s.j)([],Object(s.g)(r.viewStates.values())),a=0;a<i.length;a++)if(i[a]&&n(i[a],e))return i[a];return null}function C(e,t){return-1!==e.attachmentWell.sharingLinkIds.indexOf(t)}function w(e,t){return Object(S.a)(e).some((function(e){return e.Id===t.Id}))}function A(e,t){return e.composeId===t}function T(e,t){var n=!!e.itemId.Id&&!!t.Id,r=e.itemId.Id===t.Id;return n&&r}!function(e){e[e.Compose=0]="Compose",e[e.Attachment=1]="Attachment",e[e.Link=2]="Link",e[e.ComposeItem=3]="ComposeItem"}(o||(o={}));var E,R=n(121),M=n(2155);Object(r.orchestrator)(M.e,(function(e){return Object(s.c)(void 0,void 0,void 0,(function(){var t,n,r,i;return Object(s.f)(this,(function(a){switch(a.label){case 0:return t=y(e.linkId,o.Link),n=Object(M.l)(e.linkId),t&&n?Object(p.a)(t.smimeViewState)?[3,3]:E?[3,2]:[4,M.x.import()]:[3,5];case 1:E=a.sent(),a.label=2;case 2:E(e.linkId,M.b.attachingAsACopy),a.label=3;case 3:return[4,M.r.import()];case 4:r=a.sent(),i=r(n,e.providerId),Object(g.a)([i],t,{isInline:!1,isHiddenInline:!1,shouldShare:!1,downsellFromLink:!0},null,(function(t,n,r){return i=e.linkId,a=e.isTryAgain,c=e.targetWindow,Object(R.s)("linkAttachAsACopySuccess",{isTryAgain:a}),void setTimeout((function(){var e=Object(M.l)(i);e&&e.linkActionStatus===M.b.attachingAsACopy&&Object(M.g)(i,c)}),100);var i,a,c}),(function(t){return function(e,t,n){E(e,M.b.none),t?Object(R.s)("linkAttachAsACopyCanceled",{isTryAGain:n,isCalendar:!1}):Object(R.s)("linkAttachAsACopyFailed",{isTryAgain:n,isCalendar:!1})}(e.linkId,t,e.isTryAgain)}),(function(){Object(R.s)("LinkAttachAsCopyTriedAgain"),Object(M.e)(e.linkId,e.providerId,!0,e.targetWindow)})),a.label=5;case 5:return[2]}}))}))}));var x=n(2151),k=(Object(r.orchestrator)(j.a,(function(e){var t=e.viewState;if(t.smimeViewState&&0!=t.smimeViewState.errorCode){var n=t.smimeViewState.errorCode;Object(x.a)(t,93==n?"smimeAdapterInitializationError":"smimeEncodeError")}})),n(24)),D=n(2720),P=n(2087),L=n(514);function F(e){var t=Object(P.k)(e),n=Object(D.a)(t),r=!Object(L.w)();return n?3:Object(k.i)("mail-popout-projection")&&e&&e!=window?4:r?1:0}var N=n(4217),V=n(9531),B=(Object(r.orchestrator)(V.a,(function(e){var t=e.composeId,n=e.isSend,r=e.smimeType,i=e.error,a=y(t,o.Compose),c=!!i,u=c?i.errorCode:null,l=c?i.errorContext:null,d=c?i.message:null,b=c?i.stack:null;if(a){var f=a.operation,m=a.attachmentWell,O=m.docViewAttachments,v=m.inlineAttachments,p=F(),j=Object(L.w)(),h=void 0;(h=O.slice(0)).push.apply(h,Object(s.j)([],Object(s.g)(v)));var g=Object(N.a)(h.length);Object(R.s)("SmimeSendSaveActionDatapoint",{isSend:n,smimeType:r,composeTarget:p,isPopout:j,operation:f,attachmentCount:g,isError:c,errorCode:u,errorContext:l,errorMessage:d,errorStack:b},{isCore:!0})}else Object(R.s)("SmimeSendSaveActionDatapoint",{isSend:n,smimeType:r,isError:c,errorCode:u,errorContext:l,errorMessage:d,errorStack:b},{isCore:!0})})),n(9532)),W=n(2018),_=n(1996),U=n(3177),H=n(2359);function z(e,t,n){return Object(s.c)(this,void 0,void 0,(function(){var r,i,a,c,o,u;return Object(s.f)(this,(function(s){switch(s.label){case 0:return r=null,i=void 0,[4,U.c.import()];case 1:return a=s.sent(),t===W.d.Added?(c=Object(_.a)(n.AttachmentId),Object(H.b)(c.model)&&(i=c.model.AttachLongPathName),(null==c?void 0:c.model)&&(r={id:n.AttachmentId.Id,name:c.model.Name,contentType:c.model.ContentType,size:c.model.Size,attachmentType:a(c.model),isInline:c.model.IsInline,url:i})):t===W.d.Deleted&&(Object(H.b)(n)&&(i=n.AttachLongPathName),r={id:n.AttachmentId.Id,name:n.Name,contentType:n.ContentType,size:n.Size,attachmentType:a(n),isInline:n.IsInline,url:i}),[4,W.N.import()];case 2:return s.sent()(e,t,r),Object(k.i)("addin-autoRun")&&Object(k.i)("addin-autoRun-attachmentsChangedEvent")&&(o=Object(W.n)(e),u=t===W.d.Added?"added":t===W.d.Deleted?"removed":null,W.G.importAndExecute(o,3,{type:"olkAttachmentsChanged",attachmentStatus:u,attachmentDetails:r})),[2]}}))}))}var q=n(2128);Object(r.orchestrator)(q.v,(function(e){var t=y(e.attachmentId,o.Attachment);t&&(Object(B.a)(t),e.shouldTriggerAddInAttachmentsChangedCallback&&z(t.composeId,W.d.Added,e.attachment))}));var G=n(2211),J=n(5553),K=n(2495),Q=n(7198),Y=n(2806);Object(r.orchestrator)(q.w,(function(e){var t=y(e.parentItemId,o.ComposeItem);if(t){var n=K.a.map(K.e);if(Object(G.a)(t,n),Object(B.a)(t),Object(J.a)(t),e.attachment.IsInline){var r="cid:"+e.attachment.ContentId;Object(Q.a)(t,'img[originalsrc^="'+r+'"]'),Object(Y.a)(t)}e.shouldTriggerAddInAttachmentsChangedCallback&&z(t.composeId,W.d.Deleted,e.attachment)}}));var $=n(14137),X=n(6),Z=Object(r.action)("onEditDraftButtonClicked",(function(e,t){return{itemId:e,sxsId:t}})),ee=n(731),te=n(1956),ne=n(3038),re=n(3162),ie=n(6150);var ae=n(4218),ce=n(3414),oe=n(2045),se=n(4427),ue=n(2339),le=n(7804),de=n(3269),be=function(e){return Object(s.c)(void 0,void 0,void 0,(function(){var t;return Object(s.f)(this,(function(n){switch(n.label){case 0:return t=new Headers,Object(m.a)(e)?[4,ne.a.import()]:[3,2];case 1:n.sent(),Object(re.a)()&&t.set(de.c,de.d),n.label=2;case 2:return[2,t]}}))}))},fe=n(2043),me=n(23),Oe=n(183),ve=n(3700),pe=n(7420),je=n(1955),he=n(57),ge=n(1951);function Se(e){var t=ye(e);if(!t)return null;var n=Object(ge.n)().get(t);return n?n.principalSMTPAddress:null}function Ie(e){var t=ye(e);if(!t)return null;var n=Object(he.l)();return Object(te.h)(t,n)}function ye(e){var t;if(!e)return null;var n=Object(je.b)().items.get(e.Id);return null===(t=null==n?void 0:n.ParentFolderId)||void 0===t?void 0:t.Id}var Ce=n(6554);function we(e){return Object(s.c)(this,void 0,void 0,(function(){var t,n,r,i,a;return Object(s.f)(this,(function(c){switch(c.label){case 0:return t=te.u.items.get(e),[4,be(t)];case 1:return n=c.sent(),r=Object(se.a)(null),[4,Object(oe.a)(e,r,"MailCompose",null,void 0,{headers:n})];case 2:return!(i=c.sent())||i instanceof Error?[3,4]:Object(le.a)(i)?[4,be(i)]:[3,4];case 3:return a=c.sent(),[2,Object(oe.a)(e,r,"MailCompose",null,void 0,{headers:a})];case 4:return[2,i]}}))}))}function Ae(e){return b.o.import().then((function(t){return t(e)}))}var Te=Object(Oe.action)("loadDraftToCompose")((function(e,t,n,r){return void 0===n&&(n=1),Object(s.c)(this,void 0,void 0,(function(){var i,a,o,u,l,d,b,f,O,p,j,h,g,S;return Object(s.f)(this,(function(I){switch(I.label){case 0:return t=t||Object(P.k)(window),a=(i=r||{}).isNdrResend,o=i.forceInsertSignatureOperation,2==n||(Object(P.n)(t)?n=3:(Object(L.w)()||1!==n)&&(n=0)),0!=n&&1!==n?[3,2]:(u=function(e){var t,n=Object(c.b)();if(n.viewStates.forEach((function(n){n.itemId&&n.itemId.Id==e&&(t=n)})),t){var r=Object(fe.e)().tabs,i=t.composeId;return i==n.primaryComposeId?fe.l:t.isInlineCompose?r.filter((function(e){return e.type==fe.a.SecondaryReadingPane&&e.data.id&&(0==e.data.listViewType&&e.data.id.Id==t.conversationId||1==e.data.listViewType&&e.data.id.Id==t.referenceItemId.Id)}))[0]:r.filter((function(e){return e.type==fe.a.MailCompose&&e.data==i}))[0]}return null}(e))?[4,fe.g.importAndExecute(u)]:[3,2];case 1:return I.sent(),[2];case 2:return I.trys.push([2,8,,9]),[4,we(e)];case 3:return!(l=I.sent())||l instanceof Error?[3,7]:(d=l,b=0,Object(m.a)(d)?[4,Ae(d)]:[3,5]);case 4:b=I.sent(),I.label=5;case 5:return f=d.Body.BodyType==ae.a?"HTML":"Text",!1,O=function(e){var t=ye(e);return!!t&&Object(ge.C)(t,"SharedMailbox")}(d.ItemId),p=d.ConversationId?d.ConversationId.Id:void 0,j="",Object(ve.a)()&&(j=Object(pe.a)(d)),d.Attachments&&d.Attachments.forEach((function(t){t.AttachmentId.RootItemId=e})),S={operation:4,forceInsertSignatureOperation:o,bodyType:f,itemId:d.ItemId,subject:d.Subject,newContent:d.Body.Value,to:a&&d.ToRecipients?(y=d.ToRecipients,y.filter((function(e){return!e.Submitted}))):d.ToRecipients,cc:d.CcRecipients,bcc:d.BccRecipients,attachments:d.Attachments,importance:d.Importance,isReadReceiptRequested:d.IsReadReceiptRequested,isDeliveryReceiptRequested:d.IsDeliveryReceiptRequested,preferAsyncSend:!0,from:null!=d.From?d.From.Mailbox:null,pendingSocialActivityTags:d.PendingSocialActivityTagIds,IRMData:Object(ce.a)()?d.RightsManagementLicenseData:null,meetingRequestItem:null!=Object(ue.a)(d.ItemClass)?Object(s.a)({},d):null,sensitivity:d.Sensitivity,isInlineCompose:!1,conversationId:p},[4,v(4,d,b)];case 6:S.smimeViewState=I.sent(),S.existingLabelString=j,S.appendOnSend=Object(Ce.b)(d),S.draftComposeType=Object(Ce.c)(d),h=S,O&&(h=Object(s.a)(Object(s.a)({},h),{isInSharedFolder:!0,folderOwnerEmailAddress:Se(d.ItemId),folderPermission:Ie(d.ItemId)})),3===n?Object(ie.a)(h,n,t):Object(ie.a)(h,n),I.label=7;case 7:return[3,9];case 8:return g=I.sent(),me.g.info("[loadDraftToCompose] "+g.message),[3,9];case 9:return[2]}var y}))}))}));Object(r.orchestrator)(Z,(function(e){return Object(s.c)(void 0,void 0,void 0,(function(){var t,n,r;return Object(s.f)(this,(function(i){switch(i.label){case 0:return t=e.itemId,n=e.sxsId,r=te.u.items.get(t),Object(m.a)(r)?[4,ne.a.import()]:[3,2];case 1:if(i.sent(),!Object(re.a)())return Object(ee.b)(null,Object(X.b)($.a),!1,{hideCancelButton:!0}),[2];i.label=2;case 2:return Te(t,n),[2]}}))}))}));var Ee=n(3587),Re=n(3054),Me=n(5112);Object(r.orchestrator)(Ee.c,(function(e){return Object(s.c)(void 0,void 0,void 0,(function(){var t,n;return Object(s.f)(this,(function(r){switch(r.label){case 0:return(t=y(e.composeId,o.Compose))?[4,Object(Me.a)(t)]:[2];case 1:return n=r.sent(),Re.c.importAndExecute(t.attachmentWell.sharingLinkIds,n,t.composeId,!1),Object(J.a)(t),[2]}}))}))}));var xe=n(9534),ke=n(3053),De=n(3696),Pe=n(6608),Le=(Object(r.orchestrator)(xe.a,(function(e){var t=e.viewState,n=e.recipients,r=Object(ke.c)(t);Object(De.a)(n,r),t.showCompactRecipientWell&&Object(Pe.a)(t)})),n(6621)),Fe=n(9535),Ne=n(6151),Ve=n(4466),Be=n(6842),We=n(209),_e=n(439);Object(r.orchestrator)(i.b,(function(e){return Object(s.c)(void 0,void 0,void 0,(function(){var t,n,r,i,a;return Object(s.f)(this,(function(c){switch(c.label){case 0:return t=e.composeViewState,[4,q.h.import()];case 1:if(n=c.sent()(t.attachmentWell,t.content,t.bodyType,!1),t.isInlineCompose&&Object(Fe.a)(t,window),!n.length)return[2];c.label=2;case 2:return c.trys.push([2,5,,6]),[4,b.j.import()];case 3:return c.sent()(t.attachmentWell,n),[4,b.d.import()];case 4:return r=c.sent(),i=t.itemId||Object(_e.a)({Id:t.composeId}),r(t.attachmentWell,Object(s.a)(Object(s.a)({},i),{mailboxInfo:Object(We.d)()}),t,n,(function(e){return function(e,t){return Object(s.c)(this,void 0,void 0,(function(){var n,r;return Object(s.f)(this,(function(i){switch(i.label){case 0:if(n=e.AttachmentId,!Object(Ne.a)(e,t.itemId))return[2];Object(Ve.a)(n),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Be.b.invokeDeleteAttachmentFromDraftMutation(n)];case 2:return i.sent(),me.g.info("Attachment deleted successfully on toggle of S/MIME mode"),[3,4];case 3:return r=i.sent(),me.d("SmimeTraceError: "+r.message),Object(x.a)(t,"WarningAttachmentCanNotBeDeleted",[Object(X.c)(Object(X.b)(Le.a),e.Name)]),[3,4];case 4:return[2]}}))}))}(e,t)})),[3,6];case 5:return a=c.sent(),me.d("SmimeTraceError: onSmimeModeEnabled failed"+a.message),[3,6];case 6:return[2]}}))}))}));var Ue=n(2805),He=n(4709),ze=n(3492),qe=n(5644),Ge=n(9536),Je=n(8196);var Ke=n(3249),Qe=n(3853),Ye=n(2212),$e=n(2070),Xe=n(2065),Ze=".eml";function et(e){return Object(s.c)(this,void 0,void 0,(function(){return Object(s.f)(this,(function(t){switch(t.label){case 0:return Object(G.a)(e,it),e.itemId?[4,tt(e)]:[3,2];case 1:return t.sent(),function(e){var t=this;Object(s.j)(Object(s.j)([],Object(s.g)(e.attachmentWell.docViewAttachments)),Object(s.g)(e.attachmentWell.inlineAttachments)).forEach((function(n){return Object(s.c)(t,void 0,void 0,(function(){var t,r,i,a,c,o;return Object(s.f)(this,(function(u){if(t=n.attachmentId.Id,(r=Object(_.a)(n.attachmentId))&&Object($e.c)(t)){if(!(i=r.model))return me.d("SmimeTraceError: Attachment not found in moveAttachmentsFromClientToServer"),[2];a=Object(Ye.a)(i),c=void 0,2===a?c=Object(Xe.h)(i.Name,Object(Je.a)(i.MimeContent),i.Size):(d=(l=i).Name,b=l.ContentType,f=l.MimeContent,m=l.Content,O=f?d+Ze:d,v=f?Object(Je.a)(f):m,o=function(e,t){if(!e)return null;var n=e;return n.name=t,n.lastModified=new Date,n}(Object(Ge.a)(v,b),O),c=Object(Xe.g)([o])),Object(ze.a)(e.attachmentWell,n),Object(He.a)(n)?Object(g.a)(c,e,{isInline:!0,isHiddenInline:!1,shouldShare:!1,skipProcessInlineImage:!0},null,(function(t,n,r){return function(e,t,n,r){return Object(s.c)(this,void 0,void 0,(function(){return Object(s.f)(this,(function(e){switch(e.label){case 0:return[4,Qe.e.import()];case 1:return[4,e.sent()(r,n,t.ContentId)];case 2:return e.sent()&&Object(Y.a)(r),[2]}}))}))}(0,r,i.ContentId,e)})):Object(g.a)(c,e,{isInline:!1,isHiddenInline:!0,shouldShare:!1})}var l,d,b,f,m,O,v;return[2]}))}))}))}(e),[3,5];case 2:return[4,Object(Ue.f)(e)];case 3:return t.sent()?[3,5]:[4,Object(Ue.b)(e)];case 4:t.sent(),t.label=5;case 5:return[2]}}))}))}function tt(e){return Object(s.c)(this,void 0,void 0,(function(){var t,n,r,i,a,c,o,u,l;return Object(s.f)(this,(function(s){switch(s.label){case 0:t=e.itemId,n=Object(se.a)(e.bodyType),s.label=1;case 1:return s.trys.push([1,5,,6]),(r=new Headers).set(de.c,de.d),i={headers:r},[4,Object(oe.a)(t.Id,n,"MailCompose",null,void 0,i)];case 2:return!(a=s.sent())||a instanceof Error?[3,4]:(c=Object(Ke.a)(a),a&&c&&c.AttachmentId?(o={Id:c.AttachmentId.Id},[4,Be.b.invokeDeleteAttachmentFromDraftMutation(o,i)]):[3,4]);case 3:u=s.sent(),Object(qe.a)(t,u.RootItemId.RootItemChangeKey),s.label=4;case 4:return[3,6];case 5:return l=s.sent(),me.d("SmimeTraceError: "+l.message),Object(x.a)(e,"WarningAttachmentCanNotBeDeleted",[Object(X.c)(Object(X.b)(Le.a),"smime.p7m")]),[3,6];case 6:return[2]}}))}))}var nt=n(4030),rt=n(2753),it="smimeAdapterInitializationError";Object(r.orchestrator)(i.c,(function(e){return Object(s.c)(void 0,void 0,void 0,(function(){var t,n,r,a,c,o,u,l,d,b,m,O,v,p,j;return Object(s.f)(this,(function(s){switch(s.label){case 0:return t=e.viewState,n=e.shouldEncryptMessageAsSmime,r=e.shouldSignMessageAsSmime,a=t.operation,c=t.smimeViewState,o=Object(L.w)(),function(e,t,n){if(e){var r=e.shouldEncryptMessageAsSmime,i=e.shouldSignMessageAsSmime;return r!=t||i!=n}return!1}(c,n,r)?(Object(nt.a)(t),Object(G.a)(t,"warningSmimeYieldToCLPDefaultLabel"),u=!n&&!r,l=!c.shouldEncryptMessageAsSmime&&!c.shouldSignMessageAsSmime,d=F(),b=Object(f.h)(c.shouldSignMessageAsSmime,c.shouldEncryptMessageAsSmime),m=t.attachmentWell,O=m.docViewAttachments,v=m.imageViewAttachments,p=m.inlineAttachments,j=Object(N.a)(O.length+v.length+p.length),(l||u)&&Object(R.s)("SmimeToggleActionDatapoint",{smimeType:b,isSmimeModeEnabled:l,isSmimeModeDisabled:u,operation:a,composeTarget:d,isPopout:o,attachmentsCount:j},{isCore:!0}),Object(i.d)(t,n,r),u?[4,et(t)]:[3,2]):[2];case 1:s.sent(),s.label=2;case 2:return l&&Object(i.b)(t),n||r?[4,at(t)]:[3,4];case 3:s.sent(),s.label=4;case 4:return[2]}}))}))}));function at(e){return Object(s.c)(this,void 0,void 0,(function(){return Object(s.f)(this,(function(t){switch(t.label){case 0:if(Object(f.k)(rt.a.installationStatus))return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,ne.a.import()];case 2:return t.sent(),[3,4];case 3:return t.sent(),me.d("SmimeTraceError: Unable to initialize the control on Smime options change"),[3,4];case 4:return 9!=rt.a.installationStatus&&Object(x.a)(e,it),[2]}}))}))}var ct=n(11542);Object(r.orchestrator)(P.N,(function(){Object(ct.a)(!0)})),Object(r.orchestrator)(P.j,(function(){Object(ct.a)(!1)}));var ot=n(4976),st=n(2399);Object(r.orchestrator)($e.o,(function(e){var t=y(e.attachmentId,o.Attachment);null!==t&&Object(J.a)(t)})),Object(r.orchestrator)(ot.b,(function(e){return Object(s.c)(void 0,void 0,void 0,(function(){var t,n;return Object(s.f)(this,(function(r){switch(r.label){case 0:return e.linkIds.length<1?[2]:null===(t=y(e.linkIds[0],o.Link))?[3,2]:[4,st.l.import()];case 1:n=r.sent(),e.linkIds.forEach((function(e){var r=Object(M.o)(e)?"newLink":"oldLink",i=Object(M.l)(e);Object(M.E)(e,t.attachmentWell.sharingLinkIds),Object(R.s)("SharingLinkDeleted",{isCalendar:!1,providerType:null==i?void 0:i.providerType},{cosmosOnlyData:e}),n(e,r)})),r.label=2;case 2:return[2]}}))}))}));var ut=n(2890),lt=n(3330),dt=n(5157),bt=n(6505),ft=(Object(r.orchestrator)(bt.a,(function(e){var t=e.composeId,n=e.recipientWell,r=e.recipients;if(n&&r&&r.length){var i=r.map((function(e){return Object(dt.a)(e)})),a=Object(lt.a)(n);Object(ut.a)(t,a,i)}})),n(3614));n(9537).a.register((function(e){return Object(s.c)(this,void 0,void 0,(function(){var t;return Object(s.f)(this,(function(n){return(t=e&&Object(c.b)().viewStates.get(e)).isSending||6===t.asyncSendState||1===t.asyncSendState||4===t.asyncSendState?[2]:(Object(ft.a)(t,!0,!0),[2])}))}))}));n(10311);var mt=n(440),Ot=n(12),vt="https://o365auditrealtimeingestion.manage.office.com:445/api/userauditrecord",pt="https://o365auditrealtimeingestion.manage.officeppe.com:445/api/userauditrecord";function jt(e){var t=e.auditActionStack,n=Object(mt.getAccessTokenforResource)(vt),r=Object(Ot.i)()?pt:vt;n.then((function(e){t.forEach((function(t){var n=function(e){return Object(s.a)(Object(s.a)({},e),{application:"OWA",platform:5,deviceName:window.location.host,targetLocation:4})}(t),i=r+"/Post"+t.logType+"Log";fetch(i,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify(n)})}))}))}var ht=n(4563),gt=(Object(r.orchestrator)(ht.a,(function(e){Object(k.i)("cmp-clp")&&Object(k.i)("cmp-clp-audit")&&!e.isGroupViewState&&jt(e.clpViewState)})),n(3610)),St=n(5560),It=n(3699),yt=n(6018),Ct=function(e){return Object(m.a)(e)&&e.NormalizedBody?e.NormalizedBody.BodyType:Object(ae.c)()},wt=n(3681),At="0x6815";function Tt(e){var t=Object(wt.a)(e,At);return"string"==typeof t?parseInt(t):0}var Et=n(2449),Rt=function(e){var t={Id:e,mailboxInfo:Object(We.d)()};return Et.f.importAndExecute(t,"LoadForSmimeResponse")},Mt=n(14139),xt="0xe1d";function kt(e,t){var n=Object(wt.a)(e,xt)||e.Subject||"",r=function(e){switch(e){case 1:case 2:return Object(X.b)(Mt.d);case 3:return Object(X.b)(Mt.b);case 5:return Object(X.b)(Mt.a);case 6:return Object(X.b)(Mt.c);default:return""}}(t).trim();return Object(X.c)("{0} {1}",r,n)}function Dt(e,t,n){return Object(s.c)(this,void 0,void 0,(function(){return Object(s.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,b.b.import()];case 1:return[2,r.sent()(e,n,e.Subject||kt(e,t))];case 2:return r.sent(),[2,""];case 3:return[2]}}))}))}var Pt=n(44),Lt=n(6451),Ft=n(4569),Nt=n(2511),Vt=n(8198);var Bt=n(1959),Wt=n(2031);function _t(){var e=Object(Wt.c)();return!(!e||e.treeType!==Bt.k&&e.treeType!==Bt.c)}var Ut=n(2255),Ht=n(6152),zt=Object(Pt.d)("forwardMessage",It.b.MailComposeForward)((function(e,t,n,r,i){var a,c;return Object(s.c)(this,void 0,void 0,(function(){var t,o,u,l,d,f,O,j,h,g,S,I,y,C,w,A,T,E,M,x,k,D,L,N,V,B,W;return Object(s.f)(this,(function(_){switch(_.label){case 0:return t=Object(P.k)((null==i?void 0:i.targetWindow)||window),o=Object(P.n)(t),u=Object(je.b)().items.get(e.Id),l=Ct(u),d=3,f=Tt(u),O=Object(yt.a)(u.ItemId),U={ReferenceItemId:O,ReferenceItemDocumentId:f,Subject:kt(u,d),NewBodyContent:Object(Ut.a)({BodyType:l,Value:""})},j=Object(s.a)({__type:"ForwardItem:#Exchange"},U),h=e.mailboxInfo,g=h&&"GroupMailbox"==h.type?h.mailboxSmtpAddress:null,S=F((null==i?void 0:i.targetWindow)||window),[4,v(d,u)];case 1:if(I=_.sent(),y="",Object(ve.a)()&&(y=Object(pe.a)(u)),C=Object(Vt.a)(u),w={operation:d,bodyType:l,subject:j.Subject,referenceItemId:u.ItemId,referenceItemDocumentId:f,smimeViewState:I,existingLabelString:y,classification:C,conversationId:u.ConversationId?u.ConversationId.Id:null,isInlineCompose:!1,shouldLoadItemLabel:!y},A=Object($e.c)(u.ItemId.Id)||Object(m.a)(u)||Object(p.a)(I),T=Object(Ht.a)(u),g||!A||!Object(re.a)()&&T)return[3,11];E=new R.b("ForwardInSMIME"),_.label=2;case 2:if(_.trys.push([2,9,,10]),u.NormalizedBody)return[3,6];_.label=3;case 3:return _.trys.push([3,5,,6]),[4,Rt(u.ItemId.Id)];case 4:return u=_.sent(),[3,6];case 5:return M=_.sent(),me.d("SMIME: The reference item's NormalizedBody cannot be retrieved while forwarding. "+M),I.errorCode=30,[3,6];case 6:return[4,Dt(u,d,"HTML"===l)];case 7:return x=_.sent(),[4,b.f.import()];case 8:return k=_.sent()(u.Attachments,u.ItemId,!0),D=k.supportedSmimeAttachments,L=k.unsupportedSmimeAttachmentNames,B=Object(s.a)(Object(s.a)({},w),{preferAsyncSend:!1,IRMData:Object(ce.a)()?u.RightsManagementLicenseData:null,attachments:D,unsupportedSmimeAttachmentNames:L,smimeQuotedBody:x}),3===S?Object(ie.a)(B,S,t):Object(ie.a)(B,S),E.end(),[3,10];case 9:throw N=_.sent(),E.endWithError(N),N;case 10:return[3,12];case 11:V=Object(Lt.a)(g)?{EmailAddress:g,Name:Object(Ft.a)(g),RoutingType:"SMTP",MailboxType:"GroupMailbox"}:null,B=Object(s.a)(Object(s.a)({},w),{preferAsyncSend:!0,IRMData:Object(ce.a)()?u.RightsManagementLicenseData:null,saveAndUpgrade:{itemToSave:j,groupId:g,suppressServerMarkReadOnReplyOrForward:r,remoteExecute:_t()},from:V}),3===S?Object(ie.a)(B,S,t):Object(ie.a)(B,S,null,g),_.label=12;case 12:return W={itemIds:[null===(a=null==u?void 0:u.ItemId)||void 0===a?void 0:a.Id],conversationIds:[null===(c=null==u?void 0:u.ConversationId)||void 0===c?void 0:c.Id]},Object(Nt.a)("Forward",n,W),o&&P.v.importAndExecute("ForwardInSxS",t),[2]}var U}))}))})),qt=n(12153);function Gt(e){return e.filter((function(e){return!!e.EmailAddress}))}var Jt=n(4870),Kt=n(6501);function Qt(e,t){if(null!=e&&e.length>0)for(var n=0;n<e.length;n++)if((r=e[n])==(i=t)||r&&i&&Object(Jt.a)(r.EmailAddress,i.EmailAddress))return n;var r,i;return-1}function Yt(e,t,n){var r=Object(Kt.a)(e,t);return e.filter((function(e){return e&&!Object(Jt.a)(e.EmailAddress,r)&&-1==Qt(n,e)}))}function $t(e,t,n,r,i){var a,c=function(e,t,n,r,i){var a=[];if(i){var c=r&&r.length>0;!e||Object(Jt.b)(e)||c||a.push(e),a=a.concat(t?Yt(t,n,a):[])}else{var o=t&&1===t.length&&t[0],s=!n||0===n.length;Object(Jt.b)(e)&&s&&o&&!Object(Jt.b)(o)?a=[o]:e&&(a=[e])}return a}(e,t,n,r,i),o=i&&n?Yt(n,t,c):[];return a=Object(s.g)(function(e,t,n,r){return null!=n&&n.length>0&&(r?n.forEach((function(n){if(-1==Qt(e,n)){var r=Qt(t,n);-1!=r&&t.splice(r,1),e.push(n)}})):e=n),[e,t]}(c,o,r,i),2),c=a[0],o=a[1],null!=e&&0==c.length&&0==o.length&&c.push(e),[Gt(c),Gt(o)]}var Xt=n(11543),Zt=n(6503),en=n(6504),tn=n(11544),nn=n(7289);function rn(e,t,n,r,i){return void 0===i&&(i={items:je.a.items}),Object(s.c)(this,void 0,void 0,(function(){var a;return Object(s.f)(this,(function(c){switch(c.label){case 0:return i.items.has(e)?[4,an(i.items.get(e),t)]:[2,null];case 1:return a=c.sent(),[4,Object(tn.a)(a,n,r,_t())];case 2:return[2,c.sent()]}}))}))}function an(e,t){return Object(s.c)(this,void 0,void 0,(function(){var n,r,i,a,c,o,u,l,d;return Object(s.f)(this,(function(b){switch(b.label){case 0:return[4,cn(e,t)];case 1:return n=s.g.apply(void 0,[b.sent(),2]),r=n[0],i=n[1],a=t&&e.BccRecipients?Object(s.j)([],Object(s.g)(e.BccRecipients)):[],c=Ct(e),o=Object(Ut.a)({BodyType:c,Value:Object(Xt.a)("",c)}),u=Object(yt.a)(e.ItemId),l=Tt(e),d=kt(e,t?2:1),[2,t?Object(Zt.a)({ReferenceItemId:u,ReferenceItemDocumentId:l,ToRecipients:r,CcRecipients:i,BccRecipients:a,NewBodyContent:o,Subject:d}):Object(en.a)({ReferenceItemId:u,ReferenceItemDocumentId:l,ToRecipients:r,NewBodyContent:o,Subject:d})]}}))}))}function cn(e,t){return Object(s.c)(this,void 0,void 0,(function(){var n,r,i,a;return Object(s.f)(this,(function(c){switch(c.label){case 0:return n=e.ToRecipients,r=e.CcRecipients,i=e.BccRecipients,a=e.RecipientCounts,t&&Object(nn.a)(a,n,r,i)?[4,Et.d.importAndExecute(e)]:[3,2];case 1:c.sent(),c.label=2;case 2:return[2,$t(e.From?e.From.Mailbox:e.Sender?e.Sender.Mailbox:null,e.ToRecipients,e.CcRecipients,e.ReplyTo,t)]}}))}))}var on=n(2861),sn=n(12245);var un=n(2146);function ln(e,t,n,r){var i=function(e){return(e.ToRecipients?e.ToRecipients.length:0)+(e.CcRecipients?e.CcRecipients.length:0)+(e.BccRecipients?e.BccRecipients.length:0)}(e),a=!1;if(1===i){var c=e.ToRecipients&&e.ToRecipients.length>0?e.ToRecipients[0]:void 0;a=c&&function(e){if(!e||!e.EmailAddress)return!1;return un.a.recipientCache&&un.a.recipientCache.slice(0,50).some((function(t){return t.EmailAddresses&&t.EmailAddresses.some((function(t){return t.EmailAddress&&t.EmailAddress.toLowerCase()===e.EmailAddress.toLowerCase()}))}))}(c)}Object(R.s)("MailComposeReply_Info",{composeLogTraceId:t,recipientsCount:i,isOneRecipient:1===i,isOneRecipientFromTopPeople:a,replySource:n,referenceItemDaysOld:bn(r)})}var dn=864e5;function bn(e){try{if(e){var t=new Date(e);return(Date.now()-t.getTime())/dn}}catch(e){}return-1}var fn=n(203),mn=n(2009),On=n(8),vn=n(2841),pn=n(2358);function jn(e){var t,n,r,i,a,c;return Object(s.c)(this,void 0,void 0,(function(){var o,u,d,f,O,j,h,g,S,I,y,C,w,A,T,E,M,x,k,D,L,N,V,B,W,_,U,H,z,q,G,J,K,Q,Y,$,X,Z,ee,ne,re,ae,ce,oe,se,ue,le,de,be,fe,Oe;return Object(s.f)(this,(function(je){switch(je.label){case 0:return o=null,u=e.fullComposeTarget,d=e.referenceItemOrId,f=e.isReplyAll,O=e.useFullCompose,j=e.conversationId,h=e.initialComposeLogTraceId,g=e.groupId,S=e.body,I=e.instrumentationContexts,y=e.attachmentFiles,C=e.actionSource,w=e.suppressServerMarkReadOnReplyOrForward,A=e.useCortanaSchedulingAssistant,T=e.smartDocOption,E=e.targetWindow,M=Object(P.k)(E),void 0===u&&(u=F(E)),"string"==typeof d?(k=Object(te.g)(),(D=null==k?void 0:k.items)&&D.has(d)&&(x=D.get(d))):x=d,O?[3,3]:(N=j||(x?x.ItemId.Id:null))?(V=j?0:1,(L=Object(on.a)(N,V,!1,Object(pn.a)(E)))?(B=null===(t=null==x?void 0:x.ItemId)||void 0===t?void 0:t.Id,W=null===(n=null==L?void 0:L.referenceItemId)||void 0===n?void 0:n.Id,B&&W&&B==W?(J=f?2:1)==L.operation?[3,2]:[4,an(x,f)]:[3,3]):[3,3]):[3,3];case 1:G=je.sent(),_=Object(sn.a)(G.ToRecipients,G.CcRecipients,G.BccRecipients,!0),U=_.toRecipientWell,H=_.ccRecipientWell,z=_.bccRecipientWell,L.toRecipientWell=U,L.ccRecipientWell=H,L.bccRecipientWell=z,L.operation=J,je.label=2;case 2:return[2,Promise.resolve(L)];case 3:return q=h||Object(fn.a)(),x?[4,an(x,f)]:[3,17];case 4:return G=je.sent(),[4,v(J=f?2:1,x)];case 5:if(K=je.sent(),Object(vn.a)()&&(Q=function(e){var t,n,r=Object(On.a)("useProxyEmail"),i=e?Object(mn.a)(e):null,a=i?i.ProxyAddresses:null===(t=Object(l.a)().SessionSettings)||void 0===t?void 0:t.UserProxyAddresses,c=!i||(null===(n=i.AdditionalProperties)||void 0===n?void 0:n.SendAsPermission);if(!a||!r||!c)return null;for(var o=0;o<a.length;o++){var s=e?a[o].match(/([^smtp:]|[^SMTP:])*$/g)[0]:a[o];if(r.toLowerCase()===s.toLowerCase())return{Mailbox:{EmailAddress:r}}}return null}(g),G.From=Q||G.From),Y="",Object(ve.a)()&&(Y=Object(pe.a)(x)),$=Object(Vt.a)(x),A&&G.CcRecipients.push({Name:"Cortana",EmailAddress:"cortana@calendar.help"}),X={operation:J,bodyType:G.NewBodyContent.BodyType,subject:G.Subject,newContent:S,from:null===(r=G.From)||void 0===r?void 0:r.Mailbox,to:G.ToRecipients,cc:G.CcRecipients,bcc:G.BccRecipients,referenceItemId:x.ItemId,attachmentFilesToUpload:y,classification:$,shouldLoadItemLabel:!Y},g||!(Object($e.c)(x.ItemId.Id)||Object(m.a)(x)||Object(p.a)(K)))return[3,15];Z=new R.b(f?"ReplyAllInSMIME":"ReplyInSMIME"),je.label=6;case 6:if(je.trys.push([6,13,,14]),x.NormalizedBody)return[3,10];je.label=7;case 7:return je.trys.push([7,9,,10]),[4,Rt(x.ItemId.Id)];case 8:return x=je.sent(),[3,10];case 9:return ee=je.sent(),me.d("SMIME: The reference item's NormalizedBody cannot be retrieved while replying. "+ee),K.errorCode=30,[3,10];case 10:return[4,Dt(x,J,"HTML"===G.NewBodyContent.BodyType)];case 11:return ne=je.sent(),[4,b.f.import()];case 12:return re=je.sent()(x.Attachments,x.ItemId,!1),ae=re.supportedSmimeAttachments,ce=re.unsupportedSmimeAttachmentNames,le=Object(s.a)(Object(s.a)({},X),{referenceItemDocumentId:G.ReferenceItemDocumentId,isInlineCompose:!1,preferAsyncSend:!1,conversationId:j,logTraceId:q,IRMData:x.RightsManagementLicenseData,attachments:ae,smimeViewState:K,unsupportedSmimeAttachmentNames:ce,smimeQuotedBody:ne}),o=Object(qt.a)(le),3===u?Object(ie.a)(o,u,M):Object(ie.a)(o,u),Z.end(),[3,14];case 13:throw oe=je.sent(),Z.endWithError(oe),oe;case 14:return[3,16];case 15:se=Object(Lt.a)(g)?{EmailAddress:g,Name:Object(Ft.a)(g),RoutingType:"SMTP",MailboxType:"GroupMailbox"}:null,ue=!!j&&!O,le=Object(s.a)(Object(s.a)({},X),{referenceItemDocumentId:G.ReferenceItemDocumentId,conversationId:j||(null===(i=x.ConversationId)||void 0===i?void 0:i.Id),isInlineCompose:ue,preferAsyncSend:!0,IRMData:x.RightsManagementLicenseData,logTraceId:q,smimeViewState:K,existingLabelString:Y,smartDocOption:T,saveAndUpgrade:(!g||!ue)&&{itemToSave:G,groupId:g,suppressServerMarkReadOnReplyOrForward:w,remoteExecute:_t()},existingInlineComposeId:null==L?void 0:L.composeId,from:se}),o=Object(qt.a)(le,g),3===(de=ue?1:u)?Object(ie.a)(o,de,M):Object(ie.a)(o,de,E),je.label=16;case 16:ln(G,q,C,x.DateTimeReceived),be={itemIds:[null===(a=null==x?void 0:x.ItemId)||void 0===a?void 0:a.Id],conversationIds:[j||(null===(c=null==x?void 0:x.ConversationId)||void 0===c?void 0:c.Id)]},1==G.ToRecipients.length&&(fe=G.ToRecipients[0],Oe=fe.Name,be.uniqueSenders=[Oe],be.lastSenderMailbox=fe),f?Object(Nt.a)("ReplyAll",I,be):Object(Nt.a)("Reply",I,be),je.label=17;case 17:return[2,o]}}))}))}var hn=Object(Pt.d)("replyToMessage",It.b.MailComposeReply)((function(e){return Object(s.c)(this,void 0,void 0,(function(){var t,n;return Object(s.f)(this,(function(r){switch(r.label){case 0:return[4,jn(Object(s.a)(Object(s.a)({},e),{referenceItemOrId:e.referenceItemId,isReplyAll:!1}))];case 1:return t=r.sent(),e.onComposeViewStateCreated&&e.onComposeViewStateCreated(t),n=Object(P.k)(e.targetWindow),Object(P.n)(n)&&P.v.importAndExecute("ReplyInSxS",n),[2]}}))}))})),gn=Object(Pt.d)("replyAllToMessage",It.b.MailComposeReplyAll)((function(e){return Object(s.c)(this,void 0,void 0,(function(){var t,n;return Object(s.f)(this,(function(r){switch(r.label){case 0:return[4,jn(Object(s.a)(Object(s.a)({},e),{referenceItemOrId:e.referenceItemId,isReplyAll:!0}))];case 1:return t=r.sent(),e.onComposeViewStateCreated&&e.onComposeViewStateCreated(t),n=Object(P.k)(e.targetWindow),Object(P.n)(n)&&P.v.importAndExecute("ReplyAllInSxS",n),[2]}}))}))}));function Sn(e){return Object(s.c)(this,void 0,void 0,(function(){var t,n,r,i;return Object(s.f)(this,(function(a){switch(a.label){case 0:return t=e.referenceItemId.mailboxInfo,n=t&&"GroupMailbox"==t.type?t.mailboxSmtpAddress:null,[4,W.L.import()];case 1:return r=a.sent(),0!==e.fullComposeTarget&&void 0!==e.fullComposeTarget||!r()||(e.useFullCompose=!0,e.fullComposeTarget=1),i=Object(s.a)(Object(s.a)({},e),{referenceItemId:e.referenceItemId.Id,groupId:n}),e.isReplyAll?[2,gn(i)]:[2,hn(i)]}}))}))}var In=n(5782),yn=n(33);function Cn(e,t){var n,r;return n={ndrMessageId:e,draftsFolderId:t},Object(yn.a)("CreateResendDraft",n,r)}var wn=n(1244),An=Object(Oe.action)("tryCreateResendDraft")((function(e,t){Cn(e,Object(wn.a)("drafts")).then((function(e){e?(t.infoBarIds.indexOf("infoResendError")&&Object(G.a)(t,"infoResendError"),Te(e,null,1,{isNdrResend:!0})):Object(x.a)(t,"infoResendError")})).catch((function(){Object(x.a)(t,"infoResendError")}))})),Tn=Object(Oe.action)("replyToApprovalMessage")((function(e,t,n,r){return void 0===r&&(r={primaryComposeId:c.a.primaryComposeId}),Object(s.c)(this,void 0,void 0,(function(){var r,i,a,c,o,u,l,d;return Object(s.f)(this,(function(b){switch(b.label){case 0:return r=!Object(L.w)(),i=Object(fn.a)(),c=kt(e,a=t?5:6),[4,cn(e,!1)];case 1:return o=s.g.apply(void 0,[b.sent(),1]),u=o[0],l={operation:a,bodyType:Object(ae.c)(),subject:c,to:u,referenceItemId:e.ItemId,preferAsyncSend:!0,logTraceId:i,sendAfterOpen:n,bypassClientSideValidation:!0},d=r?1:0,Object(ie.a)(l,d),[2]}}))}))})),En=n(8197),Rn=n(3116),Mn=n(3098);var xn=n(14),kn=n(3519),Dn=n(1080),Pn=n(4356);function Ln(e){var t,n,r,i,a,c=e.composeViewState,o=e.attachments,s=e.mailtips,u=e.protectionStore,l=e.includeFluidOnPopout;if((null===(t=c.addin)||void 0===t?void 0:t.internetHeaders)?c.addin.internetHeaders=new xn.ObservableMap(c.addin.internetHeaders):c.addin&&(c.addin.internetHeaders=new xn.ObservableMap),(null===(n=c.addin)||void 0===n?void 0:n.sessionStore)?(c.addin.sessionStore=new xn.ObservableMap(c.addin.sessionStore),c.addin.sessionStore.forEach((function(e){e.dataStore=new xn.ObservableMap(e.dataStore)}))):c.addin&&(c.addin.sessionStore=new xn.ObservableMap),(c.postOpenTasks||[]).forEach((function(e){e.resetInNewDeeplink&&(e.executed=!1)})),l){var d=Object(Dn.f)(Dn.c.Bohemia);Vn(d)}if(Fn(o),s){var b=(i=s,a=new Rn.b(Mn.a.compareEntryCacheTime),i.map((function(e){a.add(e.parentCacheKey,e)})),a);Nn(b)}if(Object(k.i)("cmp-clp")&&u){var f={clpLabels:u.clpLabels,learnMoreUrl:u.learnMoreUrl,hasMandatoryLabel:u.hasMandatoryLabel};Object(En.a)(f)}return(null===(r=c.policyTipsViewState)||void 0===r?void 0:r.succeededPolicyMatch)&&Object(Pn.b)(c),c}var Fn=Object(r.mutatorAction)("Popout_SetUpAttachments",(function(e){e&&e.forEach((function(e){Object($e.b)().attachments.set(e.id.Id,e)}))})),Nn=Object(r.mutatorAction)("Popout_SetUpMailTips",(function(e){kn.a.mailTips.initialize(e)})),Vn=Object(r.mutatorAction)("Popout_EnableBohemia",(function(e){e.fluidEnabledForTenant=!0})),Bn=n(6141),Wn=n(5783),_n=n(4433);n.d(t,"closeCompose",(function(){return gt.a})),n.d(t,"discardCompose",(function(){return St.a})),n.d(t,"forwardMessage",(function(){return zt})),n.d(t,"loadDraftToCompose",(function(){return Te})),n.d(t,"moveComposeToTab",(function(){return ft.a})),n.d(t,"openCompose",(function(){return ie.a})),n.d(t,"replyToMessage",(function(){return Sn})),n.d(t,"replyToMessageAndCreateViewState",(function(){return jn})),n.d(t,"createReply",(function(){return rn})),n.d(t,"getToCcRecipientsForReply",(function(){return cn})),n.d(t,"trySaveAndCloseCompose",(function(){return In.a})),n.d(t,"createAttachments",(function(){return g.a})),n.d(t,"tryCreateResendDraft",(function(){return An})),n.d(t,"replyToApprovalMessage",(function(){return Tn})),n.d(t,"onEditDraftButtonClicked",(function(){return Z})),n.d(t,"extractComposePopoutData",(function(){return Ln})),n.d(t,"insertSignature",(function(){return Bn.a})),n.d(t,"popoutCompose",(function(){return Wn.a})),n.d(t,"didInsertLinksHaveIssuesOnBlockDialogDismiss",(function(){return _n.a}))},3452:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2121),i=function(e,t){return e.substring(0,t.length)===t},a=function(e,t){return e.substring(e.length-t.length)===t},c=function(e){return e.ContentType&&(i(e.ContentType,r.v)||i(e.ContentType,r.l))},o=function(e){return e.ContentType&&e.ContentType===r.j};function s(e){return(null==e?void 0:e.Name)&&a(e.Name,r.t)&&(c(e)||o(e))}},3492:function(e,t,n){"use strict";var r=n(3857),i=n(4466),a=n(1996),c=n(183);t.a=Object(c.action)("removeAttachmentFromWell")((function(e,t,n,c){void 0===n&&(n=!0),void 0===c&&(c=!0);var o=Object(a.a)(t.attachmentId);if(o){var s,u=!1;1===t.attachmentType?(s=e.inlineAttachments,u=!0):s=e.imageViewAttachments.some((function(e){return e.attachmentId===t.attachmentId}))?e.imageViewAttachments:e.docViewAttachments;for(var l=!1,d=0;d<s.length;d++)if(s[d].attachmentId===t.attachmentId){s.splice(d,1),l=!0;break}n&&l&&(u||!t.isCloudy)&&Object(r.a)(e,-1*o.model.Size),c&&Object(i.a)(t.attachmentId)}}))},3539:function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"i",(function(){return b}));var r=n(31),i=n(3230);n.d(t,"f",(function(){return i.a}));var a=n(2876);n.d(t,"c",(function(){return a.a}));var c=n(3231);n.d(t,"g",(function(){return c.a}));var o=n(2615);n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b})),n.d(t,"e",(function(){return o.c}));var s=n(2614);n.d(t,"h",(function(){return s.a}));var u=n(2819);n.d(t,"j",(function(){return u.a}));var l=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(22),n.e(742)]).then(n.bind(null,6331))})),d=Object(r.d)(l,(function(e){return e.NotificationToast})),b=new r.a(l,(function(e){return e.addNotification}))},3543:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2677),i=n(2338),a=24;function c(){return{minWidth:i.g-a,maxWidth:Object(r.a)().listViewWidth-a}}},3587:function(e,t,n){"use strict";var r=n(3007);n.d(t,"a",(function(){return r.a}));var i=n(3003);n.d(t,"b",(function(){return i.a}));var a=n(2890);n.d(t,"d",(function(){return a.a}));var c=n(2983);n.d(t,"c",(function(){return c.a}))},3681:function(e,t,n){"use strict";function r(e,t,n,r){var a=i(e,t,n,r);return a?a.Value:null}function i(e,t,n,r){if(!e||!e.ExtendedProperty)return null;for(var i=0;i<e.ExtendedProperty.length;i++){var a=e.ExtendedProperty[i],c=null,o=null,s=null;if((null==a?void 0:a.ExtendedFieldURI)&&(c=a.ExtendedFieldURI.PropertyTag,o=a.ExtendedFieldURI.PropertyName,s=a.ExtendedFieldURI.PropertyId),t&&c==t)return a;if(n&&o==n)return a;if(r&&s==r)return a}return null}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},3857:function(e,t,n){"use strict";var r=n(183);t.a=Object(r.action)("changeTotalClassicAttachmentSize")((function(e,t){e.totalClassicAttachmentSize+=t}))},3984:function(e,t,n){"use strict";function r(e,t,n){var r=n.fromHtml(e,t);return r&&0!=r.length?1==r.length?r[0]:n.wrap(r,"SPAN"):null}n.d(t,"a",(function(){return r}))},4003:function(e,t,n){"use strict";t.a={AttachmentCreationClassicFromLocalFile:{name:"AttachmentCreationClassicFromLocalFile",customData:function(e,t,n,r,i){return r?[r.size]:[0]}},AttachmentCreationFromRecentAttachment:{name:"AttachmentCreationFromRecentAttachment",customData:function(e,t,n,r,i,a){return[(null==r?void 0:r.size)||0,null==r?void 0:r.fileType]}},AttachmentCreationCloudyFromAttachmentDataProvider:{name:"AttachmentCreationCloudyFromAttachmentDataProvider",customData:function(e,t,n,r){return[n.providerType,n.fileType]}},AttachmentCreationCloudyFromLocalFile:{name:"AttachmentCreationCloudyFromLocalFile"},AttachmentDeletionAction:{name:"AttachmentDeletionAction",customData:function(e,t,n,r){return{generatedAttachmentId:t.attachmentId.Id}},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({attachmentId:t.attachmentId.Id,fileType:r})},options:{isCore:!0}},AttachmentWellInitialization:{name:"AttachmentWellInitialization",customData:function(e,t,n,r,i,a,c){return{hasAttachments:e&&e.length>0,isCompose:i}},options:{sessionSampleRate:1}}}},4030:function(e,t,n){"use strict";var r=n(2211),i=["ErrorTooLargeForLocalAttachmentSingle","ErrorTooLargeForLocalAttachmentMultiple","WarningFilesCanNotBeAttachedGenericError","WarningEmptyFilesCanNotBeAttached","WarningFilesCanNotBeAttachedWithNamesGenericError","WarningFilesCannotBeAttachedFromOtherMailboxes","WarningSeveralFilesCanNotBeAttachedGenericError","WarningInlineImageTypeNotSupported","WarningAttachmentsCanNotBeDeleted","InfoIncludeMostRecentAttachmentsMessage","ErrorSmimeHasCloudOrUriAttachments","ErrorAttachmentDownloadFailed","ErrorAttachmentDownloadFailedMultipleFiles","WarningSpecialCharactersAreNotSupported"];function a(e){e&&Object(r.a)(e,i)}n.d(t,"a",(function(){return a}))},4062:function(e,t,n){"use strict";t.a=function(e){var t;return null===(t=null==e?void 0:e.Smime)||void 0===t?void 0:t.isDecoded}},4089:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Text=0]="Text",e[e.Html=3]="Html"}(r||(r={}))},4217:function(e,t,n){"use strict";t.a=function(e,t){void 0===t&&(t=!0);var n=t?23:24;return e>=n?n:e}},4218:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(19),i="HTML",a="Text",c="Html";function o(){return Object(r.a)().UserOptions.ComposeMarkup==c?"HTML":"Text"}},4255:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("TOGGLE_DARK_MODE_THEME",(function(e){return{isDarkModeEnabled:e}}))},4466:function(e,t,n){"use strict";var r=n(2143),i=n(183);t.a=Object(i.action)("deleteAttachment")((function(e){Object(r.a)().attachments.delete(e.Id)}))},4563:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_SEND_MESSAGE_SUCCEEDED",(function(e,t,n,r,i,a){return{operation:e,referenceItemId:t,composeId:n,conversationId:r,isGroupViewState:i,clpViewState:a}}))},4614:function(e){e.exports=JSON.parse('{"a":"nMa"}')},4709:function(e,t,n){"use strict";function r(e){return 1===e.attachmentType}n.d(t,"a",(function(){return r}))},4796:function(e,t,n){"use strict";var r=n(1),i=n(3984),a=n(2),c=Object(a.mutatorAction)("removeAppendOnSend",(function(e){e.appendOnSend=[]})),o=n(4089),s=n(121),u=n(2078),l=n(3332);function d(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,a,d;return Object(r.f)(this,(function(r){switch(r.label){case 0:return 0==(n=t.appendOnSend).length?[2]:(a="",d="ComposeAppendOnSend",[4,u.c.import()]);case 1:return r.sent()(e,(function(e,r,u){if(n.map((function(e){var t=e.txt;e.typ===o.a.Text&&(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/\//g,"&#x2F;")),a+=t})),a.length>0){var b=e.queryElements("div#appendonsend");e.addUndoSnapshot((function(){if(0==b.length)Object(s.s)(d,["End","HTML"]),e.insertContent(a,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!0});else for(var t=0;t<b.length;t++){var n=b[t];if("appendonsend"===n.id&&""===n.innerHTML){Object(s.s)(d,["Div","HTML"]);var r=Object(i.a)(a,e.getDocument(),u);n.appendChild(r);break}}}),l.a)}return c(t),null}),(function(e,r,i){n.map((function(e){e.typ!==o.a.Html&&(a+="\n"+e.txt)}));var u=e;return a.length>0&&(Object(s.s)(d,["End","Text"]),u+=a),c(t),{value:u,selectionStart:r,selectionEnd:i,focus:!0}})),[2]}}))}))}n.d(t,"a",(function(){return d}))},5118:function(e){e.exports=JSON.parse('{"c":"u_a","g":"v_a","f":"w_a","a":"x_a","e":"y_a","d":"z_a","i":"A_a","h":"B_a","b":"C_a"}')},5119:function(e){e.exports=JSON.parse('{"a":"P6a"}')},5157:function(e,t,n){"use strict";function r(e){var t;return(null===(t=null==e?void 0:e.persona)||void 0===t?void 0:t.EmailAddress)?e.persona.EmailAddress.EmailAddress:null}n.d(t,"a",(function(){return r}))},5200:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}));var r="application/octet-stream",i=1024,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},5644:function(e,t,n){"use strict";var r=n(183);t.a=Object(r.action)("updateChangeKeyOnItemId")((function(e,t){e.ChangeKey=t}))},5899:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2753),i=n(2722);function a(){var e=Object(r.b)();return Object(i.k)(e.installationStatus)}},6028:function(e,t,n){"use strict";var r=n(1),i=n(2460),a=n(2341),c=n(3326);t.a=function(e,t,n){return Object(r.c)(void 0,void 0,void 0,(function(){return Object(r.f)(this,(function(r){switch(r.label){case 0:return Object(i.a)(e,t),""!==e.queryString?[3,1]:(c.a.import().then((function(t){t(e,e.recipients,n)})),[3,3]);case 1:return e.queryString!==t?[3,3]:[4,Object(a.a)(e,t,!1,null,null,null,null,n)];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))}},6151:function(e,t,n){"use strict";function r(e,t){var n,r=null===(n=null==e?void 0:e.AttachmentId)||void 0===n?void 0:n.RootItemId;return r&&t&&r===t.Id}n.d(t,"a",(function(){return r}))},6152:function(e,t,n){"use strict";var r=n(2121);t.a=function(e){return e&&e.ItemClass===r.e}},6451:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(24),i=n(2009);function a(e){var t;if(!Object(r.i)("grp-SendAsOnBehalfOfGrp"))return!1;var n=e?Object(i.a)(e):null;return!!(null===(t=null==n?void 0:n.AdditionalProperties)||void 0===t?void 0:t.SendAsPermission)}},6516:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19),i=n(297);function a(){i.a.importAndExecute([{key:"SendAsMruAddresses",valuetype:"StringArray",value:Object(r.a)().UserOptions.SendAsMruAddresses}])}},6517:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("setSelectedCLPLabel",(function(e,t,n){return{labelToSet:e,infoBarViewState:t,clpViewState:n}}))},6518:function(e,t,n){"use strict";var r=n(6519),i=n(19),a=n(183);t.a=Object(a.action)("changeFrom")((function(e,t,n){e.from.email!=t&&(e.from={email:{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:t,Name:n||Object(i.a)().SessionSettings.UserDisplayName}}),Object(r.a)(e,!1)}))},6519:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.mutatorAction)("setIsFromEditing",(function(e,t){e.isFromEditing=t}))},6520:function(e,t,n){"use strict";var r=n(1),i=n(2664),a=n(6521),c=n(3393);t.a=function(e,t,n){return Object(r.c)(this,void 0,void 0,(function(){var o,s;return Object(r.f)(this,(function(r){switch(r.label){case 0:return Object(i.a)(e,!0),e.queryString=e.queryString.trim(),e.recipients&&e.queryString?(null==n||n(),[4,Object(c.a)(e,!1,!0,!0)]):[3,2];case 1:return r.sent(),[3,3];case 2:for(o=-1,s=t||0;s<e.recipients.length;s++)if(!e.recipients[s].isValid){o=s;break}-1!==o?Object(a.a)(e.recipients[o],o,e):Object(i.a)(e,!1),r.label=3;case 3:return[2]}}))}))}},6521:function(e,t,n){"use strict";var r=n(2608),i=n(6028);t.a=function(e,t,n,a){Object(i.a)(n,e.displayText||"",a);var c=n.recipients[t];Object(r.a)(c,!0)}},6621:function(e){e.exports=JSON.parse('{"a":"B4a"}')},6622:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5200);function i(e){if(!e)return e;var t=e.toLowerCase().charCodeAt(0);if(t>=97&&t<=122&&-1===e.indexOf("#")&&-1===e.indexOf("-"))try{return atob(e)}catch(e){}for(var n="",i=0,a=function(){var t=e.charAt(i++);switch(t){case"\r":case"\n":return a();default:return t}};i<e.length;){var c=r.a.indexOf(a()),o=r.a.indexOf(a()),s=r.a.indexOf(a()),u=r.a.indexOf(a()),l=c<<2|o>>4,d=(15&o)<<4|s>>2,b=(3&s)<<6|u;n+=String.fromCharCode(l),64!=s&&(n+=String.fromCharCode(d)),64!=u&&(n+=String.fromCharCode(b))}return n}},6842:function(e,t,n){"use strict";var r=n(1),i=n(44),a=n(4003),c=n(3492),o=n(5644),s=n(1250),u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteAttachmentFromDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AttachmentIdInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteAttachmentFromDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"AttachmentId"},value:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"RootItemId"}}]}}]}}]};n.d(t,"b",(function(){return d}));t.a=Object(i.d)("deleteAttachment",a.a.AttachmentDeletionAction)((function(e,t,n,i){return Object(r.c)(this,void 0,void 0,(function(){var i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,l(t.attachmentId)];case 1:return i=r.sent(),Object(c.a)(e,t),Object(o.a)(n,i.RootItemId.RootItemChangeKey),[2]}}))}))}));var l=function(e,t){var n;return Object(r.c)(this,void 0,void 0,(function(){var i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,Object(s.a)()];case 1:return[4,r.sent().mutate({variables:{attachmentId:{Id:e.Id,mailboxInfo:e.mailboxInfo,RootItemId:e.RootItemId,RootItemChangeKey:e.RootItemChangeKey}},context:{requestOptions:t},mutation:u})];case 2:return i=r.sent(),[2,null===(n=null==i?void 0:i.data)||void 0===n?void 0:n.deleteAttachmentFromDraft]}}))}))},d={invokeDeleteAttachmentFromDraftMutation:l}},7143:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n(1),i=n(6516),a=n(19),c=n(296),o=n(197),s=10;function u(e){var t,n;if(!Object(o.a)()&&e&&e.isFromShown){var r=null===(n=null===(t=e.from)||void 0===t?void 0:t.email)||void 0===n?void 0:n.EmailAddress;!r||l(r,e.sendAsEmailAddresses)||l(r,d())||function(e){var t=[];t.push(e);for(var n=d(),r=0;r<n.length&&t.length<s;r++){var a=n[r];t.push(a)}Object(c.a)((function(e){e.UserOptions.SendAsMruAddresses=t})),Object(i.a)()}(r)}}function l(e,t){var n,i,a=e.toLowerCase();if(t&&t.length>0)try{for(var c=Object(r.k)(t),o=c.next();!o.done;o=c.next()){if(a===o.value.toLowerCase())return!0}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}return!1}function d(){return Object(a.a)().UserOptions.SendAsMruAddresses||[]}},7145:function(e){e.exports=JSON.parse('{"d":"Y7a","a":"Z7a","c":"_7a","b":"$7a"}')},7146:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.mutatorAction)("setTempCLPLabel",(function(e,t){e.tempCLPLabel=t}))},7149:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("setCurrentBccRecipient",(function(e,t){return{smimeViewState:e,currentBccRecipient:t}}))},7150:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("setSmimeBccForkingMode",(function(e,t){return{smimeViewState:e,smimeBccForkingMode:t}}))},7198:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2340);function i(e,t){Object(r.a)(e,"queryElements",t,0,(function(e){return e.parentNode.removeChild(e)}))}},7289:function(e,t,n){"use strict";function r(e,t,n,r){return!!e&&!!(t&&t.length<e.ToRecipientsCount||n&&n.length<e.CcRecipientsCount||r&&r.length<e.BccRecipientsCount)}n.d(t,"a",(function(){return r}))},7350:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(31),i=new r.c((function(){return n.e(1030).then(n.bind(null,10331))})),a=new r.a(i,(function(e){return e.loadSignature}))},7420:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3681),i="msip_labels";function a(e){return e&&e.ExtendedProperty?Object(r.a)(e,null,i):null}},7784:function(e,t,n){"use strict";var r=n(8197),i=n(151),a=n(19),c=n(24),o=function(e){var t,n;if(!e||!e.value)return{clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1};var r=e.value,i=null===(n=null===(t=Object(a.a)().SessionSettings)||void 0===t?void 0:t.UserCulture)||void 0===n?void 0:n.toLowerCase(),o={},l="",d=!1;return r.forEach((function(e){var t,n;!l&&e.PolicySetting_customurl&&(l=e.PolicySetting_customurl),Object(c.i)("cmp-clp-outlookcustomfield")&&"true"==(null===(t=e.PolicySetting_DisableMandatoryInOutlook)||void 0===t?void 0:t.toLowerCase())||d||"true"!=(null===(n=e.PolicySetting_mandatory)||void 0===n?void 0:n.toLowerCase())||(d=!0),o[e.Id]=function(e,t){var n,r,i,a=e["LocaleSetting_DisplayName_"+t]||e["DisplayName_"+t]||e.DisplayName_Fallback,o=e["LocaleSetting_Tooltip_"+t]||e.Setting_tooltip,u=Object(c.i)("cmp-clp-outlookcustomfield")&&e.PolicySetting_outlookdefaultlabel&&e.PolicySetting_outlookdefaultlabel.length>0?e.PolicySetting_outlookdefaultlabel==e.Id:"true"==(null===(n=e.PolicySetting_default)||void 0===n?void 0:n.toLowerCase());return{id:e.Id,parentId:e.ParentId,displayName:a,infobarDisplayText:a,tooltip:o,settingOrder:parseInt(e.Setting_order),isDefault:u,isEncryptingLabel:!!e.RightsProtectMessage_Disabled&&"false"==(null===(r=e.RightsProtectMessage_Disabled)||void 0===r?void 0:r.toLowerCase()),isAutoLabelingOn:e.AutoLabeling_SensitiveTypeIds&&e.AutoLabeling_SensitiveTypeIds.length>0,children:[],isLabelEnabled:"true"==e.Setting_enabled.toLowerCase()&&!s(e),shouldShowDowngradeDialog:"true"==(null===(i=e.PolicySetting_requiredowngradejustification)||void 0===i?void 0:i.toLowerCase())}}(e,i)})),Object.keys(o).forEach((function(e){var t=o[e];if(t.parentId){var n=o[t.parentId];n&&(t.infobarDisplayText=n.displayName+"\\"+t.displayName,n.children.push(t)),delete o[e]}})),{clpLabels:u(Object.values(o)),learnMoreUrl:l,hasMandatoryLabel:d}};function s(e){var t,n,r,i=null===(t=e.RightsProtectMessage_ProtectionType)||void 0===t?void 0:t.toLowerCase(),a=null===(n=e.RightsProtectMessage_donotforward)||void 0===n?void 0:n.toLowerCase(),o=null===(r=e.RightsProtectMessage_encryptonly)||void 0===r?void 0:r.toLowerCase();return Object(c.i)("cmp-clp-enableencryptonlylabel")?"userdefined"==i&&"false"==a&&"false"==o:"userdefined"==i&&"false"==a}function u(e){return e?(e.sort(l),e.forEach((function(e){e.children&&e.children.sort(l)})),e):null}function l(e,t){return e.settingOrder-t.settingOrder}var d=n(3978),b=n(1),f=n(2),m=n(2119),O=n(8194),v=Object(f.mutatorAction)("refreshCLPViewStateForExistingCompose",(function(){Object(b.j)([],Object(b.g)(m.a.viewStates.values())).forEach((function(e){var t=e.protectionViewState;if(t){var n=t.clpViewState;t.clpViewState=Object(O.a)(null==n?void 0:n.existingLabelString,e.referenceItemId)}}))}));n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return h}));var p="/compliancepolicy/api/v1.0/user/label",j=null;function h(){j=Object(i.b)(p,null,!1,{SupportedMaxVersion:"1.0.48.0"}).then((function(e){Object(r.a)(o(e)),v(),Object(d.e)(e),j=null}))}},7804:function(e,t,n){"use strict";var r=n(3249),i=n(4062),a=n(2223),c=n(5899),o=n(3162),s=function(){return!!Object(c.a)()&&!Object(o.a)()};t.a=function(e){return!Object(i.a)(e)&&!s()&&Object(a.a)(e)&&!Object(r.a)(e)}},8023:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1),i=n(1996);function a(e){var t,n,a=[];if(!e.attachmentWell||!e.attachmentWell.docViewAttachments||0==e.attachmentWell.docViewAttachments.length)return a;try{for(var c=Object(r.k)(e.attachmentWell.docViewAttachments),o=c.next();!o.done;o=c.next()){var s=o.value;if(s.isCloudy){var u=Object(i.a)(s.attachmentId);u&&a.push(u.model.Name)}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return a}},8193:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("setSmimeErrorCode",(function(e,t,n){return{smimeViewState:e,errorCode:t,errorContext:n}}))},8196:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5200);function i(e){if(!e)return e;try{return btoa(e)}catch(e){}for(var t="",n=0,i=function(e){for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n),i=[];do{i.push(255&r),r>>=8}while(r);for(var a=i.length-1;a>-1;a--)t+=String.fromCharCode(i[a])}return t}(e);n<i.length;){var a=i.charCodeAt(n++),c=n<i.length?i.charCodeAt(n++):0,o=n<i.length?i.charCodeAt(n++):0,s=a>>2,u=(3&a)<<4|c>>4,l=(15&c)<<2|o>>6,d=63&o;n==i.length&&(i.length%3==1?(l=64,d=64):i.length%3==2&&(d=64)),t+=r.a.charAt(s)+r.a.charAt(u)+r.a.charAt(l)+r.a.charAt(d)}return t}},8197:function(e,t,n){"use strict";var r=n(2),i=n(2584);t.a=Object(r.mutatorAction)("initializeCLPStore",(function(e){i.b.clpLabels=e.clpLabels,i.b.learnMoreUrl=e.learnMoreUrl,i.b.hasMandatoryLabel=e.hasMandatoryLabel}))},8198:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(4611),i=n(3681),a=n(53);function c(e){var t=Object(i.a)(e,null,null,r.b.Id.id),n=Object(i.a)(e,null,null,r.b.Description.id);return!Object(i.a)(e,null,null,r.b.IsClassified.id)||Object(a.b)(n)||Object(a.b)(t)?null:{Id:t,Name:Object(i.a)(e,null,null,r.b.Name.id),Description:n}}},8484:function(e,t,n){"use strict";var r=n(1),i=n(3610),a=n(2211),c=n(2),o=Object(c.mutatorAction)("setHandledByDelaySend",(function(e,t){e.handledByDelaySend=t})),s=n(3614),u=n(5107),l=n(5114),d=n(2043),b=n(183),f=Object(b.action)("setAsyncSendState")((function(e,t){e.changeAsyncSendStateTimer&&(window.clearTimeout(e.changeAsyncSendStateTimer),e.changeAsyncSendStateTimer=0),e.asyncSendState=t;var n=Object(d.b)(e.composeId);switch(t){case 0:o(e,!1);break;case 6:m(e,n),o(e,!0);break;case 1:e.handledByDelaySend||m(e,n),e.changeAsyncSendStateTimer=window.setTimeout((function(){f(e,3)}),1e4);break;case 4:Object(a.a)(e,u.a),e.changeAsyncSendStateTimer=window.setTimeout((function(){f(e,5)}),3e3);break;case 5:Object(l.a)(e.toRecipientWell.findPeopleFeedbackManager,"Send"),Object(i.a)(e,"Send");break;case 3:n&&d.k.importAndExecute(n,!0)}}));function m(e,t){4===e.operation&&Object(s.a)(e,!1,!1),t&&d.k.importAndExecute(t,!1)}var O=f,v=n(2112),p=Object(b.action)("cancelSend")((function(e,t){O(e,0),4===e.operation?v.j.importAndExecute(e.itemId.Id,t):e.isInlineCompose||Object(s.a)(e,!0,!0)})),j=n(2268),h=n(4563),g=n(2031),S=n(1956),I=n(1244),y=Object(b.action)("setIsSending")((function(e,t){e.isSending=t,Object(g.b)()===Object(I.a)("drafts")&&Object(S.w)(e.itemId,t)})),C=Object(b.action)("setPreferAsyncSend")((function(e,t){e.preferAsyncSend=t})),w=Object(c.mutatorAction)("setUIEnabledState",(function(e,t){e.uiEnabledState=t})),A=n(4434),T=n(2805),E=n(3699),R=n(5118),M=n(7143),x=n(4026),k=n(23),D=function(e){[e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell].some((function(e){if((null==e?void 0:e.queryString)&&e.queryString.length>0){var t=Object(x.a)(e.recipientWellId);if(1===t.length){var n=t[0];return n.current&&n.current.focus(),!0}t.length>1&&k.g.warn("Found "+t.length+" instances of recipient well "+e.recipientWellId+" during send failure. Using the first one.")}return!1}))},P=n(3053),L=n(7144),F=n(5561),N=n(4426),V=n(6017),B=n(2904),W=n(6020);var _=n(2151),U=n(6),H=n(0),z=n(2029);var q="ErrorSendCanceled",G=n(3269),J=n(197);function K(e,t,n,i){if(e.message!=q&&e.message!=G.a){var a,c=Object(V.a)(e?e.message:null,n);"errorMessageMessageSubmissionBlocked"==c&&Object(J.a)()&&function(e,t){Object(r.c)(this,void 0,void 0,(function(){var n;return Object(r.f)(this,(function(i){switch(i.label){case 0:return n=Object(r.g)(Object(B.a)(W.a,t),1),[4,n[0]];case 1:return i.sent().success?Wt(e,t):Object(s.a)(e,!0,!0),[2]}}))}))}(t,i),"errorMessageMessageCanNotBeSent"==c&&e.messageText?Object(_.a)(t,"errorMessageErrorWithDetail",(a=e.messageText,function(){return{key:"errorMessageErrorWithDetail",source:z.c.Compose,rank:z.b.Error,message:a,messageParts:[Object(U.b)(R.c),{showDetailsText:Object(U.b)(R.f),hideDetailsText:null,detailsElement:H.createElement("span",null,a)}]}})):Object(_.a)(t,c)}}var Q=n(2065),Y=n(1992),$=n(2155),X=n(24),Z=n(121),ee=n(5106),te=n(1996);var ne=n(5783),re=n(6016),ie=n(6324),ae=n(19),ce=n(3270),oe=n(3539),se=n(514);var ue=n(14),le=n(2018),de=n(4796),be=n(3178),fe=n(5554),me=n(2682),Oe=n(2027),ve=n(2930),pe=n(3575),je=n(2581),he=n(5119),ge=n(7145),Se=n(3463),Ie=n(6517),ye=n(7146),Ce=n(3978),we=n(31),Ae=n(6812);function Te(e){var t,n="HTML"===e.bodyType;return!!(n&&function(e){var t;return null===(t=e.forgottenAttachments)||void 0===t?void 0:t.hasAttachmentTriggerWords}(e)||!n&&function(e){var t=e.content,n=e.quotedBody,r=e.useSmartResponse,i=e.forgottenAttachments;if(r||!n)return Object(Ae.c)(t)>0;var a=Object(Ae.c)(t),c=i&&null!==i.attachmentKeywordsDetectedBeforeUserInput?i.attachmentKeywordsDetectedBeforeUserInput:Object(Ae.c)(n);if(a>c)return!0;return!1}(e))&&!((t=e.attachmentWell).docViewAttachments.length>0||t.imageViewAttachments.length>0||t.inlineAttachments.length>0)}var Ee=new we.c((function(){return n.e(648).then(n.bind(null,18626))})),Re=Object(we.d)(Ee,(function(e){return e.ForgottenAttachmentsDialogToggle})),Me=n(9035),xe=n(4085);function ke(e){var t=Object(xe.a)(e.succeededPolicyMatch);if(!t)return null;switch(t.Action){case 2:case 3:return Object(U.b)(Me.a);case 4:case 5:return Object(U.b)(Me.b);case 1:return null}}function De(e){var t=Object(xe.a)(e.succeededPolicyMatch);if(!t)return!0;switch(t.Action){case 1:return!0;case 2:case 3:return e.isOverridden||e.isReportedFalsePositive;case 4:case 5:return e.isReportedFalsePositive}}var Pe=n(3095);function Le(e){var t,n,i=0;try{for(var a=Object(r.k)(e.recipients),c=a.next();!c.done;c=a.next()){i+=c.value.isValid?1:0}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i}var Fe=n(3054),Ne=n(2087),Ve=n(5559),Be=n(4875),We=n(6023),_e=n(7148),Ue=n(8023),He=n(3330),ze=n(6021),qe="GroupMailbox";function Ge(e){return Object(P.a)(e).some((function(e){return e.MailboxType==qe}))}var Je=n(6025),Ke=n(3393);function Qe(e){(null==e?void 0:e.queryString)&&e.queryString.length>0&&Object(Ke.a)(e,!0)}var Ye=n(6518);function $e(e){var t=e.fromViewState;if(null==t?void 0:t.fromWellFindControlViewState){if(t.isFromShown)return t.isFromValid;if(t.sendAsEmailAddresses&&t.sendAsEmailAddresses.length>0){var n=t.sendAsEmailAddresses[0];Object(Ye.a)(t,n)}}return!0}var Xe=n(4433),Ze=n(9036),et=n(3480),tt=n(2584),nt=n(731),rt=n(6520),it=n(2664),at=function(e){for(var t=-1,n=0;n<e.recipients.length;n++){if(!e.recipients[n].isValid){t=n;break}}-1!==t?Object(it.a)(e,!0):Object(it.a)(e,!1)},ct=Object(ue.computed)((function(){return[{validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){return Object(r.f)(this,(function(t){return[2,De(e.policyTipsViewState)]}))}))},errorCode:"PolicyTipsViolation",getConfirmDialogOptions:function(e){return{text:Object(U.b)(R.g),subtext:ke(e.policyTipsViewState),confirmOptions:{hideCancelButton:!0},continueOnUserConfirmation:!1}}},{validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n;return Object(r.f)(this,(function(r){return t=e.protectionViewState.clpViewState,n=tt.b.hasMandatoryLabel,[2,!Object(X.i)("cmp-clp-mandatory-labeling")||!n||t.selectedCLPLabel]}))}))},errorCode:"CLPMandatoryLabeling",getConfirmDialogOptions:function(e){var t=e.protectionViewState.clpViewState;return Object(Ce.g)(),{text:Object(U.b)(ge.d),subtext:Object(U.b)(ge.c),confirmOptions:{okText:Object(U.b)(ge.b),bodyElement:H.createElement(Se.a,{viewState:t}),shouldDisableOkButton:function(){return!t.tempCLPLabel}},onModalResolveCallback:function(n){n==nt.a.ok?t.tempCLPLabel&&(Object(Ie.a)(t.tempCLPLabel,e,t),Object(Ce.d)(t.selectedCLPLabel,t.tempCLPLabel),Object(ye.a)(t,null)):n==nt.a.cancel&&Object(ye.a)(t,null)},continueOnUserConfirmation:!0}}},{validate:function(e,t){return Object(r.c)(void 0,void 0,void 0,(function(){var n,i,a,c,o,s,u;return Object(r.f)(this,(function(l){switch(l.label){case 0:n=!1,l.label=1;case 1:l.trys.push([1,10,11,12]),i=Object(r.k)([e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell]),a=i.next(),l.label=2;case 2:return a.done?[3,9]:(c=a.value)?Object(X.i)("mon-rp-recipientEdit")?(at(c),[3,7]):[3,3]:[3,8];case 3:return Object(X.i)("mon-rp-unifiedPicker")?[4,Object(rt.a)(c,void 0,(function(){Object(Je.a)(t)}))]:[3,5];case 4:return l.sent(),[3,7];case 5:return[4,Object(Pe.a)(c,c.recipients,(function(){Object(Je.a)(t)}))];case 6:l.sent(),l.label=7;case 7:if(c.inForceResolve)return n=!0,Object(Z.s)("sendInvalidRecipients",[Le(c),c.findResultSet.length]),[3,9];l.label=8;case 8:return a=i.next(),[3,2];case 9:return[3,12];case 10:return o=l.sent(),s={error:o},[3,12];case 11:try{a&&!a.done&&(u=i.return)&&u.call(i)}finally{if(s)throw s.error}return[7];case 12:return[2,!n]}}))}))},errorCode:"InvalidRecipients"},{validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){return Object(r.f)(this,(function(t){return Qe(e.toRecipientWell),Qe(e.ccRecipientWell),Qe(e.bccRecipientWell),[2,Object(ze.a)(e.toRecipientWell)>0||Object(ze.a)(e.ccRecipientWell)>0||Object(ze.a)(e.bccRecipientWell)>0]}))}))},messageId:"errorMessageNoRecipentsMailCanNotBeSend",errorCode:"NoRecipients"},{validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){return Object(r.f)(this,(function(t){return[2,$e(e)]}))}))},messageId:"errorMessageInvalidSenderMailCanNotBeSend",errorCode:"InvalidSender"},{getConfirmDialogOptions:function(e){var t=e.numberOfWaitingAttachments>0;return{text:Object(U.b)(R.a),subtext:Object(fe.b)(e.attachmentWell,t),confirmOptions:{okText:Object(U.b)(je.a),hideCancelButton:!0},continueOnUserConfirmation:!1}},validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){return(t=e.numberOfWaitingAttachments>0)?[2,!1]:[2,Object(U.f)(Object(fe.b)(e.attachmentWell,t))]}))}))},errorCode:"AttachmentInProgress"},{validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){return Object(r.f)(this,(function(t){return[2,Object(et.a)(e)<=Object(ae.a)().MaxRecipientsPerMessage]}))}))},messageId:"warningMessageMaxRecipientsExceed",errorCode:"MaxRecipients"},{validate:function(e,t){return Object(r.c)(void 0,void 0,void 0,(function(){var e;return Object(r.f)(this,(function(n){switch(n.label){case 0:return e=Object(Ne.k)(window),Object(Ne.n)(e)?(Object(Je.a)(t),[4,Ne.p.import()]):[2,!0];case 1:return[2,n.sent()(e)]}}))}))},messageId:"errorMessageFileCanNotBeSaved",errorCode:"CantClosePreviewPane"},{getConfirmDialogOptions:function(e){return{text:Object(U.b)(R.e),subtext:Object(U.b)(R.d),confirmOptions:{okText:Object(U.b)(R.i),cancelText:Object(U.b)(R.b)},continueOnUserConfirmation:!0}},validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){return Object(r.f)(this,(function(t){return[2,e.isInlineCompose||e.subject&&e.subject.length>0]}))}))},errorCode:"NoSubject"},{validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n;return Object(r.f)(this,(function(r){return Object(a.a)(e,"errorSmimeMessageHasIRM"),Object(ce.a)(e.smimeViewState)?[2,!(null===(n=null===(t=e.protectionViewState)||void 0===t?void 0:t.IRMData)||void 0===n?void 0:n.RmsTemplateId)]:[2,!0]}))}))},messageId:"errorSmimeComposeHasIRM",errorCode:"HasIRMDataInSmime"},{validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n,i;return Object(r.f)(this,(function(r){return Object(ce.a)(e.smimeViewState)?[2,!((t=e.fromViewState).isFromShown&&!Object(_e.a)(null===(i=null===(n=t.from)||void 0===n?void 0:n.email)||void 0===i?void 0:i.EmailAddress))]:[2,!0]}))}))},getConfirmDialogOptions:function(e){return{text:"",subtext:Object(U.b)(Ze.g),confirmOptions:{okText:Object(U.b)(je.a),hideCancelButton:!0},continueOnUserConfirmation:!1}},errorCode:"HasFromFieldInSmime"},{validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){return Object(r.f)(this,(function(t){return Object(ce.a)(e.smimeViewState)?[2,!Ge(e)]:[2,!0]}))}))},getConfirmDialogOptions:function(e){return{text:"",subtext:Object(U.b)(Ze.h),confirmOptions:{okText:Object(U.b)(je.a),hideCancelButton:!0},continueOnUserConfirmation:!1}},errorCode:"HasModernGroupsInSmime"},{validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){return Object(r.f)(this,(function(t){return Object(ce.a)(e.smimeViewState)?[2,!Object(Ue.a)(e).length]:[2,!0]}))}))},getConfirmDialogOptions:function(e){return{text:"",subtext:Object(U.c)(Object(U.b)(he.a),Object(Ue.a)(e).join(", ")),confirmOptions:{okText:Object(U.b)(je.a),hideCancelButton:!0},continueOnUserConfirmation:!1}},errorCode:"HasCloudyAttachmentsInSmime"},{getConfirmDialogOptions:function(e){return{text:function(){return Object(Xe.d)().title},confirmOptions:{bodyElement:H.createElement(ve.d,{insertLinksIds:Object(Xe.b)(),isSend:!0}),cancelText:function(){return Object(Xe.d)().cancelButtonText},okText:function(){return Object(Xe.d)().okButtonText}},continueOnUserConfirmation:!0}},validate:function(e){return Object(Xe.f)(e,!0)},errorCode:Ve.b},{getConfirmDialogOptions:function(e){return Object(fe.e)()?{text:Object(U.b)(fe.g),confirmOptions:{bodyElement:H.createElement(be.b,{labelString:Object(U.b)(fe.f)}),okText:Object(U.b)(R.h),cancelText:Object(U.b)(R.b),dialogContentProps:{showCloseButton:!0}},continueOnUserConfirmation:!0}:{text:Object(U.b)(Ze.f),subtext:Object(fe.d)(e.infoBarIds,e.attachmentWell,Object(He.a)(e.toRecipientWell),Object(P.c)(e),e.composeId,!1),confirmOptions:{okText:Object(U.b)(R.i),cancelText:Object(U.b)(R.b)},continueOnUserConfirmation:!0}},validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){return Object(r.f)(this,(function(t){switch(t.label){case 0:return[4,Object(fe.a)(e.infoBarIds,e.attachmentWell,Object(He.a)(e.toRecipientWell),Object(P.c)(e),!1)];case 1:return[2,!t.sent()]}}))}))},errorCode:Ve.d},{getConfirmDialogOptions:function(e){var t=function(){return Object(fe.c)(e.attachmentWell,Object(He.a)(e.toRecipientWell),Object(P.c)(e))};return{text:function(){return t().title},confirmOptions:{bodyElement:H.createElement(be.a,{attachmentWell:e.attachmentWell,fromAddress:Object(He.a)(e.toRecipientWell),recipientContainers:Object(P.c)(e)}),cancelText:function(){return t().cancelText},okText:function(){return t().okButton}},continueOnUserConfirmation:!0}},validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){return Object(r.f)(this,(function(t){return[2,!Object(Fe.b)(e.composeId)]}))}))},errorCode:Ve.c},{getConfirmDialogOptions:function(e){return{text:Object(U.b)(pe.a),subtext:Object(U.b)(Ze.e),confirmOptions:{okText:Object(U.b)(Ze.d),cancelText:Object(U.b)(Ze.c)},continueOnUserConfirmation:!0}},validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){return Object(r.f)(this,(function(t){return[2,!Object(le.s)(Object(le.n)(e.composeId))]}))}))},errorCode:"AddinsStillRunning"},{getConfirmDialogOptions:function(e){return{text:Object(U.b)(Ze.b),subtext:Object(U.b)(Ze.a),confirmOptions:{bodyElement:H.createElement(Re,null),okText:Object(U.b)(R.i),cancelText:Object(U.b)(R.b)},continueOnUserConfirmation:!0}},validate:function(e){return!Object(ae.a)().UserOptions.CheckForForgottenAttachments||!Te(e)},errorCode:Ve.a},{validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){return Object(r.f)(this,(function(t){switch(t.label){case 0:return Object(X.i)("rp-appendOnSend")&&0!=e.addin.appendOnSend.length?[4,Object(de.a)(e,e.addin)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2,!0]}}))}))},errorCode:"AppendOnSend"},{validate:function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n;return Object(r.f)(this,(function(r){switch(r.label){case 0:return Object(me.a)()&&Object(Oe.f)()||(null===(n=null===(t=e.protectionViewState)||void 0===t?void 0:t.IRMData)||void 0===n?void 0:n.RmsTemplateId)?[2,!0]:[4,le.u.import()];case 1:return[2,r.sent()(Object(le.n)(e.composeId))]}}))}))},errorCode:"AddinBlockingSend"}]}));function ot(e,t,n){return Object(r.c)(this,void 0,void 0,(function(){var i,a;return Object(r.f)(this,(function(r){switch(r.label){case 0:i=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(We.a)(e,n,ct.get(),Be.a.onSend,t)];case 2:return i=r.sent(),[3,4];case 3:return a=r.sent(),y(e,!1),k.g.warn(a),[2,Promise.reject(a)];case 4:return[2,Promise.resolve(i)]}}))}))}var st=n(44),ut=n(5),lt=n(4084),dt=n(3272),bt=n(5563),ft=new we.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5),n.e(6),n.e(7),n.e(8),n.e(10),n.e(13),n.e(14),n.e(15),n.e(17),n.e(16),n.e(18),n.e(22),n.e(23),n.e(24),n.e(25),n.e(26),n.e(29),n.e(43),n.e(41),n.e(914)]).then(n.bind(null,18543))})),mt=new we.a(ft,(function(e){return e.removeMailItemWithData})),Ot=new we.a(ft,(function(e){return e.undoLatestDelayedMailItem})),vt=n(5120),pt=n(4614),jt=n(3543),ht=n(1081),gt="sendNotification";function St(e){Object(Z.s)("MailComposeDeferredSend",function(e){var t=Object(ut.Rb)(),n=Object(ut.v)(t,e),r=Object(ut.s)(t,e);return{SendTimeDeltaDays_1:Math.min(r,23),SendTimeDeltaHours:n}}(e))}var It=n(2283),yt=n(2797),Ct=n(7149),wt=n(7150),At=n(1269),Tt=n(3839),Et=n(4150),Rt=n(9037),Mt=n(8024),xt={ErrorAccountSuspendShowTierUpgrade:"configuration",ErrorAttachmentSizeLimitExceeded:!0,ErrorExceededMaxRecipientLimit:!0,ErrorExceededMaxRecipientLimitShowTierUpgrade:!0,ErrorExceededMessageLimit:"throttle",ErrorExceededMessageLimitShowTierUpgrade:"throttle",ErrorInvalidRecipients:!0,ErrorOrganizationAccessBlocked:"configuration",ErrorMessageSubmissionBlocked:"configuration",ErrorMessageThrottled:"throttle",ErrorNonExistentMailbox:"configuration",ErrorSendAsDenied:"accessDenied",ErrorSubmissionQuotaExceeded:"throttle",ErrorMessageTransientError:"transient"};function kt(e,t,n,i){var a,c=(null===(a=Object(ae.a)().UserOptions)||void 0===a?void 0:a.MailSendUndoInterval)?Object(ae.a)().UserOptions.MailSendUndoInterval:0,o=Object(Ne.k)(i),s=c>0&&!Object(Ne.n)(o)?function(e,t,n,i){return O(e,6),Bt(e,!0),new Promise((function(a,c){var o=window.setTimeout((function(){return Object(r.c)(this,void 0,void 0,(function(){var n,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:mt.importAndExecute(e),r.label=1;case 1:return r.trys.push([1,3,,4]),n=a,[4,Lt(e,t)];case 2:return n.apply(void 0,[r.sent()]),[3,4];case 3:return i=r.sent(),c(i),[3,4];case 4:return[2]}}))}))}),n);!function(e){var t=new Z.b("UndoSend_SendCancelledTimeElapsed");Object(Z.s)("UndoSend_SendBarShown");var n=Object(jt.a)();ht.e.importAndExecute(gt,"MailModuleNotificationBarHost",Object(U.b)(vt.a),{icon:"Send",primaryActionText:Object(U.b)(pt.a),allowAutoDismiss:!0,autoDismissInSeconds:e/1e3,minWidth:n.minWidth,maxWidth:n.maxWidth,notificationCallback:function(e){e===ht.a.PrimaryActionClicked&&(Ot.importAndExecute(),t.end(),Object(Z.s)("UndoSend_SendCancelled"))}})}(n),Object(bt.a)().delayedMailItems.push({timeoutId:o,timeToSend:Object(ut.g)(Object(ut.Rb)(),n),data:e,afterCancel:function(t){p(t,i),Nt(e),c(new Error(q))}}),Object(Tt.b)(e)||Object(T.d)(e)||!Object(et.b)(e)||Object(T.b)(e,!0)}))}(e,t,1e3*c,o):Lt(e,t);return y(e,!0),n.markUserPerceivedTime(!0),s}function Dt(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n,i,a,c,o,s,u;return Object(r.f)(this,(function(l){switch(l.label){case 0:n=e.smimeViewState,i=Object(yt.a)().BccEncryptedEmailForking,a=Object(N.a)(e.bccRecipientWell),c=[],l.label=1;case 1:return l.trys.push([1,15,,16]),e.toRecipientWell.recipients.length>0||e.ccRecipientWell.recipients.length>0?(Object(wt.a)(n,1),[4,Object(ie.c)(e)]):[3,3];case 2:t=l.sent(),Object(A.e)(e),l.label=3;case 3:if(0!=i)return[3,10];o=0,Object(wt.a)(n,2),l.label=4;case 4:return o<a.length?(Object(Ct.a)(n,o),t?[3,6]:[4,Object(ie.c)(e)]):[3,9];case 5:return t=l.sent(),[3,8];case 6:return[4,Object(ie.c)(e).catch((function(){c.push(a[o])}))];case 7:l.sent(),l.label=8;case 8:return e.itemId&&Object(A.e)(e),o++,[3,4];case 9:return[3,14];case 10:return 1!=i?[3,14]:(Object(wt.a)(n,3),t?[3,12]:[4,Object(ie.c)(e)]);case 11:return t=l.sent(),[3,14];case 12:return[4,Object(ie.c)(e).catch((function(){c.push.apply(c,Object(r.j)([],Object(r.g)(a)))}))];case 13:l.sent(),l.label=14;case 14:if(c.length>0)throw s=Object(U.c)(Object(U.b)(Rt.b),c.map((function(e){return e.Name})).join(", ")),Object(_.a)(e,"smimeBccForkingFailedError",[s]),Object(Z.s)("errorSmimeBccForkingFailed",[c.length],{isCore:!0}),new Error("smimeBccForkingFailedError");return[3,16];case 15:return u=l.sent(),[2,Promise.reject(u)];case 16:return Object(Z.s)("successSmimeBccForking",[a.length,i],{isCore:!0}),[2,Promise.resolve(t)]}}))}))}function Pt(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,a;return Object(r.f)(this,(function(r){switch(r.label){case 0:t(),y(e,!0),r.label=1;case 1:return r.trys.push([1,6,,7]),function(e){var t,n,r=null===(t=Object(yt.a)())||void 0===t?void 0:t.BccEncryptedEmailForking;return(null===(n=e.smimeViewState)||void 0===n?void 0:n.shouldEncryptMessageAsSmime)&&e.bccRecipientWell&&e.bccRecipientWell.recipients.length>0&&2!=r}(e)?[4,Dt(e)]:[3,3];case 2:return a=r.sent(),[3,5];case 3:return[4,Object(ie.c)(e)];case 4:a=r.sent(),r.label=5;case 5:return n=a,Object(l.a)(e.toRecipientWell.findPeopleFeedbackManager,"Send"),Object(i.a)(e,"Send"),Bt(e,!0),[2,n];case 6:throw r.sent();case 7:return[2]}}))}))}function Lt(e,t){return t(),function(e){var t,n,r,i,a,c,o=0,s=0,u=[],l=e.attachmentWell;if(l){var d=l.docViewAttachments.concat(l.imageViewAttachments);c=d.map((function(e){var t=Object(te.a)(e.attachmentId),n=t.model;return{fileType:e.fileType,isCloudy:e.isCloudy,extension:Object(Y.d)(t.model.Name),providerType:e.isCloudy?n.ProviderType:""}}));n=Math.min(d.filter((function(e){return!e.isCloudy})).length,23),r=Math.min(d.filter((function(e){return e.isCloudy})).length,23);for(var b=0;b<l.sharingLinkIds.length;b++){var f=Object($.l)(l.sharingLinkIds[b]);f&&(0===f.providerType&&o++,1===f.providerType&&s++,u.push({source:f.source,extension:Object(Y.d)(f.fileName),providerType:f.providerType}))}if(o=Math.min(o,23),s=Math.min(s,23),i=Math.min(l.sharingLinkIds.length,23),a=Math.min(d.filter((function(e){return e.fileType==Q.a.SmartDoc})).length,23),Object(X.i)("cmp-prague")){var m=l.sharingLinkIds.filter((function(e){var t=Object($.l)(e);return Object($.n)(null==t?void 0:t.fileName)})).length;m>1?Object(Z.s)("MultipleFluidComponentsInserted",{numberOfFluidComponents_1:m},{isCore:!0}):1===m&&Object(Z.s)("SingleFluidComponentsInserted",null,{isCore:!0})}}var O=e.operation,v=1==O||2==O,p=null===(t=e.referenceItemId)||void 0===t?void 0:t.Id,j=JSON.stringify([{smartDocExtractionId:Object(ee.a)(e,"smartDoc"),isReply:v,referenceItemId:p,attachmentsData:c,linksData:u}]);Object(Z.s)("AttachmentCountsOnMessageSent",[n,i,r,a,o,s],{cosmosOnlyData:j,isCore:!0,excludeFromKusto:!0})}(e),O(e,1),Bt(e,!0),C(e,!1),Object(ie.c)(e).then((function(t){return O(e,4),Promise.resolve(t)})).catch((function(t){return Nt(e,t),t.showErrorToUser=!0,Promise.reject(t)}))}function Ft(e){var t=e.actionContext;Object(s.a)(t,!0,!0)}function Nt(e,t){Bt(e,!1),1==e.asyncSendState&&(t&&"ErrorMessageSubmissionBlocked"===t.message&&Object(J.a)()||function(e){var t=Object(L.a)(e.subject);Object(oe.g)(oe.c.AsyncSendFailed,Ft);var n={actionType:oe.c.AsyncSendFailed,title:Object(U.b)(Rt.a),description:t,actionLink:Object(U.b)(R.f),cancelLink:null,actionContext:e};oe.i.importAndExecute(n)}(e)),0!=e.asyncSendState&&O(e,2),y(e,!1)}function Vt(e,t,n){e&&window.requestAnimationFrame((function(){var r=t.keyStrokeCount;e.addCosmosOnlyData(JSON.stringify({smartReplyExtractionId:Object(ee.a)(t,"smartReply"),smartDocExtractionId:Object(ee.a)(t,"smartDoc"),keyStrokeCount:r}));var i=e.eventName==E.a;if(n){e.addCustomData(i?[n.showErrorToUser,n.isAsyncSend]:{showErrorToUser:n.showErrorToUser,isAsyncSend:n.isAsyncSend,composeTraceId:t.logTraceId,operation:t.operation});var a=n&&xt[n.message];e.endWithError(a?"string"==typeof a?"ServerExpectedError":"UserError":"ServerError",n,void 0,a&&"string"==typeof a?a:void 0)}else i&&e.addCustomData({operation:t.operation,messageLanguage:Object(re.a)(t)}),e.end()}))}function Bt(e,t){(null==e?void 0:e.conversationId)&&Object(j.a)(e,t)}var Wt=t.a=Object(st.d)("trySendMessage",E.b.MailComposeSendE2E)((function(e,t,n){var i,c,o;return Object(r.c)(this,void 0,void 0,(function(){var s,l,d,b,f,m,O,v,p,j,g;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(e.isSending)return[2,Promise.resolve()];w(e,1),r.label=1;case 1:return r.trys.push([1,,12,13]),Object(X.i)("addin-popoutComposeAndSend")&&Object(le.U)()&&(w(e,2),!Object(At.a)(t))?(e.postOpenTasks.push(Object(Mt.a)(8,{bypassClientSideValidation:!1})),Object(ne.a)(e),[2,Promise.resolve()]):(s=Object(Z.u)(),l=function(e){return oe.i.isLoaded()&&Object(ae.a)().AsyncSendEnabled&&e.preferAsyncSend&&!Object(se.w)()&&!Object(ce.a)(e.smimeViewState)}(e),Object(a.a)(e,u.a),(b=!n)?[4,ot(e,t,s)]:[3,3]);case 2:b=r.sent(),r.label=3;case 3:return(d=b)?[3,10]:e.itemId?[3,5]:[4,Object(T.f)(e)];case 4:r.sent(),r.label=5;case 5:f=e.shouldUpdateContentOnDispose,Object(lt.a)(e,!1),Object(dt.a)(e,1),m=null,O=function(){m=new Z.b(Object(Tt.b)(e)?"GroupMailComposeSend":E.a)},v=l?kt:Pt,p=null,r.label=6;case 6:return r.trys.push([6,8,,9]),[4,v(e,O,s,t)];case 7:return p=r.sent(),Object(Tt.b)(e)&&m.addCustomData({composeTraceId:e.logTraceId,operation:e.operation}),Object(M.a)(e.fromViewState),[3,9];case 8:return j=r.sent(),f&&Object(lt.a)(e,!0),j.isAsyncSend=l,y(e,!1),Vt(m,e,j),K(j,e,!0,t),[2,Promise.reject(j)];case 9:return Et.c.importAndExecute(null===(i=e.referenceItemId)||void 0===i?void 0:i.Id,e.content,null===(c=e.smartPillViewState)||void 0===c?void 0:c.smartReplyComposeSIGSData),(null===(o=e.protectionViewState)||void 0===o?void 0:o.IRMData)&&Object(Z.s)("MailComposeSendWithIRMData"),e.isReadReceiptRequested&&Object(Z.s)("MailComposeSendRequestReadReceipt"),e.isDeliveryReceiptRequested&&Object(Z.s)("MailComposeSendRequestDeliveryReceipt"),e.sensitivity&&Object(Z.s)("MailComposeSendWithMessageSensitivity"),e.deferredSendTime&&St(e.deferredSendTime),Object(It.g)(Object(F.a)(e.ccRecipientWell,Object(P.a)(e))),y(e,!1),Vt(m,e),g=Object(ie.a)(p,e),Object(h.a)(e.operation,e.referenceItemId,e.composeId,e.conversationId,Object(Tt.a)(e),e.protectionViewState.clpViewState),g?[2,Promise.resolve()]:(s.endWithError("ServerError",new Error("Malformed response shape")),[2,Promise.resolve()]);case 10:y(e,!1);try{"InvalidRecipients"===d&&D(e)}catch(e){k.d("Error in send failure handler",e)}return s.endWithError("UserError",new Error(d)),[2,Promise.reject(new Error(d))];case 11:return[3,13];case 12:return w(e,0),[7];case 13:return[2]}}))}))}))},9035:function(e){e.exports=JSON.parse('{"a":"D_a","b":"E_a"}')},9036:function(e){e.exports=JSON.parse('{"g":"m_a","h":"n_a","f":"o_a","e":"p_a","d":"q_a","c":"r_a","b":"s_a","a":"t_a"}')},9037:function(e){e.exports=JSON.parse('{"b":"j_a","a":"k_a"}')},9530:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("loadSmimeComposeInfobars",(function(e){return{viewState:e}}))},9531:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("logSmimeSendSaveActionDatapoint",(function(e,t,n,r){return{composeId:e,isSend:t,smimeType:n,error:r}}))},9532:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),i=n(6014),a=n(2070),c=n(2495),o=n(2151);function s(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,u(e)];case 1:return t=r.sent(),[4,c.g.import()];case 2:return n=r.sent(),n(t).forEach((function(t){return Object(o.a)(e,t)})),[2]}}))}))}function u(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,a.h.import()];case 1:return t=n.sent(),[2,Object(i.a)(e).map((function(e){return t(e).model}))]}}))}))}},9534:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("onRemoveRecipientFromMailTip",(function(e,t){return{viewState:e,recipients:t}}))},9535:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),i=n(2805),a=n(6510),c=n(3352),o=n(2087);function s(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n;return Object(r.f)(this,(function(r){switch(r.label){case 0:return null==e.groupId||e.itemId&&!e.isDirty?[3,2]:[4,Object(i.b)(e)];case 1:r.sent(),r.label=2;case 2:return n=Object(o.k)(t||window),Object(o.n)(n)?(Object(a.a)(e),[4,o.B.import()]):[3,4];case 3:return r.sent()(e.composeId,n),[3,5];case 4:Object(c.moveComposeToTab)(e,!0,!0),r.label=5;case 5:return[2]}}))}))}},9536:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(6622),i=n(5200);function a(e,t){void 0===t&&(t=i.b);var n=Object(r.a)(e);if(!n)return null;for(var a=[],c=0;c<n.length;c+=i.c){for(var o=n.slice(c,c+i.c),s=[],u=0;u<o.length;u++)s[u]=o.charCodeAt(u);var l=new Uint8Array(s);a.push(l)}return new Blob(a,{type:t})}},9537:function(e,t,n){"use strict";var r=null,i={register:function(e){r=e},available:function(){return!!r},run:function(e){r&&r(e)}};t.a=i},9538:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2065),i=n(4029),a=n(2128),c=n(24);function o(e,t,n,a){return new Promise((function(c,o){var u=!1;try{var l=Object(r.j)([{name:t,url:n}]);Object(i.a)(l,e,{isInline:a,isHiddenInline:!0,shouldShare:!1},(function(e){u||(u=!0,c(e.Id))}),s,(function(e){u||(u=!0,o({errorType:"UploadError"}))}))}catch(e){o({errorType:"UploadError"})}}))}var s=function(e,t,n){Object(a.v)(e,t,n,!Object(c.i)("addin-fix-multipleCallbacksForAttachmentHandler"))}},9539:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2065),i=n(4029);function a(e,t,n,a){return new Promise((function(c,o){var s=!1,u=Object(r.i)([t],[n]);Object(i.a)(u,e,{isInline:a,isHiddenInline:!1,shouldShare:!1},(function(e){s||(s=!0,c(e.Id))}),null,(function(e){s||(s=!0,o({errorType:"UploadError"}))}))}))}},9540:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return o}));var r=n(31),i=new r.c((function(){return Promise.all([n.e(9),n.e(296),n.e(971)]).then(n.bind(null,12223))})),a=new r.a(i,(function(e){return e.preloadRoamingDictionary})),c=new r.a(i,(function(e){return e.saveRoamingDictionary})),o=new r.b(i,(function(e){return e.getRoamingDictionary}))},9541:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2151),i=n(6),a=n(5119);function c(e,t){(null==e?void 0:e.length)&&Object(r.a)(t,"ErrorSmimeHasCloudOrUriAttachments",[Object(i.c)(Object(i.b)(a.a),e.join(", "))])}}}]);
//# sourceMappingURL=owa.MailBoot~MailComposeActions~MailComposeCommand.js.map
self.scriptsLoaded['owa.MailBoot~MailComposeActions~MailComposeCommand.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailComposeActions~MailComposeCommand.js'] = (new Date()).getTime();