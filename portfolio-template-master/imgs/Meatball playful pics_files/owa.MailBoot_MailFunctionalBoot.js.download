self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFunctionalBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[711],{1269:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(514);function o(e){var t=e&&e!==window;return Object(r.w)()||t}},1271:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(988);function o(e){return Object(r.b)().projections.filter((function(t){return t.tabId==e}))[0]}},1272:function(e,t,n){"use strict";var r=n(1),o=n(67),i=600,a=800,c=8,u=25,s={location:!1,menubar:!1,resizable:!0,scrollbars:!1,status:!1,toolbar:!1},d=-1;function l(e,t,n){try{t=function(e){var t=u*(1+(d=(d+1)%c)),n={left:window.screenX+t,top:window.screenY+t,height:Math.max(25*Math.pow(window.innerHeight,.5),i),width:Math.max(8*Math.pow(window.innerWidth,2/3),a)};return Object(r.a)(Object(r.a)(Object(r.a)({},s),n),e)}(t);var l=(n||window).open(e,"_blank",function(e){return Object.getOwnPropertyNames(e).map((function(t){return t+"="+("boolean"==typeof(n=e[t])?n?"1":"0":n?String(n):void 0);var n})).join(",")}(t));return(Object(o.e)()||Object(o.f)())&&l.moveTo(t.left,t.top),l}catch(e){return null}}var f=n(988);var b=n(1297),v=n(44),O=n(982),p=n(121);t.a=Object(v.d)("addPopoutV2",{name:"PopoutAddPopout",customData:function(e,t,n,r,o,i){return[(t||"").split("/")[0],i]}})((function(e,t,n,r,o,i,a){var c=function(e){var t=null,n=void 0,r=null,o=null;return e&&(!function(e){return void 0!==e.deeplinkData||!!e.projectionTabId}(e)?n=e:(n=e.deeplinkData,Object(f.b)().isAvailable&&(t=e.projectionTabId||null),r=e.projectionTargetWindow,o=e.projectionParentWindow)),{deeplinkCallback:void 0===n?function(){return Promise.resolve(null)}:"function"==typeof n?n:function(){return Promise.resolve(n)},projectionTabId:t,projectionTargetWindow:r,projectionParentWindow:o}}(n),u=c.deeplinkCallback,s=c.projectionTabId,d=c.projectionTargetWindow,v=c.projectionParentWindow,m=new p.b(s?"PopoutProjectionPerf":"PopoutDeeplinkPerf"),j=s?"about:blank":Object(b.a)(e,t,{skipOptinCheck:o,urlParameters:a}),I=d||l(j,r,v);I&&O.h.import().then((function(t){return t(e,I,s,u,m)}))}))},1297:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(4),o=n(514),i=n(817),a="version";function c(e,t,n){var c;void 0===n&&(n={});var u=n.isStandalone?{}:((c={})[i.a]=i.b,c[a]=Object(r.r)(),c),s=n.urlParameters||{};return Object.keys(s).map((function(e){u[e]=s[e]})),Object(o.q)(e,t,n.skipOptinCheck,u)}},1557:function(e,t,n){var r=n(1558),o=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1558:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,"._3k2DZQclSrOtYR-5XBK9RP{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={view:"_3k2DZQclSrOtYR-5XBK9RP"}},18202:function(e,t,n){"use strict";n.r(t);var r=n(1244),o=n(4170),i=n(1947),a=n(24);function c(e){return Object(i.W)(Object(r.a)("inbox"))||Object(a.i)("rp-reactions")}var u=n(1985);function s(e){var t=Object(r.a)("inbox");return Object(i.W)(t)&&!Object(u.isPersonaInFavorites)(null,e.SenderSmtpEmailAddress)}function d(){return Object(i.W)(Object(r.a)("inbox"))||!Object(a.i)("auth-reactionNotifications")||!Object(a.i)("rp-reactions")}var l=n(10330),f=n(4175),b=n(2),v=n(3299),O=n(8230);Object(b.orchestrator)(O.a,(function(e){var t={Subject:e.taskNewEventTitle,IsAllDayEvent:!0};v.g.importAndExecute("GetStarted","GetStarted",t)}));var p=n(2218),m=n(9624);Object(b.orchestrator)(m.a,(function(){p.f.importAndExecute("mail","attachments")}));var j=n(9625);Object(b.orchestrator)(j.a,(function(){p.f.importAndExecute("mail","messageContent")}));var I=n(9622);Object(b.orchestrator)(I.a,(function(){p.f.importAndExecute("general","timeAndLanguage")}));var w=n(2447),h=n(9623),g=n(9629),S=n(3272);Object(b.orchestrator)(h.a,(function(e){w.c.importAndExecute("GetStarted",void 0,void 0,e.taskSendEmailSubject,e.taskSendEmailBody)})),Object(b.orchestrator)(S.a,(function(e){1==e.event&&Object(g.a)()}));var x=n(9626),A=n(9630),E=n(31),y=new E.c((function(){return Promise.all([n.e(213),n.e(316),n.e(760)]).then(n.bind(null,18382))})),C=new E.a(y,(function(e){return e.showPersonalizationCard}));Object(b.orchestrator)(x.a,(function(){C.importAndExecute(A.a)}));var N=n(5879),R=n(4967),M=new E.c((function(){return n.e(348).then(n.bind(null,18615))})),P=new E.a(M,(function(e){return e.loadSenders})),T=n(7913),k=n(3147),L=new E.c((function(){return n.e(922).then(n.bind(null,18373))})),V=new E.a(L,(function(e){return e.subscribeToHierarchyNotification}));Object(E.f)(k.a,L,(function(e){return e.onNewFolderNotificationOrchestrator})),Object(E.f)(k.b,L,(function(e){return e.onUpdateFolderNotificationOrchestrator}));var D=n(1),_=n(6),F=n(14),K=n(1955),U=n(3246),B=n(23);function G(e,t){var n=function(e){var t={},n=K.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){B.d("Invalid loop found in ParentInternetMessageId pointers");break}if(Object(U.b)(n.internetMessageId)&&(t[n.internetMessageId]=!0),Object(_.f)(n.parentInternetMessageId))break;n=K.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(n).length)return function(e,t){var n=new F.ObservableMap({});return t.forEach((function(t){var r=K.a.conversationNodes.get(t),o=t===e?i.a.CheckMark:i.a.None;n.set(r.internetMessageId,o)})),n}(e,t);for(var r=new F.ObservableMap({}),o=!1,a=!1,c=0,u=0;u<t.length;u++){var s=K.a.conversationNodes.get(t[u]);s&&(n[s.internetMessageId]?(o?c+1===Object.keys(n).length?(r.set(s.internetMessageId,i.a.BusEnd),a=!0):r.set(s.internetMessageId,i.a.BusStop):(r.set(s.internetMessageId,i.a.BusStart),o=!0),c++):!o||a?r.set(s.internetMessageId,i.a.None):r.set(s.internetMessageId,i.a.NoStop))}return r}var W=n(2072),z=n(2962),H=Object(b.action)("FOCUS_ITEM_PART",(function(e,t){return{nodeId:e,mailListItemSelectionSource:t}})),q=n(2133),Y=n(8218),J=n(1956),X=n(2959);function Q(){var e=q.a.expandedConversationViewState;e.expandedRowKey=null,e.focusedNodeId=null,e.selectedNodeIds=[],e.allNodeIds=[],e.shouldBeExpanded=!1,e.busStopStateMap=new F.ObservableMap({}),e.latestNodeIdsInEachFork=null}Object(b.mutator)(W.s,(function(e){var t=e.nodeId,n=q.a.expandedConversationViewState,r=n.selectedNodeIds,o=n.allNodeIds;q.a.expandedConversationViewState.focusedNodeId=t,r.indexOf(t)>-1?r.splice(r.indexOf(t),1):r.push(t),1===r.length&&(q.a.expandedConversationViewState.busStopStateMap=G(r[0],o))})),Object(b.mutator)(W.u,(function(e){var t,n,r=e.deletedItemIds,o=e.latestItemIdsInForks;try{for(var i=Object(D.k)(r),a=i.next();!a.done;a=i.next()){var c=a.value,u=o.indexOf(c);o.splice(u,1)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}q.a.expandedConversationViewState.latestNodeIdsInEachFork=Object(D.j)([],Object(D.g)(o))})),Object(b.mutator)(W.h,(function(e){q.a.expandedConversationViewState.busStopStateMap=new F.ObservableMap({})})),Object(b.mutator)(H,(function(e){q.a.expandedConversationViewState.focusedNodeId=e.nodeId})),Object(b.mutator)(W.p,(function(e){var t=e.rowKey,n=e.nodeIdToSelect,r=e.allNodeIds,o=q.a.expandedConversationViewState;o.selectedNodeIds=[n],o.busStopStateMap=G(n,r),o.expandedRowKey=t,o.focusedNodeId=n,o.allNodeIds=r})),Object(b.mutator)(W.t,(function(e){e.mailListItemSelectionSource===J.b.MailListItemCheckbox&&Q()})),Object(b.mutator)(z.a,(function(e){Q()})),Object(b.mutator)(W.i,(function(e){Q()})),Object(b.mutator)(W.k,(function(e){Q()})),Object(b.mutator)(W.a,(function(e){Q();var t=q.a.expandedConversationViewState;t.latestNodeIdsInEachFork=e.latestItemIdsInForks,t.expandedRowKey=e.rowKey})),Object(b.mutator)(W.q,(function(e){var t=q.a.expandedConversationViewState,n=e.rowKey,r=e.mailListItemSelectionSource;t.expandedRowKey!=n?Object(X.d)()?(t.shouldBeExpanded=!0,t.expandedRowKey=n,t.latestNodeIdsInEachFork=[]):r===J.b.MailListItemTwisty&&(t.shouldBeExpanded=!0,t.expandedRowKey=n,t.latestNodeIdsInEachFork=null):r===J.b.MailListItemTwisty&&Object(X.a)(n)&&(Q(),t.shouldBeExpanded=!0,t.expandedRowKey=n)})),Object(b.mutator)(W.o,(function(e){Q(),q.a.expandedConversationViewState.expandedRowKey=e.rowKey})),Object(b.mutator)(Y.a,(function(e){if(1===q.a.expandedConversationViewState.selectedNodeIds.length){var t=q.a.expandedConversationViewState.selectedNodeIds[0],n=J.u.conversations.get(e.conversationId).conversationNodeIds;q.a.expandedConversationViewState.busStopStateMap=G(t,n)}}));var Z=n(4402),$=n(7915),ee=n(2326),te=n(2010),ne=n(2013),re=n(2449);function oe(e,t){var n;if(e)for(var r=0;r<e.length;r++)if(t){var o=Object(J.v)(e[r]);if((null===(n=null==o?void 0:o.ParentFolderId)||void 0===n?void 0:n.Id)==t)return e[r]}return null}var ie=n(6858);var ae,ce=function(e,t){return Object(D.c)(this,void 0,void 0,(function(){var n,r;return Object(D.f)(this,(function(o){switch(o.label){case 0:return[4,Object(ie.a)(e)];case 1:return(n=o.sent())?(r=[],n.forEach((function(e){if(0===e.childrenImIds.length){var o=oe(e.itemIds,t);o&&r.push(o);for(var i=e;!o&&(null==i?void 0:i.parentImId);)(o=oe(null==(i=n.get(null==i?void 0:i.parentImId))?void 0:i.itemIds,t))&&r.push(o)}})),[2,r.reverse()]):[2,[]]}}))}))},ue=n(3306),se=n(7441),de=n(2054),le=n(2350);Object(b.orchestrator)(W.b,(function(e){ve(e.itemId,e.tableView,e.nodeId,e.allNodeIds,e.mailListItemSelectionSource)}));Object(b.orchestrator)(W.e,(function(e){if(1!=e.listViewType){var t=i.ab.expandedConversationViewState,n=e.mailListItemSelectionSource==J.b.MailListItemTwisty;Object(X.d)()&&t.expandedRowKey!=e.rowKey?Ie(e.rowKey,e.tableView,n):t.expandedRowKey==e.rowKey&&(t.shouldBeExpanded?t.latestNodeIdsInEachFork?Ie(e.rowKey,e.tableView,n):me(e.rowKey,e.tableView):!t.latestNodeIdsInEachFork&&n&&je())}})),Object(b.orchestrator)(W.c,(function(e){(Object(X.a)(e.rowKey)||Object(X.c)(e.rowKey))&&je()})),Object(b.orchestrator)(W.m,(function(e){for(var t=i.b.getConversationId(e.rowKey,e.tableView),n=J.u.conversations.get(t),r=null,o=null,a=n.conversationNodeIds.indexOf(i.ab.expandedConversationViewState.selectedNodeIds[0])+1;a<n.conversationNodeIds.length;a++){var c=n.conversationNodeIds[a],u=Object(ue.a)(c,Object(X.a)(e.rowKey));if(u){o=u.ItemId.Id,r=c;break}}r?ve(o,e.tableView,r,n.conversationNodeIds,J.b.RowRemoval):pe(e.rowKey,e.tableView)}));var fe=0,be=!0;function ve(e,t,n,r,o){if(ae&&(clearTimeout(ae),ae=null),Object($.a)(t,!0,o,void 0),o!==J.b.KeyboardUpDown||Object(te.c)())Oe(e,t);else{var a=Date.now(),c=a-fe;fe=a,(be||c<=500)&&(be=!1,ae=setTimeout((function(){ae=null,be=!0,Oe(e,t)}),250))}var u=i.ab.expandedConversationViewState;W.p(u.expandedRowKey,n,r,t.id,u.selectedNodeIds)}function Oe(e,t){if(Object(de.a)())le.o.importAndExecute({Id:e,mailboxInfo:Object(ne.b)(t)},!0,null,!1);else{var n=i.b.getRowClientItemId(i.ab.expandedConversationViewState.expandedRowKey,t);le.s.importAndExecute(null==n?void 0:n.Id,e,!0)}}function pe(e,t,n,r){var o,a,c=n;if(!c||0==c.length){var u=i.b.getConversationId(e,t);c=J.u.conversations.get(u).conversationNodeIds}var s=r?i.b.getRowIdToShowInReadingPane(e,t):null;try{for(var d=Object(D.k)(c),l=d.next();!l.done;l=d.next()){var f=l.value,b=Object(ue.a)(f,Object(X.a)(e));if(b&&(!s||b.ItemId.Id==s.Id)){ve(b.ItemId.Id,t,f,c,Object(de.a)()&&Object(X.d)()&&Object(ee.a)()&&Object(te.c)()?J.b.MailListItemExpansion:J.b.RowRemoval);break}}}catch(e){o={error:e}}finally{try{l&&!l.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}}function me(e,t){W.o(e),Object(Z.a)(t,!1),Object(de.a)()?pe(e,t,null,!0):pe(e,t)}function je(){W.i()}function Ie(e,t,n){return Object(D.c)(this,void 0,void 0,(function(){var r,o,a,c;return Object(D.f)(this,(function(u){switch(u.label){case 0:return r=i.b.getRowClientItemId(e,t),o=r.Id,Object(se.a)(o)?[3,2]:[4,re.e.importAndExecute(r,"CreateConversationRelationMap")];case 1:u.sent(),u.label=2;case 2:return a=Object(i.N)(e,t.id),[4,ce(o,null==a?void 0:a.parentFolderId)];case 3:return(c=u.sent()).length>1?(W.a(e,c),pe(e,t,c)):n?me(e,t):W.a(e,[]),[2]}}))}))}var we=n(8221),he=n(9663),ge=(Object(b.orchestrator)(he.a,(function(e){Object(we.a)(),1===Object(i.M)().expandedConversationViewState.selectedNodeIds.length&&W.h()})),n(9572)),Se=n(3247),xe=(Object(b.orchestrator)(ge.a,(function(e){if(i.ab.expandedConversationViewState.expandedRowKey){var t=J.u.conversations.get(e.conversationId);W.p(i.ab.expandedConversationViewState.expandedRowKey,e.conversationNodeId,t.conversationNodeIds,Object(Se.a)())}})),n(8235)),Ae=n(5201),Ee=n(6623),ye=n(2921),Ce=Object(b.action)("FOCUS_ROW_IN_DIRECTION",(function(e,t,n){return{tableView:e,selectionDirection:t,mailListItemSelectionSource:n}}));function Ne(e,t,n){return Object(ye.a)()?1===e&&n===i.d.Next||0===e&&n===i.d.Previous:e===t-1&&n===i.d.Next||e===t-2&&n===i.d.Previous}Object(b.orchestrator)(xe.a,(function(e){var t=e.selectionDirection,n=e.tableView,r=e.mailListItemSelectionSource,o=e.shouldSelect,a=Object(D.g)(function(e,t){var n=i.ab.expandedConversationViewState,r=n.focusedNodeId,o=n.allNodeIds;if(!r)return[null,null];var a,c,u=o.indexOf(r);e===i.d.Next?(a=o.length-1,c=1):(a=0,c=-1);var s=Object(i.N)(t.focusedRowKey,t.id).id,d=i.ab.conversationItems.get(s);for(;u!==a;){if(u+=c,Object(Ae.a)(d.id)&&Ne(u,o.length,e))return Object(Ee.a)(d.clientId),["loading",null];var l=o[u],f=Object(ue.a)(l,Object(X.a)(t.focusedRowKey));if(f)return[l,f]}return[null,null]}(t,n),2),c=a[0],u=a[1];"loading"!==c&&(c?o?W.b(c,u.ItemId.Id,i.ab.expandedConversationViewState.allNodeIds,n,r):H(c,r):i.ab.expandedConversationViewState.expandedRowKey&&t===i.d.Previous?W.c(i.ab.expandedConversationViewState.expandedRowKey):o?W.n(n,t,r):Ce(n,t,r))}));var Re=n(7916),Me=n(4058),Pe=n(3819),Te=n(3818),ke=(Object(b.orchestrator)(Ce,(function(e){var t=e.tableView,n=e.selectionDirection,r=Object(Re.a)(t,n);if(null!==r){var o=t.rowKeys[r];Object(Me.a)(t,o),Object(Te.a)(t,o),Object(Pe.a)(t,null),W.i()}})),n(8236));Object(b.orchestrator)(ke.a,(function(e){var t=e.tableView,n=e.mailListItemSelectionSource,r=i.ab.expandedConversationViewState.focusedNodeId;r?W.s(r):W.t(t,t.focusedRowKey,!0,n)}));var Le=n(2048),Ve=n(7888),De=n(8237);Object(b.orchestrator)(De.a,(function(e){var t=e.tableView,n=e.selectedNodeIds,r=e.selectedRowKeys,o=e.mailListItemSelectionSource;if(n.length>0&&o===Le.a.KeyboardEnter){if(1!==n.length)return;W.b(n[0],Object(Ve.a)(n[0],Object(X.a)(r[0])),i.ab.expandedConversationViewState.allNodeIds,t,o)}else{if(1!==r.length)return;W.q(t,r[0],!0,o)}}));var _e=n(33);var Fe=n(197),Ke=n(2816),Ue=n(5407),Be=n(9440),Ge=n(2709),We=n(3379),ze=new E.c((function(){return Promise.all([n.e(295),n.e(966)]).then(n.bind(null,18269))})),He=new E.a(ze,(function(e){return e.evaluatePlaywrightMailActions})),qe=n(19),Ye=n(6438),Je=n(2252),Xe=n(2597);function Qe(){Object(qe.a)().IsMonitoring&&He.importAndExecute(),V.importAndExecute(),Object(l.a)(!0),Ge.b.importAndExecute({condition:Object(a.i)("fwk-devTools")||Object(a.i)("sea-contextFeedback"),task:function(){return T.b.importAndExecute()}},{condition:Object(a.i)("fwk-nlqsFloodgateSurvey"),task:function(){return Xe.a.importAndExecute(null,!0)}},Ze,{condition:Object(Je.j)(),task:function(){return Je.n.importAndExecute()}},{condition:Object(a.i)("tri-spotlight2"),task:function(){return Ke.i.importAndExecute()}},{condition:Object(Fe.a)(),task:function(){return P.importAndExecute()}},(function(){return Be.b.importAndExecute()}),(function(){return Be.a.importAndExecute()}),{condition:Object(Ye.a)(),task:function(){return N.c.importAndExecute()}},{condition:Object(a.i)("mc-personalization"),task:function(){Ue.b.importAndExecute()},idle:!0},{condition:Object(le.f)(),task:function(){return R.a.importAndExecute()},idle:!0},{task:function(){return We.a.importAndExecute()},idle:!0},{condition:Object(a.i)("auth-activityFeed")&&Object(a.i)("auth-activityFeedWeveSignal"),task:function(){return f.e.importAndExecute()},idle:!0},{condition:Object(a.i)("mail-popout-projection"),task:function(){return le.h.importAndExecute()},idle:!0}).then((function(){Ge.a.importAndExecute()}))}function Ze(){var e,t;Object(o.h)(s),Object(o.g)(c),Object(o.i)(d),Object(Fe.a)()&&(e={isOWALogon:!0},Object(_e.a)("ConnectedAccountsNotification",e,t))}Object(b.orchestrator)(o.c,(function(e){return Object(D.c)(void 0,void 0,void 0,(function(){var t,n,r,o,a,c;return Object(D.f)(this,(function(u){switch(u.label){case 0:return t=e.notification,Object(i.S)(Object(i.J)())?(n=Object(J.g)().conversations.get(t.conversationId),r={Id:t.conversationId,mailboxInfo:Object(ne.a)()},n?[3,2]:[4,re.e.importAndExecute(r,"LoadLikedConversation")]):[3,3];case 1:u.sent(),u.label=2;case 2:return $e(r,t.subject),[3,6];case 3:return o=Object(J.g)().items.get(t.itemId),a={Id:t.itemId,mailboxInfo:Object(ne.a)()},(null==o?void 0:o.NormalizedBody)?($e(a,t.subject),[3,6]):[3,4];case 4:return c={Id:t.itemId,mailboxInfo:Object(ne.a)()},[4,re.f.importAndExecute(c,"LoadLikedItem")];case 5:u.sent(),$e(c,t.subject),u.label=6;case 6:return[2]}}))}))}));function $e(e,t){le.p.importAndExecute(e,t,[],!0,null)}var et=n(9655),tt=n(57);Object(b.orchestrator)(o.d,(function(e){var t=e.notification,n=1===Object(tt.h)().UserOptions.GlobalListViewTypeReact?t.ItemId:t.ConversationId;Object(et.a)("inbox",n)})),Object(b.orchestrator)(o.e,(function(e){return Object(D.c)(void 0,void 0,void 0,(function(){var t,n,r,o,a,c;return Object(D.f)(this,(function(u){switch(u.label){case 0:return t=e.notification,Object(i.S)(Object(i.J)())?(n=Object(J.g)().conversations.get(t.conversationId),r={Id:t.conversationId,mailboxInfo:Object(ne.a)()},n?[3,2]:[4,re.e.importAndExecute(r,"LoadReactedConversation")]):[3,3];case 1:u.sent(),u.label=2;case 2:return nt(r,t.subject),[3,6];case 3:return o=Object(J.g)().items.get(t.itemId),a={Id:t.itemId,mailboxInfo:Object(ne.a)()},(null==o?void 0:o.NormalizedBody)?(nt(a,t.subject),[3,6]):[3,4];case 4:return c={Id:t.itemId,mailboxInfo:Object(ne.a)()},[4,re.f.importAndExecute(c,"LoadReactedItem")];case 5:u.sent(),nt(c,t.subject),u.label=6;case 6:return[2]}}))}))}));function nt(e,t){le.p.importAndExecute(e,t,[],!0,null)}n.d(t,"setupMailModulePostRender",(function(){return Qe}))},1986:function(e,t,n){"use strict";var r=n(1),o=n(2051),i=n(374),a=n(730),c=n(121),u=n(5),s="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";function b(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,b,v,O,p;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(i.k)(e)){if(b.accountState==i.b.AccessRevoked)return[2,null];if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.c)(b.accountState,b.accountProviderType),[2,null]}return t?(n[s]=t,n[f]=t):b&&(n[s]=b.anchorMailbox),b?(v=b.token,!(O=Object(a.g)(b.tokenExpiry))&&v?[3,2]:(Object(c.s)("getAndUpdateAccessToken",{tokenExpiry:Object(u.y)(b.tokenExpiry,Object(u.Rb)()),isTokenExpired_1:O,isTokenInvalid_2:!v},{isCore:!0}),[4,o.a.importAndExecute(b.accountId,e,v)])):[3,3];case 1:(v=r.sent())||(v=""),r.label=2;case 2:p=void 0,"Outlook"==b.accountProviderType?(p='MSAuth1.0 usertoken="'+v+'", type="MSACT"',n[l]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(p="Bearer "+v,n[l]=2..toString()),n[d]=p,r.label=3;case 3:return[2,n]}}))}))}var v=n(1989),O=n(23);function p(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=Object(v.a)(),o=n,[4,m(e,t)];case 1:return o.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function m(e,t){var n;return Object(r.c)(this,void 0,void 0,(function(){var o,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return o=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,[4,b(e.mailboxInfo.userIdentity,j(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(v.b)(o,i),[2,o]}}))}))}function j(e,t){var n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&O.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return j}))},1989:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach((function(n){return e.set(n,t[n])}))}function o(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},1991:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},1993:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),o=n(14),i=Object(r.createStore)("groupsStore",{groups:new o.ObservableMap})},2004:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(267);function o(e){var t;return null===(t=Object(r.a)(e))||void 0===t?void 0:t.AttachmentPolicy}},2009:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1993);function o(e){var t=Object(r.a)().groups.get(e.toLowerCase());return t?t.groupDetails:null}},2029:function(e,t,n){"use strict";var r,o,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(o||(o={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(i||(i={}))},2030:function(e,t,n){"use strict";var r=n(1),o=n(1989);function i(e,t){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":t||e}}function a(e,t,n){t&&(e||n)&&Object(o.b)(t,i(e,n))}function c(e,t){var n,o=null!=t?t:{},i=(null===(n=o.headers)||void 0===n?void 0:n.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",a(e,i),Object(r.a)(Object(r.a)({},o),{headers:i})}var u=n(374),s=n(1986),d=n(87),l=n(319);function f(e){return Object(r.c)(this,void 0,void 0,(function(){var t=this;return Object(r.f)(this,(function(n){return[2,Object(d.b)().then((function(n){return Object(r.c)(t,void 0,void 0,(function(){var t,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return e?Object(u.r)(e.userIdentity)?[4,Object(s.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return t=r.sent(),l(n,t),[3,3];case 2:"GroupMailbox"!=e.type&&"TeamsMailbox"!=e.type||(o=i(e.mailboxSmtpAddress),l(n,o)),r.label=3;case 3:return[2,n]}}))}))}))]}))}))}function b(){return Object(d.b)().then((function(e){return e.prefer='exchange.Behavior="CalendarInternal"',e}))}function v(e){return void 0===e&&(e=null),Object(u.r)(e)?b().then((function(t){return Object(s.a)(e).then((function(e){return Object.keys(e).forEach((function(n){return t[n]=e[n]})),t}))})):Promise.resolve({})}var O=n(65);function p(e,t,n,r){var o=new Headers;return n&&o.set("X-OWA-CANARY",Object(O.a)()),t&&o.set("X-OWA-ActionName",t),(e||r)&&(r?a(e,o,r):a(e,o)),o}n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return p}))},2051:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(31),o=n(1991);n.d(t,"b",(function(){return o.a}));var i=new r.c((function(){return n.e(1286).then(n.bind(null,2298))})),a=new r.a(i,(function(e){return e.getAndUpdateAccessToken}))},2128:function(e,t,n){"use strict";n.d(t,"n",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"r",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"p",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"u",(function(){return b})),n.d(t,"g",(function(){return v})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"i",(function(){return j})),n.d(t,"l",(function(){return I})),n.d(t,"k",(function(){return w})),n.d(t,"c",(function(){return h})),n.d(t,"o",(function(){return g})),n.d(t,"s",(function(){return S})),n.d(t,"b",(function(){return x})),n.d(t,"m",(function(){return A})),n.d(t,"h",(function(){return E})),n.d(t,"t",(function(){return y}));var r=n(31),o=n(2248);n.d(t,"v",(function(){return o.a}));var i=n(2249);n.d(t,"w",(function(){return i.a}));var a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(15),n.e(17),n.e(16),n.e(21),n.e(22),n.e(29),n.e(34),n.e(37),n.e(41),n.e(42),n.e(52),n.e(57),n.e(72),n.e(77),n.e(78),n.e(82),n.e(111),n.e(143),n.e(170),n.e(353)]).then(n.bind(null,3209))})),c=new r.a(a,(function(e){return e.initializeAttachments})),u=new r.a(a,(function(e){return e.reinitializeAttachments})),s=new r.a(a,(function(e){return e.setInlineAttachmentStatus})),d=new r.a(a,(function(e){return e.addAttachmentIntoWellBeforeUpload})),l=new r.b(a,(function(e){return e.refreshSharingTipsAttachmentWell})),f=new r.b(a,(function(e){return e.createAttachmentsViaQueueManager})),b=new r.b(a,(function(e){return e.createAttachmentsFromRecentAttachments})),v=new r.a(a,(function(e){return e.deleteAttachmentViaQueueManager})),O=new r.b(a,(function(e){return e.createAttachmentFullViewStateAndStoreBackingModel})),p=new r.b(a,(function(e){return e.createAttachmentFullViewState})),m=new r.b(a,(function(e){return e.getAttachmentWellInitialValue})),j=new r.b(a,(function(e){return e.getAttachmentWellForCompose})),I=new r.b(a,(function(e){return e.getConversationAttachmentWellInitialValue})),w=(new r.b(a,(function(e){return e.getMaxClassicAttachmentsSize})),new r.b(a,(function(e){return e.getAvailableLocalAttachmentSize}))),h=new r.b(a,(function(e){return e.createAttachmentFileFromExistingMailboxAttachment})),g=new r.a(a,(function(e){return e.mergeToConversationAttachmentWell})),S=new r.a(a,(function(e){return e.sortConversationAttachmentWell})),x=new r.a(a,(function(e){return e.convertImageViewAttachmentToInlineAttachment})),A=new r.b(a,(function(e){return e.getLastCloudyAttachmentsSharingIssueForBlockOnSend})),E=new r.b(a,(function(e){return e.getAllValidAttachments})),y=new r.b(a,(function(e){return e.uploadLocalFile}))},2151:function(e,t,n){"use strict";var r=n(1),o=n(2527),i=n(183),a=Object(i.action)("addInfoBarMessage")((function(e,t,n){if(e){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=Object(r.j)([],Object(r.g)(e.infoBarIds));var i=e.infoBarHostKey;n&&(o.b[i]||(o.b[i]={}),o.b[i][t]=n)}}));t.a=a},2180:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2094),o=function(){return Object(r.a)().smtpAddress}},2224:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2030);function o(e,t){return{headers:Object(r.e)(e,"GroupMailbox",!1,t)}}},2248:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_ATTACHMENT_CREATED",(function(e,t,n,r){return void 0===r&&(r=!0),{parentItemId:e,attachmentId:t,attachment:n,shouldTriggerAddInAttachmentsChangedCallback:r}}))},2249:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_ATTACHMENT_DELETED",(function(e,t,n,r){return void 0===r&&(r=!0),{parentItemId:e,attachmentId:t,attachment:n,shouldTriggerAddInAttachmentsChangedCallback:r}}))},2273:function(e,t,n){"use strict";n(2224);var r=n(2160),o=n(2),i=Object(o.action)("EDIT_GROUP_SUCCESS",(function(e,t){return{groupSmtp:e,photoUrl:t}})),a=Object(o.action)("ADD_GROUP_MEMBER_SUCCESS",(function(e){return{groupSmtp:e}})),c=Object(o.action)("MEMBER_MANAGEMENT_SUCCESS",(function(e){return{groupSmtp:e}})),u=Object(o.action)("POPUP_OPENED",(function(){return{isOpen:!0}})),s=Object(o.action)("POPUP_CLOSED",(function(){return{isOpen:!1}})),d=Object(o.action)("DELETE_GROUP_SUCCESS",(function(e){return{groupSmtp:e}})),l=Object(o.action)("EDIT_GROUP_SMTP_SUCCESS",(function(e,t,n,r){return{aadObjectId:e,groupSmtp:t,photoUrl:n,oldGroupSmtp:r}})),f=n(2203);n.d(t,"n",(function(){return r.a})),n.d(t,"m",(function(){return i})),n.d(t,"j",(function(){return a})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"p",(function(){return s})),n.d(t,"k",(function(){return d})),n.d(t,"l",(function(){return l})),n.d(t,"g",(function(){return f.g})),n.d(t,"c",(function(){return f.c})),n.d(t,"d",(function(){return f.d})),n.d(t,"a",(function(){return f.a})),n.d(t,"e",(function(){return f.e})),n.d(t,"f",(function(){return f.f})),n.d(t,"i",(function(){return f.i})),n.d(t,"b",(function(){return f.b})),n.d(t,"h",(function(){return f.h}))},2527:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r={};function o(e,t){var n,o=e.infoBarHostKey;return null===(n=r[o])||void 0===n?void 0:n[t]}},2584:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(14),o=n(2),i={clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,rmsTemplates:new r.ObservableMap,messageClassifications:new r.ObservableMap},a=Object(o.createStore)("protection",i),c=a()},2597:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(31),o=new r.c((function(){return Promise.all([n.e(21),n.e(24),n.e(64),n.e(68),n.e(641)]).then(n.bind(null,4145))})),i=new r.a(o,(function(e){return e.loadAndInitializeFloodgateEngine})),a=new r.b(o,(function(e){return e.logFloodgateActivity}))},2603:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return a})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"p",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"n",(function(){return O})),n.d(t,"r",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return j})),n.d(t,"j",(function(){return I})),n.d(t,"f",(function(){return w})),n.d(t,"i",(function(){return h})),n.d(t,"a",(function(){return g}));var r=n(31),o=new r.c((function(){return Promise.all([n.e(4),n.e(22),n.e(26),n.e(43),n.e(42),n.e(77),n.e(78),n.e(82),n.e(194),n.e(908)]).then(n.bind(null,4342))})),i=new r.a(o,(function(e){return e.onSmimeItemAttachmentOpened})),a=new r.a(o,(function(e){return e.mergeSmimeDecodedMessageProperties})),c=(new r.b(o,(function(e){return e.fetchAndDecodeSmimeMessage})),new r.b(o,(function(e){return e.setSmimePropertiesInDraftMessage}))),u=new r.b(o,(function(e){return e.trySetSmimeProperties})),s=new r.b(o,(function(e){return e.tryAddSmimeProperties})),d=new r.b(o,(function(e){return e.createMailResponseBodyContent})),l=new r.b(o,(function(e){return e.downloadSmimeAttachment})),f=new r.b(o,(function(e){return e.getMergedSmimeViewState})),b=new r.b(o,(function(e){return e.getMergedSmimeViewStateForDraft})),v=new r.b(o,(function(e){return e.isSmimeItemDecoding})),O=new r.b(o,(function(e){return e.previewSmimeAttachment})),p=new r.b(o,(function(e){return e.updateSmimeAttachmentIds})),m=new r.b(o,(function(e){return e.createSmimeAttachmentsFromFiles})),j=new r.b(o,(function(e){return e.createSmimeAttachmentsViaSmimeQueueManager})),I=new r.b(o,(function(e){return e.initializeAttachmentStateForSmimeAttachments})),w=new r.b(o,(function(e){return e.getAttachmentsForSmimeResponse})),h=new r.b(o,(function(e){return e.getSmimeAttachmentsForRequest})),g=Object(r.d)(o,(function(e){return e.SignatureDetails}))},2841:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19),o=n(24);function i(){var e;return(null===(e=Object(r.a)().UserOptions)||void 0===e?void 0:e.SendFromAliasEnabled)&&Object(o.i)("cmp-proxy-address")}},2905:function(e,t,n){"use strict";var r,o;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),function(e){e.Unknown="Unknown",e.Like="Like",e.AtMention="AtMention",e.GroupMention="GroupMention",e.MeMention="MeMention",e.FileMention="FileMention",e.GroupAtAllMention="GroupAtAllMention",e.TxpRentalCarReservation="TxpRentalCarReservation",e.TxpFlightReservation="TxpFlightReservation",e.TxpLodgingReservation="TxpLodgingReservation",e.TxpFoodEstablishmentReservation="TxpFoodEstablishmentReservation",e.TxpEventReservation="TxpEventReservation",e.TxpParcelDelivery="TxpParcelDelivery",e.TxpInvoice="TxpInvoice",e.TxpServiceReservation="TxpServiceReservation",e.UserAtMentioned="UserAtMentioned",e.TaskNotificationInsight="TaskNotificationInsight",e.FollowUpNotificationInsight="FollowUpNotificationInsight",e.OutOfRoutineNotificationInsight="OutOfRoutineNotificationInsight",e.RealTimeFlightUpdate="RealTimeFlightUpdate",e.YammerLiveEventNotification="YammerLiveEventNotification",e.Reactions="Reactions"}(r||(r={})),function(e){e[e.None=0]="None",e[e.IsDismissed=1]="IsDismissed",e[e.IsSeen=4]="IsSeen",e[e.IsRead=8]="IsRead",e[e.IsCompleted=16]="IsCompleted",e[e.IsFlagged=32]="IsFlagged"}(o||(o={}))},3272:function(e,t,n){"use strict";var r=n(2),o=Object(r.action)("OnComposeLifecycleEvent",(function(e,t){return{viewState:e,event:t}}));t.a=o},3299:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"g",(function(){return v}));var r=n(2363),o=n(31),i=new o.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(16),n.e(22),n.e(28),n.e(31),n.e(40),n.e(53),n.e(59),n.e(87),n.e(187),n.e(310),n.e(1042)]).then(n.bind(null,4495))}));Object(o.f)(r.d,i,(function(e){return e.openTimePanelOrchestrator}));var a=Object(o.d)(i,(function(e){return e.TimePanel})),c=Object(o.d)(i,(function(e){return e.TimePanelHeaderBar})),u=new o.a(i,(function(e){return e.loadTimePanelData})),s=new o.a(i,(function(e){return e.openEventDetailsView})),d=(new o.a(i,(function(e){return e.openAttendeeTrackingView})),new o.a(i,(function(e){return e.closeAttendeeTrackingView})),new o.a(i,(function(e){return e.openTasksView}))),l=new o.a(i,(function(e){return e.openCalendarView})),f=new o.a(i,(function(e){return e.openConflictsView})),b=new o.a(i,(function(e){return e.closeConflictsView})),v=new o.a(i,(function(e){return e.openEventQuickComposeView}))},3316:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("saveReadingPanePositionOption")},3463:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var r=n(31),o=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(5),n.e(10),n.e(22),n.e(779)]).then(n.bind(null,6327))})),i=new r.a(o,(function(e){return e.loadCLPUserLabels})),a=(new r.a(o,(function(e){return e.addAuditActionToViewState})),new r.b(o,(function(e){return e.showJustificationModal}))),c=new r.a(o,(function(e){return e.loadItemCLPInfo})),u=new r.b(o,(function(e){return e.updateItemCLPInfo})),s=new r.b(o,(function(e){return e.logReadCLPLabel})),d=new r.b(o,(function(e){return e.triggerCLPAutoLabeling})),l=(new r.b(o,(function(e){return e.constructCLPAuditAction})),Object(r.d)(o,(function(e){return e.CLPSubjectHeaderLabel}))),f=Object(r.d)(o,(function(e){return e.CLPMandatoryLabelModal}))},3700:function(e,t,n){"use strict";var r=n(24),o=n(2584),i=n(197);t.a=function(){var e=o.b.clpLabels;return Object(r.i)("cmp-clp")&&e.length>0&&e.some((function(e){return e.isLabelEnabled}))&&!Object(i.a)()}},3866:function(e,t,n){"use strict";var r=n(31),o=n(2),i=n(3316),a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5),n.e(10),n.e(15),n.e(17),n.e(16),n.e(19),n.e(22),n.e(24),n.e(25),n.e(28),n.e(29),n.e(46),n.e(50),n.e(65),n.e(91),n.e(106),n.e(109),n.e(122),n.e(161),n.e(957)]).then(n.bind(null,18006))})),c=(new r.a(a,(function(e){return e.saveReadingPaneOptionQuick})),n(2716)),u=n(2521),s=n(2522),d=n(2523),l=n(183),f=n(2010),b=Object(l.action)("onPrintRow")((function(){Object(f.c)()&&(Object(d.a)(!0),Object(s.a)(!1))})),v=Object(l.action)("onNewMessage")((function(e){e||(Object(d.a)(!0),Object(s.a)(!Object(f.c)()))})),O=n(3944);n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return I})),n.d(t,"f",(function(){return w})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"a",(function(){return O.a}));var p=new r.c((function(){return Promise.all([n.e(72),n.e(76),n.e(718)]).then(n.bind(null,18336))})),m=new r.a(p,(function(e){return e.onReplyOrReplyAllOrForwardMessage})),j=(new r.b(p,(function(e){return e.onSxSPreviewPaneClose})),new r.a(p,(function(e){return e.onReadingPanePositionOptionSaved}))),I=new r.a(p,(function(e){return e.onSelectMessageAd}));function w(){Object(o.orchestrator)(i.a,(function(){j.importAndExecute()}))}Object(r.f)(c.a,p,(function(e){return e.onClientReadingPanePositionChangeOrchestrator})),Object(r.f)(u.a,p,(function(e){return e.closeImmersiveReadingPaneOrchestrator}))},3944:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("exitSearch",(function(e){return{actionSource:e}}))},4045:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_REMINDER_CLICKED",(function(e,t){return{itemId:e,reminderType:t}}))},4170:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var r=n(31),o=n(4373);n.d(t,"h",(function(){return o.a}));var i=n(4374);n.d(t,"g",(function(){return i.a}));var a=n(4375);n.d(t,"i",(function(){return a.a}));var c=n(4171);n.d(t,"c",(function(){return c.a}));var u=n(4172);n.d(t,"e",(function(){return u.a}));var s=n(4173);n.d(t,"d",(function(){return s.a}));var d=n(4045);n.d(t,"f",(function(){return d.a}));var l=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(16),n.e(28),n.e(31),n.e(40),n.e(53),n.e(106),n.e(135),n.e(187),n.e(219),n.e(681)]).then(n.bind(null,8478))})),f=Object(r.d)(l,(function(e){return e.NotificationPane})),b=new r.b(l,(function(e){return e.onDismissAutomaticReplyNotification}))},4171:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_LIKE_NOTIFICATION_CLICKED",(function(e){return{notification:e}}))},4172:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_REACTION_NOTIFICATION_CLICKED",(function(e){return{notification:e}}))},4173:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_NEW_MAIL_NOTIFICATION_NAVIGATED",(function(e){return{notification:e}}))},4175:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return d}));var r=n(31),o=n(2905);n.d(t,"c",(function(){return o.b}));var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(7),n.e(13),n.e(14),n.e(121),n.e(135),n.e(165),n.e(218),n.e(338)]).then(n.bind(null,6323))})),a=Object(r.d)(i,(function(e){return e.ActivityFeed})),c=new r.a(i,(function(e){return e.initializeActivityFeed})),u=Object(r.d)(i,(function(e){return e.ActivityFeedTitle})),s=new r.a(i,(function(e){return e.postWeveSignal})),d=new r.a(i,(function(e){return e.loadActivityFeed}))},4373:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=[];function o(e){r.push(e)}function i(e){return r.reduce((function(t,n){return t||n(e)}),!1)}},4374:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=[];function o(e){r.push(e)}function i(e){return r.reduce((function(t,n){return t||n(e)}),!1)}},4375:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=[];function o(e){r.push(e)}function i(e){return r.reduce((function(t,n){return t||n(e)}),!1)}},5201:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1955);function o(e){var t=r.a.conversations.get(e);return null==t?void 0:t.canLoadMore}},5211:function(e){e.exports=JSON.parse('{"e":"r1a","a":"s1a","n":"u1a","p":"v1a","u":"x1a","q":"y1a","m":"z1a","j":"A1a","s":"B1a","r":"C1a","h":"D1a","o":"E1a","k":"F1a","t":"G1a","i":"H1a","g":"I1a","l":"J1a","f":"K1a","d":"L1a","b":"M1a","c":"N1a"}')},5407:function(e,t,n){"use strict";var r=n(31),o=n(5651);function i(e){var t;return null===(t=o.a.usageSuggestions)||void 0===t?void 0:t.get(e)}n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return i}));var a=new r.c((function(){return n.e(970).then(n.bind(null,18312))})),c=new r.a(a,(function(e){return e.initializePersonalizationSuggestions})),u=(new r.a(a,(function(e){return e.postPersonalizationSuggestionFeedback})),new r.a(a,(function(e){return e.postPersonalizationUsageSignals})))},5645:function(e,t,n){"use strict";var r=n(3559),o=n(44);t.a=Object(o.d)("expandCollapsedItemsRollUp",r.a.RPCountExpCollItemsRollUp)((function(e,t){void 0===t&&(t=!1),e.conversationNodeIdsInCollapsedItemsRollUp=[]}))},5651:function(e,t,n){"use strict";var r=n(14),o=n(2),i={usageSuggestions:new r.ObservableMap},a=Object(o.createStore)("personalization",i)();t.a=a},615:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"}(r||(r={}))},6623:function(e,t,n){"use strict";var r=n(5645),o=n(3559),i=n(2093),a=n(3823),c=n(121),u=n(44),s=n(2449),d=n(1955),l=n(4217);t.a=Object(u.d)("loadMore",o.a.RPCountLoadMore)((function(e,t){if(void 0===t&&(t={conversations:d.a.conversations,conversationReadingPaneViewState:Object(i.a)(e.Id)}),e&&t.conversations.has(e.Id)){var n=t.conversations.get(e.Id);n.isLoadMoreInProgress=!0,n.maxItemsToReturn=n.maxItemsToReturn+s.a,n.syncState="";var o=Object(c.u)();return o&&o.addCustomData([(u=n.maxItemsToReturn,f=Math.ceil((u-20)/10),Object(l.a)(f))]),Object(a.b)(t.conversationReadingPaneViewState)&&Object(r.a)(t.conversationReadingPaneViewState,!0),s.e.importAndExecute(e,"LoadMore")}var u,f;return Promise.resolve()}))},6636:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2072),o=n(1947),i=n(2307),a=n(2048);function c(e){var t=Object(i.a)(),n=Object(o.G)([e],t)[0];t.rowKeys.includes(n)&&Object(r.q)(t,n,!0,a.a.RouteHandler)}},6858:function(e,t,n){"use strict";var r=n(1),o=n(2449),i=n(1956),a=n(209);function c(e){var t,n;return Object(r.c)(this,void 0,void 0,(function(){var c;return Object(r.f)(this,(function(r){switch(r.label){case 0:c=null===(t=i.u.conversations)||void 0===t?void 0:t.get(e),r.label=1;case 1:return!c||null!=c&&c.canLoadMoreForRelationMap?(c&&(c.isLoadMoreInProgress=!0,c.maxItemsToReturn=o.b,c.syncState=""),[4,o.e.importAndExecute({Id:e,mailboxInfo:Object(a.d)()},"CreateConversationRelationMap")]):[3,3];case 2:return r.sent(),c||(c=null===(n=i.u.conversations)||void 0===n?void 0:n.get(e))?[3,1]:[3,3];case 3:return[2]}}))}))}var u,s,d=n(6147);function l(){return u}function f(e){var t;return Object(r.c)(this,void 0,void 0,(function(){var n,o,a,d,l,f,v,O;return Object(r.f)(this,(function(p){switch(p.label){case 0:return s==e?[3,2]:(s=e,[4,c(e)]);case 1:if(p.sent(),!(n=null===(t=i.u.conversations)||void 0===t?void 0:t.get(e)))return[2,null];if(o=null==n?void 0:n.conversationNodeIds,a=null==o?void 0:o.length,!o||!a||0==a)return[2,null];for(d=Object(r.j)([],Object(r.g)(o)),"ChronologicalNewestOnBottom"===n.conversationSortOrder||d.reverse(),l=i.u.conversationNodes.get(d[0]),f=new Map,l&&f.set(l.internetMessageId,{itemIds:l.itemIds,childrenImIds:[]}),v=1;v<a;)O=i.u.conversationNodes.get(d[v]),b(f,O),v+=1;u=f,p.label=2;case 2:return[2,u]}}))}))}function b(e,t){if(t&&e){var n=t.internetMessageId,r=t.parentInternetMessageId,o=i.u.items.get(t.itemIds[0]),a=null==o?void 0:o.ItemClass,c=!!a&&d.a.test(a);if(!c&&r){var u=e.get(r);u&&u.childrenImIds.push(n)}e.set(n,{itemIds:t.itemIds,parentImId:c?void 0:r,childrenImIds:[]})}}n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}))},702:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(615),o=n(2),i=n(817),a=n(8),c={state:r.a.NotStarted,isPopoutV2:Object(a.a)(i.a)==i.b},u=Object(o.createStore)("popoutChild",c);u()},709:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c}));var r,o=2,i=[window.location.origin];function a(e,t,n){var r={version:o,type:t,serializedData:JSON.stringify(n)};e.postMessage(JSON.stringify(r),"*")}function c(e){if(i.indexOf(e.origin)>=0){var t=void 0;try{t=JSON.parse(e.data)}catch(e){return null}if(t&&o==t.version)return t}return null}!function(e){e[e.Unknown=0]="Unknown",e[e.PopoutReady=1]="PopoutReady",e[e.SetData=2]="SetData",e[e.CloseWindow=3]="CloseWindow",e[e.DeeplinkReady=4]="DeeplinkReady"}(r||(r={}))},7441:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1955);function o(e){var t,n,o=null===(n=null===(t=r.a.conversations)||void 0===t?void 0:t.get(e))||void 0===n?void 0:n.conversationNodeIds;return(null==o?void 0:o.length)>0}},817:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}));var r="popoutv2",o="1",i="_owa_projection_root"},8218:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",(function(e,t){return{conversationId:e,nodeIdCollectionChanged:t}}))},8221:function(e,t,n){"use strict";var r=n(1),o=n(4972),i=n(4511),a=n(5053),c=n(2112),u=n(2119),s=n(2624),d=n(2054),l=n(183),f=n(1947);t.a=Object(l.action)("reloadReadingPane")((function(e){var t,n;void 0===e&&(e={composeViewState:u.a.viewStates.get(u.a.primaryComposeId),conversationItems:f.ab.conversationItems});var l=Object(f.J)(),b=l?Object(r.j)([],Object(r.g)(l.selectedRowKeys.keys())):[];if(1==b.length){var v=f.b.getRowIdToShowInReadingPane(b[0],l),O=Object(s.a)(b,l)[0],p=l.tableQuery.listViewType;if(1===p||Object(d.a)())(null===(t=e.composeViewState)||void 0===t?void 0:t.isInlineCompose)?c.s.importAndExecute(e.composeViewState).then((function(){Object(i.a)(v,O,a.a)})):Object(i.a)(v,O,a.a);else if(0===p){var m=e.conversationItems.get(v.Id);(null===(n=e.composeViewState)||void 0===n?void 0:n.isInlineCompose)?c.s.importAndExecute(e.composeViewState).then((function(){Object(o.b)(v,O,m.subject)})):Object(o.b)(v,O,m.subject)}}}))},8230:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),o=n(5211),i=n(6),a=Object(r.action)("ADD_FIRST_EVENT",(function(){return{taskNewEventTitle:Object(i.b)(o.l)}}))},8235:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_KEYBOARD_UP_DOWN",(function(e,t,n,r){return{selectionDirection:e,tableView:t,mailListItemSelectionSource:n,shouldSelect:r}}))},8236:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_KEYBOARD_TOGGLE_SELECT",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}}))},8237:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_KEYBOARD_UP_DOWN",(function(e,t,n,r){return{tableView:e,selectedNodeIds:t,selectedRowKeys:n,mailListItemSelectionSource:r}}))},9440:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(31),o=new r.c((function(){return Promise.all([n.e(0),n.e(238),n.e(505)]).then(n.bind(null,12143))})),i=new r.a(o,(function(e){return e.subscribeToBulkActionNotification})),a=new r.a(o,(function(e){return e.findBulkActionItemAction}))},9572:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_ITEM_PART_SELECTED",(function(e,t){return{conversationNodeId:e,conversationId:t}}))},9622:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("CONFIRM_TIMEZONE")},9623:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),o=n(5211),i=n(6),a=n(19),c=Object(r.action)("SEND_AN_EMAIL",(function(){return{taskSendEmailSubject:Object(i.c)(Object(i.b)(o.s),Object(a.a)().SessionSettings.UserEmailAddress),taskSendEmailBody:Object(i.c)(Object(i.b)(o.r),Object(a.a)().SessionSettings.UserEmailAddress)}}))},9624:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("ADD_STORAGE_ACCOUNT")},9625:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("SETUP_SIGNATURE")},9626:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("SHOW_PERSONALIZATION_MODAL")},9629:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("COMPLETE_SEND_AN_EMAIL")},9630:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),o=Object(r.action)("COMPLETE_PERSONALIZATION")},9655:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(6442),o=n(6636);function i(e,t){Object(r.a)(e),Object(o.a)(t)}},9663:function(e,t,n){"use strict";var r=n(2),o=Object(r.action)("ON_CONVERSATION_OPTION_SAVED");t.a=o},982:function(e,t,n){"use strict";var r=n(31),o=n(1272),i=n(990),a=n(20),c=n(0),u=n(989),s=n(702),d=n(24),l=n(615),f=n(1301),b=n(1557),v=Object(a.a)((function(e){c.useEffect((function(){Object(d.i)("rp-popoutsDebug")||O()}),[]);return c.createElement("div",{className:b.view},Object(s.a)().state==l.a.Loading?c.createElement("span",null,c.createElement(f.a,null),e.loadingString):c.createElement("button",{onClick:O},"Get Data"))}));function O(){Object(u.a)()}function p(e,t,n,r){var o="";if(r)o="readimid/",o+=encodeURIComponent(btoa(r));else{if(o=n?"readconv/":"read/",e&&"GroupMailbox"==e.type){o+="group/";var i=e.mailboxSmtpAddress.split("@");o+=i[1]+"/"+i[0]+"/"}o+=encodeURIComponent(n||t)}return o}var m=n(1269);n(1271);n.d(t,"h",(function(){return I})),n.d(t,"c",(function(){return o.a})),n.d(t,"i",(function(){return i.a})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return l.a})),n.d(t,"f",(function(){return s.a})),n.d(t,"d",(function(){return u.b})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return m.a}));var j=new r.c((function(){return n.e(982).then(n.bind(null,18279))})),I=new r.b(j,(function(e){return e.bootPopout}))},989:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l}));var r,o=n(1),i=n(990),a=n(709),c=n(615),u=n(702),s=!1;function d(){Object(i.a)(c.a.Loading),r?r():s=!0}function l(e){return Object(o.c)(this,void 0,void 0,(function(){return Object(o.f)(this,(function(t){switch(t.label){case 0:return s?[3,2]:[4,new Promise((function(e){r=function(){e()}}))];case 1:t.sent(),t.label=2;case 2:return[2,Object(u.a)().isPopoutV2?new Promise((function(t,n){var r=function(n){var o=Object(a.b)(n);if(o&&o.type==a.a.SetData){window.removeEventListener("message",r);var i=void 0;try{i=e?e(o.serializedData):JSON.parse(o.serializedData)}catch(e){}t(i)}};window.addEventListener("message",r);try{var o=window.opener;Object(a.c)(o,a.a.PopoutReady,null)}catch(e){t(null)}})):Promise.resolve(null)]}}))}))}},990:function(e,t,n){"use strict";var r=n(702),o=n(2),i=n(615),a=n(709);t.a=Object(o.mutatorAction)("setPopoutChildState",(function(e){var t=Object(r.a)();t.state=e,e==i.a.Ready&&t.isPopoutV2&&window.opener&&Object(a.c)(window.opener,a.a.DeeplinkReady,null)}))}}]);
//# sourceMappingURL=owa.MailBoot~MailFunctionalBoot.js.map
self.scriptsLoaded['owa.MailBoot~MailFunctionalBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFunctionalBoot.js'] = (new Date()).getTime();