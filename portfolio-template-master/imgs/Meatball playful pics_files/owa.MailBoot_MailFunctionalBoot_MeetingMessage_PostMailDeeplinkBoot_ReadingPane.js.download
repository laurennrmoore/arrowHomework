self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFunctionalBoot~MeetingMessage~PostMailDeeplinkBoot~ReadingPane.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[154],{1005:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"GetNotesForPersonaRequest:#Exchange"},e)}},1012:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"PersonaPropertyUpdate:#Exchange"},e)}},1092:function(e,t,n){"use strict";var r=n(24),i=n(53),s=n(1093),o=n(197),a=n(1279);n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d}));var u={NotResolved:"NotResolved",User:"User",Group:"Group",External:"External",DistributionList:"DistributionList",PrivateDistributionList:"PrivateDistributionList",Location:"Location",Room:"Room",Meeting:"Meeting",Brand:"Brand",Topic:"Topic"};function c(e,t,n,c){if(e)return{personaType:u.User,isBrand:!1,isTier3Brand:!1};if(Object(r.i)("rp-brandCards")&&!Object(i.b)(c)&&Object(s.a)(c)){var l=Object(s.b)(c);return{personaType:u.Brand,isBrand:!0,isTier3Brand:l}}return Object(i.b)(t)?!Object(i.b)(n)&&Object.keys(u).indexOf(n)>-1?{personaType:n,isBrand:!1,isTier3Brand:!1}:(f=c,Object(a.a)(f,"@groups.outlook.com")?{personaType:"Group",isBrand:!1,isTier3Brand:!1}:Object(o.a)()?{personaType:"User",isBrand:!1,isTier3Brand:!1}:{personaType:"NotResolved",isBrand:!1,isTier3Brand:!1}):{personaType:d(t),isBrand:!1,isTier3Brand:!1};var f}function d(e){switch(e){case"PublicDL":return u.DistributionList;case"PrivateDL":return u.PrivateDistributionList;case"GroupMailbox":return u.Group;case"Mailbox":case"Contact":return u.User;case"OneOff":case"Unknown":return u.NotResolved;default:return u.User}}},11548:function(e,t,n){"use strict";var r=n(2),i=Object(r.createStore)("TrustedSenders",{trustedSendersAndDomains:null})();t.a=i},1253:function(e,t,n){"use strict";t.a=function(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}},1263:function(e,t,n){"use strict";var r=n(1),i=n(0),s=n(212),o=n(991),a=n(1322),u=n(211),c=n(121),d=n(772),l=n(20),f=n(1285),b=n(1092),p=n(24),v=Object(l.a)((function(e){var t=e.personaSize,n=e.identifiers,r=e.styles,s=e.children,o=e.onPersonaInsightRingStateChange,a="User"===n.PersonaType||"NotResolved"===n.PersonaType,c=window.PersonaInsightRing;return c&&u.a.isLivePersonaCardInitialized&&a?i.createElement(c,{identifiers:n,styles:r,personaSize:t,onPersonaInsightRingStateChange:o},s):i.createElement(i.Fragment,null,s)}));var O=n(1280);n.d(t,"a",(function(){return h}));var m=Object(l.a)((function(e){var t=e.composeEmailOverride,n=e.isUnauthenticatedSender,m=e.mailBoxType,h=e.personaType,j=e.emailAddress,y=e.clientScenario,g=e.locationToOpen,S=e.focusReturnElement,w=e.tabIndex,P=e.olsPersonaId,C=e.topicId,T=e.name,B=e.disableHover,I=e.ariaLabel,R=e.className,N=e.children,E=e.size,U=e.aadObjectId,x=e.displayPersonaHighlightRing,L=e.mountWithoutWrapperSpan,A=e.disableAccessibilityDefaults,D=Object(r.g)(i.useState(!1),2),k=D[0],F=D[1];i.useEffect((function(){Object(a.a)(t),Object(o.a)()}),[]);var _,z=i.useMemo((function(){return Object(b.b)(n,m,h,j)}),[n,m,h,j,u.a.brandListLoadState]),M=i.useCallback((function(){return function(e,t,n){if(Object(p.i)("grp-TransferOwnership")){var r=document.getElementById("TransferOwnershipGroupDialog");r&&(s.unmountComponentAtNode(r),document.body.removeChild(r))}e.isBrand&&Object(c.s)(e.personaType===b.a.Brand?"BrandCardDisplayed":"BrandDetectedButNotDisplayed");var i=t||"No Client Scenario",o=n||"LPC";Object(c.s)("LPCRenderedFromHoverTarget",{clientScenario:i,locationToOpen:o})}(z,y,g)}),[z,y,g]),G=i.useCallback((function(){S instanceof HTMLElement?S.focus():(null==S?void 0:S.current)&&S.current.focus()}),[S]),H=i.useCallback((function(e){F(e)}),[F]),q=Object(f.a)({text:T}),J=(_={displayPersonaHighlightRing:x,personaSize:E||Object(O.a)(),identifiers:{OlsPersonaId:P,TopicId:C,Smtp:j,PersonaType:z.personaType},onPersonaInsightRingStateChange:H},Object(l.a)((function(e){var t=e.children;return Object(p.i)("lpc-isPersonaInsightRingEnabled")&&_.displayPersonaHighlightRing?i.createElement(v,Object(r.a)({},_),t):i.createElement(i.Fragment,null,t)})));if(u.a.isLivePersonaCardInitialized){var $=window.LivePersonaCardHoverTargetV2,V=x?i.createElement(J,null,N):N;return i.createElement($,{tabIndex:w,cardParameters:{disableAccessibilityDefaults:A,externalAppSessionCorrelationId:d.lokiClientCorrelationId,personaInfo:{identifiers:{Smtp:j,PersonaType:z.personaType,OlsPersonaId:P,AadObjectId:U,TopicId:C},isUnauthenticatedSender:n,displayName:T,isTier3Brand:z.isTier3Brand,personaCoinColor:q},behavior:{disableHover:B,onCardOpen:M,onCardClose:G,locationToOpen:g},clientScenario:y,ariaLabel:I,hasPersonaInsightRing:k}},L?V:i.createElement("span",{className:R,"aria-label":I},V))}return i.createElement(i.Fragment,null,N)}));function h(e){return Object(l.a)((function(t){var n=t.children;return u.a.isPersonaCardDisabled?i.createElement(i.Fragment,null,n):i.createElement(m,Object(r.a)({},e),n)}))}},1265:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"GetPersonaJsonRequest:#Exchange"},e)}},1279:function(e,t,n){"use strict";var r=n(1253),i=n(732),s=n(866),o=n(864);t.a=function(e,t,n){e=Object(o.a)(e),t=Object(i.a)(t);var a=e.length,u=n=void 0===n?a:Object(r.a)(Object(s.a)(n),0,a);return(n-=t.length)>=0&&e.slice(n,u)==t}},1280:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(49),i=n(57),s=n(24);function o(){if(!Object(s.i)("mon-densities"))return r.c.size40;switch(Object(i.d)()){case"medium":return r.c.size32;case"compact":return r.c.size24;default:return r.c.size40}}},1300:function(e,t,n){"use strict";var r=n(1);function i(e){return e>0}var s=n(2),o=n(44),a=Object(s.action)("UNSUBSCRIBE_FROM_BRAND_SUBSCRIPTION",(function(e,t,n,r,i,s){return Object(o.c)({name:"UnsubscribeSubscription",customData:{unsubscribeSourceType:e}},{unsubscribeSourceType:e,smtpAddress:t,smtpIdentifier:n,unsubscribeSilentUris:r,unsubscribeHttpUri:i,completedCallback:s})})),u=Object(s.action)("AFTER_UNSUBSCRIBE",(function(e,t,n,r,i){return{smtpIdentifier:e,unsubscribeSourceType:t,responseType:n,debugMessage:r,completedCallback:i}})),c=n(6),d=n(151),l="ows/api/beta/subscriptions/{0}/unsubscribe";var f,b=function(e,t){return Object(d.d)(Object(c.c)(l,e),{unsubscribeSilentUris:t},null,!0)};!function(e){e[e.Fail=0]="Fail",e[e.Success=1]="Success"}(f||(f={}));var p=f,v=n(14),O=Object(s.createStore)("BrandSubscription",{subscriptions:new v.ObservableMap({}),unsubscribedSubscriptions:new v.ObservableMap({})})();function m(e){return e&&O.subscriptions.has(e.toLowerCase())?O.subscriptions.get(e.toLowerCase()):null}var h=Object(s.mutatorAction)("unsubscribeFromCache",(function(e){var t=Object(r.a)({},m(e));t?(O.subscriptions.delete(e.toLowerCase()),O.unsubscribedSubscriptions.set(e.toLowerCase(),t)):S()})),j=n(217);Object(s.orchestrator)(a,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n,s,o,a,c,d,l,f,v,O,m;return Object(r.f)(this,(function(r){switch(r.label){case 0:return t=e.unsubscribeSourceType,n=e.smtpAddress,s=e.smtpIdentifier,o=e.unsubscribeSilentUris,a=e.unsubscribeHttpUri,c=e.completedCallback,a&&0!==a.length||o&&0!==o.length?(o&&i(o.length)||!a?d="No unsubscribe URIs provided":(window.open(a,"_blank"),d="Opened unsubscribe URI in new tab"),[4,b(s,o)]):(d="No unsubscribe URIs or SilentURIs provided",l=p.Fail,u(s,t,l,d,c),[2,Promise.reject("No unsubscribe URIs or SilentURIs provided")]);case 1:return f=r.sent(),v=null,Object(j.a)(f.status)?(d="Unsubscribe service called successfully. "+d,l=p.Success,h(n),[3,4]):[3,2];case 2:return d="Unsubscribe service failed. "+d,l=p.Fail,[4,f.text().then((function(e){return e?JSON.parse(e):{}}))];case 3:O=r.sent(),(v=new Error("ResponseCode="+f.status+", ErrorMessage="+(null===(m=null==O?void 0:O.error)||void 0===m?void 0:m.message))).fetchErrorType="ServerFailure",r.label=4;case 4:return u(s,t,l,d,c),v?[2,Promise.reject(v)]:[2,Promise.resolve()]}}))}))}));Object(s.mutator)(u,(function(e){var t=e.unsubscribeSourceType,n=e.responseType,r=e.debugMessage,i=e.completedCallback;"BrandCard"===t&&i&&i(n===p.Success,r)}));var y=Object(s.mutatorAction)("populateSubscriptionStore",(function(e){e.subscriptions.forEach((function(e){var t;(null===(t=null==e?void 0:e.smtpInfo)||void 0===t?void 0:t.smtpAddress)&&O.subscriptions.set(e.smtpInfo.smtpAddress.toLowerCase(),e)})),e.unsubscribedSubscriptions.forEach((function(e){var t;(null===(t=null==e?void 0:e.smtpInfo)||void 0===t?void 0:t.smtpAddress)&&O.unsubscribedSubscriptions.set(e.smtpInfo.smtpAddress.toLowerCase(),e)}))})),g="ows/api/beta/subscriptions?orderBy=name, asc";var S=function(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,Object(d.b)(e?g+"&noResolveBrand=true":g,void 0,!0)];case 1:return t=r.sent(),Object(j.a)(t.status)?[4,t.json()]:[3,3];case 2:return n=r.sent(),y(n),[2,n];case 3:return[2,null]}}))}))};n.d(t,"b",(function(){return S})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return i}))},1313:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(1),i=void 0,s=new Promise((function(e){i=e}));function o(e){null==i||i(e)}function a(){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(e){return[2,Promise.race([s,new Promise((function(e,t){setTimeout((function(){return t()}),45e3)}))])]}))}))}},1316:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(997),i=n(180),s=n(996);function o(e){if(!e)return Promise.reject(new Error("GetPersonaByEmailAddress failed"));var t=Object(r.a)({EmailAddress:{EmailAddress:e}});return Object(s.a)({Header:Object(i.b)(),Body:t}).then((function(e){if(e.Body&&"NoError"===e.Body.ResponseCode)return e.Body.Persona;throw new Error("GetPersonaByEmailAddress failed")}))}},1317:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(33),i=n(1005);function s(e,t){return void 0===e.getNotesForPersonaRequest||e.getNotesForPersonaRequest.__type||(e.getNotesForPersonaRequest=Object(i.a)(e.getNotesForPersonaRequest)),Object(r.a)("GetNotesForPersona",e,t)}},186:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function s(t){r--,delete e[t]}this.put=function(t,n,i,o){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var a=e[t];a?clearTimeout(a.timeout):r++;var u={value:n,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){s(t),o&&o(t,n)}.bind(this),i)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&s(t),n},this.clear=function(){for(var s in e)clearTimeout(e[s].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(s){var o=e[s];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return i&&t++,o.value;i&&n++,r--,delete e[s]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),s=n&&n.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(s)if(e[o])continue;var a=r[o],u=a.expire-i;if(u<=0){this.del(o);continue}u=u>0?u:void 0,this.put(o,a.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},2260:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(14),i=n(2),s={signInState:0,presences:new r.ObservableMap({}),processingManualSignIn:!1,isRetrySignInAllowed:!0},o=Object(i.createStore)("presenceStore",s),a=o();t.a=a},2317:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),i=Object(r.createStore)("chatStore",{isChatCalloutShown:!1,chatProvider:0});i()},2388:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2260);function i(){return 3==r.a.signInState}},2517:function(e,t,n){"use strict";var r=n(31),i=n(2388),s=n(2317);function o(){var e=Object(s.a)().chatProvider;return Object(i.a)()&&(3==e||4==e)}n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return o}));var a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(7),n.e(10),n.e(266),n.e(822)]).then(n.bind(null,18164))})),u=new r.a(a,(function(e){return e.initializeSkypeForBusiness})),c=new r.b(a,(function(e){return e.tryRegisterForPresenceUpdates})),d=new r.b(a,(function(e){return e.startChat})),l=new r.a(a,(function(e){return e.setIsSkypeShown})),f=Object(r.d)(a,(function(e){return e.UcmaChatView}))},2886:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2887),i=n(2260),s=n(49),o=n(24);function a(e){if(Object(o.i)("fwk-skypeBusinessV2")&&e){var t=Object(r.b)(e),n=function(e){switch(e){case"Offline":return s.b.offline;case"Away":case"BeRightBack":return s.b.away;case"Busy":case"IdleBusy":return s.b.busy;case"DoNotDisturb":return s.b.dnd;case"Online":case"IdleOnline":return s.b.online;case"None":return s.b.none}}(i.a.presences.get(t));return n||void 0}}},2887:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r="sip:";function i(e){if(!e)return null;var t=e.toLowerCase();return 0!=t.indexOf(r)&&(t=r+t),t}},326:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var r,i=n(1);function s(e){r=e}function o(){var e,t;return Object(i.c)(this,void 0,void 0,(function(){var n,s;return Object(i.f)(this,(function(i){switch(i.label){case 0:return(s=r)?[4,r()]:[3,2];case 1:s=i.sent(),i.label=2;case 2:if((n=s)&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},531:function(e,t,n){"use strict";var r=n(311),i=n(303),s="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(i.a)(e)&&Object(r.a)(e)==s}},699:function(e,t,n){"use strict";var r=/\s/;var i=function(e){for(var t=e.length;t--&&r.test(e.charAt(t)););return t},s=/^\s+/;var o=function(e){return e?e.slice(0,i(e)+1).replace(s,""):e},a=n(216),u=n(531),c=NaN,d=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,f=/^0o[0-7]+$/i,b=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(u.a)(e))return c;if(Object(a.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(a.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=o(e);var n=l.test(e);return n||f.test(e)?b(e.slice(2),n?2:8):d.test(e)?c:+e}},732:function(e,t,n){"use strict";var r=n(312),i=n(861),s=n(292),o=n(531),a=1/0,u=r.a?r.a.prototype:void 0,c=u?u.toString:void 0;t.a=function e(t){if("string"==typeof t)return t;if(Object(s.a)(t))return Object(i.a)(t,e)+"";if(Object(o.a)(t))return c?c.call(t):"";var n=t+"";return"0"==n&&1/t==-a?"-0":n}},861:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},864:function(e,t,n){"use strict";var r=n(732);t.a=function(e){return null==e?"":Object(r.a)(e)}},866:function(e,t,n){"use strict";var r=n(699),i=1/0,s=17976931348623157e292;var o=function(e){return e?(e=Object(r.a)(e))===i||e===-i?(e<0?-1:1)*s:e==e?e:0:0===e?e:0};t.a=function(e){var t=o(e),n=t%1;return t==t?n?t-n:t:0}},996:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(33),i=n(1265);function s(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("GetPersona",e,t)}},997:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"GetPersonaRequest:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.MailBoot~MailFunctionalBoot~MeetingMessage~PostMailDeeplinkBoot~ReadingPane.js.map
self.scriptsLoaded['owa.MailBoot~MailFunctionalBoot~MeetingMessage~PostMailDeeplinkBoot~ReadingPane.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFunctionalBoot~MeetingMessage~PostMailDeeplinkBoot~ReadingPane.js'] = (new Date()).getTime();