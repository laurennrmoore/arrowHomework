self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MarkRead.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[724],{14097:function(e){e.exports=JSON.parse('{"a":"yvb","b":"zvb","c":"Avb","d":"Bvb"}')},14098:function(e){e.exports=JSON.parse('{"a":"uvb","b":"vvb","c":"wvb","d":"xvb"}')},14099:function(e){e.exports=JSON.parse('{"a":"qvb","b":"rvb","c":"svb","d":"tvb"}')},2136:function(e,n,t){"use strict";var a={};t.r(a),t.d(a,"add",(function(){return u})),t.d(a,"remove",(function(){return s})),t.d(a,"removeAll",(function(){return l})),t.d(a,"getCount",(function(){return b})),t.d(a,"getTombstonedReasons",(function(){return v})),t.d(a,"clearMapForFolder",(function(){return m})),t.d(a,"removeRowsFromTombstone",(function(){return f}));var i=t(1),r=t(2),o=Object(r.createStore)("tombstone",{folderTombstoneMap:{}}),c=(o(),t(121)),d=t(183),u=Object(d.action)("tombstoneOperations.add")((function(e,n,t){if(1!=n.tableQuery.type&&"spotlight"!==n.tableQuery.scenarioType){var a=n.serverFolderId,i=o().folderTombstoneMap;a in i||(i[a]={});var r=i[a];e.forEach((function(e){var n=r[e];n?3!=t?n.indexOf(3)>-1||-1==n.indexOf(t)&&n.push(t):r[e]=[3]:r[e]=[t]}))}})),s=Object(d.action)("tombstoneOperations.remove")((function(e,n,t){var a=o().folderTombstoneMap;if(n in a){var i=a[n],r=i[e],c=r?r.indexOf(t):-1;if(-1==c)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");r.splice(c,1),0==r.length&&delete i[e],0==Object.keys(i).length&&delete a[n]}})),l=Object(d.action)("tombstoneOperations.removeAll")((function(){o().folderTombstoneMap={},Object(c.t)("TnS_RemoveAllFromTombstone")})),b=function(e,n){var t=o().folderTombstoneMap;if(!(e in t))return 0;var a=0,i=t[e];return Object.values(i).forEach((function(e){e==n&&a++})),a},v=function(e,n){var t=o().folderTombstoneMap;if(n in t){var a=t[n][e];if(a)return a}return[]},m=Object(d.action)("tombstoneOperations.clearMapForFolder")((function(e){var n=o().folderTombstoneMap;n[e]&&(Object(c.t)("TnS_ClearFolderMapInTombstone",[Object.keys(n[e]).length]),delete n[e])})),f=Object(d.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,n){var t,a,r=o().folderTombstoneMap;if(n in r){var c=r[n];try{for(var d=Object(i.k)(e),u=d.next();!u.done;u=d.next()){var s=u.value;s in c&&delete c[s]}}catch(e){t={error:e}}finally{try{u&&!u.done&&(a=d.return)&&a.call(d)}finally{if(t)throw t.error}}0==Object.keys(c).length&&delete r[n]}}));n.a=a},2308:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return r}));var a=20,i=10,r=100},2449:function(e,n,t){"use strict";var a=t(31),i=t(2560),r=t(1956),o=t(183),c=Object(o.action)("setIsPendingDeleteConversationItemParts")((function(e,n,t){void 0===t&&(t={conversationItemParts:r.u.conversations.get(e)});var a=t.conversationItemParts;a&&(a.isPendingDelete=n)})),d=t(2308);t.d(n,"d",(function(){return s})),t.d(n,"f",(function(){return l})),t.d(n,"e",(function(){return b})),t.d(n,"c",(function(){return i.a})),t.d(n,"g",(function(){return c})),t.d(n,"a",(function(){return d.b})),t.d(n,"b",(function(){return d.c}));var u=new a.c((function(){return Promise.all([t.e(15),t.e(17),t.e(16),t.e(286),t.e(722)]).then(t.bind(null,18252))})),s=new a.a(u,(function(e){return e.loadAllRecipientsForItem})),l=new a.a(u,(function(e){return e.loadItem})),b=new a.a(u,(function(e){return e.loadConversation}))},2511:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2),i=Object(a.action)("USERMAIL_INTERACTION",(function(e,n,t){return{interactionType:e,instrumentationContexts:n,triageContext:t}}))},2560:function(e,n,t){"use strict";t.d(n,"a",(function(){return d}));var a=t(1),i=t(1956),r=t(2487),o=t(3036),c=t(2);function d(e){var n,t,c,d;if(i.u.conversations.has(e)){var l=i.u.conversations.get(e);try{for(var b=Object(a.k)(l.conversationNodeIds),v=b.next();!v.done;v=b.next()){var m=v.value,f=i.u.conversationNodes.get(m);if(f)try{for(var k=(c=void 0,Object(a.k)(f.itemIds)),O=k.next();!O.done;O=k.next()){var j=O.value;Object(r.a)(j,1)}}catch(e){c={error:e}}finally{try{O&&!O.done&&(d=k.return)&&d.call(k)}finally{if(c)throw c.error}}u(m)}}catch(e){n={error:e}}finally{try{v&&!v.done&&(t=b.return)&&t.call(b)}finally{if(n)throw n.error}}s(e)}Object(o.a)()}var u=Object(c.mutatorAction)("deleteConversationNode",(function(e){i.u.conversationNodes.delete(e)})),s=Object(c.mutatorAction)("deleteConversation",(function(e){i.u.conversations.delete(e)}))},2638:function(e,n,t){"use strict";t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return c})),t.d(n,"a",(function(){return d}));var a=t(31),i=t(2511);t.d(n,"d",(function(){return i.a}));var r=new a.c((function(){return t.e(517).then(t.bind(null,4744))})),o=new a.a(r,(function(e){return e.onKeyboardUpDown})),c=new a.a(r,(function(e){return e.onOpenEmail})),d=new a.a(r,(function(e){return e.onKeyboardToggleSelect}))},2964:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(1951);function i(e){return Object(a.C)(e,"SharedMailbox")}},3036:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return r}));var a=t(2),i=Object(a.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),r=Object(a.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},3076:function(e){e.exports=JSON.parse('{"a":"gJa","c":"hJa","e":"iJa","b":"jJa","d":"kJa"}')},3458:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.action)("RELOAD_TABLE_ON_TRIAGE_ACTION_FAIL",(function(e){return{tableView:e}}))},3778:function(e,n,t){"use strict";var a=t(2136);function i(e,n,t){t&&a.a.removeRowsFromTombstone(e,n)}var r=t(3458);function o(e){e&&Object(r.a)(e)}var c=t(2028),d=t(121);function u(e,n,t,a,r,u){var s=Object(d.u)();return e.then((function(e){return s&&s.addCheckpoint("PAPCARM"),i(n,t,r),u?void 0:Object(c.a)(e)})).catch((function(e){return i(n,t,r),o(a),Promise.reject(e)}))}var s=t(1);function l(e,n,t,a,r){return e.then((function(e){if(i(n,t,r),e.ResponseMessages){var c=function(e,n){var t,a;try{for(var i=Object(s.k)(e),r=i.next();!r.done;r=i.next()){var c=r.value;if(c&&"Success"!=c.ResponseClass){o(n);var d=new Error("ResponseCode="+c.ResponseCode+", Stacktrace="+c.StackTrace);return d.fetchErrorType="ServerFailure",d}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(a=i.return)&&a.call(i)}finally{if(t)throw t.error}}return null}(e.ResponseMessages.Items,a);return c?Promise.reject(c):Promise.resolve()}return Promise.reject(new Error("processUpdateItemActionResponseMessage empty response"))})).catch((function(e){return i(n,t,r),o(a),Promise.reject(e)}))}t.d(n,"c",(function(){return u})),t.d(n,"d",(function(){return l})),t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return o}))},3804:function(e){e.exports=JSON.parse('{"a":"Cvb"}')},4204:function(e){e.exports=JSON.parse('{"a":"lvb","c":"mvb","e":"nvb","b":"ovb","d":"pvb"}')},4762:function(e,n,t){"use strict";t.r(n);var a=t(1),i=t(1947),r={markConversationAsRead:{name:function(e,n,t,a,i,r,o){var c="TnS_MarkConversation";return c+=t?"Read":"Unread",a||(c+="Background"),c},options:function(e,n,t,a,i,r,o){return a?{isCore:!0}:{sessionSampleRate:10}},customData:function(e,n,t,a,r,o,c){return[r,e.length,Object(i.m)(n),Object(i.R)(n)]},cosmosOnlyData:function(e,n,t,r,o,c,d){var u,s,l=[],b=Object(i.G)(e,n);try{for(var v=Object(a.k)(b),m=v.next();!m.done;m=v.next()){var f=m.value;l.push(i.b.getItemIds(f,n))}}catch(e){u={error:e}}finally{try{m&&!m.done&&(s=v.return)&&s.call(v)}finally{if(u)throw u.error}}return JSON.stringify({itemIds:l,conversationIds:e})}},markItemReadUnread:{name:function(e,n,t,a,i,r){var o="TnS_MarkItem";return o+=t?"Read":"Unread",a||(o+="Background"),o},options:function(e,n,t,a,i,r){return a?{isCore:!0}:{}},customData:function(e,n,t,a,r,o){var c=e?e.tableQuery.type:null,d=e?Object(i.m)(e):null,u=e?Object(i.R)(e):null;return[c,n.length,d,u]},cosmosOnlyData:function(e,n,t,a,i,r){return JSON.stringify({itemIds:n})},actionSource:function(e,n,t,a,i){return i}}},o=t(183),c=t(2),d=Object(c.createStore)("markread",{markAsReadTimerTask:null,suppressedItemIdsMap:{}})(),u=Object(o.action)("AddMarkReadSuppressedItemIds")((function(e,n){void 0===n&&(n={store:d}),e.forEach((function(e){return n.store.suppressedItemIdsMap[e]=!0}))})),s=Object(o.action)("RemoveMarkReadSuppressedItemIds")((function(e,n){void 0===n&&(n={store:d}),e.forEach((function(e){return delete n.store.suppressedItemIdsMap[e]}))})),l=Object(o.action)("ClearMarkReadSuppressedMap")((function(e){void 0===e&&(e={store:d}),e.store.suppressedItemIdsMap={}}));function b(e){for(var n=0;n<e.length;n++)if(!d.suppressedItemIdsMap[e[n]])return!1;return!0}var v=t(7412),m=t(2638),f=t(2524),k=t(8715),O=t(2013),j=t(23),p=t(44),y=t(3778);var I=t(1955);var N=t(2525),R=t(1250),h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkItemAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipts"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markItemAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"isRead"},value:{kind:"Variable",name:{kind:"Name",value:"isRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressReadReceipts"},value:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipts"}}},{kind:"ObjectField",name:{kind:"Name",value:"isUserInitiated"},value:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},T=t(19),g=Object(p.d)("markItemsAsReadBasedOnItemIds",r.markItemReadUnread)((function(e,n,t,r,o,c){return Object(a.c)(this,void 0,void 0,(function(){var d,l,b,f,k;return Object(a.f)(this,(function(a){return 0==(d=function(e,n){var t=[];return e.forEach((function(e){var a=I.a.items.get(e);Object(i.Y)(a)&&a&&a.IsRead!=n&&t.push(e)})),t}(n,t)).length?[2,Promise.resolve()]:(t?s(d):r?u(d):j.g.warn("Invalid scenario to implicitly mark item as unread."),l=e?e.id:null,Object(N.a)(d,t,r,l),v.a.import().then((function(n){n(e?e.tableQuery:null,!1,t,o,d)})),b={itemIds:d},t?r?Object(m.d)("MarkAsRead",c,b):Object(m.d)("MarkAsReadImplicit",c,b):Object(m.d)("MarkAsUnread",c,b),f=Object(O.e)(e.tableQuery).mailboxInfo,k=e?Object(i.G)(d,e):[],[2,w(e,k,d,t,r,f)])}))}))}));function w(e,n,t,i,r,o){return Object(a.c)(this,void 0,void 0,(function(){var c,d,u,s;return Object(a.f)(this,(function(a){switch(a.label){case 0:c=Object(T.a)(),d="AlwaysSend"!=c.UserOptions.ReadReceipt,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,A.invokeMarkItemAsReadMutation(t,i,d,r,o)];case 2:return a.sent(),[2];case 3:return u=a.sent(),s=e?e.serverFolderId:null,Object(y.a)(n,s,!0),[2,Promise.reject(u)];case 4:return[2]}}))}))}var A={invokeMarkItemAsReadMutation:function(e,n,t,i,r){var o;return Object(a.c)(this,void 0,void 0,(function(){var c;return Object(a.f)(this,(function(a){switch(a.label){case 0:return[4,Object(R.a)()];case 1:return[4,a.sent().mutate({variables:{ids:e,isRead:n,suppressReadReceipts:t,isUserInitiated:i,mailboxInfo:r},mutation:h})];case 2:return c=a.sent(),[2,null===(o=null==c?void 0:c.data)||void 0===o?void 0:o.markItemAsRead]}}))}))}},V={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkConversationAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markConversationAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"isRead"},value:{kind:"Variable",name:{kind:"Name",value:"isRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"isUserInitiated"},value:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},S=t(5639),M=Object(p.d)("markConversationsAsReadBasedOnConversationIds",r.markConversationAsRead)((function(e,n,t,r,o,c,d){var s=function(e,n,t){var a=[];return e.forEach((function(e){var r=Object(i.N)(e,n);if(r){var o=0==r.unreadCount,c=r.itemIds.length,d=r.unreadCount==c;o&&t||d&&!t||a.push(e)}})),a}(d,n.id,t);if(0==s.length)return Promise.resolve();if(1==e.length&&1==n.selectedRowKeys.size){var b=i.b.getRowIdString(s[0],n),p=Object(i.N)(Object(a.j)([],Object(a.g)(n.selectedRowKeys.keys()))[0],n.id);if(b==p.id){var I=p.itemIds;t?l():r?u(I):j.g.warn("Invalid scenario to implicitly mark conversation as unread.")}}Object(f.a)(e,n.id,t,r),v.a.import().then((function(a){a(n.tableQuery,!1,t,o,e)}));var N={conversationIds:e};t?r?Object(m.d)("MarkAsRead",c,N):Object(m.d)("MarkAsReadImplicit",c,N):Object(m.d)("MarkAsUnread",c,N);var R=Object(O.e)(n.tableQuery).mailboxInfo;return Object(i.e)(n)?function(e,n,t,r,o){var c=[];return n.forEach((function(n){c.push.apply(c,Object(a.j)([],Object(a.g)(i.b.getItemIds(n,e))))})),w(e,n,c,t,r,o)}(n,s,t,r,R):function(e,n,t,a,r){var o=Object(k.a)(e),c=n.map((function(n){return Object(i.i)(n,e.id)})),d=x.invokeMarkConversationAsReadMutation(c,t,a,o,r),u=Object(i.db)(e,t,a);return Object(y.c)(d,n,o,e,u,!0)}(n,s,t,r,R)}));var x={invokeMarkConversationAsReadMutation:function(e,n,t,i,r){var o;return Object(a.c)(this,void 0,void 0,(function(){var c,d;return Object(a.f)(this,(function(a){switch(a.label){case 0:return c=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(S.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(R.a)()];case 1:return[4,a.sent().mutate({variables:{conversations:c,isRead:n,isUserInitiated:t,folderId:i,mailboxInfo:r},mutation:V})];case 2:return d=a.sent(),[2,null===(o=null==d?void 0:d.data)||void 0===o?void 0:o.markConversationAsRead]}}))}))}},C=t(2559),F=Object(o.action)("autoMarkConversationAsRead")((function(e,n,t){return void 0===t&&(t={items:I.a.items}),Object(a.c)(this,void 0,void 0,(function(){var r,o,c,u,s,v,m,f,k;return Object(a.f)(this,(function(O){switch(O.label){case 0:return r=Object(i.G)([e],n),(o=Object(C.a)(r[0],n.id))?Object(i.g)(n)?b(c=o.itemIds)?[2]:0!=Object.keys(d.suppressedItemIdsMap).length?[3,2]:[4,M([e],n,!0,!1,null,[],r)]:[2]:[2];case 1:return O.sent(),[3,9];case 2:O.trys.push([2,7,8,9]),u=Object(a.k)(c),s=u.next(),O.label=3;case 3:return s.done?[3,6]:b([v=s.value])||!t.items.get(v)?[3,5]:[4,g(n,[v],!0,!1,null,[])];case 4:O.sent(),O.label=5;case 5:return s=u.next(),[3,3];case 6:return[3,9];case 7:return m=O.sent(),f={error:m},[3,9];case 8:try{s&&!s.done&&(k=u.return)&&k.call(u)}finally{if(f)throw f.error}return[7];case 9:return l(),[2]}}))}))})),E=t(6858),D=t(1956);var P=function(e,n,t){return Object(a.c)(this,void 0,void 0,(function(){var i,r,o,c,d,u;return Object(a.f)(this,(function(a){switch(a.label){case 0:return i=[t],[4,Object(E.a)(n)];case 1:if((r=a.sent())&&(null==(o=D.u.items.get(t))?void 0:o.InternetMessageId))for(c=r.get(o.InternetMessageId),d=null==c?void 0:c.parentImId;d;)(u=r.get(d))?(u.itemIds.forEach((function(n){var t,a=D.u.items.get(n);e&&(null===(t=null==a?void 0:a.ParentFolderId)||void 0===t?void 0:t.Id)!=e||i.push(n)})),d=u.parentImId):d=void 0;return[2,i]}}))}))};var U=t(2163),_=t(2054),L=Object(o.action)("autoMarkItemAsRead")((function(e,n,t){return Object(a.c)(this,void 0,void 0,(function(){var r,o,c;return Object(a.f)(this,(function(d){switch(d.label){case 0:return Object(i.g)(n)?b([e])?[2]:((r=Object(U.a)(e))&&(c=Object(i.B)(r.ParentFolderId.Id),o=1==c),!Object(_.a)()||o?[3,1]:(function(e,n,t){Object(a.c)(this,void 0,void 0,(function(){var r,o,c;return Object(a.f)(this,(function(d){return n?(r=t||Object(a.j)([],Object(a.g)(e.selectedRowKeys.keys()))[0],o=i.b.getRowClientItemId(r,e),(c=null==o?void 0:o.Id)?(P(e.tableQuery.folderId,c,n).then((function(n){g(e,n,!0,!1,null,[])})),[2]):[2]):[2]}))}))}(n,e,t),[3,3])):[2];case 1:return[4,g(n,[e],!0,!1,null,[])];case 2:d.sent(),d.label=3;case 3:return l(),[2]}}))}))}));function Q(e,n){var t;return Object(a.c)(this,void 0,void 0,(function(){var r,o;return Object(a.f)(this,(function(a){switch(a.label){case 0:if("OnSelectionChange"!==Object(T.a)().UserOptions.PreviewMarkAsRead)return[2];switch(r=i.b.getRowIdString(e,n),n.tableQuery.listViewType){case 0:return[3,1];case 1:return[3,6]}return[3,8];case 1:return Object(_.a)()?(o=null===(t=i.b.getRowIdToShowInReadingPane(e,n))||void 0===t?void 0:t.Id,[4,L(o,n,e)]):[3,3];case 2:return a.sent(),[3,5];case 3:return[4,F(r,n)];case 4:a.sent(),a.label=5;case 5:return[3,8];case 6:return[4,L(r,n)];case 7:return a.sent(),[3,8];case 8:return[2]}}))}))}var B=t(2090),K=Object(o.action)("onReadingPaneClosed")((function(e,n){Object(B.t)()||j.d("onReadingPaneClosed should only be called in single line view."),Q(e,n)})),J=Object(o.action)("onSingleSelectionChanged")((function(e,n,t){return Object(a.c)(this,void 0,void 0,(function(){return Object(a.f)(this,(function(a){switch(a.label){case 0:return Object(B.t)()?[2]:t?[4,Q(e,n)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}));function G(e,n,t){0==e.length||Object(B.t)()||1!==e.length||"Unread"===Object(i.R)(t)||Q(e[0],n)}var q=Object(c.action)("MARK_ITEMS_READ_BASED_ON_NODE_IDS",(function(e,n,t,a,i){return{nodeIds:e,tableViewId:n,isReadValueToSet:t,isExplicit:a,actionSource:i}})),z=Object(o.action)("markItemAsReadFromReadingPane")((function(e,n,t,a,r){var o=[],c=null;if(n){if(Object(i.S)(n)){var d=I.a.items.get(e).ConversationId.Id;o=Object(i.G)([d],n)}else o=Object(i.G)([e],n);c=Object(i.l)(n)}g(n,[e],t,!0,r,a).then((function(){n&&Object(y.a)(o,c)})).catch((function(e){n&&(Object(y.a)(o,c),Object(y.b)(n))}))})),W=t(2624),$=Object(o.action)("markConversationsAsReadFromTable")((function(e,n,t,a){var r=Object(i.E)(e,n.id),o=Object(W.a)(e,n);return M(r,n,t,!0,a,o,e)})),Y=Object(o.action)("markItemsReadFromTable")((function(e,n,t,a,r){var o=Object(i.E)(e,n.id),c=Object(W.a)(e,n),d=g(n,o,t,a,r,c),u=Object(i.l)(n),s=Object(i.db)(n,t,a);d.then((function(n){Object(y.a)(e,u,s)})).catch((function(t){Object(y.a)(e,u,s),Object(y.b)(n)}))})),H=t(3036),X=Object(o.action)("toggleRowReadState")((function(e,n,t){var a=i.ab.tableViews.get(n),r=i.b.getUnreadCount(e,a)>0;switch(a.tableQuery.listViewType){case 0:$([e],a,r,t);break;case 1:Y([e],a,r,!0,t)}Object(H.b)()})),Z=Object(o.action)("onNavigateAwayViaUpDown")((function(e,n){Q(e,n)})),ee=Object(c.action)("onKeyboardMarkAsRead",(function(e,n,t,a,i,r){return{tableView:e,selectedNodeIds:n,isInVirtualSelectAllMode:t,rowKeysToActOn:a,exclusionList:i,isReadValueToSet:r}})),ne=t(4204),te=t(3076),ae=t(3804),ie=t(14097),re=t(6),oe=t(6616),ce=t(14098),de=t(14099);var ue=t(121),se=t(1085),le=t(731),be=t(5),ve=t(1951),me=t(2581),fe=t(2423),ke=t(11535),Oe=t(4920),je=t(2964),pe=t(2267),ye={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkViewAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FocusedViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"markAsRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationIdsToExclude"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markViewAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"focusedViewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"viewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"markAsRead"},value:{kind:"Variable",name:{kind:"Name",value:"markAsRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"clientLastSyncTime"},value:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}}},{kind:"ObjectField",name:{kind:"Name",value:"conversationIdsToExclude"},value:{kind:"Variable",name:{kind:"Name",value:"conversationIdsToExclude"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemIdsToExclude"},value:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressReadReceipt"},value:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"FolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}}]}}]}}]}}]}}]},Ie=Object(o.action)("markAsReadInTable")((function(e,n,t,r,o,c,d){var u=this;if(o.length&&t)throw new Error("If in virtual select all mode, rowKeysToActOn should be empty.");if(n.length&&!t)throw new Error("If not in virtual select all mode, exclusionList should be empty.");var s=c.tableQuery.folderId,l=ve.d.folderTable.get(s),b=c.isInVirtualSelectAllMode&&n.length>0,m=Object(i.R)(c),f="ContextFolder"===e||"CommandBar"===e&&t&&!c.isInCheckedMode&&!Object(i.V)(c,m),k=o.length>0&&!t,p=t&&l&&l.UnreadCount>=oe.b,y=function(e,n,t,a,r,o,c,d){if(e){var u=Object(i.Q)(o);return u?Object(se.n)(u):null==t?void 0:t.UnreadCount}if(Object(i.v)(o)||n||Object(i.V)(o,c)&&d)return o.totalRowsInView-a;return r}(f,b,l,n.length,o.length,c,m,t),I=p||y>=oe.b,N={headerText:"",bodyText:""};if(I){var R=Object(i.p)(c.tableQuery.type,c,l&&Object(ve.i)(l));N=function(e,n,t,a,i,r,o,c){var d,u="",s="",l=1===n,b=e||l;return t<0&&(j.g.warn("totalCount in getMarkAsReadUnreadAllConfirmText should not be negative."),u=b?i?Object(re.b)(ne.e):Object(re.b)(te.e):i?Object(re.b)(ne.c):Object(re.b)(te.c)),1==t&&(u=i?Object(re.b)(ae.a):Object(re.b)(te.a)),d=t<oe.a?t:"10000+",u=b?i?Object(re.c)(Object(re.b)(ne.d),d):Object(re.c)(Object(re.b)(te.d),d):i?Object(re.c)(Object(re.b)(ne.b),d):Object(re.c)(Object(re.b)(te.b),d),s=e?i?Object(re.c)(Object(re.b)(ce.b),a):Object(re.c)(Object(re.b)(de.b),a):r||o?l?i?Object(re.c)(Object(re.b)(ce.d),a):Object(re.c)(Object(re.b)(de.d),a):i?Object(re.c)(Object(re.b)(ce.c),a):Object(re.c)(Object(re.b)(de.c),a):l?i?Object(re.c)(Object(re.b)(ce.b),a):Object(re.c)(Object(re.b)(de.b),a):i?Object(re.c)(Object(re.b)(ce.a),a):Object(re.c)(Object(re.b)(de.a),a),c&&(s=l?i?Object(re.b)(ie.b):Object(re.b)(ie.d):i?Object(re.b)(ie.a):Object(re.b)(ie.c)),{headerText:u,bodyText:s}}(f,c.tableQuery.listViewType,y,R,r,b,k,2===c.tableQuery.type)}Object(le.b)(N.headerText,N.bodyText,!I,{delayCallbackAfterAnimation:!0,okText:Object(re.b)(me.a)}).then((function(d){return Object(a.c)(u,void 0,void 0,(function(){var u,l,b,m,f,k,j,p,y,I,N;return Object(a.f)(this,(function(a){switch(a.label){case 0:return d!==le.a.ok?[3,2]:[4,pe.b()];case 1:if(a.sent(),t){switch(u=Object(T.a)().UserOptions.ReadReceipt,l="DoNotAutomaticallySend"==u||"NeverSend"==u||Object(je.a)(s),b=Object(i.W)(s)?i.ab.inboxPausedDateTime:null,function(e,n,t){var a="TnS_MarkAllAs";a+=n?"Read":"Unread",Object(ue.s)(a,[e,Object(i.m)(t),t.isInCheckedMode])}(e,r,c),v.a.import().then((function(n){n(c.tableQuery,!0,r,e)})),m=[],0===c.tableQuery.listViewType&&(m=Object(ke.a)(n,c.id)),f=[],c.tableQuery.listViewType){case 0:f=Object(Oe.a)(n,c.id);break;case 1:f=Object(i.E)(n,c.id)}Object(fe.a)(c,r,f),k=Object(i.k)(c),(j=null===(I=k)||void 0===I?void 0:I.Id)||(j=null===(N=k)||void 0===N?void 0:N.Id),p=c.tableQuery,y={id:j,focusedViewFilter:Object(i.q)(p.focusedViewFilter),viewFilter:Object(i.u)(p.viewFilter),markAsRead:r,clientLastSyncTime:b&&Object(be.ub)(b),conversationIdsToExclude:m,itemIdsToExclude:f,suppressReadReceipt:l,mailboxInfo:Object(O.b)(c)},Ne.invokeMarkViewAsReadMutation(y)}else switch(c.tableQuery.listViewType){case 0:$(o,c,r,e);break;case 1:Y(o,c,r,!0,e)}a.label=2;case 2:return[2]}}))}))}))})),Ne={invokeMarkViewAsReadMutation:function(e){var n;return Object(a.c)(this,void 0,void 0,(function(){var t;return Object(a.f)(this,(function(a){switch(a.label){case 0:return[4,Object(R.a)()];case 1:return[4,a.sent().mutate({variables:e,mutation:ye})];case 2:return t=a.sent(),[2,null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.markViewAsRead]}}))}))}};var Re=t(2307),he=Object(o.action)("setAutoMarkAsReadTimer")((function(e,n,t){void 0===t&&(t={store:d});var a=Object(T.a)().UserOptions;if("Delayed"==a.PreviewMarkAsRead){var r=Object(Re.a)();if(!r||!Object(i.g)(r))return;t.store.markAsReadTimerTask=setTimeout((function(){ge(e,r,n)}),1e3*a.MarkAsReadDelaytime)}})),Te=Object(o.action)("clearAutoMarkAsReadTimer")((function(e){void 0===e&&(e={store:d}),e.store.markAsReadTimerTask&&(clearTimeout(e.store.markAsReadTimerTask),e.store.markAsReadTimerTask=null)})),ge=Object(o.action)("setMarkAsReadTimer:timeout")((function(e,n,t){Te(),t?L(e,n):1===n.tableQuery.listViewType||Object(_.a)()?L(e,n):F(e,n)})),we=t(2790),Ae=t(31),Ve=Object(Ae.e)(we.b,"CLONE_ON_ITEM_PART_DESELECTED",(function(e){var n=e.itemId,t=e.tableView;t&&"OnSelectionChange"==Object(T.a)().UserOptions.PreviewMarkAsRead&&L(n,t)})),Se=t(4206),Me=t(2959),xe=(Object(c.orchestrator)(q,(function(e){var n=i.ab.tableViews.get(e.tableViewId),t=Object(a.j)([],Object(a.g)(n.selectedRowKeys.keys())),r=Object(Se.a)(e.nodeIds,Object(Me.a)(t[0]));g(n,r,e.isReadValueToSet,e.isExplicit,e.actionSource,null)})),t(2072)),Ce=t(7888);Object(c.orchestrator)(xe.p,(function(e){var n=e.tableViewId,t=e.currentSelectedNodeIds,a=e.rowKey;if("OnSelectionChange"==Object(T.a)().UserOptions.PreviewMarkAsRead&&Object(_.a)()&&1===(null==t?void 0:t.length)){var r=i.ab.tableViews.get(n);L(Object(Ce.a)(t[0],Object(Me.a)(a)),r)}}));Object(c.orchestrator)(ee,(function(e){var n=e.tableView,t=e.selectedNodeIds,a=e.isInVirtualSelectAllMode,i=e.rowKeysToActOn,r=e.exclusionList,o=e.isReadValueToSet;t.length>0?q(t,n.id,o,!0,"Keyboard"):Ie("Keyboard",r,a,o,i,n)}));t.d(n,"onReadingPaneClosed",(function(){return K})),t.d(n,"onSingleSelectionChanged",(function(){return J})),t.d(n,"markReadOnTableViewChange",(function(){return G})),t.d(n,"markItemsAsReadBasedOnNodeIds",(function(){return q})),t.d(n,"markItemAsReadFromReadingPane",(function(){return z})),t.d(n,"toggleRowReadState",(function(){return X})),t.d(n,"onNavigateAwayViaUpDown",(function(){return Z})),t.d(n,"onKeyboardMarkAsRead",(function(){return ee})),t.d(n,"markAsReadInTable",(function(){return Ie})),t.d(n,"clearAutoMarkAsReadTimer",(function(){return Te})),t.d(n,"setAutoMarkAsReadTimer",(function(){return he})),t.d(n,"onItemPartDeselectedOrchestrator",(function(){return Ve}))},5639:function(e,n,t){"use strict";function a(e){return e?new Date(e).toISOString():null}t.d(n,"a",(function(){return a}))},6147:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var a=/ipm.note.rules.ooftemplate.microsoft/i},6616:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return i}));var a=1e4,i=25},6858:function(e,n,t){"use strict";var a=t(1),i=t(2449),r=t(1956),o=t(209);function c(e){var n,t;return Object(a.c)(this,void 0,void 0,(function(){var c;return Object(a.f)(this,(function(a){switch(a.label){case 0:c=null===(n=r.u.conversations)||void 0===n?void 0:n.get(e),a.label=1;case 1:return!c||null!=c&&c.canLoadMoreForRelationMap?(c&&(c.isLoadMoreInProgress=!0,c.maxItemsToReturn=i.b,c.syncState=""),[4,i.e.importAndExecute({Id:e,mailboxInfo:Object(o.d)()},"CreateConversationRelationMap")]):[3,3];case 2:return a.sent(),c||(c=null===(t=r.u.conversations)||void 0===t?void 0:t.get(e))?[3,1]:[3,3];case 3:return[2]}}))}))}var d,u,s=t(6147);function l(){return d}function b(e){var n;return Object(a.c)(this,void 0,void 0,(function(){var t,i,o,s,l,b,m,f;return Object(a.f)(this,(function(k){switch(k.label){case 0:return u==e?[3,2]:(u=e,[4,c(e)]);case 1:if(k.sent(),!(t=null===(n=r.u.conversations)||void 0===n?void 0:n.get(e)))return[2,null];if(i=null==t?void 0:t.conversationNodeIds,o=null==i?void 0:i.length,!i||!o||0==o)return[2,null];for(s=Object(a.j)([],Object(a.g)(i)),"ChronologicalNewestOnBottom"===t.conversationSortOrder||s.reverse(),l=r.u.conversationNodes.get(s[0]),b=new Map,l&&b.set(l.internetMessageId,{itemIds:l.itemIds,childrenImIds:[]}),m=1;m<o;)f=r.u.conversationNodes.get(s[m]),v(b,f),m+=1;d=b,k.label=2;case 2:return[2,d]}}))}))}function v(e,n){if(n&&e){var t=n.internetMessageId,a=n.parentInternetMessageId,i=r.u.items.get(n.itemIds[0]),o=null==i?void 0:i.ItemClass,c=!!o&&s.a.test(o);if(!c&&a){var d=e.get(a);d&&d.childrenImIds.push(t)}e.set(t,{itemIds:n.itemIds,parentImId:c?void 0:a,childrenImIds:[]})}}t.d(n,"b",(function(){return l})),t.d(n,"a",(function(){return b}))},7412:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return c}));var a=t(31),i=new a.c((function(){return t.e(477).then(t.bind(null,11954))})),r=new a.b(i,(function(e){return e.addMarkAsReadDiagnostics})),o=new a.b(i,(function(e){return e.addUnreadCountNotificationDiagnostics})),c=new a.b(i,(function(e){return e.addUnreadCountSubscriptionDiagnostics}))}}]);
//# sourceMappingURL=owa.MailBoot~MarkRead.js.map
self.scriptsLoaded['owa.MailBoot~MarkRead.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MarkRead.js'] = (new Date()).getTime();