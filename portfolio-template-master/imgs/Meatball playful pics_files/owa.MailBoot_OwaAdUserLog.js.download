self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~OwaAdUserLog.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[749],{1080:function(e,n,t){"use strict";var a=t(31),i=t(1259),o=t(198),r=t(2),s=[o.b.SurfaceActions];Object(r.orchestrator)(i.a,(function(e){var n=e.defaultOptions;s.forEach((function(e){n[e]&&Object(o.g)(Number(e),n[e])}))}));var d=t(980),u=t(1249);t.d(n,"h",(function(){return l})),t.d(n,"k",(function(){return f})),t.d(n,"i",(function(){return p})),t.d(n,"j",(function(){return A})),t.d(n,"e",(function(){return d.a})),t.d(n,"f",(function(){return o.e})),t.d(n,"d",(function(){return o.c})),t.d(n,"c",(function(){return o.b})),t.d(n,"a",(function(){return o.a})),t.d(n,"b",(function(){return u.a})),t.d(n,"g",(function(){return u.b}));var c=new a.c((function(){return t.e(960).then(t.bind(null,18362))})),l=new a.a(c,(function(e){return e.createOrUpdateOptionsForFeature})),f=new a.a(c,(function(e){return e.updateAddinPinStatus})),p=(new a.a(c,(function(e){return e.updateAddInArray})),new a.b(c,(function(e){return e.getServerOptionsForFeature}))),A=new a.a(c,(function(e){return e.loadOptions}))},1249:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return r}));var a,i=t(2);!function(e){e[e.OptionsNotLoaded=0]="OptionsNotLoaded",e[e.OptionsLoading=1]="OptionsLoading",e[e.OptionsLoaded=2]="OptionsLoaded"}(a||(a={}));var o={loadState:a.OptionsNotLoaded},r=Object(i.createStore)("owsOptionsLoadStateStore",o)},1259:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(2),i=t(980),o=Object(a.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",(function(e){return void 0===e&&(e=Object(i.a)()),{defaultOptions:e}}))},151:function(e,n,t){"use strict";t.d(n,"e",(function(){return o})),t.d(n,"d",(function(){return r})),t.d(n,"f",(function(){return s})),t.d(n,"b",(function(){return d})),t.d(n,"a",(function(){return u})),t.d(n,"c",(function(){return c})),t.d(n,"g",(function(){return l}));var a=t(31),i=new a.c((function(){return Promise.all([t.e(4),t.e(21),t.e(973)]).then(t.bind(null,1559))})),o=new a.a(i,(function(e){return e.makePostRequest})).importAndExecute,r=new a.a(i,(function(e){return e.makePatchRequest})).importAndExecute,s=new a.a(i,(function(e){return e.makePutRequest})).importAndExecute,d=new a.a(i,(function(e){return e.makeGetRequest})).importAndExecute,u=new a.a(i,(function(e){return e.makeDeleteRequest})).importAndExecute,c=new a.a(i,(function(e){return e.makeGraphRequest})).importAndExecute,l=new a.a(i,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},18534:function(e,n,t){"use strict";t.r(n);var a=t(1),i=t(24);var o=t(5576),r=t(7771),s=t(121),d=t(4017),u=t(2494),c=t(57),l=t(6388);function f(e,n,t,f){var p;return Object(a.c)(this,void 0,void 0,(function(){var A,S,v,b,g,m,P,O,C,w,E,R,x;return Object(a.f)(this,(function(a){switch(a.label){case 0:return A=new s.b("UserAdConfig",{isCore:!0}),v="NA",(S=e)&&(b=Object(c.h)().UserOptions.IsFocusedInboxEnabled,!1,m=Object(c.h)().UserOptions.InboxPlusTabs,g=(null==m?void 0:m.length)>1,b||g||(S=!1,v="FocusInboxInboxPlusTabsOff")),O=Object(u.o)(),C="NA",w=[],O?[4,Object(d.e)()]:[3,3];case 1:return C=a.sent(),[4,Object(d.d)()];case 2:return E=a.sent(),P=!(2===E),(null==C?void 0:C.length)>0?(o.TCString.decode(C).purposeConsents.forEach((function(e,n){e&&w.push(n)})),null!=w&&0!=w.length||(w=[0])):w=[-1],[3,4];case 3:w=[-1],a.label=4;case 4:return P?[3,6]:(x=Object(u.g)(),[4,Object(l.a)(x)]);case 5:R=a.sent(),a.label=6;case 6:return A.addCustomData({AdsEnabled:e,NotEnabledReason:n,UserAdCountry:Object(u.i)(t),CalculatedAdMarket:t,DisplayAdsOn:f,NativeAdsOn:S,DisplayOffReason:e&&!f?n:"NA",NativeOffReason:v,MSOptOut:R,AdsExpFlights:["adsexp-Display-7s","adsexp-Display-cr","adsExp-NativeInbox-e2-NoDisplayAd","adsExp-NativeInbox-e3-NoDisplayAd","adsExp-NativeInbox-e4-NoDisplayAd","adsExp-NativeInbox-e3-DisplayAd","adsExp-NativeInbox-control","adsExp-NativeTwoAds-e1","adsExp-NativeTwoAds-e2","adsExp-NativeTwoAds-e3","adsExp-NativeTwoAds-control","adsexp-NRExitRp-treatment","adsexp-NRExitRp-control","adsexp-NRExitRpThrottle-cr","adsexp-NRExitRpThrottle-5s","adsexp-NRExitRpThrottle-10s","adsexp-NRExitRpThrottle-15s","adsexp-NRExitRpThrottle-20s"].filter(i.i).toString(),GDPRApplies_2:O,GDPRPurposes_2:w.toString(),FirstPartyCookieOptOut:P,ReadingPanePosition:null===(p=Object(c.h)().UserOptions)||void 0===p?void 0:p.GlobalReadingPanePositionReact}),A.addCosmosOnlyData(JSON.stringify({GDPRConsentString_2:C})),A.end(),r.d.importAndExecute(!1),[2]}}))}))}t.d(n,"logUserAdConfig",(function(){return f}))},198:function(e,n,t){"use strict";var a,i,o,r=t(2),s=Object(r.action)("setOptionValue",(function(e,n){return{feature:e,value:n}})),d=Object(r.action)("assignOptionValue",(function(e,n){return{feature:e,value:n}})),u=Object(r.action)("verifyAndSetOptionValues",(function(e){return{potentialOptionValues:e}})),c=Object(r.action)("setOptionValue",(function(e,n){return{feature:e,value:n}})),l=t(1);!function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance",e[e.ActivityFeed=19]="ActivityFeed",e[e.AmpDeveloper=20]="AmpDeveloper",e[e.CalendarHelp=21]="CalendarHelp",e[e.LinkedInViewProfile=22]="LinkedInViewProfile",e[e.Bohemia=23]="Bohemia",e[e.GdprAdsV2=24]="GdprAdsV2",e[e.Proofing=25]="Proofing",e[e.ActiveProxyAddress=26]="ActiveProxyAddress",e[e.OutlookSpaces=27]="OutlookSpaces",e[e.GdprAdsV3=28]="GdprAdsV3",e[e.SxS=29]="SxS",e[e.ReadingPaneConversation=30]="ReadingPaneConversation",e[e.AdsAggregate=31]="AdsAggregate",e[e.ListViewColumnHeaders=32]="ListViewColumnHeaders",e[e.MailLayoutOptions=33]="MailLayoutOptions",e[e.Commanding=34]="Commanding"}(a||(a={})),function(e){e[e.EditInBrowser=0]="EditInBrowser",e[e.EditInDesktop=1]="EditInDesktop",e[e.EditAndReply=2]="EditAndReply"}(i||(i={}));var f=Object(r.createStore)("owsOptionsStore",{options:(o={},o[a.SmartSuggestions]={feature:a.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},o[a.DiverseEmojis]={feature:a.DiverseEmojis,diverseEmojisSelectedSkinTone:""},o[a.SurfaceActions]={feature:a.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},o[a.SkypeNotifications]={feature:a.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},o[a.WebPushNotifications]={feature:a.WebPushNotifications,enabled:!1,applicationServerKey:null},o[a.Confetti]={feature:a.Confetti,confettiEnabled:!1},o[a.GdprAdsV3]={feature:a.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},o[a.CalendarSurfaceAddins]={feature:a.CalendarSurfaceAddins,calendarSurfaceAddins:[]},o[a.ExternalImages]={feature:a.ExternalImages,externalImagesSelectedOption:null},o[a.EventCapture]={autoCollectionEnabled:!1},o[a.Translation]={feature:a.Translation,translationMode:0,targetLanguage:"",excludedLanguages:[]},o[a.CalendarSurfaceOptions]={feature:a.CalendarSurfaceOptions,agendaPaneIsClosed:!0,lastKnownRoamingTimeZone:void 0,roamingTimeZoneNotificationsIsDisabled:void 0,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},o[a.MentionEventNotifications]={feature:a.MentionEventNotifications,enabled:!1},o[a.TxpEventNotifications]={feature:a.TxpEventNotifications,enabled:!1},o[a.ComposeAssistance]={feature:a.ComposeAssistance,composeAssistanceEnabled:!1},o[a.AmpDeveloper]={feature:a.AmpDeveloper,enabled:!0,allowedSender:[]},o[a.ActivityFeed]={feature:a.ActivityFeed,OWASurfaceOptions:{SupportedTypes:[],DisabledInFeedPanel:[]}},o[a.LinkedInViewProfile]={dismissed:!1},o[a.CalendarHelp]={feature:a.CalendarHelp,calendarHelpEnabled:!1},o[a.Bohemia]={feature:a.Bohemia,bohemiaEnabled:!1,fluidEnabledForTenant:!1},o[a.Proofing]={feature:a.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!1,proofingLocale:void 0,overriddenOptions:void 0},o[a.ActiveProxyAddress]={feature:a.ActiveProxyAddress,activeProxyAddresses:[]},o[a.OutlookSpaces]={feature:a.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},o[a.SxS]={feature:a.SxS,hideReadingPane:!1,defaultEditCommand:i.EditInBrowser},o[a.ReadingPaneConversation]={feature:a.ReadingPaneConversation,conversationEnabled:!0,conversationEnabledNativeHost:!1},o)}),p=t(14);function A(e){return(null==e?void 0:e.feature)in a}var S,v=t(319);function b(e,n){f().options[e]=n}function g(e){return f().options[e]}Object(r.mutator)(d,(function(e){var n=e.feature,t=e.value;v(f().options[n],t)})),Object(r.mutator)(s,(function(e){b(e.feature,e.value)})),Object(r.mutator)(c,(function(e){var n=e.feature,t=e.value;Object(p.extendObservable)(f().options[n],t)})),Object(r.mutator)(u,(function(e){var n,t,a=e.potentialOptionValues;try{for(var i=Object(l.k)(a),o=i.next();!o.done;o=i.next()){var r=o.value;r&&A(r)&&b(r.feature,r)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(n)throw n.error}}})),function(e){e[e.Work=1]="Work",e[e.Life=2]="Life"}(S||(S={})),t.d(n,"h",(function(){return s})),t.d(n,"d",(function(){return d})),t.d(n,"i",(function(){return u})),t.d(n,"g",(function(){return c})),t.d(n,"f",(function(){return f})),t.d(n,"e",(function(){return g})),t.d(n,"c",(function(){return S})),t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return i}))},217:function(e,n,t){"use strict";var a=t(859);t.d(n,"a",(function(){return a.a}))},4717:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return r})),t.d(n,"d",(function(){return s}));var a=t(2),i=Object(a.action)("IncreaseNativeAdsClickedRunningSum"),o=Object(a.action)("IncreaseNativeAdsSeenRunningSum"),r=Object(a.action)("UpdateNativeCPMRunningSum",(function(e){return{newCPMRunningSum:e}})),s=Object(a.action)("UpdateWasAdLastSeenInLastSession",(function(e){return{wasAdLastSeenInLastSession:e}}))},6388:function(e,n,t){"use strict";var a,i=t(1),o=t(151),r=t(217),s="ows/beta/AdsTargetingOptOutController";var d=function(e){return Object(i.c)(this,void 0,void 0,(function(){var n,t,d;return Object(i.f)(this,(function(i){switch(i.label){case 0:return n=!e,e=e||"",null!=a?[3,4]:[4,Object(o.b)(s,void 0,!0,{PreferAnid:e},!1,n)];case 1:return t=i.sent(),Object(r.a)(t.status)?[4,t.json()]:[3,3];case 2:return d=i.sent(),[2,a=d];case 3:return[2,!1];case 4:return[2,a]}}))}))};t.d(n,"a",(function(){return d}))},7771:function(e,n,t){"use strict";var a=t(4717),i=t(1),o=t(24),r=t(1080),s=t(2),d=Object(s.createStore)("userAdConfigStore",{nativeAdsClickedRunningSum:null,nativeAdsSeenRunningSum:null,nativeCPMRunningSum:null,wasAdLastSeenInLastSession:null,wasAdLastSeenInLastSessionValue:null});function u(e){if(Object(o.i)("fwk-ads-logUserConfig")){var n=Object(r.f)(r.c.AdsAggregate),t=d(),a=c(t.nativeAdsSeenRunningSum,n?n.nativeAdsSeenRunningSum:0),s=c(t.nativeAdsClickedRunningSum,n?n.nativeAdsClickedRunningSum:0),u=c(t.nativeCPMRunningSum,n?n.nativeCPMRunningSum:0),l=c(t.wasAdLastSeenInLastSession,!!n&&n.wasAdSeenInLastSession);e.increaseNativeAdsSeenRunningSum&&(t.nativeAdsSeenRunningSum=a+1,a=t.nativeAdsSeenRunningSum),e.increaseNativeAdsClickedRunningSum&&(t.nativeAdsClickedRunningSum=s+1,s=t.nativeAdsClickedRunningSum),e.updateNativeCPMRunningSum&&(t.nativeCPMRunningSum=u+e.updateNativeCPMRunningSum,u=t.nativeCPMRunningSum),e.updateWasAdLastSeenInLastSession&&(t.wasAdLastSeenInLastSession=e.updateWasAdLastSeenInLastSessionValue,l=t.wasAdLastSeenInLastSession),r.h.importAndExecute(r.c.AdsAggregate,Object(i.a)(Object(i.a)({},n),{nativeAdsSeenRunningSum:a,nativeAdsClickedRunningSum:s,nativeCPMRunningSum:u,wasAdSeenInLastSession:l}))}}function c(e,n){return null==e?n:e}Object(s.orchestrator)(a.a,(function(){u({increaseNativeAdsClickedRunningSum:!0})})),Object(s.orchestrator)(a.b,(function(){u({increaseNativeAdsSeenRunningSum:!0})})),Object(s.orchestrator)(a.c,(function(e){u({updateNativeCPMRunningSum:e.newCPMRunningSum})})),Object(s.orchestrator)(a.d,(function(e){u({updateWasAdLastSeenInLastSession:!0,updateWasAdLastSeenInLastSessionValue:e.wasAdLastSeenInLastSession})}));var l=t(31);t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return A})),t.d(n,"c",(function(){return S})),t.d(n,"d",(function(){return v}));var f=new l.c((function(){return t.e(961).then(t.bind(null,18133))})),p=new l.a(f,(function(e){return e.increaseNativeAdsClickedRunningSum})),A=new l.a(f,(function(e){return e.increaseNativeAdsSeenRunningSum})),S=new l.a(f,(function(e){return e.updateNativeCPMRunningSum})),v=new l.a(f,(function(e){return e.updateWasAdLastSeenInLastSession}))},859:function(e,n,t){"use strict";function a(e){return e>=200&&e<300}t.d(n,"a",(function(){return a}))},980:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(24),i=t(197),o=t(198);function r(){var e;return(e={})[o.b.AdsAggregate]={feature:o.b.AdsAggregate,nativeAdsSeenRunningSum:0,nativeAdsClickedRunningSum:0,nativeCPMRunningSum:0,wasAdSeenInLastSession:!1,startOfAdFreeTrial:""},e[o.b.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[o.b.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[o.b.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(i.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddClassicAttachment","InsertLink","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","QuickUse","ToggleRibbon","FluidHeroButton"],composeSurfaceAddins:[]},e[o.b.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[o.b.Confetti]={confettiEnabled:!0},e[o.b.ComposeAssistance]={composeAssistanceEnabled:!0},e[o.b.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[o.b.ExternalImages]={externalImagesSelectedOption:0},e[o.b.EventCapture]={autoCollectionEnabled:!1},e[o.b.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[o.b.CalendarSurfaceOptions]={agendaPaneIsClosed:!1,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3},e[o.b.AmpDeveloper]={enabled:Object(a.i)("rp-ampDefault"),allowedSender:[]},e[o.b.CalendarHelp]={calendarHelpEnabled:!1},e[o.b.LinkedInViewProfile]={dismissed:!1},e[o.b.Bohemia]={bohemiaEnabled:Object(a.i)("cmp-prague")},e[o.b.GdprAdsV3]={feature:o.b.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},e[o.b.Proofing]={feature:o.b.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0,overriddenOptions:void 0},e[o.b.ActiveProxyAddress]={feature:o.b.ActiveProxyAddress,activeProxyAddresses:[]},e[o.b.OutlookSpaces]={feature:o.b.OutlookSpaces,backgroundColor:"",gestureScheme:"pointer",toolboxCollapsed:!0},e[o.b.SxS]={feature:o.b.SxS,hideReadingPane:!1,defaultEditCommand:o.a.EditInBrowser},e[o.b.ReadingPaneConversation]={feature:o.b.ReadingPaneConversation,conversationEnabled:!0,conversationEnabledNativeHost:!1},e[o.b.ListViewColumnHeaders]={feature:o.b.ListViewColumnHeaders,senderColumnWidth:332,subjectColumnWidth:1e3,receivedColumnWidth:80},e[o.b.MailLayoutOptions]={feature:o.b.MailLayoutOptions,useSingleLineMessageListWithRightReadingPane:!1},e}}}]);
//# sourceMappingURL=owa.MailBoot~OwaAdUserLog.js.map
self.scriptsLoaded['owa.MailBoot~OwaAdUserLog.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~OwaAdUserLog.js'] = (new Date()).getTime();