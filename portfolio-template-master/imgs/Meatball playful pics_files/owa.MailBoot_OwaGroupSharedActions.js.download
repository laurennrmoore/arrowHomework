self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~OwaGroupSharedActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[753],{10435:function(t,e,n){"use strict";n.r(e);var r=n(1),o=n(4924),u=n(6127),i=n(2),a=Object(i.action)("loadUnifiedGroupsSettings");Object(i.orchestrator)(a,(function(){return Object(r.c)(void 0,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(e){switch(e.label){case 0:return[4,Object(u.b)()];case 1:return(null==(t=e.sent())?void 0:t.unifiedGroupSettings)&&t.responseCode===u.a.Success&&Object(o.a)(t.unifiedGroupSettings),[2]}}))}))}));var c=a,s=n(3428);n.d(e,"loadUnifiedGroupsSettings",(function(){return c})),n.d(e,"getGroupDetailsAction",(function(){return s.a}))},1986:function(t,e,n){"use strict";var r=n(1),o=n(2051),u=n(374),i=n(730),a=n(121),c=n(5),s="X-AnchorMailbox",d="Authorization",f="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";function b(t,e){return Object(r.c)(this,void 0,void 0,(function(){var n,b,p,v,O;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(u.k)(t)){if(b.accountState==u.b.AccessRevoked)return[2,null];if(b.accountState==u.b.AccountDeprovisioned||b.accountState==u.b.AccountNotFound)return Object(u.c)(b.accountState,b.accountProviderType),[2,null]}return e?(n[s]=e,n[l]=e):b&&(n[s]=b.anchorMailbox),b?(p=b.token,!(v=Object(i.g)(b.tokenExpiry))&&p?[3,2]:(Object(a.s)("getAndUpdateAccessToken",{tokenExpiry:Object(c.y)(b.tokenExpiry,Object(c.Rb)()),isTokenExpired_1:v,isTokenInvalid_2:!p},{isCore:!0}),[4,o.a.importAndExecute(b.accountId,t,p)])):[3,3];case 1:(p=r.sent())||(p=""),r.label=2;case 2:O=void 0,"Outlook"==b.accountProviderType?(O='MSAuth1.0 usertoken="'+p+'", type="MSACT"',n[f]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(O="Bearer "+p,n[f]=2..toString()),n[d]=O,r.label=3;case 3:return[2,n]}}))}))}var p=n(1989),v=n(23);function O(t,e){return Object(r.c)(this,void 0,void 0,(function(){var n,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=Object(p.a)(),o=n,[4,g(t,e)];case 1:return o.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function g(t,e){var n;return Object(r.c)(this,void 0,void 0,(function(){var o,u;return Object(r.f)(this,(function(r){switch(r.label){case 0:return o=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,[4,b(t.mailboxInfo.userIdentity,j(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return u=r.sent(),Object(p.b)(o,u),[2,o]}}))}))}function j(t,e){var n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&v.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return O})),n.d(e,"c",(function(){return j}))},1989:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach((function(n){return t.set(n,e[n])}))}function o(t){var e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},1991:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2),o=Object(r.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},1993:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2),o=n(14),u=Object(r.createStore)("groupsStore",{groups:new o.ObservableMap})},2009:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1993);function o(t){var e=Object(r.a)().groups.get(t.toLowerCase());return e?e.groupDetails:null}},2014:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2),o=n(2068),u=Object(r.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:o.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},2020:function(t,e,n){"use strict";var r;!function(t){t[t.None=0]="None",t[t.Executing=1]="Executing",t[t.Succeed=2]="Succeed",t[t.FailureNotice=3]="FailureNotice",t[t.FailureRetry=4]="FailureRetry"}(r||(r={})),e.a=r},2030:function(t,e,n){"use strict";var r=n(1),o=n(1989);function u(t,e){return{"X-OWA-ExplicitLogonUser":t,"X-AnchorMailbox":e||t}}function i(t,e,n){e&&(t||n)&&Object(o.b)(e,u(t,n))}function a(t,e){var n,o=null!=e?e:{},u=(null===(n=o.headers)||void 0===n?void 0:n.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",i(t,u),Object(r.a)(Object(r.a)({},o),{headers:u})}var c=n(374),s=n(1986),d=n(87),f=n(319);function l(t){return Object(r.c)(this,void 0,void 0,(function(){var e=this;return Object(r.f)(this,(function(n){return[2,Object(d.b)().then((function(n){return Object(r.c)(e,void 0,void 0,(function(){var e,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return t?Object(c.r)(t.userIdentity)?[4,Object(s.a)(t.userIdentity,"GroupMailbox"==t.type||"TeamsMailbox"==t.type?t.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return e=r.sent(),f(n,e),[3,3];case 2:"GroupMailbox"!=t.type&&"TeamsMailbox"!=t.type||(o=u(t.mailboxSmtpAddress),f(n,o)),r.label=3;case 3:return[2,n]}}))}))}))]}))}))}function b(){return Object(d.b)().then((function(t){return t.prefer='exchange.Behavior="CalendarInternal"',t}))}function p(t){return void 0===t&&(t=null),Object(c.r)(t)?b().then((function(e){return Object(s.a)(t).then((function(t){return Object.keys(t).forEach((function(n){return e[n]=t[n]})),e}))})):Promise.resolve({})}var v=n(65);function O(t,e,n,r){var o=new Headers;return n&&o.set("X-OWA-CANARY",Object(v.a)()),e&&o.set("X-OWA-ActionName",e),(t||r)&&(r?i(t,o,r):i(t,o)),o}n.d(e,"a",(function(){return a})),n.d(e,"d",(function(){return l})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return b})),n.d(e,"f",(function(){return i})),n.d(e,"e",(function(){return O}))},2046:function(t,e,n){"use strict";var r=n(2),o=n(14),u=(Object(r.createStore)("personaPhotoStore",{personaPhotoUrls:new o.ObservableMap})(),n(2139),n(2068),n(1993)),i=n(2014),a=n(2009);function c(t){var e=Object(u.a)().groups.get(t.toLowerCase());return!!e&&!e.groupDetailsError}var s=n(2073),d=n(2180),f=n(2047),l=Object(r.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(t,e,n,r){if(2==e){var o=Object(a.a)(t);Object(s.a)(o,"Site")[0].Url=n,Object(s.a)(o,"Files")[0].Url=r}})),b=n(2149);function p(t){return t=t.toLocaleLowerCase(),Object(f.a)().groupSiteStatus.has(t)?Object(f.a)().groupSiteStatus.get(t):0}var v=function(t){var e="string"==typeof t?Object(a.a)(t):t;return e?e.ExternalDirectoryObjectId:null},O=(n(2020),n(2144),n(2134),n(2150),n(2145),n(2393)),g=n(2394),j=n(2411),S=n(2379),m=n(2380),h=n(6);function A(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(h.b)(S.a);if(3===e)return Object(h.b)(m.a)}return""}function y(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(h.b)(j.b);if(3===e)return Object(h.b)(j.c)}return""}function x(t){var e=0;return t.members?e=t.members.totalCount:t.groupDetails&&(e=t.groupDetails.MemberCount),e?e>1?Object(h.c)(Object(h.b)(g.a),e.toString()):Object(h.c)(Object(h.b)(O.a),e.toString()):Object(h.b)(j.a)}n.d(e,"j",(function(){return u.a})),n.d(e,"l",(function(){return i.a})),n.d(e,"d",(function(){return a.a})),n.d(e,"m",(function(){return c})),n.d(e,"f",(function(){return s.a})),n.d(e,"g",(function(){return s.b})),n.d(e,"c",(function(){return d.a})),n.d(e,"i",(function(){return f.a})),n.d(e,"o",(function(){return l})),n.d(e,"n",(function(){return b.b})),n.d(e,"h",(function(){return p})),n.d(e,"e",(function(){return v})),n.d(e,"a",(function(){return A})),n.d(e,"b",(function(){return y})),n.d(e,"k",(function(){return x}))},2047:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2),o=n(14),u=Object(r.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new o.ObservableMap})},2051:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(31),o=n(1991);n.d(e,"b",(function(){return o.a}));var u=new r.c((function(){return n.e(1286).then(n.bind(null,2298))})),i=new r.a(u,(function(t){return t.getAndUpdateAccessToken}))},2067:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1);function o(t){return Object(r.a)({__type:"IndexedPageView:#Exchange"},t)}},2068:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Private=0]="Private",t[t.Public=1]="Public"}(r||(r={}))},2073:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return u}));var r=n(2009),o=function(t,e){var n="string"==typeof t?Object(r.a)(t):t;if(!n||!n.GroupResources)return null;var o=n.GroupResources.filter((function(t){return t.Name===e}));return!o||o.length<1?null:o},u=function(t,e){var n=o(t,e);return n&&0!=n.length?n[0].Url:null}},2094:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2),o=Object(r.createStore)("currentGroupInformationStore",{smtpAddress:"",groupId:"",tenantId:""})},2134:function(t,e,n){"use strict";var r=n(2),o=n(2198),u=Object(r.mutatorAction)("setJoinButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=u},2139:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(24),o=n(2014),u=n(57);function i(){return(Object(r.i)("grp-shareable-crud")||Object(o.a)().isSensitivityLabelsEnabled)&&!Object(u.s)()}},2144:function(t,e,n){"use strict";var r=n(2),o=n(2197),u=Object(r.mutatorAction)("setFollowButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=u},2145:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2020),o=n(2198);function u(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},2149:function(t,e,n){"use strict";n.d(e,"b",(function(){return u}));var r=n(2),o=n(2047),u=Object(r.mutatorAction)("setGroupSiteStatus",(function(t,e){t=t.toLocaleLowerCase(),Object(o.a)().groupSiteStatus.has(t)&&e==Object(o.a)().groupSiteStatus.get(t)||Object(o.a)().groupSiteStatus.set(t,e)}));e.a=u},2150:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2020),o=n(2197);function u(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):r.a.None}},2180:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2094),o=function(){return Object(r.a)().smtpAddress}},2190:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1);function o(t){return Object(r.a)({__type:"UnifiedGroupIdentity:#Exchange"},t)}},2197:function(t,e,n){"use strict";var r=n(2),o=n(14);e.a=Object(r.createStore)("followButtonStore",{groupActionState:new o.ObservableMap})()},2198:function(t,e,n){"use strict";var r=n(2),o=n(14);e.a=Object(r.createStore)("joinButtonStore",{groupActionState:new o.ObservableMap})()},2245:function(t,e,n){"use strict";var r,o,u,i,a,c,s,d,f,l,b,p,v,O,g;var j;n(6);function S(t,e){e,j=t}function m(){return j}n.d(e,"o",(function(){return r})),n.d(e,"n",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"g",(function(){return c})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return d})),n.d(e,"l",(function(){return f})),n.d(e,"m",(function(){return l})),n.d(e,"q",(function(){return b})),n.d(e,"r",(function(){return p})),n.d(e,"h",(function(){return v})),n.d(e,"j",(function(){return O})),n.d(e,"e",(function(){return g})),n.d(e,"p",(function(){})),n.d(e,"k",(function(){return S})),n.d(e,"i",(function(){return m}))},2255:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1);function o(t){return Object(r.a)({__type:"BodyContentType:#Exchange"},t)}},2379:function(t){t.exports=JSON.parse('{"a":"T1a"}')},2380:function(t){t.exports=JSON.parse('{"a":"S1a"}')},2393:function(t){t.exports=JSON.parse('{"a":"R1a"}')},2394:function(t){t.exports=JSON.parse('{"a":"X1a"}')},2411:function(t){t.exports=JSON.parse('{"b":"U1a","c":"V1a","a":"W1a"}')},2672:function(t,e,n){"use strict";function r(t,e,n){var r,o,u,i,a,c=t.groups.get(e.toLowerCase());if(c||(n.unreadMessageCount=null,n.groupDetailsError=n.groupDetailsError||!1),!n.groupDetailsError||c&&c.basicInformation||(n.basicInformation={SmtpAddress:e,DisplayName:e}),n.groupDetails){var s=n.groupDetails;c&&c.basicInformation&&!c.groupDetailsError||(n.basicInformation={SmtpAddress:s.SmtpAddress,DisplayName:s.DisplayName,AccessType:s.AccessType,LegacyDN:s.LegacyDN,MailboxGuid:s.MailboxGuid}),n.groupDetails.UserGroupRelationship={SubscriptionType:(null===(r=s.UserGroupRelationship)||void 0===r?void 0:r.SubscriptionType)||0,IsSubscribed:(null===(o=s.UserGroupRelationship)||void 0===o?void 0:o.IsSubscribed)||!1,ShouldIgnoreReply:(null===(u=s.UserGroupRelationship)||void 0===u?void 0:u.ShouldIgnoreReply)||!1,IsMember:(null===(i=s.UserGroupRelationship)||void 0===i?void 0:i.IsMember)||!1,IsOwner:(null===(a=s.UserGroupRelationship)||void 0===a?void 0:a.IsOwner)||!1}}return n}var o=n(183),u=n(2094),i=Object(o.action)("addOrUpdateGroup")((function(t,e,n,o,i){var a;e=e.toLowerCase();var c=void 0!==o&&""!==o;if(c&&(o=o.toLowerCase(),e=n.groupDetails.SmtpAddress),n=r(t,c?o:e,n),t.groups.has(e)||c&&t.groups.has(o)){var s=t.groups.has(e)?t.groups.get(e):t.groups.get(o);n.basicInformation&&(s.basicInformation=n.basicInformation),n.groupDetails&&((null===(a=s.groupDetails)||void 0===a?void 0:a.MailboxSettings)&&!n.groupDetails.MailboxSettings&&(n.groupDetails.MailboxSettings=s.groupDetails.MailboxSettings),s.groupDetails=n.groupDetails),n.members&&(s.members=n.members),null!=n.groupDetailsError&&(s.groupDetailsError=n.groupDetailsError),c&&e!==o&&(void 0!==i&&i(e,o),t.groups.set(e,s),t.groups.delete(o),Object(u.a)().smtpAddress=e)}else t.groups.set(e,n)}));e.a=i},2841:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(19),o=n(24);function u(){var t;return(null===(t=Object(r.a)().UserOptions)||void 0===t?void 0:t.SendFromAliasEnabled)&&Object(o.i)("cmp-proxy-address")}},3428:function(t,e,n){"use strict";var r=n(183),o=n(2245),u=n(2426),i=n(2046),a=n(2672),c=n(2149),s=n(2073);var d=function(t,e){var n=Object(s.b)(e,"Site");n?!function(t){return-1==t.indexOf("_layouts/groupstatus.aspx")}(n)?Object(c.a)(t,1):Object(c.a)(t,2):Object(c.a)(t,0)},f=n(2),l=Object(f.action)("beforeGetGroupDetailsStartAction",(function(t){return{groupSmtpAddress:t}}));Object(f.orchestrator)(l,(function(t){3==Object(i.h)(t.groupSmtpAddress)&&Object(i.n)(t.groupSmtpAddress,1)}));var b=l,p=n(2094),v=Object(f.mutatorAction)("updateCurrentGroupIdAndTenantIdAction",(function(t,e){Object(p.a)().groupId=t,Object(p.a)().tenantId=e})),O=function(t,e){Object(a.a)(Object(i.j)(),t,{basicInformation:null,groupDetails:null,members:null,groupDetailsError:!0}),Object(i.n)(t,0),e&&e()},g=Object(r.action)("getGroupDetailsAction")((function(t,e,n,r){b(t),(o.g||u.f)(t,e).then((function(e){return function(t,e,n,r){if(t&&t.Body&&Object(u.i)(t.Body)){var o=t.Body.GroupDetails;o?(Object(a.a)(Object(i.j)(),o.SmtpAddress,{basicInformation:null,groupDetails:o,members:null,groupDetailsError:!1}),v(o.ExternalDirectoryObjectId,o.ExternalDirectoryOrganizationId),d(e,o),n&&n()):O(e,r)}else O(e,r)}(e,t,n,r)})).catch((function(e){O(t,r)}))}));e.a=g},4924:function(t,e,n){"use strict";var r=n(484),o=n(2014);e.a=Object(r.mutatorAction)("updateUnifiedGroupSettings",(function(t){var e=Object(o.a)();Object.keys(t).forEach((function(n){e[n]=t[n]}))}))}}]);
//# sourceMappingURL=owa.MailBoot~OwaGroupSharedActions.js.map
self.scriptsLoaded['owa.MailBoot~OwaGroupSharedActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~OwaGroupSharedActions.js'] = (new Date()).getTime();