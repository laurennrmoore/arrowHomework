self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~OwaMailPlaywright~TriageAction.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[295],{10467:function(e,t,n){"use strict";var r=n(1),a=n(3204),i=n(11532),o=n(11533),c=n(8183),u=n(9517),s=n(8597),l=n(7409),d=n(121),b=n(44),f=n(1250),m=n(2027),v=n(6),O=n(2958),j=n(2638),p=n(2392),y=n(2119),I=n(2133),g=n(2013),k=n(3778),S=n(5639),h=n(2267),T=n(1244),C=n(2),N=n(1947),D=n(14073),w={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposalType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposalType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"disposalType"},value:{kind:"Variable",name:{kind:"Name",value:"disposalType"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}},{kind:"Field",name:{kind:"Name",value:"undoRequestId"}}]}}]}}]};n.d(t,"b",(function(){return R})),n.d(t,"a",(function(){return x})),n.d(t,"c",(function(){return V}));var R=Object(C.action)("deleteConversationsWithoutConfirmDialog",(function(e,t,n,r,i){var o=I.a.tableViews.get(t);return Object(b.c)({name:"TnS_DeleteConversation",options:{timeout:7e4},customData:[i,e.length,n,Object(a.b)(t),Object(N.m)(o),Object(N.R)(o),Object(N.v)(o)],cosmosOnlyData:JSON.stringify({conversationIds:e.map((function(e){return e.conversationId}))}),actionSource:i},{conversationActionContexts:e,originalTableViewId:t,disposalType:n,instrumentationContexts:r})}));Object(C.orchestrator)(R,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n,a,i,o,l,b,f,m,v,O,y,S;return Object(r.f)(this,(function(C){switch(C.label){case 0:return t=e.conversationActionContexts,n=e.originalTableViewId,a=e.disposalType,i=e.instrumentationContexts,o=t.map((function(e){return e.conversationId})),l=Object(I.b)().tableViews.get(n),Object(c.a)(l.tableQuery,!0)&&Object(p.a)(o,l,"Delete"),b=Object(d.u)(),f=Object(g.b)(l),[4,(m=Object(h.d)(l.tableQuery.folderId,f)&&"MoveToDeletedItems"===a)?h.c():h.b()];case 1:return C.sent(),v=Object(N.G)(o,l),O=Object(N.l)(l,!0),y={timeoutMS:6e4},S=V.invokeDeleteConversationMutation(t,O,a,f,y),m&&h.a((function(){return Object(r.c)(void 0,void 0,void 0,(function(){var e;return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,S];case 1:return(e=n.sent()).success?[4,s.b.invokeUndoDeleteMutation(t,Object(T.a)("deleteditems"),e.undoRequestId)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2,Promise.resolve()]}}))}))}),l.serverFolderId,S),Object(u.a)(t.length,m),Object(j.d)("Delete",i,{conversationIds:o}),b.markUserPerceivedTime(),[2,Object(k.c)(S,v,l.serverFolderId,l,!0,!0)]}}))}))}));function x(e,t,n,r,a){var c=I.a.tableViews.get(t),u=Object(m.e)(c.tableQuery),s={deleteNumberOfRowsTitle:Object(v.b)(l.c),deleteOneRowTitle:Object(v.b)(O.a),confirmDeleteRows:u?Object(v.b)(D.b):Object(v.b)(D.a)};return Object(i.a)(e,t,n,(function(e,n){var i=Object(o.a)(e,t);R(i,t,n,r,a)}),_,s,a)}function _(e){var t=y.a.primaryComposeId&&y.a.viewStates.get(y.a.primaryComposeId).conversationId;return t&&e.indexOf(t)>=0}var V={invokeDeleteConversationMutation:function(e,t,n,a,i){var o;return Object(r.c)(this,void 0,void 0,(function(){var c,u;return Object(r.f)(this,(function(r){switch(r.label){case 0:return c=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(S.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(f.a)()];case 1:return[4,r.sent().mutate({variables:{conversations:c,disposalType:n,folderId:t,mailboxInfo:a},context:{requestOptions:i},mutation:w})];case 2:return u=r.sent(),[2,null===(o=null==u?void 0:u.data)||void 0===o?void 0:o.deleteConversation]}}))}))}}},11532:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r=n(1),a=n(8181),i=n(6801),o=n(7409),c=n(731),u=n(2027),s=n(6),l=n(10596),d=n(2112),b=n(2119),f=n(3427),m=n(8712),v=n(2133),O=n(2252),j=n(1956),p=n(7410),y=n(6616),I=n(1244),g=n(14071),k=n(1947),S=n(1951),h=n(1959);function T(e,t,n,r,o,d,b,m){void 0===m&&(m={originalTableView:v.a.tableViews.get(t),folderTable:S.d.folderTable,searchStore:Object(O.i)()});var g,T,R=m.originalTableView,x=R.tableQuery,_=x.folderId;if(Object(a.a)(_,null))return null;var V=Object(u.e)(x),F=1==x.type,M=F&&0===R.selectedRowKeys.size&&"Hover"!==b,A=Object(S.G)(_),J=Object(k.T)(x)||Object(f.c)(x);if(V)g=!1;else if(F){var Q=m.searchStore.staticSearchScope;g=e.map((function(e){return k.b.getParentFolderId(e,R)})).every((function(e){return Object(j.j)(e)}))||("PrimaryMailbox"==Q.kind||"ArchiveMailbox"==Q.kind)&&Object(j.j)(Q.folderId),T=Object(s.b)(l.a)}else if(!J&&!A){var E=m.folderTable.get(_);g=Object(j.j)(_)||Object(j.p)(E),T=Object(S.i)(E)}var P=n||g||V||A,z=e.length,U=z>=y.b,q=Object(k.v)(R),B=N(z,d),K=D(d,J,M,P,R,T),L=w(P,U,J,M,q);return Object(c.b)(B,K,L,{delayCallbackAfterAnimation:!0}).then((function(t){if(t===c.a.ok){var n=e.filter((function(e){return R.rowKeys.indexOf(e)>=0}));if(Object(S.C)(_,"SharedMailbox")){var a=Object(I.a)(h.g),u=Object(k.E)(e,R.id);return Object(i.a)(u,Object(p.a)(a),!0).then((function(){n.length>0&&C(n,R,"HardDelete",r,o)}))}var s=J?"HardDelete":P?"SoftDelete":"MoveToDeletedItems";if(n.length>0)return C(n,R,s,r,o)}return Promise.resolve()}))}function C(e,t,n,a,i){return Object(r.c)(this,void 0,void 0,(function(){var o,c;return Object(r.f)(this,(function(r){switch(r.label){case 0:return o=Object(k.E)(e,t.id),i(o)?[4,d.f.importAndExecute(b.a.viewStates.get(b.a.primaryComposeId))]:[3,2];case 1:r.sent(),r.label=2;case 2:return i(o)||(c=e.filter((function(e){return t.rowKeys.indexOf(e)>=0}))).length>0&&a(c,n),[2]}}))}))}var N=function(e,t){return e>1?Object(s.c)(t.deleteNumberOfRowsTitle,e):t.deleteOneRowTitle},D=function(e,t,n,r,a,i){if(n)return r?Object(s.b)(g.b):Object(s.b)(g.a);var c=Object(k.S)(a)?o.a:o.b;return r||t?e.confirmDeleteRows:Object(s.c)(Object(s.b)(c),Object(m.a)(a.tableQuery.type,a,i))},w=function(e,t,n,r,a){return!(a||e||t||n||r)}},11533:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1947);function a(e,t){var n=[],a={};return e.forEach((function(e){var i=Object(r.i)(e,t);a[i.conversationId]||(a[i.conversationId]=!0,n.push(i))})),n}},11534:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(6145),a=n(180),i=n(8184),o=n(8185),c=n(439);function u(e){var t=function(e){return Object(i.a)({MessageAction:Object(o.a)({Action:"Restore"}),Ids:e.map((function(e){return Object(c.a)({Id:e})}))})}(e);return Object(r.a)({Header:Object(a.b)(),Body:t}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}},14070:function(e){e.exports=JSON.parse('{"a":"Jzb","c":"Kzb","b":"Lzb","d":"Mzb"}')},14071:function(e){e.exports=JSON.parse('{"b":"Ezb","a":"Fzb"}')},14072:function(e){e.exports=JSON.parse('{"a":"Czb","b":"Dzb"}')},14073:function(e){e.exports=JSON.parse('{"b":"tzb","a":"uzb"}')},14074:function(e){e.exports=JSON.parse('{"b":"Nzb","a":"Ozb","c":"Pzb","d":"Qzb"}')},2511:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),a=Object(r.action)("USERMAIL_INTERACTION",(function(e,t,n){return{interactionType:e,instrumentationContexts:t,triageContext:n}}))},2638:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(31),a=n(2511);n.d(t,"d",(function(){return a.a}));var i=new r.c((function(){return n.e(517).then(n.bind(null,4744))})),o=new r.a(i,(function(e){return e.onKeyboardUpDown})),c=new r.a(i,(function(e){return e.onOpenEmail})),u=new r.a(i,(function(e){return e.onKeyboardToggleSelect}))},3204:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r=n(1),a=n(5),i=n(1964),o=n(23),c=n(1947);function u(e){var t=c.ab.tableViews.get(e),n=null;t&&(n=0==t.tableQuery.type||2==t.tableQuery.type?Object(c.L)(t).sortColumn:null);return n}function s(e,t){var n,a,i=[];if(e)try{for(var o=Object(r.k)(e),u=o.next();!u.done;u=o.next()){var s=u.value,l=c.b.getItemIds(s,t);l&&i.push.apply(i,Object(r.j)([],Object(r.g)(l)))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return i}function l(e,t){var n,a,i=[];if(e)try{for(var o=Object(r.k)(e),u=o.next();!u.done;u=o.next()){var s=u.value;i.push(c.b.getConversationId(s,t))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return i}t.a={blockSendersFromTable:{name:"TnS_BlockSendersFromListView",customData:function(e,t,n,r){return[n,e.length,t.tableQuery.type]}},setConversationsFlagState:{name:function(e,t,n,r,a){var i;switch(r.FlagStatus){case"Flagged":i="TnS_FlagConversation";break;case"NotFlagged":i="TnS_UnflagConversation";break;case"Complete":i="TnS_CompleteFlagConversation";break;default:o.d("Cannot log invalid flag type")}return i},customData:function(e,t,n,r,a){var i=c.ab.tableViews.get(n);return[Object(c.m)(i),Object(c.R)(i),null==e?void 0:e.length]},cosmosOnlyData:function(e,t,n,a,i){return function(e,t){var n,a,i=[],o=[],u=c.ab.tableViews.get(t);try{for(var s=Object(r.k)(e),l=s.next();!l.done;l=s.next()){var d=l.value;i.push(c.b.getItemIds(d,u)[0]),o.push(c.b.getConversationId(d,u))}}catch(e){n={error:e}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return JSON.stringify({itemIds:i,conversationIds:o})}(e,n)},actionSource:function(e,t,n,r,a){return a},options:{isCore:!0}},setItemsFlagState:{name:function(e,t,n,r,a){var i;switch(n.FlagStatus){case"Flagged":i="TnS_FlagItem";break;case"NotFlagged":i="TnS_UnflagItem";break;case"Complete":i="TnS_CompleteFlagItem";break;default:o.d("Cannot log invalid flag type")}return i},customData:function(e,t,n,r,a){var i=c.ab.tableViews.get(r);return[Object(c.m)(i),Object(c.R)(i),null==e?void 0:e.length]},cosmosOnlyData:function(e,t,n,r,a){return JSON.stringify({itemIds:e})},actionSource:function(e,t,n,r,a){return a},options:{isCore:!0}},archiveMailListRows:{name:"TnS_Archive",customData:function(e,t,n){return[t.tableQuery.folderId?Object(i.a)(t.tableQuery.folderId):null,t.tableQuery.type,t.tableQuery.listViewType,e.length,Object(c.m)(t),Object(c.R)(t)]},cosmosOnlyData:function(e,t,n){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0},actionSource:function(e,t,n){return n}},markItemsJunkNotJunk:{name:function(e,t,n,r,a,i){var o="TnS_MarkAs";return o+=t?"Junk":"NotJunk"},customData:function(e,t,n,r,a,i){return[e.length,Object(c.m)(r),Object(c.R)(r)]},cosmosOnlyData:function(e,t,n,r,a,i){return JSON.stringify({itemIds:e})},actionSource:function(e,t,n,r,a,i){return n}},markItemsAsPhishing:{name:"TnS_MarkAsPhishing",customData:function(e,t,n,r){return[e.length,Object(c.m)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:e})},actionSource:function(e,t,n,r){return n}},moveConversation:{name:function(e,t,n,r){var a="TnS_MoveConversation";return a+=r?"":"Background"},customData:function(e,t,n,r){return[n.tableQuery.type,n.tableQuery.folderId?Object(i.a)(n.tableQuery.folderId):null,Object(i.a)(t),e.length,Object(c.m)(n),Object(c.R)(n)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,n),conversationIds:l(e,n)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},moveItems:{name:function(e,t,n,r){var a="TnS_MoveItem";return a+=r?"":"Background"},customData:function(e,t,n,r){return[n.tableQuery.type,n.tableQuery.folderId?Object(i.a)(n.tableQuery.folderId):null,Object(i.a)(t),e.length,Object(c.m)(n),Object(c.R)(n)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:e})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},copyMailListRows:{name:"TnS_Copy",customData:function(e,t,n,r,a){return[t.tableQuery.type,t.tableQuery.folderId?Object(i.a)(r):null,Object(i.a)(n),e.length,Object(c.m)(t)]},cosmosOnlyData:function(e,t,n,r,a){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},actionSource:function(e,t,n,r,a){return a}},restoreConversation:{name:"TnS_RestoreConversation"},restoreItems:{name:"TnS_RestoreItem"},unsubscribe:{name:"TnS_Unsubscribe",customData:function(e,t,n,r){return[r,n,Object(c.m)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemId:e.ItemId.Id})}},pinConversations:{name:function(e,t,n,r){var a="TnS_";return a+=n?"PinConversation":"UnpinConversation"},customData:function(e,t,n,r){return[e.length,Object(c.m)(t),Object(c.R)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},actionSource:function(e,t,n,r){return r},options:{isCore:!0}},pinItems:{name:function(e,t,n,r){var a="TnS_";return a+=n?"PinItem":"UnpinItem"},customData:function(e,t,n,r){return[e.length,Object(c.m)(t),Object(c.R)(t)]},cosmosOnlyData:function(e,t,n,r){var a=s(e,t);return JSON.stringify({itemIds:a})},actionSource:function(e,t,n,r){return r},options:{isCore:!0}},moveConversationToFocusedOrOther:{name:function(e,t,n,r){return 0===n?"TnS_MoveConversationToFocused":"TnS_MoveConversationToOther"},customData:function(e,t,n,r){return[e.length,Object(c.m)(c.ab.tableViews.get(t))]},cosmosOnlyData:function(e,t,n,r){var a=c.ab.tableViews.get(t);return JSON.stringify({itemIds:s(e,a),conversationIds:l(e,a)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},moveItemToFocusedOrOther:{name:function(e,t,n,r){return 0===n?"TnS_MoveItemToFocused":"TnS_MoveItemToOther"},customData:function(e,t,n,r){return[e.length,Object(c.m)(c.ab.tableViews.get(t))]},cosmosOnlyData:function(e,t,n,r){var a=c.ab.tableViews.get(t);return JSON.stringify({itemIds:s(e,a)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},alwaysMoveRowToFocusedOrOther:{name:function(e,t,n,r){return 0===n?"TnS_AlwaysMoveToFocused":"TnS_AlwaysMoveToOther"},customData:function(e,t,n,r){return[e.length,Object(c.m)(t),t.tableQuery.listViewType]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0},actionSource:function(e,t,n,r){return r}},addCategories:{name:"TnS_AddCategory",customData:function(e,t,n,r){return[r,e.length,t.tableQuery.listViewType,Object(c.m)(t),Object(c.R)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0}},removeCategories:{name:"TnS_RemoveCategory",customData:function(e,t,n,r){return[r,e.length,t.tableQuery.listViewType,Object(c.m)(t)]},cosmosOnlyData:function(e,t,n,r){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0}},clearCategories:{name:"TnS_ClearCategory",customData:function(e,t,n){return[n,e.length,t.tableQuery.listViewType,Object(c.m)(t)]},cosmosOnlyData:function(e,t,n){return JSON.stringify({itemIds:s(e,t),conversationIds:l(e,t)})},options:{isCore:!0}},scheduleItems:{name:"TnS_ScheduleItem",customData:function(e,t,n,r){return[e.length,t.tableQuery.listViewType,Object(c.m)(t),r?Object(a.ub)(r):null]},options:{isCore:!0},actionSource:function(e,t,n){return n}}}},3704:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"DeleteItemJsonRequest:#Exchange"},e)}},3778:function(e,t,n){"use strict";var r=n(2136);function a(e,t,n){n&&r.a.removeRowsFromTombstone(e,t)}var i=n(3458);function o(e){e&&Object(i.a)(e)}var c=n(2028),u=n(121);function s(e,t,n,r,i,s){var l=Object(u.u)();return e.then((function(e){return l&&l.addCheckpoint("PAPCARM"),a(t,n,i),s?void 0:Object(c.a)(e)})).catch((function(e){return a(t,n,i),o(r),Promise.reject(e)}))}var l=n(1);function d(e,t,n,r,i){return e.then((function(e){if(a(t,n,i),e.ResponseMessages){var c=function(e,t){var n,r;try{for(var a=Object(l.k)(e),i=a.next();!i.done;i=a.next()){var c=i.value;if(c&&"Success"!=c.ResponseClass){o(t);var u=new Error("ResponseCode="+c.ResponseCode+", Stacktrace="+c.StackTrace);return u.fetchErrorType="ServerFailure",u}}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return null}(e.ResponseMessages.Items,r);return c?Promise.reject(c):Promise.resolve()}return Promise.reject(new Error("processUpdateItemActionResponseMessage empty response"))})).catch((function(e){return a(t,n,i),o(r),Promise.reject(e)}))}n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}))},3846:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"DeleteItemRequest:#Exchange"},e)}},3847:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(33),a=n(3704);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("DeleteItem",e,t)}},4088:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(3846),a=n(439),i=n(3847),o=n(180);function c(e,t){return Object(r.a)({ItemIds:e.map((function(e){return t=e,Object(a.a)({Id:t.Id,ChangeKey:t.ChangeKey});var t})),DeleteType:t,SuppressReadReceipts:!0,ReturnMovedItemIds:!0,SendMeetingCancellations:"SendToNone",AffectedTaskOccurrences:"AllOccurrences"})}function u(e,t,n){var r=c(e,t);return Object(i.a)({Header:Object(o.b)(),Body:r},n).then((function(e){return e.Body.ResponseMessages.Items}))}},4468:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1947),a=n(1956);function i(e){return e.map((function(e){var t,n=a.u.items.get(e);return t=!Object(r.Y)(n)||n.IsRead,{itemId:e,itemConversationId:n.ConversationId,isRead:t,mailboxInfo:n.MailboxInfo}}))}},4614:function(e){e.exports=JSON.parse('{"a":"nMa"}')},5639:function(e,t,n){"use strict";function r(e){return e?new Date(e).toISOString():null}n.d(t,"a",(function(){return r}))},6145:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(33),a=n(6146);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("ApplyMessageAction",e,t)}},6146:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"ApplyMessageActionJsonRequest:#Exchange"},e)}},6616:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r=1e4,a=25},6617:function(e,t,n){"use strict";n.d(t,"c",(function(){return Q})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return P}));var r=n(1),a=n(14074),i=n(7409),o=n(2958),c=n(6),u=n(2267),s=n(2119),l=n(6801),d=n(4468),b=n(3204),f=n(4088),m=n(2292),v=n(11532),O=n(1244),j=n(7410),p=n(8181),y=n(2133),I=n(11534),g=n(9517),k=n(1956),S=n(731),h=n(2013),T=n(1947),C=n(1955),N=(n(2053),n(121)),D=n(2638),w=n(1951),R=n(1959),x=n(8183),_=n(3778),V=n(2028),F=n(44),M=n(2),A=n(419);function J(e){var t=s.a.primaryComposeId&&s.a.viewStates.get(s.a.primaryComposeId).itemId;return t&&e.indexOf(t.Id)>=0}var Q=Object(M.action)("deleteItemsWithoutConfirmDialog",(function(e,t,n,r,a,i,o){return Object(F.c)({name:"TnS_DeleteItem",options:{timeout:7e4},customData:[e.length,t],cosmosOnlyData:JSON.stringify({itemIds:e}),actionSource:r},{itemIds:e,disposalType:t,parentFolderId:n,actionSource:r,instrumentationContexts:a,requestInitOptions:i,allowUndoAction:o})}));function E(e,t,n,r,i,o){var s=Object(C.b)().items.get(e[0]).ParentFolderId.Id;if(Object(p.a)(s,null))return Promise.resolve();var d=Object(w.C)(s,"SharedMailbox"),b=Object(A.a)(i)||null,f=i&&"GroupMailbox"==i.type,m=Object(k.j)(s),v="SoftDelete"==t&&m||f||Object(w.G)(s);return Object(S.b)(f?Object(c.b)(a.b):"",f?Object(c.b)(a.a):Object(c.b)(a.c),!v,{delayCallbackAfterAnimation:!0}).then((function(a){var o=Object(u.d)(s,i)&&"MoveToDeletedItems"===t;if(a==S.a.ok){if(d){var c=Object(O.a)(R.g);return Object(l.a)(e,Object(j.a)(c),!0).then((function(){return Q(e,"HardDelete",s,r,n,b,o)}))}return Q(e,t,s,r,n,b,o)}return Promise.resolve()}))}function P(e,t,n,r,s){var l=y.a.tableViews.get(t),d={deleteNumberOfRowsTitle:Object(c.b)(i.d),deleteOneRowTitle:Object(c.b)(o.a),confirmDeleteRows:Object(c.b)(a.d)},f=y.a.tableViews.get(t);return Object(N.s)("TnS_DeleteItemsFromTable",[s,e.length,Object(b.b)(t),Object(T.v)(f)]),Object(v.a)(e,t,n,(function(e,n){var a=Object(T.E)(e,t);return Q(a,n,l.tableQuery.folderId,s,r,Object(A.a)(Object(h.b)(l)),Object(u.d)(l.tableQuery.folderId,Object(h.b)(l))&&"MoveToDeletedItems"==n)}),J,d,s)}Object(M.orchestrator)(Q,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n,a,i,o,c,s,l,b,v,O,j,p,y;return Object(r.f)(this,(function(k){switch(k.label){case 0:return t=e.itemIds,n=e.disposalType,a=e.parentFolderId,i=e.actionSource,o=e.instrumentationContexts,c=e.requestInitOptions,s=e.allowUndoAction,l=Object(T.J)(),b=null,v=[],l&&(v=Object(T.G)(t,l),b=l.serverFolderId,Object(x.a)(l.tableQuery,!0)&&(O=Object(d.a)(t),Object(m.a)(O,a,"Delete"))),j=Object(N.u)(),[4,u.c()];case 1:return k.sent(),p=t.map((function(e){return{Id:e}})),(c=c||{}).timeoutMS=6e4,y=Object(f.a)(p,n,c),u.a((function(){return Object(r.c)(void 0,void 0,void 0,(function(){var e,t,n,a,i,o,c,u;return Object(r.f)(this,(function(l){switch(l.label){case 0:return[4,y];case 1:if(e=l.sent(),s){t=[];try{for(n=Object(r.k)(e),a=n.next();!a.done;a=n.next())i=a.value,"Success"==(o=i).ResponseClass&&t.push(o.MovedItemId.Id)}catch(e){c={error:e}}finally{try{a&&!a.done&&(u=n.return)&&u.call(n)}finally{if(c)throw c.error}}if(t.length>0)return[2,Object(I.a)(t)]}return[2,Promise.resolve()]}}))}))}),b),i&&Object(g.a)(t.length,s),Object(D.d)("Delete",o,{itemIds:t}),j.markUserPerceivedTime(),[2,y.then((function(e){return j.addCheckpoint("di_then"),Object(_.a)(v,a,!!l),Object(V.a)(e)})).catch((function(e){return j.addCheckpoint("di_catch"),"ErrorItemNotFound"==e.responseCode&&(e.fetchErrorType="Expected"),Object(_.a)(v,a,!!l),Object(_.b)(l),Promise.reject(e)}))]}}))}))}))},6801:function(e,t,n){"use strict";var r=n(8182),a=n(1);var i=n(33);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.a)({__type:"CopyItemJsonRequest:#Exchange"},n)),Object(i.a)("CopyItem",e,t)}var c=n(180);function u(e,t,n,i){var u=function(e,t,n){return i={ToFolderId:t,ItemIds:Object(r.a)(e),ReturnNewItemIds:!0,RemoteExecute:n},Object(a.a)({__type:"CopyItemRequest:#Exchange"},i);var i}(e,t,n);return o({Header:Object(c.b)(),Body:u},i).then((function(e){return e.Body}))}n.d(t,"a",(function(){return u}))},7408:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(10467),a=n(6617),i=n(2133),o=n(2624);function c(e,t,n,c){var u=i.a.tableViews.get(t),s=Object(o.a)(e,u);switch(u.tableQuery.listViewType){case 0:Object(r.a)(e,t,n,s,c);break;case 1:Object(a.b)(e,t,n,s,c)}}},7409:function(e){e.exports=JSON.parse('{"b":"vzb","a":"wzb","c":"xzb","d":"yzb","f":"zzb","e":"Azb"}')},7410:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(613),a=n(984);function i(e){return e?Object(a.a)({BaseFolderId:Object(r.a)({Id:e})}):null}},8181:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(14070),a=n(6),i=n(731),o=n(1951),c=n(19);function u(e,t){if(!Object(c.a)().SessionSettings.IsShadowMailbox)return!1;var n,u=o.d.folderTable.get(e),s=o.d.folderTable.get(t),l=u.sourceWellKnownFolderType;if(87==l)n=Object(a.b)(r.a);else if(88==l)n=Object(a.b)(r.c);else if(null!=s){var d=s.sourceWellKnownFolderType;87==d?n=Object(a.b)(r.b):88==d&&(n=Object(a.b)(r.d))}return null!=n&&(Object(i.b)("",n,!1,{hideCancelButton:!0}),!0)}},8182:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(439);function a(e){return e.map((function(e){return Object(r.a)({Id:e})}))}},8183:function(e,t,n){"use strict";function r(e,t){switch(0==e.type?e.scenarioType:""){case"persona":case"privatedistributionlist":return!1;case"category":return t;default:return!0}}n.d(t,"a",(function(){return r}))},8184:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"ApplyMessageActionRequest:#Exchange"},e)}},8185:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"MessageAction:#Exchange"},e)}},8597:function(e,t,n){"use strict";var r=n(1),a=n(3204),i=n(44),o=n(2392),c=n(1947),u=n(2133),s=n(8718),l=n(3778),d=n(1250),b=n(5639),f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UndoDeleteConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"undoDeleteConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]};n.d(t,"b",(function(){return m}));t.a=Object(i.d)("RestoreConversation",a.a.restoreConversation)((function(e,t){var n=Object(u.b)().tableViews.get(t),r=Object(s.a)(e,t,(function(e){return!!e})),a=Object(c.E)(r,t),i=r.map((function(e){return Object(c.i)(e,t)}));Object(o.a)(a,n,"Restore");var d=n.tableQuery.folderId,b=m.invokeUndoDeleteMutation(i,d);return Object(l.c)(b,r,n.serverFolderId,n,!1,!0)}));var m={invokeUndoDeleteMutation:function(e,t,n){var a;return Object(r.c)(this,void 0,void 0,(function(){var i,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return i=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(b.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(d.a)()];case 1:return[4,r.sent().mutate({variables:{conversations:i,folderId:t,undoRequestId:n},mutation:f})];case 2:return o=r.sent(),[2,null===(a=null==o?void 0:o.data)||void 0===a?void 0:a.undoDeleteConversation]}}))}))}}},9517:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(6),a=n(4614),i=n(2090),o=n(2267),c=n(1081),u=n(19),s=n(14072);function l(e,t){if(Object(u.a)().UserOptions.ShowNotificationBar){var n=1===e?Object(r.b)(s.a):Object(r.c)(Object(r.b)(s.b),e),l=Object(i.j)();c.e.importAndExecute("deleteNotification","MailModuleNotificationBarHost",n,{icon:"Delete",primaryActionText:t?Object(r.b)(a.a):null,allowClear:!0,minWidth:l.minWidth,maxWidth:l.maxWidth,notificationCallback:function(e){e===c.a.PrimaryActionClicked&&o.f.importAndExecute("NotificationBar")}})}}}}]);
//# sourceMappingURL=owa.MailBoot~OwaMailPlaywright~TriageAction.js.map
self.scriptsLoaded['owa.MailBoot~OwaMailPlaywright~TriageAction.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~OwaMailPlaywright~TriageAction.js'] = (new Date()).getTime();