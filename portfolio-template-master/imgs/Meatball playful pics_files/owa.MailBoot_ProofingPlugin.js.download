self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ProofingPlugin.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[778],{10029:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=e=>Symbol.for(e)},10030:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Remote=0]="Remote",e[e.System=1]="System",e[e.User=2]="User"}(n||(n={}))},10031:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(10032),r=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new n.BindingWhenSyntax(this._binding)},e}();t.BindingOnSyntax=r},10032:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(10031),r=i(11823),a=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new n.BindingOnSyntax(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=r.namedConstraint(e),new n.BindingOnSyntax(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new n.BindingOnSyntax(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=r.taggedConstraint(e)(t),new n.BindingOnSyntax(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return r.typeConstraint(e)(t.parentRequest)},new n.BindingOnSyntax(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return r.namedConstraint(e)(t.parentRequest)},new n.BindingOnSyntax(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(i){return r.taggedConstraint(e)(t)(i.parentRequest)},new n.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return r.traverseAncerstors(t,r.typeConstraint(e))},new n.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!r.traverseAncerstors(t,r.typeConstraint(e))},new n.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return r.traverseAncerstors(t,r.namedConstraint(e))},new n.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!r.traverseAncerstors(t,r.namedConstraint(e))},new n.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(i){return r.traverseAncerstors(i,r.taggedConstraint(e)(t))},new n.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(i){return!r.traverseAncerstors(i,r.taggedConstraint(e)(t))},new n.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return r.traverseAncerstors(t,e)},new n.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!r.traverseAncerstors(t,e)},new n.BindingOnSyntax(this._binding)},e}();t.BindingWhenSyntax=a},10033:function(e,t,i){"use strict";var n,r;i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),function(e){e.Diagnostics="Diagnostics"}(n||(n={})),function(e){e.UnhandledContentError="RunTimeErrors.UnhandledContentError",e.UnhandledBackgroundError="RunTimeErrors.UnhandledBackgroundError",e.UnhandledOptionsPageError="RunTimeErrors.UnhandledOptionsPageError"}(r||(r={}))},10034:function(e,t,i){"use strict";function n(e,t){const i=new Map;let n,r=0,a=0;if(!t)return e.textContent&&i.set(r,e.textContent),i;const o=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:e=>(a+=e.length,t&&e.parentElement&&e.parentElement.closest(t)?(n&&(i.set(r,n),n=void 0),r=a,NodeFilter.FILTER_REJECT):e.length?(n||(n=""),n+=e.nodeValue,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT)});for(;o.nextNode(););return n&&i.set(r,n),i}function r(e,t,i=!1){let n,r,s={firstDiffLeft:0,firstDiffRight:t.length};e.length<t.length?(n=e,r=t):(n=t,r=e),r.startsWith(n)?(s.firstDiffLeft=n.length,s.firstDiffRight=0):r.endsWith(n)?(s.firstDiffLeft=0,s.firstDiffRight=n.length):(s=o(e,t,i),s.firstDiffLeft+s.firstDiffRight>n.length&&(s.firstDiffRight=n.length-s.firstDiffLeft)),a(s,e,t);s.firstDiffLeft<e.length&&c(e,s.firstDiffLeft)||s.firstDiffLeft<t.length&&c(t,s.firstDiffLeft),s.firstDiffRight>0&&(s.firstDiffRight<e.length&&c(e,e.length-s.firstDiffRight)||s.firstDiffRight<t.length&&c(t,t.length-s.firstDiffRight));return s}function a(e,t,i){if(e.firstDiffLeft>0){const n=e.firstDiffLeft<t.length&&c(t,e.firstDiffLeft),r=e.firstDiffLeft<i.length&&c(i,e.firstDiffLeft);(n||r)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight>1){const n=e.firstDiffRight<t.length&&c(t,t.length-e.firstDiffRight),r=e.firstDiffRight<i.length&&c(i,i.length-e.firstDiffRight);(n||r)&&(e.firstDiffRight-=1)}}function o(e,t,i=!1){const n={firstDiffLeft:0,firstDiffRight:t.length};let r;for(r=0;r<e.length&&r<t.length;r+=1){const n=e.charCodeAt(r),a=t.charCodeAt(r);if(!(n===a||s(n,i)&&s(a,i)))break}for(n.firstDiffLeft=r,r=0;r<e.length&&r<t.length;r+=1){const n=e.charCodeAt(e.length-r-1),a=t.charCodeAt(t.length-r-1);if(!(n===a||s(n,i)&&s(a,i)))break}return n.firstDiffRight=r,n}function s(e,t=!1){switch(e){case 12288:case 8197:case 32:case 11:case 9:case 160:return!0;case 13:case 10:case 65532:return!t}return!1}function c(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}function l(e,t){return e.charCodeAt(t)>=55296&&e.charCodeAt(t)<=56319}function u(e){const t=e.toString();return t.toLowerCase()!==t.toUpperCase()}i.r(t),i.d(t,"extractTextContent",(function(){return n})),i.d(t,"getMinimalDifferenceBounds",(function(){return r})),i.d(t,"trimDifferenceBounds",(function(){return a})),i.d(t,"getDifferenceBounds",(function(){return o})),i.d(t,"isWhitespace",(function(){return s})),i.d(t,"isLowSurrogateCharAt",(function(){return c})),i.d(t,"isHighSurrogateCharAt",(function(){return l})),i.d(t,"isAlpha",(function(){return u})),i.d(t,"numbers",(function(){return d})),i.d(t,"isNumeric",(function(){return h})),i.d(t,"isAlphaNum",(function(){return g}));const d="0123456789";function h(e){return d.indexOf(e)>=0}function g(e){return u(e)||h(e)}},10035:function(e,t,i){"use strict";var n;i.r(t),i.d(t,"TextUnit",(function(){return n})),function(e){e[e.Default=0]="Default",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=4]="Sentence",e[e.Paragraph=8]="Paragraph",e[e.Page=16]="Page",e[e.Section=32]="Section",e[e.Chapter=64]="Chapter",e[e.Document=256]="Document",e[e.RawChars=16384]="RawChars"}(n||(n={}))},10036:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.NoReaction=0]="NoReaction",e[e.EnableFeature=1]="EnableFeature",e[e.DisableFeature=2]="DisableFeature"}(n||(n={}))},10037:function(e,t,i){"use strict";var n,r,a,o;i.d(t,"b",(function(){return n})),i.d(t,"d",(function(){return r})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return o})),function(e){e[e.CritiqueClicked=0]="CritiqueClicked",e[e.UpsellButtonClicked=1]="UpsellButtonClicked",e[e.ShowPage=2]="ShowPage",e[e.TryPremiumPreviewButtonClicked=3]="TryPremiumPreviewButtonClicked"}(n||(n={})),function(e){e[e.ShowCritiqueCallout=0]="ShowCritiqueCallout",e[e.SettingsPage=1]="SettingsPage",e[e.Outlook=2]="Outlook"}(r||(r={})),function(e){e.Regular_CCard="Regular_CCard",e.ContextualUpsell_CCard="ContextualUpsell_CCard",e.ContextualUpsell_SkittleOpenUpsellCallout="ContextualUpsell_SkittleOpenUpsellCallout",e.PremiumPreview_CCard="PremiumPreview_CCard",e.PremiumPreview_SkittleOpenOptInDialog="PremiumPreview_SkittleOpenOptInDialog",e.PremiumPreview_CCardOpenOptInDialog="PremiumPreview_CCardOpenOptInDialog",e.PremiumPreview_SkittleOpenPreviewEndCallout="PremiumPreview_SkittleOpenPreviewEndCallout",e.PremiumPreview_CCardOpenPreviewEndCallout="PremiumPreview_CCardOpenPreviewEndCallout",e.PremiumPreview_CountdownCallout="PremiumPreview_CountdownCallout",e.Regular_SettingsDialog="Regular_SettingsDialog",e.ContextualUpsell_SettingsDialog="ContextualUpsell_SettingsDialog",e.PremiumPreview_SettingsDialog="PremiumPreview_SettingsDialog"}(a||(a={})),function(e){e.SpellingEnabled="SpellingEnabled",e.SpellingDisabled="SpellingDisabled"}(o||(o={}))},10038:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(10039);function r(e,t=""){window.open(Object(n.a)(e,t),"_blank","noopener,noreferrer")}},10039:function(e,t,i){"use strict";function n(e,t){if(!function(e){if(0===e.trim().length)return!1;try{return new URL(e),!0}catch(e){return!1}}(e))return e;const i=new URL(e),n=t.trim();return i.pathname.endsWith("/")?i.pathname+=n:i.pathname=`${i.pathname}/${n}`,i.toString()}i.d(t,"a",(function(){return n}))},10040:function(e,t,i){"use strict";var n,r;i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),function(e){e[e.SettingsClicked=0]="SettingsClicked"}(n||(n={})),function(e){e[e.dropdown=0]="dropdown"}(r||(r={}))},1083:function(e,t,i){"use strict";var n=i(1),r=i(20),a=i(642),o=i(0),s=i.n(o);function c(e,t){var i=function(t,i){return s.a.createElement(l,Object(n.a)({},t),s.a.createElement(e,Object(n.a)({},t)))};return i.displayName=e.displayName,t?s.a.forwardRef(i):i}var l=Object(r.a)((function(e){var t=e.lid,i=e.when,n=e.series,r=e.children,o=e.disposeOnUnmount,c=void 0===o||o;return s.a.useEffect((function(){return Object(a.b)(t,i,n),function(){c&&a.c.importAndExecute(t)}}),[]),r&&d(t)?s.a.createElement(s.a.Fragment,null,r):null}));function u(e,t){a.c.importAndExecute(e,t)}function d(e){if(a.d.unseenItems){var t=a.d.unseenItems.get(e);if(null==t?void 0:t.visible)return!0}return!1}function h(e){var t;return null===(t=a.d.unseenItems)||void 0===t?void 0:t.has(e)}i.d(t,"d",(function(){return c})),i.d(t,"a",(function(){return l})),i.d(t,"e",(function(){return u})),i.d(t,"f",(function(){return d})),i.d(t,"c",(function(){return h})),i.d(t,"b",(function(){return a.a}))},11815:function(e,t,i){"use strict";var n,r;i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(n||(n={})),function(e){e.ContextualSpelling="818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",e.WrongSpelling="363d7011-83dd-4cc0-bdec-ea4af4df4dbb",e.TonalRewrite="965c8b90-32a3-4451-8c09-eba2c163dcec"}(r||(r={}))},11818:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(3593),r=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(n.PARAM_TYPES,e),userGeneratedMetadata:Reflect.getMetadata(n.TAGGED,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(n.TAGGED_PROP,e)||[]},e}();t.MetadataReader=r},11819:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(4328);t.isStackOverflowExeption=function(e){return e instanceof RangeError||e.message===n.STACK_OVERFLOW}},11820:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(4328),r=i(3593),a=i(4736),o=i(5686),s=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}();t.LazyServiceIdentifer=s,t.inject=function(e){return function(t,i,s){if(void 0===e)throw new Error(n.UNDEFINED_INJECT_ANNOTATION(t.name));var c=new a.Metadata(r.INJECT_TAG,e);"number"==typeof s?o.tagParameter(t,i,s,c):o.tagProperty(t,i,c)}}},11821:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(3593),r=i(6269),a=i(4736),o=i(16406),s=function(){function e(e,t,i,s){this.id=r.id(),this.type=e,this.serviceIdentifier=i,this.name=new o.QueryableString(t||""),this.metadata=new Array;var c=null;"string"==typeof s?c=new a.Metadata(n.NAMED_TAG,s):s instanceof a.Metadata&&(c=s),null!==c&&this.metadata.push(c)}return e.prototype.hasTag=function(e){for(var t=0,i=this.metadata;t<i.length;t++){if(i[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(n.MULTI_INJECT_TAG)},e.prototype.matchesArray=function(e){return this.matchesTag(n.MULTI_INJECT_TAG)(e)},e.prototype.isNamed=function(){return this.hasTag(n.NAMED_TAG)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return e.key!==n.INJECT_TAG&&e.key!==n.MULTI_INJECT_TAG&&e.key!==n.NAME_TAG&&e.key!==n.UNMANAGED_TAG&&e.key!==n.NAMED_TAG}))},e.prototype.isOptional=function(){return this.matchesTag(n.OPTIONAL_TAG)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===n.NAMED_TAG}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return e.key!==n.INJECT_TAG&&e.key!==n.MULTI_INJECT_TAG&&e.key!==n.NAME_TAG&&e.key!==n.UNMANAGED_TAG&&e.key!==n.NAMED_TAG})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(n.NAMED_TAG)(e)},e.prototype.matchesTag=function(e){var t=this;return function(i){for(var n=0,r=t.metadata;n<r.length;n++){var a=r[n];if(a.key===e&&a.value===i)return!0}return!1}},e}();t.Target=s},11822:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(10031),r=i(10032),a=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new r.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new n.BindingOnSyntax(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingWhenOnSyntax=a},11823:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(3593),r=i(4736),a=function(e,t){var i=e.parentRequest;return null!==i&&(!!t(i)||a(i,t))};t.traverseAncerstors=a;var o=function(e){return function(t){var i=function(i){return null!==i&&null!==i.target&&i.target.matchesTag(e)(t)};return i.metaData=new r.Metadata(e,t),i}};t.taggedConstraint=o;var s=o(n.NAMED_TAG);t.namedConstraint=s;t.typeConstraint=function(e){return function(t){var i=null;if(null!==t){if(i=t.bindings[0],"string"==typeof e)return i.serviceIdentifier===e;var n=t.bindings[0].implementationType;return e===n}return!1}}},11824:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r}));const n=(e,t)=>{let i=!1;for(let n=0;n<e.length;n+=1)e[n]===t&&(i=!0,e.splice(n,1),n-=1);return i},r=()=>({listeners:[]})},11825:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i(3859),r=i(10029),a=i(2734),o=i(4737),s=i(5687);const c={IFeatureFlagsReader:n.a.IFeatureFlagsReader,IHostSettings:n.a.IHostSettings,IInstrumentationMessageProcessor:n.a.IInstrumentationMessageProcessor,ILocalizer:n.a.ILocalizer,ILogger:n.a.ILogger,IProofingPersistedStore:n.a.IProofingPersistedStore,IResourceUrlFormatter:n.a.IResourceUrlFormatter,IShowSynonymsFeature:n.a.IShowSynonymsFeature,IUpsellFeature:n.a.IUpsellFeature,IRoamingDictionaryFeature:n.a.IRoamingDictionaryFeature,IExternalSettingsFeature:n.a.IExternalSettingsFeature,IUnsignedInEditorFeature:n.a.IUnsignedInEditorFeature,ICritiqueCalloutStateStore:Object(r.a)("ICritiqueCalloutStateStore"),ISquigglerStateStoreFactory:Object(r.a)("ISquigglerStateStoreFactory"),ISquiggleStateStoreFactory:Object(r.a)("ISquiggleStateStoreFactory"),ISquiggleTooltipStateStore:Object(r.a)("ISquiggleTooltipStateStore"),ISquiggleTooltipStateStoreFactory:Object(r.a)("ISquiggleTooltipStateStoreFactory"),IAriaStatusStateStore:Object(r.a)("IAriaStatusStateStore"),IAriaStatusUniqueProxy:Object(r.a)("IAriaStatusUniqueProxy"),IContentValidator:o.a.IContentValidator,ICritiqueInterpreter:o.a.ICritiqueInterpreter,ILanguageScriptDirectionDetector:o.a.ILanguageScriptDirectionDetector,IPresentationSettings:o.a.IPresentationSettings,IWordDictionary:o.a.IWordDictionary,IPresentationDomSettings:Object(r.a)("IPresentationDomSettings"),IStyleDefinitions:Object(r.a)("IPresentationDomStyleDefinitions"),IUpsellStore:a.a.IUpsellStore,ITextRetrieverFactory:s.a.ITextRetrieverFactory}},11826:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(6270),r=i(4140);class a{static logUnhandledError(e,t,i,a){e.logEvent(575705184,i,n.a.Error,a,r.i.CriticalExperimentation,t)}static addUnhandledExceptionsListeners(e,t,i){}}},11827:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(3108),r=i(2037),a=i(3859);let o=class{constructor(e){this.registrables=e,this.initializeCalled=!1,this.shutDownCalled=!1}async initialize(){if(!this.initializeCalled){this.initializeCalled=!0;for(const e of this.registrables)await e.initialize();this.shutDownCalled=!1}}async shutDown(){this.shutDownCalled||(this.shutDownCalled=!0,await Promise.all(this.registrables.map(async e=>e.shutDown())))}async addRegistrable(e){await e.initialize(),this.registrables.push(e)}};o=Object(n.a)([Object(r.injectable)(),Object(n.b)(0,Object(r.multiInject)(a.a.IRegistrable))],o)},11828:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(3108),r=i(2037),a=i(3859);let o=class{constructor(e){this._cleanables=e,this.disableCalled=!1}disableContentScript(){this.disableCalled||(this.disableCalled=!0,this._cleanables.forEach(e=>e.cleanUp()))}};o=Object(n.a)([Object(r.injectable)(),Object(n.b)(0,Object(r.multiInject)(a.a.ICleanable))],o)},11829:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(3108),r=i(14);class a{constructor(e){this.equalsTo=e=>{if(!e||this._codesList.length!==e.length)return!1;for(let t=0;t<this._codesList.length;t+=1)if(this._codesList[t]!==e[t])return!1;return!0},this.add=e=>!this._codesList.includes(e)&&(this._codesList.push(e),!0),this.remove=e=>{const t=this._codesList.indexOf(e);return!(t<0)&&(this._codesList.splice(t,1),!0)},this.moveUp=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const i=this._codesList[t-1];return this._codesList[t-1]=this._codesList[t],this._codesList[t]=i,!0},this.moveToTop=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const i=this._codesList[t];for(let e=t;e>0;e-=1)this._codesList[e]=this._codesList[e-1];return this._codesList[0]=i,!0},this._codesList=e}get count(){return this._codesList?this._codesList.length:0}get defaultLanguageCode(){return this._codesList&&this._codesList.length>0?this._codesList[0]:""}get codesList(){return this._codesList||[]}}Object(n.a)([r.observable],a.prototype,"_codesList",void 0),Object(n.a)([r.computed],a.prototype,"count",null),Object(n.a)([r.computed],a.prototype,"defaultLanguageCode",null),Object(n.a)([r.computed],a.prototype,"codesList",null)},11830:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.NewData="NewData",e.RemoveData="RemoveData",e.ChangeData="ChangeData"}(n||(n={}))},11831:function(e,t,i){"use strict";function n(e,t){const i=function(e){const t=e&&(e.commonAncestorContainer||e),i=t&&(t.ownerDocument||("[object HTMLDocument]"===Object.prototype.toString.apply(t)?t:null));return i&&(i.defaultView||window)}(e),n=i&&i[t],r=window,a=r&&r[t];return a&&e instanceof a||n&&e instanceof n}i.d(t,"a",(function(){return n}))},11832:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.IgnoreOnce="IgnoreOnce",e.ApplySuggestion="ApplySuggestion",e.DisableCritiqueType="DisableCritiqueType"}(n||(n={}))},11833:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.IgnoreListUpdate="IgnoreListUpdate",e.CustomDictionaryUpdate="CustomDictionaryUpdate"}(n||(n={}))},11834:function(e,t,i){"use strict";var n,r;i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),function(e){e[e.ClientInitialized=0]="ClientInitialized"}(n||(n={})),function(e){e[e.WordDictionaryInit=0]="WordDictionaryInit"}(r||(r={}))},11835:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return l}));var n,r,a=i(3108),o=i(2037),s=i(3859),c=i(5688);!function(e){e[e.SettingsShown=0]="SettingsShown",e[e.CalloutShown=1]="CalloutShown",e[e.PageContext=2]="PageContext"}(n||(n={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout",e[e.PageContext=2]="PageContext"}(r||(r={}));let l=class extends c.a{constructor(e,t,i){super(),this._isSignedInUser=e,this._featureFlagsReader=t,this._languageDetector=i,this.enablers=[!0],this.disablers=[this,this._isSignedInUser]}check(){return!this._featureFlagsReader.flags.enableUnsignedInEditor}async emitAndEvaluateAsync(e){return this.emitAndEvaluate(e)&&this.checkForMultipleLanguages()}async checkForMultipleLanguages(){const e=await this.countUniqueLanguages();return!this._featureFlagsReader.flags.enableSuppressUnsignedInEditorForMultiLang||e<=1}async countUniqueLanguages(){return(await this._languageDetector.getBrowserLanguages()).reduce((e,t)=>{const i=t.split("-");if(i.length>0){const t=i[0];e.add(t)}return e},new Set).size}};l=Object(a.a)([Object(o.injectable)(),Object(a.b)(0,Object(o.inject)(s.a.IsSignedInUser)),Object(a.b)(1,Object(o.inject)(s.a.IFeatureFlagsReader)),Object(a.b)(2,Object(o.inject)(s.a.IUxLanguageDetector))],l)},11836:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(8334),r=i(8332);class a{constructor(e,t){this._backgroundActivityId=e,this._hostEmitter=t,this._startTime=n.a()}createChildActivity(e){throw new Error("Method not implemented.")}executeAsync(e){throw new Error("Method not implemented.")}executeSync(e){throw new Error("Method not implemented.")}executeChildActivityAsync(e,t){throw new Error("Method not implemented.")}executeChildActivitySync(e,t){throw new Error("Method not implemented.")}setEventFlags(e){throw new Error("Method not implemented.")}get startTime(){return this._startTime}setSuccess(e){this._hostEmitter.emit(r.a.activitySetSuccessTelemetryEvent,{address:this._backgroundActivityId,message:e})}setResult(e,t,i){this._hostEmitter.emit(r.a.activitySetResultTelemetryEvent,{address:this._backgroundActivityId,message:{resultCode:e,resultType:t,resultTag:i}})}addDataField(e){this._hostEmitter.emit(r.a.activityAddDataFieldTelemetryEvent,{address:this._backgroundActivityId,message:Object.assign({},e)})}addDataFields(e){e.forEach(e=>this.addDataField(e))}endNow(){this._hostEmitter.emit(r.a.activityEndNowTelemetryEvent,{address:this._backgroundActivityId,message:null})}}},11837:function(e,t){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var n=new Uint8Array(16);e.exports=function(){return i(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},11838:function(e,t){for(var i=[],n=0;n<256;++n)i[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,r=i;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}},11839:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n,r=i(4739),a=i(2037),o=i(10034),s=i(8333);let c=n=class{constructor(){this.supportsBrowserWordBreaking=!1}getForwardBreakByWord(e,t){let i=this.getForwardBreak(e,t);return i&&(i.wordBreakType!==s.a.WhiteSpace||(i=this.getForwardBreak(e,i.cp),i))?i.cp:e.length}getBackwardBreakByWord(e,t){let i=this.getBackwardBreak(e,t);return i&&(i.wordBreakType!==s.a.WhiteSpace||(i=this.getBackwardBreak(e,i.cp),i))?i.cp:0}getForwardBreak(e,t){return this.getForwardBreakInternal(e,t,e.length)}getBackwardBreak(e,t){return this.getBackwardBreakInternal(e,t)}getTextStartWordBreak(e){return this.getTextWordBreak(e,0)}getTextWordBreak(e,t){return{cp:t,wordBreakType:n.getWordBreakType(e,t)}}getBreaks(e){const t=this.getBreaksForRange(e,0,e.length);return e.length&&t.splice(0,0,this.getTextStartWordBreak(e)),t}getBreaksForRange(e,t,i){const r=[];if(!e)return r;let a=t,o=!1;for(;!o;){const t=this.getForwardBreakInternal(e,a,i);if(t)if(t.wordBreakType===s.a.Invalid)if(a=t.cp+1,a>=i)o=!0;else{const i=n.getWordBreakType(e,t.cp),o=n.getWordBreakType(e,a);i!==o&&r.push({cp:a,wordBreakType:o})}else r.push(t),a=t.cp;else o=!0}return r}getWordCount(e,t){return this.getWordCountFromWordBreaks(e,t).wordCount}getWordCountInRange(e,t,i){const n=this.getBreaksForRange(e,t,i);return n.splice(0,0,this.getTextWordBreak(e,t)),this.getWordCount(n,e)}getWordCountFromWordBreaks(e,t){const i={browserWordBreakCount:0,wordCount:0};for(let r=0;r<e.length;r+=1){const a=e[r];a.wordBreakType===s.a.AlphaNumeric||a.wordBreakType===s.a.Undetermined?(a.wordBreakType===s.a.Undetermined&&(i.browserWordBreakCount+=1),n.shouldCountAlphaBreak(r,e,t)&&(i.wordCount+=1)):a.wordBreakType!==s.a.Punctuation&&a.wordBreakType!==s.a.PuncuationWithoutBreak||n.shouldCountPuncuationBreak(r,e,t)&&(i.wordCount+=1)}return i}static shouldCountAlphaBreak(e,t,i){if(!e)return!0;const r=t[e];if(!r.cp)return!0;const a=t[e-1];let o=!0;if(a.wordBreakType===s.a.Punctuation){let e=!1;for(let t=a.cp;t<r.cp;t+=1){const r=i.charAt(t);if("-"===r){if(e)return!0;e=!0}else e=!1;if(o=n.doesPunctuationIndiciateNewWord(r),o)return!0}}else if(a.wordBreakType===s.a.Undetermined)return!1;return(r.wordBreakType!==s.a.Undetermined||a.wordBreakType===s.a.WhiteSpace)&&o}static shouldCountPuncuationBreak(e,t,i){const r=t[e];if(n.doesPunctuationIndiciateNewWord(i.charAt(r.cp)))return!1;if(!e)return!0;if(!r.cp)return!1;const a=t[e-1];return a.wordBreakType===s.a.WhiteSpace||a.wordBreakType===s.a.FootnoteEndnotePunctuation}static doesPunctuationIndiciateNewWord(e){return"–"===e||"—"===e}getBackwardBreakInternal(e,t){if(t<=1)return;let i=t;for(;i>0;){const t=n.getWordBreakType(e,i-1);switch(t){case s.a.Undetermined:break;case s.a.AlphaNumeric:case s.a.Punctuation:case s.a.WhiteSpace:case s.a.PuncuationWithoutBreak:case s.a.FootnoteEndnotePunctuation:{if(i<=1)return;const r=i-1,a=n.getWordBreakType(e,r-1);if(t!==a&&n.shouldCreateBreakOnNextWordBreak(t,a)&&(a!==s.a.Undetermined||!this.supportsBrowserWordBreaking))return{cp:r,wordBreakType:t};break}}i-=1}}getForwardBreakInternal(e,t,i){if(t>=i-1)return;let r=t;for(;r<i;){const t=n.getWordBreakType(e,r);switch(t){case s.a.Undetermined:break;case s.a.AlphaNumeric:case s.a.Punctuation:case s.a.WhiteSpace:case s.a.PuncuationWithoutBreak:case s.a.FootnoteEndnotePunctuation:{if(r>=i-1)return;const a=r+1,o=n.getWordBreakType(e,a);if(t!==o&&n.shouldCreateBreakOnNextWordBreak(t,o)&&(o!==s.a.Undetermined||!this.supportsBrowserWordBreaking))return{cp:a,wordBreakType:o};break}}r+=1}}static shouldCreateBreakOnNextWordBreak(e,t){const i=e===s.a.AlphaNumeric&&t!==s.a.PuncuationWithoutBreak,n=e===s.a.PuncuationWithoutBreak&&t!==s.a.AlphaNumeric,r=e===s.a.Punctuation||e===s.a.FootnoteEndnotePunctuation,a=e===s.a.WhiteSpace;return n||i||r||a}static getWordBreakType(e,t){const i=e.charAt(t).toString();return o.isAlphaNum(i)?s.a.AlphaNumeric:n.isWhiteSpace(i)?s.a.WhiteSpace:n.isPunctuation(i)?s.a.Punctuation:n.isPunctuationWithoutBreak(i)?s.a.PuncuationWithoutBreak:n.isFootnoteEndnotePunctuation(i)?s.a.FootnoteEndnotePunctuation:s.a.Undetermined}static isWhiteSpace(e){return new RegExp("[\\u0000-\\u001F]|\\u0020|[\\u007F-\\u009F]|\\u00A0|[\\u2000-\\u200C]|\\u202F|\\u205F|\\u2420|[\\u2422-\\u2424]|\\u3000|\\uFF02").test(e)}static isPunctuation(e){return new RegExp("[!-&]|[\\(-\\.]|/|[:-@]|[\\[-`]|[{-~]|¡|¦|§|©|«|¬|®|°|±|[´-·]|»|¿|×|÷|ǃ|;|[‒-―]|[‚-•]|[․-…]|\\u202F|‰|‹|›|‼|‽|⁈|⁉|\\u2060|℃|℅|℆|℉|№|™|∑|−|√|∞|∫|≈|≠|≤|≥|\\u25A1|\\u25AA|\\u25AB|◊|●|◦|[☹-☻]|❢|。|[〝-〟]|\\uFEFF|！|．|；|？|｡").test(e)}static isPunctuationWithoutBreak(e){return"'"===e||"‘"===e||"’"===e}static isFootnoteEndnotePunctuation(e){return""===e}};c=n=Object(r.a)([Object(a.injectable)()],c)},11840:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(4739),r=i(2037),a=i(5687),o=i(8333);let s=class{constructor(e,t){this._wordCount=e,this._hostSettings=t}hasWordCountChanged(e,t,i){const n=this.computeValidWordCountForRange(i,0,i.length),r={isWordCountChanged:!1,wordCount:n};if(e&&e.firstDiffLeft+e.firstDiffRight<=i.length){if(this._wordCount.getWordCountInRange(i,e.firstDiffLeft,i.length-e.firstDiffRight)>1)return r.isWordCountChanged=!0,r}if(t>n)return r.isWordCountChanged=!0,r;const a=this.computeValidWordCountForRange(i,0,i.length-e.firstDiffRight);if(0===a)return r.isWordCountChanged=!1,r;const o=this.computeValidWordCountForRange(i,0,e.firstDiffLeft);return r.isWordCountChanged=a>o,r}computeValidWordCountForRange(e,t,i){if(t>=i||t<0||i>e.length)return 0;let n=this._wordCount.getWordCountInRange(e,t,i);if(n>0){const r=this._wordCount.getBreaksForRange(e,t,i);if(0===r.length)return 0;const a=r.length-1;r[a].wordBreakType!==o.a.WhiteSpace&&(this._hostSettings.newLineSentenceSeparatorEnabled||r[a].wordBreakType!==o.a.Punctuation)&&r[a].cp+1<=e.length&&(n-=1)}return n}};s=Object(n.a)([Object(r.injectable)(),Object(n.b)(0,Object(r.inject)(a.a.IWordCount)),Object(n.b)(1,Object(r.inject)(a.a.IHostSettings))],s)},11841:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(3108),r=i(2037),a=i(16440);let o=class{generate(){return Object(a.v4)()}};o=Object(n.a)([Object(r.injectable)()],o)},11842:function(e,t){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var n=new Uint8Array(16);e.exports=function(){return i(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},11843:function(e,t){for(var i=[],n=0;n<256;++n)i[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,r=i;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}},11844:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n,r=i(4739),a=i(2037),o=i(5687);!function(e){e[e.Start=0]="Start",e[e.End=1]="End"}(n||(n={}));let s=class{constructor(e,t){this._textExtractor=e,this._indexReadjuster=t,this.findOffsetPositions=(e,t)=>{const i=new Map;let r=0;t.sort((e,t)=>e.index-t.index);const a=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});let o=0;const s=this._textExtractor.extractElementText(e);if(t[0]&&t[0].index<0||t[t.length-1]&&t[t.length-1].index>s.length)return i;const c=this._indexReadjuster.getReadjustedIndices(e,t,s);for(;a.nextNode();){const e=a.currentNode,s=r,l=e.textContent?e.textContent.length:0,u=s+l;for(let r=o;r<t.length;r+=1){const a=c[r];if(a.indexType===n.Start&&a.index>=s&&a.index<u)o+=1,i.set(t[r].startIndex,{startNode:e,startOffset:a.index-s});else{if(!(a.indexType===n.End&&a.index>s&&a.index<=u))break;{o+=1;const n=i.get(t[r].startIndex);if(!n)throw new Error("The critique's end index has no conforming start index.");n.endNode=e,n.endOffset=a.index-s,i.set(t[r].startIndex,n)}}}if(r+=l,o===t.length)break}return i},this.createRange=(e,t)=>{if(!t||!t.endNode||!t.endOffset)return;const i=e.createRange();return i.setStart(t.startNode,t.startOffset),i.setEnd(t.endNode,t.endOffset),i}}getCritiqueRanges(e,t){const i=[];t.forEach(e=>{i.push({index:e.start,indexType:n.Start,startIndex:e.start}),i.push({index:e.start+e.length,indexType:n.End,startIndex:e.start})});const r=this.findOffsetPositions(e,i),a=e.ownerDocument||document;return t.map(e=>{const t=r.get(e.start);return{critique:e,range:this.createRange(a,t)}})}includePrecedingSpace(e,t){let i;if(t.startOffset>=0&&t.startContainer.textContent&&" "===t.startContainer.textContent.charAt(t.startOffset-1))i={startNode:t.startContainer,startOffset:t.startOffset-1};else if(0===t.startOffset){const n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});for(n.currentNode=t.startContainer;n.previousNode();){const e=n.currentNode;if(e.nodeType===e.TEXT_NODE&&e.textContent&&e.textContent.length>0){e.textContent.endsWith(" ")&&(i={startNode:e,startOffset:e.textContent.length-1});break}}}return i&&t.setStart(i.startNode,i.startOffset),t}};s=Object(r.a)([Object(a.injectable)(),Object(r.b)(0,Object(a.inject)(o.a.ITextExtractor)),Object(r.b)(1,Object(a.inject)(o.a.IIndexReadjuster))],s)},11845:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(4739),r=i(2037),a=i(11831);let o=class{extractElementText(e){let t="";return Object(a.a)(e,"HTMLTextAreaElement")||Object(a.a)(e,"HTMLInputElement")?t=e.value:e.innerText&&(t=e.innerText),t}};o=Object(n.a)([Object(r.injectable)()],o)},11846:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(4739),r=i(16443),a=i(2037);let o=class{constructor(){this.getIndex=e=>e.index>=0?e.index:e,this.getNewValue=(e,t)=>e.index>=0?(e.index=t,e):e=t,this._dmp=new r.diff_match_patch}getReadjustedIndices(e,t,i,n){const r=[],a=e.textContent||"",o=n?this._dmp.diff_main(i,a):this._dmp.diff_main(a,i);if(1===o.length&&0===o[0][0])return t;let s=0,c=0,l=0,u=0,d=0;for(const e of o){const i=e[0],n=e[1].length;switch(i){case 0:u=n,d=n;break;case 1:u=0,d=n;break;case-1:c+=n;continue}for(let e=s;e<t.length;e+=1){const n=this.getIndex(t[e]);if(n<l)throw new Error("Indices are not sorted!");if(!(n>=l&&n<l+d))break;r[e]=0===i?this.getNewValue(t[e],n+c-l):this.getNewValue(t[e],c),s+=1}if(s===t.length)break;c+=u,l+=d}for(let e=s;e<t.length;e+=1)r[e]=this.getNewValue(t[e],c);return r}};o=Object(n.a)([Object(a.injectable)()],o)},11847:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n,r=i(4739),a=i(2037),o=i(5687);let s=n=class{constructor(e){this._hostSettings=e}static getMatchRegexRange(e,t,i=0){const n=[];let r=t.exec(e);for(;null!==r;){if(r[i]){const e=r.index;n.push({begin:e,end:e+r[i].length})}r=t.exec(e)}return n}expandEndRange(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?n.NewExpandRuleChecks:n.ExpandRuleChecks;for(const i of t){const t=n.getMatchRegexRange(e,i);if(t.length>0&&0===t[0].begin)return t[0].end-1}return this._hostSettings.newLineSentenceSeparatorEnabled?-1:0}isEndPuncSpecialCase(e){const t=n.getMatchRegexRange(e,n.SpecialCaseCheck),i=this._hostSettings.newLineSentenceSeparatorEnabled?e.length-1:e.length;return t.some(e=>e.end===i)}findBeginBoundary(e,t,i){const r=this._hostSettings.newLineSentenceSeparatorEnabled?n.NewEndPuncCheck:n.EndPuncCheck,a=e.substring(i,t),o=n.getMatchRegexRange(a,r);for(let e=o.length-1;e>=0;e-=1){const t=a.substring(0,o[e].end);if(!this.isEndPuncSpecialCase(t)){const t=a.substring(o[e].begin,a.length),n=this.expandEndRange(t);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===n:!n)continue;return i+o[e].end+n}}return i}findEndBoundary(e,t,i){const r=e.substring(t,i),a=this._hostSettings.newLineSentenceSeparatorEnabled?n.NewEndPuncCheck:n.EndPuncCheck,o=n.getMatchRegexRange(r,a);for(const e of o){const i=r.substring(0,e.end);if(!this.isEndPuncSpecialCase(i)){const i=r.substring(e.begin,r.length),n=this.expandEndRange(i);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===n:!n)continue;return t+e.end+n}}return-1}splitInUnits(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?n.NewEndExpandRuleCheck:n.EndExpandRuleCheck,i=e.replace(n.SpecialCaseCheck,e=>"#".repeat(e.length));return n.getMatchRegexRange(i,t).map(e=>e.end)}};s.ClosingBrace="[)]}༻༽⁆〉》」』】〕〗〙〛〞〟）］｝｠｣]",s.SmileyChar="[☹☺☻]",s.OtherSpaceChar="[\0-\b\n--\u2028-\u2029  ]",s.Digit="[0-9٠-٩۰-۹०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙０-９]",s.OtherNumber="[²³¹¼½¾৴-৹௰௱௲౸-౾൰-൵༪-༳፩-፼៰-៹〇〡-〩〸〹〺]",s.Punct="[!-#%-*,-/:-;?-@_{}¡«¬·»¿;·՚-՟։-֊־׀׃׆׳-״؉-؊،-؍؛؞-؟٪-٭۔।-॥॰෴๏๚-๛༄-༒༺-༽྅࿐-࿔၊-၏჻፡-፨᙭-᙮។-៖៘-៚᠀-᠊‐-‧‰-⁃⁅-⁑⁓-⁞、-〃〈-】〔-〟〰〽゠・！-＃％-＊，-／：-；？-＠［-］＿｛｝｟-･]",s.Symbol="[$+<=>^`|~¢£¤¥-©¬®¯°±´¶¸×÷˂-˅˒-˟˥-˫˭˯-˿͵΄΅϶҂؆؇؈؋؎؏۞۩۽۾৲৳৺૱୰௳-௺౿൹฿༁༂༃༓༕༖༗༚-༟༴༶༸྾-࿅࿇-࿌࿎࿏႞႟᎐-᎙៛⁄⁒〄〒〓〠〶〷〾〿゛゜＄＋＜＝＞＾｀｜～￠-￦￨-￮]",s.OtherControl="[؀-؃۝᠎​-‍⁠-⁤⁪-⁯]",s.LetterUpperLower_Halfwidth="[A-Za-zªµºÀ-ÐÑ-ÖØ-öø-ƺƼ-ƿǄ-ʓʕ-ͳͶͷͻͼͽΆΈΉΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԣԱ-Ֆա-ևႠ-Ⴥ]",s.LetterUpperLower_Fullwidth="[Ａ-Ｚａ-ｚ]",s.LetterOther_NonCjThai="[ƻǀ-ǃʔא-תװױײء-ؿف-يٮٯ-ۓٱەۮۯۺۻۼۿऄ-हऽॐक़-ॡॲॻ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়ৠৡৰৱਅ-ਊਏਐਓ-ਙਚ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-നപ-ഹഽൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜໝༀཀ-ཇཉ-ཬྈ-ྋក-ឳៗៜက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎა-ჺᄀ-ᅙᅟᅠ-ᆢᆨ-ᇹሀ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙶᠠ-ᡷᢀ-ᢨᢪ〆〼가-힣ﾠ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]",s.LetterOther_Cj="[ぁ-ゖゟァ-ヺヿ豈-鶴侮-頻並-龎ｦ-ﾝ]",s.LetterOther_Thai="[ก-ะาำเ-ๅ]",s.EndPunc="[?!.։۔܁܂।॥።᙮᠃᠉⳹⳾。꓿꘎꛳︒﹒．｡]",s.EndPuncCJ="[。｡]",s.SpaceChar="[   -   　\t]",s.FinalQuotationChar="[»’”›\"']",s.OtherChar=`${n.ClosingBrace}|${n.SmileyChar}`,s.LineEnd="[\u2028\u2029\n\r]",s.LeftContext_OrdinalNumber=`(${n.SpaceChar}|${n.OtherSpaceChar}|${n.Punct}|${n.OtherControl})`,s.LeftContext_Abbrev_Cj=`(${n.SpaceChar}|${n.OtherSpaceChar}|${n.Punct}|${n.Symbol}|${n.OtherControl}|${n.Digit}|${n.OtherNumber})`,s.expandRule1=`(${n.EndPunc}(${n.OtherChar}|${n.FinalQuotationChar}|${n.SpaceChar})*${n.LineEnd})`,s.expandRule2=`(${n.EndPunc}(${n.OtherChar})*(${n.SpaceChar})+)`,s.expandRule3=`(${n.EndPuncCJ}(${n.OtherChar})*)`,s.expandRule4=`((${n.LineEnd})+)`,s.expandRule5=`(${n.EndPunc}(${n.OtherChar}|${n.FinalQuotationChar}|${n.SpaceChar})*(${n.LineEnd})+)`,s.ExpandRuleChecks=[new RegExp(n.expandRule1,"ig"),new RegExp(n.expandRule2,"ig"),new RegExp(n.expandRule3,"ig")],s.NewExpandRuleChecks=[new RegExp(n.expandRule2,"ig"),new RegExp(n.expandRule3,"ig"),new RegExp(n.expandRule4,"ig"),new RegExp(n.expandRule5,"ig")],s.EndExpandRuleCheck=new RegExp(`${n.expandRule1}|${n.expandRule2}|${n.expandRule3}`,"ig"),s.NewEndExpandRuleCheck=new RegExp(`${n.expandRule2}|${n.expandRule3}\n    |${n.expandRule4}|${n.expandRule5}`,"ig"),s.specialCase1="[.。﹒．｡]{2,6}|[.]([ ][.]){1,5}",s.specialCase2_Halfwidth="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]",s.specialCase2_Fullwidth="((([Ｌ]?[Ｘ]{1,3}|[Ｘ][ＬＣ]|[Ｌ])?([Ｖ]?[Ｉ]{1,3}|[Ｉ][ＶＸ]|[Ｖ]))|([Ｌ]?[Ｘ]{1,3}|[Ｘ][ＬＣ]|[Ｌ])|(([ｌ]?[ｘ]{1,3}|[ｘ][ｌｃ]|[ｌ])?([ｖ]?[ｉ]{1,3}|[ｉ][ｖｘ]|[ｖ]))|([ｌ]?[ｘ]{1,3}|[ｘ][ｌｃ]|[ｌ]))[.﹒．]",s.specialCase2=`${n.specialCase2_Halfwidth}|${n.specialCase2_Fullwidth}`,s.specialCase3="([0-9]{1,4}[.]|[０-９]{1,4}[.﹒．])",s.specialCase4="([0-9]+(([aoªºᵃᵒ])|((er)[ao]?)|(([ᵉ][ʳ])[ᵃᵒ]?)|([mdtvn][ao])|([ᵐᵈᵗᵛⁿ][ᵃʳ]))[.]|[A-Za-zÀÄÈÉÔÖÜßàäèéôöü]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-zÀÄÈÉÔÖÜßàäèéôöü]+((STR)|(str))[.])",s.specialCase5=`((${n.LetterUpperLower_Halfwidth}|${n.LetterOther_NonCjThai}|${n.LetterOther_Thai})[.])+|((${n.LetterOther_Cj})[.﹒．])+`,s.specialCase6=`(${n.LetterUpperLower_Fullwidth})[.﹒．]`,s.sensitiveCaseOrdinalNumber=`${n.LeftContext_OrdinalNumber}(${n.specialCase2}|${n.specialCase3}|${n.specialCase4})`,s.sensitiveCaseAbbrev=`${n.LeftContext_Abbrev_Cj}(${n.specialCase5})`,s.noSensitiveCase=`${n.specialCase1}|${n.specialCase6}`,s.specialCase=`${n.noSensitiveCase}|${n.sensitiveCaseOrdinalNumber}|${n.sensitiveCaseAbbrev}`,s.EndPuncCheck=new RegExp(`${n.EndPunc}|${n.EndPuncCJ}`,"ig"),s.NewEndPuncCheck=new RegExp(`${n.EndPunc}|${n.EndPuncCJ}|${n.LineEnd}`,"ig"),s.SpecialCaseCheck=new RegExp(n.specialCase,"g"),s=n=Object(r.a)([Object(a.injectable)(),Object(r.b)(0,Object(a.inject)(o.a.IHostSettings))],s)},11848:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(4739),r=i(2037);let a=class{findBeginBoundary(e,t,i){return Math.min(t,i)}findEndBoundary(e,t,i){return e.length<i?-1:Math.max(t,i)}splitInUnits(e){return[e.length]}};a=Object(n.a)([Object(r.injectable)()],a)},11849:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n,r=i(4739),a=i(2037),o=i(5687),s=i(10035);let c=n=class{constructor(e,t){this._sentenceSeparator=e,this._unitySeparator=t}splitInUnitsFromExtendedBoundaries(e,t,i,r){const a=this._getUnitSeparator(i),o=r||n._extendBoundariesFromDiffBounds(e,t,a),s=n._splitInUnits(a,e,t,o);return!s.length||s[s.length-1].validEndBoundary&&!1!==s[s.length-1].validEndBoundary||(s[s.length-1]=n._checkForValidSeparatorAtEnd(e,s[s.length-1],a)),s}extendBoundariesFromDiffBounds(e,t,i){return n._extendBoundariesFromDiffBounds(e,t,this._getUnitSeparator(i))}_getUnitSeparator(e){switch(e){case s.TextUnit.Sentence:return this._sentenceSeparator;default:return this._unitySeparator}}static _extendBoundariesFromDiffBounds(e,t,i){let n,r=0,a=e.length,o=t.firstDiffLeft+1;if(e.length)do{if(o-=1,r=i.findBeginBoundary(e,o,0),a=i.findEndBoundary(e,e.length-t.firstDiffRight,e.length),n=-1!==a,a=-1!==a?a:e.length,o<e.length){if(r===i.findBeginBoundary(e,o+1,0))continue}let s=r,c=0;for(;s&&o===s+c;){c+=1;const t=s;if(s=i.findBeginBoundary(e,s-1,0),s<t-1){r=s;break}}}while(!(a-r));return{offset:r,span:a-r,validEndBoundary:n}}static _splitInUnits(e,t,i,r){if(!i.firstDiffLeft&&!i.firstDiffRight&&!r.offset&&r.span===t.length)return n._fullTextSplit(e,t);const a=t.slice(r.offset,r.offset+r.span),o=i.firstDiffLeft-r.offset,s=i.firstDiffRight-(t.length-r.offset-r.span);let c=0,l=0;const u=[],d=Math.min(a.length,a.length-s+2);do{const t=c;c=e.findEndBoundary(a,Math.max(c,o-2),d),l=-1!==c&&c<d?c:a.length,l-t&&u.push({offset:t+r.offset,span:l-t,validEndBoundary:-1!==c,enforcedCompleteTileTextUnit:r.enforcedCompleteTileTextUnit})}while(l<a.length);return u}static _checkForValidSeparatorAtEnd(e,t,i){if(!1===t.validEndBoundary&&t.span>=2){let n,r=t.span;do{n=e.slice(t.offset+r-2,t.offset+r),r-=1}while(!/\S/.test(n)&&r>=2);t.validEndBoundary=-1!==i.findEndBoundary(n,0,n.length)}return t}static _fullTextSplit(e,t){const i=[],n=e.splitInUnits(t);let r=0;return n.forEach(e=>{i.push({offset:r,span:e-r,validEndBoundary:-1!==e}),r=e}),(!n.length||n.length&&n[n.length-1]!==t.length)&&i.push({offset:r,span:t.length-r,validEndBoundary:!1}),i}};c=n=Object(r.a)([Object(a.injectable)(),Object(r.b)(0,Object(a.inject)(o.a.ITextUnitSeparator)),Object(r.b)(0,Object(a.named)(s.TextUnit.Sentence)),Object(r.b)(1,Object(a.inject)(o.a.ITextUnitSeparator)),Object(r.b)(1,Object(a.named)(s.TextUnit.Default))],c)},11850:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(4739),r=i(2037),a=i(8335);let o=class extends a.a{replace(e,t){if(!this.element)return;const i=this.element.value.length,n=Math.min(e.start,i),r=Math.min(e.start+e.length,i);this.element.setRangeText(t.text,n,r,"end"),this.dispatchInputEvent()}remove(e){if(!this.element)return;const t=this.element.value.length;let i=Math.min(e.start,t);const n=Math.min(e.start+e.length,t);" "===this.element.value[i-1]&&(i-=1),this.element.setRangeText("",i,n),this.dispatchInputEvent()}};o=Object(n.a)([Object(r.injectable)()],o)},11851:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.HtmlEditTextProcessor="HtmlEditTextProcessor",e.HtmlElementTextProcessor="HtmlElementTextProcessor",e.KixTextProcessor="KixTextProcessor",e.ContentEditableTextProcessor="ContentEditableTextProcessor",e.ContentEditableWithTimeoutTextProcessor="ContentEditableWithTimeoutTextProcessor"}(n||(n={}))},11852:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(4739),r=i(2037),a=i(5687),o=i(8335);let s=class extends o.a{constructor(e,t){super(e),this.textNodeRangeBuilder=t,this.getRangeAndPerformOperation=(e,t)=>{if(!this.element)return;const i=this.element.ownerDocument;if(!i)return;const n=this.textNodeRangeBuilder.getCritiqueRanges(this.element,[e])[0];n.range&&t(i,n.range,this.element)},this.selectRange=(e,t)=>{const i=e.getSelection();return!!i&&(i.removeAllRanges(),i.addRange(t),i.setBaseAndExtent(t.startContainer,t.startOffset,t.endContainer,t.endOffset),!0)}}replace(e,t){window.requestAnimationFrame(()=>this.getRangeAndPerformOperation(e,(e,i)=>{this.selectRange(e,i),this.doReplacement(e,t.text)}))}remove(e){window.requestAnimationFrame(()=>this.getRangeAndPerformOperation(e,(e,t,i)=>{this.textNodeRangeBuilder.includePrecedingSpace(i,t),this.selectRange(e,t),this.doRemoval(e)}))}doReplacement(e,t){const i=new Event("createUndoCheckpoint");e.dispatchEvent(i),this.innerDoReplacement(e,t),e.dispatchEvent(i)}doRemoval(e){const t=new Event("createUndoCheckpoint");e.dispatchEvent(t),this.innerDoRemoval(e),e.dispatchEvent(t)}innerDoReplacement(e,t){e.execCommand("insertText",!1,t),this.dispatchInputEvent()}innerDoRemoval(e){e.execCommand("delete",!1),this.dispatchInputEvent()}};s=Object(n.a)([Object(r.injectable)(),Object(n.b)(0,Object(r.inject)(a.a.ITextRetrieverFactory)),Object(n.b)(1,Object(r.inject)(a.a.ITextNodeRangeBuilder))],s)},11853:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e){this.element=e}retrieve(){return this.element.value}}},11854:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e){this.element=e}retrieve(){return this.element?this.element.innerText:""}}},11855:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(3108),r=i(2037),a=i(8329),o=i(7594);let s=class extends o.a{checkUserInfo(){return this.licenseType===a.b.NoLicense&&this.identityProvider===a.a.MSA}};s=Object(n.a)([Object(r.injectable)()],s)},11856:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(3108),r=i(2037),a=i(8329),o=i(7594);let s=class extends o.a{checkUserInfo(){return this._expiry?Date.now()<=this._expiry:this.licenseType===a.b.Subscription}setGracePeriodUntil(e){this._expiry=e}};s=Object(n.a)([Object(r.injectable)()],s)},11857:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(3108),r=i(2037),a=i(7594);let o=class extends a.a{checkUserInfo(){return!!this.isLoggedIn}};o=Object(n.a)([Object(r.injectable)()],o)},11858:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i(3108),r=i(2037),a=i(7595),o=i(3859),s=i(5688),c=i(10038),l=i(10037),u=i(4140);let d=class extends s.a{constructor(e,t,i,n){super(),this._isUpsellUser=e,this.logger=t,this._featureFlagsReader=i,this.hostSettings=n,this.disablers=[this],this.enablers=[!1,this._isUpsellUser]}emitAndEvaluate(e){if(e.eventId===l.b.UpsellButtonClicked){const t=this.logger.getNewActivity(a.b.ActionUpsellButtonClicked,u.i.CriticalExperimentation),i=this._featureFlagsReader.flags.enableSpellingUpsell?l.a.SpellingEnabled:l.a.SpellingDisabled;t&&(t.addDataFields([{name:"Event_Source",value:JSON.stringify(e.sender),dataType:u.d.String,classification:u.c.EssentialServiceMetadata},{name:"Upsell_Location",value:e.location||"",dataType:u.d.String,classification:u.c.EssentialServiceMetadata},{name:"CCard_Treatment",value:l.c.Regular_CCard||e.location===l.c.ContextualUpsell_CCard?i:"",dataType:u.d.String,classification:u.c.EssentialServiceMetadata}]),t.setSuccess(!0),t.endNow())}return super.emitAndEvaluate(e)}check(){return!this._featureFlagsReader.flags.enableUpsellFeature}processCallBackResult(e,t,i){return this._upsellLinkFromListener=i.upsellLink,super.processCallBackResult(e,t,i)}goPremium(e,t,i){const n={eventId:l.b.UpsellButtonClicked,sender:e,critique:t,location:i};this._upsellLinkFromListener=void 0,this.emitAndEvaluate(n),this._upsellLinkFromListener?(Object(c.a)(this._upsellLinkFromListener),this._upsellLinkFromListener=void 0):Object(c.a)(this.hostSettings.upsellLink,e===l.d.ShowCritiqueCallout?"callout":e===l.d.SettingsPage?"settings":"")}};d=Object(n.a)([Object(r.injectable)(),Object(n.b)(0,Object(r.inject)(o.a.IsUpsellUser)),Object(n.b)(1,Object(r.inject)(o.a.ILogger)),Object(n.b)(2,Object(r.inject)(o.a.IFeatureFlagsReader)),Object(n.b)(3,Object(r.inject)(o.a.IHostSettings))],d)},11859:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(3108),r=i(2037),a=i(5688),o=i(10040);let s=class extends a.a{constructor(){super(),this.disablers=[],this.enablers=[!1]}openSettings(e){const t={eventId:o.a.SettingsClicked,sender:e};this.emitAndEvaluate(t)}};s=Object(n.a)([Object(r.injectable)()],s)},11860:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return l}));var n,r,a=i(3108),o=i(2037),s=i(3859),c=i(5688);!function(e){e[e.ShowPage=0]="ShowPage",e[e.GetMoreCommands=1]="GetMoreCommands"}(n||(n={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout"}(r||(r={}));let l=class extends c.a{constructor(e){super(),this._isPremiumUser=e,this.disablers=[],this.enablers=[!1,this._isPremiumUser]}};l=Object(a.a)([Object(o.injectable)(),Object(a.b)(0,Object(o.inject)(s.a.IsPremiumUser))],l)},11861:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n,r,a=i(3108),o=i(2037),s=i(3859),c=i(5688);!function(e){e[e.ShowPage=0]="ShowPage"}(n||(n={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.DropDown=1]="DropDown"}(r||(r={}));let l=class extends c.a{constructor(e){super(),this._isPremiumUser=e,this.disablers=[],this.enablers=[!1,this._isPremiumUser]}};l=Object(a.a)([Object(o.injectable)(),Object(a.b)(0,Object(o.inject)(s.a.IsPremiumUser))],l)},11862:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i(3108),r=i(12149),a=i(2037),o=i(3859),s=i(5688);let c=class extends s.a{constructor(e){super(),this.hostSettings=e,this.disablers=[],this.enablers=[!0]}check(){return!this.hostSettings.enableRoamingDictionary}getRoamingDictionary(){return this._roamingDictionary}isReady(){return!0===this.hostSettings.enableRoamingDictionary&&void 0!==this._roamingDictionary&&this._roamingDictionary.getLoadState()===r.a.LOADED}processCallBackResult(e,t,i){return this._roamingDictionary=i.roamingDictionary,super.processCallBackResult(e,t,i)}};c=Object(n.a)([Object(a.injectable)(),Object(n.b)(0,Object(a.inject)(o.a.IHostSettings))],c)},11863:function(e,t,i){"use strict";function n(e,t){return!(!e||!t)&&(e.start===t.start&&e.length===t.length&&e.priority===t.priority&&e.textInContext===t.textInContext)}function r(e,t){return!(!e||!t)&&!(e.start>=t.start+t.length||t.start>=e.start+e.length)}i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return a}));const a=(e,t,i)=>{if(e&&void 0!==t&&void 0!==i)return e.substring(t,t+i)}},11864:function(e,t,i){"use strict";function n(e,t){return!(!e||!t)&&(e.offset===t.offset+t.span||t.offset===e.offset+e.span)}function r(e,t){return!(!e||!t)&&!(e.offset>=t.offset+t.span||t.offset>=e.offset+e.span)}i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}))},11865:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n,r=i(3108),a=i(3859),o=i(2037),s=i(7595),c=i(4140);let l=n=class{constructor(e,t){var i,n,r;this._logger=e,this._hostSettings=t,this._eventName="End2EndTelemetry",this._alEventName="IsAL",this._performanceApiGarbageCollectorIntervalInMs=1e4,this._isAlEnabled=!0===(null===(i=this._hostSettings)||void 0===i?void 0:i.enableOrchestration)&&!0===(null===(r=null===(n=this._hostSettings)||void 0===n?void 0:n.orchestratorSettings)||void 0===r?void 0:r.enableAugLoop)}startEntry(e){if(!this._hostSettings.enableE2eMetric)return;this._scheduleGarbageCollection();const[t]=this._getPerformanceEntryNames(e);window.performance.mark(t)}_getPerformanceEntryNames(e){const t=`${this._eventName}-${e}`;return[`${t}--${n.START_SUFFIX}`,`${t}--${n.END_SUFFIX}`,t]}commitEntry(e){if(!this._hostSettings.enableE2eMetric)return;const[t,i,n]=this._getPerformanceEntryNames(e);if(0!==window.performance.getEntriesByName(t).length)try{window.performance.mark(i),window.performance.measure(n,t,i);const r=window.performance.getEntriesByName(n)[0];this._logToTelemetry(r.duration),this._clearPerformanceDataById(e)}catch(e){this._logger.logEvent(570786316,s.a.TelemetryError,c.h.Error,`Error while commiting a telemetry entry, error: ${e}`,c.i.CriticalExperimentation)}}_logToTelemetry(e){const t=this._logger.getNewActivity(this._eventName,c.i.CriticalExperimentation);t&&(t.addDataField({name:this._eventName,value:e,dataType:c.d.Double,classification:c.c.EssentialServiceMetadata}),t.addDataField({name:this._alEventName,value:this._isAlEnabled,dataType:c.d.Boolean,classification:c.c.EssentialServiceMetadata}),t.setSuccess(!0),t.endNow())}_clearAndReschedule(e){const t=Date.now(),i=window.performance.getEntries().filter(i=>{if(!i.name.match(`${this._eventName}(.*)`))return!1;const n=window.performance.timeOrigin+i.startTime;return!!(e&&!e.didTimeout&&0===e.timeRemaining()||t-n<this._performanceApiGarbageCollectorIntervalInMs)||(window.performance.clearMarks(i.name),window.performance.clearMeasures(i.name),!1)});this._garbageCollectionScheduler=void 0,i.length>0&&this._scheduleGarbageCollection()}_scheduleGarbageCollection(){this._garbageCollectionScheduler||("requestIdleCallback"in window?this._garbageCollectionScheduler=window.requestIdleCallback(e=>this._clearAndReschedule(e),{timeout:this._performanceApiGarbageCollectorIntervalInMs}):this._garbageCollectionScheduler=setTimeout(()=>{this._clearAndReschedule()},this._performanceApiGarbageCollectorIntervalInMs))}_clearPerformanceDataById(e){const[t,i,n]=this._getPerformanceEntryNames(e);window.performance.clearMarks(t),window.performance.clearMarks(i),window.performance.clearMeasures(n)}};l.END_SUFFIX="end",l.START_SUFFIX="start",l=n=Object(r.a)([Object(o.injectable)(),Object(r.b)(0,Object(o.inject)(a.a.ILogger)),Object(r.b)(1,Object(o.inject)(a.a.IHostSettings))],l)},11866:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i(3108),r=i(2037),a=i(8334),o=i(3859),s=i(8332),c=i(7595),l=i(4140);let u=class{constructor(e,t){this._hostEmitter=e,this._logger=t,this._remoteObjects={},this.onTelemetryEvent=async e=>{try{if(e&&e.message){const t=e.message;t.tagID&&t.level&&t.message&&this._logger.logEvent(t.tagID,t.eventName,t.level,t.message,t.sampling,t.data,t.experimentation)}}catch(e){this._logger.logEvent(571269910,c.a.AriaError,l.h.Error,"The call to Aria failed",l.i.CriticalBusinessImpact)}return!1},this.onNewActivityTelemetryEvent=async e=>{try{if(e&&e.address&&e.message){const t=e.message;this._remoteObjects[e.address]={activity:this._logger.getNewActivity(t.eventName,t.sampling,t.experimentation),startTime:Date.now()}}}catch(e){this._logger.logEvent(571269911,c.a.GetNewActivityError,l.h.Error,"The call to getNewActivity failed",l.i.CriticalBusinessImpact)}return!1},this.onAddDataFieldTelemetryEvent=async e=>this.processEnvelope(e,(e,t)=>{e.addDataField(t)}),this.onSetResultTelemetryEvent=async e=>this.processEnvelope(e,(e,t)=>{e.setResult(t.resultCode,t.resultType,t.resultTag)}),this.onSetSuccessTelemetryEvent=async e=>this.processEnvelope(e,(e,t)=>{e.setSuccess(t)}),this.onEndNowTelemetryEvent=async e=>this.processEnvelope(e,(t,i)=>new Promise(e=>{t.endNow(),e()}).then(()=>{delete this._remoteObjects[e.address]}).catch(()=>{delete this._remoteObjects[e.address]})),this.processEnvelope=async(e,t)=>{var i;try{if(e&&e.address){const n=e.message,r=null===(i=this._remoteObjects[e.address])||void 0===i?void 0:i.activity;r&&t(r,n)}}catch(e){this._logger.logEvent(571269912,c.a.EnvelopeFormatError,l.h.Error,"The call to processEnvelope failed",l.i.CriticalBusinessImpact)}return!1},setInterval(()=>{this.cleanupActivities()},6e5)}async initialize(){this._hostEmitter.on(s.a.telemetryEvent,this.onTelemetryEvent),this._hostEmitter.on(s.a.newActivityTelemetryEvent,this.onNewActivityTelemetryEvent),this._hostEmitter.on(s.a.activityAddDataFieldTelemetryEvent,this.onAddDataFieldTelemetryEvent),this._hostEmitter.on(s.a.activitySetResultTelemetryEvent,this.onSetResultTelemetryEvent),this._hostEmitter.on(s.a.activitySetSuccessTelemetryEvent,this.onSetSuccessTelemetryEvent),this._hostEmitter.on(s.a.activityEndNowTelemetryEvent,this.onEndNowTelemetryEvent)}async shutDown(){this._hostEmitter.off(s.a.telemetryEvent),this._hostEmitter.off(s.a.newActivityTelemetryEvent),this._hostEmitter.off(s.a.activityAddDataFieldTelemetryEvent),this._hostEmitter.off(s.a.activitySetResultTelemetryEvent),this._hostEmitter.off(s.a.activitySetSuccessTelemetryEvent),this._hostEmitter.off(s.a.activityEndNowTelemetryEvent)}cleanupActivities(){Object.keys(this._remoteObjects).forEach(e=>{const t=this._remoteObjects[e];t&&a.a()-t.startTime>36e8&&delete this._remoteObjects[e]})}};u=Object(n.a)([Object(r.injectable)(),Object(n.b)(0,Object(r.inject)(o.a.IHostEmitter)),Object(n.b)(1,Object(r.inject)(o.a.ILogger))],u)},11867:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(3108),r=i(2037);let a=class{triggerCallback(e,t){t?(this.userInfo=void 0,this.lastError=t):this.lastError=void 0,this.userInfo=e(this.userInfo)}async executeAsync(e=!0){return new Promise((t,i)=>{this.execute(e,e=>(this.lastError?i(this.lastError):t(e),e))})}};a=Object(n.a)([Object(r.injectable)()],a)},11868:function(e,t,i){"use strict";i.r(t),function(e){i.d(t,"BrowserInfo",(function(){return n})),i.d(t,"NodeInfo",(function(){return r})),i.d(t,"BotInfo",(function(){return a})),i.d(t,"detectBrowser",(function(){return c})),i.d(t,"parseUserAgent",(function(){return l})),i.d(t,"getNodeVersion",(function(){return u}));class n{constructor(e,t){this.name=e,this.version=t}}class r{constructor(e){this.version=e,this.name="node"}}class a{constructor(){this.bot=!0,this.name="bot",this.version=null}}const o=3,s=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]];function c(e){return e?l(e):navigator?l(navigator.userAgent):u()}function l(e){const t=""!==e&&s.reduce((t,[i,n])=>{if(t)return t;const r=n.exec(e);return!!r&&[i,r]},!1);if(!t)return null;const[i,r]=t;if("searchbot"===i)return new a;let c=r[1]&&r[1].split(/[._]/).slice(0,3);return c?c.length<o&&(c=[...c,...d(o-c.length)]):c=[],new n(i,c.join("."))}function u(){return e&&e.version?new r(e.version.slice(1)):null}function d(e){const t=[];for(let i=0;i<e;i+=1)t.push("0");return t}}.call(this,i(226))},11869:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n,r=i(3108),a=i(4140),o=i(2037),s=i(3859),c=i(8331);let l=n=class{constructor(e,t){this._userInfoStrategy=e,this._telemetrySink=t,this._appId="",this._clientId="",this._initialized=!1,this._initializing=!1,this._enableOptionalDiagnostic=!0,this._configurationId="",this.requiredDiagnosticEventCategoryName=new Set(["ExtensionInstalled","BackgroundScriptInitialization","ContentScriptLifetime","SignInInitialized","WebSiteProvedOnce","RemoteSettingSync"]),this.requiredUnsignedInEventCategoryName=new Set(["AnnouncementShown","AnnouncementDismissed","AnnouncementClickedThrough"])}async initialize(e,t,i){if(!this._initialized){if(!this._initializing){this._initializing=!0;try{const n=await e.read(c.a.LogGroupName),r=await e.read(c.a.DefaultLoggingLevel),o=await e.read(c.a.AppId),s=await e.read(c.a.ClientId);this._configurationId=await e.read(c.a.ConfigurationId),this._defaultEventName=await e.read(c.a.DefaultEventName),this._loggingLevel=r,this._appId=o,this._clientId=s,this._sessionContext=t,this._enableOptionalDiagnostic=await e.read(c.a.EnableTelemetry),i&&i.on("enableTelemetry",async()=>{this._enableOptionalDiagnostic=await e.read(c.a.EnableTelemetry)}),this._internalLogger=new a.g({logGroupName:n,tenant:{tenantName:"NaturalLanguage",ariaTenantToken:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",nexusTenantToken:1733},defaultEventName:"",logToConsole:!1,logToKusto:!0},this._telemetrySink)}finally{this._initializing=!1}}this._initialized=!0}}logEvent(e,t,i,n,r,a,o){if(this._initialized&&this._defaultEventName){let s=this._defaultEventName;t&&(s=t),this.sendLog(s,e,i,n,r,a,o)}}getNewActivity(e,t,i){if(!this._initialized)return;if(!this._enableOptionalDiagnostic&&!this.requiredDiagnosticEventCategoryName.has(e))return;const r=this._internalLogger.createActivity(e);let o=!0;if(this._userInfoStrategy.execute(!1,e=>(e?(e.userId&&r.addDataField({name:"User_Id",value:e.userId,dataType:a.d.String,classification:a.c.SystemMetadata}),e.tenantId&&r.addDataField({name:"Tenant_Id",value:e.tenantId,dataType:a.d.String,classification:a.c.SystemMetadata}),r.addDataField({name:"Identity_Provider",value:JSON.stringify(e.identityProvider),dataType:a.d.String,classification:a.c.SystemMetadata}),e.licenseType&&r.addDataField({name:"License_Type",value:e.licenseType,dataType:a.d.String,classification:a.c.SystemMetadata})):o=!1,e)),!o&&!this.requiredDiagnosticEventCategoryName.has(e)&&!this.requiredUnsignedInEventCategoryName.has(e))return;const s={dataCategories:a.b.ProductServiceUsage};if(this.requiredDiagnosticEventCategoryName.has(e)||this.requiredUnsignedInEventCategoryName.has(e)?s.diagnosticLevel=a.e.BasicEvent:s.diagnosticLevel=a.e.FullEvent,r.setEventFlags(s),this._sessionContext&&(r.addDataField({name:"Browser_Type",value:this._sessionContext.browserType,dataType:a.d.String,classification:a.c.SystemMetadata}),r.addDataField({name:"Browser_Version",value:this._sessionContext.browserVersion||"",dataType:a.d.String,classification:a.c.SystemMetadata}),r.addDataField({name:"Store_Runtime_Id",value:this._sessionContext.extensionStoreId||"",dataType:a.d.String,classification:a.c.SystemMetadata}),r.addDataField({name:"Extension_Version",value:this._sessionContext.extensionVersion||"",dataType:a.d.String,classification:a.c.SystemMetadata}),r.addDataField({name:"Extension_Version_Name",value:this._sessionContext.extensionVersionName||"",dataType:a.d.String,classification:a.c.SystemMetadata})),r.addDataField({name:"App_Id",value:this._appId,dataType:a.d.String,classification:a.c.SystemMetadata}),r.addDataField({name:"Client_Id",value:this._clientId,dataType:a.d.String,classification:a.c.SystemMetadata}),r.addDataField({name:"CorrelationID",value:this._sessionCorrelationId?this._sessionCorrelationId:"",dataType:a.d.String,classification:a.c.SystemMetadata}),r.addDataField({name:"ConfigurationId",value:this._configurationId,dataType:a.d.String,classification:a.c.SystemMetadata}),i){const t=n.createFunnelContract(e,i);r.addDataFields(t)}return r}addCorrelationID(e){this._sessionCorrelationId=e}static createFunnelContract(e,t){const i=a.f[t];return a.a.Office.System.Funnel.getFields(e,{name:e,state:i})}sendLog(e,t,i,r,o,s,c){if(!this._initialized||void 0===this._loggingLevel)return;if(i>this._loggingLevel)return;let l=[];this.serviceRequestId&&l.push({name:"Service_Request_Id",value:this.serviceRequestId,dataType:a.d.Guid,classification:a.c.SystemMetadata}),this._sessionContext&&(l.push({name:"Browser_Type",value:this._sessionContext.browserType,dataType:a.d.String,classification:a.c.SystemMetadata}),l.push({name:"Browser_Version",value:this._sessionContext.browserVersion||"",dataType:a.d.String,classification:a.c.SystemMetadata}),l.push({name:"Store_Runtime_Id",value:this._sessionContext.extensionStoreId||"",dataType:a.d.String,classification:a.c.SystemMetadata}),l.push({name:"Extension_Version",value:this._sessionContext.extensionVersion||"",dataType:a.d.String,classification:a.c.SystemMetadata}),l.push({name:"Extension_Version_Name",value:this._sessionContext.extensionVersionName||"",dataType:a.d.String,classification:a.c.SystemMetadata}));let u="",d="",h="";if(this._userInfoStrategy.execute(!1,e=>(e&&(e.userId&&(u=e.userId),e.tenantId&&(d=e.tenantId),e.identityProvider&&(h=e.identityProvider.toString())),e)),l=l.concat([{name:"Tag",value:t.toString(),dataType:a.d.String,classification:a.c.SystemMetadata},{name:"Tag_Hex",value:t.toString(16),dataType:a.d.String,classification:a.c.SystemMetadata},{name:"Level",value:a.h[i],dataType:a.d.String,classification:a.c.SystemMetadata},{name:"App_Id",value:this._appId,dataType:a.d.String,classification:a.c.SystemMetadata},{name:"Client_Id",value:this._clientId,dataType:a.d.String,classification:a.c.SystemMetadata},{name:"User_Id",value:u,dataType:a.d.String,classification:a.c.EndUserIdentifiableInformation},{name:"Tenant_Id",value:d,dataType:a.d.String,classification:a.c.EndUserIdentifiableInformation},{name:"Identity_Provider",value:h,dataType:a.d.String,classification:a.c.SystemMetadata}]),r&&l.push({name:"Message",value:r,dataType:a.d.String,classification:a.c.SystemMetadata}),this._sessionCorrelationId&&l.push({name:"Correlation_Id",value:this._sessionCorrelationId,dataType:a.d.String,classification:a.c.SystemMetadata}),s&&l.push({name:"Data",value:JSON.stringify(s),dataType:a.d.String,classification:a.c.SystemMetadata}),c){n.createFunnelContract(e,c).forEach(e=>l.push(e))}this._internalLogger.logStandaloneMetric(e,o,a.e.FullEvent,a.b.NotSet,l)}};l=n=Object(r.a)([Object(o.injectable)(),Object(r.b)(0,Object(o.inject)(s.a.IUserInfoStrategy)),Object(r.b)(1,Object(o.inject)(s.a.TelemetrySink))],l)},11870:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(3108),r=i(2037);let a=class{getUrl(e){return e}};a=Object(n.a)([Object(r.injectable)()],a)},11871:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(3108),r=i(2037);let a=class{getUILanguage(){return navigator.language}async getBrowserLanguages(){return Promise.resolve([navigator.language])}};a=Object(n.a)([Object(r.injectable)()],a)},11886:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Extension=0]="Extension",e[e.OWA_New_Email=1]="OWA_New_Email",e[e.OWA_Draft_Email=2]="OWA_Draft_Email"}(n||(n={}))},11887:function(e){e.exports=JSON.parse('{"d":"Rjc","e":"Sjc","a":"Tjc","b":"Ujc","c":"Vjc"}')},12133:function(e,t,i){"use strict";i.r(t);var n={};i.r(n),i.d(n,"Descriptor",(function(){return Hn})),i.d(n,"LookupWords",(function(){return Gn})),i.d(n,"LookupInput",(function(){return Vn})),i.d(n,"Synonym",(function(){return zn})),i.d(n,"Meaning",(function(){return $n})),i.d(n,"LookupResult",(function(){return Jn})),i.d(n,"LookupOutput",(function(){return Kn})),i.d(n,"CommonAppIdProperty",(function(){return Xn})),i.d(n,"CommonLanguageIdProperty",(function(){return Yn})),i.d(n,"CommonAppVersionProperty",(function(){return Zn})),i.d(n,"CommonDescriptorsProperty",(function(){return Qn})),i.d(n,"PostCheckHeaders",(function(){return er}));var r=i(1),a=i(2),o=Object(a.action)("premiumPreviewActions",(function(e,t,i,n,r){return{viewState:e,premiumPreviewType:t,numerOfDaysLeft:i,shouldUpdateOptionSettings:n,premiumSuggestionsCount:r}})),s=i(3275),c=i(4450),l=i(94);var u=Object(a.mutatorAction)("onUpdatePremiunSuggestionsDaysLeft",(function(e,t,i,n,r){e.premiumPreviewData.numberOfDaysLeftToUsePremiunSuggestions=t,e.premiumPreviewData.premiumPreviewStatus=i,e.premiumPreviewData.premiumPreviewType=n,e.premiumPreviewData.premiumSuggestionsCount=r})),d=i(4004);Object(a.orchestrator)(o,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(i){switch(i.label){case 0:return e.shouldUpdateOptionSettings?e.premiumPreviewType!==s.b.TimeBased?[3,2]:[4,d.g.importAndExecute(e.numerOfDaysLeft)]:[3,5];case 1:i.sent(),i.label=2;case 2:return e.premiumPreviewType!==s.b.CountBased?[3,4]:[4,d.h.importAndExecute("premiumSuggestionsCount",e.premiumSuggestionsCount)];case 3:i.sent(),i.label=4;case 4:return t=s.a.Activated,[3,6];case 5:t=function(e,t,i){switch(e){case s.b.TimeBased:return i===c.b?s.a.New:i>0?s.a.Activated:s.a.Expired;case s.b.CountBased:return t===c.g?s.a.Expired:t>c.h?s.a.Activated:s.a.New;case s.b.TimeAndCountCombined:case s.b.None:case s.b.BasicSkittle:return s.a.Unknown;default:return Object(l.a)(e)}}(e.premiumPreviewType,e.premiumSuggestionsCount,e.numerOfDaysLeft),i.label=6;case 6:return u(e.viewState,e.numerOfDaysLeft,t,e.premiumPreviewType,e.premiumSuggestionsCount),[2]}}))}))}));var h=i(5587),g=i(16395),f=i(6),p=i(5685);var m=i(10036),b=i(11815),y=i(10037),v=i(11834),_=i(24),I="spelling",S="grammar",C="refinements";function E(e){switch(e){case b.b.Low:return C;case b.b.Medium:return S;case b.b.High:return I}return"callout_unknown"}var T=i(121),O=i(203),w=i(0),j=i(20),P=i(424),x=i(1115),D=i(60),N=i(1872),A=i(733),R=i(1261),k=i(700),F="https://go.microsoft.com/fwlink/?linkid=2146723",L="https://go.microsoft.com/fwlink/?linkid=2146721",M="https://go.microsoft.com/fwlink/?linkid=2146728",q="https://go.microsoft.com/fwlink/?linkid=2147013",B="https://go.microsoft.com/fwlink/?linkid=2146724",U="https://go.microsoft.com/fwlink/?linkid=2147012",W="https://go.microsoft.com/fwlink/?linkid=2147014",H="https://go.microsoft.com/fwlink/?linkid=2146726",G="https://go.microsoft.com/fwlink/?linkid=2139290",V="https://go.microsoft.com/fwlink/?linkid=2145120",z="https://go.microsoft.com/fwlink/?linkid=2145204",$="https://go.microsoft.com/fwlink/?linkid=2125009",J="https://go.microsoft.com/fwlink/?linkid=2125008",K="https://go.microsoft.com/fwlink/?linkid=2146725",X="https://go.microsoft.com/fwlink/?linkid=2146722",Y="https://go.microsoft.com/fwlink/?linkid=2146729",Z="https://go.microsoft.com/fwlink/?linkid=2146727";function Q(e,t,i){var n=ee(e,t,i,void 0);window.open(n,"_blank")}function ee(e,t,i,n){switch(e){case s.b.TimeBased:switch(t){case s.a.New:switch(i){case"Callout":return F;case"ContexualCard":return q;default:Object(l.a)(i)}break;case s.a.Activated:switch(i){case"Callout":return L;case"ContexualCard":return q;default:Object(l.a)(i)}break;case s.a.Expired:switch(i){case"Callout":return M;case"ContexualCard":return q;default:Object(l.a)(i)}break;case s.a.Unknown:break;default:Object(l.a)(t)}break;case s.b.CountBased:switch(t){case s.a.New:switch(i){case"Callout":return B;case"ContexualCard":return H;default:Object(l.a)(i)}break;case s.a.Activated:switch(i){case"Callout":return U;case"ContexualCard":return H;default:Object(l.a)(i)}break;case s.a.Expired:switch(i){case"Callout":return W;case"ContexualCard":return H;default:Object(l.a)(i)}break;case s.a.Unknown:break;default:Object(l.a)(t)}break;case s.b.TimeAndCountCombined:switch(t){case s.a.New:switch(i){case"Callout":return K;case"ContexualCard":return Z;default:Object(l.a)(i)}break;case s.a.Activated:switch(i){case"Callout":return X;case"ContexualCard":return Z;default:Object(l.a)(i)}break;case s.a.Expired:switch(i){case"Callout":return Y;case"ContexualCard":return Z;default:Object(l.a)(i)}break;case s.a.Unknown:break;default:Object(l.a)(t)}break;case s.b.BasicSkittle:switch(i){case"Callout":return G;case"ContexualCard":return n?V:z;default:Object(l.a)(i)}break;case s.b.None:switch(i){case"Callout":return"";case"ContexualCard":return n?$:J;default:Object(l.a)(i)}break;default:Object(l.a)(e)}return""}var te="EditorProofing_UpsellClicked",ie="ContextualUpsell_SkittleOpenUpsellCallout",ne="PremiumPreview_SkittleOpenOpt-inDialog",re="PremiumPreview_CCardOpenOpt-inDialog",ae="PremiumPreview_SettingsOpenOpt-in",oe="PremiumPreview_SkittleCountdownCallout",se="PremiumPreview_SkittlePreviewEndCallout",ce="PremiumPreview_SettingsCountdown",le="PremiumPreview_SettingsDialogAfter",ue="PremiumPreview_CCardCountdown",de="PremiumPreview_CCAfterPreviewEnd",he="Regular_SettingsDialog",ge="ContextualUpsell_CCard",fe="Regular_CCard";function pe(e,t,i){var n=function(e,t,i){var n="";switch(e){case"PremiumPreview":switch(t){case"settings":n=ae;break;case"skittle":n=ne;break;case"contextualCard":n=re;break;case"none":break;default:Object(l.a)(t)}break;case"Skittle":switch(i){case s.a.Activated:n=oe;break;case s.a.Expired:n=se;break;case s.a.New:break;case s.a.Unknown:n=ie;break;default:Object(l.a)(i)}break;case"ContexualCard":switch(i){case s.a.Activated:n=ue;break;case s.a.Expired:n=de;break;case s.a.New:n=ge;break;case s.a.Unknown:n=fe;break;default:Object(l.a)(i)}break;case"SettingsCompose":switch(i){case s.a.Activated:n=ce;break;case s.a.Expired:n=le;break;case s.a.New:break;case s.a.Unknown:n=he;break;default:Object(l.a)(i)}break;default:Object(l.a)(e)}return n}(e,t.premiumPreviewSource,t.premiumPreviewStatus);Object(T.s)(te,{type:i,location:n},{isCore:!0})}function me(e,t,i){var n,r,a,o=e.premiumPreviewType;switch(o){case s.b.TimeBased:a=p.s,n=1===(r=t||e.numberOfDaysLeftToUsePremiunSuggestions)?p.g:p.e;break;case s.b.CountBased:a=p.c,n=1===(r=i||e.premiumSuggestionsCount)?p.h:p.i;break;case s.b.TimeAndCountCombined:case s.b.BasicSkittle:case s.b.None:break;default:return Object(l.a)(o)}return{stringToShowInSkittle:n,numberToShow:r,stringToShowOnPremiumPreviewCallout:a}}var be="EditorProofing_ContextualCardOpenPremiumPreviewOptInDialog ",ye="EditorProofing_SettingsOpenPremiumPreviewOptInDialog ",ve="EditorProofing_PremiumPreview_Try_Skittle",_e="EditorProofing_PremiumPreview_Try_CCard",Ie="EditorProofing_PremiumPreview_Try_Settings";function Se(e,t){var i;(i=t?function(e){switch(e){case"contextualCard":return be;case"settings":return ye;case"skittle":case"none":return"";default:Object(l.a)(e)}}(e):function(e){switch(e){case"skittle":return ve;case"contextualCard":return _e;case"settings":return Ie;case"none":return"";default:Object(l.a)(e)}}(e))&&Object(T.s)(i,{},{isCore:!0})}var Ce=i(158),Ee=i.n(Ce),Te=i(6268),Oe=i(16397),we=Object(j.a)((function(e){w.useEffect((function(){Se(e.premiumPreviewData.premiumPreviewSource,!0)}),[]);var t=w.useCallback((function(){Q(e.premiumPreviewData.premiumPreviewType,e.premiumPreviewData.premiumPreviewStatus,"Callout"),pe("PremiumPreview",e.premiumPreviewData,"")}),[e.premiumPreviewData.premiumPreviewType,e.premiumPreviewData.premiumPreviewStatus,e.premiumPreviewData]),i=w.useCallback((function(){e.onTryItNowClick(c.e,c.f)}),[]),n=me(e.premiumPreviewData,c.e,c.f),r=n.stringToShowOnPremiumPreviewCallout,a=n.numberToShow,o=Object(f.c)(Object(f.b)(r),a),s={flexContainer:Te.goPremiumButoon},l=w.useCallback((function(){var t;null===(t=e.onHoverPremiumPreview)||void 0===t||t.call(e,!0)}),[e.onHoverPremiumPreview]),u=w.useCallback((function(){var t;null===(t=e.onHoverPremiumPreview)||void 0===t||t.call(e,!1)}),[e.onHoverPremiumPreview]),d="skittle"!==e.premiumPreviewData.premiumPreviewSource,h=d?Te.editorPremPrevImageDialog:Te.editorPremPrevImage;return w.createElement("div",{className:Te.premPrevSkittleContainer,"aria-label":p.t,onMouseLeave:u,onMouseEnter:l},w.createElement("div",{className:Ee()(Te.innerContainerPP,!d&&Te.calloutPP)},w.createElement("div",{className:h},w.createElement("img",{src:Oe,className:Te.editorSVG})),w.createElement("span",{className:Te.premPrevTitle},Object(f.b)(p.t)),w.createElement("span",{className:Te.editorPremPrevText},o),!d&&w.createElement("div",{className:Te.premPrevbuttonsContainer,"aria-label":o},w.createElement(R.a,{onClick:i,text:Object(f.b)(p.u),className:Ee()(Te.tryItNowButoon,Te.goPremiumButoon)}),w.createElement(k.a,{onClick:t,styles:s,text:Object(f.b)(p.v),className:Te.goPremiumButoon},w.createElement(P.a,{iconName:"Diamond",className:Te.premiumPreviewDiamonIcon})))))})),je=i(6268),Pe={flexContainer:je.goPremiumButoon},xe=Object(j.a)((function(e){var t=w.useCallback((function(){Q(e.premiumPreviewData.premiumPreviewType,e.premiumPreviewData.premiumPreviewStatus,"Callout"),pe("PremiumPreview",e.premiumPreviewData,"")}),[e.premiumPreviewData.premiumPreviewType,e.premiumPreviewData.premiumPreviewStatus,e.premiumPreviewData]),i=w.useCallback((function(){e.onTryItNowClick(c.e,c.f)}),[]),n=me(e.premiumPreviewData,c.e,c.f),r=n.stringToShowOnPremiumPreviewCallout,a=n.numberToShow,o=Object(f.c)(Object(f.b)(r),a);return w.createElement(N.a,{onDismiss:e.onDismiss,forceFocusInsideTrap:!0,hidden:!1,dialogContentProps:{type:A.a.normal,showCloseButton:!0},containerClassName:je.confirmation,firstFocusableSelector:je.goPremiumButoon,modalProps:{isBlocking:!0,className:je.dialogBox}},w.createElement("div",null,w.createElement(we,{onTryItNowClick:e.onTryItNowClick,premiumPreviewData:e.premiumPreviewData,onHoverPremiumPreview:null}),w.createElement("div",{className:je.premPrevbuttonsContainer,"aria-label":o},w.createElement(R.a,{onClick:i,text:Object(f.b)(p.u),className:Ee()(je.tryItNowButoon,je.goPremiumButoon)}),w.createElement(k.a,{onClick:t,styles:Pe,text:Object(f.b)(p.v),className:je.goPremiumButoon},w.createElement(P.a,{iconName:"Diamond",className:je.premiumPreviewDiamonIcon})))))})),De="EditorProofing_SkittleOpenUpsellCallout",Ne="EditorProofing_PremiumPreview_CountdownCalloutOpen",Ae="EditorProofing_PremiumPreview_EndCalloutOpen",Re="EditorProofing_SkittleOpenPremiumPreviewOptInDialog";var ke=i(1545);var Fe,Le,Me,qe=Object(a.mutatorAction)("onHideSkittle",(function(e){e.skittleViewStatus="Hide"})),Be=Object(a.mutatorAction)("onShowSkittle",(function(e){e.skittleViewStatus="Show"})),Ue=Object(a.mutatorAction)("onSkittleUpdate",(function(e,t,i){e.premimumFlagsFound=t,e.premiumCategories=i})),We=Object(a.mutatorAction)("onUpdateSkittleCallout",(function(e,t){e.skittleCalloutStatus=t})),He=Object(a.mutatorAction)("onUpdateSkittleCallout",(function(e,t){e.premiumPreviewData.premiumPreviewSource=t})),Ge=Object(a.mutatorAction)("onProofingDisable",(function(e){e.isProofingDisabled=!0})),Ve=i(6268),ze=Object(j.a)((function(e){var t=e.premimumFlagsFound,i=e.premiumCategories;if(t>0){var n=1===t?p.m:p.l,r=Object(f.c)(Object(f.b)(n),i);return w.createElement("div",{className:Ve.skittleCalloutTextContainer},w.createElement("span",null,Object(f.b)(p.k)),w.createElement("span",{className:Ve.premimumFlagsFound}," ",t," "),w.createElement("span",null,r))}return w.createElement("div",{className:Ve.skittleCalloutTextContainer},w.createElement("div",null,Object(f.b)(p.q)))})),$e=i(6268),Je=Object(j.a)((function(e){var t=me(e.premiumPreviewData,null,null),i=t.stringToShowInSkittle,n=t.numberToShow;return w.createElement("div",{className:$e.skittleCalloutTextContainer},w.createElement("span",{className:$e.premimumFlagsFound},n),w.createElement("span",{className:$e.premimumpreviewDaysText},Object(f.b)(i)))})),Ke=i(6268),Xe=Object(j.a)((function(e){var t=e.premimumFlagsFound,i=e.premiumCategories,n=e.premiumPreviewData,r=e.upsellClicked,a=n.premiumPreviewStatus;return a===s.a.Activated?w.createElement(Je,{premiumPreviewData:n}):a===s.a.Expired?w.createElement("div",{className:Ke.skittleCalloutTextContainer},w.createElement("div",null,Object(f.b)(p.f))):w.createElement(ze,{premimumFlagsFound:t,premiumCategories:i,upsellClicked:r})})),Ye=i(1286),Ze=i(6268),Qe=i(16398),et=Object(j.a)((function(e){var t=w.useCallback((function(){Q(r.premiumPreviewType,r.premiumPreviewStatus,"Callout"),pe("Skittle",r,"")}),[]),i=e.premimumFlagsFound,n=e.premiumCategories,r=e.premiumPreviewData,a=r.premiumPreviewStatus,o=r.premiumPreviewType,c=a===s.a.Activated?p.d:p.r;return w.createElement("div",{className:Ze.skittleCalloutContainer},w.createElement("div",{className:Ze.skittleCountContainer},w.createElement("div",{className:Ze.editorImage},w.createElement("img",{src:Qe,className:Ze.editorSVG})),w.createElement("div",{className:Ze.calloutTextContainer},w.createElement("span",{className:Ze.calloutTitle}," ",Object(f.b)(c)," "),w.createElement(Xe,{premimumFlagsFound:i,premiumCategories:n,premiumPreviewData:r,upsellClicked:t}))),w.createElement("div",{className:Ze.linkContainer},w.createElement("div",{className:Ze.linkInnerContainer},o!==s.b.BasicSkittle&&w.createElement("span",{className:Ze.goPremiumText},Object(f.b)(p.j)),w.createElement(Ye.a,{href:"javascript:void(0);",className:Ze.goPremiumLink,onClick:t},Object(f.b)(p.v)))))})),tt=(i(8330),i(8331)),it=i(11829),nt=i(11830);!function(e){e[e.OutlineNode=0]="OutlineNode",e[e.TerminalNode=1]="TerminalNode",e[e.TileNode=2]="TileNode",e[e.ParagraphNode=3]="ParagraphNode"}(Fe||(Fe={})),function(e){e.DefaultOutlineNodeObserver="DefaultOutlineNodeObserver",e.TerminalNodeObserver="TerminalNodeObserver",e.InputNodeObserver="InputNodeObserver",e.AttributeObserver="AttributeObserver"}(Le||(Le={})),function(e){e.SelectorDomFinder="SelectorDomFinder",e.TextDomFinder="TextDomFinder"}(Me||(Me={}));var rt=i(11872),at=i(6270),ot=i(8332),st=i(6707),ct=i(2936),lt=i(11841);class ut{constructor(e,t,i,n,r){this.initialize=()=>{if(this._sessionPromise)this._logger.info(588862478,"Skipping augloop initialization because another one is in progress");else if(this._alRuntimePromise)try{this._sessionPromise=this._alRuntimePromise.then(async e=>e.createSession({docSessionId:void 0!==this._sessionId?this._sessionId.toString():(new lt.a).generate()})),this._sessionPromise.catch(e=>{this._logger.error(588862480,`Failed to create AugLoop session: ${e}`)}),this._submitDocumentTile(),this._sessionPromise.then(e=>{e.activateAnnotation(st.Critique.getTypeName(),{callback:this._onAnnotationResult}),e.setReconnectCallback(()=>{this._hostEmitter.emit(ot.a.hostModelRehydrateTiles,{address:this._sessionId,message:[]})})})}catch(e){this._logger.error(588862481,`Failed to create AugLoop session: ${e}`)}else this._logger.error(588862479,"Failed to initialize augloop, there is no runtime")},this.submitTileAdd=(e,t,i)=>{this._submitOperation(new ct.AddOperation({parentPath:["session","doc"],items:[{id:e,revId:`${i}`,body:t}]}))},this.submitTileDelete=e=>{this._submitOperation(new ct.DeleteOperation({parentPath:["session","doc"],items:[{id:e}]}))},this.submitTileUpdate=(e,t,i)=>{this._submitOperation(new ct.UpdateOperation({parentPath:["session","doc"],items:[{id:e,revId:`${i}`,body:t}]}))},this.submitDelta=(e,t,i)=>{this._submitOperation(new ct.DeltaUpdateOperation({parentPath:["session","doc",e],items:[{id:e,revId:`${i}`,body:t}]}))},this.getSessionId=()=>this._sessionId,this._onAnnotationResult=e=>{if(e&&e.items&&e.items.length>0){let t;const i=ct.SchemaObject.getTypeNameFor(e);switch(i){case ct.AddOperation.getTypeName():t=nt.a.NewData;break;case ct.UpdateOperation.getTypeName():t=nt.a.ChangeData;break;case ct.DeleteOperation.getTypeName():t=nt.a.RemoveData;break;default:return void this._logger.error(588862482,`Unexpected annotation operation: ${i}`)}for(const i of e.items)this._hostEmitter.emit(ot.a.hostModelCritique,{address:this._sessionId,message:{messageType:t,data:{tileId:e.parentPath.length>0?e.parentPath[e.parentPath.length-1]:"",tileVersion:Number.parseInt(e.parentRevId||"0",10),annotationId:i.id,critique:i.body}}})}},this._submitDocumentTile=()=>{const e={id:"doc",body:new ct.Document({isReadonly:!1})},t=new ct.AddOperation({parentPath:["session"],items:[e]});this._sessionPromise&&this._sessionPromise.then(e=>{e.submitSeedOperations([t])})},this._submitOperation=e=>{this._sessionPromise&&this._sessionPromise.then(t=>{t.submitOperations([e])})},this._sessionId=e,this._hostEmitter=t,this._logger=i,n&&(this._sessionPromise=Promise.resolve(n),n.activateAnnotation(st.Critique.getTypeName(),{callback:this._onAnnotationResult}),n.setReconnectCallback(()=>{this._hostEmitter.emit(ot.a.hostModelRehydrateTiles,{address:this._sessionId,message:[]})})),this._alRuntimePromise=r}}class dt{constructor(e,t,i){this._tiles=new Map,this._critiquesPerNode=new Map,this.initialize=()=>{},this.submitTileAdd=(e,t,i)=>{if(this._tiles.set(e,t.content),t.content){const n=t.content.indexOf("spell");-1!==n&&this._emitCritique(e,t.content,n,"spell".length,i)}},this.submitTileDelete=e=>{this._tiles.delete(e),this._deleteCritiques(e)},this.submitTileUpdate=(e,t)=>{this._tiles.set(e,t.content)},this.submitDelta=(e,t,i)=>{let n=this._tiles.get(e);if(void 0!==n){switch(t.deltaType){case st.TextTileDeltaType.Add:t.position<n.length?n=`${n.slice(0,t.position)}${t.content}${n.slice(t.position,n.length)}`:n+=t.content;break;case st.TextTileDeltaType.Update:n=`${n.slice(0,t.position)}${t.content}${n.slice(t.position+(t.length||0),n.length)}`;break;case st.TextTileDeltaType.Delete:n=`${n.slice(0,t.position)}${n.slice(t.position+(t.length||0),n.length)}`}if(this._tiles.set(e,n),0===n.length&&this._deleteCritiques(e),t.unit===st.TextTileDeltaUnit.Word||t.unit===st.TextTileDeltaUnit.Sentence){let t=n.indexOf("spell");for(;-1!==t;)this._emitCritique(e,n,t,"spell".length,i),t=n.indexOf("spell",t+"spell".length)}}},this.getSessionId=()=>this._sessionId,this._deleteCritiques=e=>{const t=this._critiquesPerNode.get(e);if(void 0!==t){for(const i of t)setTimeout(()=>{this._hostEmitter.emit(ot.a.hostModelCritique,{address:this._sessionId,message:{messageType:nt.a.RemoveData,data:{annotationId:"A1",tileId:e,critique:i,tileVersion:0}}})},dt._emitterDelayMs*Math.random());this._critiquesPerNode.delete(e)}},this._emitCritique=(e,t,i,n,r)=>{let a=this._critiquesPerNode.get(e);void 0===a&&(a=[]);const o=new st.Critique({priority:st.Priority.High,id:this._guidGenerator.generate(),context:t,startInContext:0,categoryName:"Spelling",language:"en-US",explanationTitle:"Spelling Mistake",explanationBody:"Stop making spelling mistakes.",bucketId:42,suggestions:[{text:"spell-better",description:"Spell better 1",suggestionActions:st.SuggestionAction.ChangeOnce},{text:"spell-much-better",description:"Spell better 2",suggestionActions:st.SuggestionAction.ChangeOnce},{text:"spel",description:"Spell better 3",suggestionActions:st.SuggestionAction.ChangeOnce}],range:{start:i,length:n}});a.push(o),this._critiquesPerNode.set(e,a),setTimeout(()=>{this._hostEmitter.emit(ot.a.hostModelCritique,{address:this._sessionId,message:{messageType:nt.a.NewData,data:{annotationId:"A1",tileId:e,tileVersion:r,critique:o}}})},dt._emitterDelayMs*Math.random())},this._sessionId=e,this._hostEmitter=t,this._guidGenerator=i}}dt._emitterDelayMs=2e3;class ht{constructor(e,t,i,n,r,a,o){this._hostEmitter=e,this._hostSettings=t,this._guidGenerator=i,this._descriptorManager=n,this._logger=r,this._e2eMetric=a,this._alSession=o,this._sessions=new Map,this._listenersInitialized=!1,this.initialize=()=>{if(this._hostSettings.enableOrchestration&&(this._logger.log(570782413,at.a.Info,"Initializing Orchestrator."),this._hostEmitter.on(ot.a.hostModelDelta,this._handleDelta),this._hostEmitter.on(ot.a.hostModelTextTile,this._handleTile),this._hostEmitter.on(ot.a.hostModelMoveTextTile,this._handleMove),this._listenersInitialized=!0,this._hostSettings.orchestratorSettings&&this._hostSettings.orchestratorSettings.enableAugLoop&&this._hostSettings.orchestratorSettings.augLoopEndpoint&&!this._alSession)){const e={appName:"EditorSDK",appPlatform:"Online"},t={onAnnotationResult:()=>{},isFeatureEnabled:async(e,t)=>Promise.resolve(!0),onResult:()=>{},executeLocalLambda:async()=>{},areLicenseFeaturesEnabled:async()=>Promise.resolve(!1),requestAuthToken:async()=>{},sendTelemetryEvent:()=>{}},i=this._hostSettings.orchestratorSettings.augLoopEndpoint,n=Object(rt.createRuntime)();this._alRuntimePromise=this._descriptorManager.buildDescriptors().then(async r=>{const a=r.find(e=>"FlightIds"===e.name);return a&&(e.flights=a.value),n.init(i,e,t,{telemetryAggregationIntervalSec:100,initSession:!1}).then(()=>n)})}},this.shutDown=()=>{this._hostSettings.enableOrchestration&&(this._logger.log(570782414,at.a.Info,"Shutting down Orchestrator."),this._listenersInitialized?(this._hostEmitter.off(ot.a.hostModelDelta,this._handleDelta),this._hostEmitter.off(ot.a.hostModelTextTile,this._handleTile),this._hostEmitter.off(ot.a.hostModelMoveTextTile,this._handleMove),this._listenersInitialized=!1):this._logger.log(570782415,at.a.Error,"Trying to delete event listeners in Orchestrator when they have already been deleted."))},this._handleDelta=e=>{const t=this._getSession(e.address),i=e.message;i&&(this._e2eMetric.startEntry(`${i.tileId}--${i.tileVersion}`),t.submitDelta(i.tileId,i.delta,i.tileVersion))},this._handleTile=e=>{const t=this._getSession(e.address),i=e.message;if(i)switch(i.messageType){case nt.a.NewData:t.submitTileAdd(i.data.tileId,i.data.tile,i.data.tileVersion);break;case nt.a.RemoveData:t.submitTileDelete(i.data.tileId);break;case nt.a.ChangeData:t.submitTileUpdate(i.data.tileId,i.data.tile,i.data.tileVersion)}},this._handleMove=e=>{const t=this._getSession(e.address),i=e.message;t.submitTileDelete(i.oldTileId),t.submitTileAdd(i.newTileId,new st.TextTile({content:i.content}),i.tileVersion)},this._getSession=e=>{let t=this._sessions.get(e);return t||(t=this._hostSettings.orchestratorSettings&&this._hostSettings.orchestratorSettings.enableAugLoop?new ut(e,this._hostEmitter,this._logger,this._alSession,this._alRuntimePromise):new dt(e,this._hostEmitter,this._guidGenerator),t.initialize(),this._sessions.set(e,t)),t}}}var gt=i(14),ft=i(11827),pt=i(11828),mt=i(11836),bt=i(12279),yt=i(11831),vt=i(11855),_t=i(11856),It=i(11857),St=i(11858),Ct=i(11859),Et=i(11860),Tt=i(11861),Ot=i(11862),wt=i(11835),jt=i(11865),Pt=i(11866),xt=i(2147),Dt=i(11869),Nt=i(11870),At=i(11871);function Rt(e,t,i,n){var r,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,i,o):r(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o}function kt(e,t){return function(i,n){t(i,n,e)}}var Ft,Lt=i(4767),Mt=i(2037),qt=i(2734);let Bt=Ft=class{constructor(e,t){this._hostEmitters=e,this._proofingStore=t}emitTileEvent(e,t,i,n){this._hostEmitters.forEach(r=>{r.emit(ot.a.hostModelTextTile,{address:void 0,message:{messageType:n,data:{tileId:e,tileVersion:i,tile:new st.TextTile({content:t})}}})})}emitTileDiffEvent(e,t,i,n,r,a,o,s){const c=s&&s.some(e=>e.textUnit===Lt.c.TextUnit.Sentence)?st.TextTileDeltaUnit.Sentence:r?st.TextTileDeltaUnit.Word:st.TextTileDeltaUnit.Chars,l=n.firstDiffLeft,u=t.length-n.firstDiffRight,d=i.length-n.firstDiffRight,h=t.length===i.length?st.TextTileDeltaType.Update:u===l?st.TextTileDeltaType.Add:d===l?st.TextTileDeltaType.Delete:st.TextTileDeltaType.Update;let g,f;switch(h){case st.TextTileDeltaType.Update:g=u-l,f=i.substring(l,d);break;case st.TextTileDeltaType.Add:g=0,f=i.substring(l,d);break;case st.TextTileDeltaType.Delete:g=u-l,f=t.substring(l,u)}const p=this.getProofingLanguage();this._hostEmitters.forEach(t=>{t.emit(ot.a.hostModelDelta,{address:void 0,message:{tileId:e,tileVersion:a,delta:new st.TextTileDelta({deltaType:h,unit:c,position:l,length:g,content:f,wordCount:o,invalidationRanges:s?s.map(e=>({position:e.header.elementId.offset,length:e.header.elementId.span,unit:Ft._convertTextUnit(e.textUnit),languageId:p})):void 0})}})})}emitMoveTileEvent(e,t,i,n){this._hostEmitters.forEach(r=>{r.emit(ot.a.hostModelMoveTextTile,{address:void 0,message:{oldTileId:e,newTileId:t,tileVersion:n,content:i}})})}static _convertTextUnit(e){if(void 0===e)return st.TextTileDeltaUnit.Sentence;switch(e){case Lt.c.TextUnit.Word:return st.TextTileDeltaUnit.Word;case Lt.c.TextUnit.Sentence:default:return st.TextTileDeltaUnit.Sentence}}getProofingLanguage(){return new it.a(this._proofingStore.getCachedEntry(tt.a.ProofingLanguages).storeEntryValue).defaultLanguageCode}};var Ut;Bt=Ft=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.multiInject)(qt.a.IHostEmitterArray)),kt(1,Object(Mt.inject)(qt.a.IProofingPersistedStore))],Bt);let Wt=Ut=class{constructor(e,t,i,n){this._preOrderTraverser=e,this._tileNodeDictionary=t,this._paragraphNodeDictionary=i,this._shadowGraphFactory=n}get shadowGraph(){return this._shadowGraph}registerNode(e){const t=this._selectDictionary(e.nodeType);t&&(t[e.id]=e)}unregisterNode(e){const t=this._selectDictionary(e.nodeType);t&&delete t[e.id]}findNode(e){return this.ensureCanFindNode()?this._iterateGraph(e):null}findNodeAtRoots(e,t){return this._preOrderTraverser.rootAtNodes(e),this._iterateGraph(t)}findTileNode(e){return this.ensureCanFindNode()?this._tileNodeDictionary[e]:null}get tileNodes(){return Object.values(this._tileNodeDictionary)}findParagraphNode(e){return this._paragraphNodeDictionary[e]}addNode(e){if(e.parent){const t=this.findNode(e.parent.id);t&&(t.children||(t.children=[]),t.children.push(e))}else this._shadowGraph||(this._shadowGraph=this._shadowGraphFactory()),this._shadowGraph.rootNodes.push(e)}removeNode(e){if(this.findNode(e.id)){let t;e.parent?t=e.parent.children:this._shadowGraph&&(t=this._shadowGraph.rootNodes),Ut.removeElement(e,t),e.retire()}}cleanUp(){this.retireAllShadowGraphRootNodes()}_selectDictionary(e){switch(e){case Fe.TileNode:return this._tileNodeDictionary;case Fe.ParagraphNode:return this._paragraphNodeDictionary;default:return}}ensureCanFindNode(){return!!this._shadowGraph&&(this._preOrderTraverser.rootAtNodes(this._shadowGraph.rootNodes),!0)}retireAllShadowGraphRootNodes(){if(this._shadowGraph)for(const e of this._shadowGraph.rootNodes)e.retire()}_iterateGraph(e){const t=this._preOrderTraverser.getIterator();let i=t.next();for(;!i.done;){if(i.value&&i.value.id===e)return i.value;i=t.next()}return null}static removeElement(e,t){if(t){const i=t.indexOf(e);if(-1!==i)return t.splice(i,1),!0}return!1}};Wt=Ut=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IPreOrderTraverser)),kt(1,Object(Mt.inject)(qt.a.ITileNodeDictionary)),kt(2,Object(Mt.inject)(qt.a.IParagraphNodeDictionary)),kt(3,Object(Mt.inject)(qt.a.IShadowGraphFactory))],Wt);var Ht,Gt,Vt=i(4140);!function(e){e.ReconcileTileNode="ReconcileTileNode",e.WebSiteProvedOnce="WebSiteProvedOnce",e.ActionCritiqueSettingsChange="ActionCritiqueSettingsChange"}(Ht||(Ht={})),function(e){e.MutationError="MutationError",e.UpdateCritiqueException="RunTimeErrors.UpdateCritiqueException"}(Gt||(Gt={}));let zt=class{constructor(e,t,i){this._mutationObserverFactory=e,this._logger=t,this.elementTransformers=i,this.connectMutationObserver=(e,t,i)=>{this._mutationObserver=this._mutationObserverFactory(e=>{e.forEach((e,t,n)=>this.handleMutation(e,i?i(e,t,n):void 0))}),this._mutationObserver.observe(e,t)},this.flushMutationObserver=e=>{this._mutationObserver&&this._mutationObserver.takeRecords().forEach((t,i,n)=>this.handleMutation(t,e?e(t,i,n):void 0))},this.handleMutation=(e,t)=>{try{const i=this.onElementRemoved,n=this.onElementAdded,r=this.onElementChanged;switch(e.type){case"childList":if(i){Array.from(e.removedNodes).forEach(e=>{i(e,t)})}if(n){Array.from(e.addedNodes).forEach(e=>{n(e,t)})}break;case"characterData":r&&r(e.target);break;case"attributes":this.handleAttributeChange(e,n,r,i)}}catch(e){this._logger.logEvent(591681236,Gt.MutationError,at.a.Error,"Error while processing a mutation.",Vt.i.CriticalBusinessImpact)}}}handleAttributeChange(e,t,i,n,r){const a=e.attributeName,o=e.target;this.elementTransformers&&a&&this.elementTransformers.forEach(e=>{e.attributeList.includes(a)&&e.transform(o)}),i&&i(o,r)}disconnect(){this._mutationObserver&&(this._mutationObserver.takeRecords(),this._mutationObserver.disconnect())}};zt=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IMutationObserverFactory)),kt(1,Object(Mt.inject)(qt.a.ILogger))],zt);let $t=class extends zt{constructor(e,t){super(e,t),this.mutationObserverFactory=e,this.logger=t}observe(e){this.connectMutationObserver(e,{attributes:!0,attributeFilter:["style"],characterData:!1,childList:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1})}};$t=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IMutationObserverFactory)),kt(1,Object(Mt.inject)(qt.a.ILogger))],$t);let Jt=class{constructor(e,t,i,n,r,a){this._observerFactory=e,this._graphNodeFactory=t,this._graphNodeBuilderFactory=i,this._childElementsFinderFactory=n,this._logger=r,this._graphNodeBuilderNonTerminalRule=a,this.buildNode=(e,t)=>{const i=this._observerFactory(this._graphNodeBuilderNonTerminalRule.nodeMetaType.observerType,this._graphNodeBuilderNonTerminalRule.nodeMetaType),n=this._graphNodeFactory(this._graphNodeBuilderNonTerminalRule.nodeMetaType.nodeType,i,e,t),r=this._childElementsFinderFactory(this._graphNodeBuilderNonTerminalRule.nodeMetaType.elementsFinder);if(!this._graphNodeBuilderNonTerminalRule.childMetaType)return n;const a=this._graphNodeBuilderFactory(this._graphNodeBuilderNonTerminalRule.childMetaType),o=this._getElementsToBuildChildNodes(e,r,n).map(e=>a.buildNode(e,n));return n.children=o,i.onElementAdded=e=>{const t=this._getElementsToBuildChildNodes(e,r,n);n.children=n.children||[],n.children.push(...t.filter(e=>!n.children||!n.children.some(t=>t.element===e)).map(e=>a.buildNode(e,n))),this._logger.log(589844951,at.a.Debug,`OutlineNodeBuilder: add operation performed. There are currently ${n.children.length} nodes tracked`,{nodeId:n.id})},i.onElementChanged=this.setOnElementChangeCallback?this.setOnElementChangeCallback(i):void 0,i.onElementRemoved=e=>{const t=r.find(e);n.children=n.children||[],n.children=n.children.filter(i=>{for(const r of t){const t=i.element&&i.element===r&&e.contains(i.element);if(t)return i.retire(),this._logger.log(589844952,at.a.Debug,"OutlineNodeBuilder: Delete op performed.",{nodeId:n.id}),!t}return!0})},n},this._getElementsToBuildChildNodes=(e,t,i)=>t.find(e).filter(e=>this._graphNodeBuilderNonTerminalRule.nodeMetaType.filters.every(t=>t(e,i,this._graphNodeBuilderNonTerminalRule.nodeMetaType)))}};Jt=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.INodeObserverFactory)),kt(1,Object(Mt.inject)(qt.a.IGraphNodeFactory)),kt(3,Object(Mt.inject)(qt.a.IDomFinderFactory)),kt(4,Object(Mt.inject)(qt.a.ILogger))],Jt);class Kt{constructor(e){this.filters=e,this.attributeList=Array.from(e.keys())}shouldProofElement(e){let t=!1;return this.filters.forEach(i=>{t=t||i(e)}),!t}}var Xt;!function(e){e.CourtesyAttributes="CourtesyAttributes",e.RootContentMaxLengthInChars="RootContentMaxLengthInChars"}(Xt||(Xt={}));let Yt=class extends zt{constructor(e,t,i,n,r){super(i,n),this._persistedStore=e,this._settings=t,this.mutationObserverFactory=i,this.logger=n,this.conditionalAttributeFilter=r}observe(e){const t=this._persistedStore.getCachedEntry(Xt.CourtesyAttributes).storeEntryValue;this.connectMutationObserver(e,{attributes:!0,attributeFilter:this.conditionalAttributeFilter?[...t,...this.conditionalAttributeFilter.attributeList]:[...t],characterData:!1,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1})}handleAttributeChange(e,t,i,n){const r=e.attributeName,a=e.target,o=this.conditionalAttributeFilter&&this.conditionalAttributeFilter.shouldProofElement(a),s=a.hasAttribute(this._settings.editorSpellcheckAttribute);r&&(i&&this._persistedStore.getCachedEntry(Xt.CourtesyAttributes).storeEntryValue.includes(r)?i(a):o&&!s&&t?t(a):!o&&s&&n&&n(a))}};Yt=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IHostModelPersistedStore)),kt(1,Object(Mt.inject)(qt.a.IHostModelSettings)),kt(2,Object(Mt.inject)(qt.a.IMutationObserverFactory)),kt(3,Object(Mt.inject)(qt.a.ILogger))],Yt);let Zt=class extends zt{constructor(e,t){super(e,t),this.mutationObserverFactory=e,this.logger=t,this._onElementChangedEvent=e=>{const t=this.onElementChanged;e&&t&&this._element&&t(this._element)}}observe(e){(Object(yt.a)(e,"HTMLInputElement")||Object(yt.a)(e,"HTMLTextAreaElement")||Object(yt.a)(e,"HTMLDivElement"))&&(this._element=e,this._element.addEventListener("input",this._onElementChangedEvent,{passive:!0}),this._element.addEventListener("BX-ForceReflow",this._onElementChangedEvent,{passive:!0}),this.connectMutationObserver(this._element,{attributes:!1,characterData:!1,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1}))}disconnect(){this._element&&(this._element.removeEventListener("input",this._onElementChangedEvent),this._element.removeEventListener("BX-ForceReflow",this._onElementChangedEvent)),super.disconnect(),this._element=void 0}};Zt=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IMutationObserverFactory)),kt(1,Object(Mt.inject)(qt.a.ILogger))],Zt);let Qt=class{constructor(e,t,i,n,r,a){this._guidGenerator=e,this._observer=i,this.nodeType=t,this.id=this._guidGenerator.generate(),this.children=n,this.element=r,this.parent=a}retire(){this._observer.disconnect(),this.children&&this.children.forEach(e=>e.retire()),this.children=void 0}move(e,t){return this._observer.disconnect(),this.id=this._guidGenerator.generate(),e&&(this.element=e),t&&(this.parent=t),this}resetState(){}};Qt=Rt([kt(0,Object(Mt.inject)(qt.a.IGuidGenerator))],Qt);let ei=class extends Qt{constructor(e,t,i,n,r){super(e,Fe.OutlineNode,t,i,n,r),this._guidGenerator=e,this._observer=t,this.element&&this._observer.observe(this.element)}move(e,t){return super.move(e,t),this.element&&this._observer.observe(this.element),this}};ei=Rt([kt(0,Object(Mt.inject)(qt.a.IGuidGenerator))],ei);let ti=class{constructor(e,t,i,n){this._guidGenerator=e,this._proofingDom=t,this.nodeType=Fe.ParagraphNode,this.id=this._guidGenerator.generate(),this.children=void 0,this.element=i,this.parent=n,this._proofingDom.registerNode(this)}retire(){this.parent=void 0,this._proofingDom.unregisterNode(this)}move(e,t){return this._proofingDom.unregisterNode(this),e&&(this.element=e),t&&(this.parent=t),this.id=this._guidGenerator.generate(),this._proofingDom.registerNode(this),this}resetState(){}};var ii;ti=Rt([kt(0,Object(Mt.inject)(qt.a.IGuidGenerator)),kt(1,Object(Mt.inject)(qt.a.IProofingDom))],ti);let ni=ii=class{constructor(e,t,i,n,r,a=n.completeTileTextUnit,o=n.partialTileTextUnit){this._proofingPersistedStore=e,this._graphNodeFactory=t,this._textUnitChunker=i,this.settings=n,this.hostSettings=r,this._completeTileTextUnit=a,this._partialTileTextUnit=o}updateParagraphNodes(e,t,i,n,r,a){const o=this._updateExistingChildren(e,t,i,r);return this._addNewChildren(e,i,n,r,a,o)}_updateExistingChildren(e,t,i,n){if(e.children&&e.children.length){const r={firstDiffLeft:n.firstDiffLeft,firstDiffRight:n.firstDiffRight},a=t!==i;let o=e.children.length-1;for(;o>=0;){const s=e.children[o].element;if(s)if(s.offset<n.firstDiffLeft&&s.offset+s.span<n.firstDiffLeft||s.offset+s.span===n.firstDiffLeft&&s.validEndBoundary&&a);else if(t.length-s.offset<n.firstDiffRight)s.offset=i.length-t.length+s.offset;else{s.offset<n.firstDiffLeft&&(r.firstDiffLeft=Math.min(s.offset,r.firstDiffLeft));const i=t.length-s.offset-s.span;i<n.firstDiffRight&&(r.firstDiffRight=Math.min(i,r.firstDiffRight)),e.children.splice(o,1).forEach(e=>e.retire())}o-=1}return{offset:r.firstDiffLeft,span:i.length-r.firstDiffRight-r.firstDiffLeft,enforcedCompleteTileTextUnit:!a&&this.hostSettings.enableOptimizedCallingPattern}}}_addNewChildren(e,t,i,n,r,a){let o=this._textUnitChunker.splitInUnitsFromExtendedBoundaries(t,n,this._completeTileTextUnit,a);if(i){const e=i[Symbol.iterator]();let t=e.next();o=o.filter(i=>{for(;!t.done&&i.offset>=t.value.offset+t.value.span;)t=e.next();return!t.done&&(t.value.offset>=i.offset&&t.value.offset<i.offset+i.span||t.value.offset<=i.offset&&t.value.offset+t.value.span>=i.offset)})}const s=[],c=o.map(i=>{const n=this._graphNodeFactory(i,e);return s.push(n),this._buildTile(e,n,t,r)});return ii._mergeChildrenToTileNode(e,s),c}static _mergeChildrenToTileNode(e,t){if(t.length&&e.children&&t[0].element){const i=t[0].element.offset;if(e.children.length){let n=e.children.length-1,r=t;for(;n>=0;){const t=e.children[n].element;if(t&&i>t.offset){e.children.splice(n,0,...r),r=[];break}n-=1}r.length&&e.children.splice(0,0,...r)}else e.children=t}}_buildTile(e,t,i,n){const r=t.element?t.element.offset:0,a=t.element?t.element.span:i.length,o=this.hostSettings.enableOptimizedCallingPattern?this._partialTileTextUnit:this._completeTileTextUnit;return{header:{nodeId:e.id,seqId:n.toString(),elementId:{id:t.id,offset:r,span:a},length:i.length},data:i.slice(r,r+a),proofingLanguages:this._proofingPersistedStore.getCachedEntry(tt.a.ProofingLanguages).storeEntryValue,textUnit:t.element?!1!==t.element.validEndBoundary||this.hostSettings.enableOptimizedCallingPattern&&!0===t.element.enforcedCompleteTileTextUnit?this._completeTileTextUnit:o:void 0}}};ni=ii=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IProofingPersistedStore)),kt(1,Object(Mt.inject)(qt.a.IParagraphNodeFactory)),kt(2,Object(Mt.inject)(qt.a.ITextUnitChunker)),kt(3,Object(Mt.inject)(qt.a.IHostModelSettings)),kt(4,Object(Mt.inject)(qt.a.IHostSettings))],ni);let ri=class{constructor(e,t){this._elementsRetriever=e,this._selectorsCb=t}find(e,t){if(!e)return[];if(!this._selectorsCb().length)return[e];const i=e.parentElement?e.parentElement:e;return this._elementsRetriever.retrieveElements(i,this._selectorsCb())}};ri=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IElementsRetriever))],ri);let ai=class{constructor(){this._contexts=[]}get rootNodes(){return this._contexts}addRootNode(e){this._contexts.push(e)}};ai=Rt([Object(Mt.injectable)()],ai);let oi=class extends Qt{constructor(e,t,i,n,r){super(e,Fe.TerminalNode,i,void 0,n,r),this._guidGenerator=e,this._settings=t,this._observer=i,this.element&&this._observer.observe(this.element)}retire(){this.element&&(this.element.removeAttribute(this._settings.editorSpellcheckAttribute),this.element.removeAttribute("spellcheck")),super.retire()}move(e,t){return super.move(e,t),this.element&&this._observer.observe(this.element),this}resetState(){this.contentRoot=void 0}};var si;oi=Rt([kt(0,Object(Mt.inject)(qt.a.IGuidGenerator)),kt(1,Object(Mt.inject)(qt.a.IHostModelSettings))],oi);let ci=si=class{constructor(e,t,i,n,r,a,o,s,c,l,u,d){this._observerFactory=e,this._graphNodeFactory=t,this._paragraphNodesBuilderFactory=i,this._nodePoller=n,this._terminalNodeReader=r,this._terminalNodeWriter=a,this._tileNodeReader=o,this._settings=s,this._hostSettings=c,this._childElementsFinderFactory=l,this._graphNodeBuilderTerminalRule=u,this._logger=d,this.buildNode=(e,t)=>{const i=this._observerFactory(this._graphNodeBuilderTerminalRule.observerType,this._graphNodeBuilderTerminalRule),n=this._graphNodeFactory(Fe.TerminalNode,i,e,t),r=this._childElementsFinderFactory(this._graphNodeBuilderTerminalRule.elementsFinder),a=this._getNewTopology(n,r,n).map(e=>this._graphNodeFactory(Fe.TileNode,this._observerFactory(Le.AttributeObserver),e,n,void 0,this._paragraphNodesBuilder));return n.children=a,this._disableNativeSpellcheck(e),i.onElementAdded=e=>{n.element&&!n.element.contains(e)||(this._hostSettings.simplifiedHostModelEnabled||this._reconcileTopology(n,r),this._nodePoller.pollNodes(nt.a.NewData,n.children||[],void 0,void 0,void 0,!0))},i.onElementChanged=e=>{this._hostSettings.simplifiedHostModelEnabled||n.element&&!n.element.contains(e)&&this._reconcileTopology(n,r),this._nodePoller.pollNodes(nt.a.ChangeData,this._getChildrenToReconcile(n,e))},i.onElementRemoved=(e,t)=>{!this._hostSettings.simplifiedHostModelEnabled&&n.element&&n.children&&!n.element.contains(e)&&n.children.forEach(i=>{if(i.element&&e.contains(i.element)&&t&&t.addedNodes.length===t.removedNodes.length)for(let n=0;n<t.removedNodes.length;n+=1){const r=t.addedNodes[n];t.removedNodes[n]===e&&Object(yt.a)(r,"HTMLElement")&&i.move(r)}}),this._hostSettings.simplifiedHostModelEnabled||this._reconcileTopology(n,r),this._nodePoller.pollNodes(nt.a.ChangeData,n.children||[])},this._nodePoller.pollNodes(nt.a.NewData,n.children),n},this._getNewTopology=(e,t,i)=>{if(e.element){if(this._hostSettings.simplifiedHostModelEnabled)return this._terminalNodeWriter.setContentRoot(e,e.element),this._disableNativeSpellcheck(e.element),t.find(e.element,this._graphNodeBuilderTerminalRule.filterSelector).filter(e=>this._graphNodeBuilderTerminalRule.filters.every(t=>t(e,i,this._graphNodeBuilderTerminalRule)));const n=si._findContentRoot(e.element,e.element.innerText);return this._prevContentRoot=this._terminalNodeReader.contentRoot(e),this._terminalNodeWriter.setContentRoot(e,n),n===this._prevContentRoot&&(this._prevContentRoot=void 0),this._disableNativeSpellcheck(e.element),t.find(n,this._graphNodeBuilderTerminalRule.filterSelector).filter(e=>this._graphNodeBuilderTerminalRule.filters.every(t=>t(e,i,this._graphNodeBuilderTerminalRule)))}return[]},this._paragraphNodesBuilder=this._paragraphNodesBuilderFactory(this._graphNodeBuilderTerminalRule.completeTileTextUnit,this._graphNodeBuilderTerminalRule.partialTileTextUnit)}_reconcileTopology(e,t){const i=this._getNewTopology(e,t,e);return e.children=e.children||[],e.children=e.children.filter(t=>{for(const e of i)if(t.element===e){if(!this._prevContentRoot||t.element!==this._prevContentRoot)return!0;this._prevContentRoot=void 0}return t.retire(),this._logger.log(591661202,at.a.Debug,"TerminalNodeBuilder: Delete op performed.",{nodeId:e.id}),!1}),this._logger.debug(591661203,`(TerminalNodeBuilder) Topology reconciled -> ${e.id}: ${e.children.length}`),this._addChildren(e,i)}_addChildren(e,t){e.children=e.children||[];const i=t.filter(t=>!e.children||!e.children.some(i=>(i.element&&this._disableNativeSpellcheck(i.element),!!i.element&&(i.element!==this._terminalNodeReader.contentRoot(e)&&i.element.contains(t)||i.element===t)))).map(t=>this._graphNodeFactory(Fe.TileNode,this._observerFactory(Le.AttributeObserver),t,e,void 0,this._paragraphNodesBuilderFactory(this._graphNodeBuilderTerminalRule.completeTileTextUnit,this._graphNodeBuilderTerminalRule.partialTileTextUnit)));return e.children.push(...i),this._logger.log(591661204,at.a.Debug,`TerminalNodeBuilder: add operation performed. There are currently ${e.children.length} nodes tracked`,{nodeId:e.id}),i}_disableNativeSpellcheck(e){if(e.spellcheck){const t=e.closest("[contenteditable=true]");t?t.setAttribute("spellcheck","false"):t&&"true"!==e.getAttribute("spellcheck")||(e.setAttribute("spellcheck","false"),e.spellcheck=!1),(t||e).setAttribute(this._settings.editorSpellcheckAttribute,"true")}else if(this._graphNodeBuilderTerminalRule.spellcheckOverrides&&this._graphNodeBuilderTerminalRule.spellcheckOverrides.some(t=>t(e))){(e.closest("[contenteditable=true]")||e).setAttribute(this._settings.editorSpellcheckAttribute,"true")}}_getChildrenToReconcile(e,t){return e.children?this._settings.narrowOnChangeReconciliation?[...(e.children||[]).filter(e=>e.element&&e.element.contains(t))]:[...(e.children||[]).filter(e=>e.element&&e.element.contains(t)||this._tileNodeReader.critiques(e).length)]:[]}static _findContentRoot(e,t){let i=e,n=e;for(;n;)Object(yt.a)(n,"HTMLElement")&&n.innerText===t?(Object(yt.a)(n,"HTMLElement")&&(i=n),n=n.firstChild):n=n.nextSibling;return i}};ci=si=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.INodeObserverFactory)),kt(1,Object(Mt.inject)(qt.a.IGraphNodeFactory)),kt(2,Object(Mt.inject)(qt.a.IParagraphNodesBuilderFactory)),kt(3,Object(Mt.inject)(qt.a.INodePoller)),kt(4,Object(Mt.inject)(qt.a.ITerminalNodeReader)),kt(5,Object(Mt.inject)(qt.a.ITerminalNodeWriter)),kt(6,Object(Mt.inject)(qt.a.ITileNodeReader)),kt(7,Object(Mt.inject)(qt.a.IHostModelSettings)),kt(8,Object(Mt.inject)(qt.a.IHostSettings)),kt(9,Object(Mt.inject)(qt.a.IDomFinderFactory))],ci);let li=class extends zt{constructor(e,t,i,n,r){super(e,i,r),this.mutationObserverFactory=e,this._hostSettings=t,this._logger=i,this._mutationContextBuilder=n,this.elementTransformers=r,this.connectMutationObserver=(e,t,i)=>{this._mutationObserver=this._mutationObserverFactory(e=>{let t=!1,n=!1;e.forEach((e,r,a)=>{try{const o=this.onElementRemoved,s=this.onElementAdded,c=this.onElementChanged;switch(e.type){case"childList":if(o){const t=Array.from(e.removedNodes);t.length&&!n&&(this._hostSettings.simplifiedHostModelEnabled?o(t.pop(),void 0):t.forEach(t=>{o(t,i?i(e,r,a):void 0)}),n=!0)}if(s){const n=Array.from(e.addedNodes);n.length&&!t&&(s(n.pop(),i?i(e,r,a):void 0),t=!0)}break;case"characterData":c&&c(e.target);break;case"attributes":this.handleAttributeChange(e,s,c,o)}}catch(e){this._logger.logEvent(591681235,Gt.MutationError,at.a.Error,"Error while processing a mutation.",Vt.i.CriticalBusinessImpact)}})}),this._mutationObserver.observe(e,t)}}observe(e){const t={attributes:!1,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1};if(this.elementTransformers){const e=new Set;for(const t of this.elementTransformers)t.attributeList.forEach(t=>{e.add(t)});e.size&&(t.attributes=!0,t.attributeFilter=Array.from(e.values()))}this.connectMutationObserver(e,t,this._mutationContextBuilder)}};li=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IMutationObserverFactory)),kt(1,Object(Mt.inject)(qt.a.IHostSettings)),kt(2,Object(Mt.inject)(qt.a.ILogger))],li);var ui,di=i(4738);let hi=ui=class{constructor(e){this._textUnitChunker=e}find(e,t){if(Object(yt.a)(e,"Text")&&e.parentElement)return[e.parentElement];const i=di.a.extractTextContent(e,t),n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:e=>t&&e.parentElement&&e.parentElement.closest(t)?NodeFilter.FILTER_REJECT:e.length?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT});let r=[];i.forEach((e,t)=>{e&&(r=this._textUnitChunker.splitInUnitsFromExtendedBoundaries(e,{firstDiffLeft:0,firstDiffRight:0},di.b.TextUnit.Sentence).map(e=>(e.offset+=t,e)))});const a=[];let o=0,s=0,c=!1;n.nextNode();for(const t of r){let i=n.currentNode,r=i.textContent;const l={range:document.createRange(),ancestors:[]};for(l.range.setStart(i,s),c=ui._addAncestor(e,l.ancestors,i)||c;r&&o+r.length<t.offset+t.span;)r&&(o+=r.length),n.nextNode(),i=n.currentNode,r=i.textContent,c=ui._addAncestor(e,l.ancestors,i)||c;s=t.offset+t.span-o,l.range.setEnd(i,s),ui._getLcas(e,l).forEach(e=>{ui._addAndConsolidate(a,e)})}return c&&a.push(e),a}static _addAncestor(e,t,i){let n=!1;return i.parentElement&&(i.parentElement.contains(e)?n=!0:ui._addAndConsolidate(t,i.parentElement)),n}static _addAndConsolidate(e,t){for(;0!==e.length;){const i=e[e.length-1],n=i.contains(t),r=t.contains(i);if(n||r){if(n)break;e.pop()}else e.push(t)}0===e.length&&e.push(t)}static _getLcas(e,t){const i=t.range;if(i){const n=i.commonAncestorContainer;if(t.ancestors.length)if(n.nodeType===n.TEXT_NODE){if(n.parentElement&&n.parentElement!==e)return[n.parentElement]}else{if(Object(yt.a)(n,"HTMLElement")&&n.contains(e))return t.ancestors;if(Object(yt.a)(n,"HTMLElement"))return[n]}else;}return[]}};hi=ui=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.ITextUnitChunker))],hi);var gi=i(8333);let fi=class extends Qt{constructor(e,t,i,n,r,a,o,s,c,l,u,d,h,g,f,p,m,b,y){if(super(e,Fe.TerminalNode,p,void 0,b,y),this._guidGenerator=e,this._logger=t,this._wordCount=i,this._wordCountDetector=n,this._persistedStore=r,this._settings=a,this._indexReadjuster=o,this._nodePoller=s,this._critiquesBrokerFactory=c,this._terminalNodeReader=l,this._proofingDom=u,this._textExtractor=d,this._hostSettings=h,this._hostTilingEmitter=g,this.nodeType=f,this._observer=p,this._paragraphNodesBuilder=m,this.element=b,this.parent=y,this._seqId=0,this._eventSeqId=0,this.id=this._guidGenerator.generate(),!this.element)throw Error("Cannot create TileNode without element");let v;this._cachedTiles=new Map,this._cachedText="",this._cachedWordCount=0,this.resetState(),this.children=[],!this._hostSettings.enableOrchestration&&this._critiquesBrokerFactory&&(this._critiquesBroker=this._critiquesBrokerFactory(this)),this._observer.onElementChanged=e=>!v&&(this.element&&e.contains(this.element)&&(v=window.setTimeout(()=>{this.element&&this._nodePoller.pollNodes(nt.a.NewData,[this])},a.styleSampleTime),v=void 0),!0),this.element&&this._observer.observe(document.body),this._proofingDom.registerNode(this),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this.id,this._cachedText,this._eventSeqId,nt.a.NewData)}retire(){this._nodePoller.removeQueuedTiles(this.id),this._clearReconcileTimer(),this._invalidationDiffBounds={firstDiffLeft:0,firstDiffRight:0},this._critiquesBroker&&this._critiquesBroker.reconcile(void 0,this._cachedText,"",this._monitoredTextRanges,this._invalidationDiffBounds,this._invalidationDiffBounds,this._seqId),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this.id,"",this._eventSeqId,nt.a.RemoveData),this.parent=void 0,this._cachedText="",this._monitoredTextRanges=void 0,this._cachedWordCount=0,this._logger.debug(591661205,"Retire node",this.id),this._proofingDom.unregisterNode(this),super.retire()}move(e,t){this._nodePoller.removeQueuedTiles(this.id),this._proofingDom.unregisterNode(this);const i=this.id;return super.move(e,t),this._critiquesBroker&&this._critiquesBroker.move(i,this.id),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitMoveTileEvent(i,this.id,this._cachedText,this._eventSeqId),this._proofingDom.registerNode(this),this._observer.observe(document.body),this}resetState(){if(!this.element)throw Error("Cannot create TileNode without element");this._cachedText="",this._cachedWordCount=0,this._cachedTiles&&this._cachedTiles.clear(),this._invalidationDiffBounds=void 0,this._monitoredTextRanges=this._hostSettings.simplifiedHostModelEnabled?void 0:[],this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this.id,this._cachedText,this._eventSeqId,nt.a.NewData)}reconcile(e,t,i,n){if(this.parent&&this.element){const r=this._extractContent(this.element),a=di.a.getMinimalDifferenceBounds(this._cachedText,r,this._hostSettings.wordCountDetectorEnabled);return this._hostSettings.simplifiedHostModelEnabled||(i=this._computeMonitoredRanges(r)||i),r!==this._cachedText&&(this._invalidationDiffBounds||(this._invalidationDiffBounds={firstDiffLeft:a.firstDiffLeft,firstDiffRight:a.firstDiffRight}),this._invalidationDiffBounds.firstDiffLeft=Math.min(this._invalidationDiffBounds.firstDiffLeft,a.firstDiffLeft),this._invalidationDiffBounds.firstDiffRight=Math.min(this._invalidationDiffBounds.firstDiffRight,a.firstDiffRight)),this._critiquesBroker&&this._critiquesBroker.reconcile(e,this._cachedText,r,this._monitoredTextRanges,a,this._invalidationDiffBounds||{firstDiffLeft:this._cachedText.length,firstDiffRight:0},this._seqId,t||void 0!==e,void 0),r!==this._cachedText||i?this._reconcileState(r,a,i||!1,void 0):(this._hostSettings.enableOrchestration&&n&&(this._eventSeqId+=1,this._hostTilingEmitter.emitTileDiffEvent(this.id,this._cachedText,r,a,!1,this._eventSeqId,this._cachedWordCount,Array.from(this._cachedTiles.values()))),void this._endActivity(void 0,{isDirtyRangeCheckActivated:!1,isFastLane:!0,isReconciledTile:!0,newCritiquesDiscarded:!1,isSuccess:!0}))}return this._resetInvalidationStateAndReturnTiles(Array.from(this._cachedTiles.values()),this._seqId,void 0)}get critiques(){return this._critiquesBroker?this._critiquesBroker.critiques:[]}_reconcileState(e,t,i,n){const r=this._seqId+1;let a;if(this._hostSettings.wordCountDetectorEnabled){const i=this._wordCountDetector.hasWordCountChanged(t,this._cachedWordCount,e);a=i.isWordCountChanged,this._cachedWordCount=i.wordCount}else a=this._reconcileWordCount(t,e);if(this._reconcileParagraphs(t,e,r),this._hostSettings.enableOrchestration&&(this._eventSeqId+=1,this._hostTilingEmitter.emitTileDiffEvent(this.id,this._cachedText,e,t,a,this._eventSeqId,this._cachedWordCount,Array.from(this._cachedTiles.values()))),this._cachedText=e,i||a){const e=Array.from(this._cachedTiles.values());return this._cachedTiles.clear(),this._hostSettings.enableOptimizedCallingPattern&&this._tryScheduleReconcileTimer(),this._resetInvalidationStateAndReturnTiles(e,r,n)}return this._tryScheduleReconcileTimer(),void this._endActivity(n,{isDirtyRangeCheckActivated:!1,isFastLane:!1,isReconciledTile:!1,newCritiquesDiscarded:!1,isSuccess:!0})}_reconcileWordCount(e,t){let i=0;const n=this._wordCount.getBreaksForRange(t,0,t.length);n.splice(0,0,this._wordCount.getTextStartWordBreak(t)),i=this._wordCount.getWordCount(n,t),i>0&&n[n.length-1].wordBreakType!==gi.a.WhiteSpace&&(this._hostSettings.newLineSentenceSeparatorEnabled||n[n.length-1].wordBreakType!==gi.a.Punctuation)&&n[n.length-1].cp+1<=t.length&&(i-=1);let r=0;e&&e.firstDiffLeft<=t.length&&(r=this._wordCount.getWordCountInRange(t,e.firstDiffLeft,t.length-e.firstDiffRight));const a=i>0&&(i!==this._cachedWordCount||r>1);return this._cachedWordCount=i,a}_reconcileParagraphs(e,t,i){this._paragraphNodesBuilder.updateParagraphNodes(this,this._cachedText,t,this._monitoredTextRanges,e,i).forEach(e=>this._cachedTiles.set(e.header.elementId.id,e));const n=this._cachedTiles.entries();let r=n.next();for(;!r.done;){const e=r.value,t=e[0],a=e[1];this._proofingDom.findParagraphNode(t)?a.header.seqId=i.toString():this._cachedTiles.delete(t),r=n.next()}}_resetInvalidationStateAndReturnTiles(e,t,i){return this._hostSettings.enableOptimizedCallingPattern||this._clearReconcileTimer(),this._invalidationDiffBounds=void 0,this._seqId=t,this._endActivity(i,{isDirtyRangeCheckActivated:!1,isFastLane:!1,isReconciledTile:!1,newCritiquesDiscarded:!1,isSuccess:!0}),e}_tryScheduleReconcileTimer(){return!(!this._settings.enableTileNodeAutoReconciliation||!this._invalidationDiffBounds)&&(this._clearReconcileTimer(),this._reconcileCritiqueTimer=window.setTimeout(()=>{this._logger.debug(591661206,"Dirty range timer has fired."),this._nodePoller.pollNodes(nt.a.NewData,[this],void 0,!0),this._clearReconcileTimer()},this._settings.reconcileTileNodeTime),!0)}_clearReconcileTimer(){this._reconcileCritiqueTimer&&(clearTimeout(this._reconcileCritiqueTimer),this._reconcileCritiqueTimer=void 0,this._logger.debug(591661207,"Dirty range timer has been cleared."))}_endActivity(e,t){e&&(e.addDataField({name:"Tile_Id",value:this.id,dataType:Vt.d.String,classification:Vt.c.EssentialServiceMetadata}),e.addDataField({name:"Fast_Lane",value:t.isFastLane,dataType:Vt.d.Boolean,classification:Vt.c.EssentialServiceMetadata}),e.addDataField({name:"Reconciled_Tile",value:t.isReconciledTile,dataType:Vt.d.Boolean,classification:Vt.c.EssentialServiceMetadata}),e.addDataField({name:"Dirty_Range",value:t.isDirtyRangeCheckActivated,dataType:Vt.d.Boolean,classification:Vt.c.EssentialServiceMetadata}),e.addDataField({name:"New_Critiques_Discarded",value:t.newCritiquesDiscarded,dataType:Vt.d.Boolean,classification:Vt.c.EssentialServiceMetadata}),e.setSuccess(t.isSuccess),e.endNow())}_computeMonitoredRanges(e){const t=this._monitoredTextRanges?this._monitoredTextRanges.length:0;if(this._monitoredTextRanges=void 0,!Object(yt.a)(this.element,"HTMLTextAreaElement")&&!Object(yt.a)(this.element,"HTMLInputElement")&&this.element&&this.parent&&this.parent.element)if(this._terminalNodeReader.contentRoot(this.parent)===this.element){this._monitoredTextRanges=[];let t=0,i=-1;const n=[],r=this.element.textContent;if(!(!!r&&r.length<this._persistedStore.getCachedEntry(Xt.RootContentMaxLengthInChars).storeEntryValue))return!1;this.element.childNodes.forEach(e=>{const r=e.textContent;r&&(e.nodeType===e.TEXT_NODE&&(-1!==i&&i===t?i+=r.length:(i>-1&&n.push(i),n.push(t),i=t+r.length)),t+=r.length)}),i>-1&&n.push(i);let a=this._indexReadjuster.getReadjustedIndices(this.element,n,e,!0);const o=[];for(let e=0;e<a.length;e+=1)e!==a.length-1&&a[e]===a[e+1]?e+=1:o.push(a[e]);a=o;for(let e=0;e<a.length;e+=2)this._monitoredTextRanges.push({offset:a[e],span:a[e+1]-a[e]})}else if(t)return!0;return!1}_extractContent(e){return this._textExtractor.extractElementText(e)}};fi=Rt([kt(0,Object(Mt.inject)(qt.a.IGuidGenerator)),kt(1,Object(Mt.inject)(qt.a.ILogger)),kt(2,Object(Mt.inject)(qt.a.IWordCount)),kt(3,Object(Mt.inject)(qt.a.IWordCount)),kt(4,Object(Mt.inject)(qt.a.IHostModelPersistedStore)),kt(5,Object(Mt.inject)(qt.a.IHostModelSettings)),kt(6,Object(Mt.inject)(qt.a.IIndexReadjuster)),kt(7,Object(Mt.inject)(qt.a.INodePoller)),kt(8,Object(Mt.optional)()),kt(8,Object(Mt.inject)(qt.a.ICritiquesBrokerFactory)),kt(9,Object(Mt.inject)(qt.a.ITerminalNodeReader)),kt(10,Object(Mt.inject)(qt.a.IProofingDom)),kt(11,Object(Mt.inject)(qt.a.ITextExtractor)),kt(12,Object(Mt.inject)(qt.a.IHostSettings))],fi);var pi,mi=i(11832),bi=i(3859);let yi=pi=class{constructor(e,t,i,n,r,a,o){this._proofingEmitter=e,this._proofingDom=t,this._proofingPersistedStore=i,this._logger=n,this._tileNode=r,this._critiqueFilterer=a,this._upsellStore=o,this._actionCallback=(e,t)=>{switch(e){case mi.a.IgnoreOnce:case mi.a.ApplySuggestion:case mi.a.DisableCritiqueType:this._removeCritique(t);break;default:this._logger.error(591526047,"Unexpected and unhandled action type for callback",e)}},this._removeCritique=e=>{if(this._critiques.delete(e)){const e=new Map;this._critiques.forEach(t=>{this._addToActive(t,[e])}),this._sendCritiqueMessage(e,this._tileNode.id,void 0,nt.a.NewData)}},this._critiques=new Map}reconcile(e,t,i,n,r,a,o,s=!1,c){let l=s;const u=this._critiques.size,d=new Map,h=new Map,g=new Map,f=this._mergeCritiques(e,a,o);this._critiques.forEach(e=>{const a=t.length-e.start,o=i.length-a;o>i.length-r.firstDiffRight?(e.start=o,pi._isInMonitoredTextRange(n,e)&&(this._addToActive(e,[h]),g.set(e.start,e),l=!0)):r.firstDiffRight?e.start+e.length>=r.firstDiffLeft?(l=!0,this._upsellStore.removePremiumCritique(e)):pi._isInMonitoredTextRange(n,e)&&(this._addToActive(e,[h,d]),g.set(e.start,e)):e.start+e.length>=r.firstDiffLeft&&t.length!==i.length?(l=!0,this._upsellStore.removePremiumCritique(e)):pi._isInMonitoredTextRange(n,e)&&(this._addToActive(e,[h,d]),g.set(e.start,e))}),this._critiques.size||u||d.size||(l=!1),l&&this._sendCritiqueMessage(h,this._tileNode.id,c,(f||this._critiques.size!==u||(h.size,d.size),nt.a.NewData)),this._critiques=g}move(e,t){this._critiques.forEach(e=>{e.tileId&&(e.tileId.nodeId=t)}),setTimeout(()=>{this._sendCritiqueMessage(new Map,e,void 0,nt.a.RemoveData)},0)}get critiques(){return Array.from(this._critiques.values())}_addToActive(e,t){this._critiqueIsVisible(e)&&(e.priority===b.b.High&&this._proofingPersistedStore.getCachedEntry(tt.a.EnableSpelling).storeEntryValue||e.priority===b.b.Medium&&(this._upsellStore.isSquiggleBeingPreviewed(e)||this._proofingPersistedStore.getCachedEntry(tt.a.EnableGrammar).storeEntryValue)||e.priority===b.b.Low&&(this._upsellStore.previewPremiumSquiggles||this._proofingPersistedStore.getCachedEntry(tt.a.EnableRefinements).storeEntryValue))&&t.forEach(t=>t.set(e.start,e))}_critiqueIsVisible(e){return this._critiqueFilterer.applyFilters([e]),!!e.isVisible}_mergeCritiques(e,t,i){if(e){const n=new Map,r=e.filter(e=>{if(e.tileId){const r=this._proofingDom.findParagraphNode(e.tileId.elementId.id);e.start=(r&&r.element?r.element.offset:e.tileId.elementId.offset)+e.start;const a=e.start<t.firstDiffLeft&&e.start+e.length<=t.firstDiffLeft,o=parseInt(e.tileId.seqId,10)===i;if(r||a&&o){const t=this._critiques.get(e.start);return t&&t.start===e.start&&t.length===e.length&&t.priority===e.priority&&(e.traceId=t.traceId),n.set(e.tileId.elementId.id,e.tileId.elementId),!0}}return!1});return this._critiques.forEach((e,t,i)=>{n.forEach(n=>{const r=n.offset,a=n.offset+n.span,o=e.start,s=e.start+e.length;((()=>o>=r&&o<a)()||(()=>s>r&&s<=a)()||(()=>o<r&&s>a)())&&i.delete(t)})}),r.forEach(e=>{e.length&&this._critiques.set(e.start,e)}),!!r.length}return!1}_sendCritiqueMessage(e,t,i,n=nt.a.NewData){i&&i.addDataField({name:"Critique_Reflow",value:!0,dataType:Vt.d.Boolean,classification:Vt.c.EssentialServiceMetadata}),this._proofingEmitter.emit("squiggleDataEvent",{messageType:n,data:{critiquesToElementsMap:[{elementId:t,element:this._tileNode.element,critiques:e}],actionCallback:this._actionCallback}})}static _isInMonitoredTextRange(e,t){if(!e)return!0;for(const i of e)if(i.offset<=t.start&&i.offset+i.span>=t.start+t.length)return!0;return!1}};yi=pi=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IProofingEmitter)),kt(1,Object(Mt.inject)(qt.a.IProofingDom)),kt(2,Object(Mt.inject)(bi.a.IProofingPersistedStore)),kt(3,Object(Mt.inject)(qt.a.ILogger)),kt(5,Object(Mt.inject)(qt.a.ICritiqueFilterer)),kt(6,Object(Mt.inject)(qt.a.IUpsellStore))],yi);let vi=class{retrieveElements(e,t){if(!e.querySelectorAll)return[];const i=t.join(",");return e.querySelector(i)?Array.from(e.querySelectorAll(i)):[]}};vi=Rt([Object(Mt.injectable)()],vi);let _i=class{isTileNode(e){return e.nodeType===Fe.TileNode}reconcile(e,t,i,n,r){return this.getTileNode(e).reconcile(t,i||!1,n||!1,r||!1)}critiques(e){return this.getTileNode(e).critiques}getTileNode(e){if(this.isTileNode(e))return e;throw TypeError("Node is not a tile node")}};_i=Rt([Object(Mt.injectable)()],_i);let Ii=class{isTerminalNode(e){return e.nodeType===Fe.TerminalNode}contentRoot(e){return this.getTerminalNode(e).contentRoot}getTerminalNode(e){if(this.isTerminalNode(e))return e;throw TypeError("Node is not a terminal node")}};Ii=Rt([Object(Mt.injectable)()],Ii);let Si=class{constructor(e){this._terminalNodeReader=e}setContentRoot(e,t){if(!this._terminalNodeReader.isTerminalNode(e))throw TypeError("Node is not a terminal node");e.contentRoot=t}};Si=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.ITerminalNodeReader))],Si);let Ci=class{constructor(){this._rootNodes=[]}rootAtNodes(e){this._rootNodes=e}*getIterator(){if(this._rootNodes.length){const e=[];for(e.push(...this._rootNodes);e.length;){const t=e.pop();yield t,t&&t.children&&t.children.length&&e.push(...t.children)}}yield}};Ci=Rt([Object(Mt.injectable)()],Ci);let Ei=class{constructor(e,t,i,n,r,a,o,s,c,l){this._proofingNodeSubmitter=e,this._tileNodeReader=t,this._settings=i,this._hostSettings=n,this.featureFlagsReader=r,this._proofingStore=a,this._proofingDom=o,this._logger=s,this._languageDetector=c,this._e2eMetric=l,this._tiles=[]}pollNodes(e,t,i,n,r,a){const[o,s,c,l]=[this._settings.maxContentLengthInChars,this._settings.schedulerDefaultWaitingTime,this._settings.schedulerDefaultMaxTime,this._settings.schedulerDefaultWaitingTimeIncrement];this._timeout||(this._timeout=s);const u=this._pickMostRecentTiles();if(this._tiles.length){let e=this._tiles.length-1;for(;e>=0;){this._proofingDom.findParagraphNode(this._tiles[e].header.elementId.id)||this._tiles.splice(e,1),e-=1}}let d=0;for(const e of t)try{const t=this._tileNodeReader.reconcile(e,r?r.get(e.id):void 0,!0,n,a);t&&!this._hostSettings.enableOrchestration&&(d+=t.length,this._tiles.splice(this._tiles.length,0,...this._mergeTiles(t)))}catch(e){this._logger.log(591661199,at.a.Error,"NodePoller: Found children of unsupported type.")}if(!this._tiles.length&&u.length&&this._tiles.push(...u),this._tiles.length){this._timer&&(clearTimeout(this._timer),this._timer=void 0,d&&(this._timeout=Math.min(this._timeout+l,c)),this._logger.debug(591661200,`Scheduler timeout cleared, it was ${this._timeout}`));let t=this._timeout;i&&(t=Math.max(i,this._timeout)),this._timer=window.setTimeout(()=>{this._timeout=s;let t=0,i=0;for(;i<this._tiles.length;){const e=this._getTileContentLength(this._tiles[i]);if(e>=o)this._tiles.splice(i,1);else{if(t+e>=o)break;t+=e,i+=1}}const n=this._tiles.splice(0,i),r=new it.a(this._proofingStore.getCachedEntry(tt.a.ProofingLanguages).storeEntryValue),a=this.featureFlagsReader.flags.enableMultiLanguageSupport?this._languageDetector.getUILanguage():r.defaultLanguageCode,l={messageType:e,data:{tiles:this._buildTilesToSend(n,r),uxLanguage:a}};this._proofingNodeSubmitter.emit("tilesEvent",l),this._timer=void 0,this._tiles.length&&this.pollNodes(nt.a.NewData,[],c)},t),this._logger.debug(591661201,"Scheduler timeout set")}}removeQueuedTiles(e){this._tiles=this._tiles.filter(t=>t.header.nodeId!==e)}_mergeTiles(e){let t=e.filter(e=>e.data.trim().length);return this._tiles.forEach(e=>{t=t.filter(t=>!(t.header.nodeId===e.header.nodeId&&t.header.elementId.id===e.header.elementId.id&&t.header.elementId.offset===e.header.elementId.offset&&t.header.elementId.span===e.header.elementId.span))}),t}_pickMostRecentTiles(){const e=new Map;return this._tiles.forEach(t=>{const i=e[t.header.nodeId];i?parseInt(t.header.seqId,10)>parseInt(i.header.seqId,10)&&e.set(t.header.nodeId,t):e.set(t.header.nodeId,t)}),Array.from(e.values())}_getTileContentLength(e){return this.featureFlagsReader.flags.enableMultiLanguageSupport?e.data.length*e.proofingLanguages.length:e.data.length}_buildTilesToSend(e,t){const i=this.featureFlagsReader.flags.enableMultiLanguageSupport,n=[];for(const r of e)if(this._e2eMetric.startEntry(r.header.elementId.id),i)for(const e of t.codesList)n.push({header:r.header,data:r.data,proofingLanguages:[e],textUnit:r.textUnit});else n.push({header:r.header,data:r.data,proofingLanguages:[t.defaultLanguageCode],textUnit:r.textUnit});return n}};Ei=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IProofingEmitter)),kt(1,Object(Mt.inject)(qt.a.ITileNodeReader)),kt(2,Object(Mt.inject)(qt.a.IHostModelSettings)),kt(3,Object(Mt.inject)(qt.a.IHostSettings)),kt(4,Object(Mt.inject)(qt.a.IFeatureFlagsReader)),kt(5,Object(Mt.inject)(qt.a.IProofingPersistedStore)),kt(6,Object(Mt.inject)(qt.a.IProofingDom)),kt(7,Object(Mt.inject)(qt.a.ILogger)),kt(8,Object(Mt.inject)(bi.a.IUxLanguageDetector)),kt(9,Object(Mt.inject)(qt.a.IE2eMetric))],Ei);let Ti=class{};Ti=Rt([Object(Mt.injectable)()],Ti);let Oi=class{};Oi=Rt([Object(Mt.injectable)()],Oi);var wi=i(11833);let ji=class{constructor(e,t,i,n,r,a){this._guidGenerator=e,this._proofingDom=t,this._proofingEmitter=i,this._nodePoller=n,this.hostSettings=r,this._roamingDictionaryFeature=a,this._ignoredWords=new Set,this.isWordIgnored=e=>{const t=e.trim();return!!this._ignoredWords.has(t)||!(!this._roamingDictionary||!this._roamingDictionary.testWord(t,!0))},this.clearIgnoredWords=()=>{this._ignoredWords.clear(),this._nodePoller.pollNodes(nt.a.ChangeData,this._proofingDom.tileNodes),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:nt.a.RemoveData,data:wi.a.IgnoreListUpdate})},this.addWordToIgnoreList=e=>{e&&(this._ignoredWords.add(e.trim()),this._nodePoller.pollNodes(nt.a.ChangeData,this._proofingDom.tileNodes),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:nt.a.NewData,data:wi.a.IgnoreListUpdate}))},this.addWordToCustomDictionary=e=>{if(e){const t=e.trim();if(this._roamingDictionary&&this._roamingDictionaryFeature.isReady()){return!!this._roamingDictionary.addWord(t)&&(this._nodePoller.pollNodes(nt.a.ChangeData,this._proofingDom.tileNodes),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:nt.a.NewData,data:wi.a.CustomDictionaryUpdate}),!0)}}return!1}}async initialize(){if(this.hostSettings.enableRoamingDictionary){this._roamingDictionaryFeature.emitAndEvaluate({eventId:v.a.ClientInitialized,sender:v.b.WordDictionaryInit})&&(this._roamingDictionary=this._roamingDictionaryFeature.getRoamingDictionary())}}async shutDown(){}};ji=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IGuidGenerator)),kt(1,Object(Mt.inject)(qt.a.IProofingDom)),kt(2,Object(Mt.inject)(qt.a.IProofingEmitter)),kt(3,Object(Mt.inject)(qt.a.INodePoller)),kt(4,Object(Mt.inject)(qt.a.IHostSettings)),kt(5,Object(Mt.inject)(bi.a.IRoamingDictionaryFeature))],ji);const Pi=(e,t,i)=>{if(!e||!t)return;const n=e.getNewActivity(Ht.WebSiteProvedOnce,Vt.i.CriticalBusinessImpact),r=t.getCachedEntry(tt.a.ProofingLanguages).storeEntryValue;n&&(n.addDataField({name:"Proofing_Languages",value:r.join(","),dataType:Vt.d.String,classification:Vt.c.EssentialServiceMetadata}),n.addDataField({name:"IsAL",value:i&&!0===i.enableOrchestration&&i.orchestratorSettings&&!0===i.orchestratorSettings.enableAugLoop||!1,dataType:Vt.d.Boolean,classification:Vt.c.EssentialServiceMetadata}),n.setSuccess(!0),n.endNow())};let xi=class{constructor(e,t,i,n,r,a,o){this._proofingDom=e,this._proofingEmitter=t,this._nodePoller=i,this._proofingPersistedStore=n,this._hostSettings=r,this._logger=a,this._e2eMetric=o,this._websiteProvedOnce=!1,this.shutDown=async()=>{this._proofingEmitter.off("critiqueEvent")},this.cleanUp=()=>{this.shutDown()},this.onCritiqueEvent=e=>{try{this._detectWebSiteProved(e),this.updateCritiques(e)}catch(e){this._logger.logEvent(589947153,Gt.UpdateCritiqueException,at.a.Error,"Error while updating critiques on the shadow graph.",Vt.i.CriticalBusinessImpact)}},this.updateCritiques=e=>{const t=e.data,i=new Map,n=[],r=new Set;for(const e of t){if(!e.tileId)continue;const t=e.tileId.elementId.id;r.has(t)||(this._e2eMetric.commitEntry(t),r.add(t));const a=i.get(e.tileId.nodeId);if(a)a.push(e);else{i.set(e.tileId.nodeId,[e]);const t=this._proofingDom.findTileNode(e.tileId.nodeId);t&&n.push(t)}}n.length&&this._nodePoller.pollNodes(nt.a.NewData,n,void 0,!1,i)}}async initialize(){this._proofingEmitter.on("critiqueEvent",this.onCritiqueEvent)}_detectWebSiteProved(e){!this._websiteProvedOnce&&e.messageType===nt.a.NewData&&e.data&&e.data.length&&(this._websiteProvedOnce=!0,Pi(this._logger,this._proofingPersistedStore,this._hostSettings))}};xi=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IProofingDom)),kt(1,Object(Mt.inject)(qt.a.IProofingEmitter)),kt(2,Object(Mt.inject)(qt.a.INodePoller)),kt(3,Object(Mt.inject)(qt.a.IProofingPersistedStore)),kt(4,Object(Mt.inject)(qt.a.IHostSettings)),kt(5,Object(Mt.inject)(qt.a.ILogger)),kt(6,Object(Mt.inject)(qt.a.IE2eMetric))],xi);let Di=class{constructor(e,t,i,n,r){this._proofingStore=e,this._emitter=t,this.nodePoller=i,this.proofingDom=n,this._logger=r,this._proofingLanguages=new it.a(this._proofingStore.getDefaultValue(tt.a.ProofingLanguages))}async initialize(){this._emitter.on("proofingLanguageChanged",async e=>{this.switchProofingLanguage(e.data)}),this._proofingLanguages=new it.a(await this._proofingStore.read(tt.a.ProofingLanguages))}async shutDown(){this._emitter.off("proofingLanguageChanged")}switchProofingLanguage(e){this._proofingLanguages.equalsTo(e.codesList)||(this._proofingLanguages=e,this._logger.debug(589968392,`Proofing languages list switched to ${e.codesList}`),this.proofingDom.tileNodes.map(e=>e.resetState()),this.nodePoller.pollNodes(nt.a.NewData,this.proofingDom.tileNodes,void 0,!0))}};Di=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IProofingPersistedStore)),kt(1,Object(Mt.inject)(qt.a.IProofingEmitter)),kt(2,Object(Mt.inject)(qt.a.INodePoller)),kt(3,Object(Mt.inject)(qt.a.IProofingDom)),kt(4,Object(Mt.inject)(qt.a.ILogger))],Di);let Ni=class{constructor(e){this._wordDictionary=e}filter(e){return!(!e||!e.textInContext)&&!this._wordDictionary.isWordIgnored(e.textInContext)}};Ni=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IWordDictionary))],Ni);let Ai=class{constructor(e,t,i,n,r,a,o){this._dictionaryCritiqueFilter=e,this._enabledCritiqueTypesCritiqueFilter=t,this._hostSettings=i,this._featureFlagsReader=n,this._premiumCritiqueFilter=r,this._spellingCritiqueFilter=a,this._categoryCritiqueFilter=o,this._critiqueFilters=[]}async initialize(){this._hostSettings.enhancedUpsellEnabled&&this._premiumCritiqueFilter&&this._critiqueFilters.push(this._premiumCritiqueFilter),this._critiqueFilters.push(this._dictionaryCritiqueFilter),!this._hostSettings.enableOrchestration&&this._featureFlagsReader.flags.enableCritiqueSettings&&this._critiqueFilters.push(this._spellingCritiqueFilter),this._hostSettings.enableOrchestration&&this._critiqueFilters.push(this._enabledCritiqueTypesCritiqueFilter),this._categoryCritiqueFilter&&this._critiqueFilters.push(this._categoryCritiqueFilter)}async shutDown(){this._critiqueFilters.splice(0,this._critiqueFilters.length)}applyFilters(e){if(!e)return[];return e.filter(e=>{const t=e.isVisible;let i=!0;for(const t of this._critiqueFilters)if(i=t.filter(e),!i)break;return e.isVisible=i,e.isVisible!==t})}};Ai=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.DictionaryCritiqueFilter)),kt(1,Object(Mt.inject)(qt.a.EnabledCritiqueTypesCritiqueFilter)),kt(2,Object(Mt.inject)(qt.a.IHostSettings)),kt(3,Object(Mt.inject)(qt.a.IFeatureFlagsReader)),kt(4,Object(Mt.optional)()),kt(4,Object(Mt.inject)(qt.a.PremiumCritiqueFilter)),kt(5,Object(Mt.optional)()),kt(5,Object(Mt.inject)(qt.a.SpellingCritiqueFilter)),kt(6,Object(Mt.optional)()),kt(6,Object(Mt.inject)(qt.a.CategoryCritiqueFilter))],Ai);var Ri=i(8329);function ki(e,t,i){e.set(b.a.ContextualSpelling,1),e.set(b.a.WrongSpelling,1),i===Ri.b.Subscription&&t.some(e=>"mc-officeeditortonalenabled"===e.toLowerCase())&&e.set(b.a.TonalRewrite,1)}let Fi=class{constructor(e,t){this._proofingPersistedStore=e,this._hostSettings=t,this._availableCritiqueTypes=new Map,this._overriddenCritiqueTypes=new Map;const i=this._proofingPersistedStore.getCachedEntry(tt.a.OverriddenCritiqueTypeOptions);ki(this._availableCritiqueTypes,this._hostSettings.flightsToTrack||[],this._hostSettings.licenseType),this.setOverriddenCritiqueTypes(i.storeEntryValue),i.isSynced||this.readOverriddenCritiqueTypesFromStorage()}async readOverriddenCritiqueTypesFromStorage(){const e=await this._proofingPersistedStore.read(tt.a.OverriddenCritiqueTypeOptions);this.setOverriddenCritiqueTypes(e)}isCritiqueTypeEnabled(e){const t=this._availableCritiqueTypes.get(e);if(void 0===t)return!1;const i=this._overriddenCritiqueTypes.get(e);return void 0===i?1===t:"1"===i}isCritiqueTypePremium(e){if(e===b.a.TonalRewrite)return!0;return 1!==this._availableCritiqueTypes.get(e)}setOverriddenCritiqueTypes(e){e&&(this._overriddenCritiqueTypes.clear(),e.forEach(e=>{this._overriddenCritiqueTypes.set(e.id,e.value)}))}setAvailableCritiqueTypes(e){e&&(this._availableCritiqueTypes.clear(),ki(this._availableCritiqueTypes,this._hostSettings.flightsToTrack||[],this._hostSettings.licenseType),e.forEach(e=>{this._availableCritiqueTypes.set(e.id,e.defaultCritiqueValue)}))}};Fi=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IProofingPersistedStore)),kt(1,Object(Mt.inject)(qt.a.IHostSettings))],Fi);let Li=class{constructor(e,t){this._enabledCritiqueTypes=e,this._upsellStore=t}filter(e){if(!e)return!1;let t=!0;if(this._upsellStore.isUpsellUser){const i=e.typeId||"";this._enabledCritiqueTypes.isCritiqueTypePremium(i)&&(this._upsellStore.addPremiumCritique(e),t=this._upsellStore.previewPremiumSquiggles)}return t}};Li=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IEnabledCritiqueTypes)),kt(1,Object(Mt.inject)(qt.a.IUpsellStore))],Li);let Mi=class{constructor(e,t,i){this._enabledCritiqueTypes=e,this._proofingPersistedStore=t,this._upsellStore=i}filter(e){return void 0!==(null==e?void 0:e.typeId)&&this.isCritiqueCategoryEnabled(e.priority)&&this.isCritiqueTypeEnabled(e.typeId)}isCritiqueCategoryEnabled(e){return e===b.b.High&&!!this._proofingPersistedStore.getCachedEntry(tt.a.EnableSpelling).storeEntryValue||e===b.b.Medium&&!!this._proofingPersistedStore.getCachedEntry(tt.a.EnableGrammar).storeEntryValue||e===b.b.Low&&(this._upsellStore.previewPremiumSquiggles||!!this._proofingPersistedStore.getCachedEntry(tt.a.EnableRefinements).storeEntryValue)}isCritiqueTypeEnabled(e){return this._enabledCritiqueTypes.isCritiqueTypeEnabled(e)||this._upsellStore.previewPremiumSquiggles&&this._enabledCritiqueTypes.isCritiqueTypePremium(e)}};Mi=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IEnabledCritiqueTypes)),kt(1,Object(Mt.inject)(qt.a.IProofingPersistedStore)),kt(2,Object(Mt.inject)(qt.a.IUpsellStore))],Mi);var qi=i(16444);let Bi=class{constructor(e,t,i,n,r,a,o){this._enabledCritiqueTypes=e,this._localizer=t,this._nodePoller=i,this._proofingDom=n,this._proofingPersistedStore=r,this._isUpsellUser=a,this._proofingEmitter=o,this._categoriesList=new Set,this._premiumCritiques=new Map,this._previouslyClickedCritiques=new Set,this._previewCount=3,this._previewUnit=qi.b.Suggestions,this._previewModeActive=!1,this._lightUpPremiumSquiggles=!1}get categoriesList(){let e="";const t=Array.from(this._categoriesList);for(let i=0;i<t.length;i+=1)e+=t[i],i<t.length-2?e+=this._localizer.getMessage("ebx_enhancedUpsellCategoriesComma"):i===t.length-2&&(e+=this._localizer.getMessage("ebx_enhancedUpsellCategoriesAnd"));return e}get isUpsellUser(){return this._isUpsellUser.check()}get premiumCount(){return this._proofingPersistedStore.getCachedEntry(tt.a.EnableGrammar).storeEntryValue?this._premiumCritiques.size:this._countRefinementCritiquesOnly()}get previewCount(){return this._previewCount}get previewUnit(){return this._previewUnit}get previewModeActive(){return this._previewModeActive}get previewPremiumSquiggles(){return this._previewModeActive||this._lightUpPremiumSquiggles}addPremiumCritique(e){e.traceId&&e.categoryTitle&&(this._premiumCritiques.has(e.traceId)||(this._premiumCritiques.set(e.traceId,e.priority),this._categoriesList.has(e.categoryTitle)||this._categoriesList.add(e.categoryTitle),this._onPremiumCountChange&&this._onPremiumCountChange(this.premiumCount,this.categoriesList)))}removePremiumCritique(e){e.traceId&&e.categoryTitle&&this._premiumCritiques.has(e.traceId)&&(this._premiumCritiques.delete(e.traceId),this._categoriesList.delete(e.categoryTitle),this._onPremiumCountChange&&this._onPremiumCountChange(this.premiumCount,this.categoriesList))}setPreviewCount(e,t=!1){this._previewCount=e,!t&&this._onPreviewCountChange&&this._onPreviewCountChange(this._previewCount)}setPreviewUnit(e){this._previewUnit=e}setPreviewModeActive(e){e!==this._previewModeActive&&(this._previewModeActive=e,this._nodePoller.pollNodes(nt.a.ChangeData,this._proofingDom.tileNodes),this._proofingEmitter.emit("enabledCritiqueTypesChanged",{messageType:nt.a.ChangeData}))}setLightUpPremiumSquiggles(e){e!==this._lightUpPremiumSquiggles&&(this._lightUpPremiumSquiggles=e,this._nodePoller.pollNodes(nt.a.ChangeData,this._proofingDom.tileNodes),this._proofingEmitter.emit("enabledCritiqueTypesChanged",{messageType:nt.a.ChangeData}))}isSquiggleBeingPreviewed(e){const t=this._proofingPersistedStore.getCachedEntry(tt.a.EnableGrammar).storeEntryValue;return!(!(this._lightUpPremiumSquiggles&&e&&e.typeId&&this._enabledCritiqueTypes.isCritiqueTypePremium(e.typeId))||e.priority===b.b.Medium&&!t)}reducePreviewCount(e){if(!this.isUpsellUser||!this.previewModeActive||this._previewUnit!==qi.b.Suggestions||!e.typeId||!this._enabledCritiqueTypes.isCritiqueTypePremium(e.typeId)||e.traceId&&this._previouslyClickedCritiques.has(e.traceId))return qi.a.Visible;let t=qi.a.Visible;if(this.previewCount>0){const t=this._previewCount-1;this.setPreviewCount(t),e.traceId&&this._previouslyClickedCritiques.add(e.traceId)}else t=qi.a.Hidden,this._previewModeActive=!1,this._nodePoller.pollNodes(nt.a.ChangeData,this._proofingDom.tileNodes),this._proofingEmitter.emit("enabledCritiqueTypesChanged",{messageType:nt.a.ChangeData}),this._onPremiumPreviewExpired&&this._onPremiumPreviewExpired();return t}setOnPremiumCountChange(e){this._onPremiumCountChange=e}setOnPremiumPreviewExpired(e){this._onPremiumPreviewExpired=e}setOnPreviewCritiquesCountChange(e){this._onPreviewCountChange=e}setOnTryPremiumPreview(e){this._onTryPremiumPreview=e}tryPremiumPreview(e){this._onTryPremiumPreview&&this._onTryPremiumPreview({eventId:y.b.TryPremiumPreviewButtonClicked,sender:y.d.ShowCritiqueCallout,critique:e,location:y.c.PremiumPreview_CCard})}_countRefinementCritiquesOnly(){let e=0;return this._premiumCritiques.forEach(t=>{t!==b.b.Medium&&(e+=1)}),e}};Rt([gt.observable],Bi.prototype,"_categoriesList",void 0),Rt([gt.observable],Bi.prototype,"_premiumCritiques",void 0),Rt([gt.observable],Bi.prototype,"_previewCount",void 0),Rt([gt.observable],Bi.prototype,"_previewUnit",void 0),Rt([gt.observable],Bi.prototype,"_previewModeActive",void 0),Rt([gt.observable],Bi.prototype,"_lightUpPremiumSquiggles",void 0),Rt([gt.computed],Bi.prototype,"categoriesList",null),Rt([gt.computed],Bi.prototype,"isUpsellUser",null),Rt([gt.computed],Bi.prototype,"premiumCount",null),Rt([gt.computed],Bi.prototype,"previewCount",null),Rt([gt.computed],Bi.prototype,"previewUnit",null),Rt([gt.computed],Bi.prototype,"previewModeActive",null),Rt([gt.computed],Bi.prototype,"previewPremiumSquiggles",null),Rt([gt.action],Bi.prototype,"addPremiumCritique",null),Rt([gt.action],Bi.prototype,"removePremiumCritique",null),Rt([gt.action],Bi.prototype,"setPreviewCount",null),Rt([gt.action],Bi.prototype,"setPreviewUnit",null),Rt([gt.action],Bi.prototype,"setPreviewModeActive",null),Rt([gt.action],Bi.prototype,"setLightUpPremiumSquiggles",null),Bi=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.inject)(qt.a.IEnabledCritiqueTypes)),kt(1,Object(Mt.inject)(qt.a.ILocalizer)),kt(2,Object(Mt.inject)(qt.a.INodePoller)),kt(3,Object(Mt.inject)(qt.a.IProofingDom)),kt(4,Object(Mt.inject)(qt.a.IProofingPersistedStore)),kt(5,Object(Mt.inject)(qt.a.IsUpsellUser)),kt(6,Object(Mt.inject)(qt.a.IProofingEmitter))],Bi);let Ui=class{constructor(e,t,i){this._hostEmitters=e,this._nodePoller=t,this._proofingDom=i}async initialize(){this._hostEmitters.forEach(e=>{e.on(ot.a.hostModelRehydrateTiles,this._handleRehydrate.bind(this))})}async shutDown(){this._hostEmitters.forEach(e=>{e.off(ot.a.hostModelRehydrateTiles)})}_handleRehydrate(e){const t=e.message;t&&t.length>0?t.forEach(e=>{const t=this._proofingDom.findTileNode(e);t&&t.resetState()}):this._proofingDom.tileNodes.forEach(e=>{e.resetState()}),this._nodePoller.pollNodes(nt.a.NewData,this._proofingDom.tileNodes,void 0,!0)}};Ui=Rt([Object(Mt.injectable)(),kt(0,Object(Mt.multiInject)(qt.a.IHostEmitterArray)),kt(1,Object(Mt.inject)(qt.a.INodePoller)),kt(2,Object(Mt.inject)(qt.a.IProofingDom))],Ui);var Wi=i(4479);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Hi(e,t,i,n){var r,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,i,o):r(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o}function Gi(e,t){return function(i,n){t(i,n,e)}}const Vi=e=>{e.action&=-5};let zi=class{constructor(e,t){this._submitter=e,this._logger=t}emitNew(e){return this.emitCritiques(nt.a.NewData,e)}emitRemoval(e){return this.emitCritiques(nt.a.RemoveData,(e=>{const t=[];for(const i of e){const e={tileId:i.header,supportedActions:0,suggestions:[],start:0,length:0,priority:0};t.push(e)}return t})(e))}emitCritiques(e,t){return!!this.canEmitCritiques(t)&&(this._logger.debug(589968355,`Publishing critique with message type = ${e}.`),this._submitter.emit("critiqueEvent",{data:t,messageType:e}),!0)}canEmitCritiques(e){return 0!==e.length}};var $i;zi=Hi([Object(Mt.injectable)(),Gi(0,Object(Mt.inject)(Wi.a.IProofingEmitter)),Gi(1,Object(Mt.inject)(Wi.a.ILogger))],zi);let Ji=$i=class{constructor(e,t,i,n,r,a,o){this._uuidGenerator=e,this._orchestratorSettings=t,this._proofingStore=i,this._descriptorManager=n,this._featureFlagsReader=r,this._tileIdFormatter=a,this._unSignedInEditorFeature=o}async buildValidRequest(e){let t=0;const i=await this._proofingStore.read(tt.a.OverriddenCritiqueTypeOptions),n={appId:await this._proofingStore.read(tt.a.AppId),sessionId:this._uuidGenerator.generate(),languageUXId:e.data.uxLanguage,content:(()=>e.data.tiles.map(e=>{const i=e.data.length<this._orchestratorSettings.maxContentLengthInChars?$i._generateElements(e.data,e.proofingLanguages[0],e.textUnit):[];return i.length&&(t+=e.data.length),{tileId:this.buildTileId(e.header,e.proofingLanguages[0]),revisionId:"1",tileElements:i}}).filter(e=>e.tileElements&&e.tileElements.length>0))(),descriptors:await this._descriptorManager.buildDescriptors(),overriddenCritiqueTypeOptions:i.length>0?i:void 0};if(await this.unsignedInEditorFeatureEnabled()&&(n.runOnProfileId="50000000-0000-0000-0000-000000000000"),t<this._orchestratorSettings.maxContentLengthInChars&&n.content&&n.content.length>0)return n}async unsignedInEditorFeatureEnabled(){return this._unSignedInEditorFeature.emitAndEvaluateAsync({eventId:wt.a.PageContext,sender:wt.c.PageContext})}buildTileId(e,t){return this._featureFlagsReader.flags.enableMultiLanguageSupport?this._tileIdFormatter.format(JSON.stringify(e),t):JSON.stringify(e)}static _generateElements(e,t,i=Lt.c.TextUnit.Sentence){return 0===e.length?[]:[{text:e,languageId:t,textUnit:i}]}};var Ki,Xi;Ji=$i=Hi([Object(Mt.injectable)(),Gi(0,Object(Mt.inject)(Wi.a.IGuidGenerator)),Gi(1,Object(Mt.inject)(Wi.a.IOrchestratorSettings)),Gi(2,Object(Mt.inject)(Wi.a.IProofingPersistedStore)),Gi(3,Object(Mt.inject)(Wi.a.IDescriptorManager)),Gi(4,Object(Mt.inject)(bi.a.IFeatureFlagsReader)),Gi(5,Object(Mt.inject)(Wi.a.ITileIdFormatter)),Gi(6,Object(Mt.inject)(bi.a.IUnsignedInEditorFeature))],Ji),function(e){e.InstrumentationCall="InstrumentationCall"}(Ki||(Ki={})),function(e){e.TileIdParseException="RunTimeErrors.TileIdParseException",e.InvalidTileFormat="RunTimeErrors.InvalidTileFormat"}(Xi||(Xi={}));let Yi=class{constructor(e,t,i,n,r){this._receiver=e,this._hostEmitter=t,this._tileCheckRequestBuilder=i,this._critiquesMessageEmitter=n,this._logger=r,this.cleanUp=()=>{this.shutDown()},this.tilesEventListener=async e=>this.process(e),this.tileCheckResponseV1Listener=e=>this.handleResponse(e),this.clearTileCritiquesListener=e=>this._critiquesMessageEmitter.emitRemoval(e.message)}async initialize(){this._receiver.on("tilesEvent",this.tilesEventListener),this._hostEmitter.on(ot.a.tileCheckResponseV1,this.tileCheckResponseV1Listener),this._hostEmitter.on(ot.a.clearTileCritiques,this.clearTileCritiquesListener)}async shutDown(){this._receiver.off("tilesEvent"),this._hostEmitter.off(ot.a.tileCheckResponseV1),this._hostEmitter.off(ot.a.clearTileCritiques)}async process(e){if(e.data.tiles.length<=0)return!1;if(e.messageType===nt.a.RemoveData)return this._critiquesMessageEmitter.emitRemoval(e.data.tiles),!0;try{const t=await this._tileCheckRequestBuilder.buildValidRequest(e);return!!t&&(this._hostEmitter.emit(ot.a.tileCheckRequestV1,{address:void 0,message:t}),this._logger.debug(589897998,"Sending Tile check API request to background script."),!0)}catch(e){this._logger.logEvent(589968387,Xi.InvalidTileFormat,at.a.Error,"Invalid input. Request not sent to the background script.",Vt.i.CriticalBusinessImpact)}return!1}handleResponse(e){this._critiquesMessageEmitter.emitNew(e.message)}};Yi=Hi([Object(Mt.injectable)(),Gi(0,Object(Mt.inject)(Wi.a.IProofingEmitter)),Gi(1,Object(Mt.inject)(Wi.a.IHostEmitter)),Gi(2,Object(Mt.inject)(Wi.a.ITileCheckRequestBuilder)),Gi(3,Object(Mt.inject)(Wi.a.ICritiquesMessageEmitter)),Gi(4,Object(Mt.inject)(Wi.a.ILogger))],Yi);let Zi=class{constructor(e,t,i){this._hostEmitter=e,this._proofingStore=t,this._descriptorManager=i}async process(e){if(e.critique.traceId&&e.critique.typeId&&e.critique.textInContext){const t=e.critique.suggestions.map(e=>e.text)[e.eventId-4],i={appId:await this._proofingStore.read(tt.a.AppId),descriptors:await this._descriptorManager.buildDescriptors(),languageId:new it.a(await this._proofingStore.read(tt.a.ProofingLanguages)).defaultLanguageCode,traceId:e.critique.traceId,critiquePriority:e.critique.priority,critiqueTypeId:e.critique.typeId,eventId:e.eventId,flaggedText:e.critique.textInContext,suggestions:e.critique.suggestions.map(e=>e.text),suggestionText:t};return this._hostEmitter.emit(ot.a.instrumentationRequestV1,{address:void 0,message:i}),!0}return!1}};Zi=Hi([Object(Mt.injectable)(),Gi(0,Object(Mt.inject)(Wi.a.IHostEmitter)),Gi(1,Object(Mt.inject)(Wi.a.IProofingPersistedStore)),Gi(2,Object(Mt.inject)(Wi.a.IDescriptorManager))],Zi);let Qi=class{constructor(e,t,i){this._proofingStore=e,this._hostSettings=t,this._featureFlagsReader=i}async buildDescriptors(){let e;try{e=JSON.parse(await this._proofingStore.read(tt.a.Descriptors))}catch(t){e=JSON.parse(this._proofingStore.getDefaultValue(tt.a.Descriptors))}const t=this._proofingStore.getCachedEntry(tt.a.ProofingLanguages).storeEntryValue;let i="";if(this._featureFlagsReader.flags.enableAsyncSynonym&&this._featureFlagsReader.flags.enableMultiLanguageSupport&&t.length>1&&(i="DoNotAddSuggestionDescription;"),this._hostSettings.flightsToTrack&&this._hostSettings.flightsToTrack.length>0&&(i=`${i}${this._hostSettings.flightsToTrack.join(";")}`),""!==i){const t=e.find(e=>"FlightIds"===e.name);t?t.value=`${t.value};${i}`:e.push({name:"FlightIds",value:i})}return e}};Qi=Hi([Object(Mt.injectable)(),Gi(0,Object(Mt.inject)(Wi.a.IProofingPersistedStore)),Gi(1,Object(Mt.inject)(Wi.a.IHostSettings)),Gi(2,Object(Mt.inject)(Wi.a.IFeatureFlagsReader))],Qi);let en=class{format(e,t){const i={header:e,proofingLanguage:t};return JSON.stringify(i)}parse(e){if(e){const t=JSON.parse(e);if(t)return{tileId:t.header,languageCode:t.proofingLanguage}}return{tileId:e,languageCode:void 0}}};en=Hi([Object(Mt.injectable)()],en);let tn=class{constructor(e,t,i,n,r,a,o,s){this._userInfoStrategy=e,this._hostEmitter=t,this._editorService=i,this._settings=n,this._logger=r,this._featureFlagsReader=a,this._transfomer=o,this._hostSettings=s}async initialize(){this._hostEmitter.on(ot.a.tileCheckRequestV1,async e=>this.handleRequest(e))}async shutDown(){this._hostEmitter.off(ot.a.tileCheckRequestV1)}async handleRequest(e){let t;try{t=await this._userInfoStrategy.executeAsync(!1),this._editorService.xUserId=t?t.userId:void 0}catch(e){this._logger.error(589968384,"Get user info failed")}try{!function(e,t,i){if(e){for(const t of e)if("LicenseType"===t.name)return t.value}else e=[];let n=Ri.b.NoLicense;t?n=Ri.b.Subscription:i&&i.licenseType&&(n=i.licenseType),e.push({name:"LicenseType",value:n})}(e.message.descriptors,this._hostSettings.enhancedUpsellEnabled,t);const i=e.address,n=await this._editorService.postTileCheck(e.message),r=await this._transfomer.transform(n);!this._settings.emitRemoval||n.responseStatus!==Lt.c.ResponseStatus.Success&&n.responseStatus!==Lt.c.ResponseStatus.PartialSuccess||this._tryEmitClearTileCritiques(e,r),this._hostEmitter.emit(ot.a.tileCheckResponseV1,{address:i,message:r})}catch(e){this._logger.error(589968385,"Editor service call failed.")}return!1}_tryEmitClearTileCritiques(e,t){const i=e.address,n=e.message,r=new Set((n.content||[]).map(e=>{if(!this._featureFlagsReader.flags.enableMultiLanguageSupport)return e.tileId;const t=JSON.parse(e.tileId);return t.header?t.header:t}));if((t||[]).forEach(e=>{r.delete(JSON.stringify(e.tileId))}),r.size>0){const e=[];Array.from(r).forEach(t=>{try{const i={header:JSON.parse(t),data:"",proofingLanguages:[]};e.push(i)}catch(e){}}),this._hostEmitter.emit(ot.a.clearTileCritiques,{address:i,message:e})}}};tn=Hi([Object(Mt.injectable)(),Gi(0,Object(Mt.inject)(Wi.a.IUserInfoStrategy)),Gi(1,Object(Mt.inject)(Wi.a.IHostEmitter)),Gi(2,Object(Mt.inject)(Wi.a.EditorService)),Gi(3,Object(Mt.inject)(Wi.a.IOrchestratorSettings)),Gi(4,Object(Mt.inject)(Wi.a.ILogger)),Gi(5,Object(Mt.inject)(Wi.a.IFeatureFlagsReader)),Gi(6,Object(Mt.inject)(Wi.a.ITileCheckResponseTransformer)),Gi(7,Object(Mt.inject)(Wi.a.IHostSettings))],tn);var nn,rn=i(11863);let an=nn=class{constructor(e,t,i,n){this._tileIdFormatter=e,this._proofingPersistedStore=t,this._featureFlagsReader=i,this._settings=n,this.chineseAndJapaneseLanguageList=["ja-JP","zh-CN","zh-TW"],this.transform=e=>{if(!e||0===e.length)return[];if(!this._featureFlagsReader.flags.enableMultiLanguageSupport)return e.forEach(e=>e.suggestions=this.getSuggestionsWithLanguage(e)),e;const t=[],i=this.groupCritiquesByElementAndRestoreTileData(e);for(const e of i){const i=e[1],n=i.critiques.sort(this.compareCritiques);t.push(...this.findAndMergeOverlappingCritiques(n,i.detectedLanguages))}return t},this.groupCritiquesByElementAndRestoreTileData=e=>{const t=this._proofingPersistedStore.getCachedEntry(tt.a.ProofingLanguages).storeEntryValue,i=new Map,n=new Map;for(const r of e){const e=r,a=this._tileIdFormatter.parse(r.tileId);e.tileId=a.tileId,e.languageId=a.languageCode;const o=this.getTileElementId(a.tileId),{languageId:s,priority:c}=e,l=i.get(o);if(l){const t=n.get(o);l.critiques.push(e),this.setLanguageMapValueForCritique(t,s,c)}else{const r=this.initializeLanguagesMap(t,s,c);n.set(o,r),i.set(o,{critiques:[e],detectedLanguages:[]})}}for(const e of i.keys()){const t=i.get(e),r=n.get(e);t&&r&&(t.detectedLanguages=this.detectLanguages(r),t.critiques.forEach(e=>{e.languages=t.detectedLanguages}))}return i},this.detectLanguages=e=>{let t,i=[];for(const n of e){const e=n[0],r=n[1];void 0===t||t>r?(t=r,i=[e]):t===r&&i.push(e)}return i},this.findAndMergeOverlappingCritiques=(e,t)=>{let i=0,n=-1,r=0;const a=[];for(const o of e){const s=this.getValueOrZero(o.start);if(s===n||s<r)continue;n=s,r=s+this.getValueOrZero(o.length);const c=[];let l=b.b.High;for(let n=i;n<e.length;n+=1){i=n;const a=e[n],o=this.getValueOrZero(a.start);if(!(s<=o&&o<=r))break;{l=this.getTopPriority(l,a.priority),(a.priority===b.b.High||t.includes(a.languageId||""))&&c.push(a);const e=o+this.getValueOrZero(a.length);e>r&&(r=e)}}const u=this.decideWinner(c,l);u&&a.push(u)}return a},this.getTopPriority=(e,t)=>{const i=t||b.b.High;return i===b.b.Medium?b.b.Medium:i===b.b.Low&&e!==b.b.Medium?b.b.Low:e},this.decideWinner=(e,t)=>{if(0===e.length)return;const i=e.filter(e=>e.priority===t);if(0===i.length)return;const n=this._proofingPersistedStore.getCachedEntry(tt.a.ProofingLanguages).storeEntryValue;if(t===b.b.High)return this.getSpellingCritiqueWithMergedSuggestions(i,n);let r=i[0];if(i.length>1){const e=i.filter(e=>e.languageId===n[0]);e.length>0&&(r=e[0])}return r.suggestions=this.getSuggestionsWithLanguage(r),r},this.getSpellingCritiqueWithMergedSuggestions=(e,t)=>{let i;const n=e[0],r=[],a=new Map;let o=this._settings.maxSuggestionItemsDisplayNumber;for(const s of t){const t=e.filter(e=>e.languageId===s);if(this.chineseAndJapaneseLanguageList.includes(s)){if(nn.containsChineseOrJapaneseUnicode(Object(rn.c)(n.context,n.startInContext,n.length)))return;continue}if(!t||0===t.length)return;const c=t[0],l=c.suggestions,u=nn.isDeleteActionAvailable(c);u&&(n.supportedActions=1|(n.supportedActions||0));const d=this.processSuggestions(l,a,r,s,u,o);d.actionable.length>0?(r.length>0&&o===this._settings.maxSuggestionItemsDisplayNumber&&(o=this._settings.maxSuggestionDisplayPerLanguageNumber,r.splice(o),d.actionable.splice(o)),r.push(...d.actionable)):i||(i=d.nonActionable)}if(r.length>0){for(const e of r)e.languageIds=a.get(e.text);n.suggestions=this.sortSuggestionsByLanguages(r,t)}else n.suggestions=i?[i]:[];return n},this.processSuggestions=(e,t,i,n,r,a)=>{const o={actionable:[],nonActionable:void 0};if(!e)return o;for(let s=0;s<e.length;s+=1){const c=e[s];if(this.setLanguageToSuggestionMapEntry(t,c.text,n),s<a){nn.isSuggestionActionable(e[s])||r?i.every(e=>e.text!==c.text)&&o.actionable.push(c):o.nonActionable=e[s]}}return o},this.sortSuggestionsByLanguages=(e,t)=>e.sort((e,i)=>{if(!e.languageIds||!i.languageIds)return 0;const n=i.languageIds.length-e.languageIds.length;if(0!==n)return n;for(let n=0;n<e.languageIds.length;n+=1){const r=t.indexOf(e.languageIds[n])-t.indexOf(i.languageIds[n]);if(0!==r)return r}return 0}),this.getTileElementId=e=>{let t="";if(e)try{t=JSON.parse(e).elementId.id}catch(e){}return t},this.getSuggestionsWithLanguage=e=>{const t=e.suggestions&&e.suggestions.length>this._settings.maxSuggestionItemsDisplayNumber?e.suggestions.splice(0,this._settings.maxSuggestionItemsDisplayNumber):e.suggestions;if(t&&e.languageId)for(const i of t)i.languageIds=e.languageId?[e.languageId]:[];return t},this.initializeLanguagesMap=(e,t,i)=>{return new Map(e.map(e=>{return[e,i===b.b.High&&e===t?1:0]}))},this.setLanguageMapValueForCritique=(e,t,i)=>{if(e&&t&&i===b.b.High){const i=e.get(t)||0;e.set(t,i+1)}},this.compareCritiques=(e,t)=>{return this.getValueOrZero(e.start)-this.getValueOrZero(t.start)},this.getValueOrZero=e=>e||0,this.setLanguageToSuggestionMapEntry=(e,t,i)=>{const n=e.get(t);n?n.push(i):e.set(t,[i])}}static containsChineseOrJapaneseUnicode(e){return!!e&&/[\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f]/.test(e)}static isSuggestionActionable(e){return 1==(1&e.action)||2==(2&e.action)||4==(4&e.action)}static isDeleteActionAvailable(e){return void 0!==e.supportedActions&&1==(1&e.supportedActions)}};an=nn=Hi([Object(Mt.injectable)(),Gi(0,Object(Mt.inject)(Wi.a.ITileIdFormatter)),Gi(1,Object(Mt.inject)(Wi.a.IProofingPersistedStore)),Gi(2,Object(Mt.inject)(Wi.a.IFeatureFlagsReader)),Gi(3,Object(Mt.inject)(Wi.a.IHostSettings))],an);let on=class{constructor(e){this._featureFlagsReader=e,this.transform=e=>this._featureFlagsReader.flags.enableAutoCorrect&&e?(this._disableAutoCorrectForDifferentLanguageCritiques(e),e):e||[],this._disableAutoCorrectForDifferentLanguageCritiques=e=>{this._featureFlagsReader.flags.enableMultiLanguageSupport&&e.forEach(e=>{e.languages&&e.languages.includes(e.languageId||"")||(e=>{e.suggestions&&e.suggestions.forEach(e=>{Vi(e)})})(e)})}}};on=Hi([Object(Mt.injectable)(),Gi(0,Object(Mt.inject)(Wi.a.IFeatureFlagsReader))],on);let sn=class{constructor(e,t,i,n){this._userInfoStrategy=e,this._hostEmitter=t,this._editorService=i,this._logger=n}async initialize(){this._hostEmitter.on(ot.a.instrumentationRequestV1,async e=>this.handleRequest(e))}async shutDown(){this._hostEmitter.off(ot.a.instrumentationRequestV1)}async handleRequest(e){const t=this._logger.getNewActivity(Ki.InstrumentationCall,Vt.i.Measure);try{const i=await this._userInfoStrategy.executeAsync(!1);i&&(this._editorService.serverToServerId=JSON.stringify({puid:i.userId,identityProvider:i.identityProvider,tenantId:i.tenantId}));const n=await this._editorService.instrumentation(e.message);return t&&(e.message&&(t.addDataField({name:"EventID",value:e.message.eventId,dataType:Vt.d.Int64,classification:Vt.c.EssentialServiceMetadata}),t.addDataField({name:"CritiquePriority",value:e.message.critiquePriority,dataType:Vt.d.Int64,classification:Vt.c.EssentialServiceMetadata})),n&&200===n._response.status?t.setSuccess(!0):t.setSuccess(!1),t.endNow()),!0}catch(e){t&&(t.addDataField({name:"Instrumentation_Error_Response",value:JSON.stringify(e),dataType:Vt.d.String,classification:Vt.c.EssentialServiceMetadata}),t.setSuccess(!1),t.endNow())}return!1}};sn=Hi([Object(Mt.injectable)(),Gi(0,Object(Mt.inject)(Wi.a.IUserInfoStrategy)),Gi(1,Object(Mt.inject)(Wi.a.IHostEmitter)),Gi(2,Object(Mt.inject)(Wi.a.EditorService)),Gi(3,Object(Mt.inject)(Wi.a.ILogger))],sn);let cn=class{constructor(e,t,i,n,r){this._logger=e,this._multiLangTileCheckResponseTransformer=t,this._autoCorrectTransformer=i,this._synonymFiller=n,this._featureFlagsReader=r,this.convertSuggestions=e=>e?e.map(e=>({text:e.text,description:e.description,confidenceLevel:e.confidenceLevel||Lt.c.ConfidenceLevel.High,source:e.source||Lt.c.Source.None,action:e.action,bucketId:e.bucketId,numberOfInstances:e.numberOfInstances,languages:e.languageIds})):[]}async transform(e){this._logger.debug(571318788,"Transforming response");let t=this._multiLangTileCheckResponseTransformer.transform(e.critiques);return t=this._autoCorrectTransformer.transform(t),this._synonymFiller&&await this.fillSuggestionWithDescription(t),Promise.all(t.map(async e=>({tileId:this.convertTileHeader(e.tileId),traceId:e.traceId,categoryTitle:e.categoryTitle,explanationTitle:e.explanationTitle,explanation:e.explanation,supportedActions:e.supportedActions||0,suggestions:this.convertSuggestions(e.suggestions),start:e.start||0,length:e.length||0,priority:e.priority||b.b.High,typeId:e.typeId,textInContext:Object(rn.c)(e.context,e.startInContext,e.length),metadata:e.metadata})))}convertTileHeader(e){if(e)try{return JSON.parse(e)}catch(t){return void this._logger.logEvent(571318789,Xi.TileIdParseException,at.a.Error,`Parsing tile ID ${e} failed`,Vt.i.CriticalBusinessImpact)}}async fillSuggestionWithDescription(e){if(!this._featureFlagsReader.flags.enableAsyncSynonym||!this._featureFlagsReader.flags.enableMultiLanguageSupport)return;const t=e.reduce((e,t)=>(t.typeId!==b.a.ContextualSpelling&&t.typeId!==b.a.WrongSpelling||t.suggestions&&e.push(...t.suggestions),e),[]),i=new Map;for(const e of t){const t=e.languageIds;if(t&&0!==t.length){const n=t[0];n in i?i[n].push(e):i[n]=[e]}else;}await Promise.all(Object.entries(i).map(async([e,t])=>{await this._synonymFiller.fill(t,e)}))}};var ln;cn=Hi([Object(Mt.injectable)(),Gi(0,Object(Mt.inject)(Wi.a.ILogger)),Gi(1,Object(Mt.inject)(Wi.a.IMultiLangTileCheckResponseTransformer)),Gi(2,Object(Mt.inject)(Wi.a.IAutoCorrectTransformer)),Gi(3,Object(Mt.optional)()),Gi(3,Object(Mt.inject)(Wi.a.ISynonymFiller)),Gi(4,Object(Mt.inject)(Wi.a.IFeatureFlagsReader))],cn);let un=ln=class{constructor(e,t,i,n,r,a){this._userInfoStrategy=e,this._synonymService=t,this._logger=i,this._synonymRequestBuilder=n,this._featureFlagsReader=r,this._proofingStore=a}async fill(e,t){const i=this._proofingStore.getCachedEntry(tt.a.ProofingLanguages).storeEntryValue;if(!this._featureFlagsReader.flags.enableAsyncSynonym||!this._featureFlagsReader.flags.enableMultiLanguageSupport||i.length<=1)return;if(0===e.length)return;if(e.some(e=>!!e.description&&e.description.length>0))return;let n;try{n=await this._userInfoStrategy.executeAsync(!1)}catch(e){this._logger.error(587608863,"Get user info failed")}if(n&&n.licenseType&&n.licenseType===Ri.b.Subscription){this._synonymService.xUserId=n.userId;try{const i=await this._synonymRequestBuilder.buildValidRequest(e,t);if(!i)return;ln._addLicenseType(i,n);const r=await this._synonymService.postCheck(i);ln._processResponse(e,r.lookupResults)}catch(e){this._logger.error(587608864,"Synonym service call failed.")}}}static _processResponse(e,t){let i=0;for(const n of t){const t=[];for(const e of n.meanings){if(t.length>=ln.maxNumberOfSynonyms)break;t.includes(e.text)||t.push(e.text)}for(const e of n.meanings){if(t.length>=ln.maxNumberOfSynonyms)break;for(const i of e.synonyms){if(t.length>=ln.maxNumberOfSynonyms)break;t.includes(i.text)||t.push(i.text)}}e[i].description=t.join(", "),i+=1}}static _addLicenseType(e,t){if(e.descriptors){for(const t of e.descriptors)if("LicenseType"===t.name)return}else e.descriptors=[];let i=Ri.b.NoLicense;t&&t.licenseType&&(i=t.licenseType),e.descriptors.push({name:"LicenseType",value:i})}};var dn;un.maxNumberOfSynonyms=3,un=ln=Hi([Object(Mt.injectable)(),Gi(0,Object(Mt.inject)(Wi.a.IUserInfoStrategy)),Gi(1,Object(Mt.inject)(Wi.a.SynonymService)),Gi(2,Object(Mt.inject)(Wi.a.ILogger)),Gi(3,Object(Mt.inject)(Wi.a.ISynonymRequestBuilder)),Gi(4,Object(Mt.inject)(Wi.a.IFeatureFlagsReader)),Gi(5,Object(Mt.inject)(Wi.a.IProofingPersistedStore))],un);let hn=dn=class{constructor(e,t){this._proofingStore=e,this._descriptorManager=t}async buildValidRequest(e,t){return{appId:await this._proofingStore.read(tt.a.AppId),languageId:t,descriptors:await this._descriptorManager.buildDescriptors(),lookupWords:dn.buildLookupWords(e),mode:0}}static buildLookupWords(e){const t=[];return e&&e.forEach(e=>{t.push({word:e.text})}),t}};hn=dn=Hi([Object(Mt.injectable)(),Gi(0,Object(Mt.inject)(Wi.a.IProofingPersistedStore)),Gi(1,Object(Mt.inject)(Wi.a.IDescriptorManager))],hn);var gn=i(4329),fn=i(4737);let pn=class{constructor(e,t,i){this._proofingEmitter=e,this.hostSettings=t,this._roamingDictionaryFeature=i,this._ignoredWords=new Set,this.isWordIgnored=e=>{const t=e.trim();return!!this._ignoredWords.has(t)||!(!this._roamingDictionary||!this._roamingDictionary.testWord(t,!0))},this.clearIgnoredWords=()=>{this._ignoredWords.clear(),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:nt.a.RemoveData,data:wi.a.IgnoreListUpdate})},this.addWordToIgnoreList=e=>{if(e){const t=e.trim();if(this._ignoredWords.has(t))return;this._ignoredWords.add(t),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:nt.a.NewData,data:wi.a.IgnoreListUpdate})}},this.addWordToCustomDictionary=e=>{if(e){const t=e.trim();if(this._roamingDictionary&&this._roamingDictionaryFeature.isReady()){return!!this._roamingDictionary.addWord(t)&&(this._proofingEmitter.emit("wordDictionaryEvent",{messageType:nt.a.NewData,data:wi.a.CustomDictionaryUpdate}),!0)}}return!1}}async initialize(){if(this.hostSettings.enableRoamingDictionary){this._roamingDictionaryFeature.emitAndEvaluate({eventId:v.a.ClientInitialized,sender:v.b.WordDictionaryInit})&&(this._roamingDictionary=this._roamingDictionaryFeature.getRoamingDictionary())}}async shutDown(){}};pn=Object(gn.a)([Object(Mt.injectable)(),Object(gn.b)(0,Object(Mt.inject)(fn.a.IProofingEmitter)),Object(gn.b)(1,Object(Mt.inject)(qt.a.IHostSettings)),Object(gn.b)(2,Object(Mt.inject)(bi.a.IRoamingDictionaryFeature))],pn);var mn=i(18130);let bn=class{constructor(e){this.presentationSettings=e}validate(e){return e?e.slice(0,this.presentationSettings.maxServiceContentLengthInChars):""}};bn=Object(gn.a)([Object(Mt.injectable)(),Object(gn.b)(0,Object(Mt.inject)(fn.a.IPresentationSettings))],bn);let yn=class{constructor(e,t,i,n,r,a,o,s){this._hostEmitters=e,this._proofingEmitter=t,this._critiqueEventHandler=i,this._filteringEventHandler=n,this._nodeEventHandler=r,this._spanEventHandler=a,this._hostSettings=o,this._logger=s,this._listenersInitialized=!1,this.shutDown=()=>{this._logger.log(0,at.a.Info,"Shutting down EventHub."),this._listenersInitialized?(this._proofingEmitter.off("enabledCritiqueTypesChanged",this.onEnabledCritiqueTypesChangedEvent),this._proofingEmitter.off("wordDictionaryEvent",this.onWordDictionaryEvent),this._hostEmitters.forEach(e=>{e.off(ot.a.hostModelCritique,this.onHostModelCritiqueEvent),e.off(ot.a.hostModelDelta,this.onHostModelDeltaEvent),e.off(ot.a.hostModelTextTile,this.onHostModelTextTileEvent)}),this._listenersInitialized=!1):this._logger.log(0,at.a.Error,"Trying to delete event listeners in EventHub when they have already been deleted.")},this.onEnabledCritiqueTypesChangedEvent=e=>{if(!e)return void this._logger.log(587486303,at.a.Error,"Enabled CritiqueTypes message: Received undefined args.");if(e.messageType!==nt.a.ChangeData)return void this._logger.log(587486304,at.a.Warn,"Enabled CritiqueTypes message: Unexpected MessageType.");this._filteringEventHandler.onEvent({eventType:2})},this.onHostModelCritiqueEvent=e=>{if(!(e&&e.message&&e.message.data&&e.message.data.tileId))return void this._logger.log(589336976,at.a.Error,"IHostModelCritique message: Received undefined args.");const t=e.message.messageType;if(t===nt.a.ChangeData)return void this._logger.log(589169424,at.a.Warn,"IHostModelCritique message: Unexpected MessageType.");const i=e.message.data,n={annotationId:i.annotationId,critique:i.critique,eventType:t===nt.a.NewData?0:1,nodeId:i.tileId,nodeVersion:i.tileVersion};this._critiqueEventHandler.onEvent(n)},this.onHostModelDeltaEvent=e=>{if(!(e&&e.message&&e.message.delta&&e.message.tileId))return void this._logger.log(589336977,at.a.Error,"IHostModelDelta message: Received undefined args.");const t=e.message.delta,i=e.message.tileId,n=e.message.tileVersion,r={position:t.position,length:t.length,content:t.content,eventType:t.deltaType===st.TextTileDeltaType.Add?0:t.deltaType===st.TextTileDeltaType.Delete?1:2,nodeId:i,nodeVersion:n};this._spanEventHandler.onEvent(r)},this.onHostModelTextTileEvent=e=>{if(!(e&&e.message&&e.message.data&&e.message.data.tileId))return void this._logger.log(589336978,at.a.Error,"IHostModelTextTile message: Received undefined args.");const t=e.message.messageType;if(t===nt.a.ChangeData)return void this._logger.log(589169425,at.a.Warn,"IHostModelTextTile message: Unexpected MessageType.");const i=e.message.data,n=i.tileId,r=i.tileVersion,a={eventType:t===nt.a.NewData?0:1,nodeId:n,nodeVersion:r};this._nodeEventHandler.onEvent(a)},this.onWordDictionaryEvent=e=>{if(!e)return void this._logger.log(589336979,at.a.Error,"IWordDictionaryMessage message: Received undefined args.");const t=e.messageType;if(t===nt.a.ChangeData)return void this._logger.log(589169426,at.a.Warn,"IWordDictionaryMessage message: Unexpected MessageType.");const i={eventType:t===nt.a.NewData?0:1};this._filteringEventHandler.onEvent(i)}}async initialize(){this.initializeSynced()}initializeSynced(){this._logger.log(0,at.a.Info,"Initializing EventHub."),this._hostSettings.enableOrchestration&&(this._proofingEmitter.on("enabledCritiqueTypesChanged",this.onEnabledCritiqueTypesChangedEvent),this._proofingEmitter.on("wordDictionaryEvent",this.onWordDictionaryEvent),this._hostEmitters.forEach(e=>{e.on(ot.a.hostModelCritique,this.onHostModelCritiqueEvent),e.on(ot.a.hostModelDelta,this.onHostModelDeltaEvent),e.on(ot.a.hostModelTextTile,this.onHostModelTextTileEvent)}),this._listenersInitialized=!0)}};yn=Object(gn.a)([Object(Mt.injectable)(),Object(gn.b)(0,Object(Mt.multiInject)(fn.a.IHostEmitterArray)),Object(gn.b)(1,Object(Mt.inject)(fn.a.IProofingEmitter)),Object(gn.b)(2,Object(Mt.inject)(fn.a.CritiqueEventHandler)),Object(gn.b)(3,Object(Mt.inject)(fn.a.FilteringEventHandler)),Object(gn.b)(4,Object(Mt.inject)(fn.a.NodeEventHandler)),Object(gn.b)(5,Object(Mt.inject)(fn.a.SpanEventHandler)),Object(gn.b)(6,Object(Mt.inject)(fn.a.IHostSettings)),Object(gn.b)(7,Object(Mt.inject)(fn.a.ILogger))],yn);const vn=(e,t)=>{const i=[];return e?(e.some(e=>(i.push({action:e.suggestionActions||0,confidenceLevel:Lt.c.ConfidenceLevel.High,description:e.description,source:Lt.c.Source.None,text:e.text}),i.length===t)),i):i};let _n=class{constructor(e,t,i,n,r,a,o){this._critiqueStore=e,this._critiqueContextValidator=t,this._critiqueFilterer=i,this._logger=n,this._hostSettings=r,this._proofingPersistedStore=a,this._e2eMetric=o,this._websiteProvedOnce=!1}onEvent(e){if(!e)return void this._logger.log(589336982,at.a.Error,"CritiqueEventHandler: Received undefined event args.");const{annotationId:t,critique:i,nodeId:n,nodeVersion:r}=e;switch(e.eventType){case 0:this.onCritiqueAdded(i,t,n,r);break;case 1:this.onCritiqueRemoved(t,n)}}logWebsiteProvedOnce(){this._websiteProvedOnce||(this._websiteProvedOnce=!0,Pi(this._logger,this._proofingPersistedStore,this._hostSettings))}onCritiqueAdded(e,t,i,n){const r=this._critiqueStore.getCritiques(i);if(r){const a=((e,t,i,n,r=3)=>{if(e)return{annotationId:t,categoryTitle:e.categoryName,explanation:e.explanationBody,explanationTitle:e.explanationTitle,length:e.range?e.range.length:0,nodeId:i,nodeVersion:n,priority:e.priority,start:e.range?e.range.start:0,suggestions:vn(e.suggestions,r),supportedActions:e.critiqueActions||0,textInContext:e.context,traceId:e.id,typeId:e.typeId}})(e,t,i,n,this._hostSettings.maxSuggestionItemsDisplayNumber);if(a){const e=[];if(this._critiqueContextValidator.isValid(a)){const t=r.critiques;let o=!1;for(const i of t){const t=i[1];if(t&&Object(rn.b)(t,a)){if(Object(rn.a)(t,a)){t.annotationId=a.annotationId,e.push({critique:t,critiqueDiffType:2}),o=!0;break}e.push({critique:t,critiqueDiffType:4})}}o||(this._critiqueFilterer.applyFilters([a]),e.push({critique:a,critiqueDiffType:0}),this.logWebsiteProvedOnce()),this._critiqueStore.updateNode(e,i,n),this._e2eMetric.commitEntry(`${i}--${n}`)}}}}onCritiqueRemoved(e,t){const i=this._critiqueStore.getCritiques(t);if(i)for(const n of i.critiques){const r=n[1];if(r.annotationId===e){i.critiques.delete(r.start);const e={critique:r,critiqueDiffType:4};this._critiqueStore.updateNode([e],t,i.nodeVersion),this._e2eMetric.commitEntry(`${t}--${i.nodeVersion}`);break}}}};_n=Object(gn.a)([Object(Mt.injectable)(),Object(gn.b)(0,Object(Mt.inject)(fn.a.ICritiqueStore)),Object(gn.b)(1,Object(Mt.inject)(fn.a.ICritiqueContextValidator)),Object(gn.b)(2,Object(Mt.inject)(fn.a.ICritiqueFilterer)),Object(gn.b)(3,Object(Mt.inject)(fn.a.ILogger)),Object(gn.b)(4,Object(Mt.inject)(fn.a.IHostSettings)),Object(gn.b)(5,Object(Mt.inject)(fn.a.IProofingPersistedStore)),Object(gn.b)(6,Object(Mt.inject)(qt.a.IE2eMetric))],_n);let In=class{constructor(e,t){this._proofingDom=e,this._textExtractor=t}isValid(e){if(!e||!e.nodeId)return!1;const t=this._proofingDom.findTileNode(e.nodeId),i=null==t?void 0:t.element;if(Object(yt.a)(i,"HTMLElement")){const t=this._textExtractor.extractElementText(i),n=e.start,r=n+e.length;let a=e.textInContext;return a&&(a=a.replace(/\u00A0/g," ")),a===t.substring(n,r).replace(/\u00A0/g," ")}return!1}};In=Object(gn.a)([Object(Mt.injectable)(),Object(gn.b)(0,Object(Mt.inject)(fn.a.IProofingDom)),Object(gn.b)(1,Object(Mt.inject)(fn.a.ITextExtractor))],In);let Sn=class{constructor(e,t,i){this._critiqueStore=e,this._critiqueFilterer=t,this._logger=i}onEvent(e){e?this.filterCritiques():this._logger.log(588097543,at.a.Error,"FilteringEventHandler: Received undefined event args.")}filterCritiques(){const e=this._critiqueStore.getAllCritiques();e&&e.forEach(e=>{const t=this._critiqueFilterer.applyFilters(Array.from(e.critiques.values())).map(e=>({critique:e,critiqueDiffType:2}));t.length>0&&this._critiqueStore.updateNode(t,e.nodeId,e.nodeVersion)})}};Sn=Object(gn.a)([Object(Mt.injectable)(),Object(gn.b)(0,Object(Mt.inject)(fn.a.ICritiqueStore)),Object(gn.b)(1,Object(Mt.inject)(fn.a.ICritiqueFilterer)),Object(gn.b)(2,Object(Mt.inject)(fn.a.ILogger))],Sn);let Cn=class{constructor(e,t){this._proofingDom=e,this._proofingEmitter=t}dispatchCritiques(e,t,i=(()=>{}),n=nt.a.NewData){const r=this._proofingDom.findTileNode(t);r&&this._proofingEmitter.emit("squiggleDataEvent",{messageType:n,data:{critiquesToElementsMap:[{elementId:t,element:r.element,critiques:e}],actionCallback:i}})}};Cn=Object(gn.a)([Object(Mt.injectable)(),Object(gn.b)(0,Object(Mt.inject)(fn.a.IProofingDom)),Object(gn.b)(1,Object(Mt.inject)(fn.a.IProofingEmitter))],Cn);let En=class{constructor(e,t,i,n){this._critiqueDispatcher=e,this._hostSettings=t,this._logger=i,this._upsellStore=n,this._critiquesByNode=new Map,this._latestNodeVersion=new Map,this.actionCallback=(e,t,i)=>{if(i)switch(e){case mi.a.IgnoreOnce:case mi.a.ApplySuggestion:case mi.a.DisableCritiqueType:this.removeCritique(t,i);break;default:this._logger.log(571318625,at.a.Error,"CritiqueStore: Received unexpected actionType.")}},this.dispatchCritiquesForNode=(e,t)=>{const i=this.getCritiquesToDispatch(e);this._critiqueDispatcher.dispatchCritiques(i,t,this.actionCallback)},this.getCritiquesToDispatch=e=>{const t=new Map;return e.forEach((e,i)=>{e.isVisible&&t.set(i,e)}),t},this.removeCritique=(e,t)=>{const i=this._critiquesByNode.get(t)||new Map,n=i.get(e);i.delete(e)&&(this._upsellStore.removePremiumCritique(n),this.dispatchCritiquesForNode(i,t))}}clearNode(e){let t=!1;const i=this._critiquesByNode.get(e);i&&(this._critiquesByNode.delete(e),i.forEach(e=>{this._upsellStore.removePremiumCritique(e)}),this._latestNodeVersion.has(e)&&this._latestNodeVersion.delete(e),t=!0),t&&this._critiqueDispatcher.dispatchCritiques(new Map,e,()=>{})}getAllCritiques(){const e=[];return this._critiquesByNode.forEach((t,i)=>{const n=this.getCritiques(i);n&&e.push(n)}),e}getCritiques(e){const t=this._critiquesByNode.get(e);if(t){return{critiques:t,nodeId:e,nodeVersion:this._latestNodeVersion.get(e)||0}}}updateNode(e,t,i){i>=(this._latestNodeVersion.get(t)||0)&&this._latestNodeVersion.set(t,i);const n=this._critiquesByNode.get(t);if(n){(this._hostSettings.enableDispatchCritiquesOnEmptyDiffs||e.length>0)&&(e.forEach(e=>{switch(e.critiqueDiffType){case 0:case 2:n.set(e.critique.start,e.critique);break;case 4:n.delete(e.critique.start),this._upsellStore.removePremiumCritique(e.critique);break;case 1:e.oldStart&&n.delete(e.oldStart),n.set(e.critique.start,e.critique)}}),this.dispatchCritiquesForNode(n,t))}else this._critiquesByNode.set(t,new Map)}};En=Object(gn.a)([Object(Mt.injectable)(),Object(gn.b)(0,Object(Mt.inject)(fn.a.ICritiqueDispatcher)),Object(gn.b)(1,Object(Mt.inject)(fn.a.IHostSettings)),Object(gn.b)(2,Object(Mt.inject)(fn.a.ILogger)),Object(gn.b)(3,Object(Mt.inject)(fn.a.IUpsellStore))],En);let Tn=class{constructor(e,t){this._critiqueStore=e,this._logger=t}onEvent(e){if(e)switch(e.eventType){case 0:this._critiqueStore.updateNode([],e.nodeId,e.nodeVersion);break;case 1:this._critiqueStore.clearNode(e.nodeId)}else this._logger.log(589336981,at.a.Error,"NodeEventHandler: Received undefined event args.")}};Tn=Object(gn.a)([Object(Mt.injectable)(),Object(gn.b)(0,Object(Mt.inject)(fn.a.ICritiqueStore)),Object(gn.b)(1,Object(Mt.inject)(fn.a.ILogger))],Tn);var On=i(11864);let wn=class{constructor(e,t){this._critiqueStore=e,this._logger=t,this.calcLengths=e=>{let t=e.length||0,i=0;switch(e.eventType){case 0:t=e.content?e.content.length:t,i=t;break;case 1:i=-t;break;case 2:i=e.content?e.content.length-t:i}return{length:t,lengthDiff:i}},this.deletedDiff=(e,t,i,n=!1)=>{const r={offset:e.start,span:e.length},a={offset:t,span:i};if(Object(On.b)(r,a)||n&&Object(On.a)(r,a))return{critique:e,critiqueDiffType:4}}}onEvent(e){if(!e)return void this._logger.log(589336980,at.a.Error,"SpanEventHandler: Received undefined event args.");const t=this._critiqueStore.getCritiques(e.nodeId);if(t&&function(e,t){return e.critiques&&t>=e.nodeVersion}(t,e.nodeVersion)){const{length:i,lengthDiff:n}=this.calcLengths(e),r=[];t.critiques.forEach(t=>{const a=this.deletedDiff(t,e.position,i,2!==e.eventType);if(a)r.push(a);else if(t.start>=e.position&&0!==n){const e=t.start;t.start+=n,r.push({critique:t,critiqueDiffType:1,oldStart:e})}}),this._critiqueStore.updateNode(r,e.nodeId,e.nodeVersion)}}};wn=Object(gn.a)([Object(Mt.injectable)(),Object(gn.b)(0,Object(Mt.inject)(fn.a.ICritiqueStore)),Object(gn.b)(1,Object(Mt.inject)(fn.a.ILogger))],wn);var jn=i(8493),Pn=i(11839),xn=i(11840),Dn=i(11844),Nn=i(11845),An=i(11846),Rn=i(11847),kn=i(11848),Fn=i(11849),Ln=i(11850),Mn=i(11851),qn=i(11852),Bn=i(11853),Un=i(11854),Wn=i(8632);const Hn={serializedName:"Descriptor",type:{name:"Composite",className:"Descriptor",modelProperties:{name:{required:!0,serializedName:"Name",type:{name:"String"}},value:{required:!0,serializedName:"Value",type:{name:"String"}}}}},Gn={serializedName:"LookupWords",type:{name:"Composite",className:"LookupWords",modelProperties:{word:{required:!0,serializedName:"Word",defaultValue:"test",type:{name:"String"}},preContextText:{serializedName:"PreContextText",defaultValue:"",type:{name:"String"}},postContextText:{serializedName:"PostContextText",defaultValue:"",type:{name:"String"}}}}},Vn={serializedName:"LookupInput",type:{name:"Composite",className:"LookupInput",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},appVersion:{serializedName:"AppVersion",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},lookupWords:{required:!0,serializedName:"LookupWords",type:{name:"Sequence",element:{type:{name:"Composite",className:"LookupWords"}}}},mode:{required:!0,serializedName:"Mode",defaultValue:2,type:{name:"Number"}}}}},zn={serializedName:"Synonym",type:{name:"Composite",className:"Synonym",modelProperties:{text:{required:!0,serializedName:"Text",defaultValue:"",type:{name:"String"}},tag:{serializedName:"Tag",defaultValue:"",type:{name:"String"}},tagInt:{serializedName:"TagInt",defaultValue:0,type:{name:"Number"}}}}},$n={serializedName:"Meaning",type:{name:"Composite",className:"Meaning",modelProperties:{text:{required:!0,serializedName:"Text",defaultValue:"",type:{name:"String"}},tag:{serializedName:"Tag",defaultValue:"",type:{name:"String"}},tagInt:{serializedName:"TagInt",defaultValue:0,type:{name:"Number"}},synonyms:{required:!0,serializedName:"Synonyms",type:{name:"Sequence",element:{type:{name:"Composite",className:"Synonym"}}}}}}},Jn={serializedName:"LookupResult",type:{name:"Composite",className:"LookupResult",modelProperties:{word:{required:!0,serializedName:"Word",defaultValue:"",type:{name:"String"}},meanings:{required:!0,serializedName:"Meanings",type:{name:"Sequence",element:{type:{name:"Composite",className:"Meaning"}}}}}}},Kn={serializedName:"LookupOutput",type:{name:"Composite",className:"LookupOutput",modelProperties:{lookupResults:{required:!0,serializedName:"LookupResults",type:{name:"Sequence",element:{type:{name:"Composite",className:"LookupResult"}}}}}}},Xn={serializedName:"CommonAppIdProperty",type:{name:"Composite",className:"CommonAppIdProperty",modelProperties:{appId:{serializedName:"AppId",type:{name:"String"}}}}},Yn={serializedName:"CommonLanguageIdProperty",type:{name:"Composite",className:"CommonLanguageIdProperty",modelProperties:{languageId:{serializedName:"LanguageId",type:{name:"String"}}}}},Zn={serializedName:"CommonAppVersionProperty",type:{name:"Composite",className:"CommonAppVersionProperty",modelProperties:{appVersion:{serializedName:"AppVersion",type:{name:"String"}}}}},Qn={serializedName:"CommonDescriptorsProperty",type:{name:"Composite",className:"CommonDescriptorsProperty",modelProperties:{descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}}}}},er={serializedName:"postcheck-headers",type:{name:"Composite",className:"PostCheckHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}};var tr=i(18247),ir=i(17900);const nr="@editor/synonym-client-rest-api",rr="1.0.0";class ar extends tr.a{constructor(e){if(e||(e={}),!e.userAgent){const t=ir.b();e.userAgent=`${nr}/${rr} ${t}`}super(void 0,e),this.baseUri=e.baseUri||this.baseUri||"https://nlsynonymservice.osi.officeppe.net/",this.requestContentType="application/json; charset=utf-8",null!==e.xCorrelationId&&void 0!==e.xCorrelationId&&(this.xCorrelationId=e.xCorrelationId),null!==e.xUserSessionId&&void 0!==e.xUserSessionId&&(this.xUserSessionId=e.xUserSessionId),null!==e.xUserId&&void 0!==e.xUserId&&(this.xUserId=e.xUserId)}}class or extends ar{constructor(e){super(e)}postCheck(e,t,i){return this.sendOperationRequest({body:e,options:t},cr,i)}}const sr=new Wn.b(n),cr={httpMethod:"POST",path:"NLSynonym/Lookup/V1",headerParameters:[{parameterPath:"xCorrelationId",mapper:{serializedName:"X-CorrelationId",type:{name:"Uuid"}}},{parameterPath:"xUserSessionId",mapper:{serializedName:"X-UserSessionId",type:{name:"Uuid"}}},{parameterPath:"xUserId",mapper:{serializedName:"X-UserId",type:{name:"String"}}}],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},Vn),{required:!0})},responses:{200:{bodyMapper:Kn,headersMapper:er},400:{headersMapper:er},500:{headersMapper:er},default:{}},serializer:sr};var lr,ur,dr=new(function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}());function hr(e,t,i){dr.fireEvent({level:e,category:t,message:i})}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(lr||(lr={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}(ur||(ur={}));var gr,fr,pr,mr,br,yr=i(18109),vr=i(9862),_r=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ir=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _r(t,e),t.prototype.initialize=function(t,i){this._postChannel=new vr.a;var n=[];i&&(n=n.concat(i)),t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=t.channelConfiguration?t.channelConfiguration:{};try{e.prototype.initialize.call(this,t,n)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,i=t/2,n={};n.OTelCustomTransmissionProfile=[t,i],this._postChannel._loadTransmitProfiles(n),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.connectNotificationListener=function(e){e&&this.addNotificationListener(e)},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(yr.a);!function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(gr||(gr={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(fr||(fr={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(pr||(pr={})),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(mr||(mr={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(br||(br={}));var Sr,Cr,Er=function(){function e(){this._fullEventsEnabled=!1}return e.prototype.processEvent=function(e){if(!this._fullEventsEnabled&&!e.eventFlags)throw new Error(e.eventName+" missing Event Flags");var t=this._fullEventsEnabled||!!e.eventFlags&&(e.eventFlags.diagnosticLevel===br.BasicEvent||e.eventFlags.diagnosticLevel===br.NecessaryServiceDataEvent||e.eventFlags.diagnosticLevel===br.AlwaysOnNecessaryServiceDataEvent);return t||hr(lr.Info,ur.Sink,(function(){return"1DS Data Classification Failed to Send: "+e.eventName})),t},e.prototype.setFullEventsEnabled=function(e){this._fullEventsEnabled=e},e}(),Tr=i(8296),Or=i(11744);!function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(Sr||(Sr={})),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Guid=4]="Guid"}(Cr||(Cr={}));var wr="Data.",jr="zC.",Pr="f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405";function xr(e){return e?new Date(e):new Date}function Dr(e,t,i){t&&t.forEach((function(t){if(!t.classification||t.classification===Sr.SystemMetadata||t.classification===Sr.EssentialServiceMetadata){var n,r;switch(n=i?t.name.substr(0,3)===jr?jr+wr+t.name.substr(3):wr+t.name:t.name,t.dataType){case Cr.Double:r=Tr.b.Double;break;case Cr.Int64:r=Tr.b.Int64;break;case Cr.Guid:r=Tr.b.Guid;break;case Cr.String:return void(e[n]="string"==typeof t.value?t.value.substr(0,25e3):t.value);case Cr.Boolean:default:return void(e[n]=t.value)}var a={value:t.value,propertyType:r};e[n]=a}}))}var Nr,Ar=i(10555),Rr=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),kr=function(){return(kr=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Fr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="PartAPlugin",t.priority=3,t._properties={},t}return Rr(t,e),t.prototype.initialize=function(t,i,n){e.prototype.initialize.call(this,t,i,n)},t.prototype.processTelemetry=function(e,t){e.data=kr(kr({},e.data),this._properties);var i=this._getTelCtx(t);this.processNext(e,i)},t.prototype.addDataFields=function(e){Dr(this._properties,e,!1)},t}(Ar.a),Lr=i(16437);(Nr||(Nr={})).newGuid=function(){return Object(Lr.v4)()};var Mr,qr=function(){function e(e,t,i){this.start=Date.now(),this.name=e,this.isAsync=!0===i,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),Br=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,i){return"HttpManager:_sendBatches"===e||"HttpManager:_sendBatchesNotification"===e?new qr(e,t,i):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case"HttpManager:_sendBatches":this.handleSendBatches(e);break;case"HttpManager:_sendBatchesNotification":this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var t=e.payload();if(t.batches&&t.reason&&t.reason>=1e3&&t.reason<=1999){var i=0;for(var n in t.batches)i+=t.batches[n].evts.length;this._callbacks.requestProcessingStats(0,i)}}},e}(),Ur=function(){function e(e,t){if(this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this._persistentDataFields=[],this._preprocessors=[],this._partADataFieldsPlugin=new Fr,t.trackOverride)this._trackOverride=t.trackOverride;else{if(!t||!t.endpointUrl)throw new Error("Missing Endpoint Url");var i=[this._partADataFieldsPlugin];t.plugins&&i.push.apply(i,t.plugins);var n={instrumentationKey:Pr,endpointUrl:t.endpointUrl,channelConfiguration:{eventsLimitInMem:t.eventsLimitInMem,httpXHROverride:t.httpXHROverride,setTimeoutOverride:t.setTimeoutOverride,clearTimeoutOverride:t.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0},disableCookiesUsage:!0};t.stats&&t.stats.networkStats&&n.channelConfiguration&&(n.channelConfiguration.payloadListener=function(e,i){var n,r=i||e;r.data&&(null===(n=t.stats)||void 0===n||n.networkStats(r.data.length))}),this._applicationInsights=new Ir,this._applicationInsights.initialize(n,i),this._applicationInsights.setUploadFrequency(t.uploadFrequency),this._applicationInsights.connectNotificationListener(t.notificationListener),t.stats&&this._applicationInsights.setPerfMgr(new Br(t.stats)),t.disableStatsTracking||this.hookUp1DSNotifications(this._applicationInsights)}this._oneDSSinkSessionId=Nr.newGuid(),this._epoch=(new Date).getTime().toString(),this._dataClassificationChecker=new Er,this.addPreprocessor(this._dataClassificationChecker),this.setPersistentDataFields(e)}return e.prototype.sendTelemetryEvent=function(e,t){var i,n,r=(n={eventName:(i=e).eventName,eventFlags:i.eventFlags},i.telemetryProperties&&(n.telemetryProperties={ariaTenantToken:i.telemetryProperties.ariaTenantToken,nexusTenantToken:i.telemetryProperties.nexusTenantToken}),i.eventContract&&(n.eventContract={name:i.eventContract.name,dataFields:i.eventContract.dataFields.slice()}),n.dataFields=i.dataFields?i.dataFields.slice():[],n);try{for(var a=0;a<this._preprocessors.length;a++)if(!this._preprocessors[a].processEvent(r))return;this.sendEventInternal(r,t)}catch(e){!function(e,t,i){hr(lr.Error,e,(function(){var e=i instanceof Error?i.message:"";return t+": "+e}))}(ur.Sink,"1DS Sink",e)}},e.prototype.getPersistentDataFields=function(){return this._persistentDataFields},e.prototype.setPersistentDataFields=function(e){this._partADataFieldsPlugin.addDataFields(e),this._persistentDataFields=e},e.prototype.addPreprocessor=function(e){this._preprocessors.push(e)},e.prototype.setFullEventsEnabled=function(e){this._dataClassificationChecker.setFullEventsEnabled(e)},e.prototype.sendEventInternal=function(e,t){var i;if(this.eventsProcessed++,!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");var n,r,a=(n={telemetryEvent:e,oneDSSinkSessionId:this._oneDSSinkSessionId,eventSequence:this.eventsProcessed,timestamp:t},Dr(r={},n.telemetryEvent.dataFields,!0),r["Event.Sequence"]={value:n.eventSequence,propertyType:Tr.b.Int64},r["Event.Name"]=n.telemetryEvent.eventName,r["Event.Source"]="OTelJS",r["Event.Time"]={value:Object(Or.f)(xr(n.timestamp)),propertyType:Tr.b.DateTime},n.oneDSSinkSessionId&&(r["Event.Id"]=n.oneDSSinkSessionId+"."+n.eventSequence),n.telemetryEvent.eventContract&&(r["Event.Contract"]=n.telemetryEvent.eventContract.name,Dr(r,n.telemetryEvent.eventContract.dataFields,!1)),r),o={iKey:e.telemetryProperties.ariaTenantToken,name:e.eventName,data:a,time:(new Date).toISOString(),baseType:"EventData",ext:{sdk:{seq:this.eventsProcessed,epoch:this._epoch}}};this._trackOverride?(null===(i=this._partADataFieldsPlugin)||void 0===i||i.processTelemetry(o),this._trackOverride(o)):this._applicationInsights&&this._applicationInsights.track(o)},e.prototype.hookUp1DSNotifications=function(e){var t=this;e.addNotificationListener({eventsSent:function(e){hr(lr.Info,ur.Transport,(function(){return"Successfully sent "+e.length+" event(s)"})),hr(lr.Verbose,ur.Transport,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),t.eventsSent+=e.length},eventsDiscarded:function(e,i){hr(lr.Error,ur.Transport,(function(){return"Discarded "+e.length+" event(s) because "+i})),hr(lr.Verbose,ur.Transport,(function(){return"Discarded event(s) details : "+JSON.stringify(e,null,2)})),t.eventsDiscarded+=e.length}})},e.prototype.flush=function(e){this._applicationInsights&&this._applicationInsights.flush(e)},e.prototype.shutdown=function(){if(this._applicationInsights)try{this._applicationInsights.shutdown()}catch(e){hr(lr.Error,ur.Transport,(function(){return"An error occurred on shutdown"}))}},e}();!function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/"}(Mr||(Mr={}));var Wr=i(16425),Hr=i(4127),Gr=i(11867),Vr=i(4478);let zr=class extends Gr.a{constructor(e){super(),this._hostSettings=e}update(e){this._updatedUserInfo=e}execute(e=!0,t){this._updatedUserInfo?this.userInfo=this._updatedUserInfo:this._hostSettings.userId&&(this.userInfo={userId:this._hostSettings.userId.puid,tenantId:this._hostSettings.userId.tenantId,email:void 0,licenseType:this._hostSettings.licenseType,identityProvider:this._hostSettings.userId.identityProvider}),this.triggerCallback(t)}};zr=Object(Hr.a)([Object(Mt.injectable)(),Object(Hr.c)(0,Object(Mt.inject)(Vr.a.IHostSettings)),Object(Hr.b)("design:paramtypes",[Object])],zr);var $r=i(11826),Jr=i(10033);let Kr=class{constructor(e,t,i,n,r){this._guidGenerator=e,this._registrar=t,this._proofingPersistedStore=i,this._logger=n,this._featureFlagsReader=r}async initializeComponent(){this._featureFlagsReader.refreshFlags(),await this._logger.initialize(this._proofingPersistedStore),this._logger.debug(575930400,"Logger initialized"),$r.a.addUnhandledExceptionsListeners(this._logger,Jr.a.UnhandledContentError,"Unhandled async content script error"),this._logger.debug(575930401,"Initializing telemetry");const e=this._guidGenerator.generate();this._logger.addCorrelationID(e),this._logger.debug(575930402,"Registering listeners"),await this._registrar.initialize()}};Kr=Object(Hr.a)([Object(Mt.injectable)(),Object(Hr.c)(0,Object(Mt.inject)(Vr.a.IGuidGenerator)),Object(Hr.c)(1,Object(Mt.inject)(Vr.a.IRegistrar)),Object(Hr.c)(2,Object(Mt.inject)(Vr.a.IProofingPersistedStore)),Object(Hr.c)(3,Object(Mt.inject)(Vr.a.ILogger)),Object(Hr.c)(4,Object(Mt.inject)(Vr.a.IFeatureFlagsReader)),Object(Hr.b)("design:paramtypes",[Object,Object,Object,Object,Object])],Kr);let Xr=class{constructor(e,t){this._proofingEmitter=e,this._localizationFileImporter=t}getMessage(e,t){return this._strings&&this._strings[e]?this._strings[e].message:""}async initialize(){this._proofingEmitter.on("proofingLanguageChanged",async e=>{this._strings=await this._localizationFileImporter.importStrings(e.data.defaultLanguageCode)})}async shutDown(){this._proofingEmitter.off("proofingLanguageChanged")}};var Yr;Xr=Object(Hr.a)([Object(Mt.injectable)(),Object(Hr.c)(0,Object(Mt.inject)(Vr.a.IProofingEmitter)),Object(Hr.c)(1,Object(Mt.inject)(Vr.a.ILocalizationStringsImporter)),Object(Hr.b)("design:paramtypes",[Object,Object])],Xr),function(e){e.ImportLocalizationStringsFailed="ImportLocalizationStringsFailed",e.ImportLocalizationMappingStringsFailed="ImportLocalizationMappingStringsFailed"}(Yr||(Yr={}));let Zr=class{constructor(e){this.logger=e}async importStrings(e){const t=await i.e(1472).then(i.t.bind(null,18147,3)).then(async e=>e.cultures).catch(()=>{this.logger.logEvent(589312539,Yr.ImportLocalizationMappingStringsFailed,at.a.Error,e,Vt.i.CriticalExperimentation)});let n=t&&t[e];return n||(n="en"),i(16445)(`./${n}/messages.json`).then(e=>e).catch(()=>{this.logger.logEvent(589312540,Yr.ImportLocalizationStringsFailed,at.a.Error,e,Vt.i.CriticalExperimentation)})}};Zr=Object(Hr.a)([Object(Mt.injectable)(),Object(Hr.c)(0,Object(Mt.inject)(Vr.a.ILogger)),Object(Hr.b)("design:paramtypes",[Object])],Zr);var Qr,ea=i(7592);let ta=Qr=class extends jn.a{constructor(e,t,i,n){super(e,t),this.storeEntryReader=e,this.storeEntryWriter=t,this._emitter=i,this._hostSettings=n,this.write(tt.a.AppId,this._hostSettings.appId)}populateStoreEntryMap(){const e=new Map;return e.set(tt.a.AppId,{storeEntry:Object(ea.d)(tt.a.AppId,"EditorBX_Online")}),e.set(tt.a.EnableSpelling,{storeEntry:Object(ea.d)(tt.a.EnableSpelling,!0),isSynced:!0}),e.set(tt.a.EnableGrammar,{storeEntry:Object(ea.d)(tt.a.EnableGrammar,!0),isSynced:!0}),e.set(tt.a.EnableRefinements,{storeEntry:Object(ea.d)(tt.a.EnableRefinements,!0),isSynced:!0}),e.set(tt.a.Descriptors,{storeEntry:Object(ea.d)(tt.a.Descriptors,JSON.stringify([{name:"FlightIds",value:"Wac-WordEditorServiceSuggestionDescriptionsNoReferenceInformation-Treatment;Wac-WordEditorServiceMultipleGrammarCritiquesPerSentence-Treatment"}]))}),e.set(tt.a.ProofingLanguages,{storeEntry:Object(ea.d)(tt.a.ProofingLanguages,["en-US"])}),e.set(tt.a.DefaultProofingLanguageInitialized,{storeEntry:Object(ea.d)(tt.a.DefaultProofingLanguageInitialized,!1)}),e.set(tt.a.ProofingLanguageListInitialized,{storeEntry:Object(ea.d)(tt.a.ProofingLanguageListInitialized,!1)}),e.set(tt.a.EnableEditor,{storeEntry:Object(ea.d)(tt.a.EnableEditor,!0)}),e.set(tt.a.OverriddenCritiqueTypeOptions,{storeEntry:Object(ea.d)(tt.a.OverriddenCritiqueTypeOptions,[])}),e.set(tt.a.ShowSynonyms,{storeEntry:Object(ea.d)(tt.a.ShowSynonyms,!1)}),e.set(tt.a.TelemetryTenant,{storeEntry:Object(ea.b)(tt.a.TelemetryTenant,JSON.stringify({tenantName:"NaturalLanguage",ariaTenantToken:Qr.ARIA_TENANT_UUID,nexusTenantToken:1733}))}),e.set(tt.a.LogGroupName,{storeEntry:Object(ea.b)(tt.a.LogGroupName,"EditorBx")}),e.set(tt.a.SendToAria,{storeEntry:Object(ea.b)(tt.a.SendToAria,!0)}),e.set(tt.a.DefaultEventName,{storeEntry:Object(ea.b)(tt.a.DefaultEventName,Jr.b.Diagnostics)}),e.set(tt.a.DefaultLoggingLevel,{storeEntry:Object(ea.c)(tt.a.DefaultLoggingLevel,at.a.Info)}),e.set(tt.a.EnableTelemetry,{storeEntry:Object(ea.d)(tt.a.EnableTelemetry,!0),isSynced:!0}),e.set(tt.a.DebugMode,{storeEntry:Object(ea.c)(tt.a.DebugMode,!1)}),e.set(tt.a.ConfigurationId,{storeEntry:Object(ea.b)(tt.a.ConfigurationId,"")}),e.set(tt.a.ClientId,{storeEntry:Object(ea.d)(tt.a.ClientId,""),isSynced:!1}),e}async initialize(){await this.read(tt.a.EnableSpelling),await this.read(tt.a.EnableGrammar),await this.read(tt.a.EnableRefinements),await this.read(tt.a.EnableTelemetry),await this.read(tt.a.ConfigurationId),this._emitter.on(tt.a.EnableSpelling,async()=>{await this.read(tt.a.EnableSpelling)}),this._emitter.on(tt.a.EnableGrammar,async()=>{await this.read(tt.a.EnableGrammar)}),this._emitter.on(tt.a.EnableRefinements,async()=>{await this.read(tt.a.EnableRefinements)}),this._emitter.on(tt.a.EnableTelemetry,async()=>{await this.read(tt.a.EnableTelemetry)}),this._emitter.on(tt.a.ConfigurationId,async()=>{await this.read(tt.a.ConfigurationId)}),this._emitter.on(tt.a.OverriddenCritiqueTypeOptions,async()=>{await this.read(tt.a.OverriddenCritiqueTypeOptions)}),this._emitter.on(tt.a.ProofingLanguages,async()=>{await this.read(tt.a.ProofingLanguages)})}async shutDown(){this._emitter.off(tt.a.EnableSpelling),this._emitter.off(tt.a.EnableGrammar),this._emitter.off(tt.a.EnableRefinements),this._emitter.off(tt.a.EnableTelemetry),this._emitter.off(tt.a.ConfigurationId),this._emitter.off(tt.a.OverriddenCritiqueTypeOptions),this._emitter.off(tt.a.ProofingLanguages)}};ta.ARIA_TENANT_UUID="71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",ta=Qr=Object(Hr.a)([Object(Mt.injectable)(),Object(Hr.c)(0,Object(Mt.inject)(Vr.a.IStoreEntryReader)),Object(Hr.c)(1,Object(Mt.inject)(Vr.a.IStoreEntryWriter)),Object(Hr.c)(2,Object(Mt.inject)(Vr.a.ISettingsEmitter)),Object(Hr.c)(3,Object(Mt.inject)(Vr.a.IHostSettings)),Object(Hr.b)("design:paramtypes",[Object,Object,Object,Object])],ta);let ia=class extends jn.a{constructor(e,t,i){super(e,t),this.storeEntryReader=e,this.storeEntryWriter=t,this._emitter=i}populateStoreEntryMap(){const e=new Map;return e.set(Xt.CourtesyAttributes,{storeEntry:Object(ea.b)(Xt.CourtesyAttributes,["data-gramm"]),isSynced:!1}),e.set(Xt.RootContentMaxLengthInChars,{storeEntry:Object(ea.b)(Xt.RootContentMaxLengthInChars,500),isSynced:!1}),e}async initialize(){await this.read(Xt.CourtesyAttributes),await this.read(Xt.RootContentMaxLengthInChars),this._emitter.on(Xt.CourtesyAttributes,async()=>{await this.read(Xt.CourtesyAttributes)}),this._emitter.on(Xt.RootContentMaxLengthInChars,async()=>{await this.read(Xt.RootContentMaxLengthInChars)})}async shutDown(){this._emitter.off(Xt.RootContentMaxLengthInChars),this._emitter.off(Xt.CourtesyAttributes)}};ia=Object(Hr.a)([Object(Mt.injectable)(),Object(Hr.c)(0,Object(Mt.inject)(Vr.a.IStoreEntryReader)),Object(Hr.c)(1,Object(Mt.inject)(Vr.a.IStoreEntryWriter)),Object(Hr.c)(2,Object(Mt.inject)(Vr.a.ISettingsEmitter)),Object(Hr.b)("design:paramtypes",[Object,Object,Object])],ia);let na=class{constructor(e){this._container=e,this._initialized=!1}initializeComponent(){this._initialized||(Promise.all([i.e(30),i.e(33),i.e(35),i.e(36),i.e(39),i.e(44),i.e(74),i.e(162),i.e(1353)]).then(i.bind(null,18166)).then(e=>{e.createReactAppDIContainer(this._container),e.createReactApp(this._container.get(Vr.a.ILogger),this._container.get(Vr.a.IAppStateStore),this._container.get(Vr.a.IResourceUrlFormatter))}),this._initialized=!0)}};na=Object(Hr.a)([Object(Mt.injectable)(),Object(Hr.c)(0,Object(Mt.inject)(Vr.a.Container)),Object(Hr.b)("design:paramtypes",[Mt.Container])],na);let ra=class{constructor(){this.defaultUxLanguage="en-US",this.editorSpellcheckAttribute="data-ms-editor",this.completeTileTextUnit=di.b.TextUnit.Sentence,this.partialTileTextUnit=di.b.TextUnit.Phrase,this.emitRemoval=!0,this.styleObserverIntervalTime=1,this.styleSampleTime=10,this.reconcileTileNodeTime=3e3,this.enableTileNodeAutoReconciliation=!0,this.maxSuggestionItemsDisplayNumber=3,this.maxSuggestionDisplayPerLanguageNumber=2,this.maxProofingLanguages=3,this.fabricFontsDefinitionPath="fonts/fabric-icons.css",this.enableSplitSuggestionButton=!1,this.narrowOnChangeReconciliation=!1,this.schedulerDefaultWaitingTime=50,this.schedulerDefaultMaxTime=2e3,this.schedulerDefaultWaitingTimeIncrement=400,this.maxServiceContentLengthInChars=350,this.maxContentLengthInChars=2e4}};ra=Object(Hr.a)([Object(Mt.injectable)()],ra),Object(Mt.decorate)(Object(Mt.injectable)(),Wr.EventEmitter);const aa=(e,t)=>{const i=new Mt.Container({defaultScope:"Singleton"});i.bind(Vr.a.Container).toConstantValue(i),i.bind(Vr.a.IComponentInitializer).to(Kr),i.bind(Vr.a.IReactComponentInitializer).to(na),i.bind(Vr.a.IRegistrar).to(ft.a),i.bind(Vr.a.IDisabler).to(pt.a),i.bind(Vr.a.IEditorClientSettings).to(ra),Object(Mt.multiBindToService)(i)(Vr.a.IEditorClientSettings)(Vr.a.IHostModelSettings,Vr.a.IPresentationSettings,Vr.a.IPresentationDomSettings,Wi.a.IOrchestratorSettings),i.bind(Vr.a.IHostSettings).toConstantValue(e),i.bind(Vr.a.IFeatureFlagsReader).to(jn.c),i.bind(jn.g.IExtensionStorage).to(jn.b),i.bind(Vr.a.IStoreEntryReader).to(jn.h),i.bind(Vr.a.IStoreEntryWriter).to(jn.i),i.bind(Vr.a.ISystemPersistedStore).to(ia),Object(Mt.multiBindToService)(i)(Vr.a.ISystemPersistedStore)(Vr.a.IHostModelPersistedStore),i.bind(Vr.a.IProofingPersistedStore).to(ta),i.bind(Vr.a.IHostEmitter).to(Wr.EventEmitter),i.bind(Vr.b.IHostEmitterArray).toService(Vr.a.IHostEmitter),i.bind(Vr.a.IHostTilingEmitter).to(Bt),i.bind(Vr.a.ISettingsEmitter).to(jn.f),Object(Mt.multiBindToService)(i)(Vr.a.ISettingsEmitter)(Vr.a.ISettingsEmitterBase),i.bind(Vr.a.IProofingEmitter).to(Wr.EventEmitter),i.bind(Vr.a.IProofingDom).to(Wt),(e=>{e.bind(qt.a.IGraphNodeBuilderFactory).toFactory(e=>t=>{const i=e.container.get(qt.a.INodeObserverFactory),n=e.container.get(qt.a.IGraphNodeFactory),r=e.container.get(qt.a.IDomFinderFactory),a=e.container.get(qt.a.IParagraphNodesBuilderFactory);switch(t.nodeMetaType.nodeType){case Fe.OutlineNode:return new Jt(i,n,e.container.get(qt.a.IGraphNodeBuilderFactory),r,e.container.get(qt.a.ILogger),t);case Fe.TerminalNode:return new ci(i,n,a,e.container.get(qt.a.INodePoller),e.container.get(qt.a.ITerminalNodeReader),e.container.get(qt.a.ITerminalNodeWriter),e.container.get(qt.a.ITileNodeReader),e.container.get(qt.a.IHostModelSettings),e.container.get(qt.a.IHostSettings),r,t.nodeMetaType,e.container.get(qt.a.ILogger));case Fe.TileNode:throw Error("Tile nodes don't need a builder.");case Fe.ParagraphNode:throw Error("Paragraph nodes don't need a builder.")}})})(i),(e=>{e.bind(qt.a.IShadowGraphFactory).toFactory(()=>()=>new ai)})(i),(e=>{e.bind(qt.a.INodeObserverFactory).toFactory(e=>(t,i)=>{switch(t){case Le.DefaultOutlineNodeObserver:return new Yt(e.container.get(qt.a.IHostModelPersistedStore),e.container.get(qt.a.IHostModelSettings),e.container.get(qt.a.IMutationObserverFactory),e.container.get(qt.a.ILogger),i?i.conditionalAttributeFilter:void 0);case Le.InputNodeObserver:return new Zt(e.container.get(qt.a.IMutationObserverFactory),e.container.get(qt.a.ILogger));case Le.TerminalNodeObserver:return new li(e.container.get(qt.a.IMutationObserverFactory),e.container.get(qt.a.IHostSettings),e.container.get(qt.a.ILogger),i?i.mutationContextBuilder:void 0,i?i.elementTransformers:void 0);case Le.AttributeObserver:return new $t(e.container.get(qt.a.IMutationObserverFactory),e.container.get(qt.a.ILogger))}})})(i),(e=>{e.bind(qt.a.IMutationObserverFactory).toFactory(()=>e=>new MutationObserver(e))})(i),(e=>{e.bind(qt.a.IGraphNodeFactory).toFactory(e=>(t,i,n,r,a,o)=>{switch(t){case Fe.OutlineNode:return new ei(e.container.get(qt.a.IGuidGenerator),i,a,n,r);case Fe.TerminalNode:return new oi(e.container.get(qt.a.IGuidGenerator),e.container.get(qt.a.IHostModelSettings),i,n,r);case Fe.TileNode:return new fi(e.container.get(qt.a.IGuidGenerator),e.container.get(qt.a.ILogger),e.container.get(qt.a.IWordCount),e.container.get(qt.a.IWordCountDetector),e.container.get(qt.a.IHostModelPersistedStore),e.container.get(qt.a.IHostModelSettings),e.container.get(qt.a.IIndexReadjuster),e.container.get(qt.a.INodePoller),e.container.isBound(qt.a.ICritiquesBrokerFactory)?e.container.get(qt.a.ICritiquesBrokerFactory):void 0,e.container.get(qt.a.ITerminalNodeReader),e.container.get(qt.a.IProofingDom),e.container.get(qt.a.ITextExtractor),e.container.get(qt.a.IHostSettings),e.container.get(qt.a.IHostTilingEmitter),t,i,o||e.container.get(qt.a.IParagraphNodesBuilderFactory),n,r);case Fe.ParagraphNode:throw Error("This factory cannot build Paragraph nodes.")}})})(i),(e=>{e.bind(qt.a.IParagraphNodeFactory).toFactory(e=>(t,i)=>new ti(e.container.get(qt.a.IGuidGenerator),e.container.get(qt.a.IProofingDom),t,i))})(i),(e=>{e.bind(qt.a.IParagraphNodesBuilderFactory).toFactory(e=>(t,i)=>new ni(e.container.get(qt.a.IProofingPersistedStore),e.container.get(qt.a.IParagraphNodeFactory),e.container.get(qt.a.ITextUnitChunker),e.container.get(qt.a.IHostModelSettings),e.container.get(qt.a.IHostSettings),t,i))})(i),(e=>{e.bind(qt.a.IDomFinderFactory).toFactory(e=>t=>{switch(t.finderId()){case Me.SelectorDomFinder:return new ri(e.container.get(qt.a.IElementsRetriever),t.selectorsCb);case Me.TextDomFinder:return new hi(e.container.get(qt.a.ITextUnitChunker))}})})(i),(e=>{e.bind(qt.a.ICritiquesBrokerFactory).toFactory(e=>t=>new yi(e.container.get(qt.a.IProofingEmitter),e.container.get(qt.a.IProofingDom),e.container.get(qt.a.IProofingPersistedStore),e.container.get(qt.a.ILogger),t,e.container.get(qt.a.ICritiqueFilterer),e.container.get(qt.a.IUpsellStore)))})(i),(e=>{e.bind(qt.a.IConditionalAttributeFilterFactory).toFactory(()=>e=>new Kt(e))})(i),i.bind(Vr.a.IElementsRetriever).to(vi),i.bind(Vr.a.ITileNodeReader).to(_i),i.bind(Vr.a.ITerminalNodeReader).to(Ii),i.bind(Vr.a.ITerminalNodeWriter).to(Si),i.bind(Vr.a.IPreOrderTraverser).to(Ci),i.bind(Vr.a.INodePoller).to(Ei),i.bind(Vr.a.IParagraphNodesBuilder).to(ni),i.bind(Vr.a.ITileNodeDictionary).to(Ti).inTransientScope(),i.bind(Vr.a.IParagraphNodeDictionary).to(Oi).inTransientScope(),i.bind(Vr.a.IWordDictionary).toDynamicValue(e=>{const t=e.container.get(Vr.a.IHostSettings);return t&&t.enableOrchestration?new pn(e.container.get(Vr.a.IProofingEmitter),t,e.container.get(Vr.a.IRoamingDictionaryFeature)):new ji(e.container.get(Vr.a.IGuidGenerator),e.container.get(Vr.a.IProofingDom),e.container.get(Vr.a.IProofingEmitter),e.container.get(Vr.a.INodePoller),t,e.container.get(Vr.a.IRoamingDictionaryFeature))}),i.bind(Vr.a.ICritiquesMessageEmitter).to(zi),i.bind(Vr.a.ITileCheckRequestBuilder).to(Ji),i.bind(Vr.a.ITextTilesMessageProcessor).to(Yi),i.bind(Vr.a.IInstrumentationMessageProcessor).to(Zi),i.bind(Vr.a.IDescriptorManager).to(Qi),i.bind(Vr.a.ITileIdFormatter).to(en),i.bind(Vr.a.IBackgroundActivityFactory).toFactory(e=>t=>{const i=e.container.get(Vr.a.IHostEmitter);return new mt.a(t,i)}),i.bind(Vr.a.ILogger).to(bt.a),t?i.bind(Vr.a.TelemetrySink).toConstantValue(t):i.bind(Vr.a.TelemetrySink).toDynamicValue(()=>{const e=new Ur([],{endpointUrl:Mr.PUBLIC});return e.setFullEventsEnabled(!0),e}),i.bind(Vr.a.IWordCount).to(Pn.a),i.bind(Vr.a.IWordCountDetector).to(xn.a),i.bind(Vr.a.IGuidGenerator).to(lt.a),i.bind(Vr.a.ITextNodeRangeBuilder).to(Dn.a),i.bind(Vr.a.ITextExtractor).to(Nn.a),i.bind(Vr.a.IIndexReadjuster).to(An.a),i.bind(Vr.b.ITextUnitSeparator).to(Rn.a).whenTargetNamed(di.b.TextUnit.Sentence),i.bind(Vr.b.ITextUnitSeparator).to(kn.a).whenTargetNamed(di.b.TextUnit.Document),i.bind(Vr.b.ITextUnitSeparator).to(kn.a).whenTargetNamed(di.b.TextUnit.Default),i.bind(Vr.a.ITextUnitChunker).to(Fn.a),i.bind(Vr.a.ICritiqueInterpreter).to(mn.a),i.bind(Vr.a.IContentValidator).to(bn),i.bind(Vr.b.ITextProcessor).to(Ln.a).inTransientScope().whenTargetNamed(Mn.a.HtmlEditTextProcessor),i.bind(Vr.b.ITextProcessor).to(qn.a).inTransientScope().whenTargetNamed(Mn.a.ContentEditableTextProcessor),i.bind(Vr.a.ITextRetrieverFactory).toFactory(()=>e=>{let t;return t=Object(yt.a)(e,"HTMLInputElement")||Object(yt.a)(e,"HTMLTextAreaElement")?new Bn.a(e):new Un.a(e),t}),i.bind(Vr.b.ICleanable).toService(Vr.a.ITextTilesMessageProcessor),i.bind(Vr.b.ICleanable).toService(Vr.a.IProofingDom),i.bind(Vr.b.ICleanable).to(xi),i.bind(Vr.b.IRegistrable).toService(Vr.a.ISettingsEmitter),i.bind(Vr.b.IRegistrable).toService(Vr.a.ITextTilesMessageProcessor),i.bind(Vr.b.IRegistrable).to(xi),i.bind(Vr.b.IRegistrable).to(Di),i.bind(Vr.b.IRegistrable).toService(Vr.a.ISystemPersistedStore),i.bind(Vr.b.IRegistrable).toService(Vr.a.IProofingPersistedStore),i.bind(Vr.b.IRegistrable).toService(Vr.a.IFeatureFlagsReader),i.bind(Vr.b.IRegistrable).toService(Vr.a.IWordDictionary),i.bind(Vr.a.IsUpsellUser).to(vt.a),i.bind(Vr.a.IsPremiumUser).to(_t.a),i.bind(Vr.a.IsSignedInUser).to(It.a),i.bind(Vr.a.IUpsellFeature).to(St.a),i.bind(Vr.a.IExternalSettingsFeature).to(Ct.a),i.bind(Vr.a.IShowSynonymsFeature).to(Et.b),i.bind(Vr.a.ICheckRefinementsFeature).to(Tt.a),i.bind(Vr.a.IRoamingDictionaryFeature).to(Ot.a),i.bind(Vr.a.IUnsignedInEditorFeature).to(wt.b),e&&e.enableOrchestration&&(i.bind(Vr.b.EventHub).to(yn),i.bind(Vr.a.CritiqueEventHandler).to(_n),i.bind(Vr.a.ICritiqueContextValidator).to(In),i.bind(Vr.a.FilteringEventHandler).to(Sn),i.bind(Vr.a.ICritiqueDispatcher).to(Cn),i.bind(Vr.a.ICritiqueStore).to(En),i.bind(Vr.a.NodeEventHandler).to(Tn),i.bind(Vr.a.SpanEventHandler).to(wn)),i.bind(Vr.b.IRegistrable).toService(Vr.a.ICritiqueFilterer),i.bind(Vr.a.DictionaryCritiqueFilter).to(Ni),i.bind(Vr.a.ICritiqueFilterer).to(Ai),i.bind(Vr.a.IEnabledCritiqueTypes).to(Fi),i.bind(Vr.a.PremiumCritiqueFilter).to(Li),i.bind(Vr.a.EnabledCritiqueTypesCritiqueFilter).to(Mi),i.bind(Vr.a.IUpsellStore).to(Bi),i.bind(Vr.a.IE2eMetric).to(jt.a),i.bind(Vr.b.IRegistrable).to(Pt.a),i.bind(Vr.b.IRegistrable).to(tn),i.bind(Vr.a.IMultiLangTileCheckResponseTransformer).to(an),i.bind(Vr.a.IAutoCorrectTransformer).to(on),i.bind(Vr.b.IRegistrable).to(sn),i.bind(Vr.a.EditorService).toDynamicValue(e=>{const t=e.container.get(Vr.a.IHostSettings);return new Lt.a({baseUri:`https://${t.editorEndPoint}`})}),i.bind(Vr.a.SynonymService).toDynamicValue(e=>{const t=e.container.get(Vr.a.IHostSettings);return new or({baseUri:`https://${t.synonymsEndPoint}`})}),i.bind(Vr.a.ITileCheckResponseTransformer).to(cn),i.bind(Vr.a.ISynonymFiller).to(un),i.bind(Vr.a.ISynonymRequestBuilder).to(hn),i.bind(Vr.a.IRemoteSettingsSyncer).to(jn.e),i.bind(Vr.a.IUserInfoStrategy).to(zr).inSingletonScope();const n=i.get(Vr.a.IUserInfoStrategy);return i.bind(Vr.a.IUserInfoUpdater).toConstantValue(n),i.bind(Vr.a.ISessionContextProvider).toProvider(e=>async()=>new Promise(e=>{const t=xt.a.detectBrowser();e({os:void 0,arch:void 0,browserType:t?t.name:"",browserVersion:t?t.version:null,extensionStoreId:"",languageUxId:"",extensionVersion:"",extensionVersionName:""})})),i.bind(jn.g.IBrowserStorageApi).to(jn.d),i.bind(Vr.a.ITransportLogger).to(Dt.a),i.bind(Vr.a.ITransportActivity).to(Dt.a),i.bind(Vr.a.ILocalizationStringsImporter).to(Zr),i.bind(Vr.a.ILocalizer).to(Xr),i.bind(Vr.b.IRegistrable).toService(Vr.a.ILocalizer),i.bind(Vr.a.IResourceUrlFormatter).to(Nt.a),i.bind(Vr.a.IUxLanguageDetector).to(At.a),e&&e.enableOrchestration&&i.bind(Vr.b.IRegistrable).to(Ui),i};class oa{constructor(e,t,i){this.diContainer=aa(e,i),this.upsellFeatureObj=this.diContainer.get(Vr.a.IUpsellFeature),this.roamingDictionaryFeatureObj=this.diContainer.get(Vr.a.IRoamingDictionaryFeature),this.externalSettingsFeatureObj=this.diContainer.get(Vr.a.IExternalSettingsFeature),this.userInfoUpdater=this.diContainer.get(Vr.a.IUserInfoUpdater),this.isPremiumUser=this.diContainer.get(Vr.a.IsPremiumUser),this.logger=this.diContainer.get(Vr.a.ILogger),this.orchestrator=new ht(this.diContainer.get(Vr.a.IHostEmitter),this.diContainer.get(Vr.a.IHostSettings),this.diContainer.get(Vr.a.IGuidGenerator),this.diContainer.get(Vr.a.IDescriptorManager),this.logger,this.diContainer.get(Vr.a.IE2eMetric),t),e&&!0===e.enableOrchestration&&(this.eventHub=this.diContainer.get(Vr.b.EventHub)),this.init()}spellCheck(e,t){const i=this.diContainer.get(Vr.a.IGraphNodeBuilderFactory),n=this.diContainer.get(Vr.a.IProofingDom),r=i({ruleName:"",nodeMetaType:{nodeType:Fe.TerminalNode,observerType:Le.TerminalNodeObserver,mutationContextBuilder:void 0,elementsFinder:{finderId:()=>this.diContainer.get(Vr.a.IHostSettings).simplifiedHostModelEnabled?Me.SelectorDomFinder:Me.TextDomFinder,selectorsCb:()=>[]},filters:[],filterSelector:t},childMetaType:null}).buildNode(e,void 0);return n.addNode(r),r}detach(e){this.diContainer.get(Vr.a.IWordDictionary).clearIgnoredWords(),this.diContainer.get(Vr.a.IProofingDom).removeNode(e)}async setLocale(e){this.diContainer.get(Vr.a.IProofingPersistedStore).write(tt.a.ProofingLanguages,[e]),this.diContainer.get(Vr.a.IProofingEmitter).emit("proofingLanguageChanged",{data:new it.a([e]),messageType:nt.a.ChangeData})}async setMultiLingualProofingLocales(e){this.diContainer.get(Vr.a.IProofingPersistedStore).write(tt.a.ProofingLanguages,e),this.diContainer.get(Vr.a.IProofingEmitter).emit("proofingLanguageChanged",{data:new it.a(e),messageType:nt.a.ChangeData})}async enableSpelling(){await this._enableDisableSpelling(!0)}async disableSpelling(){await this._enableDisableSpelling(!1)}async enableGrammar(){await this._enableDisableGrammar(!0)}async enableRefinements(){await this._enableDisableRefinements(!0)}async setOverriddenCritiqueTypeOptions(e){await this.diContainer.get(Vr.a.IProofingPersistedStore).write(tt.a.OverriddenCritiqueTypeOptions,e),this.diContainer.get(Vr.a.IEnabledCritiqueTypes).setOverriddenCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged(),this._refreshTileNodes()}async disableGrammar(){await this._enableDisableGrammar(!1)}async disableRefinements(){await this._enableDisableRefinements(!1)}async isSpellingEnabled(){return this.diContainer.get(Vr.a.IProofingPersistedStore).read(tt.a.EnableSpelling)}async isGrammarEnabled(){return this.diContainer.get(Vr.a.IProofingPersistedStore).read(tt.a.EnableGrammar)}async areRefinementsEnabled(){return this.diContainer.get(Vr.a.IProofingPersistedStore).read(tt.a.EnableRefinements)}async _enableDisableSpelling(e){await this.diContainer.get(Vr.a.IProofingPersistedStore).write(tt.a.EnableSpelling,e),this._emitEnabledCritiqueTypesChanged(),this._refreshTileNodes()}async _enableDisableGrammar(e){await this.diContainer.get(Vr.a.IProofingPersistedStore).write(tt.a.EnableGrammar,e),this._emitEnabledCritiqueTypesChanged(),this._refreshTileNodes()}async _enableDisableRefinements(e){await this.diContainer.get(Vr.a.IProofingPersistedStore).write(tt.a.EnableRefinements,e),this._emitEnabledCritiqueTypesChanged(),this._refreshTileNodes()}_refreshTileNodes(){const e=this.diContainer.get(Vr.a.IProofingDom);this.diContainer.get(Vr.a.INodePoller).pollNodes(nt.a.ChangeData,e.tileNodes)}shutDown(){try{this.orchestrator.shutDown(),this.eventHub&&this.eventHub.shutDown();const e=document.querySelectorAll("editor-card");Array.from(e).forEach(e=>{e.remove()}),this.diContainer.get(Vr.a.IDisabler).disableContentScript()}catch(e){this.logger.error(575930397,"error while removing the editor-card from the DOM.")}}get upsellFeature(){return this.upsellFeatureObj}get roamingDictionaryFeature(){return this.roamingDictionaryFeatureObj}get externalSettingsFeature(){return this.externalSettingsFeatureObj}enablePremiumUntil(e){this.isPremiumUser.setGracePeriodUntil(e)}updateUserInfo(e){this.userInfoUpdater.update(e)}async init(){Object(gt.configure)({enforceActions:"observed"}),this.orchestrator.initialize(),this.eventHub&&await this.eventHub.initialize();this.diContainer.get(Vr.a.IRemoteSettingsSyncer).schedule(1e3,3e5);const e=this.diContainer.get(Vr.a.IComponentInitializer);await e.initializeComponent();const t=this.diContainer.get(Vr.a.IHostSettings);await this.setLocale(t.defaultLocale);const i=this.diContainer.get(Vr.a.IUserInfoStrategy);try{await i.executeAsync(!0),this.diContainer.get(Vr.a.IReactComponentInitializer).initializeComponent()}catch(e){}}setAvailableCritiqueTypes(e){this.diContainer.get(Vr.a.IEnabledCritiqueTypes).setAvailableCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged()}setPreviewCritiquesCount(e,t){const i=this.diContainer.get(Vr.a.IUpsellStore);i.setPreviewModeActive(!0),i.setPreviewCount(e,!0),i.setPreviewUnit(t)}setPremiumPreviewActive(e){this.diContainer.get(Vr.a.IUpsellStore).setPreviewModeActive(e)}setLightUpPremiumSquiggles(e){this.diContainer.get(Vr.a.IUpsellStore).setLightUpPremiumSquiggles(e)}onPremiumCountChange(e){this.diContainer.get(Vr.a.IUpsellStore).setOnPremiumCountChange(e)}onPreviewCritiquesCountChange(e){this.diContainer.get(Vr.a.IUpsellStore).setOnPreviewCritiquesCountChange(e)}onTryPremiumPreview(e){this.diContainer.get(Vr.a.IUpsellStore).setOnTryPremiumPreview(e)}onPremiumPreviewExpired(e){this.diContainer.get(Vr.a.IUpsellStore).setOnPremiumPreviewExpired(e)}_emitEnabledCritiqueTypesChanged(){this.diContainer.get(Vr.a.IProofingEmitter).emit("enabledCritiqueTypesChanged",{messageType:nt.a.ChangeData})}}var sa=i(11886),ca=i(11816),la=i(9965),ua=i(197),da=i(7548);function ha(){return Object(da.a)()?Ri.a.MSA:Object(ua.a)()?Ri.a.MSA:Ri.a.AAD}var ga=i(57),fa=i(1339),pa=i(11817),ma={},ba="https://go.microsoft.com/fwlink/?linkid=2125008";function ya(e,t,i,n,r){return ma[e]?ma[e]:function(e,t,i,n,r){var a,o,c=Object(ga.h)(),l=Object(_.i)("mc-officeEditorALEnabled"),u=Object(pa.a)(),d=n===s.a.New&&(Object(_.i)("mc-officeEditorUpsellSkittleBasedOnDate")||Object(_.i)("mc-officeEditorUpsellSkittleBasedOnCount"));l&&(r||Object(T.s)("ProofingALSessionNull"));return ma[e]=new oa({enableOrchestration:l,orchestratorSettings:{enableAugLoop:l,augLoopEndpoint:Object(ca.a)()},useShadowDom:!1,appId:"Outlook_Online",defaultLocale:t,controlIconSetName:fa.a.fontFileName,showOptionsButton:!1,showCalloutBranding:!1,editorEndPoint:Object(_.i)("ring-dogfood")?Lt.b.Staging:Lt.b.Prod,synonymsEndPoint:Object(_.i)("ring-dogfood")?Lt.d.Staging:Lt.d.Prod,ignoreAllEnabled:!0,ignoreOnceEnabled:!0,sessionType:"Edit"===i?sa.a.OWA_Draft_Email:sa.a.OWA_New_Email,enableUrlClassifier:!0,userId:{identityProvider:ha(),puid:null===(a=c.SessionSettings)||void 0===a?void 0:a.UserPuid,tenantId:null===(o=c.SessionSettings)||void 0===o?void 0:o.ExternalDirectoryTenantGuid},showTeachingUi:!1,showSquiggleTooltip:Object(_.i)("mc-officeEditorBXTooltip"),licenseType:Object(la.b)(),upsellLink:ba,manageRtlInEditorUx:!1,manageRtlForProofingLanguage:!1,enableOptimizedCallingPattern:!0,flightsToTrack:u,enableRoamingDictionary:!0,enhancedUpsellEnabled:!0,premiumPreviewEnabled:d,maxSuggestionDisplayPerLanguageNumber:2,maxSuggestionItemsDisplayNumber:3,newLineSentenceSeparatorEnabled:Object(_.i)("mc-officeEditorNewSentenceSeparator"),simplifiedHostModelEnabled:!l&&Object(_.i)("mc-officeEditorSimplifiedHostModel"),enableE2eMetric:Object(_.i)("mc-officeEditorE2eMetric"),wordCountDetectorEnabled:Object(_.i)("mc-officeEditorWordCountDetector"),enableDispatchCritiquesOnEmptyDiffs:!0,enableRenderingCalloutToPortal:!0,inferenceCritiqueCloudIconEnabled:Object(_.i)("mc-officeEditorInferenceCritiqueIcon")},r),ma[e]}(e,t||Object(ga.j)(),i,n,r)}function va(e,t,i,n){var r,a,o=ya(e,null,null,t.premiumPreviewStatus,null);t.premiumPreviewType===s.b.TimeBased?(r=qi.b.Days,a=i):t.premiumPreviewType===s.b.CountBased&&(r=qi.b.Suggestions,a=n),o.setPremiumPreviewActive(!0),o.setPreviewCritiquesCount(a,r)}var _a=i(6268),Ia=i(158),Sa=Object(j.a)((function(e){var t=e.viewState,i=t.skittleViewStatus,n=t.premimumFlagsFound,r=t.premiumCategories,a=t.skittleCalloutStatus,u=t.premiumPreviewData,d=t.editorProofingId,g=w.useRef(),m=w.useRef(),b="Show"===i,y=u.premiumPreviewStatus===s.a.Activated,v=u.premiumPreviewStatus===s.a.New,_=function(t){We(e.viewState,t)},I=w.useCallback((function(e){y||ya(d,null,null,u.premiumPreviewStatus,null).setLightUpPremiumSquiggles(e)}),[u.premiumPreviewStatus]),S=y?null:n,C=w.useCallback((function(){!function(e){var t;switch(e){case s.a.Activated:t=Ne;break;case s.a.Expired:t=Ae;break;case s.a.Unknown:t=De;break;case s.a.New:t=Re;break;default:Object(l.a)(e)}t&&Object(T.s)(t,{},{isCore:!0})}(u.premiumPreviewStatus),_(h.a.ShowCallout),He(e.viewState,"skittle"),v&&I(!0),m.current.focus()}),[u.premiumPreviewStatus,e.viewState]),E=w.useCallback((function(){v&&I(!1)}),[u.premiumPreviewStatus]),O=w.useCallback((function(t,i){o(e.viewState,u.premiumPreviewType,t,!0,i),va(d,u,c.e,c.f),_(h.a.Hide),Se(u.premiumPreviewSource,!1)}),[]),j=w.useCallback((function(){_(h.a.Hide)}),[]),N=function(e,t){var i=t.premiumSuggestionsCount,n=t.numberOfDaysLeftToUsePremiunSuggestions,r=t.premiumPreviewStatus,a=t.premiumPreviewType;if(r===s.a.Activated){if(a===s.b.TimeBased)return Object(f.c)(Object(f.b)(p.b),n.toString());if(a===s.b.CountBased)return Object(f.c)(Object(f.b)(p.a),i.toString())}return 1===e?Object(f.b)(p.o):e>1?Object(f.c)(Object(f.b)(p.p),e.toString()):Object(f.b)(p.n)}(n,u),A=v?w.createElement(we,{onTryItNowClick:O,premiumPreviewData:u,onHoverPremiumPreview:I}):w.createElement(et,{premiumCategories:r,premimumFlagsFound:n,premiumPreviewData:u});return b?w.createElement("div",{className:_a.skittleContainer},w.createElement("div",{ref:g},w.createElement(k.a,{"aria-label":N,className:_a.skittleInfo,onMouseEnter:C,onMouseLeave:E,onClick:C},w.createElement("span",{className:Ia([_a.skittleCount,0==n&&_a.hideCount])},S),w.createElement(P.a,{iconName:"Diamond",className:_a.skittleDiamonIcon}))),w.createElement(x.a,{hidden:a!==h.a.ShowCallout,className:_a.reservationStatusCallout,gapSpace:3,onDismiss:j,directionalHint:D.a.topRightEdge,isBeakVisible:!1,setInitialFocus:!0,target:g.current},w.createElement(ke.a,{ref:function(e){return m.current=e},forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0},A)),a===h.a.ShowDialog&&w.createElement(xe,{onDismiss:j,onTryItNowClick:O,premiumPreviewData:u})):null})),Ca=i(23),Ea=i(1103),Ta=i(9969);function Oa(e,t){return t?Object(Ta.a)()&&((null==e?void 0:e.spellCheckEnabled)||(null==e?void 0:e.grammarEnabled))&&Object(d.a)(null==e?void 0:e.proofingLocale):Object(Ta.a)()}var wa=i(3431),ja=i(2001),Pa=i(9968),xa=i(7849),Da=[{id:"818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",name:"Frequently confused words",defaultCritiqueValue:1},{id:"5cb7fc16-cd78-449c-86d9-5d047be21ac4",name:"Adjective Used instead of Adverb",defaultCritiqueValue:1},{id:"f57c12d6-03e4-4f48-9b7b-f95802a6c669",name:"Agreement within Noun Phrases",defaultCritiqueValue:1},{id:"63e72d3d-62d7-4e73-8d66-c137d8841121",name:"Capitalization",defaultCritiqueValue:1},{id:"fd8f4ff7-fa09-492c-9c74-1a6b9f71e488",name:"Comma Missing after Introductory Phrase",defaultCritiqueValue:1},{id:"72e604b0-a185-413b-bd45-ad555288c746",name:"Comma Splice",defaultCritiqueValue:1},{id:"aea1e72a-abf4-4cc8-8b7a-43d15be8fc55",name:"Commonly Confused Words",defaultCritiqueValue:1},{id:"02c15397-df70-4f00-aa4d-7269e6d4e712",name:"Comparative Use",defaultCritiqueValue:1},{id:"84275a90-df79-4b9e-a208-9ec8b5e59622",name:"Hyphenation",defaultCritiqueValue:1},{id:"7c2ff4d7-41a9-4310-949b-863a0dfa4257",name:"Incorrect Verb Form after Auxiliary",defaultCritiqueValue:1},{id:"6dbfae4c-9818-4dec-a769-2595168927f2",name:"Indefinite Article",defaultCritiqueValue:1},{id:"f1a2ad0b-0b26-4bb5-aede-e88c9fe47492",name:"Possessive and Plural Forms",defaultCritiqueValue:1},{id:"3f2eda01-e8a5-4ed9-9494-6de566bc5333",name:"Punctuation",defaultCritiqueValue:1},{id:"76e3d0aa-bb80-461e-89c3-9fa640190616",name:"Question Mark Missing",defaultCritiqueValue:1},{id:"6d1d8c3d-62d5-45d1-b850-d8a98a24964b",name:"Spacing",defaultCritiqueValue:1},{id:"d7746119-e7e5-4e97-9979-bcd2114f9fe9",name:"Subject-Verb Agreement",defaultCritiqueValue:1},{id:"27783a58-c44f-4778-9856-36d9eab63693",name:"Too Many Determiners",defaultCritiqueValue:1},{id:"352579fc-6ae6-4eb1-8d3b-895ab239714e",name:"Verb Use",defaultCritiqueValue:1}];function Na(){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(e){return Object(da.a)()?[2,Da]:[2,d.c.importAndExecute()]}))}))}var Aa=i(2597),Ra=i(9540),ka=i(2151),Fa=15e3;function La(e,t){var i=null==e?void 0:e.getContent(3),n=(null==i?void 0:i.length)>Fa;return n&&Object(ka.a)(t,"proofingDiabledDueToSize"),n}var Ma=i(5);function qa(e){if(!e)return c.b;var t=function(e){var t=new Date(e);return Object(Ma.Sb)(Object(ga.h)().UserOptions.TimeZone,t.getFullYear(),t.getMonth(),t.getDate())}(e);return Object(Ma.Hb)(Object(Ma.Rb)(),t)?Object(Ma.u)(t,Object(Ma.Rb)())+1:c.a}function Ba(e,t,i){var n=Object(_.i)("mc-officeEditorUpsellSkittleBasedOnDate")?s.b.TimeBased:Object(_.i)("mc-officeEditorUpsellSkittleBasedOnCount")?s.b.CountBased:s.b.BasicSkittle;if(n!==s.b.None){var r=qa(e);o(i,n,r,!1,t)}}var Ua=i(8293),Wa="EditorProofing_CritiqueClicked",Ha=1e3,Ga=function(){function e(e,t,i,n,a,o){var c=this;this.adapter=e,this.editorAdapter=t,this.augloopSessionAdapter=i,this.composeOperation=n,this.isCalendar=a,this.infoBarViewState=o,this.onUpdateSettings=function(){d.d.importAndExecute((function(e){c.proofingOptions=e,c.getOptionsAndUpdateEditorClient(e)}))},this.getOptionsAndUpdateEditorClient=function(e){Object(d.a)(e.proofingLocale)?(c.updateEditorProofingOptionsBasedOnSettings(),e.spellCheckEnabled||e.grammarEnabled?c.nodeBeingChecked?(c.stopProofing(),c.startProofing()):c.startProofing():c.stopProofing(),c.reProofDocument()):c.stopProofing()},this.onSettingsDialogButtonClicked=function(){var e=c.adapter().premiumPreviewData;e.premiumPreviewStatus===s.a.New?(He(c.adapter(),"settings"),We(c.adapter(),h.a.ShowDialog)):(d.e.importAndExecute(),pe("SettingsCompose",e,""))},this.reactToRoamingDictionaryInitialized=function(e){return Ca.g.info("[roamingDictionary] reactToRoamingDictionaryInitialized"),c.roamingDictionary?(Ca.g.info("[roamingDictionary] reactToRoamingDictionaryInitialized: enabling feature"),[m.a.EnableFeature,{roamingDictionary:c.roamingDictionary}]):(Ca.g.info("[roamingDictionary] reactToRoamingDictionaryInitialized: roamingDictionary not created disabling feature"),[m.a.DisableFeature,{roamingDictionary:void 0}])},this.reactToCritiqueClicked=function(e){Ca.g.info("[ProofingPlugin] reactToCritiqueClicked");var t=c.adapter().premiumPreviewData;if(!e.critique)return[m.a.NoReaction,{upsellLink:void 0}];e.critique.priority===b.b.Low&&(Ca.g.info("[ProofingPlugin] triggering floodgate survey in 1 second"),setTimeout((function(){Aa.b.import().then((function(e){e("ProofingRefinementClicked")}))}),Ha));var i=ee(t.premiumPreviewType,t.premiumPreviewStatus,"ContexualCard",e.critique.priority===b.b.High);return Object(T.s)(Wa,{type:E(e.critique.priority),showUpsell:Object(Ta.a)()}),[m.a.EnableFeature,{upsellLink:i}]},this.reactToUpsellClicked=function(e){var t;Ca.g.info("[ProofingPlugin] reactToUpsellClicked");var i=c.adapter().premiumPreviewData;pe("ContexualCard",i,E(null===(t=e.critique)||void 0===t?void 0:t.priority));var n=e.sender===y.d.Outlook?void 0:ee(i.premiumPreviewType,i.premiumPreviewStatus,"ContexualCard",e.critique.priority===b.b.High);return[m.a.EnableFeature,{upsellLink:n}]},this.updateEditorProofingOptionsBasedOnSettings=function(){return Object(r.c)(c,void 0,void 0,(function(){var e,t,i,n,a,o,s,c;return Object(r.f)(this,(function(l){switch(l.label){case 0:return e=this.proofingOptions,t=e.spellCheckEnabled,i=e.grammarEnabled,n=e.writingRefinementsEnabled,a=e.proofingLocale,this.editorClient?(t?this.editorClient.enableSpelling():this.editorClient.disableSpelling(),i?this.editorClient.enableGrammar():this.editorClient.disableGrammar(),n&&Object(xa.a)()?this.editorClient.enableRefinements():this.editorClient.disableRefinements(),[4,Na()]):[2];case 1:return o=l.sent(),[4,d.b.importAndExecute()];case 2:return s=l.sent(),o&&this.editorClient.setAvailableCritiqueTypes(o),s&&(c=Object(r.j)([],Object(r.g)(s.values())),this.editorClient.setOverriddenCritiqueTypeOptions(c)),this.editorClient.setLocale(a),[2]}}))}))},this.handleProofingCreateUndoCheckpointEvent=function(e){c.editor.addUndoSnapshot()},this.sessionId=Object(O.a)()}return e.prototype.getName=function(){return"Proofing"},e.prototype.initialize=function(e){this.editor=e,Ca.g.info("[ProofingPlugin] initialize: "+this.editor),La(this.editor,this.infoBarViewState)?this.temporarilyDisableProofing():this.initializeProofingEditorClient()},e.prototype.dispose=function(){var e,t,i,n=this.adapter();n.premiumPreviewData.premiumPreviewType===s.b.CountBased&&(null===(e=this.proofingOptions)||void 0===e?void 0:e.premiumSuggestionsCount)!==(null===(t=n.premiumPreviewData)||void 0===t?void 0:t.premiumSuggestionsCount)&&d.h.importAndExecute("premiumSuggestionsCount",n.premiumPreviewData.premiumSuggestionsCount),this.editorClient&&(this.roamingDictionary&&Ra.c.importAndExecute(),this.stopProofing(),this.editorClient.shutDown(),this.editorClient=null),this.editor=null,i=n.editorProofingId,delete ma[i],Object(_.i)("mc-officeEditorALEnabled")&&Ua.a.importAndExecute(this.augloopSessionAdapter().sessionId)},e.prototype.setPluginUtils=function(e){this.utils=e},e.prototype.onPluginEvent=function(e){if(7==e.eventType)switch(e.source){case"UpgradeCompose":La(this.editor,this.infoBarViewState)&&this.temporarilyDisableProofing();break;case"_ShowEditorSettingsSource":this.showEditorSettings(e.data)}},e.prototype.getUIComponentClass=function(){return Sa},e.prototype.showEditorSettings=function(e){var t=function(e){var t,i,n=e.premiumPreviewData,r=n.premiumPreviewStatus;if(r===s.a.New)0===e.premimumFlagsFound?t=Object(f.b)(g.d):1===e.premimumFlagsFound?t=Object(f.b)(g.a):e.premimumFlagsFound>1&&(t=Object(f.c)(Object(f.b)(g.b),e.premimumFlagsFound.toString()));else if(r===s.a.Activated){if(n.premiumPreviewType===s.b.TimeBased){var a=void 0;a=1===n.numberOfDaysLeftToUsePremiunSuggestions?g.f:g.e,t=Object(f.c)(Object(f.b)(a),n.numberOfDaysLeftToUsePremiunSuggestions)}else if(n.premiumPreviewType===s.b.CountBased){var o=void 0;o=1===n.premiumSuggestionsCount?g.g:g.h,t=Object(f.c)(Object(f.b)(o),n.premiumSuggestionsCount)}}else r!==s.a.Expired&&n.premiumPreviewType!==s.b.BasicSkittle||e.premimumFlagsFound>0&&(t=Object(f.c)(Object(f.b)(g.c),e.premimumFlagsFound.toString()));return i=r===s.a.New?Object(f.b)(g.j):Object(f.b)(p.v),{upsellString:t=t||Object(f.b)(g.i),buttonString:i}}(this.adapter()),i=t.upsellString,n=t.buttonString;Ca.g.info("[ProofingPlugin] showEditorSettings"),d.f.importAndExecute(e,this.isCalendar?Pa.a.CalendarComposeToolbar:Pa.a.MailComposeToolbar,this.onUpdateSettings,this.onSettingsDialogButtonClicked,i,n)},e.prototype.temporarilyDisableProofing=function(){var e;Ge(this.adapter()),null===(e=this.editor)||void 0===e||e.setEditorDomAttribute("spellCheck","true"),this.stopProofing()},e.prototype.setEditorClientData=function(e){var t=this;d.d.importAndExecute((function(i){t.proofingOptions=i,t.editor&&(Oa(i,!0)&&Be(t.adapter()),Ba(i.finalDatePremiumDemo,i.premiumSuggestionsCount,t.adapter()),t.editorClient=ya(t.adapter().editorProofingId,t.getDefaultProofingLocale(),t.composeOperation,t.adapter().premiumPreviewData.premiumPreviewStatus,e),t.attachUpsellCallbacks(),t.getOptionsAndUpdateEditorClient(i))}))},e.prototype.initializeProofingEditorClient=function(){var e=this;if(Object(wa.a)())if(Object(_.i)("mc-officeEditorALEnabled")){var t=this.augloopSessionAdapter().sessionId;Ua.b.import().then((function(i){i(t).then((function(i){e.editor&&(Ca.g.info("[augloopSession]. Proofing plugin with Id:"+t),e.setEditorClientData(i))}))}))}else this.setEditorClientData(null)},e.prototype.attachUpsellCallbacks=function(){var e=this,t=this.adapter().premiumPreviewData;Oa(void 0,!1)&&this.editorClient.onPremiumCountChange((function(t,i){Ue(e.adapter(),t,i),!e.loggedPremiumSuggestionsFound&&t>0&&(Object(T.s)(c.c,{},{isCore:!0}),e.loggedPremiumSuggestionsFound=!0)})),t.premiumPreviewStatus===s.a.New&&this.editorClient.onTryPremiumPreview((function(t){He(e.adapter(),"contextualCard"),We(e.adapter(),h.a.ShowDialog)})),t.premiumPreviewType===s.b.CountBased&&t.premiumPreviewStatus!==s.a.Expired&&(this.editorClient.onPremiumPreviewExpired((function(){We(e.adapter(),h.a.ShowCallout),u(e.adapter(),t.numberOfDaysLeftToUsePremiunSuggestions,s.a.Expired,s.b.CountBased,c.g)})),this.editorClient.onPreviewCritiquesCountChange((function(i){u(e.adapter(),t.numberOfDaysLeftToUsePremiunSuggestions,s.a.Activated,s.b.CountBased,i)})));var i=this.editorClient.upsellFeature;i.ignoreDisablers=!0,i.addListener(y.b.CritiqueClicked,this.reactToCritiqueClicked),i.addListener(y.b.UpsellButtonClicked,this.reactToUpsellClicked),this.editorClient.roamingDictionaryFeature.addListener(v.a.ClientInitialized,this.reactToRoamingDictionaryInitialized)},e.prototype.startProofing=function(){return Object(r.c)(this,void 0,void 0,(function(){var e,t,i,n,a,o,l=this;return Object(r.f)(this,(function(r){switch(r.label){case 0:return this.editorClient?(this.updateEditorProofingOptionsBasedOnSettings(),this.logEvent("EditorProofing_SessionStart"),e=this.adapter(),t=this.adapter().premiumPreviewData,Oa(this.proofingOptions,!0)?(Be(e),Object(T.s)(c.d,{},{isCore:!0})):qe(e),t.premiumPreviewStatus===s.a.Activated&&va(e.editorProofingId,t,t.numberOfDaysLeftToUsePremiunSuggestions,t.premiumSuggestionsCount),this.roamingDictionary?[3,3]:(Ca.g.info("[roamingDictionary] startProofing: getting roaming dictionary"),[4,Ra.a.import()])):[3,4];case 1:return i=r.sent(),n=this,[4,i()];case 2:n.roamingDictionary=r.sent(),Ca.g.info("[roamingDictionary]startProofing: got roaming dictionary"),r.label=3;case 3:this.editor&&(this.editor.setEditorDomAttribute("spellCheck","false"),a=Object(ja.getEntitySelector)("WATERMARK_WRAPPER"),o=Object(_.i)("mc-officeEditorSimplifiedHostModel")?"":".suggestedCompletion, .SonoraInlineHint, a, blockquote, "+a,this.nodeBeingChecked=this.utils.spellCheck(this.editorClient,o),document.addEventListener("createUndoCheckpoint",this.handleProofingCreateUndoCheckpointEvent),this.resizeObserver=new Ea.default((function(e){l.reProofDocument()})),this.utils.observeResize(this.resizeObserver,{box:"border-box"})),r.label=4;case 4:return[2]}}))}))},e.prototype.reProofDocument=function(){var e,t;null===(t=null===(e=this.nodeBeingChecked)||void 0===e?void 0:e.children)||void 0===t||t.forEach((function(e){e.reconcile(void 0,!0)}))},e.prototype.logEvent=function(e){var t=this.proofingOptions,i=t.spellCheckEnabled,n=t.grammarEnabled,r=t.writingRefinementsEnabled;Object(T.s)(e,{sessionId:this.sessionId,spelling:i,grammar:n,refinements:r})},e.prototype.stopProofing=function(){var e;this.editorClient&&this.nodeBeingChecked&&(this.logEvent("EditorProofing_SessionEnd"),null===(e=this.editor)||void 0===e||e.setEditorDomAttribute("spellCheck","true"),this.editorClient.detach(this.nodeBeingChecked),this.nodeBeingChecked=null,document.removeEventListener("createUndoCheckpoint",this.handleProofingCreateUndoCheckpointEvent)),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)},e.prototype.getDefaultProofingLocale=function(){var e,t;return(null===(e=this.proofingOptions)||void 0===e?void 0:e.proofingLocale)?null===(t=this.proofingOptions)||void 0===t?void 0:t.proofingLocale:Object(ga.j)()},e}(),Va=i(3698),za=i(1886),$a=i(1083),Ja=i(11887),Ka=Object(j.a)((function(e){var t=$a.b.ProofingTeachingFreeUserFRE,i=Object(f.b)(Ja.d),n=Object(f.b)(Ja.a),r=Object(f.b)(Ja.c),a=function(){Object($a.e)(t)};return w.createElement($a.a,{lid:$a.b.ProofingTeachingFreeUserFRE,when:function(e){setTimeout(e,1500)}},w.createElement(za.a,{calloutProps:{beakWidth:12,directionalHint:D.a.topCenter},targetElement:e.target(),hasCloseIcon:!0,onDismiss:a,hasSmallHeadline:!0,headline:i,primaryButtonProps:{buttonType:Va.a.primary,children:r,onClick:a}},n))})),Xa=Object(j.a)((function(e){var t=$a.b.ProofingTeachingPremiumUserFRE,i=Object(f.b)(Ja.e),n=Object(f.b)(Ja.b),r=Object(f.b)(Ja.c),a=function(){Object($a.e)(t)};return w.createElement($a.a,{lid:$a.b.ProofingTeachingPremiumUserFRE,when:function(e){setTimeout(e,1500)}},w.createElement(za.a,{calloutProps:{beakWidth:12,directionalHint:D.a.topCenter},targetElement:e.target(),hasCloseIcon:!0,onDismiss:a,hasSmallHeadline:!0,headline:i,primaryButtonProps:{buttonType:Va.a.primary,children:r,onClick:a}},n))})),Ya=Object(j.a)((function(e){var t=e.target,i=Object(xa.a)();return w.createElement(w.Fragment,null,!i&&w.createElement(Ka,{target:t}),i&&w.createElement(Xa,{target:t}))}));i.d(t,"ProofingPlugin",(function(){return Ga})),i.d(t,"ProofingTeachingCallout",(function(){return Ya}))},12279:function(e,t,i){"use strict";var n=i(3108),r=i(2037),a=i(3859),o=i(8331),s=i(4140);let c=class{async initialize(e){}addCorrelationID(e){}log(e,t,i,n){this.dispatchLog(null,e,t,i,n)}debug(e,t,i){this.dispatchLog(null,e,s.h.Debug,t,i)}error(e,t,i){this.dispatchLog(null,e,s.h.Error,t,i)}warn(e,t,i){this.dispatchLog(null,e,s.h.Warn,t,i)}info(e,t,i){this.dispatchLog(null,e,s.h.Info,t,i)}logEvent(e,t,i,n,r,a){this.dispatchLog(t,e,i,n,a)}dispatchLog(e,t,i,n,r){switch(i){case s.h.Debug:case s.h.Error:case s.h.Info:case s.h.Warn:break;default:throw new Error("Invalid logging level")}}};c=Object(n.a)([Object(r.injectable)()],c),i.d(t,"a",(function(){return l}));let l=class{constructor(e,t){this._transports=e,this._activityTransport=t,this._debugMode=!1,this._initialized=!1,this._initializing=!1}async initialize(e,t,i){if(!this._initialized){if(!this._initializing)try{this._debugMode=await e.read(o.a.DebugMode),this._debugMode&&this._transports.push(new c);for(const n of this._transports)await n.initialize(e,t,i);this._activityTransport&&await this._activityTransport.initialize(e,t,i)}finally{this._initializing=!1}this._initialized=!0}}addCorrelationID(e){for(const t of this._transports)t.addCorrelationID(e);this._activityTransport&&this._activityTransport.addCorrelationID(e)}log(e,t,i,n){this.logEvent(e,null,t,i,s.i.Measure,n)}info(e,t,i){this.logEvent(e,null,s.h.Info,t,s.i.Measure,i)}warn(e,t,i){this.logEvent(e,null,s.h.Warn,t,s.i.Measure,i)}error(e,t,i){this.logEvent(e,null,s.h.Error,t,s.i.CriticalBusinessImpact,i)}debug(e,t,i){this.logEvent(e,null,s.h.Debug,t,s.i.Diagnostics,i)}logServiceRequest(e,t,i,n,r){for(const a of this._transports)t&&(a.serviceRequestID=t),this.logEvent(e,null,i,n,s.i.Measure,r)}logEvent(e,t,i,n,r,a,o){if(this._initialized&&(this._debugMode||i!==s.h.Debug))for(const s of this._transports)s.logEvent(e,t,i,n,r,a,o)}getNewActivity(e,t,i){return this._initialized&&this._activityTransport?this._activityTransport.getNewActivity(e,t,i):void 0}};l=Object(n.a)([Object(r.injectable)(),Object(n.b)(0,Object(r.multiInject)(a.a.ITransportLogger)),Object(n.b)(1,Object(r.inject)(a.a.ITransportActivity))],l)},1261:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i(3),r=i(0),a=i(513),o=i(609),s=i(700),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.render=function(){return r.createElement(s.a,Object(n.__assign)({},this.props,{primary:!0,onRenderDescription:a.b}))},t=Object(n.__decorate)([Object(o.a)("PrimaryButton",["theme","styles"],!0)],t)}(r.Component)},1286:function(e,t,i){"use strict";var n=i(768),r=i(3),a=i(0),o=i(604),s=i(713),c=i(622),l=Object(s.a)(),u=function(e,t){a.useImperativeHandle(e.componentRef,(function(){return{focus:function(){t.current&&t.current.focus()}}}),[t])},d=function(e,t){t.as;var i=t.disabled,n=t.target,a=t.href,o=(t.theme,t.getStyles,t.styles,t.componentRef,t.underline,Object(r.__rest)(t,["as","disabled","target","href","theme","getStyles","styles","componentRef","underline"]));return"string"==typeof e?"a"===e?Object(r.__assign)({target:n,href:i?void 0:a},o):"button"===e?Object(r.__assign)({type:"button",disabled:i},o):Object(r.__assign)(Object(r.__assign)({},o),{disabled:i}):Object(r.__assign)({target:n,href:a,disabled:i},o)},h=a.forwardRef((function(e,t){var i=function(e,t){var i=e.as,n=e.className,s=e.disabled,h=e.href,g=e.onClick,f=e.styles,p=e.theme,m=e.underline,b=a.useRef(null),y=Object(o.a)(b,t);u(e,b),Object(c.b)(b);var v=l(f,{className:n,isButton:!h,isDisabled:s,isUnderlined:m,theme:p}),_=i||(h?"a":"button");return{state:{},slots:{root:_},slotProps:{root:Object(r.__assign)(Object(r.__assign)({},d(_,e)),{"aria-disabled":s,className:v.root,onClick:function(e){s?e.preventDefault():g&&g(e)},ref:y})}}}(e,t),n=i.slots,s=i.slotProps;return a.createElement(n.root,Object(r.__assign)({},s.root))}));h.displayName="LinkBase";var g=i(7),f={root:"ms-Link"};i.d(t,"a",(function(){return p}));var p=Object(n.a)(h,(function(e){var t,i,n,r,a,o,s=e.className,c=e.isButton,l=e.isDisabled,u=e.isUnderlined,d=e.theme,h=d.semanticColors,p=h.link,m=h.linkHovered,b=h.disabledText,y=h.focusBorder,v=Object(g.getGlobalClassNames)(f,d);return{root:[v.root,d.fonts.medium,{color:p,outline:"none",fontSize:"inherit",fontWeight:"inherit",textDecoration:u?"underline":"none",selectors:(t={".ms-Fabric--isFocusVisible &:focus":{boxShadow:"0 0 0 1px "+y+" inset",outline:"1px auto "+y,selectors:(i={},i[g.HighContrastSelector]={outline:"1px solid WindowText"},i)}},t[g.HighContrastSelector]={borderBottom:"none"},t)},c&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:(n={},n[g.HighContrastSelector]={color:"LinkText",forcedColorAdjust:"none"},n)},!c&&{selectors:(r={},r[g.HighContrastSelector]={MsHighContrastAdjust:"auto",forcedColorAdjust:"auto"},r)},l&&["is-disabled",{color:b,cursor:"default"},{selectors:{"&:link, &:visited":{pointerEvents:"none"}}}],!l&&{selectors:{"&:active, &:hover, &:active:hover":{color:m,textDecoration:"underline",selectors:(a={},a[g.HighContrastSelector]={color:"LinkText"},a)},"&:focus":{color:p,selectors:(o={},o[g.HighContrastSelector]={color:"LinkText"},o)}}},v.root,s]}}),void 0,{scope:"Link"})},1294:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(44),r=i(873);function a(e,t){Object.keys(r.a).some((function(i){return r.a[i]==t&&(Object(n.h)(e,{key:i,id:t},{isCore:!0}),!0)}))}},1339:function(e,t,i){"use strict";var n=i(771);i.d(t,"a",(function(){return n.b}))},16395:function(e){e.exports=JSON.parse('{"b":"qkc","a":"rkc","i":"skc","e":"tkc","f":"ukc","h":"vkc","g":"wkc","d":"xkc","c":"ykc","j":"zkc"}')},16396:function(e,t,i){(t=e.exports=i(77)(!1)).push([e.i,'._2vu6nHbBMYeBeGWSvjGGe3{color:"[theme:themePrimary, default:#0078D4]";font-size:16px}html[dir=ltr] ._2vu6nHbBMYeBeGWSvjGGe3{margin-right:5px}html[dir=rtl] ._2vu6nHbBMYeBeGWSvjGGe3{margin-left:5px}._2ES3fWQLAEojIJTfsimZI4{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}._2ES3fWQLAEojIJTfsimZI4,._1B1cG4KkIkBXxwvZHW7GGW{display:-webkit-box;display:-ms-flexbox;display:flex}._1B1cG4KkIkBXxwvZHW7GGW{min-width:0!important}html[dir] ._1B1cG4KkIkBXxwvZHW7GGW{padding:6px;border:1px solid;border-color:"[theme:neutralLight, default:#edebe9]"!important}html[dir=ltr] ._1B1cG4KkIkBXxwvZHW7GGW{-webkit-box-shadow:2px 2px "[theme:neutralLight, default:#edebe9]";box-shadow:2px 2px "[theme:neutralLight, default:#edebe9]"}html[dir=rtl] ._1B1cG4KkIkBXxwvZHW7GGW{-webkit-box-shadow:-2px 2px "[theme:neutralLight, default:#edebe9]";box-shadow:-2px 2px "[theme:neutralLight, default:#edebe9]"}html[dir] ._1B1cG4KkIkBXxwvZHW7GGW:hover{background-color:"[theme:neutralLighterAlt, default:#faf9f8]"}.CtFKmac3lOrS-OaDyX4Pj{color:"[theme:themeDark, default:#0D62AA]";font-size:12px}._3rwNwM0PfIa6B2e-BrohjF{color:"[theme:themePrimary, default:#0078D4]";font-weight:700;font-size:14px;font-weight:400}html[dir=ltr] ._3rwNwM0PfIa6B2e-BrohjF{margin-right:3px}html[dir=rtl] ._3rwNwM0PfIa6B2e-BrohjF{margin-left:3px}._3rwNwM0PfIa6B2e-BrohjF._2U8NfTxNV9779HJvK3SpmC{display:none}.qNBF68_DAEGvoOurje0Jy{font-size:14px;font-weight:400;width:292px;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;display:-webkit-box;display:-ms-flexbox;display:flex}html[dir] .qNBF68_DAEGvoOurje0Jy{margin:15px 15px 7px 15px}._160mp_Po1qvAddzJWUD56D{color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] ._12QqW0IKgo0CaT4lCC2udh{padding:10px 15px 10px 5px}html[dir=rtl] ._12QqW0IKgo0CaT4lCC2udh{padding:10px 5px 10px 15px}.ZFd6ioKVXyTRkmnz8z8AF{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}html[dir] .ZFd6ioKVXyTRkmnz8z8AF{background-color:"[theme:neutralLight, default:#edebe9]"}._16auZW0uSiGbxCcy5KAM9X{font-size:14px;font-weight:400;font-weight:700}html[dir] ._14K7rZiTBxnBkUZTZveLV8{margin-top:7px}._2wgViKiTD8LcrYUtE8Nl8F{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}html[dir] ._2wgViKiTD8LcrYUtE8Nl8F{padding-top:10px}html[dir=ltr] ._2wgViKiTD8LcrYUtE8Nl8F{padding-right:10px}html[dir=rtl] ._2wgViKiTD8LcrYUtE8Nl8F{padding-left:10px}.Ujife4nUKFI71K6CECbHy{width:338px}html[dir] ._20pRI38bnovOjueH0x5mX-{padding:30px 10px 30px 10px!important}._1c90dGgjETpXc5wSUK-GX0{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}html[dir] ._1c90dGgjETpXc5wSUK-GX0{padding-bottom:20px}._1S0D_60rcy6LiZF4SmOSy-{-ms-flex-item-align:center;align-self:center}html[dir] ._1S0D_60rcy6LiZF4SmOSy-{padding-top:25px}html[dir=ltr] ._1S0D_60rcy6LiZF4SmOSy-{padding-left:24px}html[dir=rtl] ._1S0D_60rcy6LiZF4SmOSy-{padding-right:24px}._3FsjbnMHqbOe95d0uO3Dx{-ms-flex-item-align:center;align-self:center}html[dir] ._3FsjbnMHqbOe95d0uO3Dx{padding-top:10px}html[dir=ltr] ._3FsjbnMHqbOe95d0uO3Dx{padding-left:24px}html[dir=rtl] ._3FsjbnMHqbOe95d0uO3Dx{padding-right:24px}._3n0QDMOghSjefXJF9Eqkqp{font-size:17px;font-weight:300;color:"[theme:themePrimary, default:#0078D4]";-ms-flex-item-align:center;align-self:center;font-size:16px;font-weight:600}html[dir] ._3n0QDMOghSjefXJF9Eqkqp{padding-top:10px}._3irJridJew5-I084uJvETr{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}html[dir] ._3irJridJew5-I084uJvETr{padding-top:20px}.re-atOySKAJZv1OiOrHwZ{font-size:12px}html[dir] .re-atOySKAJZv1OiOrHwZ{text-align:center;padding-top:10px}._2PUBWaPuzz8jgy0AQlRCiJ .ms-Dialog-main{max-width:450px}html[dir=ltr] .pIucPmrgZovuHrgmbi-rP{padding-left:5px}html[dir=rtl] .pIucPmrgZovuHrgmbi-rP{padding-right:5px}._2oP95ia0WbqNecorS6f8Tx{font-size:12px}html[dir=ltr] ._2oP95ia0WbqNecorS6f8Tx{padding-right:5px}html[dir=rtl] ._2oP95ia0WbqNecorS6f8Tx{padding-left:5px}._3h2F0teYDuRazaFSQGdJRS{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}._3JH7ifM1YpFA9XfAW2o6J5{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}html[dir=ltr] ._3JH7ifM1YpFA9XfAW2o6J5{margin-left:10px}html[dir=rtl] ._3JH7ifM1YpFA9XfAW2o6J5{margin-right:10px}._3qMg1YOJiia_YaMhCuIYee{font-size:16px}html[dir=ltr] ._3qMg1YOJiia_YaMhCuIYee{margin-right:5px}html[dir=rtl] ._3qMg1YOJiia_YaMhCuIYee{margin-left:5px}._27zGQv1frAPXlY0DgTCfYi{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.vZ_C1XniS451KdCLhUbwG{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}html[dir=ltr] .vZ_C1XniS451KdCLhUbwG{margin-left:10px}html[dir=rtl] .vZ_C1XniS451KdCLhUbwG{margin-right:10px}._2FMKhdNh1d6HmyTnzAxtUB{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}html[dir=ltr] ._2FMKhdNh1d6HmyTnzAxtUB{margin-right:8px}html[dir=rtl] ._2FMKhdNh1d6HmyTnzAxtUB{margin-left:8px}',""]),t.locals={skittleDiamonIcon:"_2vu6nHbBMYeBeGWSvjGGe3",skittleContainer:"_2ES3fWQLAEojIJTfsimZI4",skittleInfo:"_1B1cG4KkIkBXxwvZHW7GGW",goPremiumLink:"CtFKmac3lOrS-OaDyX4Pj",skittleCount:"_3rwNwM0PfIa6B2e-BrohjF",hideCount:"_2U8NfTxNV9779HJvK3SpmC",skittleCountContainer:"qNBF68_DAEGvoOurje0Jy",premimumFlagsFound:"_160mp_Po1qvAddzJWUD56D",linkInnerContainer:"_12QqW0IKgo0CaT4lCC2udh",linkContainer:"ZFd6ioKVXyTRkmnz8z8AF",calloutTitle:"_16auZW0uSiGbxCcy5KAM9X",skittleCalloutTextContainer:"_14K7rZiTBxnBkUZTZveLV8",editorImage:"_2wgViKiTD8LcrYUtE8Nl8F",premPrevSkittleContainer:"Ujife4nUKFI71K6CECbHy",calloutPP:"_20pRI38bnovOjueH0x5mX-",innerContainerPP:"_1c90dGgjETpXc5wSUK-GX0",editorPremPrevImage:"_1S0D_60rcy6LiZF4SmOSy-",editorPremPrevImageDialog:"_3FsjbnMHqbOe95d0uO3Dx",premPrevTitle:"_3n0QDMOghSjefXJF9Eqkqp",premPrevbuttonsContainer:"_3irJridJew5-I084uJvETr",editorPremPrevText:"re-atOySKAJZv1OiOrHwZ",dialogBox:"_2PUBWaPuzz8jgy0AQlRCiJ",premimumpreviewDaysText:"pIucPmrgZovuHrgmbi-rP",goPremiumText:"_2oP95ia0WbqNecorS6f8Tx",skittleCalloutContainer:"_3h2F0teYDuRazaFSQGdJRS",goPremiumButoon:"_3JH7ifM1YpFA9XfAW2o6J5",premiumPreviewDiamonIcon:"_3qMg1YOJiia_YaMhCuIYee",buttonsContainer:"_27zGQv1frAPXlY0DgTCfYi",dialogGoPrem:"vZ_C1XniS451KdCLhUbwG",tryNowButton:"_2FMKhdNh1d6HmyTnzAxtUB"}},16397:function(e,t,i){e.exports=i.p+"../resources/images/EditorUpsell-0f681fbff6a93db2b22ebeed8d01405e.svg"},16398:function(e,t,i){e.exports=i.p+"../resources/images/EditorImage-cbf82dda59d4ed6e4d355723c49c493b.svg"},16399:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,a){function o(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?r(e.value):new i((function(t){t(e.value)})).then(o,s)}c((n=n.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var i,n,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[0,r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{i=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(16400),o=i(4328),s=i(5234),c=i(3593),l=i(11818),u=i(16401),d=i(16408),h=i(16410),g=i(6269),f=i(7593),p=i(16413),m=i(16414),b=function(){function e(e){var t=e||{};if("object"!=typeof t)throw new Error(""+o.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===t.defaultScope)t.defaultScope=s.BindingScopeEnum.Transient;else if(t.defaultScope!==s.BindingScopeEnum.Singleton&&t.defaultScope!==s.BindingScopeEnum.Transient&&t.defaultScope!==s.BindingScopeEnum.Request)throw new Error(""+o.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+o.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+o.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=g.id(),this._bindingDictionary=new m.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new l.MetadataReader}return e.merge=function(t,i){var n=new e,r=u.getBindingDictionary(n),a=u.getBindingDictionary(t),o=u.getBindingDictionary(i);function s(e,t){e.traverse((function(e,i){i.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}return s(a,r),s(o,r),n},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=this._getContainerModuleHelpersFactory(),n=0,r=e;n<r.length;n++){var a=r[n],o=i(a.id);a.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n(this,void 0,void 0,(function(){var t,i,n,a,o;return r(this,(function(r){switch(r.label){case 0:t=this._getContainerModuleHelpersFactory(),i=0,n=e,r.label=1;case 1:return i<n.length?(a=n[i],o=t(a.id),[4,a.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction)]):[3,4];case 2:r.sent(),r.label=3;case 3:return i++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=function(e){return function(t){return t.moduleId===e}};t.forEach((function(t){var i=n(t.id);e._bindingDictionary.removeByCondition(i)}))},e.prototype.bind=function(e){var t=this.options.defaultScope||s.BindingScopeEnum.Transient,i=new a.Binding(e,t);return this._bindingDictionary.add(e,i),new h.BindingToSyntax(i)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(o.CANNOT_UNBIND+" "+f.getServiceIdentifierAsString(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new m.Lookup},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,c.NAMED_TAG,t)},e.prototype.isBoundTagged=function(e,t,i){var n=!1;if(this._bindingDictionary.hasKey(e)){var r=this._bindingDictionary.get(e),a=u.createMockRequest(this,e,t,i);n=r.some((function(e){return e.constraint(a)}))}return!n&&this.parent&&(n=this.parent.isBoundTagged(e,t,i)),n},e.prototype.snapshot=function(){this._snapshots.push(p.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(o.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var i=new e(t||this.options);return i.parent=this,i},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),i)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,s.TargetTypeEnum.Variable,e)},e.prototype.getTagged=function(e,t,i){return this._get(!1,!1,s.TargetTypeEnum.Variable,e,t,i)},e.prototype.getNamed=function(e,t){return this.getTagged(e,c.NAMED_TAG,t)},e.prototype.getAll=function(e){return this._get(!0,!0,s.TargetTypeEnum.Variable,e)},e.prototype.getAllTagged=function(e,t,i){return this._get(!1,!0,s.TargetTypeEnum.Variable,e,t,i)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,c.NAMED_TAG,t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},i=function(i){return function(n){var r=e.rebind.bind(e)(n);return t(r,i),r}};return function(n){return{bindFunction:(r=n,function(i){var n=e.bind.bind(e)(i);return t(n,r),n}),isboundFunction:function(t){return e.isBound.bind(e)(t)},rebindFunction:i(n),unbindFunction:function(t){e.unbind.bind(e)(t)}};var r}},e.prototype._get=function(e,t,i,n,r,a){var s=null,c={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:r,serviceIdentifier:n,targetType:i,value:a};if(this._middleware){if(null==(s=this._middleware(c)))throw new Error(o.INVALID_MIDDLEWARE_RETURN)}else s=this._planAndResolve()(c);return s},e.prototype._planAndResolve=function(){var e=this;return function(t){var i=u.plan(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return i=t.contextInterceptor(i),d.resolve(i)}},e}();t.Container=b},16400:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5234),r=i(6269),a=function(){function e(e,t){this.id=r.id(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=n.BindingTypeEnum.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=!1,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}();t.Binding=a},16401:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(16402),r=i(4328),a=i(5234),o=i(3593),s=i(11819),c=i(7593),l=i(16403),u=i(4736),d=i(16404),h=i(16405),g=i(16407),f=i(11821);function p(e){return e._bindingDictionary}function m(e,t,i,a,o){var s=b(i.container,o.serviceIdentifier),l=[];return s.length===n.BindingCount.NoBindingsAvailable&&i.container.options.autoBindInjectable&&"function"==typeof o.serviceIdentifier&&e.getConstructorMetadata(o.serviceIdentifier).compilerGeneratedMetadata&&(i.container.bind(o.serviceIdentifier).toSelf(),s=b(i.container,o.serviceIdentifier)),l=t?s:s.filter((function(e){var t=new g.Request(e.serviceIdentifier,i,a,e,o);return e.constraint(t)})),function(e,t,i,a){switch(t.length){case n.BindingCount.NoBindingsAvailable:if(i.isOptional())return t;var o=c.getServiceIdentifierAsString(e),s=r.NOT_REGISTERED;throw s+=c.listMetadataForTarget(o,i),s+=c.listRegisteredBindingsForServiceIdentifier(a,o,b),new Error(s);case n.BindingCount.OnlyOneBindingAvailable:if(!i.isArray())return t;case n.BindingCount.MultipleBindingsAvailable:default:if(i.isArray())return t;o=c.getServiceIdentifierAsString(e),s=r.AMBIGUOUS_MATCH+" "+o;throw s+=c.listRegisteredBindingsForServiceIdentifier(a,o,b),new Error(s)}}(o.serviceIdentifier,l,o,i.container),l}function b(e,t){var i=[],n=p(e);return n.hasKey(t)?i=n.get(t):null!==e.parent&&(i=b(e.parent,t)),i}t.getBindingDictionary=p,t.plan=function(e,t,i,n,p,b,y,v){void 0===v&&(v=!1);var _=new l.Context(t),I=function(e,t,i,n,r,a){var s=e?o.MULTI_INJECT_TAG:o.INJECT_TAG,c=new u.Metadata(s,i),l=new f.Target(t,n,i,c);if(void 0!==r){var d=new u.Metadata(r,a);l.metadata.push(d)}return l}(i,n,p,"",b,y);try{return function e(t,i,n,o,s,c){var l,u;if(null===s){l=m(t,i,o,null,c),u=new g.Request(n,o,null,l,c);var f=new d.Plan(o,u);o.addPlan(f)}else l=m(t,i,o,s,c),u=s.addChildRequest(c.serviceIdentifier,l,c);l.forEach((function(i){var n=null;if(c.isArray())n=u.addChildRequest(i.serviceIdentifier,i,c);else{if(i.cache)return;n=u}if(i.type===a.BindingTypeEnum.Instance&&null!==i.implementationType){var s=h.getDependencies(t,i.implementationType);if(!o.container.options.skipBaseClassChecks){var l=h.getBaseClassDependencyCount(t,i.implementationType);if(s.length<l){var d=r.ARGUMENTS_LENGTH_MISMATCH(h.getFunctionName(i.implementationType));throw new Error(d)}}s.forEach((function(i){e(t,!1,i.serviceIdentifier,o,n,i)}))}}))}(e,v,p,_,null,I),_}catch(e){throw s.isStackOverflowExeption(e)&&_.plan&&c.circularDependencyToException(_.plan.rootRequest),e}},t.createMockRequest=function(e,t,i,n){var r=new f.Target(a.TargetTypeEnum.Variable,"",t,new u.Metadata(i,n)),o=new l.Context(e);return new g.Request(t,o,null,[],r)}},16402:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},16403:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(6269),r=function(){function e(e){this.id=n.id(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}();t.Context=r},16404:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){this.parentContext=e,this.rootRequest=t};t.Plan=n},16405:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(11820),r=i(4328),a=i(5234),o=i(3593),s=i(7593);t.getFunctionName=s.getFunctionName;var c=i(11821);function l(e,t,i,n){var o=e.getConstructorMetadata(i),s=o.compilerGeneratedMetadata;if(void 0===s){var l=r.MISSING_INJECTABLE_ANNOTATION+" "+t+".";throw new Error(l)}var h=o.userGeneratedMetadata,g=Object.keys(h),f=function(e,t,i,n,r){for(var a=[],o=0;o<r;o++){var s=u(o,e,t,i,n);null!==s&&a.push(s)}return a}(n,t,s,h,0===i.length&&g.length>0?g.length:i.length),p=function e(t,i){for(var n=t.getPropertiesMetadata(i),r=[],o=Object.keys(n),s=0,l=o;s<l.length;s++){var u=l[s],h=n[u],g=d(n[u]),f=g.targetName||u,p=g.inject||g.multiInject,m=new c.Target(a.TargetTypeEnum.ClassProperty,f,p);m.metadata=h,r.push(m)}var b=Object.getPrototypeOf(i.prototype).constructor;if(b!==Object){var y=e(t,b);r=r.concat(y)}return r}(e,i);return f.concat(p)}function u(e,t,i,o,s){var l=s[e.toString()]||[],u=d(l),h=!0!==u.unmanaged,g=o[e],f=u.inject||u.multiInject;if((g=f||g)instanceof n.LazyServiceIdentifer&&(g=g.unwrap()),h){if(!t&&(g===Object||g===Function||void 0===g)){var p=r.MISSING_INJECT_ANNOTATION+" argument "+e+" in class "+i+".";throw new Error(p)}var m=new c.Target(a.TargetTypeEnum.ConstructorArgument,u.targetName,g);return m.metadata=l,m}return null}function d(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[o.INJECT_TAG],multiInject:t[o.MULTI_INJECT_TAG],targetName:t[o.NAME_TAG],unmanaged:t[o.UNMANAGED_TAG]}}t.getDependencies=function(e,t){return l(e,s.getFunctionName(t),t,!1)},t.getBaseClassDependencyCount=function e(t,i){var n=Object.getPrototypeOf(i.prototype).constructor;if(n!==Object){var r=l(t,s.getFunctionName(n),n,!0),a=r.map((function(e){return e.metadata.filter((function(e){return e.key===o.UNMANAGED_TAG}))})),c=[].concat.apply([],a).length,u=r.length-c;return u>0?u:e(t,n)}return 0}},16406:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,i=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},i)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}();t.QueryableString=n},16407:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(6269),r=function(){function e(e,t,i,r,a){this.id=n.id(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=i,this.target=a,this.childRequests=[],this.bindings=Array.isArray(r)?r:[r],this.requestScope=null===i?new Map:null}return e.prototype.addChildRequest=function(t,i,n){var r=new e(t,this.parentContext,this,i,n);return this.childRequests.push(r),r},e}();t.Request=r},16408:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(4328),r=i(5234),a=i(11819),o=i(7593),s=i(16409),c=function(e,t,i){try{return i()}catch(i){throw a.isStackOverflowExeption(i)?new Error(n.CIRCULAR_DEPENDENCY_IN_FACTORY(e,t.toString())):i}},l=function(e){return function(t){t.parentContext.setCurrentRequest(t);var i=t.bindings,a=t.childRequests,u=t.target&&t.target.isArray(),d=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(u&&d)return a.map((function(t){return l(e)(t)}));var h=null;if(!t.target.isOptional()||0!==i.length){var g=i[0],f=g.scope===r.BindingScopeEnum.Singleton,p=g.scope===r.BindingScopeEnum.Request;if(f&&g.activated)return g.cache;if(p&&null!==e&&e.has(g.id))return e.get(g.id);if(g.type===r.BindingTypeEnum.ConstantValue)h=g.cache;else if(g.type===r.BindingTypeEnum.Function)h=g.cache;else if(g.type===r.BindingTypeEnum.Constructor)h=g.implementationType;else if(g.type===r.BindingTypeEnum.DynamicValue&&null!==g.dynamicValue)h=c("toDynamicValue",g.serviceIdentifier,(function(){return g.dynamicValue(t.parentContext)}));else if(g.type===r.BindingTypeEnum.Factory&&null!==g.factory)h=c("toFactory",g.serviceIdentifier,(function(){return g.factory(t.parentContext)}));else if(g.type===r.BindingTypeEnum.Provider&&null!==g.provider)h=c("toProvider",g.serviceIdentifier,(function(){return g.provider(t.parentContext)}));else{if(g.type!==r.BindingTypeEnum.Instance||null===g.implementationType){var m=o.getServiceIdentifierAsString(t.serviceIdentifier);throw new Error(n.INVALID_BINDING_TYPE+" "+m)}h=s.resolveInstance(g.implementationType,a,l(e))}return"function"==typeof g.onActivation&&(h=g.onActivation(t.parentContext,h)),f&&(g.cache=h,g.activated=!0),p&&null!==e&&!e.has(g.id)&&e.set(g.id,h),h}}};t.resolve=function(e){return l(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}},16409:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(4328),r=i(5234),a=i(3593);t.resolveInstance=function(e,t,i){var o,s,c=null;if(t.length>0){var l=t.filter((function(e){return null!==e.target&&e.target.type===r.TargetTypeEnum.ConstructorArgument})).map(i);s=l,c=function(e,t,i){var n=t.filter((function(e){return null!==e.target&&e.target.type===r.TargetTypeEnum.ClassProperty})),a=n.map(i);return n.forEach((function(t,i){var n;n=t.target.name.value();var r=a[i];e[n]=r})),e}(c=new((o=e).bind.apply(o,[void 0].concat(s))),t,i)}else c=new e;return function(e,t){if(Reflect.hasMetadata(a.POST_CONSTRUCT,e)){var i=Reflect.getMetadata(a.POST_CONSTRUCT,e);try{t[i.value]()}catch(t){throw new Error(n.POST_CONSTRUCT_ERROR(e.name,t.message))}}}(e,c),c}},16410:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(4328),r=i(5234),a=i(16411),o=i(11822),s=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=r.BindingTypeEnum.Instance,this._binding.implementationType=e,new a.BindingInWhenOnSyntax(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+n.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=r.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,new o.BindingWhenOnSyntax(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=r.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new a.BindingInWhenOnSyntax(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=r.BindingTypeEnum.Constructor,this._binding.implementationType=e,new o.BindingWhenOnSyntax(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=r.BindingTypeEnum.Factory,this._binding.factory=e,new o.BindingWhenOnSyntax(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(n.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=r.BindingTypeEnum.Function,t},e.prototype.toAutoFactory=function(e){return this._binding.type=r.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},new o.BindingWhenOnSyntax(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=r.BindingTypeEnum.Provider,this._binding.provider=e,new o.BindingWhenOnSyntax(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}();t.BindingToSyntax=s},16411:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(16412),r=i(10031),a=i(10032),o=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new a.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding),this._bindingInSyntax=new n.BindingInSyntax(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingInWhenOnSyntax=o},16412:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5234),r=i(11822),a=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=n.BindingScopeEnum.Request,new r.BindingWhenOnSyntax(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=n.BindingScopeEnum.Singleton,new r.BindingWhenOnSyntax(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=n.BindingScopeEnum.Transient,new r.BindingWhenOnSyntax(this._binding)},e}();t.BindingInSyntax=a},16413:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.of=function(t,i){var n=new e;return n.bindings=t,n.middleware=i,n},e}();t.ContainerSnapshot=n},16414:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(4328),r=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(n.NULL_ARGUMENT);if(null==t)throw new Error(n.NULL_ARGUMENT);var i=this._map.get(e);void 0!==i?(i.push(t),this._map.set(e,i)):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(n.NULL_ARGUMENT);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(n.KEY_NOT_FOUND)},e.prototype.remove=function(e){if(null==e)throw new Error(n.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(n.KEY_NOT_FOUND)},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach((function(i,n){var r=i.filter((function(t){return!e(t)}));r.length>0?t._map.set(n,r):t._map.delete(n)}))},e.prototype.hasKey=function(e){if(null==e)throw new Error(n.NULL_ARGUMENT);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,i){e.forEach((function(e){return t.add(i,e.clone())}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,i){e(i,t)}))},e}();t.Lookup=r},16415:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(6269),r=function(e){this.id=n.id(),this.registry=e};t.ContainerModule=r;var a=function(e){this.id=n.id(),this.registry=e};t.AsyncContainerModule=a},16416:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(4328),r=i(3593);t.injectable=function(){return function(e){if(Reflect.hasOwnMetadata(r.PARAM_TYPES,e))throw new Error(n.DUPLICATED_INJECTABLE_DECORATOR);var t=Reflect.getMetadata(r.DESIGN_PARAM_TYPES,e)||[];return Reflect.defineMetadata(r.PARAM_TYPES,t,e),e}}},16417:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(4736),r=i(5686);t.tagged=function(e,t){return function(i,a,o){var s=new n.Metadata(e,t);"number"==typeof o?r.tagParameter(i,a,o,s):r.tagProperty(i,a,s)}}},16418:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(3593),r=i(4736),a=i(5686);t.named=function(e){return function(t,i,o){var s=new r.Metadata(n.NAMED_TAG,e);"number"==typeof o?a.tagParameter(t,i,o,s):a.tagProperty(t,i,s)}}},16419:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(3593),r=i(4736),a=i(5686);t.optional=function(){return function(e,t,i){var o=new r.Metadata(n.OPTIONAL_TAG,!0);"number"==typeof i?a.tagParameter(e,t,i,o):a.tagProperty(e,t,o)}}},16420:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(3593),r=i(4736),a=i(5686);t.unmanaged=function(){return function(e,t,i){var o=new r.Metadata(n.UNMANAGED_TAG,!0);a.tagParameter(e,t,i,o)}}},16421:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(3593),r=i(4736),a=i(5686);t.multiInject=function(e){return function(t,i,o){var s=new r.Metadata(n.MULTI_INJECT_TAG,e);"number"==typeof o?a.tagParameter(t,i,o,s):a.tagProperty(t,i,s)}}},16422:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(3593),r=i(4736),a=i(5686);t.targetName=function(e){return function(t,i,o){var s=new r.Metadata(n.NAME_TAG,e);a.tagParameter(t,i,o,s)}}},16423:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(4328),r=i(3593),a=i(4736);t.postConstruct=function(){return function(e,t,i){var o=new a.Metadata(r.POST_CONSTRUCT,t);if(Reflect.hasOwnMetadata(r.POST_CONSTRUCT,e.constructor))throw new Error(n.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(r.POST_CONSTRUCT,o,e.constructor)}}},16424:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multiBindToService=function(e){return function(t){return function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return i.forEach((function(i){return e.bind(i).toService(t)}))}}}},16425:function(e,t,i){"use strict";t.__esModule=!0;var n=function(e,t){for(var i=!1,n=0;n<e.length;n+=1)e[n]===t&&(i=!0,e.splice(n,1),n-=1);return i},r=function(){function e(){this.anyRegistrations=[],this.registrations={}}return e.prototype.on=function(e,t){this.safelyGetRegistration(e).listeners.push(t)},e.prototype.onFirst=function(e,t){var i=this.safelyGetRegistration(e);void 0!==i.firstArgs&&t.apply(void 0,i.firstArgs),i.firstOnlyListeners.push(t)},e.prototype.onAny=function(e){this.anyRegistrations.push(e)},e.prototype.off=function(e,t){if(void 0!==e)if(void 0!==t){var i=this.safelyGetRegistration(e),r=n(i.listeners,t),a=n(i.firstOnlyListeners,t);if(!r&&!a)throw new Error("Tried to remove a non-existent listener for event name '"+e+"'.")}else this.registrations[e]={firstOnlyListeners:[],listeners:[]};else this.registrations={}},e.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n=this.safelyGetRegistration(e);if(void 0===n.firstArgs){for(var r=0,a=n.firstOnlyListeners;r<a.length;r++){var o=a[r];o.apply(void 0,t)}n.firstArgs=t,n.firstOnlyListeners=[]}for(var s=0,c=n.listeners;s<c.length;s++){c[s].apply(void 0,t)}for(var l=0,u=this.anyRegistrations;l<u.length;l++){u[l].apply(void 0,[e].concat(t))}},e.prototype.waitFor=function(e){var t=this;return new Promise((function(i){var n=function(r){i(r),t.off(e,n)};t.on(e,n)}))},e.prototype.waitForFirst=function(e){var t=this;return new Promise((function(i){var n=function(r){i(r),t.off(e,n)};t.onFirst(e,n)}))},e.prototype.safelyGetRegistration=function(e){return void 0===this.registrations[e]&&(this.registrations[e]={firstOnlyListeners:[],listeners:[]}),this.registrations[e]},e}();t.EventEmitter=r,t.Squee=r},16426:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(10029);const r={ICalloutFocusManager:Object(n.a)("ICalloutFocusManager"),ICritiqueCalloutStateStore:Object(n.a)("ICritiqueCalloutStateStore"),IDropdownStateStoreFactory:Object(n.a)("IDropdownStateStoreFactory"),ISuggestionButtonStateStoreFactory:Object(n.a)("ISuggestionButtonStateStoreFactory")}},16437:function(e,t,i){var n=i(16438),r=i(16439),a=r;a.v1=n,a.v4=r,e.exports=a},16438:function(e,t,i){var n,r,a=i(11837),o=i(11838),s=0,c=0;e.exports=function(e,t,i){var l=t&&i||0,u=t||[],d=(e=e||{}).node||n,h=void 0!==e.clockseq?e.clockseq:r;if(null==d||null==h){var g=a();null==d&&(d=n=[1|g[0],g[1],g[2],g[3],g[4],g[5]]),null==h&&(h=r=16383&(g[6]<<8|g[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:c+1,m=f-s+(p-c)/1e4;if(m<0&&void 0===e.clockseq&&(h=h+1&16383),(m<0||f>s)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=f,c=p,r=h;var b=(1e4*(268435455&(f+=122192928e5))+p)%4294967296;u[l++]=b>>>24&255,u[l++]=b>>>16&255,u[l++]=b>>>8&255,u[l++]=255&b;var y=f/4294967296*1e4&268435455;u[l++]=y>>>8&255,u[l++]=255&y,u[l++]=y>>>24&15|16,u[l++]=y>>>16&255,u[l++]=h>>>8|128,u[l++]=255&h;for(var v=0;v<6;++v)u[l+v]=d[v];return t||o(u)}},16439:function(e,t,i){var n=i(11837),r=i(11838);e.exports=function(e,t,i){var a=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||n)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;++s)t[a+s]=o[s];return t||r(o)}},16440:function(e,t,i){var n=i(16441),r=i(16442),a=r;a.v1=n,a.v4=r,e.exports=a},16441:function(e,t,i){var n,r,a=i(11842),o=i(11843),s=0,c=0;e.exports=function(e,t,i){var l=t&&i||0,u=t||[],d=(e=e||{}).node||n,h=void 0!==e.clockseq?e.clockseq:r;if(null==d||null==h){var g=a();null==d&&(d=n=[1|g[0],g[1],g[2],g[3],g[4],g[5]]),null==h&&(h=r=16383&(g[6]<<8|g[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:c+1,m=f-s+(p-c)/1e4;if(m<0&&void 0===e.clockseq&&(h=h+1&16383),(m<0||f>s)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=f,c=p,r=h;var b=(1e4*(268435455&(f+=122192928e5))+p)%4294967296;u[l++]=b>>>24&255,u[l++]=b>>>16&255,u[l++]=b>>>8&255,u[l++]=255&b;var y=f/4294967296*1e4&268435455;u[l++]=y>>>8&255,u[l++]=255&y,u[l++]=y>>>24&15|16,u[l++]=y>>>16&255,u[l++]=h>>>8|128,u[l++]=255&h;for(var v=0;v<6;++v)u[l+v]=d[v];return t||o(u)}},16442:function(e,t,i){var n=i(11842),r=i(11843);e.exports=function(e,t,i){var a=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||n)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;++s)t[a+s]=o[s];return t||r(o)}},16443:function(e,t){function i(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}i.Diff,i.prototype.diff_main=function(e,t,i,n){void 0===n&&(n=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var r=n;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[[0,e]]:[];void 0===i&&(i=!0);var a=i,o=this.diff_commonPrefix(e,t),s=e.substring(0,o);e=e.substring(o),t=t.substring(o),o=this.diff_commonSuffix(e,t);var c=e.substring(e.length-o);e=e.substring(0,e.length-o),t=t.substring(0,t.length-o);var l=this.diff_compute_(e,t,a,r);return s&&l.unshift([0,s]),c&&l.push([0,c]),this.diff_cleanupMerge(l),l},i.prototype.diff_compute_=function(e,t,i,n){var r;if(!e)return[[1,t]];if(!t)return[[-1,e]];var a=e.length>t.length?e:t,o=e.length>t.length?t:e,s=a.indexOf(o);if(-1!=s)return r=[[1,a.substring(0,s)],[0,o],[1,a.substring(s+o.length)]],e.length>t.length&&(r[0][0]=r[2][0]=-1),r;if(1==o.length)return[[-1,e],[1,t]];var c=this.diff_halfMatch_(e,t);if(c){var l=c[0],u=c[1],d=c[2],h=c[3],g=c[4],f=this.diff_main(l,d,i,n),p=this.diff_main(u,h,i,n);return f.concat([[0,g]],p)}return i&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,n):this.diff_bisect_(e,t,n)},i.prototype.diff_lineMode_=function(e,t,i){e=(u=this.diff_linesToChars_(e,t)).chars1,t=u.chars2;var n=u.lineArray,r=this.diff_main(e,t,!1,i);this.diff_charsToLines_(r,n),this.diff_cleanupSemantic(r),r.push([0,""]);for(var a=0,o=0,s=0,c="",l="";a<r.length;){switch(r[a][0]){case 1:s++,l+=r[a][1];break;case-1:o++,c+=r[a][1];break;case 0:if(o>=1&&s>=1){r.splice(a-o-s,o+s),a=a-o-s;for(var u,d=(u=this.diff_main(c,l,!1,i)).length-1;d>=0;d--)r.splice(a,0,u[d]);a+=u.length}s=0,o=0,c="",l=""}a++}return r.pop(),r},i.prototype.diff_bisect_=function(e,t,i){for(var n=e.length,r=t.length,a=Math.ceil((n+r)/2),o=a,s=2*a,c=new Array(s),l=new Array(s),u=0;u<s;u++)c[u]=-1,l[u]=-1;c[o+1]=0,l[o+1]=0;for(var d=n-r,h=d%2!=0,g=0,f=0,p=0,m=0,b=0;b<a&&!((new Date).getTime()>i);b++){for(var y=-b+g;y<=b-f;y+=2){for(var v=o+y,_=(T=y==-b||y!=b&&c[v-1]<c[v+1]?c[v+1]:c[v-1]+1)-y;T<n&&_<r&&e.charAt(T)==t.charAt(_);)T++,_++;if(c[v]=T,T>n)f+=2;else if(_>r)g+=2;else if(h){if((C=o+d-y)>=0&&C<s&&-1!=l[C])if(T>=(S=n-l[C]))return this.diff_bisectSplit_(e,t,T,_,i)}}for(var I=-b+p;I<=b-m;I+=2){for(var S,C=o+I,E=(S=I==-b||I!=b&&l[C-1]<l[C+1]?l[C+1]:l[C-1]+1)-I;S<n&&E<r&&e.charAt(n-S-1)==t.charAt(r-E-1);)S++,E++;if(l[C]=S,S>n)m+=2;else if(E>r)p+=2;else if(!h){if((v=o+d-I)>=0&&v<s&&-1!=c[v]){var T;_=o+(T=c[v])-v;if(T>=(S=n-S))return this.diff_bisectSplit_(e,t,T,_,i)}}}}return[[-1,e],[1,t]]},i.prototype.diff_bisectSplit_=function(e,t,i,n,r){var a=e.substring(0,i),o=t.substring(0,n),s=e.substring(i),c=t.substring(n),l=this.diff_main(a,o,!1,r),u=this.diff_main(s,c,!1,r);return l.concat(u)},i.prototype.diff_linesToChars_=function(e,t){var i=[],n={};function r(e){for(var t="",r=0,a=-1,o=i.length;a<e.length-1;){-1==(a=e.indexOf("\n",r))&&(a=e.length-1);var s=e.substring(r,a+1);r=a+1,(n.hasOwnProperty?n.hasOwnProperty(s):void 0!==n[s])?t+=String.fromCharCode(n[s]):(t+=String.fromCharCode(o),n[s]=o,i[o++]=s)}return t}return i[0]="",{chars1:r(e),chars2:r(t),lineArray:i}},i.prototype.diff_charsToLines_=function(e,t){for(var i=0;i<e.length;i++){for(var n=e[i][1],r=[],a=0;a<n.length;a++)r[a]=t[n.charCodeAt(a)];e[i][1]=r.join("")}},i.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var i=0,n=Math.min(e.length,t.length),r=n,a=0;i<r;)e.substring(a,r)==t.substring(a,r)?a=i=r:n=r,r=Math.floor((n-i)/2+i);return r},i.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var i=0,n=Math.min(e.length,t.length),r=n,a=0;i<r;)e.substring(e.length-r,e.length-a)==t.substring(t.length-r,t.length-a)?a=i=r:n=r,r=Math.floor((n-i)/2+i);return r},i.prototype.diff_commonOverlap_=function(e,t){var i=e.length,n=t.length;if(0==i||0==n)return 0;i>n?e=e.substring(i-n):i<n&&(t=t.substring(0,i));var r=Math.min(i,n);if(e==t)return r;for(var a=0,o=1;;){var s=e.substring(r-o),c=t.indexOf(s);if(-1==c)return a;o+=c,0!=c&&e.substring(r-o)!=t.substring(0,o)||(a=o,o++)}},i.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var i=e.length>t.length?e:t,n=e.length>t.length?t:e;if(i.length<4||2*n.length<i.length)return null;var r=this;function a(e,t,i){for(var n,a,o,s,c=e.substring(i,i+Math.floor(e.length/4)),l=-1,u="";-1!=(l=t.indexOf(c,l+1));){var d=r.diff_commonPrefix(e.substring(i),t.substring(l)),h=r.diff_commonSuffix(e.substring(0,i),t.substring(0,l));u.length<h+d&&(u=t.substring(l-h,l)+t.substring(l,l+d),n=e.substring(0,i-h),a=e.substring(i+d),o=t.substring(0,l-h),s=t.substring(l+d))}return 2*u.length>=e.length?[n,a,o,s,u]:null}var o,s,c,l,u,d=a(i,n,Math.ceil(i.length/4)),h=a(i,n,Math.ceil(i.length/2));return d||h?(o=h?d&&d[4].length>h[4].length?d:h:d,e.length>t.length?(s=o[0],c=o[1],l=o[2],u=o[3]):(l=o[0],u=o[1],s=o[2],c=o[3]),[s,c,l,u,o[4]]):null},i.prototype.diff_cleanupSemantic=function(e){for(var t=!1,i=[],n=0,r=null,a=0,o=0,s=0,c=0,l=0;a<e.length;)0==e[a][0]?(i[n++]=a,o=c,s=l,c=0,l=0,r=e[a][1]):(1==e[a][0]?c+=e[a][1].length:l+=e[a][1].length,r&&r.length<=Math.max(o,s)&&r.length<=Math.max(c,l)&&(e.splice(i[n-1],0,[-1,r]),e[i[n-1]+1][0]=1,n--,a=--n>0?i[n-1]:-1,o=0,s=0,c=0,l=0,r=null,t=!0)),a++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),a=1;a<e.length;){if(-1==e[a-1][0]&&1==e[a][0]){var u=e[a-1][1],d=e[a][1],h=this.diff_commonOverlap_(u,d),g=this.diff_commonOverlap_(d,u);h>=g?(h>=u.length/2||h>=d.length/2)&&(e.splice(a,0,[0,d.substring(0,h)]),e[a-1][1]=u.substring(0,u.length-h),e[a+1][1]=d.substring(h),a++):(g>=u.length/2||g>=d.length/2)&&(e.splice(a,0,[0,u.substring(0,g)]),e[a-1][0]=1,e[a-1][1]=d.substring(0,d.length-g),e[a+1][0]=-1,e[a+1][1]=u.substring(g),a++),a++}a++}},i.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var n=e.charAt(e.length-1),r=t.charAt(0),a=n.match(i.nonAlphaNumericRegex_),o=r.match(i.nonAlphaNumericRegex_),s=a&&n.match(i.whitespaceRegex_),c=o&&r.match(i.whitespaceRegex_),l=s&&n.match(i.linebreakRegex_),u=c&&r.match(i.linebreakRegex_),d=l&&e.match(i.blanklineEndRegex_),h=u&&t.match(i.blanklineStartRegex_);return d||h?5:l||u?4:a&&!s&&c?3:s||c?2:a||o?1:0}for(var n=1;n<e.length-1;){if(0==e[n-1][0]&&0==e[n+1][0]){var r=e[n-1][1],a=e[n][1],o=e[n+1][1],s=this.diff_commonSuffix(r,a);if(s){var c=a.substring(a.length-s);r=r.substring(0,r.length-s),a=c+a.substring(0,a.length-s),o=c+o}for(var l=r,u=a,d=o,h=t(r,a)+t(a,o);a.charAt(0)===o.charAt(0);){r+=a.charAt(0),a=a.substring(1)+o.charAt(0),o=o.substring(1);var g=t(r,a)+t(a,o);g>=h&&(h=g,l=r,u=a,d=o)}e[n-1][1]!=l&&(l?e[n-1][1]=l:(e.splice(n-1,1),n--),e[n][1]=u,d?e[n+1][1]=d:(e.splice(n+1,1),n--))}n++}},i.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,i.whitespaceRegex_=/\s/,i.linebreakRegex_=/[\r\n]/,i.blanklineEndRegex_=/\n\r?\n$/,i.blanklineStartRegex_=/^\r?\n\r?\n/,i.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,i=[],n=0,r=null,a=0,o=!1,s=!1,c=!1,l=!1;a<e.length;)0==e[a][0]?(e[a][1].length<this.Diff_EditCost&&(c||l)?(i[n++]=a,o=c,s=l,r=e[a][1]):(n=0,r=null),c=l=!1):(-1==e[a][0]?l=!0:c=!0,r&&(o&&s&&c&&l||r.length<this.Diff_EditCost/2&&o+s+c+l==3)&&(e.splice(i[n-1],0,[-1,r]),e[i[n-1]+1][0]=1,n--,r=null,o&&s?(c=l=!0,n=0):(a=--n>0?i[n-1]:-1,c=l=!1),t=!0)),a++;t&&this.diff_cleanupMerge(e)},i.prototype.diff_cleanupMerge=function(e){e.push([0,""]);for(var t,i=0,n=0,r=0,a="",o="";i<e.length;)switch(e[i][0]){case 1:r++,o+=e[i][1],i++;break;case-1:n++,a+=e[i][1],i++;break;case 0:n+r>1?(0!==n&&0!==r&&(0!==(t=this.diff_commonPrefix(o,a))&&(i-n-r>0&&0==e[i-n-r-1][0]?e[i-n-r-1][1]+=o.substring(0,t):(e.splice(0,0,[0,o.substring(0,t)]),i++),o=o.substring(t),a=a.substring(t)),0!==(t=this.diff_commonSuffix(o,a))&&(e[i][1]=o.substring(o.length-t)+e[i][1],o=o.substring(0,o.length-t),a=a.substring(0,a.length-t))),0===n?e.splice(i-r,n+r,[1,o]):0===r?e.splice(i-n,n+r,[-1,a]):e.splice(i-n-r,n+r,[-1,a],[1,o]),i=i-n-r+(n?1:0)+(r?1:0)+1):0!==i&&0==e[i-1][0]?(e[i-1][1]+=e[i][1],e.splice(i,1)):i++,r=0,n=0,a="",o=""}""===e[e.length-1][1]&&e.pop();var s=!1;for(i=1;i<e.length-1;)0==e[i-1][0]&&0==e[i+1][0]&&(e[i][1].substring(e[i][1].length-e[i-1][1].length)==e[i-1][1]?(e[i][1]=e[i-1][1]+e[i][1].substring(0,e[i][1].length-e[i-1][1].length),e[i+1][1]=e[i-1][1]+e[i+1][1],e.splice(i-1,1),s=!0):e[i][1].substring(0,e[i+1][1].length)==e[i+1][1]&&(e[i-1][1]+=e[i+1][1],e[i][1]=e[i][1].substring(e[i+1][1].length)+e[i+1][1],e.splice(i+1,1),s=!0)),i++;s&&this.diff_cleanupMerge(e)},i.prototype.diff_xIndex=function(e,t){var i,n=0,r=0,a=0,o=0;for(i=0;i<e.length&&(1!==e[i][0]&&(n+=e[i][1].length),-1!==e[i][0]&&(r+=e[i][1].length),!(n>t));i++)a=n,o=r;return e.length!=i&&-1===e[i][0]?o:o+(t-a)},i.prototype.diff_prettyHtml=function(e){for(var t=[],i=/&/g,n=/</g,r=/>/g,a=/\n/g,o=0;o<e.length;o++){var s=e[o][0],c=e[o][1].replace(i,"&amp;").replace(n,"&lt;").replace(r,"&gt;").replace(a,"&para;<br>");switch(s){case 1:t[o]='<ins style="background:#e6ffe6;">'+c+"</ins>";break;case-1:t[o]='<del style="background:#ffe6e6;">'+c+"</del>";break;case 0:t[o]="<span>"+c+"</span>"}}return t.join("")},i.prototype.diff_text1=function(e){for(var t=[],i=0;i<e.length;i++)1!==e[i][0]&&(t[i]=e[i][1]);return t.join("")},i.prototype.diff_text2=function(e){for(var t=[],i=0;i<e.length;i++)-1!==e[i][0]&&(t[i]=e[i][1]);return t.join("")},i.prototype.diff_levenshtein=function(e){for(var t=0,i=0,n=0,r=0;r<e.length;r++){var a=e[r][0],o=e[r][1];switch(a){case 1:i+=o.length;break;case-1:n+=o.length;break;case 0:t+=Math.max(i,n),i=0,n=0}}return t+=Math.max(i,n)},i.prototype.diff_toDelta=function(e){for(var t=[],i=0;i<e.length;i++)switch(e[i][0]){case 1:t[i]="+"+encodeURI(e[i][1]);break;case-1:t[i]="-"+e[i][1].length;break;case 0:t[i]="="+e[i][1].length}return t.join("\t").replace(/%20/g," ")},i.prototype.diff_fromDelta=function(e,t){for(var i=[],n=0,r=0,a=t.split(/\t/g),o=0;o<a.length;o++){var s=a[o].substring(1);switch(a[o].charAt(0)){case"+":try{i[n++]=[1,decodeURI(s)]}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+s)}break;case"-":case"=":var c=parseInt(s,10);if(isNaN(c)||c<0)throw new Error("Invalid number in diff_fromDelta: "+s);var l=e.substring(r,r+=c);"="==a[o].charAt(0)?i[n++]=[0,l]:i[n++]=[-1,l];break;default:if(a[o])throw new Error("Invalid diff operation in diff_fromDelta: "+a[o])}}if(r!=e.length)throw new Error("Delta length ("+r+") does not equal source text length ("+e.length+").");return i},i.prototype.match_main=function(e,t,i){if(null==e||null==t||null==i)throw new Error("Null input. (match_main)");return i=Math.max(0,Math.min(i,e.length)),e==t?0:e.length?e.substring(i,i+t.length)==t?i:this.match_bitap_(e,t,i):-1},i.prototype.match_bitap_=function(e,t,i){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var n=this.match_alphabet_(t),r=this;function a(e,n){var a=e/t.length,o=Math.abs(i-n);return r.Match_Distance?a+o/r.Match_Distance:o?1:a}var o=this.Match_Threshold,s=e.indexOf(t,i);-1!=s&&(o=Math.min(a(0,s),o),-1!=(s=e.lastIndexOf(t,i+t.length))&&(o=Math.min(a(0,s),o)));var c,l,u=1<<t.length-1;s=-1;for(var d,h=t.length+e.length,g=0;g<t.length;g++){for(c=0,l=h;c<l;)a(g,i+l)<=o?c=l:h=l,l=Math.floor((h-c)/2+c);h=l;var f=Math.max(1,i-l+1),p=Math.min(i+l,e.length)+t.length,m=Array(p+2);m[p+1]=(1<<g)-1;for(var b=p;b>=f;b--){var y=n[e.charAt(b-1)];if(m[b]=0===g?(m[b+1]<<1|1)&y:(m[b+1]<<1|1)&y|(d[b+1]|d[b])<<1|1|d[b+1],m[b]&u){var v=a(g,b-1);if(v<=o){if(o=v,!((s=b-1)>i))break;f=Math.max(1,2*i-s)}}}if(a(g+1,i)>o)break;d=m}return s},i.prototype.match_alphabet_=function(e){for(var t={},i=0;i<e.length;i++)t[e.charAt(i)]=0;for(i=0;i<e.length;i++)t[e.charAt(i)]|=1<<e.length-i-1;return t},i.prototype.patch_addContext_=function(e,t){if(0!=t.length){for(var i=t.substring(e.start2,e.start2+e.length1),n=0;t.indexOf(i)!=t.lastIndexOf(i)&&i.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)n+=this.Patch_Margin,i=t.substring(e.start2-n,e.start2+e.length1+n);n+=this.Patch_Margin;var r=t.substring(e.start2-n,e.start2);r&&e.diffs.unshift([0,r]);var a=t.substring(e.start2+e.length1,e.start2+e.length1+n);a&&e.diffs.push([0,a]),e.start1-=r.length,e.start2-=r.length,e.length1+=r.length+a.length,e.length2+=r.length+a.length}},i.prototype.patch_make=function(e,t,n){var r,a;if("string"==typeof e&&"string"==typeof t&&void 0===n)r=e,(a=this.diff_main(r,t,!0)).length>2&&(this.diff_cleanupSemantic(a),this.diff_cleanupEfficiency(a));else if(e&&"object"==typeof e&&void 0===t&&void 0===n)a=e,r=this.diff_text1(a);else if("string"==typeof e&&t&&"object"==typeof t&&void 0===n)r=e,a=t;else{if("string"!=typeof e||"string"!=typeof t||!n||"object"!=typeof n)throw new Error("Unknown call format to patch_make.");r=e,a=n}if(0===a.length)return[];for(var o=[],s=new i.patch_obj,c=0,l=0,u=0,d=r,h=r,g=0;g<a.length;g++){var f=a[g][0],p=a[g][1];switch(c||0===f||(s.start1=l,s.start2=u),f){case 1:s.diffs[c++]=a[g],s.length2+=p.length,h=h.substring(0,u)+p+h.substring(u);break;case-1:s.length1+=p.length,s.diffs[c++]=a[g],h=h.substring(0,u)+h.substring(u+p.length);break;case 0:p.length<=2*this.Patch_Margin&&c&&a.length!=g+1?(s.diffs[c++]=a[g],s.length1+=p.length,s.length2+=p.length):p.length>=2*this.Patch_Margin&&c&&(this.patch_addContext_(s,d),o.push(s),s=new i.patch_obj,c=0,d=h,l=u)}1!==f&&(l+=p.length),-1!==f&&(u+=p.length)}return c&&(this.patch_addContext_(s,d),o.push(s)),o},i.prototype.patch_deepCopy=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],a=new i.patch_obj;a.diffs=[];for(var o=0;o<r.diffs.length;o++)a.diffs[o]=r.diffs[o].slice();a.start1=r.start1,a.start2=r.start2,a.length1=r.length1,a.length2=r.length2,t[n]=a}return t},i.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var i=this.patch_addPadding(e);t=i+t+i,this.patch_splitMax(e);for(var n=0,r=[],a=0;a<e.length;a++){var o,s,c=e[a].start2+n,l=this.diff_text1(e[a].diffs),u=-1;if(l.length>this.Match_MaxBits?-1!=(o=this.match_main(t,l.substring(0,this.Match_MaxBits),c))&&(-1==(u=this.match_main(t,l.substring(l.length-this.Match_MaxBits),c+l.length-this.Match_MaxBits))||o>=u)&&(o=-1):o=this.match_main(t,l,c),-1==o)r[a]=!1,n-=e[a].length2-e[a].length1;else if(r[a]=!0,n=o-c,l==(s=-1==u?t.substring(o,o+l.length):t.substring(o,u+this.Match_MaxBits)))t=t.substring(0,o)+this.diff_text2(e[a].diffs)+t.substring(o+l.length);else{var d=this.diff_main(l,s,!1);if(l.length>this.Match_MaxBits&&this.diff_levenshtein(d)/l.length>this.Patch_DeleteThreshold)r[a]=!1;else{this.diff_cleanupSemanticLossless(d);for(var h,g=0,f=0;f<e[a].diffs.length;f++){var p=e[a].diffs[f];0!==p[0]&&(h=this.diff_xIndex(d,g)),1===p[0]?t=t.substring(0,o+h)+p[1]+t.substring(o+h):-1===p[0]&&(t=t.substring(0,o+h)+t.substring(o+this.diff_xIndex(d,g+p[1].length))),-1!==p[0]&&(g+=p[1].length)}}}}return[t=t.substring(i.length,t.length-i.length),r]},i.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,i="",n=1;n<=t;n++)i+=String.fromCharCode(n);for(n=0;n<e.length;n++)e[n].start1+=t,e[n].start2+=t;var r=e[0],a=r.diffs;if(0==a.length||0!=a[0][0])a.unshift([0,i]),r.start1-=t,r.start2-=t,r.length1+=t,r.length2+=t;else if(t>a[0][1].length){var o=t-a[0][1].length;a[0][1]=i.substring(a[0][1].length)+a[0][1],r.start1-=o,r.start2-=o,r.length1+=o,r.length2+=o}if(0==(a=(r=e[e.length-1]).diffs).length||0!=a[a.length-1][0])a.push([0,i]),r.length1+=t,r.length2+=t;else if(t>a[a.length-1][1].length){o=t-a[a.length-1][1].length;a[a.length-1][1]+=i.substring(0,o),r.length1+=o,r.length2+=o}return i},i.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=t)){var r=e[n];e.splice(n--,1);for(var a=r.start1,o=r.start2,s="";0!==r.diffs.length;){var c=new i.patch_obj,l=!0;for(c.start1=a-s.length,c.start2=o-s.length,""!==s&&(c.length1=c.length2=s.length,c.diffs.push([0,s]));0!==r.diffs.length&&c.length1<t-this.Patch_Margin;){var u=r.diffs[0][0],d=r.diffs[0][1];1===u?(c.length2+=d.length,o+=d.length,c.diffs.push(r.diffs.shift()),l=!1):-1===u&&1==c.diffs.length&&0==c.diffs[0][0]&&d.length>2*t?(c.length1+=d.length,a+=d.length,l=!1,c.diffs.push([u,d]),r.diffs.shift()):(d=d.substring(0,t-c.length1-this.Patch_Margin),c.length1+=d.length,a+=d.length,0===u?(c.length2+=d.length,o+=d.length):l=!1,c.diffs.push([u,d]),d==r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(d.length))}s=(s=this.diff_text2(c.diffs)).substring(s.length-this.Patch_Margin);var h=this.diff_text1(r.diffs).substring(0,this.Patch_Margin);""!==h&&(c.length1+=h.length,c.length2+=h.length,0!==c.diffs.length&&0===c.diffs[c.diffs.length-1][0]?c.diffs[c.diffs.length-1][1]+=h:c.diffs.push([0,h])),l||e.splice(++n,0,c)}}},i.prototype.patch_toText=function(e){for(var t=[],i=0;i<e.length;i++)t[i]=e[i];return t.join("")},i.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var n=e.split("\n"),r=0,a=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;r<n.length;){var o=n[r].match(a);if(!o)throw new Error("Invalid patch string: "+n[r]);var s=new i.patch_obj;for(t.push(s),s.start1=parseInt(o[1],10),""===o[2]?(s.start1--,s.length1=1):"0"==o[2]?s.length1=0:(s.start1--,s.length1=parseInt(o[2],10)),s.start2=parseInt(o[3],10),""===o[4]?(s.start2--,s.length2=1):"0"==o[4]?s.length2=0:(s.start2--,s.length2=parseInt(o[4],10)),r++;r<n.length;){var c=n[r].charAt(0);try{var l=decodeURI(n[r].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+l)}if("-"==c)s.diffs.push([-1,l]);else if("+"==c)s.diffs.push([1,l]);else if(" "==c)s.diffs.push([0,l]);else{if("@"==c)break;if(""!==c)throw new Error('Invalid patch mode "'+c+'" in: '+l)}r++}}return t},i.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},i.patch_obj.prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],i=0;i<this.diffs.length;i++){switch(this.diffs[i][0]){case 1:e="+";break;case-1:e="-";break;case 0:e=" "}t[i+1]=e+encodeURI(this.diffs[i][1])+"\n"}return t.join("").replace(/%20/g," ")},e.exports=i,e.exports.diff_match_patch=i,e.exports.DIFF_DELETE=-1,e.exports.DIFF_INSERT=1,e.exports.DIFF_EQUAL=0},16444:function(e,t,i){"use strict";var n,r;i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),function(e){e[e.Days=0]="Days",e[e.Suggestions=1]="Suggestions"}(n||(n={})),function(e){e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden"}(r||(r={}))},16445:function(e,t,i){var n={"./am/messages.json":[17262,1473],"./ar/messages.json":[17263,1474],"./bg/messages.json":[17264,1475],"./ca/messages.json":[17265,1476],"./cs/messages.json":[17266,1477],"./da/messages.json":[17267,1478],"./de/messages.json":[17268,1479],"./el/messages.json":[17269,1480],"./en/messages.json":[17270,1481],"./en_gb/messages.json":[17271,1482],"./es/messages.json":[17272,1483],"./es_419/messages.json":[17273,1484],"./et/messages.json":[17274,1485],"./fa/messages.json":[17275,1486],"./fi/messages.json":[17276,1487],"./fil/messages.json":[17277,1488],"./fr-CA/messages.json":[17279,1489],"./fr/messages.json":[17278,1490],"./gu/messages.json":[17280,1491],"./he/messages.json":[17281,1492],"./hi/messages.json":[17282,1493],"./hr/messages.json":[17283,1494],"./hu/messages.json":[17284,1495],"./id/messages.json":[17285,1496],"./it/messages.json":[17286,1497],"./ja/messages.json":[17287,1498],"./kn/messages.json":[17288,1499],"./ko/messages.json":[17289,1500],"./lt/messages.json":[17290,1501],"./lv/messages.json":[17291,1502],"./ml/messages.json":[17292,1503],"./mr/messages.json":[17293,1504],"./ms/messages.json":[17294,1505],"./nl/messages.json":[17295,1506],"./no/messages.json":[17296,1507],"./pl/messages.json":[17297,1508],"./pt_br/messages.json":[17298,1509],"./pt_pt/messages.json":[17299,1510],"./ro/messages.json":[17300,1511],"./ru/messages.json":[17301,1512],"./sk/messages.json":[17302,1513],"./sl/messages.json":[17303,1514],"./sr/messages.json":[17304,1515],"./sv/messages.json":[17305,1516],"./ta/messages.json":[17306,1517],"./te/messages.json":[17307,1518],"./th/messages.json":[17308,1519],"./tr/messages.json":[17309,1520],"./uk/messages.json":[17310,1521],"./vi/messages.json":[17311,1522],"./zh_cn/messages.json":[17312,1523],"./zh_tw/messages.json":[17313,1524]};function r(e){if(!i.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return i.e(t[1]).then((function(){return i.t(r,3)}))}r.keys=function(){return Object.keys(n)},r.id=16445,e.exports=r},18130:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(4329),r=i(11815),a=i(2037);let o=class{isSpellingCritique(e){const t=[r.a.ContextualSpelling,r.a.WrongSpelling];return!!e&&(e.priority===r.b.High||!!e.typeId&&t.includes(e.typeId))}isDeleteActionAvailable(e){return 1==(1&e.supportedActions)}isChangeActionAvailable(e){return 1==(1&e.action)||2==(2&e.action)||4==(4&e.action)}isRepeatedWord(e){return!!e&&(this.isDeleteActionAvailable(e)&&!e.suggestions.some(e=>this.isChangeActionAvailable(e)))}};o=Object(n.a)([Object(a.injectable)()],o)},187:function(e,t,i){"use strict";var n,r,a=i(33);function o(e){return Object(a.a)("GetBposShellInfoNavBarData",{},e)}function s(e){return Object(a.a)("GetBposShellInfoNavBarDataForBookings",{},e)}function c(e,t){n||(n=("Bookings"===e?s:o)({authNeededOnUnAuthorized:!t}).then((function(e){return r=e})).catch((function(){return r=null})));return n}function l(){return n}function u(){return r}i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return c})),i.d(t,"c",(function(){return l}))},1886:function(e,t,i){"use strict";var n=i(768),r=i(3),a=i(0),o=i(713),s=i(66),c=i(700),l=i(1261),u=i(1260),d=i(1714),h=i(1545),g=i(421),f=i(604),p=i(411),m=i(381),b=Object(o.a)(),y=a.forwardRef((function(e,t){var i,n,o,y,v,_=a.useRef(null),I=Object(m.c)(),S=Object(f.a)(_,t),C=e.illustrationImage,E=e.primaryButtonProps,T=e.secondaryButtonProps,O=e.headline,w=e.hasCondensedHeadline,j=e.hasCloseButton,P=void 0===j?e.hasCloseIcon:j,x=e.onDismiss,D=e.closeButtonAriaLabel,N=e.hasSmallHeadline,A=e.isWide,R=e.styles,k=e.theme,F=e.ariaDescribedBy,L=e.ariaLabelledBy,M=e.footerContent,q=e.focusTrapZoneProps,B=b(R,{theme:k,hasCondensedHeadline:w,hasSmallHeadline:N,hasCloseButton:P,hasHeadline:!!O,isWide:A,primaryButtonClassName:E?E.className:void 0,secondaryButtonClassName:T?T.className:void 0}),U=a.useCallback((function(e){x&&e.which===s.a.escape&&x(e)}),[x]);if(Object(p.a)(I,"keydown",U),C&&C.src&&(i=a.createElement("div",{className:B.imageContent},a.createElement(g.a,Object(r.__assign)({},C)))),O){var W="string"==typeof O?"p":"div";n=a.createElement("div",{className:B.header},a.createElement(W,{role:"heading",className:B.headline,id:L},O))}if(e.children){var H="string"==typeof e.children?"p":"div";o=a.createElement("div",{className:B.body},a.createElement(H,{className:B.subText,id:F},e.children))}return(E||T||M)&&(y=a.createElement(d.a,{className:B.footer,horizontal:!0,horizontalAlign:M?"space-between":"end"},a.createElement(d.a.Item,{align:"center"},a.createElement("span",null,M)),a.createElement(d.a.Item,null,T&&a.createElement(c.a,Object(r.__assign)({},T,{className:B.secondaryButton})),E&&a.createElement(l.a,Object(r.__assign)({},E,{className:B.primaryButton}))))),P&&(v=a.createElement(u.a,{className:B.closeButton,iconProps:{iconName:"Cancel"},title:D,ariaLabel:D,onClick:x})),function(e,t){a.useImperativeHandle(e,(function(){return{focus:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.focus()}}}),[t])}(e.componentRef,_),a.createElement("div",{className:B.content,ref:S,role:"dialog",tabIndex:-1,"aria-labelledby":L,"aria-describedby":F,"data-is-focusable":!0},i,a.createElement(h.a,Object(r.__assign)({isClickableOutsideFocusTrap:!0},q),a.createElement("div",{className:B.bodyContent},n,o,y,v)))})),v=i(7),_=i(138),I={root:"ms-TeachingBubble",body:"ms-TeachingBubble-body",bodyContent:"ms-TeachingBubble-bodycontent",closeButton:"ms-TeachingBubble-closebutton",content:"ms-TeachingBubble-content",footer:"ms-TeachingBubble-footer",header:"ms-TeachingBubble-header",headerIsCondensed:"ms-TeachingBubble-header--condensed",headerIsSmall:"ms-TeachingBubble-header--small",headerIsLarge:"ms-TeachingBubble-header--large",headline:"ms-TeachingBubble-headline",image:"ms-TeachingBubble-image",primaryButton:"ms-TeachingBubble-primaryButton",secondaryButton:"ms-TeachingBubble-secondaryButton",subText:"ms-TeachingBubble-subText",button:"ms-Button",buttonLabel:"ms-Button-label"},S=Object(_.c)((function(){return Object(v.keyframes)({"0%":{opacity:0,animationTimingFunction:v.AnimationVariables.easeFunction1,transform:"scale3d(.90,.90,.90)"},"100%":{opacity:1,transform:"scale3d(1,1,1)"}})})),C=function(e,t){var i=t||{},n=i.calloutWidth,r=i.calloutMaxWidth;return[{display:"block",maxWidth:364,border:0,outline:"transparent",width:n||"calc(100% + 1px)",animationName:""+S(),animationDuration:"300ms",animationTimingFunction:"linear",animationFillMode:"both"},e&&{maxWidth:r||456}]},E=function(e,t,i){return t?[e.headerIsCondensed,{marginBottom:14}]:[i&&e.headerIsSmall,!i&&e.headerIsLarge,{selectors:{":not(:last-child)":{marginBottom:14}}}]},T=function(e){var t,i,n,a=e.hasCondensedHeadline,o=e.hasSmallHeadline,s=e.hasCloseButton,c=e.hasHeadline,l=e.isWide,u=e.primaryButtonClassName,d=e.secondaryButtonClassName,h=e.theme,g=e.calloutProps,f=void 0===g?{className:void 0,theme:h}:g,p=!a&&!o,m=h.palette,b=h.semanticColors,y=h.fonts,_=Object(v.getGlobalClassNames)(I,h),S=Object(v.getFocusStyle)(h,{outlineColor:"transparent",borderColor:"transparent"});return{root:[_.root,y.medium,f.className],body:[_.body,s&&!c&&{marginRight:24},{selectors:{":not(:last-child)":{marginBottom:20}}}],bodyContent:[_.bodyContent,{padding:"20px 24px 20px 24px"}],closeButton:[_.closeButton,{position:"absolute",right:0,top:0,margin:"15px 15px 0 0",borderRadius:0,color:m.white,fontSize:y.small.fontSize,selectors:{":hover":{background:m.themeDarkAlt,color:m.white},":active":{background:m.themeDark,color:m.white},":focus":{border:"1px solid "+b.variantBorder}}}],content:Object(r.__spreadArrays)([_.content],C(l),[l&&{display:"flex"}]),footer:[_.footer,{display:"flex",flex:"auto",alignItems:"center",color:m.white,selectors:(t={},t["."+_.button+":not(:first-child)"]={marginLeft:10},t)}],header:Object(r.__spreadArrays)([_.header],E(_,a,o),[s&&{marginRight:24},(a||o)&&[y.medium,{fontWeight:v.FontWeights.semibold}]]),headline:[_.headline,{margin:0,color:m.white,fontWeight:v.FontWeights.semibold},p&&[{fontSize:y.xLarge.fontSize}]],imageContent:[_.header,_.image,l&&{display:"flex",alignItems:"center",maxWidth:154}],primaryButton:[_.primaryButton,u,S,{backgroundColor:m.white,borderColor:m.white,color:m.themePrimary,whiteSpace:"nowrap",selectors:(i={},i["."+_.buttonLabel]=y.medium,i[":hover"]={backgroundColor:m.themeLighter,borderColor:m.themeLighter,color:m.themePrimary},i[":focus"]={backgroundColor:m.themeLighter,border:"1px solid "+m.black,outline:"1px solid "+m.white,outlineOffset:"-2px"},i[":active"]={backgroundColor:m.white,borderColor:m.white,color:m.themePrimary},i)}],secondaryButton:[_.secondaryButton,d,S,{backgroundColor:m.themePrimary,borderColor:m.white,whiteSpace:"nowrap",selectors:(n={},n["."+_.buttonLabel]=[y.medium,{color:m.white}],n[":hover"]={backgroundColor:m.themeDarkAlt,borderColor:m.white},n[":focus"]={backgroundColor:m.themeDark,border:"1px solid "+m.black,outline:"1px solid "+m.white,outlineOffset:"-2px"},n[":active"]={backgroundColor:m.themePrimary,borderColor:m.white},n)}],subText:[_.subText,{margin:0,fontSize:y.medium.fontSize,color:m.white,fontWeight:v.FontWeights.regular}],subComponentStyles:{callout:{root:Object(r.__spreadArrays)(C(l,f),[y.medium]),beak:[{background:m.themePrimary}],calloutMain:[{background:m.themePrimary}]}}}},O=Object(n.a)(y,T,void 0,{scope:"TeachingBubbleContent"}),w=i(1115),j={beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:i(60).a.rightCenter},P=Object(o.a)(),x=a.forwardRef((function(e,t){var i=a.useRef(null),n=Object(f.a)(i,t),o=e.calloutProps,s=e.targetElement,c=e.onDismiss,l=e.hasCloseButton,u=void 0===l?e.hasCloseIcon:l,d=e.isWide,h=e.styles,g=e.theme,p=e.target,m=a.useMemo((function(){return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},j),o),{theme:g})}),[o,g]),b=P(h,{theme:g,isWide:d,calloutProps:m,hasCloseButton:u}),y=b.subComponentStyles?b.subComponentStyles.callout:void 0;return function(e,t){a.useImperativeHandle(e,(function(){return{focus:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.focus()}}}),[t])}(e.componentRef,i),a.createElement(w.a,Object(r.__assign)({target:p||s,onDismiss:c},m,{className:b.root,styles:y,hideOverflow:!0}),a.createElement("div",{ref:n},a.createElement(O,Object(r.__assign)({},e))))}));x.displayName="TeachingBubble",i.d(t,"a",(function(){return D}));var D=Object(n.a)(x,T,void 0,{scope:"TeachingBubble"})},2037:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(3593);t.METADATA_KEY=n;var r=i(16399);t.Container=r.Container;var a=i(5234);t.BindingScopeEnum=a.BindingScopeEnum,t.BindingTypeEnum=a.BindingTypeEnum,t.TargetTypeEnum=a.TargetTypeEnum;var o=i(16415);t.AsyncContainerModule=o.AsyncContainerModule,t.ContainerModule=o.ContainerModule;var s=i(16416);t.injectable=s.injectable;var c=i(16417);t.tagged=c.tagged;var l=i(16418);t.named=l.named;var u=i(11820);t.inject=u.inject,t.LazyServiceIdentifer=u.LazyServiceIdentifer;var d=i(16419);t.optional=d.optional;var h=i(16420);t.unmanaged=h.unmanaged;var g=i(16421);t.multiInject=g.multiInject;var f=i(16422);t.targetName=f.targetName;var p=i(16423);t.postConstruct=p.postConstruct;var m=i(11818);t.MetadataReader=m.MetadataReader;var b=i(6269);t.id=b.id;var y=i(5686);t.decorate=y.decorate;var v=i(11823);t.traverseAncerstors=v.traverseAncerstors,t.taggedConstraint=v.taggedConstraint,t.namedConstraint=v.namedConstraint,t.typeConstraint=v.typeConstraint;var _=i(7593);t.getServiceIdentifierAsString=_.getServiceIdentifierAsString;var I=i(16424);t.multiBindToService=I.multiBindToService},2147:function(e,t,i){"use strict";var n=i(11868);i.d(t,"a",(function(){return n}));i(6270),i(4140)},2734:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(10029),r=i(3859),a=i(5687);const o={CategoryCritiqueFilter:Object(n.a)("CategoryCritiqueFilter"),DictionaryCritiqueFilter:Object(n.a)("DictionaryCritiqueFilter"),EnabledCritiqueTypesCritiqueFilter:Object(n.a)("EnabledCritiqueTypesCritiqueFilter"),IConditionalAttributeFilterFactory:Object(n.a)("IConditionalAttributeFilterFactory"),ICritiqueFilterer:Object(n.a)("ICritiqueFilterer"),ICritiquesBrokerFactory:Object(n.a)("ICritiquesBrokerFactory"),IDomFinderFactory:Object(n.a)("IDomFinderFactory"),IElementsRetriever:Object(n.a)("IElementsRetriever"),IEnabledCritiqueTypes:Object(n.a)("IEnabledCritiqueTypes"),IE2eMetric:r.a.IE2eMetric,IFeatureFlagsReader:r.a.IFeatureFlagsReader,IGrammarRules:Object(n.a)("IGrammarRules"),IGraphNodeBuilderFactory:Object(n.a)("Factory<IGraphNodeBuilderFactory>"),IGraphNodeFactory:Object(n.a)("IGraphNodeFactory"),IGuidGenerator:r.a.IGuidGenerator,IHostEmitter:r.a.IHostEmitter,IHostEmitterArray:r.a.IHostEmitterArray,IHostModelPersistedStore:Object(n.a)("IHostModelPersistedStore"),IHostModelSettings:Object(n.a)("IHostModelSettings"),IHostTilingEmitter:Object(n.a)("IHostTilingEmitter"),IHostSettings:Object(n.a)("IHostSettings"),IIndexReadjuster:a.a.IIndexReadjuster,ILocalizer:r.a.ILocalizer,ILogger:r.a.ILogger,IMutationObserverFactory:Object(n.a)("Factory<MutationObserver>"),INodeObserverFactory:Object(n.a)("Factory<INodeObserver>"),INodePoller:Object(n.a)("INodePoller"),IParagraphNodesBuilderFactory:Object(n.a)("IParagraphNodesBuilderFactory"),IParagraphNodeDictionary:Object(n.a)("IParagraphNodeDictionary"),IParagraphNodeFactory:Object(n.a)("IParagraphNodeFactory"),IProofingPersistedStore:r.a.IProofingPersistedStore,IPreOrderTraverser:Object(n.a)("IPreOrderTraverser<NodeElementType>"),IProofingDom:Object(n.a)("IProofingDom"),IProofingEmitter:r.a.IProofingEmitter,ISelectedCritiqueCategory:Object(n.a)("ISelectedCritiqueCategory"),IShadowGraphFactory:Object(n.a)("Factory<IShadowGraph>"),IsUpsellUser:r.a.IsUpsellUser,ITerminalNodeReader:Object(n.a)("ITerminalNodeReader<NodeElementType>"),ITerminalNodeWriter:Object(n.a)("ITerminalNodeWriter<NodeElementType>"),ITextExtractor:a.a.ITextExtractor,ITextUnitChunker:a.a.ITextUnitChunker,ITileNodeDictionary:Object(n.a)("ITileNodeDictionary"),ITileNodeReader:Object(n.a)("ITileNodeReader<NodeElementType>"),IUpsellStore:Object(n.a)("IUpsellStore"),IWordCount:a.a.IWordCount,IWordCountDetector:a.a.IWordCountDetector,IWordDictionary:Object(n.a)("IWordDictionary"),PremiumCritiqueFilter:Object(n.a)("PremiumCritiqueFilter"),ISpellingSettingsStore:Object(n.a)("ISpellingSettingsStore"),SpellingCritiqueFilter:Object(n.a)("SpellingCritiqueFilter")}},3108:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}));function n(e,t,i,n){var r,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,i,o):r(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o}function r(e,t){return function(i,n){t(i,n,e)}}},3275:function(e,t,i){"use strict";var n,r;i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),function(e){e[e.TimeBased=0]="TimeBased",e[e.CountBased=1]="CountBased",e[e.TimeAndCountCombined=2]="TimeAndCountCombined",e[e.BasicSkittle=3]="BasicSkittle",e[e.None=4]="None"}(n||(n={})),function(e){e[e.New=0]="New",e[e.Activated=1]="Activated",e[e.Expired=2]="Expired",e[e.Unknown=3]="Unknown"}(r||(r={}))},3593:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NAMED_TAG="named",t.NAME_TAG="name",t.UNMANAGED_TAG="unmanaged",t.OPTIONAL_TAG="optional",t.INJECT_TAG="inject",t.MULTI_INJECT_TAG="multi_inject",t.TAGGED="inversify:tagged",t.TAGGED_PROP="inversify:tagged_props",t.PARAM_TYPES="inversify:paramtypes",t.DESIGN_PARAM_TYPES="design:paramtypes",t.POST_CONSTRUCT="post_construct"},3698:function(e,t,i){"use strict";var n,r;i.d(t,"a",(function(){return r})),function(e){e[e.button=0]="button",e[e.anchor=1]="anchor"}(n||(n={})),function(e){e[e.normal=0]="normal",e[e.primary=1]="primary",e[e.hero=2]="hero",e[e.compound=3]="compound",e[e.command=4]="command",e[e.icon=5]="icon",e[e.default=6]="default"}(r||(r={}))},3859:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(10029);const r={IGuidGenerator:Object(n.a)("IGuidGenerator"),ICleanable:Object(n.a)("ICleanable"),IUserInfoStrategy:Object(n.a)("IUserInfoStrategy"),IsPremiumUser:Object(n.a)("IsPremiumUser"),IsUpsellUser:Object(n.a)("IsUpsellUser"),IsSignedInUser:Object(n.a)("IsSignedInUser"),IUpsellFeature:Object(n.a)("IUpsellFeature"),IRoamingDictionaryFeature:Object(n.a)("IRoamingDictionaryFeature"),IExternalSettingsFeature:Object(n.a)("IExternalSettingsFeature"),IFeatureFlagsReader:Object(n.a)("IFeatureFlagsReader"),IRegistrable:Object(n.a)("IRegistrable"),IProofingEmitter:Object(n.a)("IProofingEmitter"),IHostSettings:Object(n.a)("IHostSettings"),ISessionContextProvider:Object(n.a)("ISessionContextProvider"),EditorService:Object(n.a)("EditorService"),SynonymService:Object(n.a)("SynonymService"),IResourceUrlFormatter:Object(n.a)("IResourceUrlFormatter"),IShowSynonymsFeature:Object(n.a)("IShowSynonymsFeature"),IUnsignedInEditorFeature:Object(n.a)("IUnsignedInEditorFeature"),IE2eMetric:Object(n.a)("IE2eMetric"),ILanguageInfoProvider:Object(n.a)("ILanguageInfoProvider"),ILanguageScriptDirectionDetector:Object(n.a)("ILanguageScriptDirectionDetector"),IUxLanguageDetector:Object(n.a)("IUxLanguageDetector"),ILocalizationStringsImporter:Object(n.a)("ILocalizationStringsImporter"),ILocalizer:Object(n.a)("ILocalizer"),ILogger:Object(n.a)("ILogger"),ITransportActivity:Object(n.a)("ITransportActivity"),ITransportLogger:Object(n.a)("ITransportLogger"),TelemetrySink:Object(n.a)("TelemetrySink"),IInstrumentationMessageProcessor:Object(n.a)("IInstrumentationMessageProcessor"),IHostEmitter:Object(n.a)("IHostEmitter"),IHostEmitterArray:Object(n.a)("IHostEmitterArray"),IProofingPersistedStore:Object(n.a)("IProofingPersistedStore")}},4127:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return a}));function n(e,t,i,n){var r,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,i,o):r(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o}function r(e,t){return function(i,n){t(i,n,e)}}function a(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}},413:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return o}));var n=i(2),r=i(14),a=Object(n.createStore)("lightningState",{unseenItems:new r.ObservableMap,lightedCount:0,lastShownId:null}),o=a()},4140:function(e,t,i){"use strict";var n,r,a,o,s,c,l,u,d,h,g,f,p,m,b,y,v,_;function I(e,t){return{name:e,dataType:l.Boolean,value:t,classification:c.SystemMetadata}}function S(e,t){return{name:e,dataType:l.Int64,value:t,classification:c.SystemMetadata}}function C(e,t){return{name:e,dataType:l.String,value:t,classification:c.SystemMetadata}}function E(e,t,i){e.push(C("zC."+t,i))}!function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(n||(n={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(r||(r={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(a||(a={})),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(o||(o={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(s||(s={})),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(c||(c={})),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Guid=4]="Guid"}(l||(l={})),d=u||(u={}),h="Office.System.Result",d.getFields=function(e,t){var i=[];return i.push(S(e+".Code",t.code)),void 0!==t.type&&i.push(C(e+".Type",t.type)),void 0!==t.tag&&i.push(S(e+".Tag",t.tag)),void 0!==t.isExpected&&i.push(I(e+".IsExpected",t.isExpected)),E(i,e,h),i},(f=g||(g={})).contractName="Office.System.Activity",f.getFields=function(e){var t=[];return void 0!==e.cV&&t.push(C("Activity.CV",e.cV)),t.push(S("Activity.Duration",e.duration)),t.push(S("Activity.Count",e.count)),t.push(S("Activity.AggMode",e.aggMode)),void 0!==e.success&&t.push(I("Activity.Success",e.success)),void 0!==e.result&&t.push.apply(t,u.getFields("Activity.Result",e.result)),E(t,"Activity",f.contractName),t},function(e){var t="Office.System.Host";e.getFields=function(e,i){var n=[];return void 0!==i.id&&n.push(C(e+".Id",i.id)),void 0!==i.version&&n.push(C(e+".Version",i.version)),void 0!==i.sessionId&&n.push(C(e+".SessionId",i.sessionId)),E(n,e,t),n}}(p||(p={})),function(e){var t="Office.System.User";e.getFields=function(e,i){var n=[];return void 0!==i.alias&&n.push(C(e+".Alias",i.alias)),void 0!==i.primaryIdentityHash&&n.push(C(e+".PrimaryIdentityHash",i.primaryIdentityHash)),void 0!==i.primaryIdentitySpace&&n.push(C(e+".PrimaryIdentitySpace",i.primaryIdentitySpace)),void 0!==i.tenantId&&n.push(C(e+".TenantId",i.tenantId)),void 0!==i.tenantGroup&&n.push(C(e+".TenantGroup",i.tenantGroup)),void 0!==i.isAnonymous&&n.push(I(e+".IsAnonymous",i.isAnonymous)),E(n,e,t),n}}(m||(m={})),function(e){var t="Office.System.SDX";e.getFields=function(e,i){var n=[];return void 0!==i.id&&n.push(C(e+".Id",i.id)),void 0!==i.version&&n.push(C(e+".Version",i.version)),void 0!==i.instanceId&&n.push(C(e+".InstanceId",i.instanceId)),void 0!==i.name&&n.push(C(e+".Name",i.name)),void 0!==i.marketplaceType&&n.push(C(e+".MarketplaceType",i.marketplaceType)),void 0!==i.sessionId&&n.push(C(e+".SessionId",i.sessionId)),void 0!==i.browserToken&&n.push(C(e+".BrowserToken",i.browserToken)),void 0!==i.osfRuntimeVersion&&n.push(C(e+".OsfRuntimeVersion",i.osfRuntimeVersion)),void 0!==i.officeJsVersion&&n.push(C(e+".OfficeJsVersion",i.officeJsVersion)),void 0!==i.hostJsVersion&&n.push(C(e+".HostJsVersion",i.hostJsVersion)),void 0!==i.assetId&&n.push(C(e+".AssetId",i.assetId)),void 0!==i.providerName&&n.push(C(e+".ProviderName",i.providerName)),void 0!==i.type&&n.push(C(e+".Type",i.type)),E(n,e,t),n}}(b||(b={})),function(e){var t="Office.System.Funnel";e.getFields=function(e,i){var n=[];return void 0!==i.name&&n.push(C(e+".Name",i.name)),void 0!==i.state&&n.push(C(e+".State",i.state)),E(n,e,t),n}}(y||(y={})),function(e){var t="Office.System.UserAction";e.getFields=function(e,i){var n=[];return void 0!==i.id&&n.push(S(e+".Id",i.id)),void 0!==i.name&&n.push(C(e+".Name",i.name)),void 0!==i.commandSurface&&n.push(C(e+".CommandSurface",i.commandSurface)),void 0!==i.parentName&&n.push(C(e+".ParentName",i.parentName)),void 0!==i.triggerMethod&&n.push(C(e+".TriggerMethod",i.triggerMethod)),void 0!==i.timeOffsetMs&&n.push(S(e+".TimeOffsetMs",i.timeOffsetMs)),E(n,e,t),n}}(v||(v={})),function(e){var t="Office.System.Error";e.getFields=function(e,i){var n=[];return n.push(C(e+".ErrorGroup",i.errorGroup)),n.push(S(e+".Tag",i.tag)),void 0!==i.code&&n.push(S(e+".Code",i.code)),void 0!==i.id&&n.push(S(e+".Id",i.id)),void 0!==i.count&&n.push(S(e+".Count",i.count)),E(n,e,t),n}}(_||(_={}));var T,O,w,j=g,P=u,x=_,D=y,N=p,A=b,R=v,k=m;!function(e){!function(e){!function(e){e.Activity=j,e.Result=P,e.Error=x,e.Funnel=D,e.Host=N,e.SDX=A,e.User=k,e.UserAction=R}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(T||(T={})),function(e){e.Offered="Offered",e.Seen="Seen",e.Tried="Tried",e.Kept="Kept",e.Rejected="Rejected"}(O||(O={})),function(e){e.Host="Host",e.Authentication="Authentication",e.ExceptionHandling="ExceptionHandling",e.Navigation="Navigation",e.UiRendering="UiRendering",e.Acronyms="Acronyms",e.AtAGlance="AtAGlance",e.CritiqueUpsell="CritiqueUpsell",e.HeadingDetection="HeadingDetection",e.WritingAnalytics="WritingAnalytics",e.TableStyles="TableStyles",e.Similarity="Similarity",e.Goals="Goals",e.Feedback="Feedback",e.TopProofingIssues="TopProofingIssues",e.Proofing="Proofing",e.EditorScore="EditorScore",e.PremiumPreview="PremiumPreview"}(w||(w={}));var F=i(6270);class L{constructor(e){this._loggerSettings=e}logData(e){this._loggerSettings.logToConsole}}const M=()=>({setEventFlags:jest.fn(),addDataField:jest.fn(),addDataFields:jest.fn(),setSuccess:jest.fn(),setResult:jest.fn(),endNow:jest.fn(),createChildActivity:e=>{throw new Error("Not implemented")},executeAsync:e=>{throw new Error("Not implemented")},executeSync:e=>{throw new Error("Not implemented")},executeChildActivityAsync:(e,t)=>{throw new Error("Not implemented")},executeChildActivitySync:(e,t)=>{throw new Error("Not implemented")}}),q=e=>({logGroupName:"ESDK",tenant:{tenantName:"NaturalLanguage",ariaTenantToken:"mockAriaTenantToken",nexusTenantToken:1733},defaultEventName:"Diagnostic",logToConsole:!0,logToKusto:void 0===e||e});var B,U,W,H,G,V=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),z=new V;function $(e,t,i){z.fireEvent({level:e,category:t,message:i})}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(B||(B={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}(U||(U={})),function(e){e[e.Aria=0]="Aria",e[e.Nexus=1]="Nexus"}(W||(W={})),function(e){var t={},i={},n={};function r(e){if("object"!=typeof e)throw new Error("tokenTree must be an object");n=function e(t,i){if("object"!=typeof i)return i;for(var n=0,r=Object.keys(i);n<r.length;n++){var a=r[n];a in t&&(t[a],1)?t[a]=e(t[a],i[a]):t[a]=i[a]}return t}(n,e)}function a(e){if(t[e])return t[e];var i=s(e,W.Aria);return"string"==typeof i?(t[e]=i,i):void 0}function o(e){if(i[e])return i[e];var t=s(e,W.Nexus);return"number"==typeof t?(i[e]=t,t):void 0}function s(e,t){var i=e.split("."),r=n,a=void 0;if(r){for(var o=0;o<i.length-1;o++)r[i[o]]&&(r=r[i[o]],t===W.Aria&&"string"==typeof r.ariaTenantToken?a=r.ariaTenantToken:t===W.Nexus&&"number"==typeof r.nexusTenantToken&&(a=r.nexusTenantToken));return a}}e.setTenantToken=function(e,t,i){var n=e.split(".");if(n.length<2||"Office"!==n[0])$(B.Error,U.Core,(function(){return"Invalid namespace: "+e}));else{var a=Object.create(Object.prototype);t&&(a.ariaTenantToken=t),i&&(a.nexusTenantToken=i);var o,s=a;for(o=n.length-1;o>=0;--o){var c=Object.create(Object.prototype);c[n[o]]=s,s=c}r(s)}},e.setTenantTokens=r,e.getTenantTokens=function(e){var t=a(e),i=o(e);if(!i||!t)throw new Error("Could not find tenant token for "+e);return{ariaTenantToken:t,nexusTenantToken:i}},e.getAriaTenantToken=a,e.getNexusTenantToken=o,e.clear=function(){t={},i={},n={}}}(H||(H={})),function(e){var t=-9007199254740991,i=9007199254740991,n=/^[A-Z][a-zA-Z0-9]*$/,r=/^[a-zA-Z0-9_\.]*$/;function a(e){return void 0!==e&&r.test(e)}function o(e){if(!((t=e.name)&&a(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;e.dataType===l.Int64&&s(e.value)}function s(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<t||e>i)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;var t=e.split("."),i=t[t.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(t)&&(r=i,void 0!==r&&n.test(r));var r}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!a(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var t=0;t<e.dataFields.length;t++)o(e.dataFields[t])},e.validateInt=s}(G||(G={}));var J,K="3.1.73",X=function(){return(X=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Y=function(){function e(e,t,i){var n,r;this.onSendEvent=new V,this.persistentDataFields=[],this.config=i||{},e?(this.onSendEvent=e.onSendEvent,(n=this.persistentDataFields).push.apply(n,e.persistentDataFields),this.config=X(X({},e.getConfig()),this.config)):this.persistentDataFields.push(C("OTelJS.Version",K)),t&&(r=this.persistentDataFields).push.apply(r,t)}return e.prototype.sendTelemetryEvent=function(e){var t;try{if(0===this.onSendEvent.getListenerCount())return void $(B.Warning,U.Core,(function(){return"No telemetry sinks are attached."}));t=this.cloneEvent(e),this.processTelemetryEvent(t)}catch(e){return void function(e,t,i){$(B.Error,e,(function(){var e=i instanceof Error?i.message:"";return t+": "+e}))}(U.Core,"SendTelemetryEvent",e)}try{this.onSendEvent.fireEvent(t)}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t;e.telemetryProperties||(e.telemetryProperties=H.getTenantTokens(e.eventName)),e.dataFields&&this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields),this.config.disableValidation||G.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.onSendEvent.addListener((function(t){return e.sendTelemetryEvent(t)}))},e.prototype.setTenantToken=function(e,t,i){H.setTenantToken(e,t,i)},e.prototype.setTenantTokens=function(e){H.setTenantTokens(e)},e.prototype.cloneEvent=function(e){return function(e){var t={eventName:e.eventName,eventFlags:e.eventFlags};return e.telemetryProperties&&(t.telemetryProperties={ariaTenantToken:e.telemetryProperties.ariaTenantToken,nexusTenantToken:e.telemetryProperties.nexusTenantToken}),e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t.dataFields=e.dataFields?e.dataFields.slice():[],t}(e)},e.prototype.getConfig=function(){return this.config},e}();!function(e){var t,i=0;e.getNext=function(){return void 0===t&&(t=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],i=0;i<22;i++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new n(t,++i)},e.getNextChild=function(e){return new n(e.getString(),++e.nextChild)};var n=function(){function e(e,t){this.base=e,this.id=t,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=n}(J||(J={}));var Z=function(e,t,i,n){return new(i||(i=Promise))((function(r,a){function o(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))},Q=function(e,t){var i,n,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{i=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},ee=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(ee=function(){return 1e3*Math.floor(window.performance.now())});var te,ie=function(){function e(e,t,i){this._optionalEventFlags={},this._ended=!1,this._telemetryLogger=e,this._activityName=t,this._cv=i?J.getNextChild(i._cv):J.getNext(),this._dataFields=[],this._success=void 0,this._startTime=ee()}return e.createNew=function(t,i){return new e(t,i)},e.prototype.createChildActivity=function(t){return new e(this._telemetryLogger,t,this)},e.prototype.setEventFlags=function(e){this._optionalEventFlags=e},e.prototype.addDataField=function(e){this._dataFields.push(e)},e.prototype.addDataFields=function(e){var t;(t=this._dataFields).push.apply(t,e)},e.prototype.setSuccess=function(e){this._success=e},e.prototype.setResult=function(e,t,i){this._result={code:e,type:t,tag:i}},e.prototype.endNow=function(){if(!this._ended){void 0===this._success&&void 0===this._result&&$(B.Warning,U.Core,(function(){return"Activity does not have success or result set"}));var e=ee()-this._startTime;this._ended=!0;var t={duration:e,count:1,aggMode:0,cV:this._cv.getString(),success:this._success,result:this._result};return this._telemetryLogger.sendActivity(this._activityName,t,this._dataFields,this._optionalEventFlags)}$(B.Error,U.Core,(function(){return"Activity has already ended"}))},e.prototype.executeAsync=function(e){return Z(this,void 0,void 0,(function(){var t=this;return Q(this,(function(i){return[2,e(this).then((function(e){return t.endNow(),e})).catch((function(e){throw t.endNow(),e}))]}))}))},e.prototype.executeSync=function(e){try{var t=e(this);return this.endNow(),t}catch(e){throw this.endNow(),e}},e.prototype.executeChildActivityAsync=function(e,t){return Z(this,void 0,void 0,(function(){return Q(this,(function(i){return[2,this.createChildActivity(e).executeAsync(t)]}))}))},e.prototype.executeChildActivitySync=function(e,t){return this.createChildActivity(e).executeSync(t)},e}(),ne=(te=function(e,t){return(te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}te(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),re=function(e,t,i,n){return new(i||(i=Promise))((function(r,a){function o(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))},ae=function(e,t){var i,n,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{i=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ne(t,e),t.prototype.executeActivityAsync=function(e,t){return re(this,void 0,void 0,(function(){return ae(this,(function(i){return[2,this.createNewActivity(e).executeAsync(t)]}))}))},t.prototype.executeActivitySync=function(e,t){return this.createNewActivity(e).executeSync(t)},t.prototype.createNewActivity=function(e){return ie.createNew(this,e)},t.prototype.sendActivity=function(e,t,i,n){return this.sendTelemetryEvent({eventName:e,eventContract:{name:T.Office.System.Activity.contractName,dataFields:T.Office.System.Activity.getFields(t)},dataFields:i,eventFlags:n})},t.prototype.sendError=function(e){var t=T.Office.System.Error.getFields("Error",e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t}(Y);class se{constructor(e,t,i=!1){this.kpisEnabled=i;const{logGroupName:n,tenant:r}=e,{tenantName:a,ariaTenantToken:o,nexusTenantToken:s}=r;this._oTelTelemetryLogger=new oe,this._logGroupName=n,this._oTelTelemetryLogger.addSink(t),this._oTelTelemetryLogger.setTenantTokens({Office:{[a]:{ariaTenantToken:o,nexusTenantToken:s,[n]:{}}}}),this._namespace=`Office.${a}.${n}`}logEvent(e,t,i,n,r,a,o,s){const l=`${i}.${t}`;if(n===F.a.Debug)return;const u=`${this._namespace}.${l}`,d=[S("Tag",e),S("Level",n)];r&&d.push(C("Data",JSON.stringify(r))),d.forEach(e=>e.classification=c.SystemMetadata),this.uploadEvent(u,d,void 0===a?se.DEFAULT_SAMPLING_POLICY:a,void 0===o?se.DEFAULT_DIAGNOSTIC_LEVEL:o,void 0===s?se.DEFAULT_DATA_CATEGORIES:s)}logKpi(e,t,i,n,r){if(!this.kpisEnabled)return;const a=`KPIs.${e}`,l=`${this._namespace}.${a}`,u=[C("Entity_Id",t)];n&&u.push(C("Data",JSON.stringify(n))),u.forEach(e=>e.classification=c.SystemMetadata);const d={name:"Funnel",dataFields:T.Office.System.Funnel.getFields(this._logGroupName,{name:this._logGroupName,state:i})};this.uploadEvent(l,u,void 0===r?se.DEFAULT_SAMPLING_POLICY:r,s.FullEvent,o.ProductServiceUsage,d)}logStandaloneMetric(e,t,i,n,r=[]){const a=void 0===t?se.DEFAULT_SAMPLING_POLICY:t,o=void 0===i?se.DEFAULT_DIAGNOSTIC_LEVEL:i,s=void 0===n?se.DEFAULT_DATA_CATEGORIES:n,c=`${this._namespace}.${e}`;this.uploadEvent(c,r,a,o,s)}createActivity(e,t){const i=t?`${t}.${e}`:e,n=`${this._namespace}.${i}`,r=ie.createNew(this._oTelTelemetryLogger,n),a={dataCategories:o.ProductServiceUsage};return r.setEventFlags(a),r}uploadEvent(e,t,i,n,o,s){this._oTelTelemetryLogger.sendTelemetryEvent({eventName:e,dataFields:t,eventContract:s,eventFlags:{dataCategories:o,diagnosticLevel:n,costPriority:a.Normal,persistencePriority:r.Normal,samplingPolicy:i}})}}se.DEFAULT_SAMPLING_POLICY=n.Measure,se.DEFAULT_DIAGNOSTIC_LEVEL=s.FullEvent,se.DEFAULT_DATA_CATEGORIES=o.ProductServiceUsage;new class{constructor(e=!1){this.useConsoleLogger=e,this._consoleLogger=new L(q())}logEvent(e,t,i,n,r,a,o,s){const c=`${i}.${t}`;this.useConsoleLogger&&this._consoleLogger.logData({message:c,data:r})}logKpi(e,t,i,n,r,a,o,s){const c=`KPIs.${e}`;this.useConsoleLogger&&this._consoleLogger.logData({kpiEvent:`${c}.${t}`,engagement:i,data:s})}logStandaloneMetric(e,t,i,n,r){this.useConsoleLogger&&this._consoleLogger.logData({standaloneMetric:e})}createActivity(e,t){const i=`${t}.${e}`;return this.useConsoleLogger&&this._consoleLogger.logData({activity:i}),M()}};var ce,le,ue;!function(e){e.Host="Host",e.CorrectionsOfferLevel="CorrectionsOfferLevel",e.EnhancementsOfferLevel="EnhancementsOfferLevel",e.RefinementsOfferLevel="RefinementsOfferLevel",e.SimilarityOfferLevel="SimilarityOfferLevel",e.WritingAnalyticsOfferLevel="WritingAnalyticsOfferLevel",e.HeadingDetectionOffer="HeadingDetectionOffer",e.KeyPointsOffer="KeyPointsOffer",e.GoalsOfferLevel="GoalsOfferLevel",e.CorrectionsCategoryLevel="CorrectionsCategoryLevel",e.EnhancementsCategoryLevel="EnhancementsCategoryLevel",e.GoalsCategoryLevel="GoalsCategoryLevel",e.RefinementsCategoryLevel="RefinementsCategoryLevel",e.SimilarityCategoryLevel="SimilarityCategoryLevel",e.WritingAnalyticsCategoryLevel="WritingAnalyticsCategoryLevel",e.CorrectionsSuggestionLevel="CorrectionsSuggestionLevel",e.EnhancementsSuggestionLevel="EnhancementsSuggestionLevel",e.RefinementsSuggestionLevel="RefinementsSuggestionLevel",e.SimilaritySuggestionLevel="SimilaritySuggestionLevel",e.WritingAnalyticsSuggestionLevel="WritingAnalyticsSuggestionLevel"}(ce||(ce={}));class de{constructor(e){this._logger=e,this._loggedEngagements=new Map,this._loggedEngagements.set(de.HOST_ENTITY_ID,new Set)}logOffered(e,t,i,n){const r=O.Offered;n&&this.hasLoggedEngagement(t,e,r)||this.logEngagement(e,t,r,i)}logSeen(e,t,i,n,r){const a=O.Seen;n&&this.completeChain(e,t,a,i),r&&this.hasLoggedEngagement(t,e,a)||(this.hasLoggedEngagement(t,e,O.Offered)?this.logEngagement(e,t,a,i):this._logger.logEvent(571524805,"LoggedSeenWithoutOffered",w.Host,F.a.Error,{entityId:e,kpiGroup:t}))}logTried(e,t,i,n,r){const a=O.Tried;n&&this.completeChain(e,t,a,i),r&&this.hasLoggedEngagement(t,e,a)||(this.hasLoggedEngagement(t,e,O.Seen)?this.logEngagement(e,t,a,i):this._logger.logEvent(571524806,"LoggedTriedWithoutSeen",w.Host,F.a.Error,{entityId:e,kpiGroup:t}))}logKept(e,t,i,n,r){const a=O.Kept;this.logKeptOrRejected(a,e,t,i,n,r)}logRejected(e,t,i,n,r){const a=O.Rejected;this.logKeptOrRejected(a,e,t,i,n,r)}logKeptOrRejected(e,t,i,n,r,a){r&&this.completeChain(t,i,e,n),a&&this.hasLoggedEngagement(i,t,e)||this.validateKeptOrRejectedForEntity(t,i,e)&&this.logEngagement(t,i,e,n)}logEngagement(e,t,i,n){this._logger.logKpi(t,e,i,n,void 0,void 0),this.storeLoggedEngagement(t,e,i),this._loggedEngagements.get(de.HOST_ENTITY_ID).has(i)||(this._logger.logKpi(ce.Host,de.HOST_ENTITY_ID,i,void 0,void 0,void 0),this._loggedEngagements.get(de.HOST_ENTITY_ID).add(i))}storeLoggedEngagement(e,t,i){const n=de.getIdentifierForEntityInGroup(t,e);this._loggedEngagements.has(n)||this._loggedEngagements.set(n,new Set),this._loggedEngagements.get(n).add(i)}hasLoggedEngagement(e,t,i){const n=de.getIdentifierForEntityInGroup(t,e),r=this._loggedEngagements.get(n);return!!r&&r.has(i)}completeChain(e,t,i,n){i!==O.Offered&&(this.logOffered(e,t,n,!0),i!==O.Seen&&(this.logSeen(e,t,n,!1,!0),i!==O.Tried&&this.logTried(e,t,n,!1,!0)))}validateKeptOrRejectedForEntity(e,t,i){return!!this.hasLoggedEngagement(t,e,O.Tried)||(this._logger.logEvent(571524807,"LoggedKeptOrRejectedWithoutTried",w.Host,F.a.Error,{entityId:e,kpiGroup:t,engagement:i}),!1)}static getIdentifierForEntityInGroup(e,t){return`${t}.${e}`}}de.HOST_ENTITY_ID="KpiTracker",function(e){e[e.Unknown=0]="Unknown",e[e.Disabled=1]="Disabled",e[e.Corrections=2]="Corrections",e[e.Refinements=3]="Refinements",e[e.KeyPoints=4]="KeyPoints",e[e.WritingAnalytics=5]="WritingAnalytics",e[e.Similarity=6]="Similarity"}(le||(le={})),function(e){e.Acronyms="Acronyms",e.Clarity="Clarity",e.Conciseness="Conciseness",e.DictationCorrections="Did you say?",e.Formality="Formality",e.Grammar="Grammar",e.Inclusiveness="Inclusiveness",e.KeyPoints="KeyPoints",e.Perspectives="Perspectives",e.PunctuationConventions="Punctuation Conventions",e.Resume="Resume",e.SensitiveGeopoliticalReferences="Sensitive Geopolitical References",e.Spelling="Spelling",e.Topics="Topics",e.UncommonWords="Uncommon Words",e.Vocabulary="Vocabulary",e.TopProofingIssues="TopProofingIssues",e.Similarity="Similarity"}(ue||(ue={}));le.Corrections,ce.CorrectionsOfferLevel,ce.CorrectionsCategoryLevel,ce.CorrectionsSuggestionLevel,le.Refinements,ce.RefinementsOfferLevel,ce.RefinementsCategoryLevel,ce.RefinementsSuggestionLevel,le.WritingAnalytics,ce.WritingAnalyticsOfferLevel,ce.WritingAnalyticsCategoryLevel,ce.WritingAnalyticsSuggestionLevel,le.KeyPoints,ce.EnhancementsOfferLevel,ce.EnhancementsCategoryLevel,ce.EnhancementsSuggestionLevel,le.Similarity,ce.SimilarityOfferLevel,ce.SimilarityCategoryLevel,ce.SimilaritySuggestionLevel;var he;!function(e){e.Offer="Offer",e.UncommonWords="UncommonWords",e.Readability="Readability",e.DistinctWords="DistinctWords",e.TimeToRead="TimeToRead",e.TimeToSpeak="TimeToSpeak",e.Navigation="Navigation",e.KeyPoints="KeyPoints",e.Similarity="Similarity",e.Stats="Stats",e.FormalityGoal="FormalityGoal",e.HeadingDetectionOffer="HeadingDetectionOffer",e.KeyPointsOffer="KeyPointsOffer",e.TopProofingIssues="TopProofingIssues"}(he||(he={}));i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return c})),i.d(t,"d",(function(){return l})),i.d(t,"e",(function(){return s})),i.d(t,"i",(function(){return n})),i.d(t,"a",(function(){return T})),i.d(t,"f",(function(){return O})),i.d(t,"h",(function(){return F.a})),i.d(t,"g",(function(){return se}))},4328:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",t.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",t.NULL_ARGUMENT="NULL argument",t.KEY_NOT_FOUND="Key Not Found",t.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",t.CANNOT_UNBIND="Could not unbind serviceIdentifier:",t.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",t.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",t.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",t.UNDEFINED_INJECT_ANNOTATION=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},t.CIRCULAR_DEPENDENCY="Circular dependency found:",t.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",t.INVALID_BINDING_TYPE="Invalid binding type:",t.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",t.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",t.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",t.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",t.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",t.ARGUMENTS_LENGTH_MISMATCH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},t.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",t.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",t.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",t.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",t.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",t.POST_CONSTRUCT_ERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]},t.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."},t.STACK_OVERFLOW="Maximum call stack size exceeded"},4329:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}));function n(e,t,i,n){var r,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,i,o):r(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o}function r(e,t){return function(i,n){t(i,n,e)}}},4450:function(e,t,i){"use strict";i.d(t,"g",(function(){return n})),i.d(t,"h",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return o})),i.d(t,"d",(function(){return s})),i.d(t,"c",(function(){return c})),i.d(t,"e",(function(){return l})),i.d(t,"f",(function(){return u}));var n=-1,r=0,a=-1,o=0,s="EditorProofing_SkittleVisible",c="EditorProofing_SkittleValueNonZero",l=15,u=20},4478:function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return h}));var n=i(3859),r=i(2734),a=i(4479),o=i(4737),s=i(11825),c=i(8493),l=i(5687),u=i(16426);i(8330);const d={Container:Symbol.for("Container"),CritiqueEventHandler:o.a.CritiqueEventHandler,DictionaryCritiqueFilter:o.a.DictionaryCritiqueFilter,EditorService:n.a.EditorService,FilteringEventHandler:o.a.FilteringEventHandler,NodeEventHandler:o.a.NodeEventHandler,IAppStateStore:Symbol.for("IAppStateStore"),IAriaStatusStateStore:s.a.IAriaStatusStateStore,IAriaStatusUniqueProxy:s.a.IAriaStatusUniqueProxy,IBackgroundActivityFactory:Symbol.for("IBackgroundActivityFactory"),ICalloutFocusManager:u.a.ICalloutFocusManager,ICheckRefinementsFeature:Symbol.for("ICheckRefinementsFeature"),IComponentInitializer:Symbol.for("IComponentInitializer"),IContentValidator:o.a.IContentValidator,ICritiqueCalloutStateStore:u.a.ICritiqueCalloutStateStore,ICritiqueContextValidator:o.a.ICritiqueContextValidator,ICritiqueDispatcher:o.a.ICritiqueDispatcher,ICritiqueFilterer:o.a.ICritiqueFilterer,ICritiqueInterpreter:o.a.ICritiqueInterpreter,ICritiquesMessageEmitter:a.a.ICritiquesMessageEmitter,ICritiqueStore:o.a.ICritiqueStore,IDescriptorManager:a.a.IDescriptorManager,IDisabler:Symbol.for("IDisabler"),IDefaultStyleDefinitionsFactory:Symbol.for("IDefaultStyleDefinitionsFactory"),IDropdownStateStoreFactory:u.a.IDropdownStateStoreFactory,IEditorClientSettings:Symbol.for("IEditorClientSettings"),IElementsRetriever:r.a.IElementsRetriever,IExternalSettingsFeature:n.a.IExternalSettingsFeature,IFeatureFlagsReader:n.a.IFeatureFlagsReader,IGraphNodeBuilderFactory:r.a.IGraphNodeBuilderFactory,IGuidGenerator:n.a.IGuidGenerator,IHighContrastModeDetector:o.a.IHighContrastModeDetector,IHostEmitter:n.a.IHostEmitter,IHostModelPersistedStore:r.a.IHostModelPersistedStore,IHostModelSettings:r.a.IHostModelSettings,IHostSettings:n.a.IHostSettings,IHostTilingEmitter:r.a.IHostTilingEmitter,IIndexReadjuster:l.a.IIndexReadjuster,IInstrumentationMessageProcessor:n.a.IInstrumentationMessageProcessor,ILanguageInfoProvider:n.a.ILanguageInfoProvider,ILanguageScriptDirectionDetector:o.a.ILanguageScriptDirectionDetector,ILocalizationStringsImporter:n.a.ILocalizationStringsImporter,ILocalizer:n.a.ILocalizer,ILogger:n.a.ILogger,TelemetrySink:n.a.TelemetrySink,IMultiLangTileCheckResponseTransformer:a.a.IMultiLangTileCheckResponseTransformer,IAutoCorrectTransformer:a.a.IAutoCorrectTransformer,INodePoller:r.a.INodePoller,IParagraphNodesBuilder:Symbol.for("IParagraphNodesBuilder"),IParagraphNodeDictionary:r.a.IParagraphNodeDictionary,IPreOrderTraverser:r.a.IPreOrderTraverser,IPresentationDomSettings:s.a.IPresentationDomSettings,IPresentationDomStyleDefinitions:s.a.IStyleDefinitions,IPresentationSettings:o.a.IPresentationSettings,IProofingDom:r.a.IProofingDom,IProofingEmitter:n.a.IProofingEmitter,IProofingPersistedStore:n.a.IProofingPersistedStore,IRangeBoundariesChecker:Symbol.for("IRangeBoundariesChecker"),IReactComponentInitializer:Symbol.for("IReactComponentInitializer"),IRegistrar:Symbol.for("IRegistrar"),IRemoteSettingsSyncer:Symbol.for("IRemoteSettingsSyncer"),IResourceUrlFormatter:n.a.IResourceUrlFormatter,IRoamingDictionaryFeature:n.a.IRoamingDictionaryFeature,IsPremiumUser:n.a.IsPremiumUser,IsUpsellUser:n.a.IsUpsellUser,ISessionContextProvider:n.a.ISessionContextProvider,ISettingsEmitter:Symbol.for("ISettingsEmitter"),ISettingsEmitterBase:c.g.ISettingsEmitterBase,IShowSynonymsFeature:Symbol.for("IShowSynonymsFeature"),ISquigglerStateStoreFactory:s.a.ISquigglerStateStoreFactory,ISquiggleStateStoreFactory:s.a.ISquiggleStateStoreFactory,ISquiggleTooltipStateStore:s.a.ISquiggleTooltipStateStore,ISquiggleTooltipStateStoreFactory:s.a.ISquiggleTooltipStateStoreFactory,IStoreEntryReader:c.g.IStoreEntryReader,IStoreEntryWriter:c.g.IStoreEntryWriter,IStyleDefinitions:s.a.IStyleDefinitions,ISuggestionButtonStateStoreFactory:u.a.ISuggestionButtonStateStoreFactory,ISynonymFiller:a.a.ISynonymFiller,ISynonymRequestBuilder:a.a.ISynonymRequestBuilder,ISystemPersistedStore:Symbol.for("ISystemPersistedStore"),ITextExtractor:l.a.ITextExtractor,ITextNodeRangeBuilder:l.a.ITextNodeRangeBuilder,ITextProcessorFactory:Symbol.for("ITextProcessorFactory"),ITextRetrieverFactory:l.a.ITextRetrieverFactory,ITextTilesMessageProcessor:Symbol.for("ITextTilesMessageProcessor"),ITextUnitChunker:l.a.ITextUnitChunker,ITileCheckRequestBuilder:a.a.ITileCheckRequestBuilder,ITileCheckResponseTransformer:a.a.ITileCheckResponseTransformer,ITileIdFormatter:a.a.ITileIdFormatter,ITileNodeDictionary:r.a.ITileNodeDictionary,ITileNodeReader:r.a.ITileNodeReader,ITerminalNodeReader:r.a.ITerminalNodeReader,ITerminalNodeWriter:r.a.ITerminalNodeWriter,ITransportActivity:n.a.ITransportActivity,ITransportLogger:n.a.ITransportLogger,IUpsellFeature:n.a.IUpsellFeature,IUpsellStore:r.a.IUpsellStore,IUserInfoStrategy:n.a.IUserInfoStrategy,IUserInfoUpdater:Symbol.for("IUserInfoUpdater"),IUxLanguageDetector:n.a.IUxLanguageDetector,IWordCount:l.a.IWordCount,IWordCountDetector:l.a.IWordCountDetector,IWordDictionary:o.a.IWordDictionary,PremiumCritiqueFilter:r.a.PremiumCritiqueFilter,SpanEventHandler:o.a.SpanEventHandler,SynonymService:n.a.SynonymService,IE2eMetric:n.a.IE2eMetric,IEnabledCritiqueTypes:r.a.IEnabledCritiqueTypes,EnabledCritiqueTypesCritiqueFilter:r.a.EnabledCritiqueTypesCritiqueFilter,IUnsignedInEditorFeature:Symbol.for("IUnsignedInEditorFeature"),IsSignedInUser:n.a.IsSignedInUser},h={ICleanable:n.a.ICleanable,IRegistrable:n.a.IRegistrable,IStyleOverrides:Symbol.for("IStyleOverrides"),ITextProcessor:Symbol.for("ITextProcessor"),IHostEmitterArray:n.a.IHostEmitterArray,ITextUnitSeparator:l.a.ITextUnitSeparator,EventHub:o.a.EventHub}},4479:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(3859),r=i(10029);const a={IGuidGenerator:n.a.IGuidGenerator,IProofingPersistedStore:n.a.IProofingPersistedStore,IProofingEmitter:n.a.IProofingEmitter,IFeatureFlagsReader:n.a.IFeatureFlagsReader,IUserInfoStrategy:n.a.IUserInfoStrategy,EditorService:n.a.EditorService,SynonymService:n.a.SynonymService,ICritiquesMessageEmitter:Object(r.a)("ICritiquesMessageEmitter"),IDescriptorManager:Object(r.a)("IDescriptorManager"),ITileCheckRequestBuilder:Object(r.a)("ITileCheckRequestBuilder"),ITileCheckResponseTransformer:Object(r.a)("ITileCheckResponseTransformer"),IMultiLangTileCheckResponseTransformer:Object(r.a)("IMultiLangTileCheckResponseTransformer"),IAutoCorrectTransformer:Object(r.a)("IAutoCorrectTransformer"),ITileIdFormatter:Object(r.a)("ITileIdFormatter"),ISynonymRequestBuilder:Object(r.a)("ISynonymRequestBuilder"),ISynonymFiller:Object(r.a)("ISynonymFiller"),IOrchestratorSettings:Object(r.a)("IOrchestratorSettings"),IHostSettings:n.a.IHostSettings,ILogger:n.a.ILogger,IHostEmitter:n.a.IHostEmitter}},4736:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(3593),r=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===n.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}();t.Metadata=r},4737:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(10029),r=i(3859),a=i(2734),o=i(5687);const s={IContentValidator:Object(n.a)("IContentValidator"),ILanguageInfoProvider:r.a.ILanguageInfoProvider,ILogger:r.a.ILogger,CritiqueEventHandler:Object(n.a)("CritiqueEventHandler"),DictionaryCritiqueFilter:Object(n.a)("DictionaryCritiqueFilter"),EventHub:Object(n.a)("EventHub"),FilteringEventHandler:Object(n.a)("FilteringEventHandler"),ICritiqueActionHandler:Object(n.a)("ICritiqueActionHandler"),ICritiqueContextValidator:Object(n.a)("ICritiqueContextValidator"),ICritiqueDispatcher:Object(n.a)("ICritiqueDispatcher"),ICritiqueInterpreter:Object(n.a)("ICritiqueInterpreter"),ICritiqueStore:Object(n.a)("ICritiqueStore"),ICritiquesBrokerFactory:Object(n.a)("ICritiquesBrokerFactory"),IProofingPersistedStore:r.a.IProofingPersistedStore,ITextExtractor:o.a.ITextExtractor,NodeEventHandler:Object(n.a)("NodeEventHandler"),SpanEventHandler:Object(n.a)("SpanEventHandler"),IHighContrastModeDetector:Object(n.a)("IHighContrastModeDetector"),ILanguageScriptDirectionDetector:Object(n.a)("ILanguageScriptDirectionDetector"),IUxLanguageDetector:Object(n.a)("IUxLanguageDetector"),IHostEmitterArray:r.a.IHostEmitterArray,IProofingEmitter:r.a.IProofingEmitter,IHostSettings:a.a.IHostSettings,IProofingDom:a.a.IProofingDom,IPresentationSettings:Object(n.a)("IPresentationSettings"),IWordDictionary:a.a.IWordDictionary,ICritiqueFilterer:a.a.ICritiqueFilterer,IUpsellStore:a.a.IUpsellStore}},4738:function(e,t,i){"use strict";var n=i(10034);i.d(t,"a",(function(){return n}));var r=i(10035);i.d(t,"b",(function(){return r}))},4739:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r}));function n(e,t,i,n){var r,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,i,o):r(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o}function r(e,t){return function(i,n){t(i,n,e)}}},5234:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};t.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};t.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},5587:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Hide=0]="Hide",e[e.ShowCallout=1]="ShowCallout",e[e.ShowDialog=2]="ShowDialog"}(n||(n={}))},5685:function(e){e.exports=JSON.parse('{"k":"Wjc","l":"Xjc","m":"Yjc","v":"Zjc","r":"_jc","q":"$jc","p":"akc","o":"bkc","n":"ckc","t":"dkc","s":"ekc","u":"fkc","d":"gkc","e":"hkc","g":"ikc","f":"jkc","i":"kkc","h":"lkc","c":"mkc","j":"nkc","a":"okc","b":"pkc"}')},5686:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(4328),r=i(3593);function a(e,t,i,r,a){var o={},s="number"==typeof a,c=void 0!==a&&s?a.toString():i;if(s&&void 0!==i)throw new Error(n.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(e,t)&&(o=Reflect.getMetadata(e,t));var l=o[c];if(Array.isArray(l))for(var u=0,d=l;u<d.length;u++){var h=d[u];if(h.key===r.key)throw new Error(n.DUPLICATED_METADATA+" "+h.key.toString())}else l=[];l.push(r),o[c]=l,Reflect.defineMetadata(e,o,t)}function o(e,t){Reflect.decorate(e,t)}function s(e,t){return function(i,n){t(i,n,e)}}t.tagParameter=function(e,t,i,n){a(r.TAGGED,e,t,n,i)},t.tagProperty=function(e,t,i){a(r.TAGGED_PROP,e.constructor,t,i)},t.decorate=function(e,t,i){"number"==typeof i?o([s(i,e)],t):"string"==typeof i?Reflect.decorate([e],t,i):o([e],t)}},5687:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(3859),r=i(10029);const a={IFeatureFlagsReader:n.a.IFeatureFlagsReader,IHostSettings:n.a.IHostSettings,IIndexReadjuster:Object(r.a)("IIndexReadjuster"),ITextExtractor:Object(r.a)("ITextExtractor"),ITextNodeRangeBuilder:Object(r.a)("ITextNodeRangeBuilder"),ITextRetrieverFactory:Object(r.a)("ITextRetrieverFactory"),ITextUnitChunker:Object(r.a)("ITextUnitChunker"),ITextUnitSeparator:Object(r.a)("ITextUnitSeparator"),IWordCount:Object(r.a)("IWordCount"),IWordCountDetector:Object(r.a)("IWordCountDetector")}},5688:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(3108),r=i(2037),a=i(10036);let o=class{constructor(){this._listenerId=0,this._callbacks=new Map,this.ignoreDisablers=!1,this.disablers=[],this.enablers=[]}triggerListeners(e){const t=this._callbacks.get(e.eventId);if(!t||0===t.length)return;let i=!0;return t.forEach(t=>{const[n,r]=t.callback(e);i=this.processCallBackResult(i,n,r)}),i}processCallBackResult(e,t,i){return t!==a.a.NoReaction?e&&t===a.a.EnableFeature:e}nextListenerId(){return this._listenerId+=1,this._listenerId}addListener(e,t){const i={callback:t,id:this.nextListenerId()};let n=this._callbacks.get(e);return n||(n=[],this._callbacks.set(e,n)),n.push(i),i.id}removeListener(e){e&&this._callbacks.forEach((t,i,n)=>{if(t){if(-1!==t.findIndex(t=>t.id===e))return void n.set(i,t.filter(t=>t.id!==e))}})}emitAndEvaluate(e){const t=this.triggerListeners(e);if(!this.ignoreDisablers)for(const e of this.disablers){if(!0===e)return!1;if(!1!==e&&e.check())return!1}let i=!1;for(const e of this.enablers)if(!0===e||!1!==e&&e.check()){i=!0;break}return void 0===t?i:i&&t}};o=Object(n.a)([Object(r.injectable)()],o)},6268:function(e,t,i){var n=i(16396),r=i(78);"string"==typeof n&&(n=[[e.i,n]]);for(var a=0;a<n.length;a++)r.loadStyles(n[a][1],!1);n.locals&&(e.exports=n.locals)},6269:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=0;t.id=function(){return n++}},6270:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Info=0]="Info",e[e.Warn=1]="Warn",e[e.Error=2]="Error",e[e.Debug=3]="Debug"}(n||(n={}))},642:function(e,t,i){"use strict";var n=i(31),r=i(413),a=i(23),o=i(1),s=i(8),c=i(14),l=i(2),u=Object(l.mutatorAction)("initializeLightning",(function(e){var t,i;if(a.g.info("initialize lightning store"),Object(r.a)().lastShownId=null,Object(r.a)().lightedCount=0,Object(r.a)().unseenItems=new c.ObservableMap,e)try{for(var n=Object(o.k)(e),s=n.next();!s.done;s=n.next()){var l=s.value;Object(r.a)().unseenItems.set(l.identity,l)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}}));var d=i(151),h="ows/v1.0/lightning/items/unseen";function g(){return a.g.info("initialize lightning from server"),Object(d.b)(h).then((function(e){var t=e.map(f);u(t)}))}function f(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var p,m=i(19),b=i(24),y="lightning",v="UnseenLightening";function _(){var e,t,i;if(!p){var n=Object(s.a)(y);if(n)p=function(e){a.g.info("initialize lightning from override query parameter");var t=e.split(",").map((function(e){return{identity:e,visible:!1}}));return u(t),Promise.resolve()}(n);else{var r=Object(m.a)().PrimeSettings;if(Object(b.i)("lightning-initFromSD")&&r&&r.Items)try{for(var c=Object(o.k)(r.Items),l=c.next();!l.done;l=c.next()){var d=l.value;if(d.Id===v&&d.Value){i=d.Value,a.g.info("initialize lightning from session data"),u(i.map((function(e){return{identity:e.id,visible:!1,category:e.category}}))),p=Promise.resolve();break}}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}p||(p=g())}}return p}var I=i(1294),S=Object(l.action)("lightup",(function(e){return{id:e}})),C=S;Object(l.mutator)(S,(function(e){a.g.info("lightup - id:"+e.id),Object(r.a)().lastShownId=e.id,Object(r.a)().lightedCount++;var t=Object(r.a)().unseenItems.get(e.id);t&&(t.visible=!0)})),Object(l.orchestrator)(S,(function(e){Object(I.a)("LIGHTUP",e.id)}));var E,T=i(514);function O(e,t){(a.g.info("lightupOrReject - id:"+e+", recurrenceCount:"+t+", lightedCount:"+Object(r.a)().lightedCount+", lastShown:"+Object(r.a)().lastShownId),Object(T.w)())?a.g.info("lightning is disabled for deeplink"):Object(r.a)().unseenItems.has(e)&&(!Object(r.a)().lastShownId||function(e,t){var i=!1,n=Object(r.a)().lastShownId;if(n&&t&&!function(){var e=Object(r.a)(),t=e.lastShownId,i=e.unseenItems;return t&&i.has(t)&&i.get(t).visible}()){var a=t.indexOf(n),o=t.indexOf(e);a>=0&&a+1==o&&(i=!0)}return i}(e,t)||function(e){var t=Object(r.a)().unseenItems.get(e);return!!t&&t.category==E.UIFeatureDiscovery}(e)||function(e){var t=Object(r.a)().unseenItems.get(e);return!!t&&t.category==E.Compliance}(e))&&C(e)}function w(e,t,i){a.g.info("beginLightning - id:"+e),t((function(){_().then((function(){return O(e,i)})).catch((function(t){a.g.warn("something is wrong, lightning id:"+e+", reason:"+t)}))}))}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(E||(E={}));var j=i(873);i.d(t,"c",(function(){return x})),i.d(t,"d",(function(){return r.b})),i.d(t,"b",(function(){return w})),i.d(t,"a",(function(){return j.a}));var P=new n.c((function(){return i.e(506).then(i.bind(null,18524))})),x=new n.a(P,(function(e){return e.endLightningImp}))},7592:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"d",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return s}));var n=i(10030);const r=(e,t)=>({name:e,storeEntryType:n.a.Remote,defaultValue:t,lastValueFromStorage:void 0}),a=(e,t)=>({name:e,storeEntryType:n.a.User,defaultValue:t,lastValueFromStorage:void 0}),o=(e,t)=>({name:e,storeEntryType:n.a.System,defaultValue:t,lastValueFromStorage:void 0});var s;!function(e){e.FeatureFlags="featureFlags"}(s||(s={}))},7593:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(4328);function r(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function a(e){if(e.name)return e.name;var t=e.toString(),i=t.match(/^function\s*([^\s(]+)/);return i?i[1]:"Anonymous function: "+t}t.getServiceIdentifierAsString=r,t.listRegisteredBindingsForServiceIdentifier=function(e,t,i){var n="",r=i(e,t);return 0!==r.length&&(n="\nRegistered bindings:",r.forEach((function(e){var t="Object";null!==e.implementationType&&(t=a(e.implementationType)),n=n+"\n "+t,e.constraint.metaData&&(n=n+" - "+e.constraint.metaData)}))),n},t.circularDependencyToException=function e(t){t.childRequests.forEach((function(t){if(function e(t,i){return null!==t.parentRequest&&(t.parentRequest.serviceIdentifier===i||e(t.parentRequest,i))}(t,t.serviceIdentifier)){var i=function(e){return function e(t,i){void 0===i&&(i=[]);var n=r(t.serviceIdentifier);return i.push(n),null!==t.parentRequest?e(t.parentRequest,i):i}(e).reverse().join(" --\x3e ")}(t);throw new Error(n.CIRCULAR_DEPENDENCY+" "+i)}e(t)}))},t.listMetadataForTarget=function(e,t){if(t.isTagged()||t.isNamed()){var i="",n=t.getNamedTag(),r=t.getCustomTags();return null!==n&&(i+=n.toString()+"\n"),null!==r&&r.forEach((function(e){i+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+i}return" "+e},t.getFunctionName=a},7594:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(3108),r=i(2037),a=i(3859);let o=class{constructor(e){this._userInfoStrategy=e}check(){return this._userInfoStrategy.execute(!1,e=>(this.setUserInfo(e),e)),this.checkUserInfo()}setUserInfo(e){e&&(this.licenseType=e.licenseType,this.identityProvider=e.identityProvider),this.isLoggedIn=!!e}};o=Object(n.a)([Object(r.injectable)(),Object(n.b)(0,Object(r.inject)(a.a.IUserInfoStrategy))],o)},7595:function(e,t,i){"use strict";var n,r;i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),function(e){e.ActionHideSynonymsFromCallout="ActionHideSynonymsFromCallout",e.ActionShowCallout="ActionShowCallout",e.ActionShowSynonymsFromCallout="ActionShowSynonymsFromCallout",e.ActionUpsellButtonClicked="ActionUpsellButtonClicked",e.SignInInitialized="SignInInitialized",e.ActionDisableCritique="ActionDisableCritique",e.OverflowMenuClicked="OverflowMenuClicked"}(n||(n={})),function(e){e.AriaError="RunTimeErrors.AriaError",e.GetNewActivityError="RunTimeErrors.GetNewActivityError",e.EnvelopeFormatError="RunTimeErrors.EnvelopeFormatError",e.TelemetryError="RunTimeErrors.TelemetryError",e.RoamingDictionarySaveError="RunTimeErrors.RoamingDictionarySaveError",e.RoamingDictionaryInitError="RunTimeErrors.RoamingDictionaryInitError"}(r||(r={}))},771:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n={Accept:"",AccessibiltyChecker:"",Accounts:"",Add:"",AddEvent:"",AddFriend:"",AddReaction:"",Airplane:"",AirplaneSolid:"",AlarmClock:"",AlertSolid:"",AlignLeft:"",AlignRight:"",AllApps:"",AnalyticsLogo:"",Archive:"",Arrivals:"",Ascending:"",Assign:"",Attach:"",AutoEnhanceOn:"",Back:"",BingLogo:"",BlockContact:"",Blocked:"",BookingsLogo:"",BoxLogo:"",BulletedList:"",Bullseye:"",Calendar:"",CalendarReply:"",CalendarSettings:"",Camera:"",Cancel:"",Car:"",CaretLeftSolid8:"",CaretRightSolid8:"",CellPhone:"",ChatInviteFriend:"",Checkbox:"",CheckboxComposite:"",CheckMark:"",ChevronDown:"",ChevronDownMed:"",ChevronLeft:"",ChevronLeftMed:"",ChevronRight:"",ChevronRightMed:"",ChevronUp:"",ChromeClose:"",ChromeMinimize:"",CircleAddition:"",CircleAdditionSolid:"",CircleFill:"",CirclePlus:"",CircleRing:"",CityNext:"",Clear:"",ClearFilter:"",ClearNight:"",ClearSelection:"",ClipboardList:"",Clock:"",ClosePane:"",Cloud:"",CloudAdd:"",CloudDownload:"",CloudEdit:"",CloudLink:"",CloudUpload:"",CodeEdit:"",CollapseContent:"",Color:"",CommentUrgent:"",Completed:"",CompletedSolid:"",Contact:"",ContactCard:"",ContactList:"",ContactLock:"",Copy:"",DateTime:"",DeclineCall:"",Delete:"",DeliveryTruck:"",Descending:"",DeveloperTools:"",Diamond:"",Dislike:"",DocumentSearch:"",Door:"",DoubleChevronDown:"",DoubleChevronLeft:"",DoubleChevronRight:"",DoubleChevronUp:"",Down:"",Download:"",Drop:"",DropboxLogo:"",EaseOfAccess:"",EatDrink:"",Edit:"",Education:"",EgnyteLogo:"",Embed:"",EMI:"",Emoji:"",Emoji2:"",Encryption:"",EndPointSolid:"",Equalizer:"",Error:"",ErrorBadge:"",Event:"",EventAccepted:"",EventDeclined:"",EventInfo:"",EventTentative:"",EventToDoLogo:"",ExploreContent:"",FabricFolder:"",FabricMovetoFolder:"",FabricNewFolder:"",FacebookLogo:"",FangBody:"",FavoriteList:"",FavoriteStar:"",FavoriteStarFill:"",Feedback:"",FileTemplate:"",Filter:"",Flag:"",Flashlight:"",Flow:"",FluidLogo:"",Folder:"",FolderHorizontal:"",Forward:"",ForwardEvent:"",Frigid:"",FullScreen:"",FullView:"",GIF:"",GiftCard:"",GlobalNavButton:"",Globe:"",Globe2:"",GoogleDriveLogo:"",GotoToday:"",GripperDotsVertical:"",Group:"",Heart:"",HeartBroken:"",HeartFill:"",Help:"",Hide:"",Hide3:"",History:"",Home:"",Hotel:"",Important:"",Inbox:"",Info:"",InsertSignatureLine:"",InsertTextBox:"",Insights:"",Label:"",LargeGrid:"",Lightbulb:"",LightningBolt:"",Like:"",Link:"",Link12:"",LinkedInLogo:"",List:"",LocaleLanguage:"",Location:"",LocationDot:"",Lock:"",Mail:"",MailAlert:"",MailAttached:"",MailCheck:"",MailForward:"",MailOptions:"",MailPause:"",MailSecure:"",MailSolid:"",MailUndelivered:"",MapDirections:"",MapPin:"",MarkAsProtected:"",Megaphone:"",MicrosoftTranslatorLogo:"",MiniExpand:"",MiniExpandMirrored:"",MobileSelected:"",Money:"",More:"",MoreVertical:"",MSNVideos:"",NavigateExternalInline:"",NewMail:"",NotePinned:"",NumberField:"",OfficeChat:"",OneDriveFileVault:"",OneDriveLogo:"",OneNoteLogo:"",OpenInNewTab:"",OpenInNewWindow:"",OpenPane:"",OpenSource:"",Org:"",OutlookLogo:"",OutlookLogoInverse:"",OutlookSpacesBucket:"",Package:"",Page:"",PageEdit:"",PageLink:"",PageRemove:"",ParkingLocation:"",ParkingLocationMirrored:"",PartlyCloudyDay:"",Paste:"",PasteAsText:"",PaymentCard:"",PDF:"",PencilReply:"",People:"",PeopleAdd:"",PeopleAlert:"",Personalize:"",Phone:"",Photo2:"",PieSingle:"",Pinned:"",PinnedSolid:"",PlainText:"",Play:"",POI:"",PreviewLink:"",Print:"",Puzzle:"",QuickNote:"",Read:"",Recent:"",RectangularClipping:"",RedEye:"",Refresh:"",RemoveContent:"",RemoveEvent:"",RemoveFromTrash:"",RemoveLink:"",Rename:"",ReopenPages:"",Reply:"",ReplyAll:"",ReportHacked:"",Ribbon:"",RightDoubleQuote:"",Ringer:"",RingerOff:"",Rotate:"",Sad:"",Save:"",ScheduleEventAction:"",ScrollUpDown:"",Search:"",SearchCalendar:"",Send:"",Settings:"",Share:"",SharedNotes:"",ShowTimeAs:"",SkypeForBusinessLogo:"",SkypeForBusinessLogo16:"",SkypeLogo:"",SkypeLogo16:"",Soccer:"",Sort:"",SortDown:"",SortLines:"",SortUp:"",SpecialEvent:"",SquareShapeSolid:"",Stack:"",StatusCircleCheckmark:"",StatusCircleErrorX:"",StatusCircleQuestionMark:"",Stopwatch:"",Sunny:"",SyncOccurence:"",SyncToPC:"",System:"",Tab:"",TabCenter:"",Table:"",Tag:"",TagSolid:"",Taskboard:"",TeamsLogo:"",TextDocumentSettings:"",TextDocumentShared:"",Ticket:"",Tiles:"",ToDoLogoOutline:"",TVMonitor:"",Undo:"",Unknown:"",Unlock:"",UnsyncOccurence:"",Up:"",Upload:"",Video:"",View:"",ViewAll:"",Volume2:"",Waffle:"",Warning:"",WebPublish:"",WipePhone:"",World:"",WorldClock:"",YammerLogo:"",ZoomIn:"",ZoomOut:""};t.b={fontFileName:"controlIcons",icons:n}},8329:function(e,t,i){"use strict";var n,r,a,o;i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return o})),function(e){e.O365="o365UserService",e.MSA="msaUserService",e.NONE="noneUserService"}(n||(n={})),function(e){e[e.MSA=0]="MSA",e[e.AAD=1]="AAD"}(r||(r={})),function(e){e.AAD="aad",e.MSA="msa",e.NONE="none"}(a||(a={})),function(e){e.NoLicense="NoLicense",e.Perpetual="Perpetual",e.Subscription="Subscription"}(o||(o={}))},8330:function(e,t,i){(function(e,t){
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var i;!function(i){!function(n){var r="object"==typeof t?t:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),a=o(i);function o(e,t){return function(i,n){"function"!=typeof e[i]&&Object.defineProperty(e,i,{configurable:!0,writable:!0,value:n}),t&&t(i,n)}}void 0===r.Reflect?r.Reflect=i:a=o(r.Reflect,a),function(t){var i=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",a=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,s={__proto__:[]}instanceof Array,c=!o&&!s,l={create:o?function(){return A(Object.create(null))}:s?function(){return A({__proto__:null})}:function(){return A({})},has:c?function(e,t){return i.call(e,t)}:function(e,t){return t in e},get:c?function(e,t){return i.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),d="object"==typeof e&&e.env&&"true"===e.env.REFLECT_METADATA_USE_MAP_POLYFILL,h=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var e={},t=[],i=function(){function e(e,t,i){this._index=0,this._keys=e,this._values=t,this._selector=i}return e.prototype["@@iterator"]=function(){return this},e.prototype[a]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var i=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:i,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var i=this._find(e,!0);return this._values[i]=t,this},t.prototype.delete=function(t){var i=this._find(t,!1);if(i>=0){for(var n=this._keys.length,r=i+1;r<n;r++)this._keys[r-1]=this._keys[r],this._values[r-1]=this._values[r];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new i(this._keys,this._values,n)},t.prototype.values=function(){return new i(this._keys,this._values,r)},t.prototype.entries=function(){return new i(this._keys,this._values,o)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[a]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function r(e,t){return t}function o(e,t){return[e,t]}}():Map,g=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[a]=function(){return this.keys()},e}():Set,f=new(d||"function"!=typeof WeakMap?function(){var e=16,t=l.create(),n=r();return function(){function e(){this._key=r()}return e.prototype.has=function(e){var t=a(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=a(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return a(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=a(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=r()},e}();function r(){var e;do{e="@@WeakMap@@"+s()}while(l.has(t,e));return t[e]=!0,e}function a(e,t){if(!i.call(e,n)){if(!t)return;Object.defineProperty(e,n,{value:l.create()})}return e[n]}function o(e,t){for(var i=0;i<t;++i)e[i]=255*Math.random()|0;return e}function s(){var t,i=(t=e,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):o(new Uint8Array(t),t):o(new Array(t),t));i[6]=79&i[6]|64,i[8]=191&i[8]|128;for(var n="",r=0;r<e;++r){var a=i[r];4!==r&&6!==r&&8!==r||(n+="-"),a<16&&(n+="0"),n+=a.toString(16).toLowerCase()}return n}}():WeakMap);function p(e,t,i){var n=f.get(e);if(I(n)){if(!i)return;n=new h,f.set(e,n)}var r=n.get(t);if(I(r)){if(!i)return;r=new h,n.set(t,r)}return r}function m(e,t,i){var n=p(t,i,!1);return!I(n)&&!!n.has(e)}function b(e,t,i){var n=p(t,i,!1);if(!I(n))return n.get(e)}function y(e,t,i,n){p(i,n,!0).set(e,t)}function v(e,t){var i=[],n=p(e,t,!1);if(I(n))return i;for(var r=function(e){var t=P(e,a);if(!w(t))throw new TypeError;var i=t.call(e);if(!C(i))throw new TypeError;return i}(n.keys()),o=0;;){var s=x(r);if(!s)return i.length=o,i;var c=s.value;try{i[o]=c}catch(e){try{D(r)}finally{throw e}}o++}}function _(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function I(e){return void 0===e}function S(e){return null===e}function C(e){return"object"==typeof e?null!==e:"function"==typeof e}function E(e,t){switch(_(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var i=3===t?"string":5===t?"number":"default",n=P(e,r);if(void 0!==n){var a=n.call(e,i);if(C(a))throw new TypeError;return a}return function(e,t){if("string"===t){var i=e.toString;if(w(i))if(!C(r=i.call(e)))return r;if(w(n=e.valueOf))if(!C(r=n.call(e)))return r}else{var n;if(w(n=e.valueOf))if(!C(r=n.call(e)))return r;var r,a=e.toString;if(w(a))if(!C(r=a.call(e)))return r}throw new TypeError}(e,"default"===i?"number":i)}function T(e){var t=E(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function O(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function w(e){return"function"==typeof e}function j(e){return"function"==typeof e}function P(e,t){var i=e[t];if(null!=i){if(!w(i))throw new TypeError;return i}}function x(e){var t=e.next();return!t.done&&t}function D(e){var t=e.return;t&&t.call(e)}function N(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var i=e.prototype,n=i&&Object.getPrototypeOf(i);if(null==n||n===Object.prototype)return t;var r=n.constructor;return"function"!=typeof r?t:r===e?t:r}function A(e){return e.__=void 0,delete e.__,e}t("decorate",(function(e,t,i,n){if(I(i)){if(!O(e))throw new TypeError;if(!j(t))throw new TypeError;return function(e,t){for(var i=e.length-1;i>=0;--i){var n=(0,e[i])(t);if(!I(n)&&!S(n)){if(!j(n))throw new TypeError;t=n}}return t}(e,t)}if(!O(e))throw new TypeError;if(!C(t))throw new TypeError;if(!C(n)&&!I(n)&&!S(n))throw new TypeError;return S(n)&&(n=void 0),function(e,t,i,n){for(var r=e.length-1;r>=0;--r){var a=(0,e[r])(t,i,n);if(!I(a)&&!S(a)){if(!C(a))throw new TypeError;n=a}}return n}(e,t,i=T(i),n)})),t("metadata",(function(e,t){return function(i,n){if(!C(i))throw new TypeError;if(!I(n)&&!function(e){switch(_(e)){case 3:case 4:return!0;default:return!1}}(n))throw new TypeError;y(e,t,i,n)}})),t("defineMetadata",(function(e,t,i,n){if(!C(i))throw new TypeError;return I(n)||(n=T(n)),y(e,t,i,n)})),t("hasMetadata",(function(e,t,i){if(!C(t))throw new TypeError;return I(i)||(i=T(i)),function e(t,i,n){if(m(t,i,n))return!0;var r=N(i);return!S(r)&&e(t,r,n)}(e,t,i)})),t("hasOwnMetadata",(function(e,t,i){if(!C(t))throw new TypeError;return I(i)||(i=T(i)),m(e,t,i)})),t("getMetadata",(function(e,t,i){if(!C(t))throw new TypeError;return I(i)||(i=T(i)),function e(t,i,n){if(m(t,i,n))return b(t,i,n);var r=N(i);return S(r)?void 0:e(t,r,n)}(e,t,i)})),t("getOwnMetadata",(function(e,t,i){if(!C(t))throw new TypeError;return I(i)||(i=T(i)),b(e,t,i)})),t("getMetadataKeys",(function(e,t){if(!C(e))throw new TypeError;return I(t)||(t=T(t)),function e(t,i){var n=v(t,i),r=N(t);if(null===r)return n;var a=e(r,i);if(a.length<=0)return n;if(n.length<=0)return a;for(var o=new g,s=[],c=0,l=n;c<l.length;c++){var u=l[c];o.has(u)||(o.add(u),s.push(u))}for(var d=0,h=a;d<h.length;d++){u=h[d];o.has(u)||(o.add(u),s.push(u))}return s}(e,t)})),t("getOwnMetadataKeys",(function(e,t){if(!C(e))throw new TypeError;return I(t)||(t=T(t)),v(e,t)})),t("deleteMetadata",(function(e,t,i){if(!C(t))throw new TypeError;I(i)||(i=T(i));var n=p(t,i,!1);if(I(n))return!1;if(!n.delete(e))return!1;if(n.size>0)return!0;var r=f.get(t);return r.delete(i),r.size>0||(f.delete(t),!0)}))}(a)}()}(i||(i={}))}).call(this,i(226),i(108))},8331:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.AppId="appId",e.EnableSpelling="enableSpelling",e.EnableGrammar="enableGrammar",e.EnableRefinements="enableRefinements",e.Descriptors="descriptors",e.ProofingLanguages="proofingLanguages",e.DefaultProofingLanguageInitialized="defaultProofingLanguageInitialized",e.ProofingLanguageListInitialized="proofingLanguageListInitialized",e.EnableEditor="enableEditor",e.OverriddenCritiqueTypeOptions="overriddenCritiqueTypeOptions",e.ShowSynonyms="showSynonyms",e.TelemetryTenant="telemetryTenant",e.LogGroupName="logGroupName",e.DefaultEventName="defaultEventName",e.DefaultLoggingLevel="defaultLoggingLevel",e.SendToAria="sendToAria",e.DebugMode="debugMode",e.EnableTelemetry="enableTelemetry",e.ConfigurationId="configurationId",e.ClientId="clientId"}(n||(n={}))},8332:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.tileCheckRequestV1="tileCheckRequestV1",e.configRequestV2="configRequestV2",e.hostModelDelta="hostModelDelta",e.hostModelTextTile="hostModelTextTile",e.hostModelMoveTextTile="hostModelMoveTextTile",e.hostModelRehydrateTiles="hostModelRehydrateTiles",e.hostModelCritique="hostModelCritique",e.instrumentationRequestV1="instrumentationRequestV1",e.tileCheckResponseV1="tileCheckResponseV1",e.configResponseV2="configResponseV2",e.clearTileCritiques="clearTileCritiques",e.telemetryEvent="telemetryEvent",e.newActivityTelemetryEvent="newActivityTelemetryEvent",e.activitySetSuccessTelemetryEvent="activitySetSuccessTelemetryEvent",e.activitySetResultTelemetryEvent="activitySetResultTelemetryEvent",e.activityAddDataFieldTelemetryEvent="activityAddDataFieldTelemetryEvent",e.activityEndNowTelemetryEvent="activityEndNowTelemetryEvent",e.saveCritiqueSettings="saveCritiqueSettings",e.critiqueSettingsChange="critiqueSettingsChange"}(n||(n={}))},8333:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.Unknown=-1]="Unknown",e[e.WhiteSpace=0]="WhiteSpace",e[e.Punctuation=1]="Punctuation",e[e.Undetermined=2]="Undetermined",e[e.AlphaNumeric=3]="AlphaNumeric",e[e.Invalid=4]="Invalid",e[e.PuncuationWithoutBreak=5]="PuncuationWithoutBreak",e[e.FootnoteEndnotePunctuation=6]="FootnoteEndnotePunctuation"}(n||(n={}))},8334:function(e,t,i){"use strict";function n(){return 1e3*(new Date).getTime()}i.d(t,"a",(function(){return n}))},8335:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(4739),r=i(2037),a=i(5687);let o=class{constructor(e){this.textRetrieverFactory=e}setHtmlElement(e){this.element!==e&&(this.element=e,this.textRetriever=this.textRetrieverFactory(this.element))}getText(){return this.textRetriever?this.textRetriever.retrieve():""}dispatchInputEvent(){if(this.element){const e=new Event("input",{bubbles:!0});this.element.dispatchEvent(e)}}};o=Object(n.a)([Object(r.injectable)(),Object(n.b)(0,Object(r.inject)(a.a.ITextRetrieverFactory))],o)},8493:function(e,t,i){"use strict";var n=i(10029),r=i(3859);const a={IStorage:Object(n.a)("IStorage"),IBrowserStorageApi:Object(n.a)("IBrowserStorageApi"),IExtensionStorage:Object(n.a)("IExtensionStorage"),IStoreEntryReader:Object(n.a)("IStoreEntryReader"),IStoreEntryWriter:Object(n.a)("IStoreEntryWriter"),IProofingPersistedStore:r.a.IProofingPersistedStore,ILogger:r.a.ILogger,IUserInfoStrategy:r.a.IUserInfoStrategy,ISessionContextProvider:r.a.ISessionContextProvider,ISettingsEmitterBase:Object(n.a)("ISettingsEmitterBase<ISettingsEmissionsBase>"),EditorService:r.a.EditorService,SynonymService:r.a.SynonymService,IGuidGenerator:r.a.IGuidGenerator};i(10030);var o=i(7592);function s(e,t,i,n){var r,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,i,o):r(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o}function c(e,t){return function(i,n){t(i,n,e)}}var l,u,d=i(6270),h=i(4140),g=i(2037);!function(e){e.RemoteSettingSync="RemoteSettingSync"}(l||(l={})),function(e){e.SettingsSyncWriteError="RunTimeErrors.SettingSyncWriteError",e.SettingsSyncEditorRequestBuildError="RunTimeErrors.SettingsSyncEditorRequestBuildError",e.SettingsSyncEditorServiceError="RunTimeErrors.SettingSyncEditorServiceError",e.SettingsSyncReadOverrideError="RunTimeErrors.SettingSyncReadOverrideError",e.SettingReadError="RunTimeErrors.SettingReadError",e.SettingInitializeError="RunTimeErrors.SettingInitializeError",e.SettingManualOverrideWarning="RunTimeErrors.SettingManualOverrideWarning",e.SettingWriteError="RunTimeErrors.SettingWriteError",e.FeatureFlagParsingError="RunTimeErrors.FeatureFlagParsingError"}(u||(u={}));const f=e=>"string"==typeof e?"true"===e.toLowerCase():!0===e;let p=class{constructor(e,t,i){this._emitter=e,this._storeEntryReader=t,this._logger=i,this._defaultFeatureFlags={disableRemoteLanguageInfo:!1,enableConflictDetectionAnnouncement:!1,enableSquiggleTooltipFeature:!0,enableCaretPositionRestore:!1,enableUpsellFeature:!1,enableLicenseRefresh:!0,enableLicenseRefreshForUndef:!0,enableLicenseResponseRetry:!0,enableIFrame:!1,enableMultiLanguageSupport:!1,enableMultiLanguageAnnouncement:!1,enableIgnoreAll:!1,enableIgnoreOnce:!1,enableNotifications:!1,enableOptimizedCallingPattern:!1,enablePostUpsellAnnouncement:!1,enableInternalMailFeedback:!1,enableOrchestration:!1,enableRoamingDictionary:!1,enableSignInAnnouncement:!1,enableSignInAnnouncementAlternativeText:!1,enableRateExtensionPrompt:!1,enableRateExtensionPromptEdge:!1,enableAsyncSynonym:!1,enableEnhancedUpsell:!1,enablePremiumPreview:!1,enableUnsignedInEditor:!1,enableSuppressUnsignedInEditorForMultiLang:!1,enableCritiqueSettings:!1,enableSimplifiedHost:!1,enableOcvIntEndpoint:!1,enableOcvFeedbackUi:!1,enableConfigV2Calls:!1,enableSpellcheckOverride:!1,enableNewLineSentenceSeparator:!1,enableE2eMetric:!1,enableAriaStatusElement:!1,disableSquiggleAriaFeatures:!1,disableSquigglesCacheInUpdateRanges:!1,enableVisibilityTracker:!1,enableSquigglesUpdateThrottling:!1,isMsitUser:!1,enableWordCountDetector:!1,enableDispatchCritiquesOnEmptyDiffs:!0,enableSignInAnnouncementReshownWeekly:!1,enableSignInAnnouncementReshownBiweekly:!1,enableSignInAnnouncementReshownMonthly:!1,enableRenderingCalloutToPortal:!1,enableStopCheckingForThis:!1,enableSpellingUpsell:!1,inferenceCritiqueCloudIconEnabled:!1,enableAutoCorrect:!1},this._featureFlags=Object(o.b)(o.a.FeatureFlags,this._defaultFeatureFlags),this._localFlags=this._defaultFeatureFlags}get flags(){return this._localFlags}async refreshFlags(){return await this.updateFlags(),this.flags}async initialize(){this._emitter.on(o.a.FeatureFlags,()=>{this.updateFlags()}),await this.updateFlags()}async shutDown(){this._emitter.off(o.a.FeatureFlags)}async updateFlags(){try{const e=await this._storeEntryReader.readOrInitialize(this._featureFlags);this._localFlags=Object.assign(this._localFlags,...Object.entries(e).map(([e,t])=>({[e]:f(t)})))}catch(e){this._logger.logEvent(571318787,u.FeatureFlagParsingError,d.a.Error,void 0,h.i.Diagnostics)}}};p=s([Object(g.injectable)(),c(0,Object(g.inject)(a.ISettingsEmitterBase)),c(1,Object(g.inject)(a.IStoreEntryReader)),c(2,Object(g.inject)(a.ILogger))],p);let m=class{constructor(e){this._extensionStorage=e}getLastError(){return this._lastError}setLastError(e){this._lastError=e}async writeSetting(e,t){const i={value:JSON.stringify(t),lastUpdated:Date.now(),manualOverride:!1};await this._extensionStorage.setItem(e,JSON.stringify(i))}};m=s([Object(g.injectable)(),c(0,Object(g.inject)(a.IExtensionStorage))],m);let b=class extends m{constructor(e,t){super(e),this._logger=t}async readOrInitialize(e){try{const t=await this.readStoredSetting(e);if(t){if(t.value){const i=JSON.parse(t.value);return t.manualOverride&&void 0!==i?i:(e.lastValueFromStorage=i,void 0!==i?i:e.defaultValue)}}else try{return await this.writeSetting(e.name,e.defaultValue),e.defaultValue}catch(e){this._logger.logEvent(589857759,u.SettingInitializeError,d.a.Error,void 0,h.i.CriticalBusinessImpact),this.setLastError(e)}}catch(e){this._logger.logEvent(589857760,u.SettingReadError,d.a.Error,void 0,h.i.CriticalBusinessImpact),this.setLastError(e)}return void 0!==e.lastValueFromStorage?e.lastValueFromStorage:e.defaultValue}async readLastUpdatedTimestamp(e){try{const t=await this.readStoredSetting(e);if(t)return t.lastUpdated}catch(e){this._logger.logEvent(589080397,u.SettingReadError,d.a.Error,void 0,h.i.CriticalBusinessImpact),this.setLastError(e)}}async readStoredSetting(e){const t=await this._extensionStorage.getItems(e.name);if(t[e.name]){return JSON.parse(t[e.name])}}};b=s([Object(g.injectable)(),c(0,Object(g.inject)(a.IExtensionStorage)),c(1,Object(g.inject)(a.ILogger))],b);let y=class extends m{constructor(e,t){super(e),this._logger=t}async write(e,t){try{let i=!1;const n=await this._extensionStorage.getItems(e.name);if(n[e.name]){i=JSON.parse(n[e.name]).manualOverride}i?this._logger.logEvent(589857757,u.SettingManualOverrideWarning,d.a.Warn,`manual override for store entry ${e.name} - writing skipped`,h.i.Measure):await this.writeSetting(e.name,t)}catch(e){this._logger.logEvent(589857758,u.SettingWriteError,d.a.Error,void 0,h.i.CriticalBusinessImpact),this.setLastError(e)}}};y=s([Object(g.injectable)(),c(0,Object(g.inject)(a.IExtensionStorage)),c(1,Object(g.inject)(a.ILogger))],y);var v=i(11824);let _=class{constructor(e){this._browserStorage=e,this.registrations={},this._storageChangeDispatcherCallback=async(e,t)=>this._storageChangeDispatcher(e,t)}safelyGetRegistration(e){return this.registrations[e]||(this.registrations[e]=Object(v.a)()),this.registrations[e]}on(e,t){this.safelyGetRegistration(e).listeners.push(t)}async initialize(){this._browserStorage.addChangeListener(this._storageChangeDispatcherCallback)}async shutDown(){this._browserStorage.removeEventListener(this._storageChangeDispatcherCallback)}_storageChangeDispatcher(e,t){Object.keys(e).forEach(e=>{this.callListeners(e)})}callListeners(e){const t=e,i=this.safelyGetRegistration(t);for(const e of i.listeners)e()}onFirst(e,t){throw Error("onFirst is not implemented for SettingsEmitter")}onAny(e){throw Error("onAny is not implemented for SettingsEmitter")}async waitFor(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}async waitForFirst(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}off(e,t){if(void 0===e)return void(this.registrations={});if(void 0===t)return void(this.registrations[e]=Object(v.a)());const i=this.safelyGetRegistration(e);if(!Object(v.b)(i.listeners,t))throw new Error(`Tried to remove a non-existent listener for event name '${e}'.`)}emit(e,...t){const i=this.safelyGetRegistration(e);for(const e of i.listeners)e(...t)}};_=s([Object(g.injectable)(),c(0,Object(g.inject)(a.IBrowserStorageApi))],_);let I=class{constructor(e,t){this._storeEntryReader=e,this._storeEntryWriter=t,this._storeEntryMap=this.populateStoreEntryMap()}_fetchStoreEntry(e){const t=this._storeEntryMap.get(e);if(!t)throw Error("Cannot find the entry key.");return t}async read(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readOrInitialize(t)}async write(e,t){await this._storeEntryWriter.write(this._fetchStoreEntry(e).storeEntry,t)}async getLastUpdatedTimestamp(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readLastUpdatedTimestamp(t)}getCachedEntry(e){const t=this._fetchStoreEntry(e),i=t.storeEntry;return{storeEntryValue:void 0===i.lastValueFromStorage?i.defaultValue:i.lastValueFromStorage,isSynced:!!t.isSynced}}getDefaultValue(e){return this._fetchStoreEntry(e).storeEntry.defaultValue}};I=s([Object(g.injectable)(),c(0,Object(g.inject)(a.IStoreEntryReader)),c(1,Object(g.inject)(a.IStoreEntryWriter))],I);var S=i(8331),C=i(4767);function E(e){const t={value:JSON.stringify(e),lastUpdated:Date.now(),manualOverride:!1};return JSON.stringify(t)}let T=class extends m{constructor(e,t,i,n,r,a,o){super(e),this._editorService=t,this._proofingStore=i,this._logger=n,this._userInfoStrategy=r,this._sessionContextProvider=a,this._guidGenerator=o}schedule(e,t){this._timer&&window.clearTimeout(this._timer),this._timer=window.setTimeout(async()=>{await this.sync(),this.schedule(t,t)},e)}async sync(){this._logger.debug(589857750,"Starting remote settings sync");const e=await this.buildRequest();if(e){const t=await this.fetchRemoteSettings(e);if(t&&t.responseStatus===C.c.ResponseStatus.Success){this.logTelemetry(e);const i=function(e){return{descriptors:E(e.descriptors),disabledWebSites:E(e.disabledWebSites),allowedUrls:E(e.allowedUrls),disabledGrammars:E(e.disabledGrammars),editorClientState:E(e.editorClientState),configurationId:E(e.configurationId),featureFlags:E(e.featureFlags),intervalForActivityCleanup:E(e.intervalForActivityCleanup),logGroupName:E(e.logGroupName),sendToAria:E(e.sendToAria),conflictingElements:E(e.conflictingElements),telemetryTenant:E(e.telemetryTenant)}}(t),n=await this.removeManualOverrides(i);if(n)return this._logger.debug(589857751,"Writing remote settings to local storage"),this.writeSettings(n)}}return this._logger.debug(589857752,"No remote settings were synced"),!1}async writeSettings(e){try{return await this._extensionStorage.setItems(e),!0}catch(e){this._logger.logEvent(589857753,u.SettingsSyncWriteError,d.a.Error,void 0,h.i.CriticalBusinessImpact),this.setLastError(e)}return!1}async fetchClientId(){try{const e=await this._proofingStore.read(S.a.ClientId);if(!e||""===e){const e=this._guidGenerator.generate();return await this._proofingStore.write(S.a.ClientId,e),e}return e}catch(e){return""}}async buildRequest(){try{const e=await this._sessionContextProvider();let t,i;const n=await this.fetchClientId();return this._userInfoStrategy.execute(!1,e=>(e&&e.userId?(this._editorService.xUserId=e.userId,t=e.tenantId,i=e.email):this._editorService.xUserId=n,e)),{appId:await this._proofingStore.read(S.a.AppId),browser:e.browserType,browserVersion:e.browserVersion||"",email:i,extensionId:e.extensionVersion,languageUxId:e.languageUxId,storeId:e.extensionStoreId,tenantId:t,firstInstallVersion:void 0}}catch(e){this._logger.logEvent(0,u.SettingsSyncEditorRequestBuildError,d.a.Error,void 0,h.i.CriticalBusinessImpact),this.setLastError(e)}}logTelemetry(e){if(!this._lastConfigRequestUserId||this._lastConfigRequestUserId!==this._editorService.xUserId||!this._lastConfigRequest||this._lastConfigRequest.browserVersion!==e.browserVersion||this._lastConfigRequest.email!==e.email||this._lastConfigRequest.languageUxId!==e.languageUxId||this._lastConfigRequest.tenantId!==e.tenantId){this._lastConfigRequest=e,this._lastConfigRequestUserId=this._editorService.xUserId;const t=this._logger.getNewActivity(l.RemoteSettingSync,h.i.CriticalExperimentation);t&&(t.setSuccess(!0),t.endNow())}}async fetchRemoteSettings(e){try{return await this._editorService.browserextension(e)}catch(e){this._logger.logEvent(589857754,u.SettingsSyncEditorServiceError,d.a.Error,void 0,h.i.CriticalBusinessImpact),this.setLastError(e)}}async removeManualOverrides(e){const t={};try{const i=await this._extensionStorage.getItems(e);for(const n of Object.keys(i)){const r=JSON.parse(i[n]);r&&r.manualOverride?this._logger.debug(589857755,"Manual override for remote setting",n):t[n]=e[n]}}catch(e){return this._logger.logEvent(589857756,u.SettingsSyncReadOverrideError,d.a.Error,void 0,h.i.CriticalBusinessImpact),void this.setLastError(e)}return t}};T=s([Object(g.injectable)(),c(0,Object(g.inject)(a.IExtensionStorage)),c(1,Object(g.inject)(a.EditorService)),c(2,Object(g.inject)(a.IProofingPersistedStore)),c(3,Object(g.inject)(a.ILogger)),c(4,Object(g.inject)(a.IUserInfoStrategy)),c(5,Object(g.inject)(a.ISessionContextProvider)),c(6,Object(g.inject)(a.IGuidGenerator))],T);let O=class{constructor(e){this._local=e}async getItems(e){return new Promise((t,i)=>{this._local.get(e,e=>{const n=this._local.getLastError();n?i(n):t(e)})})}async setItems(e){return new Promise((t,i)=>{this._local.set(e,()=>{const e=this._local.getLastError();e?i(e):t()})})}async setItem(e,t){const i={};return i[e]=t,this.setItems(i)}async removeItems(e){return new Promise((t,i)=>{this._local.remove(e,()=>{const e=this._local.getLastError();e?i(e):t()})})}};var w;O=s([Object(g.injectable)(),c(0,Object(g.inject)(a.IBrowserStorageApi))],O),function(e){e.ChromeBrowserStorageApi="ChromeBrowserStorageApi",e.LocalStorageApi="LocalStorageApi"}(w||(w={}));let j=class{set(e,t){chrome.storage.local.set(e,t)}remove(e,t){chrome.storage.local.remove(e,t)}get(e,t){chrome.storage.local.get(e,t)}getLastError(){if(chrome.runtime.lastError)return chrome.runtime.lastError.message}addChangeListener(e){browser.storage.onChanged.addListener(e)}removeEventListener(e){browser.storage.onChanged.removeListener(e)}};var P;j=s([Object(g.injectable)()],j);let x=P=class{constructor(){this._listeners=[]}set(e,t){const i=Object.keys(e),n={};i.forEach(t=>{const i=e[t];n[t]={oldValue:localStorage.getItem(t),newValue:i};try{localStorage.setItem(t,i)}catch(e){this._lastError=e}});const r=new CustomEvent("storageItemInserted",{detail:n});document.dispatchEvent(r),t&&t()}remove(e,t){if("string"==typeof e)localStorage.removeItem(e);else if(Array.isArray(e))for(const t of e)localStorage.removeItem(t);t&&t()}get(e,t){const i={};if("string"==typeof e)i[e]=P._getItem(e);else if(Array.isArray(e))for(const t of e)i[t]=P._getItem(t);else if(e instanceof Object){Object.keys(e).forEach(t=>{const n=P._getItem(t);i[t]=n||e[t]})}t(i)}getLastError(){return this._lastError}addChangeListener(e){const t=t=>{t.detail&&e(t.detail,"")};document.addEventListener("storageItemInserted",t),this._listeners.push(t)}removeEventListener(e){this._listeners.forEach(e=>{document.removeEventListener("storageItemInserted",e)}),this._listeners.splice(0,this._listeners.length-1)}static _getItem(e){const t=localStorage.getItem(e);if(t)try{const e=JSON.parse(t);return void 0!==e.value&&e.lastUpdated&&void 0!==e.manualOverride?t:e}catch(e){return t}return null}};x=P=s([Object(g.injectable)()],x);let D=class{getItem(e){const t=localStorage.getItem(e);if(t)return t}setItem(e,t){localStorage.setItem(e,t)}clearItem(e){localStorage.removeItem(e)}};D=s([Object(g.injectable)()],D),i.d(t,"g",(function(){return a})),i.d(t,"c",(function(){return p})),i.d(t,"h",(function(){return b})),i.d(t,"i",(function(){return y})),i.d(t,"f",(function(){return _})),i.d(t,"a",(function(){return I})),i.d(t,"e",(function(){return T})),i.d(t,"b",(function(){return O})),i.d(t,"d",(function(){return x}))},873:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33",e.InboxPlusEasyOn="34",e.InboxRulesFromDL="35",e.GdprAdsV2="36",e.TimePanelCombinedDndFRE="47",e.UaeEduPrivacyNotification="48",e.OutlookSpacesFRE="49",e.TodoFlaggedEmailList="50",e.DynamicLayoutFolderPaneCollapse="51",e.EdgeUpsell="56",e.OutlookSpacesCapturedPaneFRE="57",e.ProofingTeachingFreeUserFRE="58",e.ProofingTeachingPremiumUserFRE="59",e.OutlookSpacesNotePaneFRE="60",e.OutlookSpacesTasksPaneFRE="61",e.OutlookSpacesGoalsPaneFRE="62",e.DefaultOnlineMeetingSetting="63",e.QuickUseFRE="64",e.GdprAdsV3="65",e.SpeedyMeetingsEndEarlySetting="66",e.InboxPlusEasyOff="67",e.ShortenEventsDurationSetting="70",e.HoneybeeClipboard="71",e.AttachmentSaveToCloudOpenAndEdit="72",e.GdprAdsEPrivacy="73",e.AdminInstalledNewAddinsFRE="75",e.InsertLinkFREOpenCompose="76",e.InsertLinkFREAfterAttach="77",e.SpotlightFre="78",e.OverlayFolderPaneFre="79",e.SpotlightPropertyIcon="80",e.GdprAdsV3ClearNull="81",e.OptionsPaneLaunch="82",e.ThemeOfTheDay="83",e.SpeedyMeetingsTenant="84",e.MailtoProtocolHandler="85",e.UnpinnedAdminAddinsFRE="86"}(n||(n={}))},9540:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return s}));var n=i(31),r=new n.c((function(){return Promise.all([i.e(9),i.e(296),i.e(971)]).then(i.bind(null,12223))})),a=new n.a(r,(function(e){return e.preloadRoamingDictionary})),o=new n.a(r,(function(e){return e.saveRoamingDictionary})),s=new n.b(r,(function(e){return e.getRoamingDictionary}))}}]);
//# sourceMappingURL=owa.MailBoot~ProofingPlugin.js.map
self.scriptsLoaded['owa.MailBoot~ProofingPlugin.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ProofingPlugin.js'] = (new Date()).getTime();