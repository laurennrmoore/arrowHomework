self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ProofingPlugin~otel~otellogger.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[200],{11744:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"u",(function(){return c})),t.d(n,"c",(function(){return b})),t.d(n,"p",(function(){return p})),t.d(n,"l",(function(){return g})),t.d(n,"m",(function(){return O})),t.d(n,"i",(function(){return S})),t.d(n,"t",(function(){return j})),t.d(n,"o",(function(){return T})),t.d(n,"n",(function(){return w})),t.d(n,"g",(function(){return C})),t.d(n,"j",(function(){return R})),t.d(n,"k",(function(){return k})),t.d(n,"q",(function(){return x})),t.d(n,"f",(function(){return B})),t.d(n,"v",(function(){return M})),t.d(n,"e",(function(){return P})),t.d(n,"r",(function(){return E})),t.d(n,"d",(function(){return _})),t.d(n,"h",(function(){return A})),t.d(n,"b",(function(){return H})),t.d(n,"s",(function(){return K}));var i=t(8296),r=t(4044),a=t(3620),o="1DS-Web-JS-2.4.6",c="undefined",u=i.b,s=null;var l=r.a.isUndefined,f=r.a.isNullOrUndefined;function d(e){return!l(e)}r.a.hasOwnProperty;var v,h=null,b=r.a.arrForEach,p=(r.a.arrIndexOf,r.a.arrMap,r.a.arrReduce,r.a.objKeys),g=(r.a.toISOString,a.n),O=r.a.isString,y=r.a.isNumber,m=r.a.isBoolean,S=(r.a.isFunction,r.a.isArray),j=(r.a.isObject,r.a.strTrim),T=(Boolean(Object(a.c)()),Boolean(Object(a.k)()));function w(e){return!(f(e)||""===e)}function C(e){if(e){var n=e.indexOf("-");if(n>-1)return e.substring(0,n)}return""}function R(){return null===h&&(h=Object(a.m)()&&Boolean(Object(a.i)().sendBeacon)),h}function k(e){return!!(e&&y(e)&&e>=1&&e<=3)}function x(e,n,t){if(!O(e)||f(n)||""===n)return null;if(O(n)||y(n)||m(n)||S(n))n={value:n};else if("object"!=typeof n||n.hasOwnProperty("value")){if(f(n.value)||""===n.value||!O(n.value)&&!y(n.value)&&!m(n.value)&&!S(n.value))return null}else n={value:t?JSON.stringify(n):n};if(S(n.value)&&!(n.value.length>0))return null;if(d(n.kind)){if(S(n.value)||!function(e){if(y(e)&&(e>=0&&e<=13||32===e))return!0;return!1}(n.kind))return null;n.value=n.value.toString()}return n}function B(e){return e.getUTCFullYear()+"-"+N(e.getUTCMonth()+1)+"-"+N(e.getUTCDate())+"T"+N(e.getUTCHours())+":"+N(e.getUTCMinutes())+":"+N(e.getUTCSeconds())+"."+function(e){if(e<10)return"00"+e;if(e<100)return"0"+e;return e.toString()}(e.getUTCMilliseconds())+"Z"}function M(){if(void 0!==typeof XMLHttpRequest){var e=Object(a.e)("XMLHttpRequest");if(e){var n=new e;return Boolean(l(n.withCredentials)&&void 0!==typeof XDomainRequest)}}}function P(e,n,t){var i=-1;return l(e)?i:(n&&n>0&&(32===n?i=1<<13:n<=13&&(i=n<<5)),d(t)&&function(e){if(y(e)&&e>=0&&e<=9)return!0;return!1}(t)?(-1===i&&(i=0),i|t):(S(e)&&(e=e[0]),-1!==i?i|function(e){if(l(e))return-1;if(y(e))return u.Double;if(O(e))return u.String;if(m(e))return u.Bool;return-1}(e):y(e)?u.Double:i))}function I(){if(void 0===v){v=!1;try{var e=Object(a.c)(),n=Object(a.i)();e&&!l(e.cookie)&&n&&n.cookieEnabled&&(v=!0)}catch(e){}}return v}function E(e,n,t){if(I()){var i="",r=Object(a.g)();r&&"https:"===r.protocol&&(i=";secure",null===s&&(s=function(e){return!!O(e)&&(-1!==e.indexOf("CPU iPhone OS 12")||-1!==e.indexOf("iPad; CPU OS 12")||(-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&-1!==e.indexOf("Version/")&&-1!==e.indexOf("Safari")||(-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&(t="AppleWebKit/605.1.15 (KHTML, like Gecko)",i=(n=e).length,r=i-t.length,n.substring(r>=0?r:0,i)===t)||(-1!==e.indexOf("Chrome/5")||-1!==e.indexOf("Chrome/6")||(-1!==e.indexOf("UnrealEngine")&&-1===e.indexOf("Chrome")||(-1!==e.indexOf("UCBrowser/12")||-1!==e.indexOf("UCBrowser/11")))))));var n,t,i,r}((Object(a.i)()||{}).userAgent)),s||(n+=";SameSite=None"));var o=new Date;o.setTime(o.getTime()+24*t*60*60*1e3);var c="; expires="+o.toUTCString();Object(a.c)().cookie=e+"="+n+c+"; path=/"+i}}function _(e){void 0===e&&(e="D");var n=r.a.newGuid();return"B"===e?n="{"+n+"}":"P"==e?n="("+n+")":"N"==e&&(n=n.replace(/-/g,"")),n}var A=r.a.perfNow;function N(e){return e<10?"0"+e:e.toString()}function H(e){var n=L("beforeunload",e);return n=L("unload",e)||n,n=L("pagehide",e)||n}function K(e,n){var t=e;t.timings=t.timings||{},t.timings.processTelemetryStart=t.timings.processTelemetryStart||{},t.timings.processTelemetryStart[n]=A()}var L=r.a.addEventHandler},11755:function(e,n,t){"use strict";(function(e){var i=t(11744),r=t(6405),a=t(8296),o=t(10560),c=t(4044),u=t(8654),s=t(10555),l=t(7535),f=t(11756),d=t(17877),v=t(11757),h=t(3297),b=.25,p=500,g=20,O=6,y=4,m=i.o?window:void 0,S=2,j=1,T="eventsDiscarded",w="overrideInstrumentationKey",C=function(n){function t(){var e,s=n.call(this)||this;s.identifier="PostChannel",s.priority=1011,s.version="2.4.6";var C,R,k,x,B,M=!1,P=[],I=null,E=!1,_=0,A=1e4,N={},H=l.c,K=null,L=0,q=0,D={},U=-1;return Object(h.a)(t,s,(function(n,t){function s(e,n){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=a.a.Normal),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,e.sync)if(L||E)e.latency=a.a.RealTime,e.sync=!1;else if(R)return void R.sendSynchronousBatch(f.a.create(e.iKey,[e]),3);var t=!1;_<A?t=!J(e,n):(t=!0,function(e,n){var t=a.a.Normal;for(;t<=n;){var i=W(e,n,!0);if(i&&i.count()>0){var r=i.split(0,g);if(r.count()>0)return ne(T,[r],o.a.QueueFull),!0}t++}return!1}(e.iKey,e.latency)&&(t=!J(e,n))),t&&ee(T,[e],o.a.QueueFull)}function h(e,n,t,i){var r=Z(e,n,t);return R.sendQueuedRequests(n,t,i),r}function F(){return _>0}function z(){U>=0&&Z(U,B,!0)&&R.sendQueuedRequests(B,!0,!1);var e=N[H][1];!K&&!I&&e>=0&&!E&&(F()?K=V((function(){K=null,h(0===q?a.a.RealTime:a.a.Normal,1,!0),q++,q%=2,z()}),e):q=0)}function V(e,t){0===t&&L&&(t=1);var i=1e3;return L&&(i=v.a.getMillisToBackoffForRetry(L-1)),n._setTimeoutOverride(e,t*i)}function X(){null!==K&&(n._clearTimeoutOverride(K),K=null,q=0)}function Q(e,t){X(),I&&(n._clearTimeoutOverride(I),I=null),E||h(a.a.Normal,e,t,!0)}function W(e,n,t){var i=D[n];i||(n=a.a.Normal,i=D[n]);var r=i.iKeyMap[e];return!r&&t&&(r=f.a.create(e),i.batches.push(r),i.iKeyMap[e]=r),r}function G(e,t){R.canSendRequest()&&!L&&(k>0&&_>k&&(t=!0),t&&null==I&&n.flush(e,null,20))}function J(e,n){var t=W(e.iKey,e.latency,!0);return!!t.addEvents([e],n)&&(_++,n&&0===e.sendAttempt&&G(!e.sync,x>0&&t.count()>=x),!0)}function Z(e,t,c){var u=!1;return!c||R.canSendRequest()?Object(r.b)(n.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var n=[],t=a.a.RealTime;t>=e;){var r=D[t];r&&r.batches&&(Object(i.c)(r.batches,(function(e){R.addBatch(e)?u=u||e&&e.count()>0:n=n.concat(e.events()),_-=e.count()})),r.batches=[],r.iKeyMap={}),t--}n.length>0&&ee(T,n,o.a.KillSwitch),u&&U>=e&&(U=-1,B=0)}),(function(){return{latency:e,sendReason:t}}),c):(U=U>=0?Math.min(U,e):e,B=Math.max(B,t)),u}function $(){(N={})[l.c]=[2,1],N[l.b]=[6,3],N[l.a]=[18,9]}function Y(e,t){var i=n._notificationManager||{},r=i[e];if(r)try{r.apply(i,t)}catch(t){n.diagLog().throwInternal(u.a.CRITICAL,a.c.NotificationException,e+" notification failed: "+t)}}function ee(e,n){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];n&&n.length>0&&Y(e,[n].concat(t))}function ne(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&Object(i.c)(n,(function(n){n&&n.count()>0&&Y(e,[n.events()].concat(t))}))}function te(){x=e&&e.disableAutoBatchFlushLimit?0:Math.max(p*(S+1),A/6)}$(),D[a.a.RealTime]={batches:[],iKeyMap:{}},D[a.a.CostDeferred]={batches:[],iKeyMap:{}},D[a.a.Normal]={batches:[],iKeyMap:{}},te(),R=new d.a(p,S,j,{requeue:function(e,t){var r=[];Object(i.c)(e,(function(e){e&&e.count()>0&&Object(i.c)(e.events(),(function(e){e&&(e.sync&&(e.latency=a.a.RealTime,e.sync=!1),e.sendAttempt<O?(Object(i.s)(e,n.identifier),s(e,!1)):r.push(e))}))})),r.length>0&&ee(T,r,o.a.NonRetryableStatus)},send:function(e,n,t){e&&e.length>0&&Y("eventsSendRequest",[n>=1e3&&n<=1999?n-1e3:0,!0!==t])},sent:function(e,n){ne("eventsSent",e,n),z()},drop:function(e,n){ne(T,e,n>=8e3&&n<=8999?n-8e3:o.a.Unknown)},rspFail:function(e){ne(T,e,o.a.NonRetryableStatus),z()},oth:function(e,n){ne(T,e,o.a.Unknown),z()}}),n._getDbgPlgTargets=function(){return[R]},n.initialize=function(a,o,c){Object(r.b)(o,(function(){return"PostChannel:initialize"}),(function(){var r=o;t.initialize(a,o,c),n.setInitialized(!1);var u=n._getTelCtx();a.extensionConfig[n.identifier]=a.extensionConfig[n.identifier]||{},e=u.getExtCfg(n.identifier),n._setTimeoutOverride=e.setTimeoutOverride?e.setTimeoutOverride:setTimeout.bind(m),n._clearTimeoutOverride=e.clearTimeoutOverride?e.clearTimeoutOverride:clearTimeout.bind(m);var s=r.getWParam;r.getWParam=function(){var n=0;return e.ignoreMc1Ms0CookieProcessing&&(n|=2),n|s()},e.eventsLimitInMem>0&&(A=e.eventsLimitInMem),e.autoFlushEventsLimit>0&&(k=e.autoFlushEventsLimit),te(),e.httpXHROverride&&e.httpXHROverride.sendPOST&&(C=e.httpXHROverride),Object(i.n)(a.anonCookieName)&&R.addQueryStringParameter("anoncknm",a.anonCookieName),R.sendHook=e.payloadPreprocessor,R.sendListener=e.payloadListener;var l=e.overrideEndpointUrl?e.overrideEndpointUrl:a.endpointUrl;n._notificationManager=a.extensionConfig.NotificationManager,R.initialize(l,n.core,n,C),Object(i.b)((function(){Q(2,!1)})),n.setInitialized(!0)}),(function(){return{coreConfig:a,core:o,extensions:c}}))},n.processTelemetry=function(t,r){Object(i.s)(t,n.identifier);var a=(r=n._getTelCtx(r)).getExtCfg(n.identifier),o=!!e.disableTelemetry;a&&(o=o||!!a.disableTelemetry);var c=t;o||M||(e[w]&&(c.iKey=e[w]),a&&a[w]&&(c.iKey=a[w]),s(c,!0),z()),n.processNext(c,r)},n.setEventQueueLimits=function(e,n){A=e>0?e:1e4,k=n>0?n:0,te();var t=_>e;if(!t&&x>0)for(var r=a.a.Normal;!t&&r<=a.a.RealTime;r++){var o=D[r];o&&o.batches&&Object(i.c)(o.batches,(function(e){e&&e.count()>=x&&(t=!0)}))}G(!0,t)},n.teardown=function(){Q(2,!1),M=!0,R.teardown()},n.pause=function(){X(),E=!0,R.pause()},n.resume=function(){E=!1,R.resume(),z()},n.addResponseHandler=function(e){R._responseHandlers.push(e)},n._loadTransmitProfiles=function(e){X(),$(),H=l.c,z(),Object(c.b)(e,(function(e,n){if(n.length>=2){if(n.splice(0,n.length-2),n[1]<0&&(n[0]=-1),n[1]>0&&n[0]>0){var t=n[0]/n[1];n[0]=Math.ceil(t)*n[1]}N[e]=n}}))},n.flush=function(e,n,t){void 0===e&&(e=!0),E||(X(),t=t||1,e?(Z(a.a.Normal,t,e),null==I?I=V((function(){!function e(n,t){h(a.a.Normal,t,!0),function e(n){R.isCompletelyIdle()?n():I=V((function(){e(n)}),b)}((function(){n&&n(),P.length>0?I=V((function(){return e(P.shift(),t)}),0):(I=null,F()&&z())}))}(n,t)}),0):P.push(n)):(h(a.a.Normal,t,!1),null!=n&&n()))},n.setMsaAuthTicket=function(e){R.addHeader("AuthMsaDeviceTicket",e)},n.hasEvents=F,n._setTransmitProfile=function(e){H!==e&&void 0!==N[e]&&(X(),H=e,z())},n._backOffTransmission=function(){L<y&&(L++,X(),z())},n._clearBackOff=function(){L&&(L=0,X(),z())}})),s}return e(t,n),t}(s.a);n.a=C}).call(this,t(3126).__extendsFn)},11756:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(3297),r=t(4044),a=function(){function e(n,t){var a=t?[].concat(t):[],o=r.a.isNullOrUndefined;Object(i.a)(e,this,(function(t){t.iKey=function(){return n},t.count=function(){return a.length},t.events=function(){return a},t.addEvents=function(e,n){return void 0===n&&(n=!0),e&&e.length>0?(a=n?a.concat(e):e.concat(a),e.length):0},t.split=function(t,i){var r=new e(n);if(t<a.length){var c=a.length-t;o(i)||(c=i<c?i:c),r.addEvents(a.splice(t,c))}return r}}))}return e.create=function(n,t){return new e(n,t)},e}()},11757:function(e,n,t){"use strict";
/*!
 * 1DS JS SDK POST plugin, 2.4.6
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */var i=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e&&429!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var n,t=Math.floor(1200*Math.random())+2400;return n=Math.pow(2,e)*t,Math.min(n,6e5)},e}();n.a=i},17877:function(e,n,t){"use strict";var i=t(11744),r=t(3620),a=t(8654),o=t(8296),c=t(4044),u=t(6405),s=t(11756),l=t(3297),f=3984588,d=65e3,v=2e6,h=Math.min(v,d),b=function e(n){Object(l.a)(e,this,(function(e){e.createPayload=function(e,n,t,i){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],batches:[],numEvents:0,retryCnt:e,isTeardown:n,isSync:t,isBeacon:i}},e.appendPayload=function(t,i,r){var a=t&&i&&!t.overflow;return a&&Object(u.b)(n,(function(){return"Serializer:appendPayload"}),(function(){for(var n=i.events(),a=t.payloadBlob,o=t.numEvents,u=!1,l=[],b=t.isBeacon,p=b?d:f,g=b?h:v,O=0;O<n.length;){var y=n[O];if(y){if(o>=r){t.overflow=i.split(O);break}var m=e.getEventBlob(y);if(m.length<=g){var S=m.length;if(a.length+S>p){t.overflow=i.split(O);break}a&&(a+="\n"),a+=m,u=!0,o++}else l.concat(n.slice(O,1))}O++}if(l&&l.length>0&&t.sizeExceed.push(s.a.create(i.iKey(),l)),u){t.batches.push(i),t.payloadBlob=a,t.numEvents=o;var j=i.iKey();-1===c.a.arrIndexOf(t.apiKeys,j)&&t.apiKeys.push(j)}}),(function(){return{payload:t,theBatch:{iKey:i.iKey(),evts:i.events()},max:r}})),a},e.getEventBlob=function(e){return Object(u.b)(n,(function(){return"Serializer.getEventBlob"}),(function(){var n={};return n.name=e.name,n.time=e.time,n.ver=e.ver,n.iKey="o:"+Object(i.g)(e.iKey),e.ext&&(n.ext={},Object(i.c)(Object(i.p)(e.ext),(function(t){n.ext[t]={},Object(i.c)(Object(i.p)(e.ext[t]),(function(r){Object(i.n)(e.ext[t][r])&&(n.ext[t][r]=Object(i.q)(r,e.ext[t][r]).value)}))}))),n.data={},n.data.baseData={},n.data.baseType=e.baseType,e.baseData&&Object(i.c)(Object(i.p)(e.baseData),(function(t){var r=Object(i.q)(t,e.baseData[t]);p(n.data.baseData,t,r),g(n.ext,"baseData."+t,r)})),e.data&&Object(i.c)(Object(i.p)(e.data),(function(t){var r=Object(i.q)(t,e.data[t]);p(n.data,t,r),g(n.ext,t,r)})),JSON.stringify(n)}),(function(){return{item:e}}))}}))};function p(e,n,t){if(t){for(var i=e,r=n.split("."),a=0;a<r.length-1;++a)i[r[a]]||(i[r[a]]={}),i=i[r[a]];i[r[r.length-1]]=t.value}}function g(e,n,t){if(t){var r=Object(i.e)(t.value,t.kind,t.propertyType);if(r>-1){var a=e;a.metadata||(a.metadata={}),a.metadata.f||(a.metadata.f={}),a=a.metadata.f;for(var o=n.split("."),c=0;c<o.length-1;++c)a[o[c]]||(a[o[c]]={f:{}}),a=a[o[c]].f;Object(i.i)(t.value)?a[o[o.length-1]]={a:{t:r}}:a[o[o.length-1]]={t:r}}}}var O=t(11757),y=1e3,m=function e(){var n={};Object(l.a)(e,this,(function(e){e.setKillSwitchTenants=function(e,t){if(e&&t)try{var r=(u=e.split(","),s=[],u&&Object(i.c)(u,(function(e){s.push(Object(i.t)(e))})),s);if("this-request-only"===t)return r;for(var a=parseInt(t,10)*y,o=0;o<r.length;++o)n[r[o]]=c.a.dateNow()+a}catch(e){return[]}var u,s;return[]},e.isTenantKilled=function(e){var t=n,r=Object(i.t)(e);return void 0!==t[r]&&t[r]>c.a.dateNow()||(delete t[r],!1)}}))},S=function e(){var n=!0,t=!0,i=!0,r="use-collector-delta",a=!1;Object(l.a)(e,this,(function(e){e.allowRequestSending=function(){return n},e.firstRequestSent=function(){i&&(i=!1,a||(n=!1))},e.shouldAddClockSkewHeaders=function(){return t},e.getClockSkewHeaderValue=function(){return r},e.setClockSkew=function(e){a||(e?(r=e,t=!0,a=!0):t=!1,n=!0)}}))},j="POST",T="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",w="drop",C="send",R="rspFail",k="oth",x="kill-tokens",B="kill-duration",M="kill-duration-seconds",P="time-delta-millis",I=((_={})[1]="requeue",_[100]="requeue",_[200]="sent",_[8004]=w,_[8003]=w,_);
/*!
 * 1DS JS SDK POST plugin, 2.4.6
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */function E(e){try{return e.responseText}catch(e){}return""}var _,A=function e(n,t,s,f){this._responseHandlers=[];var d,v,h,p="?cors=true&content-type=application/x-json-stream&client-id=NO_AUTH&client-version="+i.a,g=new m,y=!1,_=new S,A=!1,N=0,H=!0,K=[],L={},q=[],D=null,U=!0;Object(l.a)(e,this,(function(e){var l=!0;function m(e,n){var t=new XDomainRequest;t.open(j,e.urlString),t.onload=function(){var e=E(t);z(n,200,{},e),te(e)},t.onerror=function(){z(n,400,{})},t.ontimeout=function(){z(n,500,{})},t.send(e.data)}function S(e,n){var t;fetch(e.urlString,(t={body:e.data,method:j,credentials:"include"},t[T]=!0,t.headers=e.headers,t)).then((function(e){var t={},i="";e.headers&&e.headers.forEach((function(e,n){t[n]=e})),e.body&&e.text().then((function(e){i=e})),z(n,e.status,t,i),te(i)})).catch((function(e){z(n,0,{})}))}function F(e,n,t){function r(e,n,t){if(!e[t]&&n&&n.getResponseHeader){var r=n.getResponseHeader(t);r&&(e[t]=Object(i.t)(r))}return e}function a(e){var n={};return e.getAllResponseHeaders?n=function(e){var n={};if(Object(i.m)(e)){var t=Object(i.t)(e).split(/[\r\n]+/);Object(i.c)(t,(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var r=Object(i.t)(e.substring(0,t)).toLowerCase(),a=Object(i.t)(e.substring(t+1));n[r]=a}else n[Object(i.t)(e)]=1}}))}return n}(e.getAllResponseHeaders()):(n=r(n,e,P),n=r(n,e,B),n=r(n,e,M)),n}function o(e,t){z(n,e.status,a(e),t)}var c=new XMLHttpRequest;try{c[T]=!0}catch(e){}l&&(c.withCredentials=!0),c.open(j,e.urlString,!t),Object(i.c)(Object(i.p)(e.headers),(function(n){c.setRequestHeader(n,e.headers[n])})),c.onload=function(){var e=E(c);o(c,e),te(e)},c.onerror=function(){o(c)},c.ontimeout=function(){o(c)},c.send(e.data)}function z(e,n,t,i){try{e(n,t,i)}catch(e){d.diagLog().throwInternal(a.a.WARNING,o.c.SendPostOnCompleteFailure,e)}}function V(){return!y&&N<t}function X(){var e=q;return q=[],e}function Q(e,n,t){var i=!1;return e&&e.length>0&&!y&&v&&D&&(i=n||V()&&(t>0||_.allowRequestSending())),i}function W(e){var n={};return e&&Object(i.c)(e,(function(e,t){n[t]={iKey:e.iKey(),evts:e.events()}})),n}function G(e,t,r,a,o,c){if(e&&0!==e.length)if(y)ie(e,1,a);else{var s=e;Object(u.b)(h,(function(){return"HttpManager:_sendBatches"}),(function(u){u&&(e=e.slice(0));for(var s=[],l=null,f=Object(i.h)();Q(e,a,t);){var d=e.shift();d&&d.count()>0&&(g.isTenantKilled(d.iKey())?s.push(d):(l=l||D.createPayload(t,r,a,c&&Z()),D.appendPayload(l,d,n)?null!==l.overflow&&(e=[l.overflow].concat(e),l.overflow=null,Y(l,f,Object(i.h)(),o),f=Object(i.h)(),l=null):(Y(l,f,Object(i.h)(),o),f=Object(i.h)(),e=[d].concat(e),l=null)))}l&&Y(l,f,Object(i.h)(),o),e.length>0&&(q=e.concat(q)),ie(s,8004,a)}),(function(){return{batches:W(s),retryCount:t,isTeardown:r,isSynchronous:a,sendReason:o,useSendBeacon:c}}),!a)}}function J(e){var n=p,t="";Object(i.c)(e.apiKeys,(function(e){t.length>0&&(t+=","),t+=e})),t.length>0&&(n+="&apikey="+t),n+="&upload-time="+c.a.dateNow().toString();var r=function(e){for(var n=0;n<e.batches.length;n++)for(var t=e.batches[n].events(),r=0;r<t.length;r++){var a=(t[r].ext||{}).intweb||{};if(Object(i.n)(a.msfpc))return encodeURIComponent(a.msfpc)}return""}(e);if(Object(i.n)(r)&&(n=n+"&ext.intweb.msfpc="+r),_.shouldAddClockSkewHeaders()&&(n+="&time-delta-to-apply-millis="+_.getClockSkewHeaderValue()),h.getWParam){var a=h.getWParam();a>=0&&(n+="&w="+a)}for(var o=0;o<K.length;o++)n+="&"+K[o].name+"="+K[o].value;return n}function Z(){return!H&&A&&Object(i.j)()}function $(e,n,t){e[n]=e[n]||{},e[n][d.identifier]=t}function Y(n,t,a,o){if(n&&n.payloadBlob&&n.payloadBlob.length>0){var c=J(n),l=Object(i.h)();Object(u.b)(h,(function(){return"HttpManager:_doPayloadSend"}),(function(){Object(i.c)(n.batches,(function(e){Object(i.c)(e.events(),(function(e){if(U){var n=e.timings=e.timings||{};$(n,"sendEventStart",l),$(n,"serializationStart",t),$(n,"serializationCompleted",a)}e.sendAttempt>0?e.sendAttempt++:e.sendAttempt=1}))})),ie(n.batches,1e3+(o||0),n.isSync,!0);var f={data:n.payloadBlob,urlString:c,headers:L};n.payloadBlob=null;var b=null,p=!!e.sendHook;Z()&&n.isBeacon?(p=!1,b=function(t){!function(e,n,t){try{if(Object(i.j)()){var a=Object(r.i)();if(a.sendBeacon(e.urlString,e.data))return void ee(n,200,t,!1);Object(i.c)(n.batches,(function(e){null.push(e.split(0))})),ee(n,200,t,!1),ie(null,8003,n.isSync,!0)}}catch(e){d.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+e)}}(t,n,o),e.sendListener&&e.sendListener(f,t,n.isSync||n.isTeardown,!0)}):v&&(b=function(t){_.firstRequestSent();var r=function(e,t){!function(e,n,t,r){var a=9e3,o=null,c=!1,u=!1;try{var l=!0;if(typeof e!==i.u){if(n){_.setClockSkew(n[P]);var f=n[B]||n["kill-duration-seconds"];Object(i.c)(g.setKillSwitchTenants(n[x],f),(function(e){Object(i.c)(t.batches,(function(n){if(n.iKey()===e){o=o||[];var i=n.split(0);t.numEvents-=i.count(),o.push(i)}}))}))}if(200===e)return void(a=200);(!O.a.shouldRetryForStatus(e)||t.numEvents<=0)&&(l=!1),a=9e3+e%1e3}if(l){a=100;var d=t.retryCnt;t.isSync||(d<s?(c=!0,ne((function(){t.isSync||N--,G(t.batches,d+1,t.isTeardown,t.isSync,5,t.isBeacon)}),!0,O.a.getMillisToBackoffForRetry(d))):u=!0)}}finally{c||(_.setClockSkew(),ee(t,a,r,u)),ie(o,8004,t.isSync)}}(e,t,n,o)};try{v.sendPOST(t,r,n.isTeardown||n.isSync),e.sendListener&&e.sendListener(f,t,n.isSync||n.isTeardown,!1)}catch(e){z(r,0,{})}}),Object(u.b)(h,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(b)if(n.isSync||N++,p){var t={data:f.data,urlString:f.urlString,headers:f.headers},i=!1;Object(u.b)(h,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(t,(function(e){i=!0,b(e)}),n.isSync||n.isTeardown)}catch(e){i||b(f)}}))}else b(f)})),ie(n.sizeExceed,8003,n.isSync)}),(function(){return{thePayload:n,serializationStart:t,serializationCompleted:a,sendReason:o}}),n.isSync)}}function ee(n,t,r,a){try{a&&d._backOffTransmission(),200===t&&(a||n.isSync||d._clearBackOff(),function(e){if(U){var n=Object(i.h)();Object(i.c)(e,(function(e){var t,r;e&&e.count()>0&&(t=e.events(),r=n,U&&Object(i.c)(t,(function(e){$(e.timings=e.timings||{},"sendEventCompleted",r)})))}))}}(n.batches)),ie(n.batches,t,n.isSync,!0)}finally{n.isSync||(N--,5!==r&&e.sendQueuedRequests(r,!n.isSync,n.isBeacon))}}function ne(e,n,t){n?e():d._setTimeoutOverride(e,t)}function te(n){var t=e._responseHandlers;try{for(var r=0;r<t.length;r++)try{t[r](n)}catch(e){d.diagLog().throwInternal(a.a.CRITICAL,o.c.PostResponseHandler,"Response handler failed: "+e)}if(n){var c=JSON.parse(n);Object(i.n)(c.webResult)&&Object(i.n)(c.webResult.msfpc)&&Object(i.r)("MSFPC",c.webResult.msfpc,365)}}catch(e){}}function ie(e,n,t,r){if(e&&e.length>0&&f){var c=f[(s=n,l=I[s],Object(i.n)(l)||(l=k,s>=9e3&&s<=9999?l=R:s>=8e3&&s<=8999?l=w:s>=1e3&&s<=1999&&(l=C)),l)];c&&Object(u.b)(h,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){ne((function(){try{c.call(f,e,n,t)}catch(e){d.diagLog().throwInternal(a.a.CRITICAL,o.c.NotificationException,"send request notification failed: "+e)}}),r||t,0)}),(function(){return{batches:W(e),reason:n,isSync:t,sendSync:r}}),!t)}var s,l}e.initialize=function(e,n,t,a){if(p=e+p,U=!(h=n).config.disableEventTimings,d=t,D=new b(n),!(v=a)){H=!1,A=!Object(i.l)();var o=Object(r.g)();o&&o.protocol&&"file:"===o.protocol.toLowerCase()&&(l=!1);var c=null;Object(i.v)()?c=m:Object(i.l)()?c=S:"undefined"!=typeof XMLHttpRequest&&(c=F),v={sendPOST:c}}},e._getDbgPlgTargets=function(){return[v,g,D]},e.addQueryStringParameter=function(e,n){for(var t=0;t<K.length;t++)if(K[t].name===e)return void(K[t].value=n);K.push({name:e,value:n})},e.addHeader=function(e,n){L[e]=n},e.canSendRequest=function(){return V()&&_.allowRequestSending()},e.sendQueuedRequests=function(e,n,t){var i=!c.a.isNullOrUndefined(n)&&!n;Q(q,i,0)&&G(X(),0,!1,i,e||0,!!t)},e.isCompletelyIdle=function(){return!y&&0===N&&0===q.length},e.addBatch=function(e){if(e&&e.count()>0){if(g.isTenantKilled(e.iKey()))return!1;q.push(e)}return!0},e.teardown=function(){q.length>0&&G(X(),0,!0,!0,2,!0)},e.pause=function(){y=!0},e.resume=function(){y=!1,e.sendQueuedRequests(4,!1)},e.sendSynchronousBatch=function(e,n,t){e&&e.count()>0&&G([e],0,!1,!0,n||0,!!t)}}))};n.a=A},18109:function(e,n,t){"use strict";(function(e){var i=t(6405),r=t(8654),a=t(17958),o=t(8296),c=t(11744),u=t(3297),s="version",l="properties",f=function(n){function t(){var e=n.call(this)||this;return e.pluginVersionStringArr=[],e.pluginVersionString="",Object(u.a)(t,e,(function(e,n){e.initialize=function(t,a,u,s){Object(i.b)(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(t){t.endpointUrl||(t.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var i=t.propertyStorageOverride;if(i&&(!i.getProperty||!i.setProperty))throw"Invalid property storage override passed.";t.channels&&Object(c.c)(t.channels,(function(n){n&&Object(c.c)(n,(function(n){if(n.identifier&&n.version){var t=n.identifier+"="+n.version;e.pluginVersionStringArr.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},a&&Object(c.c)(a,(function(n){if(n&&n.identifier&&n.version){var t=n.identifier+"="+n.version;e.pluginVersionStringArr.push(t)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{n.initialize(t,a,u,s)}catch(n){e.logger.throwInternal(r.a.CRITICAL,o.c.ErrorProvidedChannels,"Channels must be provided through config.channels only")}e.pollInternalLogs("InternalLog")}),(function(){return{config:t,extensions:a,logger:u,notificationManager:s}}))},e.track=function(t){Object(i.b)(e,(function(){return"AppInsightsCore.track"}),(function(){var i=t;if(i){i.timings=i.timings||{},i.timings.trackStart=Object(c.h)(),Object(c.k)(i.latency)||(i.latency=o.a.Normal);var r=i.ext=i.ext||{};r.sdk=r.sdk||{},r.sdk.ver=c.a;var a=i.baseData=i.baseData||{};a[l]||(a[l]={});var u=a[l];u[s]||(u[s]=""),""!=e.pluginVersionString&&(u[s]=e.pluginVersionString)}n.track(i)}),(function(){return{item:t}}),!t.sync)}})),e}return e(t,n),t.prototype.initialize=function(e,n,t,i){},t.prototype.track=function(e){},t}(a.a);n.a=f}).call(this,t(3126).__extendsFn)},7535:function(e,n,t){"use strict";t.d(n,"c",(function(){return i})),t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return a}));
/*!
 * 1DS JS SDK POST plugin, 2.4.6
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */
var i="REAL_TIME",r="NEAR_REAL_TIME",a="BEST_EFFORT"},8296:function(e,n,t){"use strict";(function(e){t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return o}));var i=t(8654),r={Normal:1,CostDeferred:2,RealTime:3},a={Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9},o=e({},i.b,{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519})}).call(this,t(3126).__assignFn)},9862:function(e,n,t){"use strict";t(3126);var i=t(11755);t.d(n,"a",(function(){return i.a}));t(7535);
/*!
 * 1DS JS SDK POST plugin, 2.4.6
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */}}]);
//# sourceMappingURL=owa.MailBoot~ProofingPlugin~otel~otellogger.js.map
self.scriptsLoaded['owa.MailBoot~ProofingPlugin~otel~otellogger.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ProofingPlugin~otel~otellogger.js'] = (new Date()).getTime();