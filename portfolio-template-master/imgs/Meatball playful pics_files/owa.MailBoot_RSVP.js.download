self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~RSVP.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[784],{1099:function(e,t){function n(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=1099},2208:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(614);function a(e){return Object(r.a)("calendarDayOfWeek_"+e)}},2531:function(e,t,n){"use strict";var r=n(53),a=n(614),c=n(5);var o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function i(e){return o.indexOf(e)}var u=n(2208),b=7;function O(e){var t=function(e){if(e&&0!==e.length){if(1===e.length)return e[0];if(2===e.length)return Object(r.a)(Object(a.a)("formatStringTwoItems"),e[0],e[1]);for(var t=Object(r.a)(Object(a.a)("formatStringNItemsStart"),e[0],e[1]),n=2;n<e.length-1;n++)t=Object(r.a)(Object(a.a)("formatStringNItemsMiddle"),t,e[n]);return t=Object(r.a)(Object(a.a)("formatStringNItemsEnd"),t,e[e.length-1])}return""}(e.DaysOfWeek.split(" ").sort(d.bind(null,e.FirstDayOfWeek)).map((function(e){return Object(u.a)(e)})));return 1===e.Interval?Object(r.a)(Object(a.a)("calendarWeekly1FormatString"),t):2===e.Interval?Object(r.a)(Object(a.a)("calendarWeekly2FormatString"),t):Object(r.a)(Object(a.a)("calendarWeeklyNFormatString"),t,e.Interval)}var f={canHandle:function(e){return!!e.DaysOfWeek&&!!e.FirstDayOfWeek&&!!e.Interval},formatRecurrence:O,formatRecurrenceOption:O,getNumberedRecurrenceEndDate:function(e,t,n){var r=function(e){var t=Array(b);return e.forEach((function(e){switch(e){case"Weekday":t[i("Monday")]=!0,t[i("Tuesday")]=!0,t[i("Wednesday")]=!0,t[i("Thursday")]=!0,t[i("Friday")]=!0;break;case"WeekendDay":t[i("Saturday")]=!0,t[i("Sunday")]=!0;break;case"Day":for(var n=0;n<t.length;n++)t[n]=!0;break;default:t[i(e)]=!0}})),t}(e.DaysOfWeek.split(" ")),a=r.reduce((function(e,t){return t?e+1:e}),0),o=function(e,t,n){var r=i(n),a=Object(c.ob)(e),o=0;do{t[a]&&o++,a=s(a+1,b)}while(a!==r);return o}(t,r,e.FirstDayOfWeek);if(n<=o)return l(r,t,n);var u=n-o,O=Math.ceil(u/a),f=Object(c.k)(t,e.Interval*O);return l(r,Object(c.cc)(f,i(e.FirstDayOfWeek)),s(u,a)||a)},formatOptionsForSummary:O};function d(e,t,n){var r={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6,Day:0,Weekday:0,WeekendDay:0},a=r[e];return s(r[t]-a,7)-s(r[n]-a,7)}function s(e,t){return(e%t+t)%t}function l(e,t,n){for(var r=Object(c.ob)(t),a=0;a<n;)e[s(r,b)]&&a++,r++;return r--,Object(c.e)(t,s(r-Object(c.ob)(t),b))}var j=7;function m(e,t,n){var r=Object(c.bc)(e),a=i(t)-Object(c.ob)(r);a<0&&(a+=j);var o=Object(c.e)(r,a);switch(n){case"First":return o;case"Second":return Object(c.k)(o,1);case"Third":return Object(c.k)(o,2);case"Fourth":return Object(c.k)(o,3);case"Last":var u=Object(c.k)(o,4);return Object(c.Kb)(r,u)||(u=Object(c.k)(o,3)),u;default:throw new Error("Invalid DayOfWeekIndexType")}}function y(e){return Object(a.a)("calendarDayOfWeekIndex_"+e)}var v={canHandle:function(e){return!!e.DaysOfWeek&&!!e.DayOfWeekIndex&&!!e.Interval},formatRecurrence:function(e){var t=Object(u.a)(e.DaysOfWeek),n=y(e.DayOfWeekIndex);return 1===e.Interval?Object(r.a)(Object(a.a)("calendarRelativeMonthly1FormatString"),n,t):2===e.Interval?Object(r.a)(Object(a.a)("calendarRelativeMonthly2FormatString"),n,t):Object(r.a)(Object(a.a)("calendarRelativeMonthlyNFormatString"),n,t,e.Interval)},formatRecurrenceOption:function(e){var t=Object(u.a)(e.DaysOfWeek),n=y(e.DayOfWeekIndex);return Object(r.a)(Object(a.a)("calendarRelativeMonthlyOptionFormatString"),n,t)},getNumberedRecurrenceEndDate:function(e,t,n){var r=m(t,e.DaysOfWeek,e.DayOfWeekIndex);return Object(c.Hb)(r,t)&&(r=m(Object(c.i)(r,1),e.DaysOfWeek,e.DayOfWeekIndex)),m(Object(c.i)(r,(n-1)*e.Interval),e.DaysOfWeek,e.DayOfWeekIndex)},formatOptionsForSummary:function(e){var t=Object(u.a)(e.DaysOfWeek),n=y(e.DayOfWeekIndex);return Object(r.a)(Object(a.a)("calendarRelativeMonthlyOptionFormatLowercaseString"),n,t)}};var I={canHandle:function(e){return!!e.DayOfMonth&&!!e.Interval},formatRecurrence:function(e){return 1===e.Interval?Object(r.a)(Object(a.a)("calendarAbsoluteMonthly1FormatString"),e.DayOfMonth):2===e.Interval?Object(r.a)(Object(a.a)("calendarAbsoluteMonthly2FormatString"),e.DayOfMonth):Object(r.a)(Object(a.a)("calendarAbsoluteMonthlyNFormatString"),e.DayOfMonth,e.Interval)},formatRecurrenceOption:function(e){return Object(r.a)(Object(a.a)("calendarAbsoluteMonthlyOptionFormatString"),e.DayOfMonth)},getNumberedRecurrenceEndDate:function(e,t,n){var r=t;return Object(c.mb)(r)!=e.DayOfMonth&&(r=Object(c.Wb)(r,e.DayOfMonth),Object(c.Hb)(r,t)&&(r=Object(c.i)(r,1))),Object(c.i)(r,(n-1)*e.Interval)},formatOptionsForSummary:function(e){return Object(r.a)(Object(a.a)("calendarAbsoluteMonthlyOptionFormatLowercaseString"),e.DayOfMonth)}};function h(e){return Object(a.a)("calendarMonth_"+e)}var g=["January","February","March","April","May","June","July","August","September","October","November","December"];function D(e){return R(Object(a.a)("calendarRelativeYearlyOptionFormatString"),e)}function R(e,t){var n=Object(u.a)(t.DaysOfWeek),a=y(t.DayOfWeekIndex),c=h(t.Month);return Object(r.a)(e,a,n,c)}var p={canHandle:function(e){return!!e.DaysOfWeek&&!!e.Month&&!!e.DayOfWeekIndex},formatRecurrence:function(e){return R(Object(a.a)("calendarRelativeYearlyFormatString"),e)},formatRecurrenceOption:D,getNumberedRecurrenceEndDate:function(e,t,n){var r=t,a=g.indexOf(e.Month);return Object(c.yb)(r)!=a&&(r=Object(c.Xb)(r,a)),r=m(r,e.DaysOfWeek,e.DayOfWeekIndex),Object(c.Hb)(r,t)&&(r=m(Object(c.l)(r,1),e.DaysOfWeek,e.DayOfWeekIndex)),m(Object(c.l)(r,n-1),e.DaysOfWeek,e.DayOfWeekIndex)},formatOptionsForSummary:D},M=["January","February","March","April","May","June","July","August","September","October","November","December"];function F(e){return S(Object(a.a)("calendarAbsoluteYearlyOptionFormatString"),e)}function S(e,t){var n=h(t.Month);return Object(r.a)(e,n,t.DayOfMonth)}var k={canHandle:function(e){return!!e.DayOfMonth&&!!e.Month},formatRecurrence:function(e){return S(Object(a.a)("calendarAbsoluteYearlyFormatString"),e)},formatRecurrenceOption:F,getNumberedRecurrenceEndDate:function(e,t,n){var r=t,a=M.indexOf(e.Month);return Object(c.yb)(r)!=a&&(r=Object(c.Xb)(r,a)),Object(c.mb)(r)!=e.DayOfMonth&&(r=Object(c.Wb)(r,e.DayOfMonth)),Object(c.Hb)(r,t)&&(r=Object(c.l)(r,1)),Object(c.l)(r,n-1)},formatOptionsForSummary:F};function W(e){return 1===e.Interval?Object(a.a)("calendarDaily1Recurrence"):2===e.Interval?Object(a.a)("calendarDaily2Recurrence"):Object(r.a)(Object(a.a)("calendarDailyNRecurrence"),e.Interval)}var w={canHandle:function(e){return("DailyRecurrence:#Exchange"===e.__type||"DailyRecurrence"===e.__typename)&&!!e.Interval},formatRecurrence:W,formatRecurrenceOption:W,getNumberedRecurrenceEndDate:function(e,t,n){return Object(c.e)(t,(n-1)*e.Interval)},formatOptionsForSummary:W};n.d(t,"a",(function(){return T}));var E=[f,v,I,p,k,w];function T(e){for(var t,n=0;n<E.length;n++)if(E[n].canHandle(e)){t=E[n];break}if(!t)throw new Error("Invalid recurrence type");return t}},4452:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(5),a=n(2531);function c(e,t){var n=e.End,c=e.Recurrence;if(c){var o=c.RecurrenceRange,i=o.EndDate;if(i){var u=Object(r.nc)(i);return Object(r.Hb)(u,t)}var b=o,O=b.NumberOfOccurrences,f=b.StartDate;if(O){var d=Object(r.nc)(f);u=Object(a.a)(c.RecurrencePattern).getNumberedRecurrenceEndDate(c.RecurrencePattern,d,O);return Object(r.Hb)(u,t)}return!1}return Object(r.Hb)(Object(r.nc)(n),t)}},614:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r;n(1),n(490);function a(e){if(!r)throw new Error("Localization has not yet been initialized");return r(e)}function c(e){r=e}},6785:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(2),c=Object(a.action)("parseGetItemResponseAction",(function(e,t){return{items:e,clientItemIds:t}})),o=Object(a.action)("tryPrefetchMeetingMessage",(function(e,t,n){return{mailboxInfo:e,listViewType:t,shouldDelayPrefetch:n}})),i=Object(a.action)("removeMeetingMessagesFromStore",(function(e){return{itemIds:e}})),u=n(4396),b=n(121),O=n(1947),f=n(1956),d=n(8214),s=n(981),l=n(979),j=n(128),m=n(23),y=n(8215),v=Object(a.mutatorAction)("updateMailStoreForRsvp",(function(e,t){e.shouldShowRSVP=t})),I=Object(a.mutatorAction)("updateTableRelationMapForRsvp",(function(e,t){e.shouldShowRSVP=t})),h=[Object(l.a)({FieldURI:"Start"}),Object(l.a)({FieldURI:"End"}),Object(l.a)({FieldURI:"AssociatedCalendarItemId"}),Object(l.a)({FieldURI:"RecurrenceId"}),Object(l.a)({FieldURI:"Recurrence"}),Object(l.a)({FieldURI:"ConflictingMeetings"}),Object(l.a)({FieldURI:"CalendarItemType"}),Object(l.a)({FieldURI:"IsResponseRequested"}),Object(l.a)({FieldURI:"Organizer"}),Object(l.a)({FieldURI:"ItemClass"}),Object(l.a)({FieldURI:"MeetingRequestType"}),Object(l.a)({FieldURI:"ItemParentId"}),Object(l.a)({FieldURI:"Sender"}),Object(l.a)({FieldURI:"ConversationId"}),Object(l.a)({FieldURI:"IsDelegated"}),Object(l.a)({FieldURI:"ReceivedRepresenting"}),Object(l.a)({FieldURI:"ResponseType"})];function g(e,t,n){return Object(r.c)(this,void 0,void 0,(function(){var a,o,i,u,l;return Object(r.f)(this,(function(r){switch(r.label){case 0:(a=new b.b("LoadMeetingMessage")).addCustomProperty("count",e.length),o=e.map((function(e){return e.Id})),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(f.e)(o,Object(s.a)({BaseShape:"IdOnly",AdditionalProperties:h}),null)];case 2:return!(i=r.sent())||i instanceof Error?a.endWithError("ServerError"):(u=e.filter((function(e){return i.some((function(t){return t.ItemId.Id===e.Id}))})),c(i,u),a.end()),(i instanceof Error||i.length!==o.length)&&m.g.warn("[loadingmeetingmessage] some items failed in: "+o),[3,4];case 3:return l=r.sent(),a.endWithError("ServerError",Error(l)),m.g.warn("[loadingmeetingmessage] all items failed in: "+o),[3,4];case 4:return function(e,t){t.forEach((function(t){if(1===e){var n=f.u.items.get(t.itemId);if(!n)return;(r=Object(d.a)(t.itemId))&&Object(y.a)(r)||v(n,!1)}else{var r,a=Object(O.N)(t.rowKey,t.tableViewId);if(!a)return;(r=Object(d.a)(t.itemId))&&Object(y.a)(r)||I(a,!1)}}))}(n,t),[2]}}))}))}Object(a.orchestrator)(o,(function(e){var t=e.listViewType,n=e.mailboxInfo,r=e.shouldDelayPrefetch,a=n.mailboxSmtpAddress,c=u.b(a);if(u.c(a),c&&0!==c.length){var o=c.map((function(e){return{Id:e.itemId,mailboxInfo:n}}));r?Object(j.a)((function(){g(o,c,t)})):g(o,c,t)}})),Object(a.mutator)(c,(function(e){for(var t=e.items,n=e.clientItemIds,a=function(e){var a=t[e],c=n[e],o=Object(O.M)().meetingMessageItems.get(c.Id);if(o){Object.keys(o).forEach((function(e){a[e]&&(o[e]=a[e])}))}else{var i=Object(r.a)(Object(r.a)({},a),{MailboxInfo:c.mailboxInfo,SmartTimeData:null,SmartTimeExtendedProperty:null,smartPillFeedbackSubmitted:!1});Object(O.M)().meetingMessageItems.set(c.Id,i)}},c=0;c<t.length;c++)a(c)})),Object(a.mutator)(i,(function(e){var t=e.itemIds,n=Object(O.M)();t.forEach((function(e){n.meetingMessageItems.has(e)&&setTimeout((function(){n.meetingMessageItems.delete(e)}),1e3)}))})),n.d(t,"tryPrefetchMeetingMessage",(function(){return o})),n.d(t,"removeMeetingMessagesFromStore",(function(){return i}))},730:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("initializeOwaObservableDateTime"),c=Object(r.action)("observableNowChanged"),o=Object(r.action)("observableTodayChanged"),i=n(5),u=n(14),b=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),O=Object(u.computed)((function(){return Object(i.nc)(b().now)})),f=function(){return O.get()},d=Object(u.computed)((function(){return Object(i.nc)(b().today)})),s=function(){return d.get()},l=function(e){return Object(i.Hb)(e,f())},j=function(e){return Object(i.Fb)(e,f())},m=function(e){return v(e,i.Hb)},y=function(e){return v(e,i.Ib)},v=function(e,t){return t(Object(i.Yb)(Object(i.nc)(e)),s())};function I(e){if(!e)return"";var t=Object(i.nc)(e);return function(e,t){var n=Object(i.Yb)(e);if(Object(i.Jb)(n,t))return i.ab;var r=function(e){return Object(i.Ob)(n,Object(i.e)(t,-e),t)};if(r(3))return i.ib;if(r(30))return i.hb;return i.Y}(t,s())(t)}function h(e){if(!e)return"";var t=Object(i.nc)(e);return function(e,t){var n=Object(i.Yb)(e);if(Object(i.Jb)(n,t))return i.T;return i.U}(t,s())(t)}function g(e){return e?function(e,t){var n=Object(i.Yb)(e);return Object(i.Jb)(n,t)?Object(i.ab)(e):D(n,t,2)?Object(i.lb)(e):D(n,t,7)?Object(i.H)(Object(i.bb)(e),Object(i.ab)(e)):Object(i.H)(Object(i.J)(e),Object(i.ab)(e))}(Object(i.nc)(e),s()):""}function D(e,t,n){return Object(i.Ob)(e,Object(i.e)(t,-n),t)}var R=Object(r.action)("updateTimes"),p=Object(r.action)("setNow"),M=Object(r.action)("setToday",(function(e){return{today:e}}));Object(r.mutator)(p,(function(){b().now=Object(i.lc)()})),Object(r.mutator)(M,(function(e){var t=e.today;b().today=t}));var F=n(21),S=n(79),k=!1;Object(r.orchestrator)(a,(function(){if(R(),!k){var e=Object(i.Rb)(),t=Object(i.ac)(Object(i.h)(e,1)),n=Object(i.w)(t,e);setTimeout((function(){return setInterval(R,F.g)}),n),document&&document.addEventListener("visibilitychange",R),k=!0}})),Object(r.orchestrator)(S.l,(function(){R()})),Object(r.orchestrator)(R,(function(){p();var e=Object(i.Ab)(Object(i.mc)()),t=b().today!=e;t&&M(e),c(),t&&o()})),n.d(t,"d",(function(){return a})),n.d(t,"j",(function(){return c})),n.d(t,"l",(function(){return o})),n.d(t,"i",(function(){return f})),n.d(t,"k",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return j})),n.d(t,"f",(function(){return m})),n.d(t,"h",(function(){return y})),n.d(t,"a",(function(){return I})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return g}))},8214:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1947);function a(e){var t=Object(r.M)().meetingMessageItems.get(e);if(!t)return null;var n=t;return n.Start&&n.End&&n.CalendarItemType?n:null}},8215:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2342),a=n(730),c=n(1964),o=n(4452);function i(e){var t=Object(c.a)(e.ParentFolderId.Id);if("deleteditems"===t||"sentitems"===t)return!1;if(e.IsDelegated&&e.ReceivedRepresenting)return!1;if(!e.AssociatedCalendarItemId)return!1;if(Object(r.q)(e.ItemClass)){var n=e;if("InformationalUpdate"===n.MeetingRequestType)return!1;if("NoResponseReceived"!==e.ResponseType)return!1;if(Object(o.a)(n,Object(a.i)()))return!1}return!0}}}]);
//# sourceMappingURL=owa.MailBoot~RSVP.js.map
self.scriptsLoaded['owa.MailBoot~RSVP.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~RSVP.js'] = (new Date()).getTime();