self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~ReadingPane~TabView.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[302],{11579:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(2036),i=e(24);function o(t){return!(!Object(i.i)("rp-persistedReadingPaneTabs")||!t)&&Object(r.b)().loadedItemReadingPaneViewStates.has(t)}},11580:function(t,n,e){"use strict";e.d(n,"a",(function(){return a}));var r=e(2036),i=e(2),o=e(2965),a=Object(i.mutatorAction)("updatePrimaryReadingPaneTabId",(function(t){r.a.primaryReadingPaneTabId=t}));Object(i.mutator)(o.a,(function(t){r.a.primaryReadingPaneTabId=null}))},11581:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(2119),i=e(2043),o=e(2861),a=e(23);function u(t,n,e){var u,c=Object(r.b)();if(t){switch(t.type){case i.a.SecondaryReadingPane:t.data.listViewType==e&&(u=Object(o.a)(n,e));break;case i.a.MailCompose:u=c.viewStates.get(t.data);break;case i.a.Primary:u=n?Object(o.a)(n,e,!0):null;break;default:u=null}return u}return a.d("There is no active tab. Something went very wrong."),null}},2010:function(t,n,e){"use strict";e.d(n,"b",(function(){return a})),e.d(n,"c",(function(){return u})),e.d(n,"d",(function(){return c})),e.d(n,"a",(function(){return d}));var r=e(2301),i=e(19),o=e(2012);function a(){return s(r.a.Bottom)}function u(){return s(r.a.Off)}function c(){return s(r.a.Right)}function s(t){var n=Object(o.a)();return null!==n.clientReadingPanePosition?n.clientReadingPanePosition===t:Object(i.a)().UserOptions.GlobalReadingPanePositionReact==t}function d(){var t=Object(i.a)().UserOptions.GlobalReadingPanePositionReact;return t==r.a.Off||t==r.a.Bottom}},2012:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(2),i=Object(r.createStore)("maillayout",{clientReadingPanePosition:null,showReadingPane:!1,showListPane:!0,showFolderPane:!0,senderColumnWidth:null,subjectColumnWidth:null,receivedColumnWidth:null})},2013:function(t,n,e){"use strict";var r=e(2088),i=e(1947);function o(){return Object(r.a)(Object(i.J)())}e.d(n,"b",(function(){return r.a})),e.d(n,"d",(function(){return r.c})),e.d(n,"c",(function(){return r.b})),e.d(n,"e",(function(){return r.d})),e.d(n,"a",(function(){return o}))},2088:function(t,n,e){"use strict";var r=e(209),i=e(1951),o=new Map;var a=e(2160),u=e(2027),c=e(2643);function s(t){return t?d(t.tableQuery):Object(r.d)()}function d(t){var n=Object(u.b)(t),e=null==t?void 0:t.folderId;return null!=n?Object(a.a)(n):l(e)}function l(t){return Object(i.G)(t)?Object(c.a)(t):function(t){if(!t)return Object(r.d)();if(!o.has(t)){var n=Object(i.u)(t,!0);o.set(t,n)}return o.get(t)}(t)}function f(t){return{mailboxInfo:d(t)}}e.d(n,"a",(function(){return s})),e.d(n,"c",(function(){return d})),e.d(n,"b",(function(){return l})),e.d(n,"d",(function(){return f}))},2223:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(2391);function i(t){return t&&Object(r.b)(t.ItemClass)}},2301:function(t,n,e){"use strict";var r;!function(t){t[t.Off=0]="Off",t[t.Right=1]="Right",t[t.Bottom=2]="Bottom"}(r||(r={})),n.a=r},2308:function(t,n,e){"use strict";e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return o}));var r=20,i=10,o=100},2319:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(2012);function i(){return Object(r.a)().showReadingPane}},2449:function(t,n,e){"use strict";var r=e(31),i=e(2560),o=e(1956),a=e(183),u=Object(a.action)("setIsPendingDeleteConversationItemParts")((function(t,n,e){void 0===e&&(e={conversationItemParts:o.u.conversations.get(t)});var r=e.conversationItemParts;r&&(r.isPendingDelete=n)})),c=e(2308);e.d(n,"d",(function(){return d})),e.d(n,"f",(function(){return l})),e.d(n,"e",(function(){return f})),e.d(n,"c",(function(){return i.a})),e.d(n,"g",(function(){return u})),e.d(n,"a",(function(){return c.b})),e.d(n,"b",(function(){return c.c}));var s=new r.c((function(){return Promise.all([e.e(15),e.e(17),e.e(16),e.e(286),e.e(722)]).then(e.bind(null,18252))})),d=new r.a(s,(function(t){return t.loadAllRecipientsForItem})),l=new r.a(s,(function(t){return t.loadItem})),f=new r.a(s,(function(t){return t.loadConversation}))},2487:function(t,n,e){"use strict";var r=e(2);n.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(function(t,n){return{itemIdToRemove:t,removeItemSource:n}}))},2560:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(1),i=e(1956),o=e(2487),a=e(3036),u=e(2);function c(t){var n,e,u,c;if(i.u.conversations.has(t)){var l=i.u.conversations.get(t);try{for(var f=Object(r.k)(l.conversationNodeIds),v=f.next();!v.done;v=f.next()){var b=v.value,m=i.u.conversationNodes.get(b);if(m)try{for(var O=(u=void 0,Object(r.k)(m.itemIds)),I=O.next();!I.done;I=O.next()){var j=I.value;Object(o.a)(j,1)}}catch(t){u={error:t}}finally{try{I&&!I.done&&(c=O.return)&&c.call(O)}finally{if(u)throw u.error}}s(b)}}catch(t){n={error:t}}finally{try{v&&!v.done&&(e=f.return)&&e.call(f)}finally{if(n)throw n.error}}d(t)}Object(a.a)()}var s=Object(u.mutatorAction)("deleteConversationNode",(function(t){i.u.conversationNodes.delete(t)})),d=Object(u.mutatorAction)("deleteConversation",(function(t){i.u.conversations.delete(t)}))},2593:function(t,n,e){"use strict";var r=e(31),i=e(1947),o=e(2013),a=e(1956),u=e(1964),c=e(2256);var s=e(2223);function d(t,n){if(n.folderId&&"junkemail"==Object(u.a)(n.folderId))return!1;if(Object(s.a)(t))return!1;var e=a.u.items.get(t.ItemId.Id);return!(null==e||!e.shouldShowAttachmentPreviews)||!(!t.HasAttachments&&!t.HasProcessedSharepointLink)&&(b.importAndExecute(Object(o.d)(n),t.ConversationId,t.ItemId.Id),!0)}var l=function(t,n,e){void 0===e&&(e={listViewStore:i.ab});var r,a,s,d=1==n.type,l=t.ConversationId,f=e.listViewStore.conversationItems.get(l.Id),v=t.HasProcessedSharepointLink;if(n.folderId&&"junkemail"==Object(u.a)(n.folderId))return!1;if((null==(r=t)?void 0:r.ItemClasses)&&r.ItemClasses.length>0&&r.ItemClasses.some((function(t){return 0===t.indexOf(c.a)})))return!1;if(d){if(null==f?void 0:f.shouldShowAttachmentPreviews)return!0;a=s=!!t.HasAttachments||v}else{if(!t.HasAttachmentPreviews&&!v)return!1;f&&!v?(a=f.globalItemIds.length!=t.GlobalItemIds.length,s=f.shouldShowAttachmentPreviews):(a=!0,s=!0)}return a&&b.importAndExecute(Object(o.d)(n),t.ConversationId,null),s};e.d(n,"b",(function(){return v})),e.d(n,"a",(function(){return b})),e.d(n,"c",(function(){return m})),e.d(n,"d",(function(){return O})),e.d(n,"e",(function(){return l})),e.d(n,"f",(function(){return d}));var f=new r.c((function(){return e.e(535).then(e.bind(null,18420))})),v=new r.a(f,(function(t){return t.getPreviews})),b=new r.a(f,(function(t){return t.add})),m=new r.a(f,(function(t){return t.getAttachmentsForConversationWell})),O=new r.a(f,(function(t){return t.removeAttachmentPreviewsForRow}))},2624:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(4155);function i(t,n){return t.map((function(t){return Object(r.getInstrumentationContext)(t,n)})).filter((function(t){return t}))}},2643:function(t,n,e){"use strict";var r=e(1947),i=e(1951);function o(){var t=Object(r.J)();return t&&0==t.tableQuery.type&&Object(i.G)(t.tableQuery.folderId)}function a(){var t=Object(r.J)();return t&&0==t.tableQuery.type&&Object(i.G)(t.tableQuery.folderId)?t.tableQuery.folderId:null}var u=e(2),c=e(2124),s=e(2209),d=e(14),l=Object(u.createStore)("publicFolderUtilsStore",new d.ObservableMap),f=e(57);function v(t){if(!l().has(t)){var n=c.a.folderTable.get(t),e=null!=n.ReplicaList?n.ReplicaList[0]:Object(f.h)().SessionSettings.DefaultPublicFolderMailbox,r=Object(s.a)(e);b(t,r)}return l().get(t)}var b=Object(u.mutatorAction)("addPublicFolderMailboxInfoToStore",(function(t,n){l().set(t,n)}));e.d(n,"b",(function(){return a})),e.d(n,"c",(function(){return o})),e.d(n,"a",(function(){return v}))},2945:function(t,n,e){var r=e(3014),i=e(78);"string"==typeof r&&(r=[[t.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(t.exports=r.locals)},2965:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(2),i=Object(r.action)("ON_SELECT_FOLDER_COMPLETE",(function(t,n,e,r,i,o,a){return{selectedFolderId:t,previousFolderId:n,isExitingSearch:e,selectedTableViewId:r,mailListItemSelectionSource:i,isInImmersiveView:o,actionSource:a}}))},3014:function(t,n,e){(n=t.exports=e(77)(!1)).push([t.i,"._2HTFmaDIVHVbnIkwPM9srx{height:100%;-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;position:relative;z-index:0}._2HTFmaDIVHVbnIkwPM9srx,._3KAPMPOz8KsW24ooeUflK2{overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}._3KAPMPOz8KsW24ooeUflK2{height:auto;min-height:0;-webkit-box-flex:1;-ms-flex:1;flex:1;-webkit-box-orient:horizontal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch}",""]),n.locals={appContainer:"_2HTFmaDIVHVbnIkwPM9srx",main:"_3KAPMPOz8KsW24ooeUflK2"}},3036:function(t,n,e){"use strict";e.d(n,"a",(function(){return i})),e.d(n,"b",(function(){return o}));var r=e(2),i=Object(r.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),o=Object(r.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},3145:function(t,n,e){"use strict";e.d(n,"a",(function(){return o})),e.d(n,"b",(function(){return a}));var r=e(2307),i=e(3806),o=function(){var t=Object(r.a)();return a(t)},a=function(t){if(!t||!t.isInitialLoadComplete)return"Loading";var n=0==t.rowKeys.length;return 0!=t.loadErrorStatus&&(n||Object(i.a)(t))?"Error":n?"Empty":"Loaded"}},3249:function(t,n,e){"use strict";var r=e(3452);n.a=function(t){var n=function(t){var n;return(null===(n=null==t?void 0:t.Attachments)||void 0===n?void 0:n.length)&&t.Attachments[0]}(t);return Object(r.a)(n)?n:null}},3452:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(2121),i=function(t,n){return t.substring(0,n.length)===n},o=function(t,n){return t.substring(t.length-n.length)===n},a=function(t){return t.ContentType&&(i(t.ContentType,r.v)||i(t.ContentType,r.l))},u=function(t){return t.ContentType&&t.ContentType===r.j};function c(t){return(null==t?void 0:t.Name)&&o(t.Name,r.t)&&(a(t)||u(t))}},3824:function(t){t.exports=JSON.parse('{"a":"f4a","b":"g4a"}')},4832:function(t,n,e){"use strict";e.d(n,"b",(function(){return o}));var r=e(2223),i=e(2391);n.a=function(t){var n;return Object(r.a)(t)?(null===(n=t.Smime)||void 0===n?void 0:n.SmimeType)?t.Smime.SmimeType:Object(i.d)(t.ItemClass)?11:-1:0};var o=function(t){return t&&t.length?t.reduce((function(t,n){return Object(i.c)(n)?-1:0===t&&Object(i.d)(n)?11:t}),0):0}},6158:function(t,n,e){"use strict";var r=e(2),i=Object(r.action)("MOVE_READING_PANE_TO_TAB",(function(t,n,e,r,i,o,a){return{id:t,subject:n,categories:e,makeActive:r,instrumentationContext:i,listViewType:o,makeHidden:a}}));n.a=i},8201:function(t){t.exports=JSON.parse('{"a":"hGc"}')},9592:function(t,n,e){"use strict";var r=e(4972),i=e(6158),o=e(11580),a=e(2093),u=e(2112),c=e(11581),s=e(2031),d=e(1956),l=e(2043),f=e(183),v=e(2656),b=e(24);n.a=Object(f.action)("loadConversationReadingPaneForSingleMailItemSelected")((function(t,n,e,f,m,O,I){var j,h,g,P;if(void 0===I&&(I={conversationReadingPaneState:Object(a.a)(),hasConversationInMailStore:d.u.conversations.has(null==t?void 0:t.Id)}),null===(h=null===(j=null==e?void 0:e.dp)||void 0===j?void 0:j.addCheckpoint)||void 0===h||h.call(j,"LCRPFSMIS"),!t)return Promise.resolve();var w=Object(l.d)(),p=I.conversationReadingPaneState?Object(c.a)(w,I.conversationReadingPaneState.conversationId.Id,0):null;if(p&&6!==p.asyncSendState&&!n)return Promise.resolve();if((null===(g=I.conversationReadingPaneState)||void 0===g?void 0:g.conversationId.Id)==t.Id&&(null===(P=I.conversationReadingPaneState)||void 0===P?void 0:P.currentSelectedFolderId)==Object(s.b)()&&I.hasConversationInMailStore)return Object(v.b)(),Promise.resolve();if(p)if(w.type==l.a.SecondaryReadingPane||p.isInlineCompose){if(!Object(b.i)("rp-smartMoveToTab")){var S=6==p.asyncSendState;Object(i.a)(I.conversationReadingPaneState.conversationId,I.conversationReadingPaneState.conversationSubject,I.conversationReadingPaneState.conversationCategories,!1,e,0,S)}}else u.k.importAndExecute(p,!0,!1);return Object(o.a)(t),Object(r.b)(t,e,f,m,O)}))}}]);
//# sourceMappingURL=owa.MailBoot~ReadingPane~TabView.js.map
self.scriptsLoaded['owa.MailBoot~ReadingPane~TabView.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~ReadingPane~TabView.js'] = (new Date()).getTime();