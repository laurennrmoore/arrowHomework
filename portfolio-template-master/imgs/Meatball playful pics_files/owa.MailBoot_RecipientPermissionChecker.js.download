self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~RecipientPermissionChecker.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[791],{1265:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"GetPersonaJsonRequest:#Exchange"},e)}},1270:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"GetItemRequest:#Exchange"},e)}},1273:function(e,t,n){"use strict";var r=n(33),i=n(1);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.a)({__type:"GetItemJsonRequest:#Exchange"},n)),Object(r.a)("GetItem",e,t)}n.d(t,"a",(function(){return o}))},1313:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c}));var r=n(1),i=void 0,o=new Promise((function(e){i=e}));function u(e){null==i||i(e)}function c(){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(e){return[2,Promise.race([o,new Promise((function(e,t){setTimeout((function(){return t()}),45e3)}))])]}))}))}},1316:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(997),i=n(180),o=n(996);function u(e){if(!e)return Promise.reject(new Error("GetPersonaByEmailAddress failed"));var t=Object(r.a)({EmailAddress:{EmailAddress:e}});return Object(o.a)({Header:Object(i.b)(),Body:t}).then((function(e){if(e.Body&&"NoError"===e.Body.ResponseCode)return e.Body.Persona;throw new Error("GetPersonaByEmailAddress failed")}))}},158:function(e,t,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r)&&r.length){var u=i.apply(null,r);u&&e.push(u)}else if("object"===o)for(var c in r)n.call(r,c)&&r[c]&&e.push(c)}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},186:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function o(t){r--,delete e[t]}this.put=function(t,n,i,u){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var a={value:n,expire:i+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){o(t),u&&u(t,n)}.bind(this),i)),e[t]=a,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(o){var u=e[o];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return i&&t++,u.value;i&&n++,r--,delete e[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),o=n&&n.skipDuplicates;for(var u in r)if(r.hasOwnProperty(u)){if(o)if(e[u])continue;var c=r[u],a=c.expire-i;if(a<=0){this.del(u);continue}a=a>0?a:void 0,this.put(u,c.value,a)}return this.size()}}e.exports=new r,e.exports.Cache=r},1986:function(e,t,n){"use strict";var r=n(1),i=n(2051),o=n(374),u=n(730),c=n(121),a=n(5),s="X-AnchorMailbox",d="Authorization",f="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";function p(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,p,b,v,h;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(n={},p=Object(o.k)(e)){if(p.accountState==o.b.AccessRevoked)return[2,null];if(p.accountState==o.b.AccountDeprovisioned||p.accountState==o.b.AccountNotFound)return Object(o.c)(p.accountState,p.accountProviderType),[2,null]}return t?(n[s]=t,n[l]=t):p&&(n[s]=p.anchorMailbox),p?(b=p.token,!(v=Object(u.g)(p.tokenExpiry))&&b?[3,2]:(Object(c.s)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(p.tokenExpiry,Object(a.Rb)()),isTokenExpired_1:v,isTokenInvalid_2:!b},{isCore:!0}),[4,i.a.importAndExecute(p.accountId,e,b)])):[3,3];case 1:(b=r.sent())||(b=""),r.label=2;case 2:h=void 0,"Outlook"==p.accountProviderType?(h='MSAuth1.0 usertoken="'+b+'", type="MSACT"',n[f]=1..toString()):"Google"!=p.accountProviderType&&"ICloud"!=p.accountProviderType||(h="Bearer "+b,n[f]=2..toString()),n[d]=h,r.label=3;case 3:return[2,n]}}))}))}var b=n(1989),v=n(23);function h(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=Object(b.a)(),i=n,[4,m(e,t)];case 1:return i.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function m(e,t){var n;return Object(r.c)(this,void 0,void 0,(function(){var i,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return i=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,[4,p(e.mailboxInfo.userIdentity,O(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return o=r.sent(),Object(b.b)(i,o),[2,i]}}))}))}function O(e,t){var n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&v.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return O}))},1989:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach((function(n){return e.set(n,t[n])}))}function i(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},1991:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),i=Object(r.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},2004:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(267);function i(e){var t;return null===(t=Object(r.a)(e))||void 0===t?void 0:t.AttachmentPolicy}},2029:function(e,t,n){"use strict";var r,i,o;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(o||(o={}))},2051:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(31),i=n(1991);n.d(t,"b",(function(){return i.a}));var o=new r.c((function(){return n.e(1286).then(n.bind(null,2298))})),u=new r.a(o,(function(e){return e.getAndUpdateAccessToken}))},2070:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"m",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"g",(function(){return l})),n.d(t,"l",(function(){return p})),n.d(t,"k",(function(){return b})),n.d(t,"j",(function(){return v})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"n",(function(){return O}));var r=n(31),i=n(2113);n.d(t,"o",(function(){return i.a})),n.d(t,"p",(function(){return i.b})),n.d(t,"q",(function(){return i.c}));var o=n(2143);n.d(t,"b",(function(){return o.a}));var u=n(2214);n.d(t,"d",(function(){return u.a})),n.d(t,"c",(function(){return u.b}));var c=n(2230);n.d(t,"a",(function(){return c.a}));var a=new r.c((function(){return Promise.all([n.e(4),n.e(21),n.e(42),n.e(77),n.e(539),n.e(352)]).then(n.bind(null,3605))})),s=new r.a(a,(function(e){return e.addAndInitializeAttachments})),d=new r.a(a,(function(e){return e.setPreviewImageUrl})),f=new r.a(a,(function(e){return e.refreshDownloadUrl})),l=new r.a(a,(function(e){return e.createAttachmentInfo})),p=new r.a(a,(function(e){return e.setAttachmentInfo})),b=new r.a(a,(function(e){return e.refreshThumbnailImageUrl})),v=new r.a(a,(function(e){return e.refreshPreviewImageUrl})),h=new r.b(a,(function(e){return e.getAttachment})),m=new r.b(a,(function(e){return e.checkPendingAttachmentOperation})),O=new r.b(a,(function(e){return e.shouldShowImageView}))},2078:function(e,t,n){"use strict";n.d(t,"a",(function(){return ReactEditor})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return a}));var r=n(31),i=new r.c((function(){return Promise.all([n.e(24),n.e(25),n.e(26),n.e(43),n.e(47),n.e(269),n.e(669)]).then(n.bind(null,3002))})),ReactEditor=Object(r.d)(i,(function(e){return e.ReactEditor})),o=new r.b(i,(function(e){return e.setTableHeaderRow})),u=new r.b(i,(function(e){return e.operateContent})),c=new r.b(i,(function(e){return e.focusToEditor}));function a(e){c.import().then((function(t){return t(e)}))}},2099:function(e,t,n){"use strict";var r=n(2293),i=n(2276),o=n(2070),u=n(2212),c=n(2752),a=n(2110);function s(e,t,n,s){if(Object(o.d)(n))return function(e){return 2===Object(u.a)(e)?l():d()}(n);if(3===Object(u.a)(n)&&!s)return f();var p;switch(t){case 2:p={allowEdit:!1,previewMethod:i.a.Image,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 3:p={allowEdit:!1,previewMethod:i.a.NativeView,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 6:p={allowEdit:!1,previewMethod:i.a.GoogleDoc,supportedOpenActions:[r.a.Preview]};break;case 4:p={allowEdit:e.wacEdit,previewMethod:i.a.Wac,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 5:p={allowEdit:!1,previewMethod:i.a.Audio,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 7:p={allowEdit:!1,previewMethod:i.a.PdfJs,supportedOpenActions:[r.a.Preview]};break;case 8:case 9:case 10:p=l();break;case 11:p={allowEdit:!1,previewMethod:i.a.Text,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 12:p={allowEdit:!1,previewMethod:i.a.Video,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 1:p={allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[]};break;case 13:p={allowEdit:!1,previewMethod:i.a.CalendarEvent,supportedOpenActions:[r.a.Preview,r.a.Download]};break;default:p=function(e){return Object(c.a)(e)||Object(a.a)(e)}(n)?f():d()}return p}function d(){return{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[r.a.Download]}}function f(){return{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[r.a.OpenInNewTab]}}function l(){return{allowEdit:!1,previewMethod:i.a.ItemAttachment,supportedOpenActions:[r.a.Preview,r.a.Download]}}var p=n(183),b=Object(p.action)("setIsPlaceholderAttachment")((function(e,t){e.isPlaceholderAttachment=t})),v=Object(p.action)("setThumbnailLoadState")((function(e,t){e.thumbnailLoadState=t}));function h(e,t,n,r,o,u){return void 0===u&&(u=null),{attachmentId:e,thumbnailLoadState:0,previewLoaded:!1,isCloudy:n,isReadOnly:t,isPlaceholderAttachment:r,strategy:{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[]},parentItemId:u,fileType:o}}var m,O=n(19);function g(){return Object(O.a)().SessionSettings.CompanyName}function w(e){return e.supportedOpenActions.length&&e.supportedOpenActions[0]||r.a.NoAction}!function(e){e[e.MailList=0]="MailList",e[e.ReadingPane=1]="ReadingPane",e[e.FilesHub=2]="FilesHub",e[e.PhotoHub=3]="PhotoHub",e[e.GroupFilesHub=4]="GroupFilesHub",e[e.ConversationAttachmentWell=5]="ConversationAttachmentWell",e[e.Deeplink=6]="Deeplink",e[e.FileSuggestion=7]="FileSuggestion",e[e.LinkSuggestion=8]="LinkSuggestion",e[e.ComposeDocLink=9]="ComposeDocLink",e[e.ReadingPaneDocLink=10]="ReadingPaneDocLink",e[e.ConsumerGroupFilesHub=11]="ConsumerGroupFilesHub",e[e.FolderTree=12]="FolderTree"}(m||(m={})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return v})),n.d(t,"d",(function(){return h})),n.d(t,"g",(function(){return g})),n.d(t,"f",(function(){return w})),n.d(t,"b",(function(){return i.a})),n.d(t,"a",(function(){return r.a})),n.d(t,"c",(function(){return m}))},2113:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return u}));var r=n(2),i=Object(r.action)("REFRESH_SHARING_TIPS_FOR_ATTACHMENT",(function(e){return{attachmentId:e}})),o=Object(r.action)("SET_ATTACHMENT_CONTENTID",(function(e,t){return{attachmentId:e,attachmentContentId:t}})),u=Object(r.action)("SET_ATTACHMENT_ISINLINE",(function(e,t){return{attachmentId:e,isInline:t}}))},2140:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(94);function i(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},217:function(e,t,n){"use strict";var r=n(859);n.d(t,"a",(function(){return r.a}))},2179:function(e,t){e.exports=function(e){return e instanceof Date}},2212:function(e,t,n){"use strict";var r=n(2060),i=n(6),o=function(e){return e&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(e)};function u(e){var t=e.__type||e.OwsTypeName;switch(t){case r.a:return 0;case r.e:return e.IsLink?3:1;case r.d:return 3;case r.b:return 2;case r.c:var n=e,u=e.EmbeddedItemClass;return u&&o(u)||Object(i.f)(n.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+t)}}n.d(t,"a",(function(){return u}))},2214:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.AttachmentId)&&i(e.AttachmentId.Id)}function i(e){return e&&-1!==e.indexOf("smime-")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},2230:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"k",(function(){return l})),n.d(t,"l",(function(){return p})),n.d(t,"a",(function(){return b}));var r="Box",i="Dropbox",o="Facebook",u="GDrive",c="Mailbox",a="MailMessage",s="OneDriveConsumer",d="OneDrivePro",f="WopiBox",l="WopiDropbox",p="WopiEgnyte",b={providers:{BOX:r,DROPBOX:i,FACEBOOK:o,GDRIVE:u,MAILBOX:c,ONE_DRIVE_CONSUMER:s,ONE_DRIVE_PRO:d,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:f,WOPI_EGNYTE:p}}},2243:function(e,t,n){var r=n(2179),i=36e5,o=6e4,u=2,c=/[T ]/,a=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],f=/^(\d{4})/,l=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],p=/^-(\d{2})$/,b=/^-?(\d{3})$/,v=/^-?(\d{2})-?(\d{2})$/,h=/^-?W(\d{2})$/,m=/^-?W(\d{2})-?(\d{1})$/,O=/^(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,j=/([Z+-].*)$/,y=/^(Z)$/,A=/^([+-])(\d{2})$/,I=/^([+-])(\d{2}):?(\d{2})$/;function k(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?u:Number(n);var E=function(e){var t,n={},r=e.split(c);a.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var i=j.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),C=function(e,t){var n,r=d[t],i=l[t];if(n=f.exec(e)||i.exec(e)){var o=n[1];return{year:parseInt(o,10),restDateString:e.slice(o.length)}}if(n=s.exec(e)||r.exec(e)){var u=n[1];return{year:100*parseInt(u,10),restDateString:e.slice(u.length)}}return{year:null}}(E.date,n),P=C.year,T=function(e,t){if(null===t)return null;var n,r,i,o;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=p.exec(e))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(t,i),r;if(n=b.exec(e)){r=new Date(0);var u=parseInt(n[1],10);return r.setUTCFullYear(t,0,u),r}if(n=v.exec(e)){r=new Date(0),i=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,i,c),r}if(n=h.exec(e))return o=parseInt(n[1],10)-1,k(t,o);if(n=m.exec(e)){o=parseInt(n[1],10)-1;var a=parseInt(n[2],10)-1;return k(t,o,a)}return null}(C.restDateString,P);if(T){var x,S=T.getTime(),D=0;return E.time&&(D=function(e){var t,n,r;if(t=O.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*i;if(t=g.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*i+r*o;if(t=w.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var u=parseFloat(t[3].replace(",","."));return n%24*i+r*o+1e3*u}return null}(E.time)),E.timezone?x=function(e){var t,n;if(t=y.exec(e))return 0;if(t=A.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=I.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(E.timezone):(x=new Date(S+D).getTimezoneOffset(),x=new Date(S+D+x*o).getTimezoneOffset()),new Date(S+D+x*o)}return new Date(e)}},225:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(572);function i(e,t){return void 0===t&&(t=!0),e&&(t&&Object(r.a)(e)||e.parentNode&&e.parentNode)}},2253:function(e,t,n){"use strict";var r=n(2004);function i(){var e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var o=n(2140),u=n(2110);function c(){return i()}function a(e){return(e&&e.length>0&&function(e){return e.some((function(e){return!((t=e).IsInline&&!Object(u.a)(t));var t}))}(e)?i():[]).map(o.a)}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a}))},2276:function(e,t,n){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),t.a=r},2277:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={})),t.b=r},2293:function(e,t,n){"use strict";var r;!function(e){e[e.NoAction=0]="NoAction",e[e.Preview=1]="Preview",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab"}(r||(r={})),t.a=r},2359:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(2212);function i(e){return u(e.type)}function o(e){return u(Object(r.a)(e))}function u(e){return 1===e||3===e}},2458:function(e){e.exports=JSON.parse('{"a":"Cda"}')},2495:function(e,t,n){"use strict";var r=n(31),i=[0,1],o=n(2505),u=n(2458),c=n(6),a=n(94),s=n(2029);function d(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(c.b)(u.a),messageParts:[Object(c.b)(u.a),f()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(c.b)(o.b),messageParts:[Object(c.b)(o.b),f()],color:s.a.Red};default:return Object(a.a)(e)}}function f(){return{text:Object(c.b)(o.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var l=n(2253),p=n(2140),b=n(1),v=n(24),h=n(2004);function m(){var e=Object(h.a)();if(Object(v.i)("fwk-devTools")){if(Object(v.i)("doc-attachment-CA-readOnlyAccessIssues"))return Object(b.a)(Object(b.a)({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(v.i)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(b.a)(Object(b.a)({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function O(){var e=m();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return w})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return l.a})),n.d(t,"e",(function(){return p.a})),n.d(t,"d",(function(){return O})),n.d(t,"c",(function(){return m}));var g=new r.c((function(){return n.e(1708).then(n.bind(null,18005))})),w=new r.b(g,(function(e){return e.getAccessIssuesForAttachments}))},2505:function(e){e.exports=JSON.parse('{"a":"Ada","b":"Bda"}')},261:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(43),i=n(118),o="__currentId__",u="id__",c=Object(r.a)()||{};void 0===c[o]&&(c[o]=0);var a=!1;function s(e){if(!a){var t=i.b.getInstance();t&&t.onReset&&t.onReset(d),a=!0}var n=c[o]++;return(void 0===e?u:e)+n}function d(e){void 0===e&&(e=0),c[o]=e}},2752:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2060);function i(e){return(e.__type||e.OwsTypeName)===r.d}},287:function(e,t,n){"use strict";var r=n(295),i=n(18);function o(e){return Object(r.resolve)(Object(i.g)(),e)}function u(e){return o("resources/images/"+e)}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}))},320:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(225);function i(e,t,n){void 0===n&&(n=!0);var i=!1;if(e&&t)if(n)if(e===t)i=!0;else for(i=!1;t;){var o=Object(r.a)(t);if(o===e){i=!0;break}t=o}else e.contains&&(i=e.contains(t));return i}},326:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}));var r,i=n(1);function o(e){r=e}function u(){var e,t;return Object(i.c)(this,void 0,void 0,(function(){var n,o;return Object(i.f)(this,(function(i){switch(i.label){case 0:return(o=r)?[4,r()]:[3,2];case 1:o=i.sent(),i.label=2;case 2:if((n=o)&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},375:function(e,t,n){"use strict";n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return b})),n.d(t,"i",(function(){return v})),n.d(t,"c",(function(){return h})),n.d(t,"k",(function(){return m})),n.d(t,"j",(function(){return O})),n.d(t,"o",(function(){return g})),n.d(t,"n",(function(){return w})),n.d(t,"m",(function(){return j})),n.d(t,"l",(function(){return y})),n.d(t,"a",(function(){return A})),n.d(t,"p",(function(){return I})),n.d(t,"b",(function(){return E})),n.d(t,"g",(function(){return C})),n.d(t,"d",(function(){return P}));var r=n(705),i=n(320),o=n(225),u=n(43),c=n(100),a="data-is-focusable",s="data-is-visible",d="data-focuszone-id",f="data-is-sub-focuszone";function l(e,t,n){return O(e,t,!0,!1,!1,n)}function p(e,t,n){return m(e,t,!0,!1,!0,n)}function b(e,t,n,r){return void 0===r&&(r=!0),O(e,t,r,!1,!1,n,!1,!0)}function v(e,t,n,r){return void 0===r&&(r=!0),m(e,t,r,!1,!0,n,!1,!0)}function h(e){var t=O(e,e,!0,!1,!1,!0);return!!t&&(E(t),!0)}function m(e,t,n,r,i,o,u,c){if(!t||!u&&t===e)return null;var a=g(t);if(i&&a&&(o||!j(t)&&!y(t))){var s=m(e,t.lastElementChild,!0,!0,!0,o,u,c);if(s){if(c&&w(s,!0)||!c)return s;var d=m(e,s.previousElementSibling,!0,!0,!0,o,u,c);if(d)return d;for(var f=s.parentElement;f&&f!==t;){var l=m(e,f.previousElementSibling,!0,!0,!0,o,u,c);if(l)return l;f=f.parentElement}}}if(n&&a&&w(t,c))return t;var p=m(e,t.previousElementSibling,!0,!0,!0,o,u,c);return p||(r?null:m(e,t.parentElement,!0,!1,!1,o,u,c))}function O(e,t,n,r,i,o,u,c){if(!t||t===e&&i&&!u)return null;var a=g(t);if(n&&a&&w(t,c))return t;if(!i&&a&&(o||!j(t)&&!y(t))){var s=O(e,t.firstElementChild,!0,!0,!1,o,u,c);if(s)return s}if(t===e)return null;var d=O(e,t.nextElementSibling,!0,!0,!1,o,u,c);return d||(r?null:O(e,t.parentElement,!1,!1,!0,o,u,c))}function g(e){if(!e||!e.getAttribute)return!1;var t=e.getAttribute(s);return null!=t?"true"===t:0!==e.offsetHeight||null!==e.offsetParent||!0===e.isVisible}function w(e,t){if(!e||e.disabled)return!1;var n=0,r=null;e&&e.getAttribute&&(r=e.getAttribute("tabIndex"))&&(n=parseInt(r,10));var i=e.getAttribute?e.getAttribute(a):null,o=null!==r&&n>=0,u=!!e&&"false"!==i&&("A"===e.tagName||"BUTTON"===e.tagName||"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||"true"===i||o);return t?-1!==n&&u:u}function j(e){return!!(e&&e.getAttribute&&e.getAttribute(d))}function y(e){return!(!e||!e.getAttribute||"true"!==e.getAttribute(f))}function A(e){var t=Object(c.a)(e),n=t&&t.activeElement;return!(!n||!Object(i.a)(e,n))}function I(e,t){return"true"!==Object(r.a)(e,t)}var k=void 0;function E(e){if(e){if(k)return void(k=e);k=e;var t=Object(u.a)(e);t&&t.requestAnimationFrame((function(){k&&k.focus(),k=void 0}))}}function C(e,t){for(var n=e,r=0,i=t;r<i.length;r++){var o=i[r],u=n.children[Math.min(o,n.children.length-1)];if(!u)break;n=u}return n=w(n)&&g(n)?n:O(e,n,!0)||m(e,n)}function P(e,t){for(var n=[];t&&e&&t!==e;){var r=Object(o.a)(t,!0);if(null===r)return[];n.unshift(Array.prototype.indexOf.call(r.children,t)),t=r}return n}},378:function(e,t,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(this&&this[r]||r);else if(Array.isArray(r))e.push(i.apply(this,r));else if("object"===o)for(var u in r)n.call(r,u)&&r[u]&&e.push(this&&this[u]||u)}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},381:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return c}));var r=n(0),i=r.createContext({window:"object"==typeof window?window:void 0}),o=function(){return r.useContext(i).window},u=function(){var e;return null===(e=r.useContext(i).window)||void 0===e?void 0:e.document},c=function(e){return r.createElement(i.Provider,{value:e},e.children)}},420:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(225);function i(e,t){return e&&e!==document.body?t(e)?e:i(Object(r.a)(e),t):null}},4567:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c}));var r=n(31),i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(15),n.e(17),n.e(16),n.e(21),n.e(22),n.e(29),n.e(34),n.e(37),n.e(41),n.e(42),n.e(52),n.e(57),n.e(72),n.e(77),n.e(78),n.e(82),n.e(111),n.e(143),n.e(170),n.e(353)]).then(n.bind(null,6776))})),o=new r.a(i,(function(e){return e.prefetchAllWacResources})),u=new r.a(i,(function(e){return e.prefetchWacResourcesForAttachments})),c=new r.a(i,(function(e){return e.prefetchWacResourcesForFiles}))},480:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c}));var r,i=n(66),o=((r={})[i.a.up]=1,r[i.a.down]=1,r[i.a.left]=1,r[i.a.right]=1,r[i.a.home]=1,r[i.a.end]=1,r[i.a.tab]=1,r[i.a.pageUp]=1,r[i.a.pageDown]=1,r);function u(e){return!!o[e]}function c(e){o[e]=1}},483:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r="data-portal-element";function i(e){e.setAttribute(r,"true")}},518:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();n.d(t,"a",(function(){return r}))},532:function(e,t,n){"use strict";function r(e){return e&&!!e._virtual}n.d(t,"a",(function(){return r}))},572:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(532);function i(e){var t;return e&&Object(r.a)(e)&&(t=e._virtual.parent),t}},5760:function(e,t,n){"use strict";var r=n(1),i=n(2),o=Object(i.action)("ON_SHARING_LINK_DETECTED",(function(e,t,n,r,i,o,u,c,a,s){return{linkId:e,linkUrl:t,sharingLinkIds:n,response:r,shouldAddComposeLinkViewState:i,isPreviouslyBeautified:o,source:u,providerType:c,unwrappedUrl:a,creationDateTime:s}})),u=n(4138),c=n(2155),a=n(2860),s=n(4567);Object(i.orchestrator)(o,(function(e){Object(c.c)(e.linkId,e.linkUrl,e.sharingLinkIds,e.response,e.source,e.providerType,e.unwrappedUrl,e.creationDateTime),e.shouldAddComposeLinkViewState&&Object(u.f)(e.linkId)})),Object(i.orchestrator)(o,(function(e){var t,n;(null===(t=e.response)||void 0===t?void 0:t.FileName)&&function(e,t){Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,a.g.import()];case 1:return n.sent()(t)&&s.c.importAndExecute([e]),[2]}}))}))}(null===(n=e.response)||void 0===n?void 0:n.FileName,e.providerType)}));var d=n(121),f=n(1992),l=n(2399),p=n(5);function b(e){var t=!1;if(e){try{var n=Object(p.nc)(e);t=Object(p.Fb)(n,Object(p.h)(Object(p.Rb)(),-10))&&Object(p.Hb)(n,Object(p.Rb)())}catch(e){}Object(d.s)("validlinkCreatedDateTime",{isNewlyCreatedLink:t})}return t}function v(e,t,n,i,o,u,c){return Object(r.c)(this,void 0,void 0,(function(){var s,p,v,h,m,O;return Object(r.f)(this,(function(g){switch(g.label){case 0:return p="",v=function(e){var t,n,i=e.toLowerCase();try{for(var o=Object(r.k)(["onedrive.aspx","onenote.aspx","allitems.aspx","all.aspx","sites"]),u=o.next();!u.done;u=o.next()){var c=u.value;if(-1!==i.indexOf(c))return c}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return"NoErrorExpected"}(e),h=new d.b("GetSharingInformationForLink"),[4,a.g.import()];case 1:m=g.sent(),h.addCustomData({anchorElementsSource:t.toString(),shouldBeautify:n,shouldRehydrate:i,expectedErrorType:v,providerType:o}),g.label=2;case 2:return g.trys.push([2,5,,6]),[4,l.h.import()];case 3:return[4,g.sent()(e,o,b(c))];case 4:return s=g.sent(),[3,6];case 5:return O=g.sent(),p=O.fetchErrorType,s={ResultCode:1},[3,6];case 6:return 0!==s.ResultCode||m(o)&&!s.CanonicalUrl?(0===s.ResultCode&&m(o)&&!s.CanonicalUrl&&(s.ResultCode=1,p="NullCanonicalUrlFromSuccessResponse"),Object(d.s)("GetSharingInformationFailure",{errorType:p,resultCode:s.ResultCode||-1,anchorElementsSource:t.toString(),shouldBeautify:n,shouldRehydrate:i,expectedErrorType:v}),h.addCustomData({errorType:p,resultCode:s.ResultCode||-1,extension:""}),h.endWithError("ServerError")):(h.addCustomData({errorType:"",resultCode:s.ResultCode||-1,extension:Object(f.d)(s.FileName||""),sharingLinkKind:s.SharingLinkKind,linkId:u}),h.end()),[2,s]}}))}))}n.d(t,"a",(function(){return"contenteditable"})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return v})),n.d(t,"d",(function(){return b}))},622:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d}));var r=n(0),i=n(43),o=n(480),u=n(283),c=new WeakMap;function a(e,t){var n,r=c.get(e);return n=r?r+t:1,c.set(e,n),n}function s(e){r.useEffect((function(){var t,n,r=Object(i.a)(null===(t=e)||void 0===t?void 0:t.current);if(r&&!0!==(null===(n=r.FabricConfig)||void 0===n?void 0:n.disableFocusRects)){var o=a(r,1);return o<=1&&(r.addEventListener("mousedown",f,!0),r.addEventListener("pointerdown",l,!0),r.addEventListener("keydown",p,!0)),function(){var e;r&&!0!==(null===(e=r.FabricConfig)||void 0===e?void 0:e.disableFocusRects)&&0===(o=a(r,-1))&&(r.removeEventListener("mousedown",f,!0),r.removeEventListener("pointerdown",l,!0),r.removeEventListener("keydown",p,!0))}}}),[e])}var d=function(e){return s(e.rootRef),null};function f(e){Object(u.b)(!1,e.target)}function l(e){"mouse"!==e.pointerType&&Object(u.b)(!1,e.target)}function p(e){Object(o.b)(e.which)&&Object(u.b)(!0,e.target)}},643:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return v})),n.d(t,"f",(function(){return h}));var r,i=n(100),o=n(464),u=n(43),c=0,a=Object(o.b)({overflow:"hidden !important"}),s="data-is-scrollable",d=function(e,t){if(e){var n=0,r=null;t.on(e,"touchstart",(function(e){1===e.targetTouches.length&&(n=e.targetTouches[0].clientY)}),{passive:!1}),t.on(e,"touchmove",(function(e){if(1===e.targetTouches.length&&(e.stopPropagation(),r)){var t=e.targetTouches[0].clientY-n,i=h(e.target);i&&(r=i),0===r.scrollTop&&t>0&&e.preventDefault(),r.scrollHeight-Math.ceil(r.scrollTop)<=r.clientHeight&&t<0&&e.preventDefault()}}),{passive:!1}),r=e}},f=function(e,t){if(e){t.on(e,"touchmove",(function(e){e.stopPropagation()}),{passive:!1})}},l=function(e){e.preventDefault()};function p(){var e=Object(i.a)();e&&e.body&&!c&&(e.body.classList.add(a),e.body.addEventListener("touchmove",l,{passive:!1,capture:!1})),c++}function b(){if(c>0){var e=Object(i.a)();e&&e.body&&1===c&&(e.body.classList.remove(a),e.body.removeEventListener("touchmove",l)),c--}}function v(){if(void 0===r){var e=document.createElement("div");e.style.setProperty("width","100px"),e.style.setProperty("height","100px"),e.style.setProperty("overflow","scroll"),e.style.setProperty("position","absolute"),e.style.setProperty("top","-9999px"),document.body.appendChild(e),r=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return r}function h(e){for(var t=e,n=Object(i.a)(e);t&&t!==n.body;){if("true"===t.getAttribute(s))return t;t=t.parentElement}for(t=e;t&&t!==n.body;){if("false"!==t.getAttribute(s)){var r=getComputedStyle(t),o=r?r.getPropertyValue("overflow-y"):"";if(o&&("scroll"===o||"auto"===o))return t}t=t.parentElement}return t&&t!==n.body||(t=Object(u.a)(e)),t}},6767:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n(2889),o=n(2277),u=n(2399);function c(e,t,n,c){return Object(r.c)(this,void 0,void 0,(function(){var a,s,d,f;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,u.e.import()];case 1:return a=r.sent(),s=a(t,!c),d=[],s.some((function(e){return e.recipient.expansionStatus===o.a.None}))?(Object(i.b)(e,s,n,c),[2,[!1,d]]):(f=s.filter((function(e){return e.recipient.expansionStatus===o.a.SucceededWithoutDLOrGroupMembers}))).length!==s.length?[2,[!1,d]]:(f.forEach((function(e){e.recipient.members.forEach((function(e){d.push(e)}))})),[2,[!0,d]])}}))}))}function a(e,t,n,i){return Object(r.c)(this,void 0,void 0,(function(){var o,a,s,d,f,l;return Object(r.f)(this,(function(p){switch(p.label){case 0:return[4,u.k.import()];case 1:return o=p.sent(),[4,u.m.import()];case 2:return a=p.sent(),o(t)||a(t)?[2,[]]:[4,c(e,t,n,i)];case 3:return s=r.g.apply(void 0,[p.sent(),2]),d=s[0],f=s[1],d?[4,u.g.import()]:[2,[]];case 4:return l=p.sent(),l(t).forEach((function(e){f.push({emailAddress:e.recipient.persona.EmailAddress.EmailAddress,displayName:e.recipient.persona.EmailAddress.Name,personaTypeString:null})})),[2,f]}}))}))}var s=n(2155);function d(e){var t=Object(s.k)(e),n=Object(s.l)(e);return n&&0===n.providerType&&t&&t.sharingInfo.getSharingInfoSucceeded&&(0===t.currentPermissionLevel||2===t.currentPermissionLevel||1===t.currentPermissionLevel)}var f=n(121),l=n(5760),p=n(6),b=n(23),v=n(2518),h=n(24),m=n(2774),O=n(295);function g(e,t,n){var i;return Object(r.c)(this,void 0,void 0,(function(){var o,u,c,a,s,d,l;return Object(r.f)(this,(function(r){switch(r.label){case 0:o=function(e){return Object(p.c)("https://{0}/{1}/{2}/permission/checkAccess",Object(O.parse)(e).hostname,Object(m.r)(0),Object(v.g)(e))}(e),u=function(e){return JSON.stringify((t=e,{recipients:t.map((function(e){return{alias:e.emailAddress}}))}));var t}(t),c={method:v.d,mode:v.a,body:u,datapointNamePrefix:"checkRecipientPermission"},a=Object(h.i)("doc-link-cogs"),s={Application:"Outlook_Web",Scenario:"ShareFile",ScenarioType:"PO"},a&&(n||(Object(f.s)("CheckAccessWithReadOnlyHeader"),s.Prefer="eventualconsistencyreadonly")),r.label=1;case 1:return r.trys.push([1,3,,7]),[4,Object(v.f)(0,o,e,c,s)];case 2:return l=r.sent(),[2,JSON.parse(l).value];case 3:return d=r.sent(),!a||n||404!==(null===(i=JSON.parse(d))||void 0===i?void 0:i.responseStatus)?[3,5]:(Object(f.s)("CheckAccessRetryOnNotFound"),[4,Object(v.f)(0,o,e,c,null)]);case 4:return l=r.sent(),[2,JSON.parse(l).value];case 5:throw d;case 6:return[3,7];case 7:return[2]}}))}))}var w=n(2),j=Object(w.action)("startCheckPerm",(function(e){return{composeId:e}})),y=Object(w.action)("finishCheckPerm",(function(e){return{composeId:e}})),A=Object(w.action)("addCheckPerm",(function(e){return{composeId:e}})),I=Object(w.action)("removeCheckPerm",(function(e){return{composeId:e}})),k=Object(w.action)("updateCheckPermCount ",(function(e,t){return{composeId:e,offset:t}})),E=30,C=23;function P(e,t,n,i){return Object(r.c)(this,void 0,void 0,(function(){var o,u,c,a,v,h,m,O;return Object(r.f)(this,(function(w){switch(w.label){case 0:return e.length>0?(b.g.info(Object(p.c)("RecipientPermission: LinkId:{0}, add {1} recipients",t,e.length)),o=null,[4,s.q.import()]):[3,10];case 1:if(u=w.sent(),!d(t))return[2,!1];u(t,e),c=Object(s.l)(t),j(i),(a=new f.b("LinkCheckPerms")).addCustomData({RecipientCount:e.length}),w.label=2;case 2:w.trys.push([2,8,9,10]),v=0,w.label=3;case 3:return v<e.length/E?(o=e.slice(v*E,(v+1)*E),d(t)?[4,g(n,o,Object(l.d)(c.creationDateTime))]:(a.addCustomData({permissionChangedSoCheckPermStoped:!0}),a.end(),a=null,[2,!1])):[3,7];case 4:return h=w.sent(),m=h.filter((function(e){return!e.hasAccess})).length,[4,s.y.import()];case 5:w.sent()(t,h),a.addCustomData({countOfRecipientsWhoCannotAccess:Math.min(m,C)}),b.g.info(Object(p.c)("RecipientPermission: checkAccess for {0} recipients succeeded",h.length)),w.label=6;case 6:return v++,[3,3];case 7:return[3,10];case 8:return O=w.sent(),function(e,t,n){Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(n){switch(n.label){case 0:return b.g.info(Object(p.c)("RecipientPermission: checkAccess for {0} recipients failed",t.length)),[4,s.w.import()];case 1:return n.sent()(e,t),[2]}}))}))}(t,o||e,O.message),a.endWithError(O.message),a=null,[2,!1];case 9:return null==a||a.end(),y(i),[7];case 10:return[2,!0]}}))}))}function T(e,t,n){return Object(r.c)(this,void 0,void 0,(function(){var i,o,c;return Object(r.f)(this,(function(a){switch(a.label){case 0:return(i=Object(s.l)(e))&&d(e)?(o=i.unwrappedUrl?i.unwrappedUrl:i.url,[4,u.j.import()]):[2];case 1:return c=a.sent(),function(e,t,n){Object(r.c)(this,void 0,void 0,(function(){var i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return(i=e.filter((function(e){return!x(e.emailAddress,t)}))).length>0?(b.g.info(Object(p.c)("RecipientPermission: LinkId:{0}, remove {1} recipients ",n,i.length)),[4,s.u.import()]):[3,2];case 1:r.sent()(n,i),r.label=2;case 2:return[2]}}))}))}(i.sharingRecipientsInfo.recipientPermissionInfos,t,e),c(i.sharingRecipientsInfo)?[2]:[4,P(function(e,t){var n=t.filter((function(t){return!x(t.emailAddress,e)})),r=[];return n.forEach((function(e){r.push({emailAddress:e.emailAddress,name:e.displayName,getPermissionInfoStatus:u.a.InProgress,hasAccess:!1})})),r}(i.sharingRecipientsInfo.recipientPermissionInfos,t),e,o,n)];case 2:return a.sent(),[2]}}))}))}function x(e,t){return t.some((function(t){return t.emailAddress===e}))}function S(e){return e.some((function(e){return d(e)}))}Object(w.orchestrator)(i.d,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n;return Object(r.f)(this,(function(r){switch(r.label){case 0:return S(e.linkIds)?(b.g.info("RecipientPermission: tryCheckPermForLinks"),[4,a(e.linkIds,e.recipientInfos,e.composeId,e.isCalendar)]):[2];case 1:t=r.sent(),n=0,r.label=2;case 2:return n<e.linkIds.length?[4,T(e.linkIds[n],t,e.composeId)]:[3,5];case 3:r.sent(),r.label=4;case 4:return n++,[3,2];case 5:return[2]}}))}))}));var D=n(7531),R=n(31),N=new R.c((function(){return n.e(995).then(n.bind(null,18558))})),L=new R.a(N,(function(e){return e.setMembersToRecipientViewState})),M=new R.a(N,(function(e){return e.setRecipientExpansionStatus})),F=n(7118);function _(e){var t,n,i;return Object(r.c)(this,void 0,void 0,(function(){var u,c,a,s,d,l,p,v,h,m,O,g,w;return Object(r.f)(this,(function(r){switch(r.label){case 0:return b.g.info("RecipientPermission: expandAndSetRecipientViewState"),[4,D.b.import()];case 1:return u=r.sent(),[4,M.import()];case 2:return c=r.sent(),a=e.recipient.persona,s=a.EmailAddress,d=a.ADObjectId,l=a.PersonaId,null!==(null===(t=a.PersonaId)||void 0===t?void 0:t.Id)?[3,4]:[4,Object(F.a)(null===(n=a.EmailAddress)||void 0===n?void 0:n.EmailAddress)];case 3:if(!(p=r.sent()))return b.d("Failed to get persona by Email Address. persona has email address:"+!!(null===(i=a.EmailAddress)||void 0===i?void 0:i.EmailAddress.toString())),c(e.recipient,o.a.Failed),[2];d=p.ADObjectId,l=p.PersonaId,s=p.EmailAddress,r.label=4;case 4:v={EmailAddress:s.EmailAddress,Name:s.Name,MailboxType:s.MailboxType,RoutingType:s.RoutingType},r.label=5;case 5:return r.trys.push([5,9,,10]),c(e.recipient,o.a.InProgress),[4,u(l,d,v,100,!0)];case 6:return(null==(h=r.sent())?void 0:h.Members)?(m=!1,O=[],h.Members.forEach((function(e){var t;switch(e.PersonaTypeString){case"DistributionList":case"ImplicitGroup":case"ExplicitGroup":case"ModernGroup":m=!0,t={emailAddress:e.EmailAddress.EmailAddress,displayName:e.DisplayName,personaTypeString:e.PersonaTypeString};break;case"Person":case"Guest":t={emailAddress:e.EmailAddress.EmailAddress,displayName:e.DisplayName,personaTypeString:e.PersonaTypeString};break;default:b.d("RecipientExpansionIgnoredPersonaType: "+e.PersonaTypeString)}t&&O.push(t)})),[4,L.import()]):[3,8];case 7:return g=r.sent(),Object(f.s)("SmallDLExpansionSucceess",[m]),c(e.recipient,m?o.a.SucceededWithDLOrGroupMembers:o.a.SucceededWithoutDLOrGroupMembers),g(e.recipient,O),[2];case 8:return[3,10];case 9:return w=r.sent(),Object(f.s)("SmallDLExpansionFailure",[w.message]),[3,10];case 10:return c(e.recipient,o.a.Failed),[2]}}))}))}Object(w.orchestrator)(i.b,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n,c,a;return Object(r.f)(this,(function(r){switch(r.label){case 0:return S(e.linkIds)?[4,u.e.import()]:[2];case 1:t=r.sent(),n=t(e.recipientInfos,!e.isCalendar),c=n.filter((function(e){return e.recipient.expansionStatus===o.b.None})),a=0,r.label=2;case 2:return a<c.length?[4,_(c[a])]:[3,5];case 3:r.sent(),r.label=4;case 4:return a++,[3,2];case 5:return Object(i.d)(e.linkIds,e.recipientInfos,e.composeId,e.isCalendar),[2]}}))}))})),Object(w.orchestrator)(i.e,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return d(e.linkId)?(b.g.info("RecipientPermission: tryCheckPermForOneLink"),[4,s.s.import()]):[2];case 1:return t=r.sent(),n=t(e.recipientContainers,e.fromAddress),[4,a([e.linkId],n,e.composeId,e.isCalendar)];case 2:return 0===(i=r.sent()).length?[2]:[4,T(e.linkId,i,e.composeId)];case 3:return r.sent(),[2]}}))}))}));var W=n(3572);Object(w.orchestrator)(i.a,(function(e){Object(W.a)(e.composeId)&&Object(f.s)("checkPermPendingWhenSend")})),Object(w.orchestrator)(s.A,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return d(e.linkId)?[4,s.v.import()]:[2];case 1:return n.sent()(e.linkId),[4,a([e.linkId],e.recipientInfos,e.composeId,e.isCalendar)];case 2:return 0===(t=n.sent()).length?[2]:[4,T(e.linkId,t,e.composeId)];case 3:return n.sent(),[2]}}))}))}));var G=n(4087);Object(w.orchestrator)(y,(function(e){var t=Object(G.a)(e.composeId);t?t.pendingCheckPermCount>1?k(e.composeId,-1):I(e.composeId):b.d("Finish check perm while tracker has not logged start. ")})),Object(w.orchestrator)(j,(function(e){Object(G.a)(e.composeId)?k(e.composeId,1):A(e.composeId)})),Object(w.orchestrator)(i.c,(function(e){k(e.composeId,-1)}));var U=n(4262);Object(w.mutator)(A,(function(e){Object(U.a)().permissionCheckers.set(e.composeId,{pendingCheckPermCount:1})})),Object(w.mutator)(I,(function(e){Object(U.a)().permissionCheckers.delete(e.composeId)})),Object(w.mutator)(k,(function(e){var t=Object(G.a)(e.composeId);t&&(t.pendingCheckPermCount=t.pendingCheckPermCount+e.offset)})),n.d(t,"tryCheckPermForLinks",(function(){return i.d})),n.d(t,"tryCheckPermForOneLink",(function(){return i.e})),n.d(t,"expandGroupsAndSmallDLs",(function(){return i.b})),n.d(t,"onRemoveLink",(function(){return i.c}))},705:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(420);function i(e,t){var n=Object(r.a)(e,(function(e){return e.hasAttribute(t)}));return n&&n.getAttribute(t)}},7118:function(e,t,n){"use strict";var r=n(1313);n.d(t,"b",(function(){return r.b}));var i=n(1316);n.d(t,"a",(function(){return i.a}))},7531:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var r=n(31),i=new r.c((function(){return Promise.all([n.e(66),n.e(990)]).then(n.bind(null,10206))})),o=new r.a(i,(function(e){return e.findReadWriteRecipient})),u=new r.b(i,(function(e){return e.getGroupInfo}))},859:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},869:function(e,t,n){"use strict";var r=n(31),i={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return i}));var o=new r.c((function(){return Promise.all([n.e(4),n.e(21),n.e(739)]).then(n.bind(null,18223))})),u=new r.a(o,(function(e){return e.subscribe})),c=new r.a(o,(function(e){return e.unsubscribe})),a=new r.b(o,(function(e){return e.getChannelId})),s=new r.a(o,(function(e){return e.getChannelReady})),d=new r.a(o,(function(e){return e.setup})),f=new r.a(o,(function(e){return e.handleNotification})),l=new r.a(o,(function(e){return e.initializeNotificationManager})),p=new r.b(o,(function(e){return e.getNotificationEmitter}))},883:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(56);function i(e,t){for(var n=Object(r.a)({},t),i=0,o=Object.keys(e);i<o.length;i++){var u=o[i];void 0===n[u]&&(n[u]=e[u])}return n}},981:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"ItemResponseShape:#Exchange"},e)}},996:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(33),i=n(1265);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("GetPersona",e,t)}},997:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"GetPersonaRequest:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.MailBoot~RecipientPermissionChecker.js.map
self.scriptsLoaded['owa.MailBoot~RecipientPermissionChecker.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~RecipientPermissionChecker.js'] = (new Date()).getTime();