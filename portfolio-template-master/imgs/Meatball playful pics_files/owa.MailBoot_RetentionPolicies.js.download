self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~RetentionPolicies.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[798],{14106:function(e){e.exports=JSON.parse('{"a":"b6b"}')},14107:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,"._2Ij1xLT_HLp88M37zkVcqx{font-weight:600}html[dir] ._23f4dMU1_LGLt4GgPo3Lk9 .ms-ContextualMenu-header{padding:0 4px}._2XmjPcdNPHzJnErHgc7pg8{font-weight:700}",""]),t.locals={checkedItem:"_2Ij1xLT_HLp88M37zkVcqx",sectionHeader:"_23f4dMU1_LGLt4GgPo3Lk9",checkmark:"_2XmjPcdNPHzJnErHgc7pg8"}},14108:function(e){e.exports=JSON.parse('{"a":"c6b","b":"d6b","c":"e6b"}')},14109:function(e){e.exports=JSON.parse('{"a":"a6b"}')},2015:function(e,t,n){"use strict";var r=n(1),i=n(14),c=n(2),a=n(3078);function o(e){return Math.floor(Math.random()*e+1)}var u=n(3079);n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return b}));var s=4,l=8,d={toDate:null,fromDate:null,includeAttachments:!1,initialSearchScope:null,isSearchHistoryDirty:!1,isAnswerInitialized:!1,isAnswerLocalizationCompleted:!1,isUnread:!1,isToMe:!1,isFlagged:!1,isMentioned:!1,previousNode:null,searchNumber:0,staticSearchScope:null,staticSearchScopeList:null,shouldShowAdvancedSearch:!1,advancedSearchViewState:Object(a.a)(),initialAdvancedSearchViewState:Object(a.a)(),legacySuggestions:new i.ObservableMap({}),recipientForPersonalizedGhostTextIndex:o(u.a-1),generalizedGhostTextBankIndex:o(s-1),personalizedGhostTextBankIndex:o(l-1),usePersonalGhostText:!1,isAnswerAvailable:!1},f=Object(r.a)({},d),b=Object(c.createStore)("mailSearchStore",f),v=b();t.c=v},2157:function(e,t,n){"use strict";var r,i,c;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.File=3]="File",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.Setting=8]="Setting"}(r||(r={})),function(e){e.ODSPFile="ODSP file",e.CloudyAttachment="Cloudy attachment",e.ClassicAttachment="Classic attachment",e.LinkAttachment="Link attachment",e.Unknown="Unknown"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Checking=1]="Checking",e[e.NotSupported=2]="NotSupported",e[e.Supported=3]="Supported"}(c||(c={}))},2239:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"Message:#Exchange"},e)}},2252:function(e,t,n){"use strict";var r=n(31),i=n(2651),c=n(2015),a=n(2126);function o(e){var t=e.tableQuery;return 0===t.type?t.folderId:function(e){if(1!=e.type)return!1;var t=e.searchScope;return["PrimaryMailbox","ArchiveMailbox","SharedFolders"].indexOf(t.kind)>-1}(t)?t.searchScope.folderId:null}var u=n(2599),s=n(2652),l=n(2600),d=n(2653),f=n(2064);n.d(t,"a",(function(){return v})),n.d(t,"n",(function(){return h})),n.d(t,"c",(function(){return i.b})),n.d(t,"r",(function(){return c.c})),n.d(t,"i",(function(){return c.e})),n.d(t,"f",(function(){return a.a})),n.d(t,"t",(function(){return a.f})),n.d(t,"s",(function(){return a.e})),n.d(t,"g",(function(){return o})),n.d(t,"j",(function(){return u.a})),n.d(t,"k",(function(){return s.a})),n.d(t,"h",(function(){return l.a})),n.d(t,"l",(function(){return d.a})),n.d(t,"o",(function(){return f.j})),n.d(t,"e",(function(){return f.d})),n.d(t,"d",(function(){return f.c})),n.d(t,"b",(function(){return f.b})),n.d(t,"p",(function(){return f.k})),n.d(t,"q",(function(){return f.m})),n.d(t,"m",(function(){return f.h}));var b=new r.c((function(){return Promise.all([n.e(4),n.e(6),n.e(7),n.e(8),n.e(10),n.e(13),n.e(14),n.e(15),n.e(17),n.e(16),n.e(18),n.e(21),n.e(19),n.e(22),n.e(23),n.e(24),n.e(27),n.e(28),n.e(30),n.e(31),n.e(33),n.e(40),n.e(42),n.e(48),n.e(933)]).then(n.bind(null,4341))})),v=Object(r.d)(b,(function(e){return e.AnswersContainer})),h=new r.a(b,(function(e){return e.initializeAndWarmupAnswers}))},2318:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);function i(){return Object(r.a)().SessionSettings.IsSubstrateSearchServiceAvailable}},2389:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"ItemChange:#Exchange"},e)}},2421:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"SetItemField:#Exchange"},e)}},2532:function(e,t,n){"use strict";var r=n(33),i=n(1);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.a)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return c}))},2539:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"UpdateItemRequest:#Exchange"},e)}},2556:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);function i(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},2599:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(24),i=n(2318),c=n(455);function a(){return Object(i.a)()&&(Object(r.i)("sea-fetchPeople2")||Object(r.i)("sea-fetchEvents2")||Object(r.i)("sea-calendarTriggerControl2")||Object(r.i)("sea-fetchFlights2")||Object(r.i)("sea-flightTriggerControl2")||Object(r.i)("sea-fetchFiles4")||Object(r.i)("sea-fileTriggerControl4")||Object(r.i)("sea-peopleTriggerControl2"))||Object(i.a)()&&Object(c.a)()&&(Object(r.i)("sea-fetchBookmarks2")||Object(r.i)("sea-bookmarkTriggerControl2")||Object(r.i)("sea-fetchAcronyms2")||Object(r.i)("sea-fetchLinks2")||Object(r.i)("sea-linkTriggerControl2")||Object(r.i)("sea-acronymTriggerControl2"))}},2600:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2015),i=n(24),c=n(2318),a=n(57);function o(){var e=Object(r.e)().staticSearchScope,t=null==e?void 0:e.kind;return Object(a.h)().SessionSettings.IsExplicitLogon?"ArchiveMailbox"===t?3:Object(i.i)("sea-3s-explicitLogon")&&Object(c.a)()?0:2:"PrimaryMailbox"===t?Object(c.a)()?Object(i.i)("sea-v23sQueryApi")?1:0:2:"ArchiveMailbox"===t?Object(i.i)("sea-archive-mailbox-3S")&&Object(c.a)()?0:2:"Group"===t?2:"SharedFolders"===t?3:null}},2651:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r=n(2157),i=[r.c.File,r.c.People,r.c.Keywords],c=[r.c.File,r.c.People,r.c.Keywords,r.c.Message,r.c.Event,r.c.Category,r.c.TrySuggestion,r.c.Setting]},2652:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(24);function i(){return Object(r.i)("sea-interactiveFiltersAll")||Object(r.i)("sea-interactiveFiltersUnreadTime")}},2653:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3032),i=n(3033),c=n(2015);function a(e){return Object(i.a)()||Object(r.a)()||Object(c.e)().isUnread||Object(c.e)().isToMe||Object(c.e)().isFlagged||Object(c.e)().isMentioned||!!(null==e?void 0:e.viewFilter)&&"All"!==(null==e?void 0:e.viewFilter)}},3032:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2015);function i(){return null!==Object(r.e)().fromDate||null!==Object(r.e)().toDate}},3033:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2015);function i(){return Object(r.e)().includeAttachments}},3078:function(e,t,n){"use strict";function r(){return{selectedSearchScope:null,subjectFieldText:"",keywordsFieldText:"",fromDate:null,toDate:null,hasAttachments:null,fromPeopleSuggestions:[],toPeopleSuggestions:[],ccPeopleSuggestions:[]}}n.d(t,"a",(function(){return r}))},3079:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=10},3106:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"ApplyConversationActionRequest:#Exchange"},e)}},3107:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"ConversationAction:#Exchange"},e)}},3138:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"DeleteItemField:#Exchange"},e)}},3223:function(e,t,n){"use strict";var r=n(33),i=n(1);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.a)({__type:"ApplyConversationActionJsonRequest:#Exchange"},n)),Object(r.a)("ApplyConversationAction",e,t)}n.d(t,"a",(function(){return c}))},3581:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"SetFolderField:#Exchange"},e)}},3805:function(e){e.exports=JSON.parse('{"a":"DJa"}')},419:function(e,t,n){"use strict";var r=n(1);function i(e,t){return e?Object(r.a)({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return i}))},4308:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"Folder:#Exchange"},e)}},6765:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n(2),c=Object(i.action)("ON_ARCHIVE_TAG_FOR_FOLDER_CHANGED",(function(e,t,n){return{folder:e,tagValue:t,actionSource:n}})),a=Object(i.action)("ON_DELETE_TAG_FOR_FOLDER_CHANGED",(function(e,t,n){return{folder:e,tagValue:t,actionSource:n}})),o=Object(i.action)("ON_ARCHIVE_TAG_FOR_FOLDER_UPDATE_SUCCESS",(function(e,t){return{folder:e,archiveTag:t}})),u=Object(i.action)("ON_DELETE_TAG_FOR_FOLDER_UPDATE_SUCCESS",(function(e,t){return{folder:e,deleteTag:t}})),s=Object(i.action)("ON_RETENTION_TAG_FOR_ITEMS_UPDATE_SUCCESS",(function(e,t,n){return{tag:e,isArchiveTag:t,itemIds:n}})),l=Object(i.action)("ON_RETENTION_TAG_FOR_ITEMS_CHANGED",(function(e,t,n,r,i){return{isArchiveTag:e,tagValue:t,itemIds:n,actionSource:r,mailboxInfo:i}})),d=Object(i.action)("ON_RETENTION_TAG_FOR_CONVERSATIONS_CHANGED",(function(e,t,n,r,i,c,a){return{isArchiveTag:e,tagValue:t,folderId:n,conversationActionContexts:r,itemIds:i,actionSource:c,mailboxInfo:a}})),f=n(1951),b=n(3581);var v=n(979),h=n(4308),g="ArchivePolicyParentRow",p="DeletePolicyParentRow",O="FolderArchiveTag",j=n(2013);function y(e,t,n){var i,c=Object(f.r)(e),a={Path:Object(v.a)({FieldURI:t}),Folder:n?t===O?Object(h.a)({ArchiveTag:n}):Object(h.a)({PolicyTag:n}):null},o=[n?Object(b.a)(a):(i=a,Object(r.a)({__type:"DeleteFolderField:#Exchange"},i))];return f.M.importAndExecute(c.Id,o,Object(j.c)(e))}var I=n(23),T=n(121);function m(e){var t=e.isArchiveTag,n=e.actionSource,r=e.responseClass;Object(T.s)("TnS_RetentionPolicySelected",[t,n,r])}function S(e){var t=e.folder,n=e.retentionId,r=e.inheritSubMenuIdentifier,i=r===g?t.ArchiveTag:t.PolicyTag;return!!i&&n!=i.Value||!i&&n!=r}Object(i.orchestrator)(c,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n,i,c,a,u;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(t=e.folder,n=e.tagValue,i=e.actionSource,!S({folder:t,retentionId:n,inheritSubMenuIdentifier:g}))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),c=n===g?null:{Value:n,IsExplicit:!0},[4,y(t.DistinguishedFolderId||t.FolderId.Id,O,c)];case 2:return"Success"===(a=r.sent()).ResponseClass&&o(t,c),m({isArchiveTag:!0,actionSource:i,responseClass:a.ResponseClass}),[3,4];case 3:return u=r.sent(),I.d("Error while updating folder archive tag"+u),[3,4];case 4:return[2]}}))}))})),Object(i.orchestrator)(a,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n,i,c,a,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(t=e.folder,n=e.tagValue,i=e.actionSource,!S({folder:t,retentionId:n,inheritSubMenuIdentifier:p}))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),c=n===p?null:{Value:n,IsExplicit:!0},[4,y(t.DistinguishedFolderId||t.FolderId.Id,"FolderPolicyTag",c)];case 2:return"Success"===(a=r.sent()).ResponseClass&&u(t,c),m({isArchiveTag:!1,actionSource:i,responseClass:a.ResponseClass}),[3,4];case 3:return o=r.sent(),I.d("Error while updating folder delete tag"+o),[3,4];case 4:return[2]}}))}))}));var A=n(2389),C=n(439),P=n(2532),k=n(2539),_=n(180),x=n(2239),E=n(2421),R=n(3138),F=n(2556);function w(e,t,n,i){var c=function(e,t,n){var i,c=t?"ItemArchiveTag":"ItemPolicyTag",a=t?"ArchiveTag":"PolicyTag",o=[n?Object(E.a)({Path:Object(v.a)({FieldURI:c}),Item:Object(x.a)((i={},i[a]=n,i))}):Object(R.a)({Path:Object(v.a)({FieldURI:c})})],u=[];return e.forEach((function(e){return u.push(Object(A.a)({Updates:o,ItemId:Object(C.a)({Id:e})}))})),Object(k.a)(Object(r.a)({ItemChanges:u,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly",SuppressReadReceipts:!1,ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone"},Object(F.a)()))}(e,t,n);return Object(P.a)({Header:Object(_.b)(),Body:c},i).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var M=n(419),N=(Object(i.orchestrator)(l,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n,i,c,a,o,u,l;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=e.isArchiveTag,n=e.tagValue,i=e.itemIds,c=e.actionSource,a=e.mailboxInfo,[4,w(i,t,o=n===g||n===p?null:{Value:n,IsExplicit:!0},Object(M.a)(a))];case 1:return"Success"==(u=r.sent()).ResponseClass&&s(o,t,i),m({isArchiveTag:t,actionSource:c,responseClass:u.ResponseClass}),[3,3];case 2:return l=r.sent(),I.d("Error while updating item retention tag "+l),[3,3];case 3:return[2]}}))}))})),n(3106)),D=n(3107),L=n(984),V=n(871),U=n(613),G=n(8186),H=n(1244);function B(e,t,n,r,i){var c=function(e,t,n,r){var i=e.map((function(e){return function(e,t,n,r){var i=Object(D.a)({Action:"SetRetentionPolicy",ConversationId:Object(C.a)({Id:e.conversationId}),RetentionPolicyType:n});t&&(i.RetentionPolicyTagId=t);if(r){var c=Object(L.a)({BaseFolderId:(a=r,Object(H.a)(a)?Object(V.a)({Id:a}):Object(U.a)({Id:a}))});i.ContextFolderId=c}var a;return i}(e,t,n,r)}));return Object(N.a)({ConversationActions:i,ReturnMovedItemIds:!1})}(e,t,n,r);return Object(G.a)(c)}Object(i.orchestrator)(d,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var t,n,i,c,a,o,u,l,d,f;return Object(r.f)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=e.isArchiveTag,n=e.tagValue,i=e.folderId,c=e.conversationActionContexts,a=e.itemIds,o=e.actionSource,u=e.mailboxInfo,[4,B(c,(l=n===g||n===p)?null:n,t?1:0,i,Object(M.a)(u))];case 1:return"Success"==(d=r.sent()).ResponseClass&&s(l?null:{Value:n,IsExplicit:!0},t,a),m({isArchiveTag:t,actionSource:o,responseClass:d.ResponseClass}),[3,3];case 2:return f=r.sent(),I.d("Error while updating conversation retention tag"+f),[3,3];case 3:return[2]}}))}))}));Object(i.mutator)(o,(function(e){var t=e.folder,n=e.archiveTag;t.ArchiveTag=n})),Object(i.mutator)(u,(function(e){var t=e.folder,n=e.deleteTag;t.PolicyTag=n}));var z=n(1956);Object(i.mutator)(s,(function(e){var t=e.itemIds,n=e.tag,r=e.isArchiveTag;t.forEach((function(e){var t=z.u.items.get(e);t&&(r?t.ArchiveTag=n:t.PolicyTag=n)}))}));var J=n(2027),q=n(1947);var Q=n(14106),K=n(6),X=n(143),W=n(9524);function $(e){var t=e.retentionId,n=e.displayName,r=e.isChecked,i=e.subMenuProps;return{key:t,text:n,data:t,onClick:e.onClickCallback,checked:r,itemProps:r?{styles:{label:W.checkedItem}}:null,iconProps:r?{iconName:"CheckMark",className:W.checkmark}:null,subMenuProps:i}}var Y=n(14108);function Z(e){var t=e.retentionId,n=e.retentionPolicyTags,r=e.folderType,i=e.isArchive,c=e.isChecked,a=e.onClickCallback,o=function(e,t){return 12==e?t?Object(K.b)(Y.a):Object(K.b)(Y.b):Object(K.b)(Y.c)}(r,i);return $({retentionId:t,displayName:17!=r?function(e){var t=e.retentionPolicyTags,n=e.folderType,r=e.isArchive,i=e.defaultName;return t.reduce((function(e,t){return t.Type===n&&t.IsArchive==r?t.DisplayName:e}),i)}({retentionPolicyTags:n,folderType:r,isArchive:i,defaultName:o}):o,isChecked:c,subMenuProps:null,onClickCallback:a})}var ee=n(9524);function te(e,t,n,r,i){var c=!1;return(12==r?[]:e.map((function(e){var r=e.RetentionId===n;return r&&(c=!0),$({retentionId:e.RetentionId,displayName:e.DisplayName,isChecked:t&&r,subMenuProps:null,onClickCallback:i})}))).concat(Z({retentionId:g,retentionPolicyTags:e,folderType:r,isArchive:!0,isChecked:t&&!c,onClickCallback:i}))}var ne=n(14109);var re=n(9524);function ie(e,t,n,r,i,c){var a=!1;return(17!=r||"archive"===i?[]:function(e){var t={},n=e.filter((function(e){return null==e.ParentLabelIdentity||e.ParentLabelIdentity.length<=0})).reduce((function(e,n){var r={parentPolicyTag:n,childrenPolicyTags:[]};return e.push(r),t[n.RetentionId]=r,e}),[]);return e.filter((function(e){return null!=e.ParentLabelIdentity&&e.ParentLabelIdentity.length>0&&e.ParentLabelIdentity in t})).forEach((function(e){t[e.ParentLabelIdentity].childrenPolicyTags.push(e)})),n}(e).map((function(e){var r=function(e,t,n,r){var i=e.parentPolicyTag,c=e.childrenPolicyTags,a=i.RetentionId===n;if(null==c||0==c.length)return{item:$({retentionId:i.RetentionId,displayName:i.DisplayName,isChecked:t&&a,subMenuProps:null,onClickCallback:r}),policyFound:a};var o=!1,u=c.map((function(e){var i=e.RetentionId===n;return i&&(o=!0),$({retentionId:e.RetentionId,displayName:e.DisplayName,isChecked:t&&i,subMenuProps:null,onClickCallback:r})}));return{item:$({retentionId:i.RetentionId,displayName:i.DisplayName,isChecked:t&&a,subMenuProps:{items:u},onClickCallback:null}),policyFound:o}}(e,t,n,c);return r.policyFound&&(a=!0),r.item}))).concat(Z({retentionId:p,retentionPolicyTags:e,folderType:r,isArchive:!1,isChecked:t&&!a,onClickCallback:c}))}function ce(e){var t=e.retentionPolicyTagList,n=e.showTagSelection,i=e.selectedArchiveTag,c=e.selectedDeleteTag,a=e.mailboxType,o=e.distinguishedFolderId,u=e.hasArchive,s=e.onArchivePolicyClickedCallback,l=e.onDeletePolicyClickedCallback,d=[],f=u&&"ArchiveMailbox"!=a,b=function(e){switch(e){case"msgfolderroot":case"archivemsgfolderroot":return 12;case"deleteditems":case"archivedeleteditems":return 3;case"recoverableitemsdeletions":case"archiverecoverableitemsdeletions":return 18;case"calendar":return 1;case"contacts":return 2;case"conversationhistory":return 16;case"drafts":return 4;case"inbox":return 5;case"junkemail":return 6;case"journal":return 7;case"notes":return 8;case"outbox":return 9;case"sentitems":return 10;case"syncissues":return 15;case"tasks":return 11;case"none":default:return 17}}(o),v=t.filter((function(e){return e.IsVisible&&e.IsArchive})).sort(ae),h=t.filter((function(e){return e.IsVisible&&!e.IsArchive})).sort(ae);return f&&d.push.apply(d,Object(r.j)([],Object(r.g)(function(e,t,n,r,i){var c=(null==n?void 0:n.IsExplicit)?n.Value:null;return[{key:"archiveSection",className:ee.sectionHeader,itemType:X.a.Section,sectionProps:{bottomDivider:!0,title:Object(K.b)(Q.a),items:te(e,t,c,r,i)}}]}(v,n,i,b,s)))),d.push.apply(d,Object(r.j)([],Object(r.g)(function(e,t,n,r,i,c){var a=(null==n?void 0:n.IsExplicit)?n.Value:null;return[{key:"deleteSection",className:re.sectionHeader,itemType:X.a.Section,sectionProps:{title:Object(K.b)(ne.a),items:ie(e,t,a,r,i,c)}}]}(h,n,c,b,o,l)))),{items:d}}function ae(e,t){return e.RetentionPeriod&&t.RetentionPeriod?e.RetentionPeriod-t.RetentionPeriod:t.RetentionPeriod?1:-1}var oe=n(19),ue=n(2252),se=n(7413);function le(e,t,n){if(e&&Object(J.e)(e.tableQuery)){var r=J.i.tryImportForRender();return r?r(e.tableQuery):[]}return"SharedMailbox"===t?(i=n,c=Object(se.b)().retentionPolicyTags,i&&c.has(i)?c.get(i):[]):Object(oe.a)().RetentionPolicyTags;var i,c}function de(e,t,n){var i=q.ab.tableViews.get(e);if(!i)return null;var c=function(e){var t,n,r;if(e&&Object(J.e)(e.tableQuery))t=null,n="GroupMailbox";else{var i=Object(ue.g)(e),c=i&&Object(f.n)().get(i);if(!c)return null;t=c.DistinguishedFolderId||c.FolderId.Id,n=c.mailboxInfo.type,r=c.principalSMTPAddress}return{folderId:t,mailboxType:n,principalSMTPAddress:r}}(i);if(!c)return null;var a=le(i,c.mailboxType,c.principalSMTPAddress);if(!a)return null;var o,u,s,l=Object(r.j)([],Object(r.g)(i.selectedRowKeys.keys()));return n?(o=n.ArchiveTag,u=n.PolicyTag,s=!0):(o=1==l.length?q.b.getArchiveTag(l[0],i):null,u=1==l.length?q.b.getPolicyTag(l[0],i):null,s=1==l.length),ce({retentionPolicyTagList:a,showTagSelection:s,selectedArchiveTag:o,selectedDeleteTag:u,mailboxType:c.mailboxType,distinguishedFolderId:"none",hasArchive:fe(i),onArchivePolicyClickedCallback:be({isArchivePolicyClicked:!0,tableView:i,selectedTag:o,folderId:c.folderId,clientItem:n,actionSource:t}),onDeletePolicyClickedCallback:be({isArchivePolicyClicked:!1,tableView:i,selectedTag:u,folderId:c.folderId,clientItem:n,actionSource:t})})}function fe(e){return(!e||!Object(J.e)(e.tableQuery))&&!!Object(oe.a)().SessionSettings.HasArchive}function be(e){var t=e.isArchivePolicyClicked,n=e.tableView,i=e.selectedTag,c=e.folderId,a=e.clientItem,o=e.actionSource;return function(e,u){if(function(e){var t=e.retentionTag,n=e.retentionId,r=e.inheritSubMenuIdentifier;return!!t&&n!=t.Value||!t&&n!=r}({retentionTag:i,retentionId:u.data,inheritSubMenuIdentifier:t?g:p})){var s="RPCSAOverflow"==o||1===n.tableQuery.listViewType,f=Object(r.j)([],Object(r.g)(n.selectedRowKeys.keys())),b=Object(j.b)(n);if(s){var v="RPCSAOverflow"==o?[a.ItemId.Id]:f.map((function(e){return Object(q.O)(e,n.id).clientId.Id}));l(t,u.data,v,o,b)}else{var h=f.map((function(e){return Object(q.i)(e,n.id)}));v=f.reduce((function(e,t){var i=Object(q.N)(t,n.id);return i&&e.push.apply(e,Object(r.j)([],Object(r.g)(i.itemIds))),e}),[]);d(t,u.data,c,h,v,o,b)}}}}var ve=n(3805),he=n(197);function ge(e){if(Object(he.a)())return null;var t=Object(oe.a)(),n=t.RetentionPolicyTags;return n&&0!==n.length?{key:"AssignPolicy",name:Object(K.b)(ve.a),disabled:!1,subMenuProps:ce(Object(r.a)(Object(r.a)({},e),{showTagSelection:!0,retentionPolicyTagList:n,hasArchive:!!t.SessionSettings.HasArchive}))}:null}n.d(t,"getAssignPolicyPropertiesForMailContextMenu",(function(){return de})),n.d(t,"onArchiveTagForFolderChanged",(function(){return c})),n.d(t,"onDeleteTagForFolderChanged",(function(){return a})),n.d(t,"getRetentionPolicyMenuItem",(function(){return ge}))},7413:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(2),i={showPeoplePickerDialog:!1,retentionPolicyTags:new(n(14).ObservableMap)({})},c=Object(r.createStore)("sharedFolderState",i),a=c();t.a=a},8186:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1),i=n(180),c=n(3223);function a(e,t,n){if(void 0===t&&(t=Object(i.b)()),!e||!e.ConversationActions||0===e.ConversationActions.length)throw new Error("ApplyConversationAction requestBody is invalid!");n=n||{};var a=Object(r.a)({},n),o=a.headers?new Headers(a.headers):new Headers;return o.set("X-OWA-ActionSource","ApplyConversationAction_"+e.ConversationActions[0].Action),a.headers=o,Object(c.a)({Header:t,Body:e},a).then((function(e){return e.Body.ResponseMessages.Items[0]})).catch((function(e){return Promise.reject(e)}))}},9524:function(e,t,n){var r=n(14107),i=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var c=0;c<r.length;c++)i.loadStyles(r[c][1],!1);r.locals&&(e.exports=r.locals)}}]);
//# sourceMappingURL=owa.MailBoot~RetentionPolicies.js.map
self.scriptsLoaded['owa.MailBoot~RetentionPolicies.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~RetentionPolicies.js'] = (new Date()).getTime();