self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SearchInstrumentation.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[811],{151:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"g",(function(){return d}));var r=n(31),u=new r.c((function(){return Promise.all([n.e(4),n.e(21),n.e(973)]).then(n.bind(null,1559))})),i=new r.a(u,(function(e){return e.makePostRequest})).importAndExecute,a=new r.a(u,(function(e){return e.makePatchRequest})).importAndExecute,c=new r.a(u,(function(e){return e.makePutRequest})).importAndExecute,o=new r.a(u,(function(e){return e.makeGetRequest})).importAndExecute,s=new r.a(u,(function(e){return e.makeDeleteRequest})).importAndExecute,l=new r.a(u,(function(e){return e.makeGraphRequest})).importAndExecute,d=new r.a(u,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},159:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(41);function u(){var e=Object(r.a)(),t=e.origin;return t||(t=e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")),t}},2553:function(e,t,n){"use strict";var r=n(1),u=n(210);var i=n(24),a=n(8);n.d(t,"a",(function(){return s}));var c=null,o="searchtesthook";function s(e){void 0===e&&(e={});var t,n=Object(r.a)(Object(r.a)(Object(r.a)({},e),function(){if(!c){c={};var e=Object(a.a)(o),t=decodeURIComponent(e||"").trim();if(Object(i.i)("sea-debugHook")&&t.length>0){var n=t.split("&");c=n.reduce((function(e,t){var n=Object(r.g)(t.split("="),2),u=n[0],i=n[1];return e[u]=i,e}),{})}}return c}()),Object(u.a)("includePartnerIn3SRequest")?((t={}).partner="exchangeshared",t):null);return Object.keys(n).filter((function(e){return null!==n[e]})).reduce((function(e,t){var u;return Object(r.a)(Object(r.a)({},e),((u={})[t]=n[t],u))}),{})}},3462:function(e,t,n){"use strict";function r(e,t){return"search/api/"+(2===t?"v2":"v1")+"/"+e}n.d(t,"a",(function(){return r}))},3511:function(e,t,n){"use strict";n.r(t);var r=n(1),u=n(8096);function i(e,t){e.Attributes.push({Key:"localtime",Value:t.toISOString()})}var a={};function c(e,t,n,r,a){var c={Name:"entityclicked",Attributes:[]};i(c,n),c.Attributes.push({Key:"id",Value:t||(a+1).toString()}),Object(u.a)(e,c,r)}function o(e,t,n,r,u){var i={Name:"responsereceived",Attributes:[]};i.Attributes.push({Key:"latency",Value:t.toString()}),i.Attributes.push({Key:"status",Value:n.toString()}),a[e]=[i,r]}function s(e,t,n){var r=e||"00000000-0000-0000-0000-000000000000",a={Name:"sessionend",Attributes:[]};i(a,t),Object(u.a)(r,a,n)}function l(e,t,n){var r=a[e];delete a[e],r&&Promise.resolve().then((function(){var i=t.getTime()-r[1].getTime();r[0].Attributes.push({Key:"renderinglatency",Value:i.toString()}),r[0].Attributes.push({Key:"rendered",Value:"1"}),Object(u.a)(e,r[0],n)}))}function d(e,t){var n=a[e];delete a[e],n&&(n[0].Attributes.push({Key:"renderinglatency",Value:"-1"}),n[0].Attributes.push({Key:"rendered",Value:"0"}),Object(u.a)(e,n[0],t))}function f(e){Object.keys(a).forEach((function(t){return d(t,e)}))}function b(e,t,n,r,a){var c={Name:"searchboxstatechanged",Attributes:[]};c.Attributes.push({Key:"id",Value:n}),i(c,e),c.Attributes.push({Key:"reason",Value:t}),Object(u.a)(r,c,a)}function y(e,t,n,a,c,o){var s,l={Name:t,Attributes:[]};i(l,a),l.Attributes.push({Key:"id",Value:n}),o&&(s=l.Attributes).push.apply(s,Object(r.j)([],Object(r.g)(o))),Object(u.a)(e,l,c)}var v=n(4215);function p(e,t,n,r){var i={Name:"responsereceived",Attributes:[{Key:"version",Value:"2"},{Key:"traceId",Value:t},{Key:"localtime",Value:Object(v.a)()},{Key:"latency",Value:n.toString()},{Key:"status",Value:null==r?void 0:r.toString()}]};Object(u.a)(t,i,e)}function O(e,t,n,r,i,a,c){var o={Name:"cachedcontentrendered",Attributes:[{Key:"version",Value:"2"},{Key:"userid",Value:t},{Key:"tenantid",Value:n},{Key:"localtime",Value:Object(v.a)()},{Key:"logicalid",Value:r},{Key:"newlogicalid",Value:i},{Key:"conversationid",Value:a}]};Object(u.a)(c,o,e)}function j(e,t,n,r){var i={Name:"resultsrendered",Attributes:[{Key:"version",Value:"2"},{Key:"logicalid",Value:t},{Key:"localtime",Value:Object(v.a)()},{Key:"e2elatency",Value:r.toString()}]};n&&i.Attributes.push({Key:"traceId",Value:n}),Object(u.a)(n||t,i,e)}function h(e,t){var n={Name:"clientdatasource",Attributes:[{Key:"version",Value:"2"},{Key:"userid",Value:t.userId},{Key:"tenantid",Value:t.tenantId},{Key:"logicalid",Value:t.logicalId},{Key:"traceId",Value:t.traceId},{Key:"providername",Value:t.providerName},{Key:"scenarioname",Value:e},{Key:"localtime",Value:Object(v.a)()},{Key:"impressiontype",Value:t.impressionType},{Key:"results",Value:JSON.stringify(t.results)}]};Object(u.a)(t.traceId,n,e)}function V(e,t,n,r,i,a,c,o,s){var l={Name:"clientlayout",Attributes:[{Key:"version",Value:"2"},{Key:"userid",Value:t},{Key:"tenantid",Value:n},{Key:"logicalid",Value:r},{Key:"localtime",Value:Object(v.a)()},{Key:"layouttype",Value:a},{Key:"resultsview",Value:JSON.stringify(c)}]};null!=o&&l.Attributes.push({Key:"part",Value:o.toString()}),s&&l.Attributes.push({Key:"verticaltype",Value:s}),Object(u.a)(i,l,e)}function g(e,t,n,r,i,a){void 0===i&&(i=null);var c={Name:"searchactions",Attributes:[{Key:"version",Value:"2"},{Key:"userid",Value:t},{Key:"tenantid",Value:n},{Key:"localtime",Value:Object(v.a)()},{Key:"logicalid",Value:r},{Key:"eventType",Value:a}]};i&&c.Attributes.push({Key:"traceId",Value:i}),Object(u.a)(r,c,e)}function m(e,t,n,r,i,a,c,o,s){void 0===i&&(i=null);var l={Name:"searchentityactions",Attributes:[{Key:"version",Value:"2"},{Key:"userid",Value:t},{Key:"tenantid",Value:n},{Key:"logicalid",Value:r},{Key:"localtime",Value:Object(v.a)()},{Key:"id",Value:a},{Key:"eventtype",Value:c}]};if(i&&l.Attributes.push({Key:"traceId",Value:i}),o){var d=[];o.forEach((function(e,t){d.push({Key:t,Value:e})})),l.Attributes.push({Key:"metadata",Value:JSON.stringify(d)})}Object(u.a)(s||r,l,e)}function K(e,t,n,r,u,i){m(r,null,null,i,e,t,n,new Map([["entityactiontaken",u]]))}function A(e,t,n,r,a){var c={Name:"SearchFeedback",Attributes:[]};c.Attributes.push({Key:"TraceId",Value:t}),i(c,e),c.Attributes.push({Key:"Version",Value:"2"});var o={Type:"ResultFoundResponse",ResponseValue:n?"Yes":"No",FeedbackString:r};c.Attributes.push({Key:"FeedbackResponse",Value:JSON.stringify(o)}),Object(u.a)(t,c,a)}function S(e,t,n,r,i){var a={Name:"searchfeedback",Attributes:[{Key:"version",Value:"2"},{Key:"logicalid",Value:t},{Key:"localtime",Value:Object(v.a)()},{Key:"id",Value:r},{Key:"feedbackresponse",Value:i}]};Object(u.a)(n,a,e)}function k(e,t,n,r,i,a){var c={Name:"EntitiesFromFilePicker",Attributes:[{Key:"userid",Value:t},{Key:"tenantid",Value:n},{Key:"localtime",Value:Object(v.a)()},{Key:"fileType",Value:i},{Key:"fileId",Value:a},{Key:"traceId",Value:r}]};Object(u.a)(r,c,e)}var R=[];function N(e,t,n,r,u,i,a,c,o){R.includes(u)||(R.push(u),V(e,t,n,r,u,i,a,c,o))}var w=[];function E(e,t,n,r){w.includes(n)||(w.push(n),j(e,t,n,r))}function I(){R.length=0,w.length=0}n.d(t,"logEntityClicked",(function(){return c})),n.d(t,"logResponseReceived",(function(){return o})),n.d(t,"logResponseRendered",(function(){return l})),n.d(t,"logSearchBoxStateChanged",(function(){return b})),n.d(t,"logSessionEnd",(function(){return s})),n.d(t,"logSearchResultInteraction",(function(){return y})),n.d(t,"logResponseNeverRendered",(function(){return d})),n.d(t,"flushNonRenderedResponseReceivedItemsFromCache",(function(){return f})),n.d(t,"logCachedContentRendered",(function(){return O})),n.d(t,"logClientLayout",(function(){return V})),n.d(t,"logClientDataSource",(function(){return h})),n.d(t,"logEntitiesFromFilePicker",(function(){return k})),n.d(t,"logResponseRecievedV2",(function(){return p})),n.d(t,"logResultsRendered",(function(){return j})),n.d(t,"logSearchEntityActions",(function(){return m})),n.d(t,"logSecondaryEntityActionClicked",(function(){return K})),n.d(t,"logFeedback",(function(){return A})),n.d(t,"logSearchFeedbackActions",(function(){return S})),n.d(t,"logSearchActions",(function(){return g})),n.d(t,"clearProcessedTraceIds",(function(){return I})),n.d(t,"logSearchSuggestionsClientLayoutEvent",(function(){return N})),n.d(t,"logSearchSuggestionsResultsRenderedEvent",(function(){return E}))},4215:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(5);function u(){return Object(r.nc)().toString()}},427:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},478:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(80);function u(e){return Object(r.a)(e,[r.c])}},514:function(e,t,n){"use strict";var r=n(478),u=n(34),i=n(80);function a(e){return Object(i.a)(e,[i.b])}var c=n(29),o=n(71);function s(e){return Object(c.b)(Object(c.c)(Object(c.a)(Object(o.a)()||"",e)))}var l,d,f,b=n(617),y=n(734),v=n(219);function p(){return l||(l=Object(u.a)("/calendar")+"/"),l}function O(){return d||(d=Object(u.a)("/mail")+"/"),d}function j(){return f||(f=Object(u.a)("/files")+"/"),f}var h,V,g,m=n(867);function K(e){return h&&V===e||(V=e,h=e?Object(u.a)("/people/group/owner")+"/":Object(u.a)("/people/group/member")+"/"),h}function A(){return g||(g=Object(u.a)("/people/group/deleted")+"/"),g}function S(e){return window.location.origin+p()+"showPeek/item/"+encodeURIComponent(e)}var k=n(295),R=n(706),N=n(8),w=n(637),E=Object(R.a)().split("/").slice(1).join("/")+"deeplink/";function I(e,t,n,r){n&&((r=r||{}).minus="");var u="";if(r){var i=Object(N.b)();Object(w.a)(i),Object.keys(r).filter((function(e){return e})).forEach((function(e){return i[e]=r[e]})),u="?"+Object(N.i)(i)}var a={pathname:"/"+e+"/"+E+t,search:u};return k.format(a)}var P,x,C=n(220),T=n(1),F=n(19),q="https://to-do.microsoft.com";function U(e,t){var n,r,u,i=Object(F.a)(),a=i.UserOptions,c=null===(r=i.SessionSettings)||void 0===r?void 0:r.UserPrincipalName,o=q,s={};if(null===(u=null==a?void 0:a.ReactOptinSettings)||void 0===u?void 0:u.TasksRedirectUrl){var l;o=(n=Object(T.g)(a.ReactOptinSettings.TasksRedirectUrl.split("?"),2))[0],l=n[1],s=Object(N.g)(l),c&&(s.auth_upn=c)}return e&&(s.utm_source=e),t&&delete s.fromOwa,Object.keys(s).length>0?Object(v.a)(o,s):o}function J(){return P||(P=Object(u.a)("/spaces")+"/"),P}function D(){return x||(x=Object(u.a)("/eventify")+"/"),x}var G=n(159);n.d(t,"j",(function(){return r.a})),n.d(t,"t",(function(){return u.a})),n.d(t,"f",(function(){return a})),n.d(t,"l",(function(){return s})),n.d(t,"s",(function(){return b.a})),n.d(t,"x",(function(){return c.a})),n.d(t,"a",(function(){return c.b})),n.d(t,"b",(function(){return c.c})),n.d(t,"o",(function(){return y.a})),n.d(t,"v",(function(){return v.a})),n.d(t,"d",(function(){return p})),n.d(t,"k",(function(){return O})),n.d(t,"g",(function(){return j})),n.d(t,"p",(function(){return m.a})),n.d(t,"i",(function(){return K})),n.d(t,"h",(function(){return A})),n.d(t,"c",(function(){return S})),n.d(t,"q",(function(){return I})),n.d(t,"w",(function(){return C.a})),n.d(t,"u",(function(){return U})),n.d(t,"n",(function(){return J})),n.d(t,"e",(function(){return D})),n.d(t,"m",(function(){return G.a})),n.d(t,"r",(function(){return o.a}))},617:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(8),u=n(637);function i(){var e=Object(r.b)();Object(u.a)(e);var t=Object(r.i)(e);return t.length>0?"?"+t:""}},637:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=["hostApp","isanonymous","cspoff","frameName","opxInstanceId","hxVersion"];function u(e){e&&Object.keys(e).forEach((function(t){r.includes(t)&&delete e[t]}))}},706:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(71),u=n(34);function i(e){return(Object(u.a)("/"+(e||Object(r.a)()))+"/").replace(/^\//,"")}},734:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(41),u=n(34),i=n(159);function a(e){var t=Object(r.a)(),n=Object(i.a)()+Object(u.a)("/owa")+"/",a=t.search&&t.search.length>0;n+=a?t.search:"?";for(var c=Object.keys(e),o=a,s=0;s<c.length;s++)o?n+="&":o=!0,n+=c[s]+"="+e[c[s]];return n}},8096:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));n(1);var r=n(3462),u=n(121),i=n(4),a=n(151),c=n(2553),o=n(514),s={};function l(e,t,n){var l=t.Attributes.filter((function(e){return null!=e.Value}));t.Attributes=l,t.Attributes.forEach((function(e){if(e.Value&&"string"!=typeof e.Value)throw new Error("All values in substrate search event attributes must be strings or null/undefines")})),void 0===s[n]&&(s[n]={},setTimeout(function(e){return function(){var t=s[e],n=Object.keys(t).reduce((function(e,n){return e.push({Key:n,Value:t[n]}),e}),[]),l={scenario:e},d=Object(c.a)(l);s[e]=void 0,Object(a.e)(Object(o.v)(Object(r.a)("events"),d),n,void 0,!0,{"Client-Session-Id":Object(i.H)()},void 0,void 0,!1).then((function(n){var r={},i=Object.keys(t).reduce((function(e,n){return t[n].forEach((function(t){e.push({TraceId:n,EventName:t.Name}),r[t.Name]?r[t.Name]=r[t.Name]+1:r[t.Name]=1})),e}),[]),a={scenario:e,status:n.status,totalEvents:i.length,events:JSON.stringify(i)};Object.keys(r).forEach((function(e){a[e]=r[e]})),Object(u.s)("3SInstEvent",a)}))}}(n),5e3)),s[n][e]=(s[n][e]||[]).concat(t)}},867:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r,u=n(34);function i(){return r||(r=Object(u.a)("/people")+"/"),r}}}]);
//# sourceMappingURL=owa.MailBoot~SearchInstrumentation.js.map
self.scriptsLoaded['owa.MailBoot~SearchInstrumentation.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SearchInstrumentation.js'] = (new Date()).getTime();