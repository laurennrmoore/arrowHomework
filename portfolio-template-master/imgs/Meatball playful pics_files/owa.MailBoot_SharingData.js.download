self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SharingData.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[819],{1281:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"FindItemJsonRequest:#Exchange"},e)}},1302:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(33),i=t(1281);function a(e,n){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FindItem",e,n)}},1304:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"FindItemRequest:#Exchange"},e)}},15553:function(e){e.exports=JSON.parse('{"b":"Doa","a":"Eoa"}')},15554:function(e){e.exports=JSON.parse('{"h":"ooa","i":"poa","j":"qoa","d":"roa","k":"soa","e":"toa","g":"uoa","m":"voa","o":"woa","f":"xoa","l":"yoa","n":"zoa","a":"Aoa","c":"Boa","b":"Coa"}')},186:function(e,n,t){"use strict";function r(){var e=Object.create(null),n=0,t=0,r=0,i=!1;function a(n){r--,delete e[n]}this.put=function(n,t,i,o){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var s=e[n];s?clearTimeout(s.timeout):r++;var u={value:t,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){a(n),o&&o(n,t)}.bind(this),i)),e[n]=u,t},this.del=function(n){var t=!0,r=e[n];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(t=!1)):t=!1,t&&a(n),t},this.clear=function(){for(var a in e)clearTimeout(e[a].timeout);r=0,e=Object.create(null),i&&(n=0,t=0)},this.get=function(a){var o=e[a];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return i&&n++,o.value;i&&t++,r--,delete e[a]}else i&&t++;return null},this.size=function(){return r},this.memsize=function(){var n,t=0;for(n in e)t++;return t},this.debug=function(e){i=e},this.hits=function(){return n},this.misses=function(){return t},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var n={};for(var t in e){var r=e[t];n[t]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(n)},this.importJson=function(n,t){var r=JSON.parse(n),i=Date.now(),a=t&&t.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(a)if(e[o])continue;var s=r[o],u=s.expire-i;if(u<=0){this.del(o);continue}u=u>0?u:void 0,this.put(o,s.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},1992:function(e,n,t){"use strict";var r=t(1963),i=t(2210),a=t(6);function o(e){var n;return e>=1073741824?(e/=1073741824,n=Object(a.b)(i.b)):e>=1048576?(e/=1048576,n=Object(a.b)(i.d)):e>=1024?(e/=1024,n=Object(a.b)(i.c)):n=Object(a.b)(i.a),Object(a.c)(n,Math.round(e))}var s,u=t(2061),c=t(24),l=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function f(e){if(!Object(c.i)("doc-attachment-documentThumbnail"))return!1;var n=Object(r.a)(e);return!!n&&l.indexOf(n.toLowerCase())>=0}function d(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return s.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return s.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return s.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(s||(s={}));var p=t(2019);t.d(n,"b",(function(){return r.a})),t.d(n,"c",(function(){return r.b})),t.d(n,"d",(function(){return r.c})),t.d(n,"i",(function(){return o})),t.d(n,"g",(function(){return u.a})),t.d(n,"h",(function(){return f})),t.d(n,"f",(function(){return d})),t.d(n,"e",(function(){return p.b})),t.d(n,"a",(function(){return s}))},2019:function(e,n,t){"use strict";function r(e){return n=e||"",(t=a.exec(n))&&t.length>1&&i[t[1].toLowerCase()];var n,t}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o}));var i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},a=/^\s*([^;\s]*)(?:;|\s|$)/;function o(e){var n="";return Object.entries(i).forEach((function(t){t[1]===e&&(n=t[0])})),n}},2029:function(e,n,t){"use strict";var r,i,a;t.d(n,"c",(function(){return r})),t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return a})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(a||(a={}))},2061:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return c}));var r=t(1963),i=t(2019),a=t(102),o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],s=[".tiff",".tif"];function u(e,n,t){return void 0===t&&(t=!0),c(Object(r.a)(e)||Object(i.a)(n),t)}function c(e,n){return void 0===n&&(n=!0),!!e&&(o.indexOf(e.toLowerCase())>=0||n&&s.indexOf(e.toLowerCase())>=0&&(Object(a.e)()||Object(a.d)()||Object(a.h)()||Object(a.g)()&&!Object(a.l)()))}},2067:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"IndexedPageView:#Exchange"},e)}},217:function(e,n,t){"use strict";var r=t(859);t.d(n,"a",(function(){return r.a}))},2179:function(e,n){e.exports=function(e){return e instanceof Date}},2210:function(e){e.exports=JSON.parse('{"b":"Nea","d":"Oea","c":"Pea","a":"Qea"}')},2243:function(e,n,t){var r=t(2179),i=36e5,a=6e4,o=2,s=/[T ]/,u=/:/,c=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],f=/^(\d{4})/,d=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],p=/^-(\d{2})$/,h=/^-?(\d{3})$/,g=/^-?(\d{2})-?(\d{2})$/,m=/^-?W(\d{2})$/,b=/^-?W(\d{2})-?(\d{1})$/,v=/^(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,x=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,j=/^(Z)$/,k=/^([+-])(\d{2})$/,y=/^([+-])(\d{2}):?(\d{2})$/;function I(e,n,t){n=n||0,t=t||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*n+t+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,n){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var t=(n||{}).additionalDigits;t=null==t?o:Number(t);var w=function(e){var n,t={},r=e.split(s);u.test(r[0])?(t.date=null,n=r[0]):(t.date=r[0],n=r[1]);if(n){var i=S.exec(n);i?(t.time=n.replace(i[1],""),t.timezone=i[1]):t.time=n}return t}(e),L=function(e,n){var t,r=l[n],i=d[n];if(t=f.exec(e)||i.exec(e)){var a=t[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(t=c.exec(e)||r.exec(e)){var o=t[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(w.date,t),P=L.year,T=function(e,n){if(null===n)return null;var t,r,i,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(n),r;if(t=p.exec(e))return r=new Date(0),i=parseInt(t[1],10)-1,r.setUTCFullYear(n,i),r;if(t=h.exec(e)){r=new Date(0);var o=parseInt(t[1],10);return r.setUTCFullYear(n,0,o),r}if(t=g.exec(e)){r=new Date(0),i=parseInt(t[1],10)-1;var s=parseInt(t[2],10);return r.setUTCFullYear(n,i,s),r}if(t=m.exec(e))return a=parseInt(t[1],10)-1,I(n,a);if(t=b.exec(e)){a=parseInt(t[1],10)-1;var u=parseInt(t[2],10)-1;return I(n,a,u)}return null}(L.restDateString,P);if(T){var E,C=T.getTime(),D=0;return w.time&&(D=function(e){var n,t,r;if(n=v.exec(e))return(t=parseFloat(n[1].replace(",",".")))%24*i;if(n=O.exec(e))return t=parseInt(n[1],10),r=parseFloat(n[2].replace(",",".")),t%24*i+r*a;if(n=x.exec(e)){t=parseInt(n[1],10),r=parseInt(n[2],10);var o=parseFloat(n[3].replace(",","."));return t%24*i+r*a+1e3*o}return null}(w.time)),w.timezone?E=function(e){var n,t;if(n=j.exec(e))return 0;if(n=k.exec(e))return t=60*parseInt(n[2],10),"+"===n[1]?-t:t;if(n=y.exec(e))return t=60*parseInt(n[2],10)+parseInt(n[3],10),"+"===n[1]?-t:t;return 0}(w.timezone):(E=new Date(C+D).getTimezoneOffset(),E=new Date(C+D+E*a).getTimezoneOffset()),new Date(C+D+E*a)}return new Date(e)}},2277:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={})),n.b=r},2860:function(e,n,t){"use strict";t.d(n,"e",(function(){return o})),t.d(n,"b",(function(){return s})),t.d(n,"f",(function(){return u})),t.d(n,"g",(function(){return c})),t.d(n,"c",(function(){return l})),t.d(n,"d",(function(){return f}));var r=t(31),i=t(3340);t.d(n,"a",(function(){return i.a}));var a=new r.c((function(){return Promise.all([t.e(42),t.e(81),t.e(634)]).then(t.bind(null,6775))})),o=new r.b(a,(function(e){return e.createGetSharingInfoResponse})),s=new r.b(a,(function(e){return e.checkSharingLinkUrlDomain})),u=new r.b(a,(function(e){return e.getLinkProviderType})),c=new r.b(a,(function(e){return e.isOneDriveProRelatedLink})),l=new r.b(a,(function(e){return e.convertToAttachmentDataProviderType})),f=new r.b(a,(function(e){return e.convertToLinkProviderType}))},326:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return o}));var r,i=t(1);function a(e){r=e}function o(){var e,n;return Object(i.c)(this,void 0,void 0,(function(){var t,a;return Object(i.f)(this,(function(i){switch(i.label){case 0:return(a=r)?[4,r()]:[3,2];case 1:a=i.sent(),i.label=2;case 2:if((t=a)&&t.length>0){if("bearer"===(null===(e=null==t?void 0:t.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,t.split(" ")[1]];if("msauth1.0"===(null===(n=null==t?void 0:t.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return[2,t]}return[2,void 0]}}))}))}},3340:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.OneDrivePro=0]="OneDrivePro",e[e.OneDriveConsumer=1]="OneDriveConsumer",e[e.Dropbox=2]="Dropbox",e[e.Box=3]="Box",e[e.GDrive=5]="GDrive",e[e.OfficeOneDrivePro=31]="OfficeOneDrivePro"}(r||(r={}))},3601:function(e,n,t){"use strict";t.r(n);var r=t(1),i=t(94),a=t(24),o=t(2860),s=t(3354),u=t(217);function c(e){return Object(r.a)({__type:"GetSharingInfoRequest:#Exchange"},e)}function l(e){return Object(r.a)({__type:"GetSharingInfoResponse:#Exchange"},e)}var f=t(33);var d,p,h=t(23);!function(e){e.OneDrivePro="OneDrivePro"}(d||(d={})),function(e){e.None="None",e.View="View",e.Edit="Edit",e.AnonymousView="AnonymousView",e.AnonymousEdit="AnonymousEdit",e.OrganizationView="OrganizationView",e.OrganizationEdit="OrganizationEdit"}(p||(p={}));var g=t(151),m="ows/api/beta/sharinglink/info";function b(e,n){return c({attachmentUrl:e,useReadWriteServer:n})}function v(e,n,t){return Object(r.c)(this,void 0,void 0,(function(){var u;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,o.c.import()];case 1:switch(u=r.sent(),n){case o.a.OneDrivePro:case o.a.OfficeOneDrivePro:return Object(a.i)("doc-attachment-sharingLinkInfoOWSPrimeService")?[2,O(e)]:[2,(l=b(e,t),void 0===l||l.__type||(l=c(l)),Object(f.a)("GetSharingInformation",l,d))];case o.a.OneDriveConsumer:case o.a.Dropbox:case o.a.Box:case o.a.GDrive:return[2,Object(s.j)(e,u(n))];default:return[2,Object(i.a)(n)]}return[2]}var l,d}))}))}function O(e){return Object(r.c)(this,void 0,void 0,(function(){var n,t,i,a,o,s,c,f,b,v,O,S;return Object(r.f)(this,(function(j){switch(j.label){case 0:return[4,(k=e,y=!0,void 0===y&&(y=!1),Object(g.e)(m,{url:k},void 0,y))];case 1:return n=j.sent(),Object(u.a)(n.status)?(a=(i=JSON).parse,[4,n.text()]):[3,3];case 2:if(function(e){return e.providerType===d.OneDrivePro}(t=a.apply(i,[j.sent()])))return o=Object(r.g)(t.sharingLinks.filter((function(e){return e.type===p.AnonymousEdit})),1),s=o[0],c=Object(r.g)(t.sharingLinks.filter((function(e){return e.type===p.AnonymousView})),1),f=c[0],b=Object(r.g)(t.sharingLinks.filter((function(e){return e.type===p.OrganizationEdit})),1),v=b[0],O=Object(r.g)(t.sharingLinks.filter((function(e){return e.type===p.OrganizationView})),1),S=O[0],[2,l({AccessRequestMode:t.accessRequestMode,AnonymousEditLink:s?s.url:void 0,AnonymousViewLink:f?f.url:void 0,CanCreateAnonymousEditLink:t.canCreateAnonymousEditLink,CanCreateAnonymousViewLink:t.canCreateAnonymousViewLink,CanCreateOrganizationEditLink:t.canCreateOrganizationEditLink,CanCreateOrganizationViewLink:t.canCreateOrganizationViewLink,CanShareExternally:t.canShareExternally,CanShareInternally:t.canShareInternally,CanonicalUrl:t.canonicalUrl,ExpirationDate:t.expirationTime,FileName:t.name,IsAnonymousEditLinkAvailable:!!s,IsAnonymousViewLinkAvailable:!!f,IsOrganizationEditLinkAvailable:!!v,IsOrganizationViewLinkAvailable:!!S,MimeType:void 0,OrganizationEditLink:v?v.url:void 0,OrganizationViewLink:S?S.url:void 0,ResultCode:0,SharingLinkKind:x(t.linkType)})];throw new Error("Invalid response from OWS` from sharing link info");case 3:return 404===n.status?[2,l({ResultCode:4})]:400===n.status?[2,l({ResultCode:24})]:(h.g.warn("Invalid response for OWS' get share info. Status code: "+n.status),[2,l({ResultCode:1})]);case 4:return[2]}var k,y}))}))}function x(e){switch(e){case p.None:return 0;case p.View:case p.Edit:return 1;case p.AnonymousView:return 4;case p.AnonymousEdit:return 5;case p.OrganizationView:return 2;case p.OrganizationEdit:return 3;default:return Object(i.a)(e)}}var S=t(6),j=t(15553),k=t(2161);var y=t(9472),I=t(8168),w=t(2330);function L(e,n,t){if(1!==e.length||null===t)return null;switch(n){case k.a.noPermissionToShare:case k.a.noPermissionToShareExternally:case k.a.externalRecipientCSL:case k.a.sharingWithLargeDL:return e[0].supportsDownsell?[t(e[0].id)]:null;case k.a.getSharingInfoFailed:case k.a.noPermissionSet:return null;case k.a.linkHasExpired:case k.a.linkWillExpire:return function(e){return[{text:Object(S.b)(I.a),action:function(){Object(w.a)(e.id)}},{text:Object(S.b)(y.a),action:function(){e.sharingTipsIgnored.push(k.a.linkHasExpired),e.sharingTipsIgnored.push(k.a.linkWillExpire)}}]}(e[0]);default:return Object(i.a)(n)}}var P=t(2029);function T(e,n){return n.filter((function(e){return e.externalMemberCount>0})).length>0&&e.sharingInfo&&!e.sharingInfo.canShareExternally&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}var E=100,C=1,D="PublicDL",F="PrivateDL",R="GroupMailbox",A="RecommendedGroup",M="InternalMailbox",N="ExternalMailbox",W="Mailbox",z="OneOff",G="Contact",V="ImplicitContact",$="PublicFolder",_="Other",U="Room",H="LinkedIn";function J(e){return e.some((function(e){return e.totalMemberCount>E}))}function Y(e,n){return J(n)&&e.sharingInfo&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}function q(e){return e.sharingInfo&&!e.sharingInfo.getSharingInfoSucceeded}function B(e,n){return n.filter((function(e){return e.externalMemberCount>0})).length>0&&(6===e.currentPermissionLevel||5===e.currentPermissionLevel)}var Z=t(5);function K(e){return(null==e?void 0:e.sharingInfo)&&!!e.sharingInfo.expirationDate&&Object(Z.Hb)(e.sharingInfo.expirationDate,Object(Z.Rb)())}function Q(e){return(null==e?void 0:e.sharingInfo)&&!!e.sharingInfo.expirationDate&&Object(Z.Fb)(e.sharingInfo.expirationDate,Object(Z.Rb)())}var X=t(2309);function ee(e){return e.recipientPermissionInfos.some((function(e){return e.getPermissionInfoStatus===X.a.Failed}))}var ne=t(2277);function te(e){switch(e){case D:case F:case R:case A:return!0;default:return!1}}function re(e,n){return e.filter((function(e){return function(e){var t=n?te(e.recipient.persona.EmailAddress.MailboxType):e.totalMemberCount>1,r=e.totalMemberCount<=E;return t&&r}(e)}))}function ie(e){return re(e,!0).some((function(e){return e.recipient.expansionStatus===ne.b.Failed||e.recipient.expansionStatus===ne.b.SucceededWithDLOrGroupMembers}))}function ae(e,n){return oe(e.sharingRecipientsInfo,n)?0===e.currentPermissionLevel&&e.sharingInfo&&e.sharingInfo.getSharingInfoSucceeded:0===e.currentPermissionLevel&&e.sharingRecipientsInfo.recipientPermissionInfos.some((function(e){return!e.hasAccess&&e.getPermissionInfoStatus===X.a.Succeeded}))||(1===e.currentPermissionLevel||2===e.currentPermissionLevel)&&function(e){return e.recipientPermissionInfos.some((function(e){return!e.hasAccess&&!e.canHaveAccess&&e.getPermissionInfoStatus===X.a.Succeeded}))}(e.sharingRecipientsInfo)}function oe(e,n){return J(n)||ie(n)||ee(e)}function se(e){var n;return(null===(n=e.sharingInfo)||void 0===n?void 0:n.getSharingInfoSucceeded)&&!e.sharingInfo.canShareInternally&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}var ue=t(2331);var ce=t(121),le=t(15554);var fe=function(e){return e?e.filter((function(e){return e.totalMemberCount>100})).map((function(e){return e.recipient.persona.EmailAddress.Name})).join(", "):""};function de(e,n,t,r){if(oe(e,n))return Object(S.b)(le.o);var i=e.recipientPermissionInfos,a=null,o=!1;if(0===t?(a=i.filter((function(e){return!e.hasAccess&&e.getPermissionInfoStatus===X.a.Succeeded})),Object(ce.s)("RecipientCanNotAccess",{numOfRecipients:a.length,linkId:r})):1!==t&&2!==t||(o=!0,a=i.filter((function(e){return!e.hasAccess&&!e.canHaveAccess&&e.getPermissionInfoStatus===X.a.Succeeded})),Object(ce.s)("RecipientCanNotHaveAccess",{numOfRecipients:a.length})),null!==a){var s=a.length,u=function(e){return e.map((function(e){return e.name?e.name:e.emailAddress})).join(", ")}(a.slice(0,3));return 1===s?Object(S.c)(Object(S.b)(o?le.c:le.l),u,"{0}"):s<4?Object(S.c)(Object(S.b)(o?le.c:le.n),u,"{0}"):Object(S.c)(Object(S.b)(o?le.b:le.a),u,"{0}")}return Object(S.b)(le.o)}function pe(e,n,t,r,o){if(!function(e){switch(e){case k.a.noPermissionToShare:case k.a.noPermissionToShareExternally:case k.a.externalRecipientCSL:case k.a.noPermissionSet:case k.a.sharingWithLargeDL:case k.a.linkWillExpire:case k.a.linkHasExpired:return!0;case k.a.getSharingInfoFailed:return Object(a.i)("doc-attachment-sharingInfoFailureTip");default:return Object(i.a)(e)}}(n))return null;var s=function(e){switch(e){case k.a.noPermissionToShare:return se;case k.a.getSharingInfoFailed:return q;case k.a.linkHasExpired:return K;case k.a.linkWillExpire:return Q;case k.a.externalRecipientCSL:return B;case k.a.noPermissionToShareExternally:return T;case k.a.noPermissionSet:return ae;case k.a.sharingWithLargeDL:return Y;default:return Object(i.a)(e)}}(n),u=e.filter((function(e){return s(e,t)}));if(0===u.length)return null;var c=u.filter((function(e){return!Object(S.f)(e.name)})).map((function(e){return e.name})).join(", "),l=function(e,n,t){switch(e){case k.a.noPermissionToShare:return{singleFile:Object(S.b)(le.h),multipleFiles:Object(S.b)(le.h)};case k.a.getSharingInfoFailed:return{singleFile:Object(S.b)(le.i),multipleFiles:Object(S.b)(le.i)};case k.a.linkHasExpired:return{singleFile:Object(S.b)(le.j),multipleFiles:Object(S.b)(le.d)};case k.a.linkWillExpire:return{singleFile:Object(S.b)(le.k),multipleFiles:Object(S.b)(le.e)};case k.a.noPermissionToShareExternally:return{singleFile:Object(S.b)(le.g),multipleFiles:Object(S.b)(le.g)};case k.a.externalRecipientCSL:return{singleFile:Object(S.b)(le.m),multipleFiles:Object(S.b)(le.m)};case k.a.noPermissionSet:return{singleFile:de(t[0].sharingRecipientsInfo,n,t[0].currentPermissionLevel,"string"==typeof t[0].id?t[0].id:""),multipleFiles:Object(S.b)(le.o)};case k.a.sharingWithLargeDL:var r=fe(n);return{singleFile:Object(S.c)(Object(S.b)(le.f),r,"{0}","{1}"),multipleFiles:Object(S.c)(Object(S.b)(le.f),r,"{0}","{1}")};default:return Object(i.a)(e)}}(n,t,u),f=u.length>1?l.multipleFiles:l.singleFile;c&&0!==c.length||!f||0===f.length||h.d("file names should not be null or empty if the infobarStringTemplate is not");var d,p=L(u,n,o),g=function(e){switch(e){case k.a.noPermissionToShare:case k.a.noPermissionToShareExternally:return[ue.a.ignore,ue.a.attachAsACopy];case k.a.getSharingInfoFailed:return[ue.a.ignore];case k.a.externalRecipientCSL:case k.a.noPermissionSet:case k.a.sharingWithLargeDL:return[ue.a.ignore,ue.a.changePermission,ue.a.attachAsACopy];case k.a.linkWillExpire:case k.a.linkHasExpired:return[ue.a.ignore,ue.a.refreshExpiration];default:return Object(i.a)(e)}}(n);if(r||null!==p&&0!==p.length)d=Object(S.c)(f,c);else{var m="",b=function(e){switch(e){case k.a.noPermissionToShare:case k.a.noPermissionToShareExternally:case k.a.externalRecipientCSL:return{singleFile:Object(S.b)(j.b),multipleFiles:Object(S.b)(j.a)};case k.a.getSharingInfoFailed:case k.a.linkHasExpired:case k.a.linkWillExpire:case k.a.noPermissionSet:case k.a.sharingWithLargeDL:return null;default:return Object(i.a)(e)}}(n);null!==b&&(m=u.length>1?b.multipleFiles:b.singleFile),d=Object(S.c)(f,c,m)}return{id:n,sharingTipString:d,actions:p,sharingTipActions:g,messageRank:function(e){switch(e){case k.a.noPermissionToShare:case k.a.noPermissionToShareExternally:case k.a.sharingWithLargeDL:case k.a.linkHasExpired:case k.a.externalRecipientCSL:case k.a.noPermissionSet:return P.b.Error;case k.a.linkWillExpire:case k.a.getSharingInfoFailed:return P.b.Info;default:return Object(i.a)(e)}}(n)}}function he(e,n,t,r,i){var a=pe(e,n,t,r,i);if(null===a)return null;var o={key:n,source:P.c.Compose,rank:a.messageRank,message:a.sharingTipString,messageParts:[a.sharingTipString]};return null!==a.actions&&a.actions.map((function(e){o.messageParts.push(e)})),function(e){return o}}var ge=new Map;function me(e,n){var t=[];ge.has(e)&&(t=ge.get(e)),be(t,[],e,n,"deleteLink")}function be(e,n,t,r,i){void 0===i&&(i=null);var a=i||"UnknownActionSource",o=n.filter((function(n){return-1===e.indexOf(n)})),s=e.filter((function(e){return-1===n.indexOf(e)}));o.length>0&&(o.unshift(r),o.unshift(a),Object(ce.s)("LinkSharingTipsAdded",o,{cosmosOnlyData:t})),s.length>0&&(s.unshift(r),s.unshift(a),Object(ce.s)("LinkSharingTipsRemoved",s,{cosmosOnlyData:t}))}function ve(e,n){if(null===e)return[];var t,r,i,a,o=Object(k.b)().filter((function(n){return-1===e.sharingTipsIgnored.indexOf(n)})).map((function(t){return pe([e],t,n,!0)})).filter((function(e){return null!==e}));if("string"==typeof e.id){var s=o.map((function(e){return e.id}));t=e.id,r=s,i=e.typeOfLink,a=[],ge.has(t)&&(a=ge.get(t)),be(a,r,t,i),ge.set(t,r)}return o}function Oe(e){switch(e){case M:case N:case W:case z:case G:case V:case H:return!0;default:return!e||te(e)||function(e){switch(e){case $:case _:case U:return!0;default:return!1}}(e)||h.d("UnknownMailboxType: "+e),!1}}function xe(e){return e.filter((function(e){return e.totalMemberCount===C&&Oe(e.recipient.persona.EmailAddress.MailboxType)}))}t.d(n,"getSharingInformation",(function(){return v})),t.d(n,"getInfoBarCreator",(function(){return he})),t.d(n,"getSharingIssuesForSharingData",(function(){return ve})),t.d(n,"hasGetRecipientPermissionFailed",(function(){return ee})),t.d(n,"hasLargeDLRecipient",(function(){return J})),t.d(n,"hasRecipientExpansionFailure",(function(){return ie})),t.d(n,"getGroupsAndSmallDLs",(function(){return re})),t.d(n,"getInvididualRecipients",(function(){return xe})),t.d(n,"logSharingTipChangesForLinkRemoval",(function(){return me}))},518:function(e,n,t){"use strict";var r=function(){function e(e,n,t){this.maxParallelTasks=e,this.taskCallback=n,this.taskDelay=t,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var n=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(n).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();t.d(n,"a",(function(){return r}))},8168:function(e){e.exports=JSON.parse('{"a":"Goa"}')},859:function(e,n,t){"use strict";function r(e){return e>=200&&e<300}t.d(n,"a",(function(){return r}))},9472:function(e){e.exports=JSON.parse('{"a":"Foa"}')},981:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"ItemResponseShape:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.MailBoot~SharingData.js.map
self.scriptsLoaded['owa.MailBoot~SharingData.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SharingData.js'] = (new Date()).getTime();