self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SmartSuggestions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[824],{10098:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var i=n(31),o=new i.c((function(){return Promise.all([n.e(9),n.e(10),n.e(164),n.e(224),n.e(217),n.e(751)]).then(n.bind(null,12136))})),r=new i.b(o,(function(e){return e.openBotConversation})),a=new i.b(o,(function(e){return e.openCortanaConversation}));new i.a(o,(function(e){return e.setEditorInterface}))},16814:function(e){e.exports=JSON.parse('{"b":"wwc","a":"xwc","c":"ywc"}')},16815:function(e,t,n){var i=n(16816),o=n(78);"string"==typeof i&&(i=[[e.i,i]]);for(var r=0;r<i.length;r++)o.loadStyles(i[r][1],!1);i.locals&&(e.exports=i.locals)},16816:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._75tHIuGwJteAnc7bhXobX{width:calc(100% - 25px);position:absolute}html[dir=ltr] ._75tHIuGwJteAnc7bhXobX{margin-left:-20px;margin-right:-35px}html[dir=rtl] ._75tHIuGwJteAnc7bhXobX{margin-right:-20px;margin-left:-35px}._1E8hr21HG9v5wO6CZW0zWI{height:calc(100% - 50px)}._1s7PgeYeoRKTHzMTiZQcrX{height:calc(100% - 10px)}._2F1f0qKFVQ0nYKheRcPt9W{width:100%;height:100%}html[dir] ._2F1f0qKFVQ0nYKheRcPt9W{border-width:0}._2tDwh-EnAubLy-FtOTryyK{font-size:21px;font-weight:100;font-weight:300;color:"[theme:neutralPrimary, default:#323130]"}._2Bfp3u7s_yvSyytNYJSrhR{width:calc(100% - 27px);height:40px;font-size:12px;color:"[theme:themePrimary, default:#0078D4]";font-weight:400;vertical-align:bottom}html[dir] ._2Bfp3u7s_yvSyytNYJSrhR{padding-top:10px;padding-bottom:3px;border-top:1px solid "[theme:neutralTertiaryAlt, default:#c8c6c4]"}html[dir=ltr] ._2Bfp3u7s_yvSyytNYJSrhR{margin-left:8px}html[dir=rtl] ._2Bfp3u7s_yvSyytNYJSrhR{margin-right:8px}',""]),t.locals={container:"_75tHIuGwJteAnc7bhXobX",containerLocationHeight:"_1E8hr21HG9v5wO6CZW0zWI",containerNoLocationHeight:"_1s7PgeYeoRKTHzMTiZQcrX",pickerIframeStyle:"_2F1f0qKFVQ0nYKheRcPt9W",header:"_2tDwh-EnAubLy-FtOTryyK",locationButton:"_2Bfp3u7s_yvSyytNYJSrhR"}},16817:function(e){e.exports=JSON.parse('{"a":"zwc"}')},16818:function(e,t,n){var i=n(16819),o=n(78);"string"==typeof i&&(i=[[e.i,i]]);for(var r=0;r<i.length;r++)o.loadStyles(i[r][1],!1);i.locals&&(e.exports=i.locals)},16819:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'@-webkit-keyframes _3Xt47js2Ol6TtHctPCq_zv{0%{background-color:none;color:none;display:inline;-webkit-animation-timing-function:cubic-bezier(.33,0,.67,1);animation-timing-function:cubic-bezier(.33,0,.67,1)}to{background-color:"[theme:themeLighter, default:#DEECF9]";color:"[theme:themeDark, default:#0D62AA]";display:inline-block}}@-webkit-keyframes _1aFK1bl8nu9HzQ8EPIECQr{0%{background-color:none;color:none;display:inline;-webkit-animation-timing-function:cubic-bezier(.33,0,.67,1);animation-timing-function:cubic-bezier(.33,0,.67,1)}to{background-color:"[theme:themeLighter, default:#DEECF9]";color:"[theme:themeDark, default:#0D62AA]";display:inline-block}}@keyframes _3Xt47js2Ol6TtHctPCq_zv{0%{background-color:none;color:none;display:inline;-webkit-animation-timing-function:cubic-bezier(.33,0,.67,1);animation-timing-function:cubic-bezier(.33,0,.67,1)}to{background-color:"[theme:themeLighter, default:#DEECF9]";color:"[theme:themeDark, default:#0D62AA]";display:inline-block}}@keyframes _1aFK1bl8nu9HzQ8EPIECQr{0%{background-color:none;color:none;display:inline;-webkit-animation-timing-function:cubic-bezier(.33,0,.67,1);animation-timing-function:cubic-bezier(.33,0,.67,1)}to{background-color:"[theme:themeLighter, default:#DEECF9]";color:"[theme:themeDark, default:#0D62AA]";display:inline-block}}@-webkit-keyframes _2Ia9lLthUfdUjdOtCQqQxl{0%{background-color:"[theme:themeLighter, default:#DEECF9]";color:"[theme:themeDark, default:#0D62AA]";display:inline-block;-webkit-animation-timing-function:cubic-bezier(.33,0,.67,1);animation-timing-function:cubic-bezier(.33,0,.67,1)}to{background-color:none;color:none;display:inline}}@-webkit-keyframes _1oldRGGSrcSFxv9Y7vQEqL{0%{background-color:"[theme:themeLighter, default:#DEECF9]";color:"[theme:themeDark, default:#0D62AA]";display:inline-block;-webkit-animation-timing-function:cubic-bezier(.33,0,.67,1);animation-timing-function:cubic-bezier(.33,0,.67,1)}to{background-color:none;color:none;display:inline}}@keyframes _2Ia9lLthUfdUjdOtCQqQxl{0%{background-color:"[theme:themeLighter, default:#DEECF9]";color:"[theme:themeDark, default:#0D62AA]";display:inline-block;-webkit-animation-timing-function:cubic-bezier(.33,0,.67,1);animation-timing-function:cubic-bezier(.33,0,.67,1)}to{background-color:none;color:none;display:inline}}@keyframes _1oldRGGSrcSFxv9Y7vQEqL{0%{background-color:"[theme:themeLighter, default:#DEECF9]";color:"[theme:themeDark, default:#0D62AA]";display:inline-block;-webkit-animation-timing-function:cubic-bezier(.33,0,.67,1);animation-timing-function:cubic-bezier(.33,0,.67,1)}to{background-color:none;color:none;display:inline}}._1aFK1bl8nu9HzQ8EPIECQr{-webkit-animation-duration:.1s;animation-duration:.1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;cursor:pointer;text-decoration:inherit}html[dir] ._1aFK1bl8nu9HzQ8EPIECQr{border-radius:2px;padding:0 1px}html[dir=ltr] ._1aFK1bl8nu9HzQ8EPIECQr{-webkit-animation-name:_1aFK1bl8nu9HzQ8EPIECQr;animation-name:_1aFK1bl8nu9HzQ8EPIECQr}html[dir=rtl] ._1aFK1bl8nu9HzQ8EPIECQr{-webkit-animation-name:_3Xt47js2Ol6TtHctPCq_zv;animation-name:_3Xt47js2Ol6TtHctPCq_zv}._1oldRGGSrcSFxv9Y7vQEqL{-webkit-animation-duration:.1s;animation-duration:.1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;cursor:pointer;text-decoration:inherit}html[dir] ._1oldRGGSrcSFxv9Y7vQEqL{border-radius:2px;padding:0 1px}html[dir=ltr] ._1oldRGGSrcSFxv9Y7vQEqL{-webkit-animation-name:_1oldRGGSrcSFxv9Y7vQEqL;animation-name:_1oldRGGSrcSFxv9Y7vQEqL}html[dir=rtl] ._1oldRGGSrcSFxv9Y7vQEqL{-webkit-animation-name:_2Ia9lLthUfdUjdOtCQqQxl;animation-name:_2Ia9lLthUfdUjdOtCQqQxl}',""]),t.locals={keywordFadeIn:"_1aFK1bl8nu9HzQ8EPIECQr","keywordFadeIn-rtl":"_3Xt47js2Ol6TtHctPCq_zv",keywordFadeOut:"_1oldRGGSrcSFxv9Y7vQEqL","keywordFadeOut-rtl":"_2Ia9lLthUfdUjdOtCQqQxl"}},18253:function(e,t,n){"use strict";n.r(t);var i=n(16814),o=n(6),r=n(1080),a=n(183),s=Object(a.action)("enableBrowserLocationOption")((function(){var e=Object(r.f)(r.c.SmartSuggestions);e&&(e.browserLocationEnabled=!0,r.h.importAndExecute(r.c.SmartSuggestions,e))})),c=n(2),l=Object(c.createStore)("smartSuggestionsPanelViewState",{latitude:"",longitude:""})(),u=Object(a.action)("setCurrentPosition")((function(e,t,n){void 0===n&&(n={store:l}),n.store.latitude=e,n.store.longitude=t})),d=n(20),m=n(1550),g=n(121),h=n(3563),f=n(2176),y=n(2306),p=n(2188),b=n(23),w=n(0),v=n(16815),k=n(378).bind(v),E="OWASUG",S=["image","gif"],O=["chains"],C='<br><a href="{0}" title="{1}" id="{2}"><img class="EmojiInsert" src="{3}" alt ="{2}" width="300px"></a><br>',x='<br><a href="{0}" title="{1}" id="{2}"><img class="EmojiInsert" src="{3}" alt ="{2}" width="300px" style="border: 1px solid #EEE;"></a><br>',j="https://www.bing.com",P="message";var _=Object(d.a)((function(e){var t=w.useRef();Object(f.c)(t,"escape",D),function(e){var t=w.useCallback((function(t){var n=E+Math.round(1e6*Math.random()).toString(),r=-1===S.indexOf(e.keyword.segment),a=Object(o.b)(i.a);return new Promise((function(e,i){var s=document.createElement("img");s.crossOrigin="anonymous",s.onload=function(){y.k.import().then((function(i){var c,l=i(s);l?c=l:(b.g.warn("SmartSuggestions: Couldn't create dataURI from card image"),c=t.imageUrl),e(Object(o.c)(r?x:C,t.searchLink,a,n,c))}))},s.onerror=function(){i("Error loading image")},s.src=t.imageUrl}))}),[e.keyword.segment]);Object(p.a)(P,(function(n){if(0===j.toLowerCase().indexOf(n.origin.toLowerCase())){var i=null;try{i=JSON.parse(n.data)}catch(e){b.g.warn("Unable to parse post message data: "+n.data)}if(i){var o=e.editor.getSelectionRange();e.editor.select(e.keywordElement,-3),Object(g.s)("SmartSuggestions_InsertCardInEditor",[e.keyword.segment]);var r={insertOnNewLine:!0,position:3,replaceSelection:!1,updateCursor:!1};t(i).then((function(t){return e.editor.insertContent(t,r)})).catch((function(e){return b.g.warn("Error creating card for SmartSuggestions: "+e)})),e.editor.select(o)}}}),[e.editor,e.keywordElement,e.keyword.segment,t])}(e),w.useEffect((function(){l()&&Object(r.f)(r.c.SmartSuggestions).browserLocationEnabled&&u()}),[]);var n,a,c,l=function(){return-1!==O.indexOf(e.keyword.segment)},u=w.useCallback((function(){var e={enableHighAccuracy:!1,maximumAge:0,timeout:3e4};navigator.geolocation.getCurrentPosition(I,A,e)}),[]),d=w.useCallback((function(e){e.stopPropagation(),s(),u()}),[u]),h=l()&&!Object(r.f)(r.c.SmartSuggestions).browserLocationEnabled,_={containerLocationHeight:h,containerNoLocationHeight:!h},T=(n=e.keyword.entity,a=e.keyword.segment,c=j+"/intelligentsuggestion/search?q="+n+"&intent="+a+"&setmkt=en-us&safesearch=strict&appid=D41D8CD98F00B204E9800998ECF8427E61385B59&FORM=OWAISS",l()&&Object(r.f)(r.c.SmartSuggestions).browserLocationEnabled&&""!==e.viewState.latitude&&""!==e.viewState.longitude&&(c+=Object(o.c)("&location=lat:{0};long:{1}",e.viewState.latitude,e.viewState.longitude)),c);return w.createElement("div",{className:k(v.container,_),ref:t},h&&w.createElement(m.a,{className:v.locationButton,iconProps:{iconName:"POI"},onClick:d,text:Object(o.b)(i.b)}),w.createElement("iframe",{src:T,className:v.pickerIframeStyle}))}));function D(e){e.stopPropagation(),h.a.importAndExecute()}function I(e){(null==e?void 0:e.coords)?u(e.coords.latitude.toString(),e.coords.longitude.toString()):b.g.warn("Browser returned success for getCurrentPosition, but with invalid position or coordinates")}function A(e){b.g.info("Error getting position from browser: "+e.message)}var T=n(16817),L=n(24),F="SmartSuggestionsKeyword";function N(e,t,n){var i=document.createElement("span");i.textContent=e,i.id=F+Math.round(1e6*Math.random()).toString(),i.title=Object(o.b)(T.a);var r=function(e){b.g.info("SmartSuggestions: keyword clicked"),n&&n(t,i)};return i.addEventListener("click",r),Object(L.i)("mc-smartPillsCompose")||z(i),{domElement:i,entityResult:t,onClickedHandler:r}}function K(e){e&&(e.mutationObserver&&(e.mutationObserver.disconnect(),e.mutationObserver=null),e.domElement&&(e.domElement.className="",e.domElement.id="",e.domElement.removeEventListener("click",e.onClickedHandler),e.domElement.title=""))}function Q(e){return 0===e.id.search(F)}var H=n(16818);function z(e){var t=(e.className||"").split(" ");t.indexOf(H.keywordFadeIn)<0&&(t.push(H.keywordFadeIn),e.className=t.join(" "))}var R=n(11531),q=n(1),M=n(203),G=n(217),B=n(151),U="cortana",Y="ows/api/beta/contextualSuggestions";function J(e,t){return Object(q.c)(this,void 0,void 0,(function(){var n;return Object(q.f)(this,(function(i){switch(i.label){case 0:return(e=e.toLocaleLowerCase())?[4,W(e,t)]:[3,2];case 1:if(n=i.sent())return b.g.info("[SmartSuggestions] contextualSuggestionLookup response: "+n),[2,X(n)];i.label=2;case 2:return[2,[]]}}))}))}function X(e){var t;return(null===(t=null==e?void 0:e.suggestedActions)||void 0===t?void 0:t.actions)&&e.suggestedActions.actions.length>0?[{entity:e.suggestedActions.actions[0].text,segment:U,score:1,initialQuery:e.suggestedActions.actions[0].text}]:[]}function W(e,t){return Object(q.c)(this,void 0,void 0,(function(){var n,i,o;return Object(q.f)(this,(function(r){switch(r.label){case 0:return n=t?t.map((function(e){return e.EmailAddress})).join(";"):"",i={useExperimentalModel:Object(L.i)("mc-contextualSuggestionsComposeExp"),emailContext:{content:e,to:{id:n}}},[4,Object(B.e)(Y,i,Object(M.a)(),!0)];case 1:if(o=r.sent(),Object(G.a)(o.status))try{return[2,o.json()]}catch(e){b.g.warn("[callCortanaService] Exception: "+e.message)}return[2,null]}}))}))}var V=/[.()+={}\[\]\s:;"',>!]+$/i,Z=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i;function $(e){if(!e||""===e)return!0;var t,n=(t=e,Z.exec(t));if(n&&n.length>0)return!0;var i=V.exec(e);return!!(i&&i.length>0)}function ee(e,t,n){if(t+1<e.length)return e.charAt(t+1);var i=n.currentBlockElement,o=n.getNextInlineElement();if(n.getPreviousInlineElement(),o&&o.getParentBlock()==i){var r=o.getTextContent();if(r&&r.length>0)return r.charAt(0)}return null}var te=function(e,t,n,i){var o=new Array;if(!t||0===t.length)return o;for(var r=e.getBodyTraverser(),a=r.currentInlineElement,s=0,c="",l=!1,u=e.getDocument().createRange(),d="";a;){if(a.isTextualInlineElement()){var m=0,g=a.getTextContent();for(n||(g=g.toLowerCase(),t=t.toLowerCase());m<g.length;){if(t.charCodeAt(s)!==g.charCodeAt(m)||i&&!l&&!$(d))l&&(l=!1,s=0,c="");else if(l||(u.setStart(a.getContainerNode(),m),l=!0),s++,(c+=g.charAt(m))===t){var h=ee(g,m,r);i&&!$(h)||(u.setEnd(a.getContainerNode(),m+1),o.push(u),u=e.getDocument().createRange()),s=0,c="",l=!1}d=g.charAt(m),m++}l||(s=0)}a=r.getNextInlineElement()}return o},ne=n(10458);function ie(e,t){var n;(null==e?void 0:e.keywords)&&(e.keywords.forEach((function(e){e.domElement===t&&(n=e)})),n&&(e.keywords=e.keywords.filter((function(e){return e.domElement!=t})),K(n),ne.c.importAndExecute(n.entityResult.entity)))}var oe=n(5105),re="gif",ae=["apologize","awesome","birthday cake","birthday party","bye bye","bye-bye","byebye","congrats","congratulations","fingers crossed","good job","good luck","good night","goodbye","goodnight","great job","happy anniversary","happy birthday","happy easter","happy friday","happy new year","happy thanksgiving","have a great day","high five","i love you","im so excited","its friday","kiss","merry christmas","merry xmas","oh my god","omg","shut up","super excited","thank you","thanks","welcome","you are awesome","you can do it","good bye","good deal","good evening","good morning","great work","heartbroken","i love you guys","so excited","thank you so much","thank you very much","well done","yummy"],se=["awesome","congrats","congratulations","goodbye","high five","kiss","omg","thank you","thanks","welcome","heartbroken","yummy"];var ce="ows/api/suggestions/getsuggestions";var le=n(10098),ue=n(209),de=n(4501),me="owaSmartSuggestionRemoveOnSend",ge=["celebrities","chains","flight","stock","sport","image","gif","cortana"],he="SmartSuggestions",fe="composePill";function ye(e,t,n,i,o,r,a,s){return Object(q.c)(this,void 0,void 0,(function(){var r,c,l;return Object(q.f)(this,(function(u){switch(u.label){case 0:return r=Object(M.a)(),c=function(e){var t=Object(oe.a)()?ae:se,n=t.length,i=[];e=e.toLocaleLowerCase();for(var o=0;o<n;o++)e.indexOf(t[o])>=0&&i.push(t[o]);return i.map((function(e){return{entity:e,segment:re,score:1}}))}(n),Object(L.i)("mc-contextualSuggestionsCompose")?[4,J(n,s)]:[3,2];case 1:l=u.sent(),c=c.concat(l),u.label=2;case 2:return c&&c.length>0&&c.forEach((function(n){b.g.info("SmartSuggestions: gif keyword ("+n.entity+") found in input string."),pe(e,n,o,t,a)})),i&&(b.g.info("SmartSuggestions: querying server for keywords in input string: "+n+". CorrelationId: "+r),function(e,t){var n={query:e,correlationId:t};return Object(B.e)(ce,n,t)}(n,r).then((function(n){!function(e,t,n,i,o,r){n&&t&&t.results&&t.results.length>0?t.results.forEach((function(o){b.g.info("SmartSuggestions: found keyword: "+o.entity+" in segment: "+o.segment+". CorrelationId: "+t.correlationId),pe(e,o,n,i,r)})):t?t.results&&0!==t.results.length||b.g.info("SmartSuggestions: no keywords found in query. CorrelationId: "+t.correlationId):b.g.warn("SmartSuggestions: no valid SmartSuggestions response received")}(e,n,o,t,0,a)}))),[2]}}))}))}function pe(e,t,n,i,o){var r=!1;if(t&&ge.includes(t.segment)){b.g.info("SmartSuggestions: keyword: "+t.entity+" is in allowed segment. Attempting to highlight");var a,s=n.getSelectionRange(),c=te(n,t.entity,!1,!0);c&&c.length>0&&(b.g.info("SmartSuggestions: found: "+c.length+" ranges for the keyword in the editor"),i.foundKeywords.includes(t.entity)||i.foundKeywords.push(t.entity),c.forEach((function(s){!function(e){var t;return!(null===(t=e.startContainer)||void 0===t||!t.parentElement)&&Q(e.startContainer.parentElement)}(s)?(a=N(s.toString(),t,o),(null==i?void 0:i.keywords)&&i.keywords.push(a),(r=e.replaceWithNode(n,s,a.domElement,!0))?(b.g.info("SmartSuggestions: keyword ("+t.entity+") inserted successfully."),function(e,t){try{var n=new MutationObserver((function(){ie(e,t.domElement)}));n.observe(t.domElement,{characterData:!0,subtree:!0}),t.mutationObserver=n}catch(e){b.g.warn("Error initializing MutationObserver for keyword wrapper. Message: "+e.message)}}(i,a)):b.g.warn("SmartSuggestions: keyword ("+t.entity+") was not inserted into the editor successfully"),a.domElement.className=(a.domElement.className||"")+" "+me,Object(g.s)("SmartSuggestions_CreateAndInsertKeyword",[t.segment])):b.g.info("SmartSuggestions: range is already highlighted. Moving on.")}))),Object(L.i)("mc-smartPillsCompose")&&function(e,t,n){var i;if(e.segment===re)i={ariaLabel:e.entity,featureName:he,onClick:function(i){t&&n&&t(e,n.domElement)},logData:Object(de.i)(he,fe),index:0,text:e.entity,id:e.entity,icon:{iconName:"Photo2"}};else if(e.segment===U){var o=e;i={ariaLabel:o.initialQuery,featureName:he,onClick:function(e){le.b.import().then((function(e){return e(Object(ue.d)(),o.initialQuery)}))},logData:Object(de.i)(he,fe),index:0,text:o.initialQuery,id:o.initialQuery,icon:{iconName:"Search"}}}i&&ne.b.importAndExecute(i)}(t,o,a),n.select(s)}return r}var be=1;function we(e,t){var n;(null==e?void 0:e.keywords)&&((null===(n=t.parentElement)||void 0===n?void 0:n.id)&&Q(t.parentElement)&&ie(e,t.parentElement),t.nodeType===be&&e.keywords.forEach((function(n){t.contains(n.domElement)&&ie(e,n.domElement)})))}var ve=n(2001);function ke(e,t,n){void 0===n&&(n=!1),!Object(L.i)("mc-smartPillsCompose")&&e&&e.keywords&&e.keywords.forEach((function(i){if(i.domElement)if(n)z(i.domElement);else{var o=t.getSelectionTraverser();if(o){var r=o.currentBlockElement;r&&r.contains(i.domElement)?z(i.domElement):e.highlightingKeywordsTemporarily||function(e){var t=(e.className||"").split(" "),n=t.indexOf(H.keywordFadeIn);n>=0&&(t.splice(n,1),e.className=t.join(" "))}(i.domElement)}}}))}var Ee=n(14),Se=n(4534),Oe=n(4808),Ce=n(19),xe=2e3,je=["en-us","en-ca"],Pe=function(){function e(e,t,n){var r=this;this.editorAdapter=e,this.getAllRecipientsWells=t,this.expressionId=n,this.onMouseOver=function(){r.state.keywords.length>0&&(r.state.highlightingKeywordsTemporarily||ke(r.state,r.editor,!0),r.startTemporaryKeywordHighlightingTimer())},this.onKeywordClicked=function(e,t){var n,a,s;e.segment==re?(r.editor.focus(),r.editor.select(t,-3),Oe.b.importAndExecute(!0,e.entity,"smartSuggestions",r.editorAdapter,r.expressionId,r.editor.getDocument().defaultView)):(n=e,a=t,s=r.editor,Object(g.s)("SmartSuggestions_OpenFlexPane",[n.segment]),a.innerText.toLowerCase()!==n.entity.toLowerCase()&&Object(g.s)("SmartSuggestions_KeywordMismatch"),h.b.importAndExecute(w.createElement(_,{keyword:n,keywordElement:a,editor:s,viewState:l}),{headerText:Object(o.b)(i.c),headerClassName:v.header,overlayOnSmallWidth:!1}))},this.startTemporaryKeywordHighlightingTimer=function(){r.state.highlightingKeywordsTemporarily=!0,r.temporaryKeywordHighlightingTimer&&clearTimeout(r.temporaryKeywordHighlightingTimer),r.temporaryKeywordHighlightingTimer=setTimeout(r.temporaryKeywordHighlightingTimerExpired,xe)},this.temporaryKeywordHighlightingTimerExpired=function(){r.temporaryKeywordHighlightingTimer=null,r.state.highlightingKeywordsTemporarily=!1,ke(r.state,r.editor)},this.state={keywords:[],foundKeywords:[]}}return e.prototype.getName=function(){return"SmartSuggestion"},e.prototype.setPluginUtils=function(e){this.pluginUtils=e},e.prototype.initialize=function(e){this.editor=e,this.temporaryKeywordHighlightingTimer=null,this.options=Object(Ee.computed)((function(){return Object(r.f)(r.c.SmartSuggestions)})),this.onMouseOverDisposer=this.editor.addDomEventHandler("mouseover",this.onMouseOver);var t=Object(Ce.a)().SessionSettings.UserCulture;t&&je.includes(t.toLowerCase())&&(this.isEnabledForSupportedMarkets=!0)},e.prototype.dispose=function(){this.logCategorySummary(),function(e){if(null==e?void 0:e.keywords)for(;e.keywords.length>0;)K(e.keywords.pop())}(this.state),Se.a.importAndExecute(this.expressionId,this.editor.getDocument().defaultView),this.editor=null,this.options=null,this.temporaryKeywordHighlightingTimer&&(clearTimeout(this.temporaryKeywordHighlightingTimer),this.temporaryKeywordHighlightingTimer=null),this.onMouseOverDisposer&&(this.onMouseOverDisposer(),this.onMouseOverDisposer=null)},e.prototype.onPluginEvent=function(e){var t,n;if(this.options.get().smartSuggestionsEnabled&&this.isEnabledForSupportedMarkets)if(0===e.eventType)this.removeKeywordIfNecessary(e.rawEvent);else if(2===e.eventType){var i=e.rawEvent;if(i.which===R.f||i.which===R.m){var o=this.getContentBeforeCursor();if(o&&""!==o){var r=(n=this.getAllRecipientsWells(),(null==(t=n[0])?void 0:t.recipients)?t.recipients.map((function(e){return e.persona.EmailAddress})):[]);ye(this.pluginUtils,this.state,o,!1,this.editor,this.startTemporaryKeywordHighlightingTimer,this.onKeywordClicked,r)}}this.state.keywords.length>0&&ke(this.state,this.editor)}else 10==e.eventType?e.sanitizingOption.additionalAllowedCssClasses.push(me):8==e.eventType&&function(e){for(var t=e.querySelectorAll("."+me),n=0;n<t.length;n++)Object(ve.unwrap)(t[n])}(e.clonedRoot)},e.prototype.getContentBeforeCursor=function(){if(null!==this.editor){var e=this.editor.getBodyTraverser(),t=e.currentInlineElement,n=this.editor.getDocument().defaultView.getSelection();if(n)for(var i=n.anchorNode;t&&t.getContainerNode()!=i;)t=e.getNextInlineElement();if(t)return this.extractText(e)}return""},e.prototype.extractText=function(e){for(var t="",n=e.currentInlineElement,i=null;t.length<100&&null!==n;){var o=null===i||!i.contains(n.getContainerNode());t=n.getTextContent()+(o?" ":"")+t,i=n.getParentBlock(),n=e.getPreviousInlineElement()}return t},e.prototype.keycodeIsPrintable=function(e){return e===R.b||e===R.f||e===R.m||e===R.e||e>=R.c&&e<=R.d||e>=R.g&&e<=R.h||e>=R.i&&e<=R.j||e>=R.l&&e<=R.n||e>=R.k&&e<=R.a},e.prototype.removeKeywordIfNecessary=function(e){if(this.state.keywords.length>0&&this.keycodeIsPrintable(e.which)){var t=this.editor.getSelectionRange();(null==t?void 0:t.startContainer)&&(t.collapsed?t.startContainer.parentNode&&Q(t.startContainer.parentNode)&&ie(this.state,t.startContainer.parentNode):(we(this.state,t.startContainer),t.endContainer!==t.startContainer&&we(this.state,t.endContainer)))}},e.prototype.logCategorySummary=function(){if(this.state.keywords.length>0){var e={};this.state.keywords.forEach((function(t){if(t.entityResult){var n=t.entityResult.segment;e[n]=n in e?e[n]+1:1}})),Object(g.s)("SmartSuggestions_CategorySummary",e)}},e}();t.default=Pe},2188:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(0),o={};function r(e){var t;null===(t=o[e.type])||void 0===t||t.forEach((function(t){return t(e)}))}function a(e){var t;return o[e]=null!==(t=o[e])&&void 0!==t?t:new Map}function s(e,t,n){var o=i.useRef();i.useEffect((function(){return function(e,t,n){var i=a(e);0===i.size&&window.addEventListener(e,r),i.set(t,n)}(e,o,t),function(){return function(e,t){var n=a(e);n.delete(t),0===n.size&&window.removeEventListener(e,r)}(e,o)}}),n)}},3563:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var i=n(31),o=new i.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(6),n.e(640)]).then(n.bind(null,5379))})),r=new i.a(o,(function(e){return e.mountAndShowFlexPane})),a=new i.a(o,(function(e){return e.hideFlexPane}))},4501:function(e,t,n){"use strict";var i=n(1),o=2500,r=n(121),a=n(414);function s(e,t,n){var i=new a.a(e,t,{isCore:!0,excludeFromKusto:!0});n&&i.addCosmosOnlyData(n),r.o.importAndExecute(i)}function c(e,t,n,a,c){return Object(i.c)(this,void 0,void 0,(function(){var l,u,d,m,g,h,f,y,p,b;return Object(i.f)(this,(function(i){switch(i.label){case 0:return l={},u=c||o,n?[4,Promise.all(n.map((function(e){return e.preRun().catch((function(t){l[e.getName()]=new Error(t)}))})))]:[3,2];case 1:i.sent(),i.label=2;case 2:return(d=new r.b("SmartPillPerformance",{sessionSampleRate:10})).addCustomProperty("preDefinedTimeout",u),[4,Promise.all(e.map((function(e){return Promise.race([e.buildPills(),(t=u,new Promise((function(e,n){setTimeout((function(){var e=new Error("timeout");e.networkError=!0,n(e)}),t)})))]).catch((function(t){return l[e.getName()]=new Error(t),[]}));var t}))).then((function(e){return d.end(),e}))];case 3:m=i.sent(),g=[].concat.apply([],m),h=g.length,a&&a.map((function(e){try{e.updateLogData(g)}catch(t){l[e.getName()]=new Error(t)}})),f={pillsToShow:[],pillsToHide:[],arbitratorId:""};try{f=t.arbitratePills(g)}catch(e){l.arbitrator=new Error(e)}return(y=Object.keys(l)).length>0&&(p=[],b=[],y.forEach((function(e){var t=l[e];t.hasOwnProperty("networkError")?p.push(e+"_"+t.message):b.push(e+"_"+t.message)})),s("SmartPillError",[p.toString(),b.toString(),h])),[2,f]}}))}))}function l(e,t,n,i,o){return{mainPayload:{renderStory:0,loggableText:t,type:e,position:-1,EID:n,confidenceScore:i},cosmosOnlyData:o}}function u(e,t,n){var i=void 0;e.concat(t).forEach((function(e){!i&&e.logData.cosmosOnlyData&&(i=e.logData.cosmosOnlyData)}));var o={data:e.map((function(e){return e.logData.mainPayload}))},r={data:t.map((function(e){return e.logData.mainPayload}))},a=e.length>0?e[0].logData.mainPayload.language:null;s("SmartPillsRendered",[e.length,t.length,JSON.stringify(o),JSON.stringify(r),n,a],i)}function d(e,t,n){var o=(new Date).toISOString(),r={data:[Object(i.a)(Object(i.a)(Object(i.a)({},t.mainPayload),{timeClicked:o}),n)]};s(e,[JSON.stringify(r),t.mainPayload.language],t.cosmosOnlyData)}n.d(t,"h",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"l",(function(){return s})),n.d(t,"d",(function(){return"SmartPillClicked"})),n.d(t,"e",(function(){return"SmartPillMenuOpened"})),n.d(t,"g",(function(){return"SmartTimeMenuClicked"})),n.d(t,"a",(function(){return"SmartDocMenuClicked"})),n.d(t,"b",(function(){return"SmartDocMenuClosed"})),n.d(t,"c",(function(){return"SmartDocSpinnerDisposed"})),n.d(t,"f",(function(){return"SmartReplyMenuClicked"}))},5105:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(19);function o(){return!Object(i.a)().UserOptions.OutlookGifPickerDisabled}}}]);
//# sourceMappingURL=owa.MailBoot~SmartSuggestions.js.map
self.scriptsLoaded['owa.MailBoot~SmartSuggestions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SmartSuggestions.js'] = (new Date()).getTime();