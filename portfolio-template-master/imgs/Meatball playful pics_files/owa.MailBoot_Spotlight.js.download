self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Spotlight.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[827],{1083:function(e,t,n){"use strict";var r=n(1),i=n(20),o=n(642),a=n(0),c=n.n(a);function u(e,t){var n=function(t,n){return c.a.createElement(s,Object(r.a)({},t),c.a.createElement(e,Object(r.a)({},t)))};return n.displayName=e.displayName,t?c.a.forwardRef(n):n}var s=Object(i.a)((function(e){var t=e.lid,n=e.when,r=e.series,i=e.children,a=e.disposeOnUnmount,u=void 0===a||a;return c.a.useEffect((function(){return Object(o.b)(t,n,r),function(){u&&o.c.importAndExecute(t)}}),[]),i&&d(t)?c.a.createElement(c.a.Fragment,null,i):null}));function l(e,t){o.c.importAndExecute(e,t)}function d(e){if(o.d.unseenItems){var t=o.d.unseenItems.get(e);if(null==t?void 0:t.visible)return!0}return!1}function f(e){var t;return null===(t=o.d.unseenItems)||void 0===t?void 0:t.has(e)}n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return o.a}))},1097:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(41),i=n(71);function o(){var e,t=null===(e=Object(r.a)())||void 0===e?void 0:e.pathname;if(t){var n=t.split("/"+Object(i.a)()+"/")[1];if(n){var o=n.split("/")[0];if(o&&!isNaN(parseInt(o)))return!0}}return!1}},113:function(e,t,n){"use strict";var r;!function(e){e.Mail="Mail",e.Calendar="Calendar",e.People="People",e.FilesHub="FilesHub",e.Tasks="Tasks",e.OutlookSpaces="OutlookSpaces",e.Eventify="Eventify",e.PublishedCalendar="PublishedCalendar",e.MailDeepLink="MailDeepLink",e.OrgExplorer="OrgExplorer",e.AppHost="AppHost",e.CalendarDeepLink="CalendarDeepLink"}(r||(r={})),n.d(t,"a",(function(){return r}))},1286:function(e,t,n){"use strict";var r=n(768),i=n(3),o=n(0),a=n(604),c=n(713),u=n(622),s=Object(c.a)(),l=function(e,t){o.useImperativeHandle(e.componentRef,(function(){return{focus:function(){t.current&&t.current.focus()}}}),[t])},d=function(e,t){t.as;var n=t.disabled,r=t.target,o=t.href,a=(t.theme,t.getStyles,t.styles,t.componentRef,t.underline,Object(i.__rest)(t,["as","disabled","target","href","theme","getStyles","styles","componentRef","underline"]));return"string"==typeof e?"a"===e?Object(i.__assign)({target:r,href:n?void 0:o},a):"button"===e?Object(i.__assign)({type:"button",disabled:n},a):Object(i.__assign)(Object(i.__assign)({},a),{disabled:n}):Object(i.__assign)({target:r,href:o,disabled:n},a)},f=o.forwardRef((function(e,t){var n=function(e,t){var n=e.as,r=e.className,c=e.disabled,f=e.href,b=e.onClick,g=e.styles,h=e.theme,p=e.underline,m=o.useRef(null),v=Object(a.a)(m,t);l(e,m),Object(u.b)(m);var O=s(g,{className:r,isButton:!f,isDisabled:c,isUnderlined:p,theme:h}),y=n||(f?"a":"button");return{state:{},slots:{root:y},slotProps:{root:Object(i.__assign)(Object(i.__assign)({},d(y,e)),{"aria-disabled":c,className:O.root,onClick:function(e){c?e.preventDefault():b&&b(e)},ref:v})}}}(e,t),r=n.slots,c=n.slotProps;return o.createElement(r.root,Object(i.__assign)({},c.root))}));f.displayName="LinkBase";var b=n(7),g={root:"ms-Link"};n.d(t,"a",(function(){return h}));var h=Object(r.a)(f,(function(e){var t,n,r,i,o,a,c=e.className,u=e.isButton,s=e.isDisabled,l=e.isUnderlined,d=e.theme,f=d.semanticColors,h=f.link,p=f.linkHovered,m=f.disabledText,v=f.focusBorder,O=Object(b.getGlobalClassNames)(g,d);return{root:[O.root,d.fonts.medium,{color:h,outline:"none",fontSize:"inherit",fontWeight:"inherit",textDecoration:l?"underline":"none",selectors:(t={".ms-Fabric--isFocusVisible &:focus":{boxShadow:"0 0 0 1px "+v+" inset",outline:"1px auto "+v,selectors:(n={},n[b.HighContrastSelector]={outline:"1px solid WindowText"},n)}},t[b.HighContrastSelector]={borderBottom:"none"},t)},u&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:(r={},r[b.HighContrastSelector]={color:"LinkText",forcedColorAdjust:"none"},r)},!u&&{selectors:(i={},i[b.HighContrastSelector]={MsHighContrastAdjust:"auto",forcedColorAdjust:"auto"},i)},s&&["is-disabled",{color:m,cursor:"default"},{selectors:{"&:link, &:visited":{pointerEvents:"none"}}}],!s&&{selectors:{"&:active, &:hover, &:active:hover":{color:p,textDecoration:"underline",selectors:(o={},o[b.HighContrastSelector]={color:"LinkText"},o)},"&:focus":{color:h,selectors:(a={},a[b.HighContrastSelector]={color:"LinkText"},a)}}},O.root,c]}}),void 0,{scope:"Link"})},1294:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(44),i=n(873);function o(e,t){Object.keys(i.a).some((function(n){return i.a[n]==t&&(Object(r.h)(e,{key:n,id:t},{isCore:!0}),!0)}))}},1303:function(e,t,n){"use strict";var r=n(448),i=n(303);t.a=function(e){return Object(i.a)(e)&&Object(r.a)(e)}},14235:function(e){e.exports=JSON.parse('{"g":"Q6b","a":"R6b","b":"S6b","c":"T6b","e":"U6b","h":"V6b","d":"W6b","f":"X6b"}')},14236:function(e){e.exports=JSON.parse('{"d":"M6b","b":"N6b","c":"O6b","a":"P6b"}')},14237:function(e,t,n){var r=n(14238),i=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},14238:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._2t_YuvrnMoftIhDSxPL3L3{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}html[dir] ._2t_YuvrnMoftIhDSxPL3L3{margin:16px 10px 10px 10px}._23UchxzLy_bId29e4Mph94,._2a-YRY6qdxYIUv34sLJQX1{display:-webkit-box;display:-ms-flexbox;display:flex;z-index:1}html[dir] ._23UchxzLy_bId29e4Mph94,html[dir] ._2a-YRY6qdxYIUv34sLJQX1{background-color:"[theme:white, default:#ffffff]";margin:10px}._23UchxzLy_bId29e4Mph94{-webkit-box-align:center;-ms-flex-align:center;align-items:center}._3ajymfC40zutWx8Z-93dYz{-webkit-box-sizing:border-box;box-sizing:border-box;height:16px;top:-8px;width:16px;z-index:0}html[dir] ._3ajymfC40zutWx8Z-93dYz{background-color:"[theme:white, default:#ffffff]";margin-bottom:-20px}html[dir=ltr] ._3ajymfC40zutWx8Z-93dYz{-webkit-transform:rotate(45deg);transform:rotate(45deg)}html[dir=rtl] ._3ajymfC40zutWx8Z-93dYz{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}.qj8qTQwyhGXKO6-2_-y92,._2JHlzfVUfuLkgGafN5tOWY{font-size:16px;font-weight:600;line-height:22px}html[dir] ._2JHlzfVUfuLkgGafN5tOWY{margin-bottom:4px;margin-top:12px}.qj8qTQwyhGXKO6-2_-y92{-ms-flex-negative:0;flex-shrink:0}html[dir=ltr] .qj8qTQwyhGXKO6-2_-y92{margin-right:16px}html[dir=rtl] .qj8qTQwyhGXKO6-2_-y92{margin-left:16px}._2lSS6u9zZ93yWwgpuG-YAP,.W8EDApUZxuOlVV1YNC65W{font-size:14px;color:"[theme:neutralSecondary, default:#605e5c]";line-height:20px}html[dir=ltr] ._2lSS6u9zZ93yWwgpuG-YAP,html[dir=ltr] .W8EDApUZxuOlVV1YNC65W{margin-right:20px}html[dir=rtl] ._2lSS6u9zZ93yWwgpuG-YAP,html[dir=rtl] .W8EDApUZxuOlVV1YNC65W{margin-left:20px}html[dir] .W8EDApUZxuOlVV1YNC65W{margin-bottom:4px}html[dir] ._2lSS6u9zZ93yWwgpuG-YAP{padding:4px 0}._3RUb1lwOpSXQLb2nCjK23G{width:80px}html[dir] ._3RUb1lwOpSXQLb2nCjK23G{padding:12px 12px 0 12px}._BytrGnWvJKEh2B6exlqa{-ms-flex-negative:0;flex-shrink:0;width:32px}html[dir=ltr] ._BytrGnWvJKEh2B6exlqa{padding:8px 12px 8px 8px}html[dir=rtl] ._BytrGnWvJKEh2B6exlqa{padding:8px 8px 8px 12px}._2_UiTmP_uzcdTrVrwV-hOr,._1T17AHOu4CZxfvbPhXSco6{-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:"[theme:green20, default:#0b6a0b]";display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}html[dir] ._2_UiTmP_uzcdTrVrwV-hOr,html[dir] ._1T17AHOu4CZxfvbPhXSco6{background-color:#e3f4e2;border-radius:50%;-webkit-transform:scaleX(-1);transform:scaleX(-1)}._1T17AHOu4CZxfvbPhXSco6{font-size:32px;height:56px;width:56px}._2_UiTmP_uzcdTrVrwV-hOr{font-size:20px;height:32px;width:32px}._2jKBvUyGUuH8WQ3ZrFppl_{-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:"[theme:green20, default:#0b6a0b]";display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;font-size:12px}html[dir] ._2jKBvUyGUuH8WQ3ZrFppl_{-webkit-transform:scaleX(-1);transform:scaleX(-1)}html[dir=ltr] ._2jKBvUyGUuH8WQ3ZrFppl_,html[dir=rtl] ._2jKBvUyGUuH8WQ3ZrFppl_{margin-left:2px;margin-right:2px}._3NRWmHRrhGIYN0q11rFWw4,.QhB-rPYx0qa0xEcuoUHaO{font-size:14px;font-weight:600;height:20px;line-height:20px;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}html[dir] .QhB-rPYx0qa0xEcuoUHaO{margin-bottom:12px}._3NRWmHRrhGIYN0q11rFWw4{-ms-flex-negative:0;flex-shrink:0}html[dir=ltr] ._3NRWmHRrhGIYN0q11rFWw4{margin-right:12px}html[dir=rtl] ._3NRWmHRrhGIYN0q11rFWw4{margin-left:12px}',""]),t.locals={container:"_2t_YuvrnMoftIhDSxPL3L3",contentSlv:"_23UchxzLy_bId29e4Mph94",contentThreeColumn:"_2a-YRY6qdxYIUv34sLJQX1",beak:"_3ajymfC40zutWx8Z-93dYz",titleSlv:"qj8qTQwyhGXKO6-2_-y92",titleThreeColumn:"_2JHlzfVUfuLkgGafN5tOWY",descriptionSlv:"_2lSS6u9zZ93yWwgpuG-YAP",descriptionThreeColumn:"W8EDApUZxuOlVV1YNC65W",iconContainerThreeColumn:"_3RUb1lwOpSXQLb2nCjK23G",iconContainerSlv:"_BytrGnWvJKEh2B6exlqa",iconSlv:"_2_UiTmP_uzcdTrVrwV-hOr",iconThreeColumn:"_1T17AHOu4CZxfvbPhXSco6",iconInDescription:"_2jKBvUyGUuH8WQ3ZrFppl_",gotItButtonSlv:"_3NRWmHRrhGIYN0q11rFWw4",gotItButtonThreeColumn:"QhB-rPYx0qa0xEcuoUHaO"}},18206:function(e,t,n){"use strict";n.r(t);var r,i=n(2),o=Object(i.action)("onCacheUpdated",(function(e,t){return{interactionType:e,triageContext:t}})),a=Object(i.action)("onSpotlightDismissedFromRP",(function(e){return{rowKey:e}})),c=Object(i.action)("onSpotlightDismissedFromRPProcessed",(function(e){return{rowKey:e}})),u=Object(i.action)("onSpotlightItemsFetched",(function(e,t,n){return{spotlightItems:e,isConversationView:t,requestStartTime:n}})),s=n(2793);!function(e){e[e.Unknown=0]="Unknown",e[e.Weak=1]="Weak",e[e.Strong=2]="Strong"}(r||(r={}));var l=function(e){switch(e){case"CreateRule":case"MarkAsRead":case"MarkAsReadImplicit":case"MarkAsUnread":case"Snooze":return r.Weak;case"Block":case"Categorize":case"Delete":case"Flag":case"FlagCleared":case"FlagComplete":case"Forward":case"Ignore":case"Like":case"MarkAsJunk":case"MarkAsPhishing":case"Move":case"Pin":case"Reaction":case"Reply":case"ReplyAll":case"ReportAbuse":case"Unpin":return r.Strong;default:return r.Unknown}},d=n(1);function f(e){var t,n,r=Object(s.a)().spotlightItems;try{for(var i=Object(d.k)(r),o=i.next();!o.done;o=i.next()){var a=o.value;if(a.rowKey===e)return a}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return null}var b,g=n(121),h=n(2229),p=n(2123),m=n(19),v=[],O=function(e){var t=Object(m.a)().SessionSettings,n=t.UserPuid,r=t.ExternalDirectoryTenantGuid;h.p.importAndExecute(p.c.ContextualInsights,n,r,Object(s.a)().logicalId,null,f(e).referenceId,"EntityClicked"),Object(g.s)("Spotlight_ItemClicked")},y=function(){var e=Object(s.a)(),t=e.logicalId,n=e.requestStartTime,r=e.spotlightItems;-1===v.indexOf(t)&&(v.push(t),h.m.importAndExecute(p.c.ContextualInsights,t,null,Date.now()-n),Object(g.s)("Spotlight_SetRendered",{hasSpotlightItems:r.length>0,logicalId:t}))},j=n(2719),I=n(5),S=n(203),w=n(1947),x=n(7832),C=n(8),k=n(11);!function(e){e[e.Acknowledged=0]="Acknowledged",e[e.Dismissed=1]="Dismissed"}(b||(b={}));var T=function(e,t){var n,r,i=E(e);try{for(var o=Object(d.k)(t),a=o.next();!a.done;a=o.next()){var c=a.value;i.push(c)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}Object(k.e)(window,M(e),JSON.stringify(i))},P=function(e){var t,n,r=e.spotlightCacheType,i=e.itemId,o=e.conversationId,a=e.rowKey,c=E(r);try{for(var u=Object(d.k)(c),s=u.next();!s.done;s=u.next()){var l=s.value;if(i&&l.itemId===i||o&&l.conversationId===o||a&&l.rowKey===a)return!0}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return!1},A=function(e,t){var n,r,i,o,a=E(e),c=[];try{for(var u=Object(d.k)(a),s=u.next();!s.done;s=u.next()){var l=s.value,f=l.itemId,b=l.conversationId,g=l.rowKey;try{for(var h=(i=void 0,Object(d.k)(t)),p=h.next();!p.done;p=h.next()){var m=p.value,v=m.itemId,O=m.conversationId,y=m.rowKey;if(f&&f===v||b&&b===O||g&&g===y){c.push(m);break}}}catch(e){i={error:e}}finally{try{p&&!p.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}Object(k.e)(window,M(e),JSON.stringify(c))},E=function(e){var t=Object(k.a)(window,M(e));return t?JSON.parse(t):[]},M=function(e){return e===b.Acknowledged?"acknowledgedSpotlightItems":"dismissedSpotlightItems"};Object(i.mutator)(u,(function(e){var t=e.spotlightItems,n=e.isConversationView,r=e.requestStartTime,i=F(),o=t.concat(i),a=[],c=o.concat(i).filter((function(e){var t=n?e.conversationId:e.itemId;return!(a.indexOf(t)>-1)&&(a.push(t),!0)}));!function(e){A(b.Acknowledged,e),A(b.Dismissed,e)}(c);var u=c.filter((function(e){return!e.isDismissed}));Object(s.a)().spotlightItems=u,Object(s.a)().logicalId=Object(S.a)(),Object(s.a)().requestStartTime=r,0===u.length&&y()})),Object(i.mutator)(c,(function(e){for(var t=e.rowKey,n=Object(s.a)().spotlightItems,r=0;r<n.length;r++){if(n[r].rowKey===t){n.splice(r,1);break}}})),Object(i.mutator)(o,(function(e){if(Object(j.a)()){var t=e.triageContext,n=void 0===t?{}:t,i=e.interactionType,o=n.itemIds,a=void 0===o?[]:o,c=n.conversationIds,u=void 0===c?[]:c,s=n.rowKeys,d=void 0===s?[]:s;if(a=a.filter((function(e){return!!e})),u=u.filter((function(e){return!!e})),d=d.filter((function(e){return!!e})),0!==a.length||0!==u.length||0!==d.length)switch(l(i)){case r.Weak:R({itemIds:a,conversationIds:u,rowKeys:d,actionCategory:r.Weak});break;case r.Strong:R({itemIds:a,conversationIds:u,rowKeys:d,actionCategory:r.Strong});break;case r.Unknown:}}})),Object(i.mutator)(x.a,(function(){Object(s.a)().spotlightItems=[]}));var R=function(e){var t=e.itemIds,n=e.conversationIds,i=e.rowKeys,o=e.actionCategory,a=Object(s.a)().spotlightItems;a.map((function(e,c){(t.indexOf(e.itemId)>-1||n.indexOf(e.conversationId)>-1||i.indexOf(e.rowKey)>-1)&&(o===r.Weak?e.isAcknowledged=!0:o===r.Strong&&a.splice(c,1))}))},F=function(){var e=[],t=Object(C.a)("testSpotlight");if(t)for(var n=Object(w.J)(),r=parseInt(t),i=0;i<r;i++){var o=n.rowKeys[i],a=w.b.getItemIds(o,n)[0],c=w.b.getConversationId(o,n);o&&e.push({rowKey:o,itemId:a,conversationId:c,isAcknowledged:P({spotlightCacheType:b.Acknowledged,itemId:a,conversationId:c,rowKey:o}),isDismissed:P({spotlightCacheType:b.Dismissed,itemId:a,conversationId:c,rowKey:o}),reason:0,senderName:w.b.getLastSenderMailbox(o,n).Name,referenceId:"00000000-0000-0000-0000-000000000000",dateTimeReceived:Object(I.Sb)(w.b.getLastDeliveryTimeStamp(o,n))})}return e},_=Object(i.action)("onSpotlightFilterLoaded",(function(e){return{actionSource:e}}));Object(i.mutator)(_,(function(){Object(s.a)().spotlightItems.map((function(e){return e.isAcknowledged=!0}))}));var D=n(2474),N=n(2044),L=n(8217),U=n(2185);Object(i.orchestrator)(a,(function(e){var t=e.rowKey;T(b.Dismissed,[{rowKey:t}]);var n=f(t),r=n.conversationId,i=n.itemId,o=n.referenceId,a=Object(m.a)().SessionSettings;h.p.importAndExecute(U.b.ContextualInsights,a.UserPuid,a.ExternalDirectoryTenantGuid,Object(s.a)().logicalId,null,o,"SpotlightDismissed");var u=Object(w.J)();u&&Object(g.s)("Spotlight_ItemDismissed",{isImportantFilter:"spotlight"===u.tableQuery.scenarioType,conversationId:Object(w.S)(u)?r:null,itemId:Object(w.S)(u)?null:i}),K(t,Object(L.a)().tableQuery),c(t)}));var K=function(e,t){var n=Object(d.a)(Object(d.a)({},t),{scenarioType:"spotlight"});Object(D.a)([e],Object(N.c)(n),"Spotlight",!1)};function z(e){var t=e.itemId,n=e.conversationId,r=e.rowKey,i=Object(s.a)().spotlightItems.filter((function(e){return t&&e.itemId===t||n&&e.conversationId===n||r&&e.rowKey===r}));return i.length>0?i[0]:null}Object(i.orchestrator)(_,(function(e){Object(g.s)("Spotlight_FilterLoaded",[e.actionSource])}));var W=n(2638);Object(i.orchestrator)(W.d,(function(e){if(Object(j.a)()){var t=e.triageContext,n=void 0===t?{}:t,i=e.interactionType,a=n.itemIds,c=void 0===a?[]:a,u=n.conversationIds,s=void 0===u?[]:u,d=n.rowKeys,f=void 0===d?[]:d;if(c=c.filter((function(e){return!!e})),s=s.filter((function(e){return!!e})),f=f.filter((function(e){return!!e})),0!==c.length||0!==s.length||0!==f.length){var g=[],h=l(i)===r.Strong?b.Dismissed:b.Acknowledged;c.map((function(e){var t=z({itemId:e});t&&!P({spotlightCacheType:h,itemId:e,rowKey:t.rowKey})&&(T(h,[{itemId:e,rowKey:t.rowKey}]),H(g,t.referenceId,i))})),s.map((function(e){var t=z({conversationId:e});t&&!P({spotlightCacheType:h,conversationId:e,rowKey:t.rowKey})&&(T(h,[{conversationId:e,rowKey:t.rowKey}]),H(g,t.referenceId,i))})),f.map((function(e){var t=z({rowKey:e});t&&!P({spotlightCacheType:h,rowKey:e})&&(T(h,[{rowKey:e}]),H(g,t.referenceId,i))})),o(i,n)}}})),Object(i.orchestrator)(_,(function(){G()}));var G=function(){var e=Object(s.a)().spotlightItems.map((function(e){return{itemId:e.itemId,conversationId:e.conversationId,rowKey:e.rowKey}}));T(b.Acknowledged,e)},H=function(e,t,n){t&&-1===e.indexOf(t)&&(!function(e,t){if(e){var n=Object(m.a)().SessionSettings,r=n.UserPuid,i=n.ExternalDirectoryTenantGuid;h.p.importAndExecute(p.c.ContextualInsights,r,i,Object(s.a)().logicalId,null,e,t),Object(g.s)("Spotlight_ItemInteraction",{interactionType:t})}}(t,n),e.push(t))};function B(e,t){var n,r,i,o,a;return{Categories:e.Categories,ConversationId:e.ConversationId&&{Id:e.ConversationId.Id,ChangeKey:null},ConversationTopic:e.Subject,FlagStatus:null===(n=e.Flag)||void 0===n?void 0:n.FlagStatus,FolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},From:e.From&&{Mailbox:{EmailAddress:e.From.EmailAddress.Address,Name:e.From.EmailAddress.Name,RoutingType:"SMTP"}},GlobalItemIds:[{Id:e.ItemId.Id,ChangeKey:null}],GlobalMessageCount:1,GlobalUnreadCount:e.IsRead?0:1,HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,HasIrm:null,Importance:e.Importance,ItemClasses:e.ItemClasses||["IPM.Note"],ItemIds:[{Id:e.ItemId.Id,ChangeKey:null}],LastDeliveryOrRenewTime:e.DateTimeReceived,LastDeliveryTime:e.DateTimeReceived,LastModifiedTime:e.DateTimeLastModified,MessageCount:1,ParentFolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},Preview:e.Preview,SenderSMTPAddress:null===(i=null===(r=e.Sender)||void 0===r?void 0:r.EmailAddress)||void 0===i?void 0:i.Address,UniqueSenders:[null===(a=null===(o=e.Sender)||void 0===o?void 0:o.EmailAddress)||void 0===a?void 0:a.Name],UnreadCount:e.IsRead?0:1,InstanceKey:t}}function V(e,t){var n;return{Categories:e.Categories,ConversationId:e.ConversationId&&{Id:e.ConversationId.Id,ChangeKey:null},ConversationIndex:e.ConversationIndex,DateTimeReceived:e.DateTimeReceived,DateTimeSent:e.DateTimeSent,LastModifiedTime:e.DateTimeLastModified,DisplayBcc:e.DisplayBcc,DisplayCc:e.DisplayCc,DisplayTo:e.DisplayTo,Flag:e.Flag&&{FlagStatus:e.Flag.FlagStatus,CompleteDate:e.Flag.CompleteDate,DueDate:e.Flag.DueDate,StartDate:e.Flag.StartDate},From:e.From&&{Mailbox:{EmailAddress:e.From.EmailAddress.Address,Name:e.From.EmailAddress.Name,RoutingType:"SMTP"}},HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,Importance:e.Importance,IsDraft:e.IsDraft,IsRead:e.IsRead,ItemClass:e.ItemClass||"IPM.Note",ItemId:{Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey},ParentFolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},Preview:e.Preview,Sender:e.Sender&&{Mailbox:{EmailAddress:e.Sender.EmailAddress.Address,Name:e.Sender.EmailAddress.Name,RoutingType:"SMTP"}},Sensitivity:e.Sensitivity,Subject:e.Subject,MentionedMe:null===(n=e.MentionsPreview)||void 0===n?void 0:n.IsMentioned,InstanceKey:t}}var q=Object(i.mutatorAction)("onSpotlightRowsAppendedToTable",(function(e){Object(s.a)().spotlightTableQuery=e})),Y=n(266),Q=n(2050);function J(e,t,n){var r,i,o,a,c,u,s,l,f;return Object(d.c)(this,void 0,void 0,(function(){var g,m,v,O,y,j,S,x,C,k,T,A,E,M,R,F,_,D,L;return Object(d.f)(this,(function(U){switch(U.label){case 0:return g=[],m=[],v=Object(w.S)(t),O=[],[4,e.json()];case 1:y=U.sent(),j=(null===(a=null===(o=null===(i=null===(r=null==y?void 0:y.EntitySets)||void 0===r?void 0:r[0])||void 0===i?void 0:i.ResultSets)||void 0===o?void 0:o[0])||void 0===a?void 0:a.Results)||[],h.k.importAndExecute(p.c.ContextualInsights,null===(c=null==y?void 0:y.Instrumentation)||void 0===c?void 0:c.TraceId,n.getData(Y.a.e2eTimeElapsed),e.status);try{for(S=Object(d.k)(j),x=S.next();!x.done;x=S.next())if(C=x.value,k=null===(u=C.Source.ConversationId)||void 0===u?void 0:u.Id,T=null===(s=C.Source.ItemId)||void 0===s?void 0:s.Id,A=X(v?k:T,t)){if(v){if(O.indexOf(k)>-1)continue;O.push(k)}P({spotlightCacheType:b.Dismissed,itemId:T,conversationId:k,rowKey:A})||(v?m.push(B(C.Source,A)):m.push(V(C.Source,A))),g.push({conversationId:k,itemId:T,rowKey:A,isAcknowledged:P({spotlightCacheType:b.Acknowledged,itemId:T,conversationId:k,rowKey:A}),isDismissed:P({spotlightCacheType:b.Dismissed,itemId:T,conversationId:k,rowKey:A}),reason:Z(C.Source.SingleValueExtendedProperties),senderName:null===(f=null===(l=C.Source.Sender)||void 0===l?void 0:l.EmailAddress)||void 0===f?void 0:f.Name,referenceId:C.ReferenceId,dateTimeReceived:Object(I.Sb)(C.DateTimeReceived),isTeachingMomentTarget:!1})}}catch(e){D={error:e}}finally{try{x&&!x.done&&(L=S.return)&&L.call(S)}finally{if(D)throw D.error}}for(E=null,M=null,R=0;R<g.length;R++)F=g[R],(!E||F.dateTimeReceived>E.dateTimeReceived)&&(E=F,M=R);return null!==M&&(g[M].isTeachingMomentTarget=!0),_=Object(d.a)(Object(d.a)({},t.tableQuery),{scenarioType:"spotlight"}),Object(Q.c)(Object(N.c)(_),m,m.length,"SpotlightLoad",null,null,!0),q(_),[2,g]}}))}))}var X=function(e,t){var n=Object(w.G)([e],t);return n.length>0?n[0]:null},Z=function(e){var t,n;if(!e||0===e.length)return 0;try{for(var r=Object(d.k)(e),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.Id.indexOf("SpotlightReason")>-1)switch(o.Value){case"ActionRequired":return 1;case"AffectsSchedule":return 2;case"AtMentioned":return 4;case"ReplyRequired":return 8;case"NewMeetingCreated":return 64;case"UpcomingMeetingTimeChanged":return 128;case"MeetingCanceled":return 256;case"NewMeetingTimeProposed":return 512;default:return 0}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return 0},$=n(2969),ee=n(2553),te=n(1244),ne=n(440),re=n(514),ie=function(){return Object(d.c)(void 0,void 0,void 0,(function(){var e,t,n;return Object(d.f)(this,(function(r){switch(r.label){case 0:return e=Object(d.g)(Object(ne.getAccessTokenforResourceAsLazy)(window.location.origin),2),t=e[0],n=e[1],t?[3,2]:[4,n];case 1:t=r.sent(),r.label=2;case 2:return[2,t||""]}}))}))},oe=function(e,t,n){var r={method:"POST"};r.headers=new Headers,r.headers.set("Authorization","Bearer "+t),r.headers.set("Content-Type","application/json;charset=utf-8"),r.headers.set("X-Client-LocalTime",(new Date).toISOString()),r.headers.set("client-request-id",e);var i=Object($.b)();i&&r.headers.append("X-AnchorMailbox",i);var o={EntityRequests:[{EntityType:"Message",Context:{EntityContext:[{"@type":"Microsoft.OutlookServices.MailFolder",id:Object(te.a)("inbox")}]}}],Scenario:{Name:"ContextualInsights"}};return r.body=JSON.stringify(o),r},ae=function(e){return Object(d.c)(void 0,void 0,void 0,(function(){var t,n;return Object(d.f)(this,(function(r){switch(r.label){case 0:return[4,ie()];case 1:return t=r.sent(),n=oe(Object(S.a)(),t,Object(w.S)(e)),[4,fetch(Object(re.v)("/search/api/v1/recommendations",Object(ee.a)()),n)];case 2:return[2,r.sent()]}}))}))},ce=n(12);function ue(){se(!0),(Object(ce.i)()||"MSIT"===Object(ce.f)())&&setInterval((function(){se(!1)}),6e4)}var se=function(e){return Object(d.c)(void 0,void 0,void 0,(function(){var t,n,r,i,o;return Object(d.f)(this,(function(a){switch(a.label){case 0:return Object(j.a)()?e||"visible"===document.visibilityState?(t=Object(L.a)(),n=new g.b("SpotlightService",{sessionSampleRate:20}),r=Date.now(),[4,ae(t)]):[3,3]:[2];case 1:return i=a.sent(),n.end(),[4,J(i,t,n)];case 2:o=a.sent(),u(o,Object(w.S)(t),r),a.label=3;case 3:return[2]}}))}))};function le(){return Object(s.a)().logicalId}function de(){return Object(s.a)().spotlightItems.filter((function(e){return!e.isAcknowledged})).length}var fe=n(1955);function be(e){var t,n,r=f(e);if(!r)return null;var i=Object(fe.b)().items.get(r.itemId);return i?JSON.stringify({messageBody:(null===(t=i.UniqueBody)||void 0===t?void 0:t.Value)||(null===(n=i.NormalizedBody)||void 0===n?void 0:n.Value)||"",itemId:i.ItemId.Id}):null}var ge=n(14235),he=n(6);function pe(e){switch(e){case 1:return Object(he.b)(ge.a);case 2:return Object(he.b)(ge.b);case 4:return Object(he.b)(ge.c);case 64:return Object(he.b)(ge.e);case 128:return Object(he.b)(ge.h);case 256:return Object(he.b)(ge.d);case 512:return Object(he.b)(ge.f);case 8:case 0:case 16:default:return Object(he.b)(ge.g)}}function me(e,t,n){ve(),t(e,!0,"200",!1),_(n)}var ve=function(){var e=Object(s.a)().spotlightTableQuery;if(e){var t=Object(N.c)(e),n=E(b.Dismissed).map((function(e){return e.rowKey})).filter((function(e){return t.rowKeys.includes(e)}));n.length>0&&Object(D.a)(n,t,"Spotlight",!1)}},Oe=n(424),ye=n(1286),je=n(20),Ie=n(5483),Se=n(1083),we=n(2090),xe=n(2109),Ce=n(102),ke=n(0),Te=n(14236),Pe=n(14237),Ae=Object(je.a)((function(e){var t,n,r=e.rowKey,i=e.target,o=ke.useCallback((function(){Object(Se.e)(Se.b.SpotlightPropertyIcon)}),[]),a=ke.useCallback((function(){return Object(we.v)()?ke.createElement("div",{className:Pe.contentSlv},ke.createElement("div",{className:Pe.iconContainerSlv},ke.createElement(Oe.a,{iconName:Ie.a,className:Pe.iconSlv,role:"presentation"})),ke.createElement("span",{className:Pe.titleSlv},Object(he.b)(Te.d)),ke.createElement("span",{className:Pe.descriptionSlv,title:Object(he.b)(Te.c)},Object(he.d)(Object(he.b)(Te.b),ke.createElement(Oe.a,{iconName:Ie.a,className:Pe.iconInDescription}))),ke.createElement(ye.a,{className:Pe.gotItButtonSlv,onClick:o},Object(he.b)(Te.a))):ke.createElement("div",{className:Pe.contentThreeColumn},ke.createElement("div",{className:Pe.iconContainerThreeColumn},ke.createElement(Oe.a,{iconName:Ie.a,className:Pe.iconThreeColumn,role:"presentation"})),ke.createElement("div",{style:{display:"flex",flexDirection:"column"}},ke.createElement("span",{className:Pe.titleThreeColumn},Object(he.b)(Te.d)),ke.createElement("span",{className:Pe.descriptionThreeColumn,title:Object(he.b)(Te.c)},Object(he.d)(Object(he.b)(Te.b),ke.createElement(Oe.a,{iconName:Ie.a,className:Pe.iconInDescription}))),ke.createElement(ye.a,{className:Pe.gotItButtonThreeColumn,onClick:o},Object(he.b)(Te.a))))}),[]);if(Object(Ce.g)())return null;var c=Object(xe.a)();return(null===(t=null==c?void 0:c.FolderId)||void 0===t?void 0:t.Id)===Object(te.a)("inbox")&&i&&(null===(n=f(r))||void 0===n?void 0:n.isTeachingMomentTarget)?ke.createElement(Se.a,{lid:Se.b.SpotlightPropertyIcon,when:function(e){return e()},disposeOnUnmount:!1},ke.createElement("div",{className:Pe.container},ke.createElement("div",{className:Pe.beak}),a())):null}));n.d(t,"initializeSpotlight",(function(){return ue})),n.d(t,"onSpotlightDismissedFromRP",(function(){return a})),n.d(t,"getSpotlightLogicalId",(function(){return le})),n.d(t,"getSpotlightItem",(function(){return z})),n.d(t,"getUnacknowledgedSpotlightCount",(function(){return de})),n.d(t,"getSpotlightDonationJson",(function(){return be})),n.d(t,"getSpotlightReasonString",(function(){return pe})),n.d(t,"loadImportantTable",(function(){return me})),n.d(t,"logSpotlightItemClicked",(function(){return O})),n.d(t,"logSpotlightResultsRendered",(function(){return y})),n.d(t,"SpotlightIconTeachingMoment",(function(){return Ae}))},186:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function o(t){r--,delete e[t]}this.put=function(t,n,i,a){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var u={value:n,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){o(t),a&&a(t,n)}.bind(this),i)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(o){var a=e[o];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return i&&t++,a.value;i&&n++,r--,delete e[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),o=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(o)if(e[a])continue;var c=r[a],u=c.expire-i;if(u<=0){this.del(a);continue}u=u>0?u:void 0,this.put(a,c.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},1975:function(e,t,n){"use strict";n.d(t,"l",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return g})),n.d(t,"i",(function(){return h})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return O})),n.d(t,"g",(function(){return y}));var r,i,o=n(42),a=n(19),c=n(57),u=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],s=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],l={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};function d(){return Object(c.u)()}function f(){return Object(a.a)().IsConsumerChild}function b(){return Object(a.a)().SessionSettings.IsShadowMailbox}function g(){return void 0!==i?i:i=function(){var e=Object(a.a)(),t=e.SessionSettings.UserCulture;if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return t?t.toLowerCase():"en-us";var n=e.AdMarket.toLowerCase();return u.indexOf(n)>-1?n:l[n.split("-")[1]]||n}()}function h(e){return null!=e?e.toUpperCase().split("-"):[]}function p(e){return h(e)[1]||"US"}function m(){return Object(o.a)("ANON")}function v(){return Object(o.a)("MUID")}function O(){return!!Object(o.a)("TOptOut")}function y(){return r||(r="https://acdn.adnxs.com/ast/static/0.36.0/ast.js")}},2013:function(e,t,n){"use strict";var r=n(2088),i=n(1947);function o(){return Object(r.a)(Object(i.J)())}n.d(t,"b",(function(){return r.a})),n.d(t,"d",(function(){return r.c})),n.d(t,"c",(function(){return r.b})),n.d(t,"e",(function(){return r.d})),n.d(t,"a",(function(){return o}))},2022:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.Init=1]="Init",e[e.LeftNavResizeExpand=2]="LeftNavResizeExpand",e[e.ToggleExpand=3]="ToggleExpand",e[e.ToggleCollapse=4]="ToggleCollapse",e[e.WindowResize=5]="WindowResize",e[e.ToggleFolderPane=6]="ToggleFolderPane",e[e.DateRangeTypeChange=7]="DateRangeTypeChange",e[e.CalendarViewTypeChange=8]="CalendarViewTypeChange",e[e.OwaSuiteHeaderFlexPane=9]="OwaSuiteHeaderFlexPane"}(r||(r={}));var i=r,o=n(2),a=Object(o.createStore)("OwaLayout",{browserWidthBucket:null,areDisplayAdsEnabled:!1}),c=Object(o.mutatorAction)("setBrowserWidthBucket",(function(e){a().browserWidthBucket=e})),u=n(4);function s(e,t,n){var r=Object(u.o)(e);return t&&(r>1900?r-=305:r>990&&(r-=165)),n&&(r-=320),r>=1600?1600:r>=1400?1599:r>=1366?1399:r>=1301?1365:r>=1239?1300:r>=1200?1238:r>=1080?1199:r>=1e3?1079:r>=919?999:r>=900?918:r>=866?899:r>=769?865:r>=692?768:r>=686?691:r>=580?685:r>=555?579:r>=542?554:r>=500?541:r>=419?499:418}var l=Object(o.action)("onAvailableWidthBucketChanged",(function(e,t){return{availableWidthBucket:e,source:t}})),d=Object(o.mutatorAction)("setAreDisplayAdsEnabled",(function(e){a().areDisplayAdsEnabled=e}));function f(){return a().areDisplayAdsEnabled}var b=n(2086);function g(e){window.addEventListener("resize",h),d(e),p(i.Init)}function h(){p(i.WindowResize)}function p(e){var t=s(e!=i.Init,f(),Object(b.a)());a().browserWidthBucket!=t&&(c(t),t<=418?m():v(),l(t,e))}function m(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflowX="auto")}function v(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflow="hidden")}var O=n(67);function y(){return j()}function j(){return Object(O.l)()||Object(O.d)()}function I(){var e=a().browserWidthBucket;return e||void 0}Object(o.orchestrator)(b.d,(function(e){var t=s(!1,f(),e.isShown);c(t),l(t,i.OwaSuiteHeaderFlexPane)})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return g})),n.d(t,"b",(function(){return m})),n.d(t,"e",(function(){return v})),n.d(t,"d",(function(){return y})),n.d(t,"g",(function(){return j})),n.d(t,"h",(function(){return l})),n.d(t,"c",(function(){return I}))},2027:function(e,t,n){"use strict";var r=n(31),i=n(1947);function o(){return a(Object(i.J)())}function a(e){return e&&2==e.tableQuery.type?e.tableQuery.folderId:null}function c(){var e=Object(i.J)();return e&&2==e.tableQuery.type}function u(e){return!!e&&(2==e.type||s(e))}function s(e){return!(!e||1!=e.type)&&"Group"==e.searchScope.kind}function l(e){return 2==e.type?e.folderId:s(e)?e.searchScope.groupId:null}function d(){var e=Object(i.J)();return e&&u(e.tableQuery)}n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return g})),n.d(t,"m",(function(){return h})),n.d(t,"l",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"i",(function(){return v})),n.d(t,"k",(function(){return O})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return d}));var f=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(19),n.e(22),n.e(65),n.e(116),n.e(754)]).then(n.bind(null,18440))})),b=new r.b(f,(function(e){return e.getGroupDisplayName})),g=new r.b(f,(function(e){return e.getGroupDisplayNameFromTableView})),h=new r.b(f,(function(e){return e.isPrivateUnjoinedGroup})),p=new r.b(f,(function(e){return e.isJoinedGroup})),m=new r.b(f,(function(e){return e.getRetentionPolicyTagsForGroup})),v=new r.b(f,(function(e){return e.getRetentionPolicyTagListForGroupTableQuery})),O=new r.b(f,(function(e){return e.isGroupOwner}))},2088:function(e,t,n){"use strict";var r=n(209),i=n(1951),o=new Map;var a=n(2160),c=n(2027),u=n(2643);function s(e){return e?l(e.tableQuery):Object(r.d)()}function l(e){var t=Object(c.b)(e),n=null==e?void 0:e.folderId;return null!=t?Object(a.a)(t):d(n)}function d(e){return Object(i.G)(e)?Object(u.a)(e):function(e){if(!e)return Object(r.d)();if(!o.has(e)){var t=Object(i.u)(e,!0);o.set(e,t)}return o.get(e)}(e)}function f(e){return{mailboxInfo:l(e)}}n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return f}))},2121:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"l",(function(){return i})),n.d(t,"v",(function(){return o})),n.d(t,"t",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return g})),n.d(t,"e",(function(){return h})),n.d(t,"m",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"k",(function(){return v})),n.d(t,"s",(function(){return O})),n.d(t,"o",(function(){return y})),n.d(t,"u",(function(){return j})),n.d(t,"r",(function(){return I})),n.d(t,"q",(function(){return S})),n.d(t,"n",(function(){return w}));var r="multipart/signed",i="application/pkcs7-mime",o="application/x-pkcs7-mime",a=".p7m",c="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",u="CLASSID",s="4",l="0800",d=57,f=78,b=16,g=11,h="IPM.Note.SMIME.MultipartSigned",p="smime-",m="image",v="OwaToSmime",O="SmimeToOwa",y="en-US",j=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],I="OwaSmimeEdgeExtension.appxbundle",S="https://microsoftedge.microsoft.com/addons/detail/gamjhjfeblghkihfjdpmbpajhlpmobbp",w="chrome-extension://maafgiompdekodanheihhgilkjchcakm/Options.html"},2124:function(e,t,n){"use strict";var r=n(14),i=n(2),o={folderTable:new r.ObservableMap,rootFolder:null},a=Object(i.createStore)("publicFolderFavoriteStore",o)();t.a=a},2157:function(e,t,n){"use strict";var r,i,o;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.File=3]="File",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.Setting=8]="Setting"}(r||(r={})),function(e){e.ODSPFile="ODSP file",e.CloudyAttachment="Cloudy attachment",e.ClassicAttachment="Classic attachment",e.LinkAttachment="Link attachment",e.Unknown="Unknown"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Checking=1]="Checking",e[e.NotSupported=2]="NotSupported",e[e.Supported=3]="Supported"}(o||(o={}))},2158:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(1);function i(e){return Object(r.a)({},e)}function o(e){return Object(r.a)({},e)}function a(e){return Object(r.a)({},e)}function c(e){return Object(r.a)({},e)}function u(e){return Object(r.a)({},e)}},2159:function(e,t,n){"use strict";function r(){return{isBeingDragged:!1}}n.d(t,"a",(function(){return r}))},2160:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(209),i={};function o(e){var t=e.toLocaleLowerCase();if(!i[t]){var n={type:"GroupMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e};i[t]=n}return i[t]}},2178:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a}));var r=350,i=270,o=418,a=48},2185:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Mail="owa.react",e.MailCompose="owa.react.compose",e.Calendar="owa.react.calendar",e.FilesHub="owa.react.filesHub",e.MailSubject="owa.react.mail.subject",e.MailEmailAttachmentPicker="owa.react.mail.emailPicker",e.SuggestedAttachments="suggestedattachments",e.MeetingPrep="MeetingPrep",e.MeetingPrepPrefetch="MeetingPrep.Prefetch",e.MeetingPrepPeek="MeetingPrep.Peek",e.MeetingPrepReminder="MeetingPrep.Reminder",e.MeetingPrepAgenda="MeetingPrep.AgendaView",e.MeetingPrepMailCalendarCard="MeetingPrep.MailCalendarCard",e.MeetingPrepDesktop="OutlookDesktopOPX.MeetingPrep",e.MeetingPrepShell="ShellOPX.MeetingPrep",e.ContextualInsights="ContextualInsights",e.FileSuggestions="owa.react.filepicker",e.SonoraFilePicker="outlook.inlinefilepicker",e.SonoraHoneybee="owa.honeybee"}(r||(r={})),t.b=r},2189:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(24),i=n(113);function o(e){return Object(r.i)("tri-officeRail")&&(e===i.a.Mail||e===i.a.Calendar||e===i.a.AppHost||e===i.a.People||e===i.a.FilesHub)}},2190:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"UnifiedGroupIdentity:#Exchange"},e)}},2209:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(209);function i(e){return{type:"PublicMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e}}},2223:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2391);function i(e){return e&&Object(r.b)(e.ItemClass)}},2227:function(e,t,n){"use strict";var r=n(871),i=n(613),o=n(1);function a(e){return Object(o.a)({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}function c(e){return Object(o.a)({__type:"SearchFolderScopeType:#Exchange"},e)}var u=n(2190),s=n(1964);var l=n(1244),d=n(2158),f=n(1959),b=n(2222);n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return I})),n.d(t,"c",(function(){return S}));var g={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){var e,t,n=[];n.push(Object(d.b)({folderId:Object(l.a)(f.j),kind:"PrimaryMailbox"}));var r=Object(b.b)("UserMailbox");try{for(var i=Object(o.k)(r),a=i.next();!a.done;a=i.next()){var c=a.value;n.push(Object(d.b)({folderId:c,kind:"PrimaryMailbox"}))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return n},getSearchScopeType:function(e){var t,n,a=Object(s.a)(e.folderId);return t="none"!=a?Object(r.a)({Id:a}):Object(i.a)({Id:e.folderId}),[(n={FolderScope:c({BaseFolderId:t}),IsDeepTraversal:!0},Object(o.a)({__type:"PrimaryMailboxSearchScopeType:#Exchange"},n))]}},h={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){var e=[];return e.push(Object(d.a)({folderId:Object(l.a)(f.d),kind:"ArchiveMailbox"})),e.push(Object(d.a)({folderId:Object(l.a)(f.a),kind:"ArchiveMailbox"})),e},getSearchScopeType:function(e){var t,n,u=Object(s.a)(e.folderId);return t="none"!=u?Object(r.a)({Id:u}):Object(i.a)({Id:e.folderId}),"archivemsgfolderroot"==u?[(n={ArchiveTypes:16777215},Object(o.a)({__type:"LargeArchiveSearchScopeType:#Exchange"},n))]:[a({FolderScope:c({BaseFolderId:t})})]}},p={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},m={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[(t={GroupIdentity:Object(u.a)({Type:0,Value:e.groupId})},Object(o.a)({__type:"SingleGroupSearchScopeType:#Exchange"},t))];var t}},v={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},O={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},y=function(e){switch(e.kind){case"PrimaryMailbox":return g;case"ArchiveMailbox":return h;case"SharedFolders":return p;case"Group":return m;case"Calendar":return v;case"PublicFolder":return O;default:throw new Error("Unregistered search scope")}},j=function(e){return y(e).getKey(e)},I=function(e){return y(e).getSearchScopeList()},S=function(e){return y(e).getSearchScopeType(e)}},2229:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"j",(function(){return a})),n.d(t,"v",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"o",(function(){return s})),n.d(t,"r",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"h",(function(){return g})),n.d(t,"e",(function(){return h})),n.d(t,"d",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"k",(function(){return v})),n.d(t,"m",(function(){return O})),n.d(t,"p",(function(){return y})),n.d(t,"q",(function(){return j})),n.d(t,"n",(function(){return I})),n.d(t,"u",(function(){return S})),n.d(t,"a",(function(){return w})),n.d(t,"s",(function(){return x})),n.d(t,"t",(function(){return C}));var r=n(31),i=new r.c((function(){return Promise.all([n.e(21),n.e(68),n.e(811)]).then(n.bind(null,3511))})),o=new r.a(i,(function(e){return e.logEntityClicked})),a=new r.a(i,(function(e){return e.logResponseReceived})),c=new r.a(i,(function(e){return e.logSessionEnd})),u=new r.a(i,(function(e){return e.logResponseRendered})),s=new r.a(i,(function(e){return e.logSearchBoxStateChanged})),l=new r.a(i,(function(e){return e.logSearchResultInteraction})),d=new r.a(i,(function(e){return e.logResponseNeverRendered})),f=new r.a(i,(function(e){return e.flushNonRenderedResponseReceivedItemsFromCache})),b=new r.a(i,(function(e){return e.logCachedContentRendered})),g=new r.a(i,(function(e){return e.logFeedback})),h=new r.a(i,(function(e){return e.logClientLayout})),p=new r.a(i,(function(e){return e.logClientDataSource})),m=new r.a(i,(function(e){return e.logEntitiesFromFilePicker})),v=new r.a(i,(function(e){return e.logResponseRecievedV2})),O=new r.a(i,(function(e){return e.logResultsRendered})),y=new r.a(i,(function(e){return e.logSearchEntityActions})),j=new r.a(i,(function(e){return e.logSearchFeedbackActions})),I=new r.a(i,(function(e){return e.logSearchActions})),S=new r.a(i,(function(e){return e.logSecondaryEntityActionClicked})),w=new r.a(i,(function(e){return e.clearProcessedTraceIds})),x=new r.a(i,(function(e){return e.logSearchSuggestionsClientLayoutEvent})),C=new r.a(i,(function(e){return e.logSearchSuggestionsResultsRenderedEvent}))},2256:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="IPM.Note.SMIME"},2288:function(e,t,n){"use strict";var r=n(2335),i=n(24),o=n(1975),a=n(1097);var c=n(2189);function u(e){return Object(i.i)("auth-cloudCache")&&(Object(o.b)()||Object(o.c)())&&Object(a.a)()||Object(r.a)()||Object(c.a)(e)}n.d(t,"a",(function(){return u}))},2335:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(24),i=n(57);function o(){return Object(r.i)("mail-oneView")&&Object(i.r)()}},2339:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}n.d(t,"a",(function(){return r}))},2342:function(e,t,n){"use strict";var r=n(31),i=n(2408),o=n(2438),a=n(2409),c=n(2339),u=n(2410),s=n(2376),l=n(2439);function d(e){var t=e;return"Single"===t.CalendarItemType&&!t.RecurrenceId}function f(e){return!!e.RecurrenceId}n.d(t,"s",(function(){return g})),n.d(t,"t",(function(){return h})),n.d(t,"w",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"g",(function(){return v})),n.d(t,"h",(function(){return O})),n.d(t,"b",(function(){return y})),n.d(t,"f",(function(){return j})),n.d(t,"e",(function(){return I})),n.d(t,"i",(function(){return S})),n.d(t,"j",(function(){return w})),n.d(t,"a",(function(){return x})),n.d(t,"c",(function(){return C})),n.d(t,"v",(function(){return k})),n.d(t,"u",(function(){return T})),n.d(t,"k",(function(){return i.a})),n.d(t,"x",(function(){return o.a})),n.d(t,"m",(function(){return a.a})),n.d(t,"q",(function(){return c.a})),n.d(t,"r",(function(){return u.a})),n.d(t,"l",(function(){return s.a})),n.d(t,"o",(function(){return l.a})),n.d(t,"p",(function(){return d})),n.d(t,"n",(function(){return f}));var b=new r.c((function(){return Promise.all([n.e(4),n.e(7),n.e(13),n.e(14),n.e(15),n.e(17),n.e(16),n.e(21),n.e(24),n.e(28),n.e(31),n.e(40),n.e(53),n.e(56),n.e(154),n.e(194),n.e(289),n.e(284),n.e(727)]).then(n.bind(null,18176))})),g=new r.a(b,(function(e){return e.addItemToCalendar})),h=new r.a(b,(function(e){return e.initializeMeetingRequestViewStateAction})),p=new r.a(b,(function(e){return e.removeCancelledMeetingFromCalendar})),m=Object(r.d)(b,(function(e){return e.MeetingMessageInfo})),v=(Object(r.d)(b,(function(e){return e.MeetingRequestActions})),Object(r.d)(b,(function(e){return e.MeetingCancellationAction})),Object(r.d)(b,(function(e){return e.MeetingActionButton})),Object(r.d)(b,(function(e){return e.MeetingDetailsTime})),Object(r.d)(b,(function(e){return e.MeetingDetailsLocation})),Object(r.d)(b,(function(e){return e.MeetingRequestInfo}))),O=Object(r.d)(b,(function(e){return e.MeetingRequestResponseEditor})),y=Object(r.d)(b,(function(e){return e.MeetingDetails})),j=Object(r.d)(b,(function(e){return e.MeetingRequestConflicts})),I=(Object(r.d)(b,(function(e){return e.EditEventLink})),Object(r.d)(b,(function(e){return e.MeetingMessageSummary}))),S=Object(r.d)(b,(function(e){return e.PreviewSummary})),w=Object(r.d)(b,(function(e){return e.SenderSummary})),x=Object(r.d)(b,(function(e){return e.CollapsedMeetingMessage})),C=Object(r.d)(b,(function(e){return e.MeetingIcon})),k=new r.a(b,(function(e){return e.logMeetingMessageActionForInvite})),T=new r.a(b,(function(e){return e.logMeetingMessageActionForEvent}))},2345:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),i=Object(r.action)("setShowFolderPane",(function(e){return{showFolderPane:e}}))},2375:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2012);function i(){return Object(r.a)().showFolderPane}},2376:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}n.d(t,"a",(function(){return r}))},2391:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(2121),i=n(2256);function o(e){return e&&0===e.indexOf(r.e)}function a(e){return e&&0===e.indexOf(i.a)&&!o(e)}function c(e){return e&&0===e.indexOf(i.a)}function u(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},2408:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("deleteMeetingMessage",(function(e,t){return{item:e,issueDeleteItemCall:t}}))},2409:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.ItemClass)&&e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",(function(){return r}))},2410:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.resp/i)}n.d(t,"a",(function(){return r}))},2436:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2022),i=n(2010);function o(){var e=Object(r.c)();return Object(i.a)()?e<=541:e<=918}},2438:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("meetingMessageAddToCalendarStatusChanged",(function(e,t){return{status:e,sxsId:t}}))},2439:function(e,t,n){"use strict";function r(e){var t=e;return"RecurringMaster"===t.CalendarItemType&&!t.RecurrenceId}n.d(t,"a",(function(){return r}))},2471:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d}));var r=n(31),i=new r.c((function(){return Promise.all([n.e(4),n.e(21),n.e(57),n.e(68),n.e(813)]).then(n.bind(null,6335))})),o=new r.a(i,(function(e){return e.logLocalContentDataSource})),a=new r.a(i,(function(e){return e.logLocalContentLayout})),c=new r.a(i,(function(e){return e.clearLocalContentInstrumentationCache})),u=new r.b(i,(function(e){return e.getLocalContentId})),s=new r.b(i,(function(e){return e.substrateSearchInitOperation})),l=(new r.b(i,(function(e){return e.substrateSearchPostSuggestionsService})),new r.b(i,(function(e){return e.deleteSubstrateSearchHistoryService}))),d=new r.b(i,(function(e){return e.exportSubstrateSearchHistoryService}))},2474:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("REMOVE_ROWS_FROM_LISTVIEW_STORE",(function(e,t,n,r){return void 0===r&&(r=!0),{rowKeys:e,tableView:t,actionType:n,shouldRemoveFromAllTables:r}}))},2485:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2227);function i(e,t){return!(!e||!t)&&Object(r.a)(e)===Object(r.a)(t)}},2487:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(function(e,t){return{itemIdToRemove:e,removeItemSource:t}}))},2511:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),i=Object(r.action)("USERMAIL_INTERACTION",(function(e,t,n){return{interactionType:e,instrumentationContexts:t,triageContext:n}}))},2522:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),i=Object(r.action)("setShowListPane",(function(e){return{showListPane:e}}))},2523:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),i=Object(r.action)("setShowReadingPane",(function(e){return{showReadingPane:e}}))},2593:function(e,t,n){"use strict";var r=n(31),i=n(1947),o=n(2013),a=n(1956),c=n(1964),u=n(2256);var s=n(2223);function l(e,t){if(t.folderId&&"junkemail"==Object(c.a)(t.folderId))return!1;if(Object(s.a)(e))return!1;var n=a.u.items.get(e.ItemId.Id);return!(null==n||!n.shouldShowAttachmentPreviews)||!(!e.HasAttachments&&!e.HasProcessedSharepointLink)&&(g.importAndExecute(Object(o.d)(t),e.ConversationId,e.ItemId.Id),!0)}var d=function(e,t,n){void 0===n&&(n={listViewStore:i.ab});var r,a,s,l=1==t.type,d=e.ConversationId,f=n.listViewStore.conversationItems.get(d.Id),b=e.HasProcessedSharepointLink;if(t.folderId&&"junkemail"==Object(c.a)(t.folderId))return!1;if((null==(r=e)?void 0:r.ItemClasses)&&r.ItemClasses.length>0&&r.ItemClasses.some((function(e){return 0===e.indexOf(u.a)})))return!1;if(l){if(null==f?void 0:f.shouldShowAttachmentPreviews)return!0;a=s=!!e.HasAttachments||b}else{if(!e.HasAttachmentPreviews&&!b)return!1;f&&!b?(a=f.globalItemIds.length!=e.GlobalItemIds.length,s=f.shouldShowAttachmentPreviews):(a=!0,s=!0)}return a&&g.importAndExecute(Object(o.d)(t),e.ConversationId,null),s};n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return l}));var f=new r.c((function(){return n.e(535).then(n.bind(null,18420))})),b=new r.a(f,(function(e){return e.getPreviews})),g=new r.a(f,(function(e){return e.add})),h=new r.a(f,(function(e){return e.getAttachmentsForConversationWell})),p=new r.a(f,(function(e){return e.removeAttachmentPreviewsForRow}))},2638:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(31),i=n(2511);n.d(t,"d",(function(){return i.a}));var o=new r.c((function(){return n.e(517).then(n.bind(null,4744))})),a=new r.a(o,(function(e){return e.onKeyboardUpDown})),c=new r.a(o,(function(e){return e.onOpenEmail})),u=new r.a(o,(function(e){return e.onKeyboardToggleSelect}))},2643:function(e,t,n){"use strict";var r=n(1947),i=n(1951);function o(){var e=Object(r.J)();return e&&0==e.tableQuery.type&&Object(i.G)(e.tableQuery.folderId)}function a(){var e=Object(r.J)();return e&&0==e.tableQuery.type&&Object(i.G)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var c=n(2),u=n(2124),s=n(2209),l=n(14),d=Object(c.createStore)("publicFolderUtilsStore",new l.ObservableMap),f=n(57);function b(e){if(!d().has(e)){var t=u.a.folderTable.get(e),n=null!=t.ReplicaList?t.ReplicaList[0]:Object(f.h)().SessionSettings.DefaultPublicFolderMailbox,r=Object(s.a)(n);g(e,r)}return d().get(e)}var g=Object(c.mutatorAction)("addPublicFolderMailboxInfoToStore",(function(e,t){d().set(e,t)}));n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return b}))},2716:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),i=Object(r.action)("onClientReadingPanePositionChange")},293:function(e,t,n){"use strict";var r,i=n(576),o=n(184).a["__core-js_shared__"],a=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var c=function(e){return!!a&&a in e},u=n(216),s=n(423),l=/^\[object .+?Constructor\]$/,d=Function.prototype,f=Object.prototype,b=d.toString,g=f.hasOwnProperty,h=RegExp("^"+b.call(g).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var p=function(e){return!(!Object(u.a)(e)||c(e))&&(Object(i.a)(e)?h:l).test(Object(s.a)(e))};var m=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var n=m(e,t);return p(n)?n:void 0}},2964:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1951);function i(e){return Object(r.C)(e,"SharedMailbox")}},2969:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(42),i=n(41),o=n(57);function a(){var e=Object(r.a)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.a)(t)}function c(){var e,t,n=(e="",(t=Object(i.a)().pathname.split("/").filter((function(e){return e.length}))).length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e);if(0===n.length){var r=Object(o.h)();if(null==r?void 0:r.SessionSettings){var c=r.SessionSettings.ExternalDirectoryTenantGuid,u=r.SessionSettings.UserPuid;u&&c&&(n="PUID:"+u+"@"+c)}}return 0===n.length&&(n=a()),n}},3031:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2012);function i(){return Object(r.a)().showListPane}},3145:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(2307),i=n(3806),o=function(){var e=Object(r.a)();return a(e)},a=function(e){if(!e||!e.isInitialLoadComplete)return"Loading";var t=0==e.rowKeys.length;return 0!=e.loadErrorStatus&&(t||Object(i.a)(e))?"Error":t?"Empty":"Loaded"}},326:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r,i=n(1);function o(e){r=e}function a(){var e,t;return Object(i.c)(this,void 0,void 0,(function(){var n,o;return Object(i.f)(this,(function(i){switch(i.label){case 0:return(o=r)?[4,r()]:[3,2];case 1:o=i.sent(),i.label=2;case 2:if((n=o)&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},3381:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d}));var r=n(2657),i=n(2367),o=n(1947),a=n(1244),c=n(2645);function u(){var e=Object(a.a)("inbox"),t=Object(o.B)(e),n=Object(r.a)(e);return Object(i.a)(e,t,"mail",-1,null,null,n)}function s(){var e=u();return e.focusedViewFilter=0,e}function l(){var e=u();return e.focusedViewFilter=1,e}function d(){return Object(c.a)()?s():u()}},413:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(2),i=n(14),o=Object(r.createStore)("lightningState",{unseenItems:new i.ObservableMap,lightedCount:0,lastShownId:null}),a=o()},423:function(e,t,n){"use strict";var r=Function.prototype.toString;t.a=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},448:function(e,t,n){"use strict";var r=n(576),i=n(580);t.a=function(e){return null!=e&&Object(i.a)(e.length)&&!Object(r.a)(e)}},520:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,i=t%n;return(((e-=r)/n&(t-=i)/n)>>>0)*n+((r&i)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},534:function(e,t,n){"use strict";var r=n(293),i=function(){try{var e=Object(r.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.a=i},5483:function(e,t,n){"use strict";var r=n(1),i=n(0),o=n(7),a=n(1245);t.a="FlashlightFilled";var c=Object(a.a)({Svg:function(e){return i.createElement("svg",Object(r.a)({},e,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"}),i.createElement("path",{d:"M21.25 5c.41 0 .75.33.75.75v12.5c0 .41-.34.75-.75.75h-5.5A2.75 2.75 0 0113 16.25V16H3.75C2.78 16 2 15.2 2 14.25v-4.5C2 8.78 2.78 8 3.75 8H13v-.25A2.75 2.75 0 0115.75 5h5.5zm-13 6.25h-2.5a.75.75 0 000 1.5h2.5a.75.75 0 100-1.5z"}))},displayName:"FlashlightFilled"});Object(o.registerIcons)({icons:{FlashlightFilled:i.createElement(c,null)}})},576:function(e,t,n){"use strict";var r=n(311),i=n(216),o="[object AsyncFunction]",a="[object Function]",c="[object GeneratorFunction]",u="[object Proxy]";t.a=function(e){if(!Object(i.a)(e))return!1;var t=Object(r.a)(e);return t==a||t==c||t==o||t==u}},577:function(e,t,n){"use strict";t.a=function(e){return e}},580:function(e,t,n){"use strict";var r=9007199254740991;t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},642:function(e,t,n){"use strict";var r=n(31),i=n(413),o=n(23),a=n(1),c=n(8),u=n(14),s=n(2),l=Object(s.mutatorAction)("initializeLightning",(function(e){var t,n;if(o.g.info("initialize lightning store"),Object(i.a)().lastShownId=null,Object(i.a)().lightedCount=0,Object(i.a)().unseenItems=new u.ObservableMap,e)try{for(var r=Object(a.k)(e),c=r.next();!c.done;c=r.next()){var s=c.value;Object(i.a)().unseenItems.set(s.identity,s)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}));var d=n(151),f="ows/v1.0/lightning/items/unseen";function b(){return o.g.info("initialize lightning from server"),Object(d.b)(f).then((function(e){var t=e.map(g);l(t)}))}function g(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var h,p=n(19),m=n(24),v="lightning",O="UnseenLightening";function y(){var e,t,n;if(!h){var r=Object(c.a)(v);if(r)h=function(e){o.g.info("initialize lightning from override query parameter");var t=e.split(",").map((function(e){return{identity:e,visible:!1}}));return l(t),Promise.resolve()}(r);else{var i=Object(p.a)().PrimeSettings;if(Object(m.i)("lightning-initFromSD")&&i&&i.Items)try{for(var u=Object(a.k)(i.Items),s=u.next();!s.done;s=u.next()){var d=s.value;if(d.Id===O&&d.Value){n=d.Value,o.g.info("initialize lightning from session data"),l(n.map((function(e){return{identity:e.id,visible:!1,category:e.category}}))),h=Promise.resolve();break}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}h||(h=b())}}return h}var j=n(1294),I=Object(s.action)("lightup",(function(e){return{id:e}})),S=I;Object(s.mutator)(I,(function(e){o.g.info("lightup - id:"+e.id),Object(i.a)().lastShownId=e.id,Object(i.a)().lightedCount++;var t=Object(i.a)().unseenItems.get(e.id);t&&(t.visible=!0)})),Object(s.orchestrator)(I,(function(e){Object(j.a)("LIGHTUP",e.id)}));var w,x=n(514);function C(e,t){(o.g.info("lightupOrReject - id:"+e+", recurrenceCount:"+t+", lightedCount:"+Object(i.a)().lightedCount+", lastShown:"+Object(i.a)().lastShownId),Object(x.w)())?o.g.info("lightning is disabled for deeplink"):Object(i.a)().unseenItems.has(e)&&(!Object(i.a)().lastShownId||function(e,t){var n=!1,r=Object(i.a)().lastShownId;if(r&&t&&!function(){var e=Object(i.a)(),t=e.lastShownId,n=e.unseenItems;return t&&n.has(t)&&n.get(t).visible}()){var o=t.indexOf(r),a=t.indexOf(e);o>=0&&o+1==a&&(n=!0)}return n}(e,t)||function(e){var t=Object(i.a)().unseenItems.get(e);return!!t&&t.category==w.UIFeatureDiscovery}(e)||function(e){var t=Object(i.a)().unseenItems.get(e);return!!t&&t.category==w.Compliance}(e))&&S(e)}function k(e,t,n){o.g.info("beginLightning - id:"+e),t((function(){y().then((function(){return C(e,n)})).catch((function(t){o.g.warn("something is wrong, lightning id:"+e+", reason:"+t)}))}))}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(w||(w={}));var T=n(873);n.d(t,"c",(function(){return A})),n.d(t,"d",(function(){return i.b})),n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return T.a}));var P=new r.c((function(){return n.e(506).then(n.bind(null,18524))})),A=new r.a(P,(function(e){return e.endLightningImp}))},708:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},7832:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("onSpotlightDisabled");n.d(t,"a",(function(){return i}))},8217:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2044),i=n(3381);function o(){var e=Object(i.a)();return Object(r.c)(e)}},873:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33",e.InboxPlusEasyOn="34",e.InboxRulesFromDL="35",e.GdprAdsV2="36",e.TimePanelCombinedDndFRE="47",e.UaeEduPrivacyNotification="48",e.OutlookSpacesFRE="49",e.TodoFlaggedEmailList="50",e.DynamicLayoutFolderPaneCollapse="51",e.EdgeUpsell="56",e.OutlookSpacesCapturedPaneFRE="57",e.ProofingTeachingFreeUserFRE="58",e.ProofingTeachingPremiumUserFRE="59",e.OutlookSpacesNotePaneFRE="60",e.OutlookSpacesTasksPaneFRE="61",e.OutlookSpacesGoalsPaneFRE="62",e.DefaultOnlineMeetingSetting="63",e.QuickUseFRE="64",e.GdprAdsV3="65",e.SpeedyMeetingsEndEarlySetting="66",e.InboxPlusEasyOff="67",e.ShortenEventsDurationSetting="70",e.HoneybeeClipboard="71",e.AttachmentSaveToCloudOpenAndEdit="72",e.GdprAdsEPrivacy="73",e.AdminInstalledNewAddinsFRE="75",e.InsertLinkFREOpenCompose="76",e.InsertLinkFREAfterAttach="77",e.SpotlightFre="78",e.OverlayFolderPaneFre="79",e.SpotlightPropertyIcon="80",e.GdprAdsV3ClearNull="81",e.OptionsPaneLaunch="82",e.ThemeOfTheDay="83",e.SpeedyMeetingsTenant="84",e.MailtoProtocolHandler="85",e.UnpinnedAdminAddinsFRE="86"}(r||(r={}))},874:function(e,t,n){"use strict";var r=n(577),i=n(881),o=n(880);t.a=function(e,t){return Object(o.a)(Object(i.a)(e,t,r.a),e+"")}},878:function(e,t,n){"use strict";var r=n(450),i=n(448),o=n(583),a=n(216);t.a=function(e,t,n){if(!Object(a.a)(n))return!1;var c=typeof t;return!!("number"==c?Object(i.a)(n)&&Object(o.a)(t,n.length):"string"==c&&t in n)&&Object(r.a)(n[t],e)}},880:function(e,t,n){"use strict";var r=function(e){return function(){return e}},i=n(534),o=n(577),a=i.a?function(e,t){return Object(i.a)(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:o.a,c=800,u=16,s=Date.now;var l=function(e){var t=0,n=0;return function(){var r=s(),i=u-(r-n);if(n=r,i>0){if(++t>=c)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(a);t.a=l},881:function(e,t,n){"use strict";var r=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},i=Math.max;t.a=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,a=-1,c=i(o.length-t,0),u=Array(c);++a<c;)u[a]=o[t+a];a=-1;for(var s=Array(t+1);++a<t;)s[a]=o[a];return s[t]=n(u),r(e,this,s)}}},887:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},891:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r=1,i=16},896:function(e,t,n){"use strict";var r=n(874),i=n(878);t.a=function(e){return Object(r.a)((function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:void 0,c=o>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(o--,a):void 0,c&&Object(i.a)(n[0],n[1],c)&&(a=o<3?void 0:a,o=1),t=Object(t);++r<o;){var u=n[r];u&&e(t,u,r,a)}return t}))}}}]);
//# sourceMappingURL=owa.MailBoot~Spotlight.js.map
self.scriptsLoaded['owa.MailBoot~Spotlight.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Spotlight.js'] = (new Date()).getTime();