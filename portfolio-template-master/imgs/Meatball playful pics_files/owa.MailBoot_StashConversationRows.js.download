self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~StashConversationRows.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[830],{1563:function(e,n,r){"use strict";r.r(n),r.d(n,"tryGetConversationRowsFromResponse",(function(){return d}));var o=r(3217),t=r(3305),i=r(23);function d(e){var n=function(e){return Object(t.b)(e,(function(e){return e.Body}),"fcr")}(e);if(n)try{return Object(o.a)(n)}catch(e){return void i.g.warn("tryGetConversationRowsFromResponse: "+e.message)}}},1959:function(e,n,r){"use strict";r.d(n,"f",(function(){return o})),r.d(n,"d",(function(){return t})),r.d(n,"j",(function(){return i})),r.d(n,"a",(function(){return d})),r.d(n,"g",(function(){return l})),r.d(n,"b",(function(){return a})),r.d(n,"h",(function(){return u})),r.d(n,"l",(function(){return s})),r.d(n,"k",(function(){return v})),r.d(n,"i",(function(){return c})),r.d(n,"c",(function(){return f})),r.d(n,"e",(function(){return I}));var o=["journal","outbox","syncissues"],t="archivemsgfolderroot",i="msgfolderroot",d="archivedeleteditems",l="deleteditems",a="archiverecoverableitemsdeletions",u="recoverableitemsdeletions",s="msgfolderroot",v="sharedFolderTree",c="primaryFolderTree",f="archiveFolderTree",I="favorites"},2901:function(e,n,r){"use strict";var o=function(e,n){var r,o;if(e.ExtendedProperty)for(var t=0;t<e.ExtendedProperty.length;t++){var i=e.ExtendedProperty[t];if((null===(r=null==i?void 0:i.ExtendedFieldURI)||void 0===r?void 0:r.PropertyTag)===n||(null===(o=null==i?void 0:i.ExtendedFieldURI)||void 0===o?void 0:o.PropertyName)===n)return i.Value}},t=function(e){var n=o(e,"SourceWellKnownFolderType");return n&&parseInt(n,10)||-1},i=function(e){return o(e,"0x7018")||null},d=function(e){return"false"!==o(e,"0x10f4")},l=r(1959),a=r(23);function u(e,n,r,o,t,i,a){var u,v=e.RootFolder;if(!v||!v.Folders||!v.ParentFolder)throw new Error("folderHierarchyWeb: failed to get folders");var c=[];null==v||v.Folders.forEach((function(e){if(e&&function(e,n,r){if(o=null==e?void 0:e.__type,"Folder:#Exchange"!=o)return!1;var o;if((null==e?void 0:e.DistinguishedFolderId)&&l.f.indexOf(e.DistinguishedFolderId)>=0)return!1;if(d(e))return!1;if("clutter"===e.DistinguishedFolderId&&0===e.TotalCount)return!1;if("junkemail"===e.DistinguishedFolderId)return!!n;if("notes"===e.DistinguishedFolderId)return!!r;return!0}(e,o,t)){var r=s(e,n);if(r&&(c.push(r),null==a?void 0:a[r.FolderId.Id])){var i=a[r.FolderId.Id];r.ReplicaList=i,r.mailboxInfo.auxiliaryMailboxGuid=i[0]}}}));var f=function(e,n){return"SharedMailbox"===n?void 0:e}((null===(u=null==v?void 0:v.ParentFolder)||void 0===u?void 0:u.DistinguishedFolderId)||"none",n.type);v.ParentFolder.DistinguishedFolderId=f;var I=s(v.ParentFolder,n);return i&&function(e,n,r){if(e){var o={},t={},i=[];o[e.FolderId.Id]=e,i.push(e.FolderId.Id),n.forEach((function(e){e&&(o[e.FolderId.Id]=e,i.push(e.FolderId.Id))})),i.forEach((function(e){var n,r=o[e],i=null===(n=r.ParentFolderId)||void 0===n?void 0:n.Id;r.DistinguishedFolderId&&(t[r.DistinguishedFolderId]=e);var d=i&&o[i];d&&d.childFolderIds.push(e)}));var d=[];r.forEach((function(e){var n=t[e];n&&d.push(n)}));for(var l=e.childFolderIds||[],a=0;a<l.length;a++){var u=l[a]||null;u&&-1==d.indexOf(u)&&d.push(u)}e.childFolderIds=d}}(I,c,r),{__typename:"FolderHierarchyResult",Folders:c,RootFolder:I,IndexedPagingOffset:v.IndexedPagingOffset,TotalItemsInView:v.TotalItemsInView,IncludesLastItemInRange:v.IncludesLastItemInRange}}function s(e,n){var r=e,o=r.FolderId,d=r.ParentFolderId,l=r.DisplayName,u=r.ArchiveTag,s=r.PolicyTag,I=r.ChildFolderCount,m=r.UnreadCount,p=r.TotalCount,F=r.FolderClass,h=r.DistinguishedFolderId;if(!o||!d)return a.g.warn("mapOWSFolderToGql: ignoring folder with missing folderId or missing parentFolderId"),null;var g=I||0,y=c(o);return{id:y.Id,__typename:"MailFolder",type:r.__type,FolderId:y,ParentFolderId:c(d),DisplayName:l||"",DistinguishedFolderId:h||null,FolderClass:F||"IPF.Note",UnreadCount:m||0,TotalCount:p||0,ArchiveTag:u?f(u):null,PolicyTag:s?f(s):null,hasChildren:g>0,remoteFolderDisplayName:i(r),sourceWellKnownFolderType:t(r),ReplicaList:r.ReplicaList,PermissionSet:r.PermissionSet,size:v(r),childFolderIds:[],pausedTotalCount:null,principalSMTPAddress:null,mailboxInfo:{type:n.type,userIdentity:n.userIdentity,mailboxSmtpAddress:n.mailboxSmtpAddress,auxiliaryMailboxGuid:n.auxiliaryMailboxGuid}}}function v(e){var n,r;return null===(r=null===(n=e.ExtendedProperty)||void 0===n?void 0:n[0])||void 0===r?void 0:r.Value}function c(e){return{__typename:"FolderId",Id:e.Id,ChangeKey:e.ChangeKey}}function f(e){return{__typename:"RetentionTagType",IsExplicit:e.IsExplicit,Value:e.Value}}r.d(n,"a",(function(){return t})),r.d(n,"b",(function(){return u})),r.d(n,"c",(function(){return s}))},3217:function(e,n,r){"use strict";function o(e){var n,r,o,t;return{__typename:"ConversationType",ConversationId:{Id:e.ConversationId.Id},ConversationTopic:null!==(n=e.ConversationTopic)&&void 0!==n?n:"",UniqueRecipients:e.UniqueRecipients,UniqueSenders:e.UniqueSenders,LastDeliveryTime:null!==(r=e.LastDeliveryTime)&&void 0!==r?r:"",Categories:e.Categories,FlagStatus:e.FlagStatus,FlagStatusV2:e.FlagStatusV2,HasAttachments:e.HasAttachments,MessageCount:e.MessageCount,GlobalMessageCount:e.GlobalMessageCount,UnreadCount:null!==(o=e.UnreadCount)&&void 0!==o?o:0,GlobalUnreadCount:e.GlobalUnreadCount,Size:e.Size,ItemClasses:e.ItemClasses,Importance:e.Importance,ItemIds:e.ItemIds,GlobalItemIds:e.GlobalItemIds,LastModifiedTime:e.LastModifiedTime,InstanceKey:e.InstanceKey,Preview:e.Preview,IconIndex:e.IconIndex,DraftItemIds:e.DraftItemIds,HasIrm:e.HasIrm,GlobalLikeCount:e.GlobalLikeCount,LastDeliveryOrRenewTime:null!==(t=e.LastDeliveryOrRenewTime)&&void 0!==t?t:"",GlobalMentionedMe:e.GlobalMentionedMe,GlobalAtAllMention:e.GlobalAtAllMention,SortOrderSource:e.SortOrderSource,LastSender:e.LastSender,From:e.From,ParentFolderId:e.ParentFolderId?{__typename:"FolderId",Id:e.ParentFolderId.Id}:void 0,EntityNamesMap:e.EntityNamesMap,HasExternalEmails:e.HasExternalEmails,ReturnTime:e.ReturnTime,HasSharepointLink:e.HasSharepointLink,HasAttachmentPreviews:e.HasAttachmentPreviews,HasProcessedSharepointLink:e.HasProcessedSharepointLink,CouponRanks:e.CouponRanks,CouponExpiryDates:e.CouponExpiryDates,mentionedMe:e.GlobalMentionedMe||e.GlobalAtAllMention,id:e.ConversationId.Id}}function t(e){var n,r,o,t,s;return{__typename:"ConversationRowConnection",edges:u(e.Conversations),pageInfo:{__typename:"PageInfo",endCursor:a(e.Conversations),hasNextPage:d(e),hasPreviousPage:i(e),startCursor:l(e.Conversations)},searchFolderId:null!==(r=null===(n=e.SearchFolderId)||void 0===n?void 0:n.Id)&&void 0!==r?r:void 0,folderId:null!==(t=null===(o=e.FolderId)||void 0===o?void 0:o.Id)&&void 0!==t?t:void 0,totalConversationRowsInView:null!==(s=e.TotalConversationsInView)&&void 0!==s?s:0}}function i(e){return!(void 0===e.IndexedOffset||!e.Conversations)&&e.IndexedOffset>e.Conversations.length}function d(e){return void 0!==e.IndexedOffset&&null!=e.TotalConversationsInView&&e.IndexedOffset<e.TotalConversationsInView}function l(e){var n;return e&&e.length>0&&null!==(n=e[0].InstanceKey)&&void 0!==n?n:""}function a(e){var n;return e&&e.length>0&&null!==(n=e[e.length-1].InstanceKey)&&void 0!==n?n:""}function u(e){return e&&0!=e.length?e.map((function(e){var n;return{__typename:"ConversationRowEdge",cursor:null!==(n=e.InstanceKey)&&void 0!==n?n:"",node:o(e)}})):[]}r.d(n,"a",(function(){return t})),r.d(n,"b",(function(){return o}))},3305:function(e,n,r){"use strict";r.d(n,"c",(function(){return m})),r.d(n,"e",(function(){return p})),r.d(n,"d",(function(){return F})),r.d(n,"f",(function(){return h})),r.d(n,"g",(function(){return g})),r.d(n,"a",(function(){return y})),r.d(n,"b",(function(){return b}));var o,t,i,d,l,a,u=r(1),s=r(15),v=r(2901),c=r(4785),f=r(910),I=r(23);function m(e,n){var r,u,s,v,c,f;o=a?void 0:e.findConversation,t=a?void 0:null==n?void 0:n.conversationRows,l=a?void 0:e.findMailFolderItem,(null===(u=null===(r=e.findFolders)||void 0===r?void 0:r.Header)||void 0===u?void 0:u.ServerVersionInfo)||(null===(v=null===(s=e.findConversation)||void 0===s?void 0:s.Header)||void 0===v?void 0:v.ServerVersionInfo)||(null===(f=null===(c=e.findMailFolderItem)||void 0===c?void 0:c.Header)||void 0===f?void 0:f.ServerVersionInfo),i=e.findFolders,d=null==n?void 0:n.folderHierarchy}function p(e,n){var r,i=b(o,(function(e){return e.Body}),"fcr");if(o=void 0,t=void 0,a=!0,i){var d=void 0;if(e!=(null===(r=i.FolderId)||void 0===r?void 0:r.Id)?d="wf":i.Conversations?"number"==typeof i.IndexedOffset&&n===i.Conversations.length-i.IndexedOffset||(d="wi"):d="ni",Object(s.b)("fcr",d||"s"),!d)return i}return null}function F(e,n){return Object(u.c)(this,void 0,void 0,(function(){var r,i,d,l;return Object(u.f)(this,(function(u){switch(u.label){case 0:return r="fcr",i=t,d=o,o=void 0,t=void 0,a=!0,i||!d?[3,2]:[4,f.b.importAndExecute(d)];case 1:i=u.sent(),u.label=2;case 2:return i?(e!=i.folderId?l="wf":0!==n&&(l="wi"),Object(s.b)(r,l||"s"),[2,l?null:i]):[2,null]}}))}))}function h(e,n,r){var o=b(l,(function(e){var n,r,o;return null===(o=null===(r=null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseMessages)||void 0===r?void 0:r.Items)||void 0===o?void 0:o[0]}),"fir");if(l=void 0,a=!0,o){var t=void 0,i=null==o?void 0:o.RootFolder;if(e!=r?t="wf":(null==i?void 0:i.Items)?"number"==typeof i.IndexedPagingOffset&&n===i.Items.length-i.IndexedPagingOffset||(t="wi"):t="ni",Object(s.b)("fir",t||"s"),!t)return o}return null}function g(e){var n=d,r=i;return d=void 0,i=void 0,!n&&r&&(n=function(e,n){var r=y(e);if(!r)return;try{return Object(v.b)(r,n,[],Object(c.a)("junkemail"),Object(c.a)("notes"),!1)}catch(e){return void I.g.warn("tryGetFolderHierarchyFromResponse: "+e.message)}}(r,e)),n&&Object(s.b)("ffr","s"),n}function y(e){return b(e,(function(e){var n,r,o;return null===(o=null===(r=null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseMessages)||void 0===r?void 0:r.Items)||void 0===o?void 0:o[0]}),"ffr")}function b(e,n,r){var o="njr";if(e){var t=n(e);if(t){if("Error"!=t.ResponseClass)return t;o="e",Object(s.b)(r+"_c",t.ResponseCode||"un")}else o="nrm"}return Object(s.b)(r,o),null}},4785:function(e,n,r){"use strict";var o=r(57),t=r(24);function i(e){var n,r=Object(o.h)().SegmentationSettings,i=null===(n=Object(o.h)().SessionSettings)||void 0===n?void 0:n.IsShadowMailbox;return"junkemail"===e?!!(null==r?void 0:r.JunkEMail):"notes"!==e||!!(null==r?void 0:r.StickyNotes)&&Object(t.i)("cal-stickyNotesFolder")&&!i}r.d(n,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.MailBoot~StashConversationRows.js.map
self.scriptsLoaded['owa.MailBoot~StashConversationRows.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~StashConversationRows.js'] = (new Date()).getTime();