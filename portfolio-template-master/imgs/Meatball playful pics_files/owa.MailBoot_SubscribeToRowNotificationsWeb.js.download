self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SubscribeToRowNotificationsWeb.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[831],{18017:function(e,n,t){"use strict";t.r(n),t.d(n,"subscribeToRowNotificationsWeb",(function(){return v}));var o=t(1),r=t(6238),i=t(7516),a=t(7517),s=t(9837),u=t(4776),d=t(3217),c=t(3517),l=t(869),v=Object(u.a)((function(e,n,t,u){return function(e){var n,t,u,d,c;return Object(o.c)(this,void 0,void 0,(function(){var v,I,m;return Object(o.f)(this,(function(o){switch(o.label){case 0:return(v={subscriptionId:"RowNotification",requiresExplicitSubscribe:!0,subscriptionParameters:{}}).subscriptionId=e.input.subscriptionId,[4,l.b.import()];case 1:return I=o.sent()(),!0===(m={NotificationType:"RowNotification",FolderId:(p=e.input.type,b=e.input.commonRowsOptions.folderId,"Folder"==p?b:void 0),FocusedViewFilter:Object(r.a)(e.input.focusedViewFilter),IsConversation:"Conversation"==e.input.listViewType,CategoryFilter:null!==(n=e.input.categoryName)&&void 0!==n?n:void 0,Filter:e.input.viewFilter,ChannelId:I,MailboxId:f(e.input.type,e.input.commonRowsOptions.folderId)}).IsConversation?(m.ConversationShapeName=null!==(u=null===(t=e.input.shape)||void 0===t?void 0:t.ShapeName)&&void 0!==u?u:void 0,m.ConversationResponseShape=Object(i.a)(null!==(c=null===(d=e.input.shape)||void 0===d?void 0:d.IsScheduledFolder)&&void 0!==c&&c),m.SortBy=Object(a.a)(e.input.commonRowsOptions.sortBy)):m.SortBy=Object(s.a)(e.input.commonRowsOptions.sortBy),v.subscriptionParameters=m,[2,Promise.resolve(v)]}var p,b}))}))}(n).then((function(e){return{subscribe:function(n){return function(e,n){return Object(o.c)(this,void 0,void 0,(function(){var t;return Object(o.f)(this,(function(o){switch(o.label){case 0:return t=function(e){return function(n){e(function(e){var n,t;return"RowDeleted"==e.EventType?{__typename:"RowNotificationDeletePayload",id:e.id,EventType:e.EventType,Item:{InstanceKey:null===(n=e.Item)||void 0===n?void 0:n.InstanceKey},Conversation:{InstanceKey:null===(t=e.Conversation)||void 0===t?void 0:t.InstanceKey}}:{__typename:"RowNotificationChangePayload",id:e.id,EventType:e.EventType,Conversation:null!=e.Conversation?Object(d.b)(e.Conversation):void 0,Item:null!=e.Item?Object(c.b)(e.Item):void 0}}(n))}}(n),[4,l.h.importAndExecute(e,t)];case 1:return o.sent(),[2,t]}}))}))}(e,n)},unSubscribe:function(n){return function(e,n){return Object(o.c)(this,void 0,void 0,(function(){return Object(o.f)(this,(function(t){switch(t.label){case 0:return[4,l.i.importAndExecute(e,n)];case 1:return t.sent(),[2]}}))}))}(e,n)}}}))}));function f(e,n){return"Group"==e?n:void 0}},2281:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var o=t(1);function r(e){return Object(o.a)({__type:"SortResults:#Exchange"},e)}},3217:function(e,n,t){"use strict";function o(e){var n,t,o,r;return{__typename:"ConversationType",ConversationId:{Id:e.ConversationId.Id},ConversationTopic:null!==(n=e.ConversationTopic)&&void 0!==n?n:"",UniqueRecipients:e.UniqueRecipients,UniqueSenders:e.UniqueSenders,LastDeliveryTime:null!==(t=e.LastDeliveryTime)&&void 0!==t?t:"",Categories:e.Categories,FlagStatus:e.FlagStatus,FlagStatusV2:e.FlagStatusV2,HasAttachments:e.HasAttachments,MessageCount:e.MessageCount,GlobalMessageCount:e.GlobalMessageCount,UnreadCount:null!==(o=e.UnreadCount)&&void 0!==o?o:0,GlobalUnreadCount:e.GlobalUnreadCount,Size:e.Size,ItemClasses:e.ItemClasses,Importance:e.Importance,ItemIds:e.ItemIds,GlobalItemIds:e.GlobalItemIds,LastModifiedTime:e.LastModifiedTime,InstanceKey:e.InstanceKey,Preview:e.Preview,IconIndex:e.IconIndex,DraftItemIds:e.DraftItemIds,HasIrm:e.HasIrm,GlobalLikeCount:e.GlobalLikeCount,LastDeliveryOrRenewTime:null!==(r=e.LastDeliveryOrRenewTime)&&void 0!==r?r:"",GlobalMentionedMe:e.GlobalMentionedMe,GlobalAtAllMention:e.GlobalAtAllMention,SortOrderSource:e.SortOrderSource,LastSender:e.LastSender,From:e.From,ParentFolderId:e.ParentFolderId?{__typename:"FolderId",Id:e.ParentFolderId.Id}:void 0,EntityNamesMap:e.EntityNamesMap,HasExternalEmails:e.HasExternalEmails,ReturnTime:e.ReturnTime,HasSharepointLink:e.HasSharepointLink,HasAttachmentPreviews:e.HasAttachmentPreviews,HasProcessedSharepointLink:e.HasProcessedSharepointLink,CouponRanks:e.CouponRanks,CouponExpiryDates:e.CouponExpiryDates,mentionedMe:e.GlobalMentionedMe||e.GlobalAtAllMention,id:e.ConversationId.Id}}function r(e){var n,t,o,r,c;return{__typename:"ConversationRowConnection",edges:d(e.Conversations),pageInfo:{__typename:"PageInfo",endCursor:u(e.Conversations),hasNextPage:a(e),hasPreviousPage:i(e),startCursor:s(e.Conversations)},searchFolderId:null!==(t=null===(n=e.SearchFolderId)||void 0===n?void 0:n.Id)&&void 0!==t?t:void 0,folderId:null!==(r=null===(o=e.FolderId)||void 0===o?void 0:o.Id)&&void 0!==r?r:void 0,totalConversationRowsInView:null!==(c=e.TotalConversationsInView)&&void 0!==c?c:0}}function i(e){return!(void 0===e.IndexedOffset||!e.Conversations)&&e.IndexedOffset>e.Conversations.length}function a(e){return void 0!==e.IndexedOffset&&null!=e.TotalConversationsInView&&e.IndexedOffset<e.TotalConversationsInView}function s(e){var n;return e&&e.length>0&&null!==(n=e[0].InstanceKey)&&void 0!==n?n:""}function u(e){var n;return e&&e.length>0&&null!==(n=e[e.length-1].InstanceKey)&&void 0!==n?n:""}function d(e){return e&&0!=e.length?e.map((function(e){var n;return{__typename:"ConversationRowEdge",cursor:null!==(n=e.InstanceKey)&&void 0!==n?n:"",node:o(e)}})):[]}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o}))},3312:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var o=t(1);function r(e){return Object(o.a)({__type:"ConversationResponseShape:#Exchange"},e)}},3517:function(e,n,t){"use strict";function o(e){var n={__typename:"ItemRow",ItemId:{Id:e.ItemId.Id},Categories:e.Categories,ConversationId:{Id:e.ConversationId.Id},DateTimeReceived:e.DateTimeReceived,DateTimeSent:e.DateTimeSent,DisplayTo:e.DisplayTo,EntityNamesMap:e.EntityNamesMap,Flag:e.Flag,HasAttachments:e.HasAttachments,HasProcessedSharepointLink:e.HasProcessedSharepointLink,IconIndex:e.IconIndex,Importance:e.Importance,InstanceKey:e.InstanceKey,IsDraft:e.IsDraft,IsExternalSender:e.IsExternalSender,ItemClass:e.ItemClass,LastModifiedTime:e.LastModifiedTime,MentionedMe:e.MentionedMe,ParentFolderId:e.ParentFolderId?{__typename:"FolderId",Id:e.ParentFolderId.Id}:void 0,Preview:e.Preview,ReceivedOrRenewTime:e.ReceivedOrRenewTime,ReturnTime:e.ReturnTime,Sensitivity:e.Sensitivity,Size:e.Size,SortOrderSource:e.SortOrderSource,Subject:e.Subject,SystemCategories:e.SystemCategories,id:e.ItemId.Id};if(!(null==e?void 0:e.ItemClass)||-1!==e.ItemClass.indexOf("IPM.Note")||-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.GroupMailbox.JoinRequest")||-1!==e.ItemClass.indexOf("IPM.Post")||-1!==e.ItemClass.indexOf("IPM.Sharing")){var t=e;n.From=t.From,n.IsRead=t.IsRead,n.IsReadReceiptRequested=t.IsReadReceiptRequested,n.IsDeliveryReceiptRequested=t.IsDeliveryReceiptRequested,n.LikeCount=t.LikeCount,n.AntispamUnauthenticatedSender=t.AntispamUnauthenticatedSender}return n}function r(e){var n,t,o,r,c,l,v;return{__typename:"ItemRowConnection",edges:d(null===(n=e.RootFolder)||void 0===n?void 0:n.Items),pageInfo:{__typename:"PageInfo",endCursor:u(null===(t=e.RootFolder)||void 0===t?void 0:t.Items),hasNextPage:a(e),hasPreviousPage:i(e),startCursor:s(null===(o=e.RootFolder)||void 0===o?void 0:o.Items)},searchFolderId:null!==(c=null===(r=e.SearchFolderId)||void 0===r?void 0:r.Id)&&void 0!==c?c:void 0,totalItemRowsInView:null!==(v=null===(l=e.RootFolder)||void 0===l?void 0:l.TotalItemsInView)&&void 0!==v?v:0}}function i(e){var n,t,o,r,i;return!(void 0===(null===(n=e.RootFolder)||void 0===n?void 0:n.IndexedPagingOffset)||null===(t=e.RootFolder)||void 0===t||!t.Items)&&(null===(o=e.RootFolder)||void 0===o?void 0:o.IndexedPagingOffset)>(null===(i=null===(r=e.RootFolder)||void 0===r?void 0:r.Items)||void 0===i?void 0:i.length)}function a(e){var n,t,o,r;return void 0!==(null===(n=e.RootFolder)||void 0===n?void 0:n.IndexedPagingOffset)&&null!=(null===(t=e.RootFolder)||void 0===t?void 0:t.TotalItemsInView)&&(null===(o=e.RootFolder)||void 0===o?void 0:o.IndexedPagingOffset)<(null===(r=e.RootFolder)||void 0===r?void 0:r.TotalItemsInView)}function s(e){var n;return e&&e.length>0&&null!==(n=e[0].InstanceKey)&&void 0!==n?n:""}function u(e){var n;return e&&e.length>0&&null!==(n=e[e.length-1].InstanceKey)&&void 0!==n?n:""}function d(e){return e&&0!=e.length?e.map((function(e){var n;return{__typename:"ItemRowEdge",cursor:null!==(n=e.InstanceKey)&&void 0!==n?n:"",node:o(e)}})):[]}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o}))},4776:function(e,n,t){"use strict";var o=t(1),r=function(e){throw new Error(e.toString())};
/*!
    callback-to-async-iterator v1.1.1 - MIT license (https://github.com/withspectrum/callback-to-async-iterator.git)
*/var i=function(e,n){var t,o;void 0===n&&(n={});var i=n.onError,a=void 0===i?r:i,s=n.onClose;try{var u,d=[],c=[],l=!0,v=function(){l&&(l=!1,d.forEach((function(e){return e({value:void 0,done:!0})})),d=[],c=[],null==s||s(u))};return e((function(e){return function(e){0!==d.length?d.shift()({value:e,done:!1}):c.push(e)}(e)})).then((function(e){u=e})).catch((function(e){a(e)})),(t={next:function(){return l?new Promise((function(e){0!==c.length?e({value:c.shift(),done:!1}):d.push(e)})):this.return()},return:function(){return v(),Promise.resolve({value:void 0,done:!0})},throw:function(e){return v(),a(e),Promise.reject(e)}})[Symbol.asyncIterator]=function(){return this},t}catch(e){return a(e),(o={next:function(){return Promise.reject(e)},return:function(){return Promise.reject(e)},throw:function(e){return Promise.reject(e)}})[Symbol.asyncIterator]=function(){return this},o}},a=t(1274),s=t(23);function u(e){var n=this;return{subscribe:function(t,r,s,u){return Object(o.c)(n,void 0,void 0,(function(){var n,c;return Object(o.f)(this,(function(o){switch(o.label){case 0:return[4,e(t,r,s,u)];case 1:return n=o.sent(),Object(a.b)(n)?[2,n]:[2,i((c=n).subscribe,{onClose:c.unSubscribe,onError:d})]}}))}))},resolve:function(e){return e}}}function d(e){s.g.warn("Subscription error: "+e.message)}t.d(n,"a",(function(){return u}))},6238:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var o=t(94);function r(e){switch(e){case"None":return-1;case"Focused":return 0;case"Other":return 1;default:return Object(o.a)(e)}}},7516:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var o=t(3312),r=t(979);function i(e){return e?Object(o.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(r.a)({FieldURI:"ConversationReturnTime"})]}):Object(o.a)({BaseShape:"IdOnly"})}},7517:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var o=t(979),r=t(2281);function i(e){var n;switch(e.sortColumn){case"Date":e.canSortByRenewTime&&(n="ConversationLastDeliveryOrRenewTime");break;case"From":n="ConversationUniqueSenders";break;case"Size":n="ConversationSize";break;case"Subject":n="ConversationTopic";break;case"Importance":n="ConversationImportance";break;default:throw new Error("getConversationSortResultsFromSortBy: sort column is not supported "+e.sortColumn)}var t=[];n&&t.push(Object(r.a)({Order:e.sortDirection,Path:Object(o.a)({FieldURI:n})}));var i="Date"==e.sortColumn?e.sortDirection:"Descending";return t.push(Object(r.a)({Order:i,Path:Object(o.a)({FieldURI:"ConversationLastDeliveryTime"})})),t}},869:function(e,n,t){"use strict";var o=t(31),r={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};t.d(n,"h",(function(){return a})),t.d(n,"i",(function(){return s})),t.d(n,"b",(function(){return u})),t.d(n,"c",(function(){return d})),t.d(n,"g",(function(){return c})),t.d(n,"e",(function(){return l})),t.d(n,"f",(function(){return v})),t.d(n,"d",(function(){return f})),t.d(n,"a",(function(){return r}));var i=new o.c((function(){return Promise.all([t.e(4),t.e(21),t.e(739)]).then(t.bind(null,18223))})),a=new o.a(i,(function(e){return e.subscribe})),s=new o.a(i,(function(e){return e.unsubscribe})),u=new o.b(i,(function(e){return e.getChannelId})),d=new o.a(i,(function(e){return e.getChannelReady})),c=new o.a(i,(function(e){return e.setup})),l=new o.a(i,(function(e){return e.handleNotification})),v=new o.a(i,(function(e){return e.initializeNotificationManager})),f=new o.b(i,(function(e){return e.getNotificationEmitter}))},979:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var o=t(1);function r(e){return Object(o.a)({__type:"PropertyUri:#Exchange"},e)}},9837:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var o=t(449),r=t(979),i=t(2281),a="Descending";function s(e){var n,t;switch(e.sortColumn){case"Date":e.canSortByRenewTime?n="ReceivedOrRenewTime":e.isDraftsFolder&&(n="ItemLastModifiedTime");break;case"From":t=!0,n=Object(o.a)({PropertyTag:"0x0042",PropertyType:"String"});break;case"Size":n="Size";break;case"Importance":n="Importance";break;case"Subject":n="Subject";break;default:throw new Error("getMailItemSortByProperty: sort column not supported"+e.sortColumn)}var s=[];if(n){var u=n;t||(u=Object(r.a)({FieldURI:n})),s.push(Object(i.a)({Order:e.sortDirection,Path:u}))}var d="Date"==e.sortColumn?e.sortDirection:a;return s.push(Object(i.a)({Order:d,Path:Object(r.a)({FieldURI:"DateTimeReceived"})})),s}}}]);
//# sourceMappingURL=owa.MailBoot~SubscribeToRowNotificationsWeb.js.map
self.scriptsLoaded['owa.MailBoot~SubscribeToRowNotificationsWeb.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SubscribeToRowNotificationsWeb.js'] = (new Date()).getTime();