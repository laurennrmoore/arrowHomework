self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SubstrateSuggestions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[832],{18603:function(t,n,e){"use strict";e.r(n);var c=e(3174),r=e(183),o=e(209),u=Object(r.action)("execute3SPrimeCall")((function(){Object(c.b)(Object(o.d)().userIdentity,null,!1)}));e.d(n,"execute3SPrimeCall",(function(){return u}))},1986:function(t,n,e){"use strict";var c=e(1),r=e(2051),o=e(374),u=e(730),i=e(121),a=e(5),d="X-AnchorMailbox",s="Authorization",f="X-OwaWebSessionType",b="X-OWA-ExplicitLogonUser";function l(t,n){return Object(c.c)(this,void 0,void 0,(function(){var e,l,O,j,v;return Object(c.f)(this,(function(c){switch(c.label){case 0:if(e={},l=Object(o.k)(t)){if(l.accountState==o.b.AccessRevoked)return[2,null];if(l.accountState==o.b.AccountDeprovisioned||l.accountState==o.b.AccountNotFound)return Object(o.c)(l.accountState,l.accountProviderType),[2,null]}return n?(e[d]=n,e[b]=n):l&&(e[d]=l.anchorMailbox),l?(O=l.token,!(j=Object(u.g)(l.tokenExpiry))&&O?[3,2]:(Object(i.s)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(l.tokenExpiry,Object(a.Rb)()),isTokenExpired_1:j,isTokenInvalid_2:!O},{isCore:!0}),[4,r.a.importAndExecute(l.accountId,t,O)])):[3,3];case 1:(O=c.sent())||(O=""),c.label=2;case 2:v=void 0,"Outlook"==l.accountProviderType?(v='MSAuth1.0 usertoken="'+O+'", type="MSACT"',e[f]=1..toString()):"Google"!=l.accountProviderType&&"ICloud"!=l.accountProviderType||(v="Bearer "+O,e[f]=2..toString()),e[s]=v,c.label=3;case 3:return[2,e]}}))}))}var O=e(1989),j=e(23);function v(t,n){return Object(c.c)(this,void 0,void 0,(function(){var e,r;return Object(c.f)(this,(function(c){switch(c.label){case 0:return e=Object(O.a)(),r=e,[4,p(t,n)];case 1:return r.headers=c.sent(),e.authNeededOnUnAuthorized=!1,e.datapoint=e.datapoint||{},e.datapoint.mailbox="Connected",[2,e]}}))}))}function p(t,n){var e;return Object(c.c)(this,void 0,void 0,(function(){var r,o;return Object(c.f)(this,(function(c){switch(c.label){case 0:return r=n&&(null===(e=t.headers)||void 0===e?void 0:e.set)?new Headers(t.headers):new Headers,[4,l(t.mailboxInfo.userIdentity,h(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null)];case 1:return o=c.sent(),Object(O.b)(r,o),[2,r]}}))}))}function h(t,n){var e="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return e&&null==n&&j.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),e}e.d(n,"a",(function(){return l})),e.d(n,"b",(function(){return v})),e.d(n,"c",(function(){return h}))},1989:function(t,n,e){"use strict";function c(t,n){Object.keys(n).forEach((function(e){return t.set(e,n[e])}))}function r(t){var n=null!=t?t:{headers:new Headers};return n.datapoint=n.datapoint||{},n.datapoint.mailbox="Default",n}e.d(n,"b",(function(){return c})),e.d(n,"a",(function(){return r}))},1991:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var c=e(2),r=Object(c.action)("triggerReInitializeAccount",(function(t){return{userIdentity:t}}))},2051:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var c=e(31),r=e(1991);e.d(n,"b",(function(){return r.a}));var o=new c.c((function(){return e.e(1286).then(e.bind(null,2298))})),u=new c.a(o,(function(t){return t.getAndUpdateAccessToken}))},217:function(t,n,e){"use strict";var c=e(859);e.d(n,"a",(function(){return c.a}))},2226:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var c=e(24);function r(){return Object(c.i)("rp-cacheFirstPeopleTrieSize300")||Object(c.i)("rp-cacheFirstPeopleTrieSize500")||Object(c.i)("rp-cacheFirstPeopleTrieSize700")||Object(c.i)("rp-peopleTrieOnTimeoutLow")||Object(c.i)("rp-peopleTrieOnTimeoutMed")||Object(c.i)("rp-peopleTrieOnTimeoutHigh")}},2553:function(t,n,e){"use strict";var c=e(1),r=e(210);var o=e(24),u=e(8);e.d(n,"a",(function(){return d}));var i=null,a="searchtesthook";function d(t){void 0===t&&(t={});var n,e=Object(c.a)(Object(c.a)(Object(c.a)({},t),function(){if(!i){i={};var t=Object(u.a)(a),n=decodeURIComponent(t||"").trim();if(Object(o.i)("sea-debugHook")&&n.length>0){var e=n.split("&");i=e.reduce((function(t,n){var e=Object(c.g)(n.split("="),2),r=e[0],o=e[1];return t[r]=o,t}),{})}}return i}()),Object(r.a)("includePartnerIn3SRequest")?((n={}).partner="exchangeshared",n):null);return Object.keys(e).filter((function(t){return null!==e[t]})).reduce((function(t,n){var r;return Object(c.a)(Object(c.a)({},t),((r={})[n]=e[n],r))}),{})}},3174:function(t,n,e){"use strict";e.d(n,"a",(function(){return m})),e.d(n,"b",(function(){return T})),e.d(n,"c",(function(){return w}));var c=e(1),r=e(374),o=e(1986),u=e(24),i=e(203),a=e(217),d=e(151),s=e(2553),f=e(197),b=e(2226),l=e(23),O=e(3267),j="/search/api/v1/init?",v="/search/api/v1/suggestions?",p="owa.react.compose",h="AppendFreshContactsToTopN",y="20",S="5",A="CSRClientEnabled",m="owa.projectMoca.peopleCard";function T(t,n,e,r,o,u,a,s){return void 0===s&&(s=!0),Object(c.c)(this,void 0,void 0,(function(){var f,b,O,j,h;return Object(c.f)(this,(function(c){switch(c.label){case 0:return f=a||p,null!=n?[3,1]:[2,I(f)];case 1:return[4,g(n,e,s,u,f)];case 2:return b=c.sent(),O=function(t,n,e){return{AppName:"OWA",Scenario:{Name:e},Cvid:n||Object(i.a)(),EntityRequests:[t]}}(b,null==o?void 0:o.conversationId,f),j=d.e,h=[v+w(f,n),O,r,!1],[4,x(t,null==o?void 0:o.clientSessionId)];case 3:return[2,j.apply(void 0,h.concat([c.sent(),!0,!0,!1])).then((function(t){return t})).catch((function(t){return l.g.info(t),null}))]}}))}))}function I(t){return Object(c.c)(this,void 0,void 0,(function(){var n,e;return Object(c.f)(this,(function(c){switch(c.label){case 0:return n=d.b,e=[j+w(t),void 0,!0],[4,x(null)];case 1:return[2,n.apply(void 0,e.concat([c.sent(),!0,!1])).then((function(t){return Object(a.a)(t.status)?t.json():null})).catch((function(t){return t.networkError=!0,l.d(t),null}))]}}))}))}function g(t,n,e,r,o){return Object(c.c)(this,void 0,void 0,(function(){var u;return Object(c.f)(this,(function(c){return u={Query:{QueryString:t},EntityType:"People",Provenances:k(n),Size:n?y:S},r&&r.length>0&&(u.Context=function(t){var n={};t&&(n.RecipientsTo=t.toString());return n}(r)),u.Fields=o===m?Object(O.a)(2,e):Object(O.a)(1,e),[2,u]}))}))}function k(t){var n=["Mailbox"];return t&&!Object(f.a)()&&n.push("Directory"),n}function w(t,n){var e=Object(c.a)({scenario:t},Object(s.a)()),r=[];return Object(b.a)()&&(r.push(A),Object(u.i)("rp-EnableFreshContactsForZeroQuery")&&r.push(h)),r.length>0&&(e.setflight=r.join(",")),Object.keys(e).map((function(t){return t+"="+e[t]})).join("&")}function x(t,n){return Object(c.c)(this,void 0,void 0,(function(){var e;return Object(c.f)(this,(function(c){return e={},n&&(e["client-session-id"]=n),t&&Object(r.r)(t)?[2,Object(o.a)(t).then((function(t){return Object.keys(t).forEach((function(n){return e[n]=t[n]})),e}))]:[2,e]}))}))}},3267:function(t,n,e){"use strict";e.d(n,"a",(function(){return a}));var c=e(2226),r=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"],o=r.concat(["FeatureData","GivenName","Surname","Alias","AdditionalNames"]),u=r.concat(["FeatureData"]),i=r.concat(["Phones","OfficeLocation","Department"]);function a(t,n){return void 0===n&&(n=!0),2===t?i:Object(c.a)()&&n?0==t?o:u:r}},374:function(t,n,e){"use strict";var c,r=e(2);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(c||(c={}));var o,u=e(44),i=Object(r.action)("addAccount",(function(t){return{userIdentity:t.userIdentity,account:t}})),a=Object(r.action)("removeAccount",(function(t){return{userIdentity:t}})),d=Object(r.action)("updateAccount",(function(t,n,e){return{userIdentity:t,accountToken:n,accountTokenExpiresIn:e}})),s=Object(r.action)("updateOWAConnectedAccountStatus",(function(t,n){return{userIdentity:t,accountState:n}})),f=Object(r.action)("accountIsInErrorState",(function(t,n){return Object(u.c)({name:"accountIsInErrorState",customData:{accountState_1:c[t],accountProvider_2:n}},{accountState:t})})),b=Object(r.action)("retryAccountUpdateToken",(function(t,n,e){return{accountId:t,userIdentity:n,currentToken:e}})),l=Object(r.action)("connectedAccountsListRequested",(function(t){return{isSuccess:t}})),O=Object(r.action)("setAccountsStoreState",(function(t){return{state:t}})),j=e(1),v=e(14);!function(t){t[t.None=0]="None",t[t.Loading=1]="Loading",t[t.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",t[t.AccountsLoadError=3]="AccountsLoadError"}(o||(o={}));var p=Object(r.createStore)("OWAAccountsStore",{accountsMap:new v.ObservableMap({}),accountsLoadedState:o.None}),h=e(94),y=e(57);function S(t){return t!=Object(y.b)()&&void 0!==m(t)}function A(){return Object(j.j)([],Object(j.g)(p().accountsMap.values()))}function m(t){return p().accountsMap.get(t)}function T(){var t;return(null===(t=A())||void 0===t?void 0:t.length)>0?A()[0]:null}function I(){return A().filter((function(t){return t.accountState!=c.Valid}))}function g(t){return A().filter((function(n){return t.includes(n.accountState)}))}function k(t){return A().filter((function(n){return n.accountProviderType==t}))}function w(t){return S(t)?m(t).accountProviderType:null}function x(t){return"Outlook"==t.accountProviderType?'MSAuth1.0 usertoken="'+t.token+'", type="MSACT"':"Google"==t.accountProviderType||"ICloud"==t.accountProviderType?"Bearer "+t.token:Object(h.a)(t.accountProviderType)}function E(t,n){return function(e){var c=m(e);return c?c[t]:n}}E("accountUniqueId","0");var P=E("accountState",c.Valid),C=function(){return A().some((function(t){return!F(t.userIdentity)}))},M=E("accountProviderType",null),L=function(t){return"Outlook"==M(t)},F=function(t){return P(t)==c.Valid},N=function(){return A().length>0};function D(){return p().accountsLoadedState}var R=e(5),U=e(121);Object(r.mutator)(i,(function(t){var n=t.account;Object(U.s)("owaAccountAdded",{accountStatus_1:c[n.accountState]}),p().accountsMap.set(n.userIdentity,n)})),Object(r.mutator)(a,(function(t){var n=t.userIdentity;p().accountsMap.delete(n)})),Object(r.mutator)(d,(function(t){var n=t.userIdentity,e=t.accountToken,c=t.accountTokenExpiresIn,r=p().accountsMap.get(n);r.token=e,r.tokenExpiry=Object(R.j)(Object(R.Rb)(),parseInt(c))})),Object(r.mutator)(s,(function(t){var n=t.userIdentity,e=t.accountState,r=p().accountsMap.get(n);r.accountState==c.Valid&&e!=c.Valid&&Object(U.s)("owaConnectedAccountStatusUpdated",{accountStatus_1:c[e]}),r.accountState=e})),Object(r.mutator)(l,(function(t){var n=t.isSuccess?o.AccountsLoadSuccessful:o.AccountsLoadError;p().accountsLoadedState=n})),Object(r.mutator)(O,(function(t){p().accountsLoadedState=t.state})),e.d(n,"d",(function(){return i})),e.d(n,"u",(function(){return a})),e.d(n,"y",(function(){return d})),e.d(n,"x",(function(){return s})),e.d(n,"c",(function(){return f})),e.d(n,"v",(function(){return b})),e.d(n,"e",(function(){return l})),e.d(n,"w",(function(){return O})),e.d(n,"n",(function(){return A})),e.d(n,"k",(function(){return m})),e.d(n,"i",(function(){return T})),e.d(n,"f",(function(){return I})),e.d(n,"g",(function(){return g})),e.d(n,"o",(function(){return k})),e.d(n,"j",(function(){return w})),e.d(n,"m",(function(){return x})),e.d(n,"l",(function(){return P})),e.d(n,"q",(function(){return C})),e.d(n,"t",(function(){return L})),e.d(n,"s",(function(){return F})),e.d(n,"p",(function(){return N})),e.d(n,"h",(function(){return D})),e.d(n,"r",(function(){return S})),e.d(n,"b",(function(){return c})),e.d(n,"a",(function(){return o}))},730:function(t,n,e){"use strict";var c=e(2),r=Object(c.action)("initializeOwaObservableDateTime"),o=Object(c.action)("observableNowChanged"),u=Object(c.action)("observableTodayChanged"),i=e(5),a=e(14),d=Object(c.createStore)("ObservableDateTime",{now:0,today:0}),s=Object(a.computed)((function(){return Object(i.nc)(d().now)})),f=function(){return s.get()},b=Object(a.computed)((function(){return Object(i.nc)(d().today)})),l=function(){return b.get()},O=function(t){return Object(i.Hb)(t,f())},j=function(t){return Object(i.Fb)(t,f())},v=function(t){return h(t,i.Hb)},p=function(t){return h(t,i.Ib)},h=function(t,n){return n(Object(i.Yb)(Object(i.nc)(t)),l())};function y(t){if(!t)return"";var n=Object(i.nc)(t);return function(t,n){var e=Object(i.Yb)(t);if(Object(i.Jb)(e,n))return i.ab;var c=function(t){return Object(i.Ob)(e,Object(i.e)(n,-t),n)};if(c(3))return i.ib;if(c(30))return i.hb;return i.Y}(n,l())(n)}function S(t){if(!t)return"";var n=Object(i.nc)(t);return function(t,n){var e=Object(i.Yb)(t);if(Object(i.Jb)(e,n))return i.T;return i.U}(n,l())(n)}function A(t){return t?function(t,n){var e=Object(i.Yb)(t);return Object(i.Jb)(e,n)?Object(i.ab)(t):m(e,n,2)?Object(i.lb)(t):m(e,n,7)?Object(i.H)(Object(i.bb)(t),Object(i.ab)(t)):Object(i.H)(Object(i.J)(t),Object(i.ab)(t))}(Object(i.nc)(t),l()):""}function m(t,n,e){return Object(i.Ob)(t,Object(i.e)(n,-e),n)}var T=Object(c.action)("updateTimes"),I=Object(c.action)("setNow"),g=Object(c.action)("setToday",(function(t){return{today:t}}));Object(c.mutator)(I,(function(){d().now=Object(i.lc)()})),Object(c.mutator)(g,(function(t){var n=t.today;d().today=n}));var k=e(21),w=e(79),x=!1;Object(c.orchestrator)(r,(function(){if(T(),!x){var t=Object(i.Rb)(),n=Object(i.ac)(Object(i.h)(t,1)),e=Object(i.w)(n,t);setTimeout((function(){return setInterval(T,k.g)}),e),document&&document.addEventListener("visibilitychange",T),x=!0}})),Object(c.orchestrator)(w.l,(function(){T()})),Object(c.orchestrator)(T,(function(){I();var t=Object(i.Ab)(Object(i.mc)()),n=d().today!=t;n&&g(t),o(),n&&u()})),e.d(n,"d",(function(){return r})),e.d(n,"j",(function(){return o})),e.d(n,"l",(function(){return u})),e.d(n,"i",(function(){return f})),e.d(n,"k",(function(){return l})),e.d(n,"g",(function(){return O})),e.d(n,"e",(function(){return j})),e.d(n,"f",(function(){return v})),e.d(n,"h",(function(){return p})),e.d(n,"a",(function(){return y})),e.d(n,"b",(function(){return S})),e.d(n,"c",(function(){return A}))},859:function(t,n,e){"use strict";function c(t){return t>=200&&t<300}e.d(n,"a",(function(){return c}))}}]);
//# sourceMappingURL=owa.MailBoot~SubstrateSuggestions.js.map
self.scriptsLoaded['owa.MailBoot~SubstrateSuggestions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SubstrateSuggestions.js'] = (new Date()).getTime();