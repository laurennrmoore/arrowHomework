self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~TriageAction.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[863],{1001:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(0),i=t(218);function a(e,n,t){var a=r.useState(n),o=a[0],c=a[1],u=Object(i.a)(void 0!==e),s=u?e:o,d=r.useRef(s),l=r.useRef(t);r.useEffect((function(){d.current=s,l.current=t}));var b=Object(i.a)((function(){return function(e,n){var t="function"==typeof e?e(d.current):e;l.current&&l.current(n,t),u||c(t)}}));return[s,b]}},11536:function(e){e.exports=JSON.parse('{"a":"hAb"}')},1300:function(e,n,t){"use strict";var r=t(1);function i(e){return e>0}var a=t(2),o=t(44),c=Object(a.action)("UNSUBSCRIBE_FROM_BRAND_SUBSCRIPTION",(function(e,n,t,r,i,a){return Object(o.c)({name:"UnsubscribeSubscription",customData:{unsubscribeSourceType:e}},{unsubscribeSourceType:e,smtpAddress:n,smtpIdentifier:t,unsubscribeSilentUris:r,unsubscribeHttpUri:i,completedCallback:a})})),u=Object(a.action)("AFTER_UNSUBSCRIBE",(function(e,n,t,r,i){return{smtpIdentifier:e,unsubscribeSourceType:n,responseType:t,debugMessage:r,completedCallback:i}})),s=t(6),d=t(151),l="ows/api/beta/subscriptions/{0}/unsubscribe";var b,f=function(e,n){return Object(d.d)(Object(s.c)(l,e),{unsubscribeSilentUris:n},null,!0)};!function(e){e[e.Fail=0]="Fail",e[e.Success=1]="Success"}(b||(b={}));var v=b,m=t(14),O=Object(a.createStore)("BrandSubscription",{subscriptions:new m.ObservableMap({}),unsubscribedSubscriptions:new m.ObservableMap({})})();function j(e){return e&&O.subscriptions.has(e.toLowerCase())?O.subscriptions.get(e.toLowerCase()):null}var k=Object(a.mutatorAction)("unsubscribeFromCache",(function(e){var n=Object(r.a)({},j(e));n?(O.subscriptions.delete(e.toLowerCase()),O.unsubscribedSubscriptions.set(e.toLowerCase(),n)):g()})),p=t(217);Object(a.orchestrator)(c,(function(e){return Object(r.c)(void 0,void 0,void 0,(function(){var n,t,a,o,c,s,d,l,b,m,O,j;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=e.unsubscribeSourceType,t=e.smtpAddress,a=e.smtpIdentifier,o=e.unsubscribeSilentUris,c=e.unsubscribeHttpUri,s=e.completedCallback,c&&0!==c.length||o&&0!==o.length?(o&&i(o.length)||!c?d="No unsubscribe URIs provided":(window.open(c,"_blank"),d="Opened unsubscribe URI in new tab"),[4,f(a,o)]):(d="No unsubscribe URIs or SilentURIs provided",l=v.Fail,u(a,n,l,d,s),[2,Promise.reject("No unsubscribe URIs or SilentURIs provided")]);case 1:return b=r.sent(),m=null,Object(p.a)(b.status)?(d="Unsubscribe service called successfully. "+d,l=v.Success,k(t),[3,4]):[3,2];case 2:return d="Unsubscribe service failed. "+d,l=v.Fail,[4,b.text().then((function(e){return e?JSON.parse(e):{}}))];case 3:O=r.sent(),(m=new Error("ResponseCode="+b.status+", ErrorMessage="+(null===(j=null==O?void 0:O.error)||void 0===j?void 0:j.message))).fetchErrorType="ServerFailure",r.label=4;case 4:return u(a,n,l,d,s),m?[2,Promise.reject(m)]:[2,Promise.resolve()]}}))}))}));Object(a.mutator)(u,(function(e){var n=e.unsubscribeSourceType,t=e.responseType,r=e.debugMessage,i=e.completedCallback;"BrandCard"===n&&i&&i(t===v.Success,r)}));var h=Object(a.mutatorAction)("populateSubscriptionStore",(function(e){e.subscriptions.forEach((function(e){var n;(null===(n=null==e?void 0:e.smtpInfo)||void 0===n?void 0:n.smtpAddress)&&O.subscriptions.set(e.smtpInfo.smtpAddress.toLowerCase(),e)})),e.unsubscribedSubscriptions.forEach((function(e){var n;(null===(n=null==e?void 0:e.smtpInfo)||void 0===n?void 0:n.smtpAddress)&&O.unsubscribedSubscriptions.set(e.smtpInfo.smtpAddress.toLowerCase(),e)}))})),y="ows/api/beta/subscriptions?orderBy=name, asc";var g=function(e){return Object(r.c)(this,void 0,void 0,(function(){var n,t;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,Object(d.b)(e?y+"&noResolveBrand=true":y,void 0,!0)];case 1:return n=r.sent(),Object(p.a)(n.status)?[4,n.json()]:[3,3];case 2:return t=r.sent(),h(t),[2,t];case 3:return[2,null]}}))}))};t.d(n,"b",(function(){return g})),t.d(n,"e",(function(){return c})),t.d(n,"d",(function(){return u})),t.d(n,"a",(function(){return v})),t.d(n,"c",(function(){return j})),t.d(n,"f",(function(){return i}))},137:function(e,n,t){"use strict";var r=t(618),i=t(5);function a(){var e=Object(i.Rb)(),n=Object(i.f)(Object(i.mc)(),12),t=Object(i.f)(Object(i.mc)(),18),r="Evening";return Object(i.y)(n,e)>0?r="Morning":Object(i.y)(t,e)>0&&(r="Afternoon"),r}function o(e,n,t){return Object(i.Ob)(e,n,t)}var c=t(85);function u(e,n){return function(e){var n=e%c.a.SecondsInOneMinute;return e-n+c.a.SecondsInOneMinute}(Object(i.y)(e,n))}var s=15*c.a.SecondsInOneMinute;function d(e,n){return u(e,n)<=s}var l=t(64),b=function(e,n,t){switch(t){case l.d.FirstFullWeek:return f(e,n,c.a.DaysInOneWeek);case l.d.FirstFourDayWeek:return f(e,n,4);default:return function(e,n){var t=v(e)-1,r=(Object(i.ob)(e)-t%c.a.DaysInOneWeek-n+2*c.a.DaysInOneWeek)%c.a.DaysInOneWeek;return Math.floor((t+r)/c.a.DaysInOneWeek+1)}(e,n)}};function f(e,n,t){var r=v(e)-1,a=Object(i.ob)(e)-r%c.a.DaysInOneWeek,o=v(Object(i.nc)(Object(i.Db)(e)-1,l.e.December,31))-1,u=(n-a+2*c.a.DaysInOneWeek)%c.a.DaysInOneWeek;0!==u&&u>=t&&(u-=c.a.DaysInOneWeek);var s=r-u;return s<0&&(0!==(u=(n-(a-=o%c.a.DaysInOneWeek)+2*c.a.DaysInOneWeek)%c.a.DaysInOneWeek)&&u+1>=t&&(u-=c.a.DaysInOneWeek),s=o-u),Math.floor(s/c.a.DaysInOneWeek+1)}function v(e){for(var n=Object(i.yb)(e),t=Object(i.Db)(e),r=0,a=0;a<n;a++)r+=m(a+1,t);return r+=Object(i.mb)(e)}function m(e,n){return Object(i.pb)(Object(i.nc)(n,e,0))}function O(e){for(var n=[],t=0;t<c.a.DaysInOneWeek;t++)e&1<<t&&n.push(t);return n}function j(e,n,t){for(var a=[],o=t.sort((function(e,n){var t=Object(i.p)(e.start,n.start);return 0!==t?t:Object(i.p)(e.end,n.end)})),c=Object(i.Yb)(e),u=0;Object(i.p)(c,n)<0&&u<o.length;){var s={start:c,end:Object(i.A)(c)},d=Object(r.h)(o[u],s,!1);d<=0?(0===d&&a.push(c),c=Object(i.e)(c,1)):u++}return a}t.d(n,"h",(function(){return r.g})),t.d(n,"g",(function(){return r.f})),t.d(n,"n",(function(){return r.k})),t.d(n,"d",(function(){return r.c})),t.d(n,"e",(function(){return r.d})),t.d(n,"s",(function(){return r.n})),t.d(n,"o",(function(){return r.l})),t.d(n,"p",(function(){return r.m})),t.d(n,"b",(function(){return r.a})),t.d(n,"j",(function(){return r.h})),t.d(n,"c",(function(){return r.b})),t.d(n,"f",(function(){return r.e})),t.d(n,"l",(function(){return r.j})),t.d(n,"k",(function(){return r.i})),t.d(n,"t",(function(){return r.o})),t.d(n,"w",(function(){return a})),t.d(n,"u",(function(){return o})),t.d(n,"v",(function(){return d})),t.d(n,"q",(function(){return u})),t.d(n,"r",(function(){return b})),t.d(n,"a",(function(){return c.a})),t.d(n,"i",(function(){return O})),t.d(n,"m",(function(){return j}))},14075:function(e){e.exports=JSON.parse('{"a":"$zb","b":"aAb","c":"bAb","d":"cAb"}')},14076:function(e){e.exports=JSON.parse('{"a":"Xzb","b":"Yzb","c":"Zzb","d":"_zb"}')},14077:function(e){e.exports=JSON.parse('{"a":"bBb","b":"cBb"}')},14078:function(e){e.exports=JSON.parse('{"a":"$Ab","b":"aBb"}')},14079:function(e){e.exports=JSON.parse('{"a":"XAb"}')},14080:function(e){e.exports=JSON.parse('{"b":"YAb","a":"ZAb"}')},14081:function(e){e.exports=JSON.parse('{"a":"WAb"}')},14082:function(e){e.exports=JSON.parse('{"a":"UAb","b":"VAb"}')},14083:function(e){e.exports=JSON.parse('{"a":"jAb","c":"kAb","b":"lAb","d":"mAb"}')},14084:function(e){e.exports=JSON.parse('{"a":"dAb","b":"eAb","c":"fAb","d":"gAb"}')},14085:function(e){e.exports=JSON.parse('{"h":"AAb","t":"BAb","p":"CAb","e":"DAb","l":"EAb","g":"FAb","s":"GAb","o":"HAb","d":"IAb","k":"JAb","f":"KAb","r":"LAb","n":"MAb","c":"NAb","j":"OAb","a":"PAb","q":"QAb","m":"RAb","b":"SAb","i":"TAb"}')},14086:function(e){e.exports=JSON.parse('{"b":"xAb","a":"yAb"}')},14087:function(e){e.exports=JSON.parse('{"a":"zAb"}')},14088:function(e){e.exports=JSON.parse('{"b":"vAb","a":"wAb"}')},14089:function(e){e.exports=JSON.parse('{"b":"tAb","a":"uAb"}')},14090:function(e){e.exports=JSON.parse('{"b":"nAb","c":"oAb","e":"pAb","f":"qAb","a":"rAb","d":"sAb"}')},14091:function(e){e.exports=JSON.parse('{"a":"P1a","b":"Q1a"}')},1554:function(e,n,t){"use strict";var r=t(768),i=t(3),a=t(0),o=t(815),c=t(604),u=t(1001),s=t(713),d=t(622),l=t(424),b=Object(s.a)(),f=a.forwardRef((function(e,n){var t=e.disabled,r=e.required,s=e.inputProps,f=e.name,v=e.ariaLabel,m=e.ariaLabelledBy,O=e.ariaDescribedBy,j=e.ariaPositionInSet,k=e.ariaSetSize,p=e.title,h=e.label,y=e.checkmarkIconProps,g=e.styles,I=e.theme,S=e.className,w=e.boxSide,N=void 0===w?"start":w,T=Object(o.a)("checkbox-",e.id),C=a.useRef(null),A=Object(c.a)(C,n),x=a.useRef(null),R=Object(u.a)(e.checked,e.defaultChecked,e.onChange),F=R[0],E=R[1],M=Object(u.a)(e.indeterminate,e.defaultIndeterminate),V=M[0],D=M[1];Object(d.b)(C),function(e,n,t,r){a.useImperativeHandle(e.componentRef,(function(){return{get checked(){return!!n},get indeterminate(){return!!t},focus:function(){r.current&&r.current.focus()}}}),[r,n,t])}(e,F,V,x);var P=b(g,{theme:I,className:S,disabled:t,indeterminate:V,checked:F,reversed:"start"!==N,isUsingCustomLabelRender:!!e.onRenderLabel}),_=a.useCallback((function(e){return e&&e.label?a.createElement("span",{"aria-hidden":"true",className:P.text,title:e.title},e.label):null}),[P.text]),L=e.onRenderLabel||_,B=V?"mixed":F?"true":"false",U=Object(i.__assign)(Object(i.__assign)({className:P.input,type:"checkbox"},s),{checked:!!F,disabled:t,required:r,name:f,id:T,title:p,onChange:function(e){V?(E(!!F,e),D(!1)):E(!F,e)},"aria-disabled":t,"aria-label":v||h,"aria-labelledby":m,"aria-describedby":O,"aria-posinset":j,"aria-setsize":k,"aria-checked":B});return a.createElement("div",{className:P.root,title:p,ref:A},a.createElement("input",Object(i.__assign)({},U,{ref:x,"data-ktp-execute-target":!0})),a.createElement("label",{className:P.label,htmlFor:T},a.createElement("div",{className:P.checkbox,"data-ktp-target":!0},a.createElement(l.a,Object(i.__assign)({iconName:"CheckMark"},y,{className:P.checkmark}))),L(e,_)))}));f.displayName="CheckboxBase";var v=t(7),m=t(283),O={root:"ms-Checkbox",label:"ms-Checkbox-label",checkbox:"ms-Checkbox-checkbox",checkmark:"ms-Checkbox-checkmark",text:"ms-Checkbox-text"};t.d(n,"a",(function(){return j}));var j=Object(r.a)(f,(function(e){var n,t,r,a,o,c,u,s,d,l,b,f,j,k,p,h,y,g,I=e.className,S=e.theme,w=e.reversed,N=e.checked,T=e.disabled,C=e.isUsingCustomLabelRender,A=e.indeterminate,x=S.semanticColors,R=S.effects,F=S.palette,E=S.fonts,M=Object(v.getGlobalClassNames)(O,S),V=x.inputForegroundChecked,D=F.neutralSecondary,P=F.neutralPrimary,_=x.inputBackgroundChecked,L=x.inputBackgroundChecked,B=x.disabledBodySubtext,U=x.inputBorderHovered,J=x.inputBackgroundCheckedHovered,W=x.inputBackgroundChecked,H=x.inputBackgroundCheckedHovered,K=x.inputBackgroundCheckedHovered,q=x.inputTextHovered,Q=x.disabledBodySubtext,z=x.bodyText,G=x.disabledText,Y=[(n={content:'""',borderRadius:R.roundedCorner2,position:"absolute",width:10,height:10,top:4,left:4,boxSizing:"border-box",borderWidth:5,borderStyle:"solid",borderColor:T?B:_,transitionProperty:"border-width, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)"},n[v.HighContrastSelector]={borderColor:"WindowText"},n)];return{root:[M.root,{position:"relative",display:"flex"},w&&"reversed",N&&"is-checked",!T&&"is-enabled",T&&"is-disabled",!T&&[!N&&(t={},t[":hover ."+M.checkbox]=(r={borderColor:U},r[v.HighContrastSelector]={borderColor:"Highlight"},r),t[":focus ."+M.checkbox]={borderColor:U},t[":hover ."+M.checkmark]=(a={color:D,opacity:"1"},a[v.HighContrastSelector]={color:"Highlight"},a),t),N&&!A&&(o={},o[":hover ."+M.checkbox]={background:H,borderColor:K},o[":focus ."+M.checkbox]={background:H,borderColor:K},o[v.HighContrastSelector]=(c={},c[":hover ."+M.checkbox]={background:"Highlight",borderColor:"Highlight"},c[":focus ."+M.checkbox]={background:"Highlight"},c[":focus:hover ."+M.checkbox]={background:"Highlight"},c[":focus:hover ."+M.checkmark]={color:"Window"},c[":hover ."+M.checkmark]={color:"Window"},c),o),A&&(u={},u[":hover ."+M.checkbox+", :hover ."+M.checkbox+":after"]=(s={borderColor:J},s[v.HighContrastSelector]={borderColor:"WindowText"},s),u[":focus ."+M.checkbox]={borderColor:J},u[":hover ."+M.checkmark]={opacity:"0"},u),(d={},d[":hover ."+M.text+", :focus ."+M.text]=(l={color:q},l[v.HighContrastSelector]={color:T?"GrayText":"WindowText"},l),d)],I],input:(b={position:"absolute",background:"none",opacity:0},b["."+m.a+" &:focus + label::before"]=(f={outline:"1px solid "+S.palette.neutralSecondary,outlineOffset:"2px"},f[v.HighContrastSelector]={outline:"1px solid WindowText"},f),b),label:[M.label,S.fonts.medium,{display:"flex",alignItems:C?"center":"flex-start",cursor:T?"default":"pointer",position:"relative",userSelect:"none"},w&&{flexDirection:"row-reverse",justifyContent:"flex-end"},{"&::before":{position:"absolute",left:0,right:0,top:0,bottom:0,content:'""',pointerEvents:"none"}}],checkbox:[M.checkbox,(j={position:"relative",display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:"20px",width:"20px",border:"1px solid "+P,borderRadius:R.roundedCorner2,boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)",overflow:"hidden",":after":A?Y:null},j[v.HighContrastSelector]=Object(i.__assign)({borderColor:"WindowText"},Object(v.getHighContrastNoAdjustStyle)()),j),A&&{borderColor:_},w?{marginLeft:4}:{marginRight:4},!T&&!A&&N&&(k={background:W,borderColor:L},k[v.HighContrastSelector]={background:"Highlight",borderColor:"Highlight"},k),T&&(p={borderColor:B},p[v.HighContrastSelector]={borderColor:"GrayText"},p),N&&T&&(h={background:Q,borderColor:B},h[v.HighContrastSelector]={background:"Window"},h)],checkmark:[M.checkmark,(y={opacity:N?"1":"0",color:V},y[v.HighContrastSelector]=Object(i.__assign)({color:T?"GrayText":"Window"},Object(v.getHighContrastNoAdjustStyle)()),y)],text:[M.text,(g={color:T?G:z,fontSize:E.medium.fontSize,lineHeight:"20px"},g[v.HighContrastSelector]=Object(i.__assign)({color:T?"GrayText":"WindowText"},Object(v.getHighContrastNoAdjustStyle)()),g),w?{marginRight:4}:{marginLeft:4}]}}),void 0,{scope:"Checkbox"})},1962:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return c}));var r=t(1971),i=t(2),a={tabs:[{id:"primaryTab",type:r.a.Primary,state:2,blink:!1,sxsId:"primaryTab"}],tabBarWidth:0,isOverflowMenuShown:!1},o=Object(i.createStore)("tab",a),c=(o(),o().tabs[0])},1971:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.MailCompose=3]="MailCompose",e[e.FloatingChat=4]="FloatingChat",e[e.SxS=5]="SxS",e[e.CalendarCompose=6]="CalendarCompose"}(r||(r={}))},2006:function(e,n,t){"use strict";t.d(n,"r",(function(){return a})),t.d(n,"A",(function(){return o})),t.d(n,"d",(function(){return c})),t.d(n,"v",(function(){return u})),t.d(n,"y",(function(){return s})),t.d(n,"z",(function(){return d})),t.d(n,"x",(function(){return l})),t.d(n,"w",(function(){return b})),t.d(n,"f",(function(){return f})),t.d(n,"g",(function(){return v})),t.d(n,"i",(function(){return m})),t.d(n,"n",(function(){return O})),t.d(n,"B",(function(){return j})),t.d(n,"s",(function(){return k})),t.d(n,"k",(function(){return p})),t.d(n,"u",(function(){return h})),t.d(n,"a",(function(){return y})),t.d(n,"m",(function(){return g})),t.d(n,"q",(function(){return I})),t.d(n,"j",(function(){return S})),t.d(n,"b",(function(){return w})),t.d(n,"o",(function(){return N})),t.d(n,"c",(function(){return T})),t.d(n,"h",(function(){return C})),t.d(n,"p",(function(){return A})),t.d(n,"l",(function(){return x})),t.d(n,"e",(function(){return R})),t.d(n,"t",(function(){return F}));var r=t(31),i=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(4),t.e(5),t.e(6),t.e(7),t.e(15),t.e(17),t.e(16),t.e(19),t.e(22),t.e(31),t.e(29),t.e(32),t.e(41),t.e(75),t.e(110),t.e(120),t.e(136),t.e(166),t.e(222),t.e(221),t.e(345)]).then(t.bind(null,4014))})),a=new r.b(i,(function(e){return e.removeExtensibilityNotification})),o=new r.b(i,(function(e){return e.updatePersistentNotifications})),c=new r.b(i,(function(e){return e.closeTaskPaneAddinCommand})),u=new r.b(i,(function(e){return e.triggerAppointmentTimeChangedEvent})),s=new r.b(i,(function(e){return e.triggerRecipientsChangedEvent})),d=new r.b(i,(function(e){return e.triggerRecurrenceChangedEvent})),l=new r.b(i,(function(e){return e.triggerLocationsChangedEvent})),b=new r.b(i,(function(e){return e.triggerAttachmentsChangedEvent})),f=new r.b(i,(function(e){return e.deinitializeAddinsForItem})),v=new r.b(i,(function(e){return e.initializeAddinsForItem})),m=new r.a(i,(function(e){return e.initializeExtensibilityContext})),O=new r.b(i,(function(e){return e.onHostItemChanged})),j=new r.b(i,(function(e){return e.whenItemHasContextualAddinKeywords})),k=new r.b(i,(function(e){return e.runContextualEvaluationAndUpdate})),p=new r.b(i,(function(e){return e.launchTranslateCommand})),h=new r.b(i,(function(e){return e.shouldForceOnSendCompliantBehavior})),y=(Object(r.d)(i,(function(e){return e.AddinBarView})),Object(r.d)(i,(function(e){return e.TaskPaneCollection}))),g=new r.b(i,(function(e){return e.onComposeClose})),I=new r.b(i,(function(e){return e.openContextualCallout})),S=new r.b(i,(function(e){return e.launchAddinCommand})),w=new r.b(i,(function(e){return e.observeAddinCommandSurfaceItems})),N=new r.b(i,(function(e){return e.onItemNavigation})),T=new r.b(i,(function(e){return e.allowItemSendEvent})),C=new r.a(i,(function(e){return e.ExecuteEntryPoint})),A=new r.a(i,(function(e){return e.onLaunchEventTriggered})),x=new r.a(i,(function(e){return e.logAppTeachingUICalloutTelemetry})),R=new r.b(i,(function(e){return e.convertRecurrenceToAddinFormat})),F=new r.b(i,(function(e){return e.seriesTimeJsonConverter}))},2010:function(e,n,t){"use strict";t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return c})),t.d(n,"d",(function(){return u})),t.d(n,"a",(function(){return d}));var r=t(2301),i=t(19),a=t(2012);function o(){return s(r.a.Bottom)}function c(){return s(r.a.Off)}function u(){return s(r.a.Right)}function s(e){var n=Object(a.a)();return null!==n.clientReadingPanePosition?n.clientReadingPanePosition===e:Object(i.a)().UserOptions.GlobalReadingPanePositionReact==e}function d(){var e=Object(i.a)().UserOptions.GlobalReadingPanePositionReact;return e==r.a.Off||e==r.a.Bottom}},2012:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2),i=Object(r.createStore)("maillayout",{clientReadingPanePosition:null,showReadingPane:!1,showListPane:!0,showFolderPane:!0,senderColumnWidth:null,subjectColumnWidth:null,receivedColumnWidth:null})},2015:function(e,n,t){"use strict";var r=t(1),i=t(14),a=t(2),o=t(3078);function c(e){return Math.floor(Math.random()*e+1)}var u=t(3079);t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return d})),t.d(n,"d",(function(){return l})),t.d(n,"e",(function(){return f}));var s=4,d=8,l={toDate:null,fromDate:null,includeAttachments:!1,initialSearchScope:null,isSearchHistoryDirty:!1,isAnswerInitialized:!1,isAnswerLocalizationCompleted:!1,isUnread:!1,isToMe:!1,isFlagged:!1,isMentioned:!1,previousNode:null,searchNumber:0,staticSearchScope:null,staticSearchScopeList:null,shouldShowAdvancedSearch:!1,advancedSearchViewState:Object(o.a)(),initialAdvancedSearchViewState:Object(o.a)(),legacySuggestions:new i.ObservableMap({}),recipientForPersonalizedGhostTextIndex:c(u.a-1),generalizedGhostTextBankIndex:c(s-1),personalizedGhostTextBankIndex:c(d-1),usePersonalGhostText:!1,isAnswerAvailable:!1},b=Object(r.a)({},l),f=Object(a.createStore)("mailSearchStore",b),v=f();n.c=v},2036:function(e,n,t){"use strict";t.d(n,"b",(function(){return s}));var r=t(1),i=t(14),a=t(24),o=t(2066),c=t(2),u={conversationReadingPaneViewState:null,loadedItemReadingPaneViewStates:new i.ObservableMap({}),loadedConversationReadingPaneViewStates:new i.ObservableMap({}),itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1,primaryReadingPaneTabId:null,sxsItemId:null},s=Object(c.createStore)("readingpane",u),d=s();o.a.registerReference((function(){var e,n;return Object(a.i)("rp-persistedReadingPaneTabs")?Object(r.j)([],Object(r.g)(d.loadedConversationReadingPaneViewStates.keys())):null===(n=null===(e=d.conversationReadingPaneViewState)||void 0===e?void 0:e.conversationId)||void 0===n?void 0:n.Id})),n.a=d},2043:function(e,n,t){"use strict";var r=t(31),i=t(1962),a=t(2116),o=t(1),c=t(1971);function u(e){var n,t,r=Object(i.a)();try{for(var a=Object(o.k)(r.tabs),u=a.next();!u.done;u=a.next()){var s=u.value;if(s.type!==c.a.Primary&&s.type!==c.a.SxS&&s.data==e)return s}}catch(e){n={error:e}}finally{try{u&&!u.done&&(t=a.return)&&t.call(a)}finally{if(n)throw n.error}}return null}function s(e){var n,t,r=Object(i.a)();try{for(var a=Object(o.k)(r.tabs),c=a.next();!c.done;c=a.next()){var u=c.value;if(u.sxsId===e)return u.id}}catch(e){n={error:e}}finally{try{c&&!c.done&&(t=a.return)&&t.call(a)}finally{if(n)throw n.error}}return null}var d=t(2358);function l(e){var n,t,r=Object(d.a)(e);if(r){var a=Object(i.a)();try{for(var c=Object(o.k)(a.tabs),u=c.next();!u.done;u=c.next()){var s=u.value;if(s.id===r)return s.sxsId}}catch(e){n={error:e}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(n)throw n.error}}}return null}function b(e){var n,t,r,a,u=Object(i.a)();try{for(var s=Object(o.k)(u.tabs),d=s.next();!d.done;d=s.next()){var l=d.value;if(l.type!==c.a.Primary&&l.type!==c.a.SxS&&(null===(a=null===(r=l.data)||void 0===r?void 0:r.id)||void 0===a?void 0:a.Id)==e)return!0}}catch(e){n={error:e}}finally{try{d&&!d.done&&(t=s.return)&&t.call(s)}finally{if(n)throw n.error}}return!1}var f=t(2122);t(2191);t.d(n,"g",(function(){return m})),t.d(n,"h",(function(){return O})),t.d(n,"i",(function(){return j})),t.d(n,"k",(function(){return k})),t.d(n,"j",(function(){return p})),t.d(n,"e",(function(){return i.a})),t.d(n,"l",(function(){return i.b})),t.d(n,"d",(function(){return a.a})),t.d(n,"b",(function(){return u})),t.d(n,"c",(function(){return s})),t.d(n,"f",(function(){return l})),t.d(n,"n",(function(){return b})),t.d(n,"a",(function(){return c.a})),t.d(n,"m",(function(){return f.b}));var v=new r.c((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(3),t.e(29),t.e(32),t.e(41),t.e(72),t.e(192),t.e(309),t.e(302),t.e(839)]).then(t.bind(null,18596))})),m=new r.a(v,(function(e){return e.activateTab})),O=new r.a(v,(function(e){return e.addTab})),j=new r.a(v,(function(e){return e.closeTab})),k=new r.a(v,(function(e){return e.setTabIsShown})),p=new r.b(v,(function(e){return e.getTabById}))},2044:function(e,n,t){"use strict";var r=t(2),i=t(44),a=t(1947),o=Object(r.action)("selectFocusedViewFilter",(function(e,n){return Object(i.c)({name:0===e?"TnS_SelectFocusedPivot":"TnS_SelectOtherPivot",options:{isCore:!0},customData:[e,n,null!=a.ab.inboxPausedDateTime]},{focusedViewFilter:e,actionSource:n})})),c=Object(r.action)("ON_INITIAL_TABLE_LOAD_COMPLETE",(function(e){return{tableView:e}})),u=t(3148),s=t(14);var d=Object(r.mutatorAction)("addTableViewToStore",(function(e,n){n.set(e.id,e)}));function l(e,n){var t=Object(a.M)().tableViews,r=Object(u.a)(e),i=t.get(r);if(!i&&(i=function(e,n){return{currentLoadedIndex:0,loadErrorStatus:0,id:e,isInCheckedMode:!1,isInVirtualSelectAllMode:!1,isInitialLoadComplete:!1,isLoading:!0,rowKeys:[],rowIdToRowKeyMap:new s.ObservableMap,lastEmptiedTime:null,selectAllModeTimeStamp:null,selectedRowKeys:new s.ObservableMap,serverFolderId:n.folderId,tableQuery:n,totalRowsInView:0,virtualSelectAllExclusionList:[],selectionAnchorRowKey:null,focusedRowKey:null,multiSelectionAnchorRowKey:null}}(r,e),!n)){var o=i.id;d(i,t),i=t.get(o)}return i}t.d(n,"a",(function(){return 25})),t.d(n,"b",(function(){return 25})),t.d(n,"e",(function(){return o})),t.d(n,"d",(function(){return c})),t.d(n,"c",(function(){return l}))},2053:function(e,n,t){"use strict";var r=t(31),i={sequentialIndex:"0",nonSequentialIndex:"-1"};t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return c})),t.d(n,"c",(function(){return u})),t.d(n,"d",(function(){return i}));var a=new r.c((function(){return Promise.all([t.e(15),t.e(17),t.e(16),t.e(709)]).then(t.bind(null,18579))})),o=new r.a(a,(function(e){return e.registerComponent})),c=new r.a(a,(function(e){return e.resetFocus})),u=new r.a(a,(function(e){return e.setFocusToSynchronous}))},2060:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return a})),t.d(n,"e",(function(){return o})),t.d(n,"d",(function(){return c}));var r="FileAttachment:#Exchange",i="ItemAttachment:#Exchange",a="ItemIdAttachment:#Exchange",o="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange"},2064:function(e,n,t){"use strict";t.d(n,"j",(function(){return u})),t.d(n,"d",(function(){return s})),t.d(n,"c",(function(){return d})),t.d(n,"a",(function(){return l})),t.d(n,"b",(function(){return b})),t.d(n,"k",(function(){return f})),t.d(n,"m",(function(){return v})),t.d(n,"h",(function(){return m})),t.d(n,"f",(function(){return O})),t.d(n,"g",(function(){return j})),t.d(n,"e",(function(){return k})),t.d(n,"l",(function(){return p})),t.d(n,"i",(function(){return h}));var r=t(31),i=t(2356),a=t(2290),o=t(2337),c=t(2913),u=new r.c((function(){return Promise.all([t.e(4),t.e(6),t.e(7),t.e(8),t.e(10),t.e(13),t.e(14),t.e(15),t.e(17),t.e(16),t.e(18),t.e(21),t.e(19),t.e(22),t.e(23),t.e(24),t.e(27),t.e(28),t.e(30),t.e(31),t.e(33),t.e(40),t.e(42),t.e(48),t.e(933)]).then(t.bind(null,4341))})),s=Object(r.d)(u,(function(e){return e.SearchHeaderFirstRowContent})),d=Object(r.d)(u,(function(e){return e.SearchFiltersContainer})),l=Object(r.d)(u,(function(e){return e.AdvancedSearchWrapper})),b=Object(r.d)(u,(function(e){return e.FolderScopePicker})),f=new r.b(u,(function(e){return e.setStaticSearchScopeData})),v=new r.b(u,(function(e){return e.startSearchWithCategory})),m=new r.a(u,(function(e){return e.findEmailFromSender})),O=(new r.b(u,(function(e){return e.initializeLivePersonaCard})),new r.b(u,(function(e){return e.personaControlStore})),new r.b(u,(function(e){return e.createFallbackPersonaSearchTableQuery}))),j=new r.b(u,(function(e){return e.createFallbackPrivateDistributionListSearchTableQuery})),k=new r.b(u,(function(e){return e.createFallbackCategorySearchTableQuery})),p=new r.b(u,(function(e){return e.shouldShowInScopeSelector}));Object(r.f)(i.a,u,(function(e){return e.getSuggestionsOrchestrator})),Object(r.f)(a.a,u,(function(e){return e.searchSessionStartedOrchestrator})),Object(r.f)(o.a,u,(function(e){return e.startSearchOrchestrator}),{captureBundleTime:!0}),Object(r.f)(c.a,u,(function(e){return e.startAnswerSearchSessionOrchestrator}));var h=new r.b(u,(function(e){return e.getNaturalLanguageGhostText}))},2093:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(2036),i=t(24),a=t(2442);function o(e){return Object(i.i)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedConversationReadingPaneViewStates.get(e||Object(r.b)().sxsItemId||Object(a.a)()):Object(r.b)().conversationReadingPaneViewState}},2110:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2060);function i(e){return(e.__type||e.OwsTypeName)===r.e}},2112:function(e,n,t){"use strict";t.d(n,"p",(function(){return c})),t.d(n,"h",(function(){return u})),t.d(n,"b",(function(){return s})),t.d(n,"f",(function(){return d})),t.d(n,"j",(function(){return l})),t.d(n,"m",(function(){return b})),t.d(n,"s",(function(){return f})),t.d(n,"k",(function(){return v})),t.d(n,"r",(function(){return m})),t.d(n,"o",(function(){return O})),t.d(n,"l",(function(){return j})),t.d(n,"d",(function(){return k})),t.d(n,"i",(function(){return p})),t.d(n,"q",(function(){return h})),t.d(n,"c",(function(){return y})),t.d(n,"n",(function(){return g})),t.d(n,"g",(function(){return I})),t.d(n,"e",(function(){return S})),t.d(n,"t",(function(){return w}));var r=t(31),i=t(2268);t.d(n,"a",(function(){return i.a}));var a=new r.c((function(){return Promise.all([t.e(4),t.e(15),t.e(17),t.e(16),t.e(22),t.e(26),t.e(29),t.e(43),t.e(41),t.e(47),t.e(66),t.e(72),t.e(75),t.e(136),t.e(166),t.e(183),t.e(169),t.e(279),t.e(255),t.e(221),t.e(705),t.e(915)]).then(t.bind(null,3352))})),o={captureBundleTime:!0},c=new r.a(a,(function(e){return e.replyToMessage}),o),u=new r.a(a,(function(e){return e.forwardMessage}),o),s=new r.a(a,(function(e){return e.closeCompose})),d=new r.a(a,(function(e){return e.discardCompose})),l=new r.a(a,(function(e){return e.loadDraftToCompose})),b=new r.a(a,(function(e){return e.openCompose})),f=new r.a(a,(function(e){return e.trySaveAndCloseCompose})),v=new r.a(a,(function(e){return e.moveComposeToTab})),m=new r.a(a,(function(e){return e.tryCreateResendDraft})),O=new r.a(a,(function(e){return e.replyToApprovalMessage})),j=new r.a(a,(function(e){return e.onEditDraftButtonClicked})),k=new r.b(a,(function(e){return e.createReply})),p=new r.b(a,(function(e){return e.getToCcRecipientsForReply})),h=new r.b(a,(function(e){return e.replyToMessageAndCreateViewState})),y=new r.b(a,(function(e){return e.createAttachments})),g=new r.b(a,(function(e){return e.popoutCompose})),I=new r.b(a,(function(e){return e.extractComposePopoutData})),S=new r.b(a,(function(e){return e.didInsertLinksHaveIssuesOnBlockDialogDismiss})),w=new r.b(a,(function(e){return e.insertSignature}))},2116:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(1),i=t(1971),a=t(1962),o=t(23);function c(){var e,n,t=Object(a.a)();try{for(var c=Object(r.k)(t.tabs),u=c.next();!u.done;u=c.next()){var s=u.value;if(2==s.state&&s.type!=i.a.FloatingChat)return s}}catch(n){e={error:n}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return o.d("There is no active tab. Something went very wrong."),null}},2122:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return o}));var r=t(1971),i={};function a(e,n){i[r.a[e]]=n}function o(e){return i[r.a[e]]}},2126:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"c",(function(){return a})),t.d(n,"d",(function(){return o})),t.d(n,"f",(function(){return c})),t.d(n,"g",(function(){return u})),t.d(n,"b",(function(){return s})),t.d(n,"e",(function(){return d}));var r=t(2),i=Object(r.action)("CLEAR_SEARCH_SCOPE",(function(e,n,t){return{actionSource:e,shouldStartSearch:n,searchScopeKind:t}})),a=Object(r.action)("LOAD_MESSAGE_SUGGESTION_INTO_TABLE",(function(e,n,t,r,i,a){return{actionSource:e,row:n,searchTableQuery:t,referenceId:r,traceId:i,itemPartId:a}})),o=Object(r.action)("LOAD_TABLE_VIEW_FROM_SEARCH_TABLE_QUERY",(function(e,n,t){return{searchTableQuery:e,searchEndToEndPerformanceDatapoint:n,actionSource:t}})),c=Object(r.action)("SET_STATIC_SEARCH_SCOPE",(function(e){return{searchScope:e}})),u=Object(r.action)("START_SEARCH_WITH_CATEGORY",(function(e,n){return{actionSource:e,categoryName:n}})),s=Object(r.action)("FIND_EMAIL_FROM_SENDER_CLICKED",(function(e,n){return{senderName:e,senderEmail:n}})),d=Object(r.action)("ON_ANSWER_RENDERED")},2157:function(e,n,t){"use strict";var r,i,a;t.d(n,"c",(function(){return r})),t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return a})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.File=3]="File",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.Setting=8]="Setting"}(r||(r={})),function(e){e.ODSPFile="ODSP file",e.CloudyAttachment="Cloudy attachment",e.ClassicAttachment="Classic attachment",e.LinkAttachment="Link attachment",e.Unknown="Unknown"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Checking=1]="Checking",e[e.NotSupported=2]="NotSupported",e[e.Supported=3]="Supported"}(a||(a={}))},2166:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"d",(function(){return o})),t.d(n,"b",(function(){return c})),t.d(n,"c",(function(){return u}));var r,i=t(210),a=t(57);function o(){var e,n,t=d();return s()&&t?r.ToDo:(n=Object(a.h)(),(null===(e=n.SessionSettings)||void 0===e?void 0:e.IsShadowMailbox)||t?r.None:r.LegacyTasks)}function c(){return s()&&d()}function u(){return s()&&d(!0)}function s(){var e,n,t=Object(a.h)(),r=Object(i.a)("todoIsExplicitLogon")&&(null===(e=t.SessionSettings)||void 0===e?void 0:e.IsExplicitLogon),o=null===(n=t.SessionSettings)||void 0===n?void 0:n.IsShadowMailbox;return!r&&!o}function d(e){var n=Object(a.h)(),t=n.UserOptions,r=n.PolicySettings;return!!((null==t?void 0:t.ReactOptinSettings)&&(t.ReactOptinSettings.TasksGraduatedFromBeta||t.ReactOptinSettings.TasksEnabled&&(e||function(e){var n;return(null===(n=null==e?void 0:e.ReactOptinSettings)||void 0===n?void 0:n.TasksShouldUseSharedToggle)?1!==e.ClientTypeOptInState:1!==e.TasksClientTypeOptInState}(t))&&function(e){if(e&&!1===e.OutlookBetaToggleEnabled)return!1;return!0}(r))&&null!==t.ReactOptinSettings.TasksRedirectUrl)}!function(e){e[e.None=0]="None",e[e.LegacyTasks=1]="LegacyTasks",e[e.ToDo=2]="ToDo"}(r||(r={}))},217:function(e,n,t){"use strict";var r=t(859);t.d(n,"a",(function(){return r.a}))},2191:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1962);function i(){return Object(r.a)().tabs.filter((function(e){return 3===e.state}))}},2211:function(e,n,t){"use strict";var r=t(1),i=t(2527),a=t(2);var o=Object(a.mutatorAction)("removeInfoBarMessages",(function(e,n){e&&(Array.isArray(n)?n:n?[n]:e.infoBarIds?Object(r.j)([],Object(r.g)(e.infoBarIds)):[]).forEach((function(n){return function(e,n){var t=e.infoBarIds&&e.infoBarIds.indexOf(n);t>=0&&e.infoBarIds.splice(t,1);var r=e.infoBarHostKey;i.b[r]&&(delete i.b[r][n],0===Object.keys(i.b[r]).length&&delete i.b[r])}(e,n)}))}));n.a=o},2223:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2391);function i(e){return e&&Object(r.b)(e.ItemClass)}},2239:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"Message:#Exchange"},e)}},2242:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2299);function i(){return r.a}},2252:function(e,n,t){"use strict";var r=t(31),i=t(2651),a=t(2015),o=t(2126);function c(e){var n=e.tableQuery;return 0===n.type?n.folderId:function(e){if(1!=e.type)return!1;var n=e.searchScope;return["PrimaryMailbox","ArchiveMailbox","SharedFolders"].indexOf(n.kind)>-1}(n)?n.searchScope.folderId:null}var u=t(2599),s=t(2652),d=t(2600),l=t(2653),b=t(2064);t.d(n,"a",(function(){return v})),t.d(n,"n",(function(){return m})),t.d(n,"c",(function(){return i.b})),t.d(n,"r",(function(){return a.c})),t.d(n,"i",(function(){return a.e})),t.d(n,"f",(function(){return o.a})),t.d(n,"t",(function(){return o.f})),t.d(n,"s",(function(){return o.e})),t.d(n,"g",(function(){return c})),t.d(n,"j",(function(){return u.a})),t.d(n,"k",(function(){return s.a})),t.d(n,"h",(function(){return d.a})),t.d(n,"l",(function(){return l.a})),t.d(n,"o",(function(){return b.j})),t.d(n,"e",(function(){return b.d})),t.d(n,"d",(function(){return b.c})),t.d(n,"b",(function(){return b.b})),t.d(n,"p",(function(){return b.k})),t.d(n,"q",(function(){return b.m})),t.d(n,"m",(function(){return b.h}));var f=new r.c((function(){return Promise.all([t.e(4),t.e(6),t.e(7),t.e(8),t.e(10),t.e(13),t.e(14),t.e(15),t.e(17),t.e(16),t.e(18),t.e(21),t.e(19),t.e(22),t.e(23),t.e(24),t.e(27),t.e(28),t.e(30),t.e(31),t.e(33),t.e(40),t.e(42),t.e(48),t.e(933)]).then(t.bind(null,4341))})),v=Object(r.d)(f,(function(e){return e.AnswersContainer})),m=new r.a(f,(function(e){return e.initializeAndWarmupAnswers}))},2268:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("conversationSendStateChanged",(function(e,n){return{viewState:e,isSendPending:n}}))},2269:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(988);function i(e){var n;return null===(n=r.a.projections)||void 0===n?void 0:n.filter((function(n){return n.tabId==e||n.window==e}))[0]}},2290:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2),i=Object(r.action)("SEARCH_SESSION_STARTED",(function(e,n,t){return{actionSource:e,shouldStartSearch:n,scenarioId:t}}))},2292:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("DELETE_ITEMS_STORE_UPDATE",(function(e,n,t){return{itemContexts:e,parentFolderId:n,actionType:t}}))},2299:function(e,n,t){"use strict";var r=t(2);var i=t(14),a=Object(r.createStore)("extensibility",{EnabledAddinCommands:null,HostItems:new i.ObservableMap,IsPreinstalledTeachingUIAvailable:!1,Context:null,frameworkComponentHostItemIndexMap:new i.ObservableMap,taskPanes:new i.ObservableMap,activeDialogs:new i.ObservableMap,ExtensibilityStateIsDirty:!1,contextualCalloutState:{activeContextualAddinCommands:[],contextualAnchor:null,hostItemIndex:null,selectedTerms:[]},runningContextualAddinCommand:null,runningUILessExtendedAddinCommands:new i.ObservableMap,autoRunAddinCommandWaitingQueue:new i.ObservableMap,compliance:{isMinor:!1},activeAutorunUilessFrames:new i.ObservableMap})();n.a=a},2301:function(e,n,t){"use strict";var r;!function(e){e[e.Off=0]="Off",e[e.Right=1]="Right",e[e.Bottom=2]="Bottom"}(r||(r={})),n.a=r},2318:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(19);function i(){return Object(r.a)().SessionSettings.IsSubstrateSearchServiceAvailable}},2319:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2012);function i(){return Object(r.a)().showReadingPane}},2326:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(2010),i=t(2319);function a(){return Object(r.c)()&&Object(i.a)()}},2337:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2),i=Object(r.action)("START_SEARCH",(function(e,n,t,r,i,a){return void 0===t&&(t=!1),void 0===r&&(r=[]),void 0===a&&(a="All"),{actionSource:e,scenarioId:n,explicitSearch:t,connectedAccountInfo:r,searchProvider:i,filter:a}}))},2339:function(e,n,t){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}t.d(n,"a",(function(){return r}))},2342:function(e,n,t){"use strict";var r=t(31),i=t(2408),a=t(2438),o=t(2409),c=t(2339),u=t(2410),s=t(2376),d=t(2439);function l(e){var n=e;return"Single"===n.CalendarItemType&&!n.RecurrenceId}function b(e){return!!e.RecurrenceId}t.d(n,"s",(function(){return v})),t.d(n,"t",(function(){return m})),t.d(n,"w",(function(){return O})),t.d(n,"d",(function(){return j})),t.d(n,"g",(function(){return k})),t.d(n,"h",(function(){return p})),t.d(n,"b",(function(){return h})),t.d(n,"f",(function(){return y})),t.d(n,"e",(function(){return g})),t.d(n,"i",(function(){return I})),t.d(n,"j",(function(){return S})),t.d(n,"a",(function(){return w})),t.d(n,"c",(function(){return N})),t.d(n,"v",(function(){return T})),t.d(n,"u",(function(){return C})),t.d(n,"k",(function(){return i.a})),t.d(n,"x",(function(){return a.a})),t.d(n,"m",(function(){return o.a})),t.d(n,"q",(function(){return c.a})),t.d(n,"r",(function(){return u.a})),t.d(n,"l",(function(){return s.a})),t.d(n,"o",(function(){return d.a})),t.d(n,"p",(function(){return l})),t.d(n,"n",(function(){return b}));var f=new r.c((function(){return Promise.all([t.e(4),t.e(7),t.e(13),t.e(14),t.e(15),t.e(17),t.e(16),t.e(21),t.e(24),t.e(28),t.e(31),t.e(40),t.e(53),t.e(56),t.e(154),t.e(194),t.e(289),t.e(284),t.e(727)]).then(t.bind(null,18176))})),v=new r.a(f,(function(e){return e.addItemToCalendar})),m=new r.a(f,(function(e){return e.initializeMeetingRequestViewStateAction})),O=new r.a(f,(function(e){return e.removeCancelledMeetingFromCalendar})),j=Object(r.d)(f,(function(e){return e.MeetingMessageInfo})),k=(Object(r.d)(f,(function(e){return e.MeetingRequestActions})),Object(r.d)(f,(function(e){return e.MeetingCancellationAction})),Object(r.d)(f,(function(e){return e.MeetingActionButton})),Object(r.d)(f,(function(e){return e.MeetingDetailsTime})),Object(r.d)(f,(function(e){return e.MeetingDetailsLocation})),Object(r.d)(f,(function(e){return e.MeetingRequestInfo}))),p=Object(r.d)(f,(function(e){return e.MeetingRequestResponseEditor})),h=Object(r.d)(f,(function(e){return e.MeetingDetails})),y=Object(r.d)(f,(function(e){return e.MeetingRequestConflicts})),g=(Object(r.d)(f,(function(e){return e.EditEventLink})),Object(r.d)(f,(function(e){return e.MeetingMessageSummary}))),I=Object(r.d)(f,(function(e){return e.PreviewSummary})),S=Object(r.d)(f,(function(e){return e.SenderSummary})),w=Object(r.d)(f,(function(e){return e.CollapsedMeetingMessage})),N=Object(r.d)(f,(function(e){return e.MeetingIcon})),T=new r.a(f,(function(e){return e.logMeetingMessageActionForInvite})),C=new r.a(f,(function(e){return e.logMeetingMessageActionForEvent}))},2356:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(2),i=t(44),a=Object(r.action)("GET_SUGGESTIONS",(function(e){return Object(i.c)({name:"Search_SuggestionsE2E"},{scenarioId:e})}))},2358:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2269);function i(e){var n=Object(r.a)(e);return n?n.tabId:null}},2376:function(e,n,t){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}t.d(n,"a",(function(){return r}))},2377:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(2036),i=t(24),a=t(2442);function o(e){return Object(i.i)("rp-persistedReadingPaneTabs")?Object(r.b)().loadedItemReadingPaneViewStates.get(e||Object(a.a)()):Object(r.b)().itemReadingPaneViewState}},2389:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"ItemChange:#Exchange"},e)}},2392:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("DELETE_CONVERSATION_STORE_UPDATE",(function(e,n,t){return{conversationIds:e,tableView:n,actionType:t}}))},2401:function(e,n,t){"use strict";var r=t(2),i=Object(r.action)("ON_NUDGE_REMOVED",(function(e){return{rowKey:e}})),a=Object(r.action)("ON_GET_NUDGES_COMPLETED",(function(e,n){return{nudgedRows:e,tableView:n}})),o=Object(r.createStore)("nudgeStore",{nudgedRows:[]}),c=o();Object(r.mutator)(a,(function(e){c.nudgedRows=e.nudgedRows})),Object(r.mutator)(i,(function(e){for(var n=c.nudgedRows.length-1;n>=0;n--)c.nudgedRows[n].rowKey===e.rowKey&&c.nudgedRows.splice(n,1)}));var u=t(3674),s=t(6);function d(e){var n=c.nudgedRows.filter((function(n){return n.rowKey===e}))[0],t=n.daysAgo,r=0==n.reason;return 0==t?r?Object(s.b)(u.c):Object(s.b)(u.f):1==t?r?Object(s.b)(u.b):Object(s.b)(u.e):r?Object(s.c)(Object(s.b)(u.a),t):Object(s.c)(Object(s.b)(u.d),t)}var l=t(1947);function b(e,n){return c.nudgedRows.some((function(t){return t.rowKey===e&&t.tableViewId===n||"testNudgeRowKey"==e}))}var f=t(3547);function v(e,n,t){return!!b(e,n)&&(!!Object(f.c)(n)&&!Object(l.w)(t))}function m(e){var n=c.nudgedRows.filter((function(n){return n.conversationId===e}));return n.length>0&&j(n[0])?n[0].rowKey:null}function O(e){var n=c.nudgedRows.filter((function(n){return n.itemId===e}));return n.length>0&&j(n[0])?n[0].rowKey:null}function j(e){var n=e.tableViewId,t=Object(l.M)().tableViews.get(n);if(!t||t.id!=Object(l.K)())return!1;var r=e.rowKey;return v(r,n,l.b.getLastDeliveryOrRenewTimeStamp(r,t))}function k(e){var n=c.nudgedRows.filter((function(n){return n.rowKey===e}));return n.length>0?n[0].itemId:null}t.d(n,"c",(function(){return d})),t.d(n,"e",(function(){return O})),t.d(n,"d",(function(){return m})),t.d(n,"b",(function(){return k})),t.d(n,"a",(function(){return v})),t.d(n,"g",(function(){return b})),t.d(n,"f",(function(){return o})),t.d(n,"h",(function(){return a})),t.d(n,"i",(function(){return i}))},2408:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("deleteMeetingMessage",(function(e,n){return{item:e,issueDeleteItemCall:n}}))},2409:function(e,n,t){"use strict";function r(e){return(null==e?void 0:e.ItemClass)&&e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}t.d(n,"a",(function(){return r}))},2410:function(e,n,t){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.resp/i)}t.d(n,"a",(function(){return r}))},2421:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"SetItemField:#Exchange"},e)}},2438:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("meetingMessageAddToCalendarStatusChanged",(function(e,n){return{status:e,sxsId:n}}))},2439:function(e,n,t){"use strict";function r(e){var n=e;return"RecurringMaster"===n.CalendarItemType&&!n.RecurrenceId}t.d(n,"a",(function(){return r}))},2440:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(24);function i(){return Object(r.i)("rp-linkedInViewProfile")||Object(r.i)("rp-linkedInViewProfileV1_1")}},2441:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var r="displaylinkedindataprebind"},2442:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(2043),i=t(2627);function a(){var e=Object(r.d)();switch(e.type){case r.a.SecondaryReadingPane:return e.data.id.Id;case r.a.Primary:default:return Object(i.a)()}}},2527:function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return i}));var r={};function i(e,n){var t,i=e.infoBarHostKey;return null===(t=r[i])||void 0===t?void 0:t[n]}},2532:function(e,n,t){"use strict";var r=t(33),i=t(1);function a(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(i.a)({__type:"UpdateItemJsonRequest:#Exchange"},t)),Object(r.a)("UpdateItem",e,n)}t.d(n,"a",(function(){return a}))},2539:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"UpdateItemRequest:#Exchange"},e)}},2556:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(19);function i(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},2593:function(e,n,t){"use strict";var r=t(31),i=t(1947),a=t(2013),o=t(1956),c=t(1964),u=t(2256);var s=t(2223);function d(e,n){if(n.folderId&&"junkemail"==Object(c.a)(n.folderId))return!1;if(Object(s.a)(e))return!1;var t=o.u.items.get(e.ItemId.Id);return!(null==t||!t.shouldShowAttachmentPreviews)||!(!e.HasAttachments&&!e.HasProcessedSharepointLink)&&(v.importAndExecute(Object(a.d)(n),e.ConversationId,e.ItemId.Id),!0)}var l=function(e,n,t){void 0===t&&(t={listViewStore:i.ab});var r,o,s,d=1==n.type,l=e.ConversationId,b=t.listViewStore.conversationItems.get(l.Id),f=e.HasProcessedSharepointLink;if(n.folderId&&"junkemail"==Object(c.a)(n.folderId))return!1;if((null==(r=e)?void 0:r.ItemClasses)&&r.ItemClasses.length>0&&r.ItemClasses.some((function(e){return 0===e.indexOf(u.a)})))return!1;if(d){if(null==b?void 0:b.shouldShowAttachmentPreviews)return!0;o=s=!!e.HasAttachments||f}else{if(!e.HasAttachmentPreviews&&!f)return!1;b&&!f?(o=b.globalItemIds.length!=e.GlobalItemIds.length,s=b.shouldShowAttachmentPreviews):(o=!0,s=!0)}return o&&v.importAndExecute(Object(a.d)(n),e.ConversationId,null),s};t.d(n,"b",(function(){return f})),t.d(n,"a",(function(){return v})),t.d(n,"c",(function(){return m})),t.d(n,"d",(function(){return O})),t.d(n,"e",(function(){return l})),t.d(n,"f",(function(){return d}));var b=new r.c((function(){return t.e(535).then(t.bind(null,18420))})),f=new r.a(b,(function(e){return e.getPreviews})),v=new r.a(b,(function(e){return e.add})),m=new r.a(b,(function(e){return e.getAttachmentsForConversationWell})),O=new r.a(b,(function(e){return e.removeAttachmentPreviewsForRow}))},2599:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(24),i=t(2318),a=t(455);function o(){return Object(i.a)()&&(Object(r.i)("sea-fetchPeople2")||Object(r.i)("sea-fetchEvents2")||Object(r.i)("sea-calendarTriggerControl2")||Object(r.i)("sea-fetchFlights2")||Object(r.i)("sea-flightTriggerControl2")||Object(r.i)("sea-fetchFiles4")||Object(r.i)("sea-fileTriggerControl4")||Object(r.i)("sea-peopleTriggerControl2"))||Object(i.a)()&&Object(a.a)()&&(Object(r.i)("sea-fetchBookmarks2")||Object(r.i)("sea-bookmarkTriggerControl2")||Object(r.i)("sea-fetchAcronyms2")||Object(r.i)("sea-fetchLinks2")||Object(r.i)("sea-linkTriggerControl2")||Object(r.i)("sea-acronymTriggerControl2"))}},2600:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(2015),i=t(24),a=t(2318),o=t(57);function c(){var e=Object(r.e)().staticSearchScope,n=null==e?void 0:e.kind;return Object(o.h)().SessionSettings.IsExplicitLogon?"ArchiveMailbox"===n?3:Object(i.i)("sea-3s-explicitLogon")&&Object(a.a)()?0:2:"PrimaryMailbox"===n?Object(a.a)()?Object(i.i)("sea-v23sQueryApi")?1:0:2:"ArchiveMailbox"===n?Object(i.i)("sea-archive-mailbox-3S")&&Object(a.a)()?0:2:"Group"===n?2:"SharedFolders"===n?3:null}},2626:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("updateInternetMessageId",(function(e,n,t){return{conversationId:e,itemId:n,internetMessageId:t}}))},2627:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(2036),i=t(514);function a(){var e,n;return Object(i.w)()?null===(e=Object(r.b)().deeplinkId)||void 0===e?void 0:e.id:null===(n=Object(r.b)().primaryReadingPaneTabId)||void 0===n?void 0:n.Id}},2651:function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return a}));var r=t(2157),i=[r.c.File,r.c.People,r.c.Keywords],a=[r.c.File,r.c.People,r.c.Keywords,r.c.Message,r.c.Event,r.c.Category,r.c.TrySuggestion,r.c.Setting]},2652:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(24);function i(){return Object(r.i)("sea-interactiveFiltersAll")||Object(r.i)("sea-interactiveFiltersUnreadTime")}},2653:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(3032),i=t(3033),a=t(2015);function o(e){return Object(i.a)()||Object(r.a)()||Object(a.e)().isUnread||Object(a.e)().isToMe||Object(a.e)().isFlagged||Object(a.e)().isMentioned||!!(null==e?void 0:e.viewFilter)&&"All"!==(null==e?void 0:e.viewFilter)}},2656:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return o}));var r=t(2),i=Object(r.action)("CONVERSATION_READY_TO_LOAD",(function(e,n){return{conversationId:e,nodeIdCollectionChange:n}})),a=Object(r.action)("UPDATE_ATTACHMENTS"),o=Object(r.action)("UPDATE_ITEM_MANDATORY_PROPERTIES",(function(e,n){return{conversationId:e,nodeIdCollectionWithItemMandatoryPropertiesChanged:n}}))},2750:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("APPLY_CONVERSATION_FLAG_STATE_STORE_UPDATE",(function(e,n,t){return{conversationIds:e,flagType:n,tableViewId:t}}))},2751:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("initializeExtendedCardForItemReadingPane",(function(e,n){return{itemReadingPaneViewState:e,loadedItem:n}}))},2890:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("updateMailtips",(function(e,n,t){return{composeId:e,fromEmailAddress:n,recipients:t}}))},2913:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2),i=Object(r.action)("startAnswersSearchSession",(function(e){return{scenarioId:e}}))},2958:function(e){e.exports=JSON.parse('{"a":"UAa"}')},2983:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("onMailTipRetrieved",(function(e,n){return{composeId:e,fromAddress:n}}))},3003:function(e,n,t){"use strict";var r=t(180),i=t(33),a=t(1);function o(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(a.a)({__type:"GetMailTipsJsonRequest:#Exchange"},t)),Object(i.a)("GetMailTips",e,n)}var c=t(419),u=t(209);function s(e,n){var t,i=Object(c.a)(Object(u.d)(e));return o({Header:Object(r.b)(),Body:(t={MailTipsRequested:1,SendingAs:{EmailAddress:e},Recipients:n.map((function(e){return{EmailAddress:e}}))},Object(a.a)({__type:"GetMailTipsRequest:#Exchange"},t))},i).then((function(e){return(null==e?void 0:e.Body)&&"Success"==e.Body.ResponseClass?e.Body:null})).catch((function(e){return Promise.resolve(null)}))}t.d(n,"a",(function(){return s}))},3007:function(e,n,t){"use strict";var r;!function(e){e.CustomMailTip="CustomMailTip",e.DeliveryRestricted="DeliveryRestricted",e.ExternalMemberCount="ExternalMemberCount",e.GuestMailTipStatus="GuestMailTipStatus",e.IsModerated="IsModerated",e.MailboxFull="MailboxFull",e.MaxMessageSize="MaxMessageSize",e.OutOfOffice="OutOfOffice",e.PreferAccessibleContent="PreferAccessibleContent",e.RecipientAddress="RecipientAddress",e.TotalMemberCount="TotalMemberCount"}(r||(r={}));var i=r,a=t(3099);t.d(n,"a",(function(){return u}));var o=/<!--((.|\n)*?)-->/gi,c=function(e){for(var n=[],t=0;t<e.length;t++)n.push(e[t]);return n};function u(e){if(!e)return null;var n=(new DOMParser).parseFromString(e,"text/xml").firstChild.childNodes;return c(n).reduce((function(e,n){switch(n.localName){case i.RecipientAddress:n.childNodes.length>1&&(e.RecipientAddress=n.childNodes[1].textContent);break;case i.MailboxFull:e.MailboxFull="true"===n.textContent;break;case i.IsModerated:e.IsModerated="true"===n.textContent;break;case i.TotalMemberCount:e.TotalMemberCount=parseInt(n.textContent)||0;break;case i.ExternalMemberCount:e.ExternalMemberCount=parseInt(n.textContent)||0;break;case i.MaxMessageSize:e.MaxMessageSize=parseInt(n.textContent)||0;break;case i.DeliveryRestricted:e.DeliveryRestricted="true"===n.textContent;break;case i.PreferAccessibleContent:e.PreferAccessibleContent="true"===n.textContent;break;case i.OutOfOffice:e.OutOfOffice=s(n);break;case i.CustomMailTip:e.CustomMailTip=b(n);break;case i.GuestMailTipStatus:e.GuestStatus=l(n.textContent)}return e}),{})}var s=function(e){return e.childNodes?b(c(e.childNodes).filter((function(e){return"ReplyBody"===e.localName}))[0]):""},d=function(e){return e.replace(o,"")},l=function(e){var n=e.split(" "),t=a.a.None;return n.map((function(e){t|=a.a[e]})),t};function b(e){var n;if(e){var t=d(e.textContent).replace(/<\/a>/gi,"</a> "),r=(new DOMParser).parseFromString(t,"text/html");if((null===(n=null==r?void 0:r.childNodes)||void 0===n?void 0:n.length)&&r.childNodes[0].textContent)return r.childNodes[0].textContent.replace(/\s\s+/g," ").trim()}return""}},3032:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2015);function i(){return null!==Object(r.e)().fromDate||null!==Object(r.e)().toDate}},3033:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2015);function i(){return Object(r.e)().includeAttachments}},3078:function(e,n,t){"use strict";function r(){return{selectedSearchScope:null,subjectFieldText:"",keywordsFieldText:"",fromDate:null,toDate:null,hasAttachments:null,fromPeopleSuggestions:[],toPeopleSuggestions:[],ccPeopleSuggestions:[]}}t.d(n,"a",(function(){return r}))},3079:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var r=10},3099:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.IsCalculated=1]="IsCalculated",e[e.GuestsEnabled=2]="GuestsEnabled",e[e.GroupHasGuests=4]="GroupHasGuests"}(r||(r={}))},3106:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"ApplyConversationActionRequest:#Exchange"},e)}},3107:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"ConversationAction:#Exchange"},e)}},3148:function(e,n,t){"use strict";function r(e,n){void 0===n&&(n=!1);var t=[];switch(e.type){case 0:t.push("folderId:"+e.folderId);var r=e;t.push("lVT:"+e.listViewType),t.push("vF:"+r.viewFilter),t.push("fVF:"+r.focusedViewFilter),n||(t.push("sC:"+r.sortBy.sortColumn),t.push("sD:"+r.sortBy.sortDirection)),r.categoryName&&t.push("catName:"+r.categoryName),t.push("sT:"+r.scenarioType);break;case 1:t.push("folderId:"+e.folderId);var i=e;t.push("id:"+i.searchNumber),t.push("query:"+i.queryString),t.push("lVT:"+e.listViewType),t.push("sT:"+i.scenarioType);break;case 2:t.push("gId:"+e.folderId);var a=e;t.push("lVT:"+e.listViewType),t.push("vF:"+a.viewFilter)}return t.join(";").toString()}t.d(n,"a",(function(){return r}))},3150:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return a}));var r=t(57);function i(e){return!!(e&Object(r.h)().ViewStateConfiguration.FocusedInboxBitFlags)}function a(e,n){i(n)!==e&&Object(r.z)((function(t){e?t.ViewStateConfiguration.FocusedInboxBitFlags|=n:t.ViewStateConfiguration.FocusedInboxBitFlags&=~n}))}},3223:function(e,n,t){"use strict";var r=t(33),i=t(1);function a(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(i.a)({__type:"ApplyConversationActionJsonRequest:#Exchange"},t)),Object(r.a)("ApplyConversationAction",e,n)}t.d(n,"a",(function(){return a}))},3249:function(e,n,t){"use strict";var r=t(3452);n.a=function(e){var n=function(e){var n;return(null===(n=null==e?void 0:e.Attachments)||void 0===n?void 0:n.length)&&e.Attachments[0]}(e);return Object(r.a)(n)?n:null}},3318:function(e,n,t){"use strict";t.d(n,"b",(function(){return i}));var r=t(2),i=Object(r.createStore)("mruFolderCache",{mruFolders:[],isInitialized:!1}),a=i();n.a=a},3452:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(2121),i=function(e,n){return e.substring(0,n.length)===n},a=function(e,n){return e.substring(e.length-n.length)===n},o=function(e){return e.ContentType&&(i(e.ContentType,r.v)||i(e.ContentType,r.l))},c=function(e){return e.ContentType&&e.ContentType===r.j};function u(e){return(null==e?void 0:e.Name)&&a(e.Name,r.t)&&(o(e)||c(e))}},3455:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("UPDATE_FOLDER_COUNTS",(function(e,n,t,r){return{unreadCount:e,totalCount:n,folderId:t,isDeltaChange:r}}))},3544:function(e,n,t){"use strict";function r(e){var n=e?e.RightsManagementLicenseData:null,t={ReplyAllowed:!0,ReplyAllAllowed:!0,ForwardAllowed:!0,PrintAllowed:!0,CopyAllowed:!0};!n||n.RightsManagedMessageDecryptionStatus&&0!=n.RightsManagedMessageDecryptionStatus||(t={ReplyAllowed:n.ReplyAllowed,ReplyAllAllowed:n.ReplyAllAllowed,ForwardAllowed:n.ForwardAllowed,PrintAllowed:n.PrintAllowed,CopyAllowed:n.ExtractAllowed});var r=e,i=null==r?void 0:r.DoNotForwardMeeting;return t.ForwardAllowed=t.ForwardAllowed&&!i,t}t.d(n,"a",(function(){return r}))},3547:function(e,n,t){"use strict";t.d(n,"b",(function(){return b})),t.d(n,"c",(function(){return m})),t.d(n,"a",(function(){return O}));var r,i=t(24),a=t(3671),o=t(1244),c=t(1947),u=t(3150),s=t(19),d=t(197),l=t(121);function b(){var e=Object(d.a)(),n=e&&Object(i.i)("tri-nudge-consumer"),t=!e&&Object(i.i)("tri-nudge"),a=Object(s.a)().UserOptions.MessageRemindersEnabled;return r||(r=!0,Object(l.s)("Nudge_TenantSetting",{owa_1:a})),a&&(t||n)&&!Object(u.a)(32)}function f(e){return e===Object(o.a)("inbox")||e===Object(o.a)("sentitems")}function v(e,n){if(0!=e.tableQuery.type)return!1;if("All"!=Object(c.R)(e))return!1;var t=Object(c.m)(e);if(0!=t&&-1!=t)return!1;var r=Object(c.L)(e);return 1==r.sortColumn&&r.sortDirection==a.DESCENDING_SORT_DIR}function m(e){var n=c.ab.tableViews.get(e),t=n.tableQuery.folderId;return!!f(t)&&v(n)}function O(e){return!!f(e)&&v(Object(c.J)())}},3587:function(e,n,t){"use strict";var r=t(3007);t.d(n,"a",(function(){return r.a}));var i=t(3003);t.d(n,"b",(function(){return i.a}));var a=t(2890);t.d(n,"d",(function(){return a.a}));var o=t(2983);t.d(n,"c",(function(){return o.a}))},3674:function(e){e.exports=JSON.parse('{"c":"Rzb","b":"Szb","a":"Tzb","f":"Uzb","e":"Vzb","d":"Wzb"}')},3979:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(2239),i=t(979),a=t(2421);function o(e,n){var t;return Object(a.a)({Path:Object(i.a)({FieldURI:e}),Item:Object(r.a)((t={},t[e]=n,t))})}},3986:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return o}));var r=t(31),i=new r.c((function(){return Promise.all([t.e(41),t.e(619)]).then(t.bind(null,5759))})),a=new r.a(i,(function(e){return e.emptyFolder})),o=new r.a(i,(function(e){return e.emptyFolderWithoutConfirmation}))},419:function(e,n,t){"use strict";var r=t(1);function i(e,n){return e?Object(r.a)({mailboxInfo:e},n):null!=n?n:void 0}t.d(n,"a",(function(){return i}))},4350:function(e,n,t){"use strict";var r=t(31),i=t(33);function a(){return Object(i.a)("GetFolderMruConfiguration",{},e).then((function(e){return e}));var e}var o=t(3318),c=t(1244),u=t(183),s=Object(u.action)("getMoveToMruList")((function(){o.a.isInitialized||a().then((function(e){return function(e){if(null==e.FolderMruEntries||0==e.FolderMruEntries.length)o.a.mruFolders.push(Object(c.a)("inbox")),o.a.mruFolders.push(Object(c.a)("deleteditems")),o.a.mruFolders.push(Object(c.a)("archive"));else for(var n=0;n<e.FolderMruEntries.length;n++){var t=e.FolderMruEntries[n].EwsFolderIdEntry;o.a.mruFolders.push(t)}o.a.isInitialized=!0}(e)}))}));t.d(n,"b",(function(){return l})),t.d(n,"c",(function(){return b})),t.d(n,"a",(function(){return s}));var d=new r.c((function(){return t.e(948).then(t.bind(null,18370))})),l=new r.a(d,(function(e){return e.addFolderIdToMoveToMruList})),b=new r.a(d,(function(e){return e.removeFolderIdFromMoveToMruList}))},4380:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"MoveItemRequest:#Exchange"},e)}},4390:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(4555),i=t(3544),a=t(4556);function o(e,n){var t=Object(i.a)(e),o=Object(a.a)(e,n),c=Object(r.c)(e);return[!t.ReplyAllowed||c||o,!t.ReplyAllAllowed||c||o,!t.ForwardAllowed||o]}},4469:function(e,n,t){"use strict";var r=t(5194),i=t(2),a={sweepDestinationFolderId:null,isSweepDialogShown:!1,sweepOptionType:r.a.All,sweepRequestStatus:0};n.a=Object(i.createStore)("sweepStore",a)()},4516:function(e,n,t){"use strict";var r=t(33),i=t(1);function a(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(i.a)({__type:"MoveItemJsonRequest:#Exchange"},t)),Object(r.a)("MoveItem",e,n)}t.d(n,"a",(function(){return a}))},4555:function(e,n,t){"use strict";t.d(n,"c",(function(){return o})),t.d(n,"b",(function(){return c})),t.d(n,"a",(function(){return u}));var r="report",i="report.ipm.note.ndr",a="report.ipm.note.dr";function o(e){return!!e&&(e.ItemClass&&0==e.ItemClass.toLowerCase().indexOf(r))}function c(e){return!!e&&(e.ItemClass&&0==e.ItemClass.toLowerCase().indexOf(i))}function u(e){return!!e&&(e.ItemClass&&0==e.ItemClass.toLowerCase().indexOf(a))}},4556:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(3249),i=t(2223);function a(e,n){return Object(i.a)(e)&&n&&!!Object(r.a)(e)}},5129:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(33);function i(e){return Object(r.a)("GetMailboxJunkEmailConfiguration",{},e)}},518:function(e,n,t){"use strict";var r=function(){function e(e,n,t){this.maxParallelTasks=e,this.taskCallback=n,this.taskDelay=t,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var n=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(n).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();t.d(n,"a",(function(){return r}))},5194:function(e,n,t){"use strict";var r;!function(e){e[e.All=0]="All",e[e.AllCurrentAndFuture=1]="AllCurrentAndFuture",e[e.AllButOne=2]="AllButOne",e[e.AllOlderThan=3]="AllOlderThan"}(r||(r={})),n.a=r},520:function(e,n,t){"use strict";function r(e,n){var t=Math.pow(2,32);if(e>=t||n>=t){var r=e%t,i=n%t;return(((e-=r)/t&(n-=i)/t)>>>0)*t+((r&i)>>>0)}return(e&n)>>>0}t.d(n,"a",(function(){return r}))},5640:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(23),i=t(19);function a(e){var n=Object(i.a)().SessionSettings,t=n.UserEmailAddress;return t?!e||(e.toLowerCase()==t.toLowerCase()||n.UserProxyAddresses&&n.UserProxyAddresses.some((function(n){return n.toLowerCase()==e}))):(r.d("User email address from session data is null."),!1)}},5882:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2),i=Object(r.action)("DISMISS_NUDGE",(function(e,n,t,r){return{rowKey:e,tableViewId:n,actionSource:t,itemOrConversationId:r}}))},5943:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return u}));var r,i=t(94),a=t(5),o=t(137),c=t(19);function u(e){var n,t,u,s,d,l=Object(c.a)().UserOptions,b=l.WorkingHours.WorkDays,f=Object(a.Rb)();switch(e){case r.today:n=t=Object(a.ub)(f),d="Flagged";break;case r.tomorrow:n=t=Object(a.ub)(Object(a.e)(Object(a.Yb)(f),1)),d="Flagged";break;case r.thisWeek:s=function(e,n){var t=7-Object(a.ob)(n),r=2;0<t&&t<=2&&(r=t-1);var i=Object(a.e)(Object(a.Yb)(n),r),c=Object(o.i)(e);for(;n<i&&!c.includes(Object(a.ob)(i));)i=Object(a.e)(Object(a.Yb)(i),-1);var u=Object(a.e)(Object(a.Yb)(n),t-1);for(;i<u&&!c.includes(Object(a.ob)(u));)u=Object(a.e)(Object(a.Yb)(u),-1);return[Object(a.ub)(i),Object(a.ub)(u)]}(b,f),t=s[0],n=s[1],d="Flagged";break;case r.nextWeek:s=function(e,n,t){for(var r=Object(a.e)(t,7),i=Object(a.cc)(r,e),c=Object(o.i)(n),u=0;u<7&&!c.includes(Object(a.ob)(i));++u)i=Object(a.e)(Object(a.Yb)(i),1);var s=Object(a.C)(r,e);for(;i<s&&!c.includes(Object(a.ob)(s));)s=Object(a.e)(Object(a.Yb)(s),-1);return[Object(a.ub)(i),Object(a.ub)(s)]}(l.WeekStartDay,b,f),t=s[0],n=s[1],d="Flagged";break;case r.noDate:d="Flagged";break;case r.complete:u=Object(a.ub)(f),d="Complete";break;case r.clear:d="NotFlagged";break;default:Object(i.a)(e)}return{FlagStatus:d,StartDate:t,DueDate:n,CompleteDate:u}}!function(e){e[e.today=0]="today",e[e.tomorrow=1]="tomorrow",e[e.thisWeek=2]="thisWeek",e[e.nextWeek=3]="nextWeek",e[e.noDate=4]="noDate",e[e.complete=5]="complete",e[e.clear=6]="clear"}(r||(r={}))},6044:function(e){e.exports=JSON.parse('{"a":"sOa"}')},6045:function(e){e.exports=JSON.parse('{"a":"tOa"}')},618:function(e,n,t){"use strict";t.d(n,"g",(function(){return o})),t.d(n,"f",(function(){return c})),t.d(n,"k",(function(){return u})),t.d(n,"c",(function(){return s})),t.d(n,"d",(function(){return d})),t.d(n,"n",(function(){return l})),t.d(n,"l",(function(){return b})),t.d(n,"m",(function(){return f})),t.d(n,"a",(function(){return v})),t.d(n,"h",(function(){return m})),t.d(n,"b",(function(){return O})),t.d(n,"e",(function(){return j})),t.d(n,"j",(function(){return k})),t.d(n,"i",(function(){return p})),t.d(n,"o",(function(){return h}));var r=t(85),i=t(64),a=t(5);function o(e,n){return void 0===n&&(n=Object(a.Rb)()),s(Object(a.cc)(n,e),r.a.DaysInOneWeek)}function c(e,n){var t=u(e,n),r=Object(a.B)(e),i=Object(a.e)(Object(a.C)(r,n),1);return s(t,Math.abs(Object(a.s)(t,i)-1))}function u(e,n){var t=Object(a.bc)(e);return Object(a.cc)(t,n)}function s(e,n){return{start:e,end:Object(a.e)(e,n-1)}}function d(e,n,t,r,c){switch(void 0===c&&(c=1),e){case i.b.Day:return s(Object(a.Yb)(n),c);case i.b.Month:var u=Object(a.bc)(n),d=Object(a.B)(n);return s(u,Math.abs(Object(a.s)(u,d)-1));case i.b.Week:return o(t,n);case i.b.WorkWeek:return function(e,n,t){void 0===t&&(t=Object(a.Rb)());for(var r,i,c=o(e,t),u=0;u<=k(c);u++){var s=Object(a.e)(c.start,u);if(!r&&n.includes(Object(a.ob)(s))&&(r=s),s=Object(a.e)(c.end,-u),!i&&n.includes(Object(a.ob)(s))&&(i=s),r&&i)break}return{start:r,end:i}}(t,r,n)}}function l(e,n){var t=c(e,n);return Object(a.t)(t.end,t.start,n)}function b(e,n){var t;return s(t=n==i.b.WorkWeek?Object(a.k)(e.start,1):Object(a.e)(e.end,1),n==i.b.Month?Object(a.pb)(t):Object(a.s)(e.end,e.start)+1)}function f(e,n){var t,r;if(n==i.b.WorkWeek)t=Object(a.k)(e.start,-1),r=Object(a.k)(e.end,-1);else{r=Object(a.e)(e.start,-1);var o=n==i.b.Month?-Object(a.pb)(r):Object(a.s)(e.start,e.end)-1;t=Object(a.e)(e.start,o)}return{start:t,end:r}}function v(e,n){return e&&n&&0==Object(a.p)(e.start,n.start)&&0==Object(a.p)(e.end,n.end)}function m(e,n,t){if(!e||!n)throw new Error("Date ranges cannot be null in call to areDateRangesOverlapping");return t?Object(a.p)(e.start,n.start)<=0?Object(a.p)(e.end,n.start)>=0?0:1:Object(a.p)(n.end,e.start)>=0?0:-1:Object(a.p)(e.start,n.start)<0?Object(a.p)(e.end,n.start)>0?0:1:Object(a.p)(n.end,e.start)>0?0:-1}function O(e,n,t){return!(!e||!n)&&(t?Object(a.p)(e.start,n.start)<=0&&Object(a.p)(e.end,n.end)>=0:Object(a.p)(e.start,n.start)<0&&Object(a.p)(e.end,n.end)>0)}function j(e,n){return e&&n?{start:Object(a.p)(e.start,n.start)<0?e.start:n.start,end:Object(a.p)(e.end,n.end)>0?e.end:n.end}:null}function k(e){return Object(a.s)(e.end,e.start)}function p(e){return Math.floor(Object(a.v)(e.end,e.start)/24)+(Object(a.v)(e.end,e.start)%24>0?1:0)}function h(e,n){return Object(a.s)(e.start,n)<=0&&Object(a.s)(e.end,n)>=0}},6321:function(e,n,t){"use strict";t.r(n);var r=t(44),i=t(2),a=Object(i.action)("ADD_MAILBOX_TO_SAFE_SENDERS",(function(e,n,t){return Object(r.c)({name:"TnS_AddToSafeSenders",customData:[t],cosmosOnlyData:JSON.stringify({itemId:n}),actionSource:"ReadingPane"},{mailbox:e,itemId:n,actionSource:t})})),o=Object(i.action)("ADD_MAILBOX_TO_TRUSTED_SENDERS_LIST",(function(e,n){return{mailbox:e,junkEmailConfiguration:n}})),c=t(7408),u=t(8597),s=t(3204),d=t(4468),l=t(11534),b=t(2292),f=t(1947),v=t(2133),m=t(3778),O=t(2028),j=Object(r.d)("RestoreItem",s.a.restoreItems)((function(e,n){var t=v.a.tableViews.get(n),r=t.tableQuery.folderId,i=Object(f.E)(e,n),a=Object(d.a)(i);return Object(b.a)(a,r,"Restore"),Object(l.a)(i).then((function(e){return Object(O.a)(e)})).catch((function(e){return Object(m.b)(t),Promise.reject(e)}))}));function k(e,n,t){switch(v.a.tableViews.get(n).tableQuery.listViewType){case 0:Object(u.a)(e,n);break;case 1:j(e,n)}}var p=t(6617),h=Object(i.action)("DELETE_ITEMS_BASED_ON_NODE_OR_THREAD_IDS",(function(e,n,t){return{nodeIds:e,tableViewId:n,actionSource:t}})),y=Object(i.action)("SCHEDULE_ROWS",(function(e,n,t,r){return{rowKeys:e,tableViewId:n,actionSource:t,scheduleReturnTime:r}})),g=t(5943),I=t(1),S=t(6),w=t(1956),N=t(14075);function T(e,n){"Flagged"===e?w.s.importAndExecute(n?Object(S.b)(N.a):Object(S.b)(N.c)):"NotFlagged"===e&&w.s.importAndExecute(n?Object(S.b)(N.b):Object(S.b)(N.d))}var C=t(2638);function A(e,n,t,r){var i;switch(e.FlagStatus){case"Flagged":i="Flag";break;case"NotFlagged":i="FlagCleared";break;case"Complete":i="FlagComplete"}Object(C.d)(i,n,{rowKeys:t})}var x=t(2750);var R=t(183),F=Object(R.action)("ApplyConversationFlagInListViewStore")((function(e,n,t,r){if(void 0===r&&(r={tableViews:f.ab.tableViews}),!n||!n.FlagStatus)throw new Error("Invalid flag type.");var i=r.tableViews.get(t),a=Object(f.z)(n,e,i);!function(e,n,t,r,i){void 0===i&&(i={tableViewConversationRelations:f.ab.tableViewConversationRelations,tableViews:f.ab.tableViews}),e.forEach((function(e){i.tableViews.forEach((function(i){i.serverFolderId==n&&Object(f.G)([e],i).forEach((function(e){var n=Object(f.N)(e,i.id);n&&n.itemIds.forEach((function(e){t.indexOf(e)>-1&&r(n,e)}))}))}))}))}(Object(f.E)(e,i.id),i.serverFolderId,a,(function(e,t){e.flagStatus=n.FlagStatus}))})),E=t(2013),M=t(5639),V=t(3106),D=t(3107),P=t(613),_=t(439),L=t(984),B=t(8186);function U(e,n,t){var r=e.map((function(e){return function(e,n,t){var r=Object(D.a)({Action:"Flag",ConversationId:Object(_.a)({Id:e.conversationId}),Flag:n,ConversationLastSyncTime:Object(M.a)(e.conversationLastSyncTimeStamp)});if(t){var i=Object(L.a)({BaseFolderId:Object(P.a)({Id:t})});r.ContextFolderId=i}return r}(e,n,t)}));return Object(V.a)({ConversationActions:r})}var J=t(3979),W=t(2389),H=t(2539),K=t(2532),q=t(180);function Q(e,n,t){var r=function(e,n){var t=Object(J.a)("Flag",n),r=[];return e.forEach((function(e){return r.push(Object(W.a)({Updates:[t],ItemId:Object(_.a)({Id:e})}))})),Object(H.a)({ItemChanges:r,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly"})}(e,n);return Object(K.a)({Header:Object(q.b)(),Body:r},t).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var z=t(2267),G=t(419),Y=Object(r.d)("setConversationsFlagState",s.a.setConversationsFlagState)((function(e,n,t,r,i){return Object(I.c)(this,void 0,void 0,(function(){var i,a;return Object(I.f)(this,(function(o){switch(o.label){case 0:return[4,z.b()];case 1:return o.sent(),i=v.a.tableViews.get(t),A(r,n,e),a=Object(f.E)(e,t),F(e,r,t),Object(x.a)(a,r,t),Object(f.e)(i)?[2,Z(i,r,e)]:[2,X(i,r,e)]}}))}))}));function Z(e,n,t){var r=Object(G.a)(Object(E.b)(e));return Q(Object(f.z)(n,t,e),n,r).then((function(e){return Object(O.a)(e)})).catch((function(e){return Promise.reject(e)}))}function X(e,n,t){var r=Object(f.l)(e),i=function(e,n,t){var r=U(e,n,t);return Object(B.a)(r)}(t.map((function(n){return Object(f.i)(n,e.id)})),n,r);return Object(m.c)(i,t,r,e,!1)}var $=t(1955),ee=t(2559),ne=t(2681),te=Object(i.action)("FLAG_ITEMS_STORE_UPDATE",(function(e,n,t){return{itemIds:e,flagTypeToSet:n,parentFolderId:t}}));Object(i.mutator)(te,(function(e){var n,t,r,i;e.itemIds.forEach((function(n){var t=$.a.items.get(n);t&&(t.Flag={FlagStatus:e.flagTypeToSet.FlagStatus})}));var a=Object(ne.a)(e.parentFolderId,!0);try{for(var o=Object(I.k)(a),c=o.next();!c.done;c=o.next()){var u=c.value;if(Object(f.S)(u))try{for(var s=(r=void 0,Object(I.k)(e.itemIds)),d=s.next();!d.done;d=s.next()){re(d.value,u,e.flagTypeToSet.FlagStatus)}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(t=o.return)&&t.call(o)}finally{if(n)throw n.error}}}));function re(e,n,t){var r,i,a=Object(w.v)(e),o=Object(f.G)([a.ConversationId.Id],n);try{for(var c=Object(I.k)(o),u=c.next();!u.done;u=c.next()){var s=u.value;Object(ee.a)(s,n.id).flagStatus=t}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}var ie=Object(r.d)("setItemsFlagState",s.a.setItemsFlagState)((function(e,n,t,r,i){return Object(I.c)(this,void 0,void 0,(function(){var i,a,o;return Object(I.f)(this,(function(c){switch(c.label){case 0:return i=Object(f.M)().tableViews.get(r),a=[],i&&(a=Object(f.G)(e,i)),[4,z.b()];case 1:return c.sent(),A(t,n,a),te(e,t,i&&i.tableQuery.folderId),o=Object(G.a)(Object(E.b)(i)),[2,Q(e,t,o)]}}))}))}));function ae(e,n,t,r,i){return Object(I.c)(this,void 0,void 0,(function(){var a;return Object(I.f)(this,(function(o){switch(o.label){case 0:return(a=e.filter((function(e){return!!Object(w.v)(e)}))).length>0?[4,ie(a,n,t,r,i)]:[3,2];case 1:o.sent(),T(t.FlagStatus,!1),o.label=2;case 2:return[2]}}))}))}var oe=t(2624);function ce(e,n,t,r,i){var a=v.a.tableViews.get(n),o=Object(oe.a)(e,a);switch(a.tableQuery.listViewType){case 0:!function(e,n,t,r,i,a,o){var c=[];c=o?e:a(e,t,r),c.length>0&&(Y(c,n,t,r,i),T(r.FlagStatus,!0))}(e,o,n,t,r,ue,i);break;case 1:!function(e,n,t,r,i,a,o){Object(I.c)(this,void 0,void 0,(function(){var c,u,s;return Object(I.f)(this,(function(d){switch(d.label){case 0:return c=[],o?c=e:(u=a(e,t,r),c=u),c.length>0?(s=Object(f.E)(c,t),[4,ie(s,n,r,t,i)]):[3,2];case 1:d.sent(),T(r.FlagStatus,!1),d.label=2;case 2:return[2]}}))}))}(e,o,n,t,r,ue,i)}}function ue(e,n,t){var r=Object(f.M)().tableViews.get(n);return e.filter((function(e){return f.b.getFlagStatus(e,r)!=t.FlagStatus}))}var se=t(57);var de=Object(R.action)("toggleRowsFlagState")((function(e,n,t){ce(e,n,function(e,n){for(var t,r=0;r<e.length;r++){switch(f.b.getFlagStatus(e[r],n)){case"Flagged":t=Object(se.s)()?Object(g.b)(g.a.clear):Object(g.b)(g.a.complete);break;case"Complete":case"NotFlagged":default:t=Object(g.b)(g.a.noDate)}}return t}(e,f.ab.tableViews.get(n)),t)})),le=function(e,n){return e&&"SharedMailbox"===e.mailboxInfo.type||n&&"SharedMailbox"===n.mailboxInfo.type?1:0},be=t(8181),fe=t(121),ve=t(1951),me=t(2867),Oe=t(4350),je=t(2252),ke=t(2096);function pe(e,n,t,r,i,a){return void 0===a&&(a={sourceFolder:ve.d.folderTable.get(t.tableQuery.folderId),destinationFolder:ve.d.folderTable.get(n)}),Object(I.c)(this,void 0,void 0,(function(){var o,c,u,s,d,l,b,v,m=this;return Object(I.f)(this,(function(O){switch(O.label){case 0:return o=a.sourceFolder,c=a.destinationFolder,u=le(o,c),s=t.tableQuery.folderId,d=Object(fe.u)(),Object(be.a)(s,n)?(d&&d.endWithError("UserError",new Error("Action not supported for shadow mailbox")),[2,Promise.resolve()]):[4,z.b()];case 1:if(O.sent(),l=e.filter((function(e){return t.rowKeys.indexOf(e)>=0&&n!=f.b.getParentFolderId(e,t)})),b=[],1==t.tableQuery.type&&l.forEach((function(e){var n=f.b.getInstrumentationContext(e,t);n&&b.push(n)})),Object(C.d)("Move",b),0==l.length)return d&&d.endWithError("UserError",new Error("no conversations to move")),[2,Promise.resolve()];switch(u){case 1:if(!Object(me.h)(Object(je.g)(t),n))return Object(me.j)(n),[2,Promise.resolve()];switch(t.tableQuery.listViewType){case 0:Object(I.c)(m,void 0,void 0,(function(){return Object(I.f)(this,(function(e){switch(e.label){case 0:return[4,ke.y.import()];case 1:return e.sent()(l,n,t),[2]}}))}));break;case 1:Object(I.c)(m,void 0,void 0,(function(){return Object(I.f)(this,(function(e){switch(e.label){case 0:return[4,ke.z.import()];case 1:return e.sent()(l,t.id,n,s),[2]}}))}))}break;case 0:default:Oe.b.importAndExecute(n),v=r(l,n,t,i,d)}return[2,v]}}))}))}var he=t(9517),ye=t(4614),ge=t(2090),Ie=t(1081),Se=t(19),we=t(1964),Ne=t(14076);function Te(e,n,t){if(Object(Se.a)().UserOptions.ShowNotificationBar){var r=Object(ve.i)(ve.d.folderTable.get(n)),i="archive"===Object(we.a)(n);if("deleteditems"===Object(we.a)(n))Object(he.a)(e,t);else{var a;a=i?1===e?Object(S.b)(Ne.a):Object(S.c)(Object(S.b)(Ne.b),e):1===e?Object(S.c)(Object(S.b)(Ne.c),r):Object(S.c)(Object(S.b)(Ne.d),e,r);var o=Object(ge.j)();Ie.e.importAndExecute("moveOrArchiveNotification","MailModuleNotificationBarHost",a,{icon:i?"Archive":"FabricMovetoFolder",primaryActionText:t?Object(S.b)(ye.a):null,allowClear:!0,minWidth:o.minWidth,maxWidth:o.maxWidth,notificationCallback:function(e){e===Ie.a.PrimaryActionClicked&&z.f.importAndExecute("NotificationBar")}})}}}var Ce=t(3455);function Ae(e,n){var t=e.filter((function(e){return!e.isRead})).length,r=e.length;Object(Ce.a)(t,r,n,!0)}function xe(e,n,t){var r=0,i=0;e.forEach((function(e){var t=Object(f.N)(e,n.id);r+=t.unreadCount,i+=t.itemIds.length})),Object(Ce.a)(r,i,t,!0)}function Re(e){var n=ve.d.folderTable.get(e);return Object(w.j)(e)||Object(w.p)(n)}var Fe=t(8183),Ee=t(1250),Me=t(2392),Ve={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MoveConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"destinationFolderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"moveConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"destinationFolderId"},value:{kind:"Variable",name:{kind:"Name",value:"destinationFolderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}},{kind:"Field",name:{kind:"Name",value:"undoRequestId"}}]}}]}}]},De={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UndoMoveConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"destinationFolderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"undoMoveConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}},{kind:"ObjectField",name:{kind:"Name",value:"destinationFolderId"},value:{kind:"Variable",name:{kind:"Name",value:"destinationFolderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},Pe=Object(r.d)("moveConversations",s.a.moveConversation)((function(e,n,t,r){return pe(e,n,t,_e,r)}));function _e(e,n,t,r,i){var a=this,o="category"!==t.tableQuery.scenarioType?t.tableQuery.folderId:null,c=e.map((function(e){return Object(f.i)(e,t.id)})),u=Object(f.E)(e,t.id),s=Object(z.d)(o,Object(E.b)(t));Object(w.m)(n)&&xe(e,t,n),Object(Fe.a)(t.tableQuery,Re(n))&&Object(Me.a)(u,t,"Move");var d=Le.invokeMoveConversationMutation(c,n,o);return s&&z.a((function(){return Object(I.c)(a,void 0,void 0,(function(){var e;return Object(I.f)(this,(function(t){switch(t.label){case 0:return[4,d];case 1:return(e=t.sent()).success?[4,Le.invokeUndoMoveConversationMutation(c,o,n,e.undoRequestId)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2,Promise.resolve()]}}))}))}),t.serverFolderId,d),Te(c.length,n,s),i.markUserPerceivedTime(),Object(m.c)(d,e,o,t,!0,!0)}var Le={invokeMoveConversationMutation:function(e,n,t){var r;return Object(I.c)(this,void 0,void 0,(function(){var i,a;return Object(I.f)(this,(function(o){switch(o.label){case 0:return i=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(M.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(Ee.a)()];case 1:return[4,o.sent().mutate({variables:{conversations:i,folderId:t,destinationFolderId:n},mutation:Ve})];case 2:return a=o.sent(),[2,null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.moveConversation]}}))}))},invokeUndoMoveConversationMutation:function(e,n,t,r){var i;return Object(I.c)(this,void 0,void 0,(function(){var a,o;return Object(I.f)(this,(function(c){switch(c.label){case 0:return a=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(M.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(Ee.a)()];case 1:return[4,c.sent().mutate({variables:{conversations:a,folderId:t,destinationFolderId:n,undoRequestId:r},mutation:De})];case 2:return o=c.sent(),[2,null===(i=null==o?void 0:o.data)||void 0===i?void 0:i.undoMoveConversation]}}))}))}},Be=t(7410),Ue=t(8182),Je=t(4380),We=t(4516),He=t(2088);function Ke(e,n,t){var r=function(e,n){return Object(Je.a)({ToFolderId:Object(Be.a)(n),ItemIds:Object(Ue.a)(e),ReturnNewItemIds:!0})}(e,n);return Object(We.a)({Header:Object(q.b)(),Body:r},Object(G.a)(Object(He.b)(n))).then((function(e){return e.Body}))}var qe=t(9518),Qe=Object(r.d)("moveItemsFromItemIds",s.a.moveItems)((function(e,n,t,r){return Object(I.c)(this,void 0,void 0,(function(){var r,i,a,o,c,u,s=this;return Object(I.f)(this,(function(l){switch(l.label){case 0:return r="category"!==t.tableQuery.scenarioType?t.tableQuery.folderId:null,i=Object(z.d)(r,Object(E.b)(t)),a=Object(fe.u)(),Object(be.a)(r,n)?(a.endWithError("UserError",new Error("Action not supported for shadow mailbox")),[2,Promise.resolve()]):(o=Object(f.G)(e,t),[4,z.b()]);case 1:return l.sent(),c=Object(d.a)(e),Object(qe.a)(n)&&Ae(c,n),Object(Fe.a)(t.tableQuery,Re(n))&&Object(b.a)(c,r,"Move"),u=Ke(e,n),i&&z.a((function(){return Object(I.c)(s,void 0,void 0,(function(){var e,n,t,i,a,o,c,s;return Object(I.f)(this,(function(d){switch(d.label){case 0:return[4,u];case 1:if((e=d.sent()).ResponseMessages){n=e.ResponseMessages.Items,t=[];try{for(i=Object(I.k)(n),a=i.next();!a.done;a=i.next())"Success"==(o=a.value).ResponseClass&&t.push(o.Items[0].ItemId.Id)}catch(e){c={error:e}}finally{try{a&&!a.done&&(s=i.return)&&s.call(i)}finally{if(c)throw c.error}}if(t.length>0)return[2,Ke(t,r)]}return[2,Promise.resolve()]}}))}))}),t.serverFolderId),Te(e.length,n,i),a.markUserPerceivedTime(),[2,Object(m.d)(u,o,r,t,!0)]}}))}))}));function ze(e,n,t,r){return pe(e,n,t,Ge,r)}function Ge(e,n,t,r){var i=Object(f.E)(e,t.id);return Qe(i,n,t,r)}function Ye(e,n,t,r){var i=f.ab.tableViews.get(t);return(0==i.tableQuery.listViewType?Pe:ze)(e,n,i,r)}var Ze=t(14077),Xe=t(6801);function $e(e,n,t){var r=Object(L.a)({BaseFolderId:Object(P.a)({Id:n})}),i=null==t?null:Object(L.a)({BaseFolderId:Object(P.a)({Id:t})}),a=e.map((function(e){return function(e,n,t){return Object(D.a)({Action:"Copy",ConversationId:Object(_.a)({Id:e.conversationId}),ContextFolderId:n,DestinationFolderId:t,ConversationLastSyncTime:Object(M.a)(e.conversationLastSyncTimeStamp)})}(e,i,r)}));return Object(V.a)({ConversationActions:a,ReturnMovedItemIds:!0})}function en(e,n,t){var r=$e(e,n,t);return Object(B.a)(r)}var nn=Object(r.d)("copyMailListRows",s.a.copyMailListRows)((function(e,n,t,r,i){switch(n.tableQuery.listViewType){case 0:var a=en(e.map((function(e){return Object(f.i)(e,n.id)})),t,r);return tn(e.length),Object(m.c)(a,e,r,n,!1);case 1:var o=Object(f.E)(e,n.id),c=Object(Xe.a)(o,Object(Be.a)(t),!1,Object(G.a)(Object(E.b)(n)));return tn(e.length),Object(m.d)(c,e,r,n,!1);default:return Promise.reject(new Error("ListViewType not support: "+n.tableQuery.listViewType))}}));function tn(e){var n=1===e?Object(S.b)(Ze.a):Object(S.c)(Object(S.b)(Ze.b),e),t=Object(ge.j)();Ie.e.importAndExecute("copyNotification","MailModuleNotificationBarHost",n,{icon:"Copy",minWidth:t.minWidth,maxWidth:t.maxWidth})}var rn=Object(i.action)("MOVE_ITEMS_BASED_ON_NODE_IDS",(function(e,n,t,r){return{nodeIds:e,destinationFolderId:n,tableViewId:t,actionSource:r}})),an=Object(r.d)("archiveMailListRowsFromTable",s.a.archiveMailListRows)((function(e,n,t,r){return void 0===r&&(r={archiveFolderId:Object(Se.a)().UserOptions.ArchiveFolderId}),Object(I.c)(this,void 0,void 0,(function(){return Object(I.f)(this,(function(t){switch(t.label){case 0:return r.archiveFolderId?[4,Ye(e,r.archiveFolderId,n.id)]:[3,2];case 1:return t.sent(),[3,3];case 2:throw new Error("Archive folder id should always be set");case 3:return[2]}}))}))})),on=t(3313),cn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"PinConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemIds"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shouldPin"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pinConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}},{kind:"ObjectField",name:{kind:"Name",value:"itemIds"},value:{kind:"Variable",name:{kind:"Name",value:"itemIds"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"shouldPin"},value:{kind:"Variable",name:{kind:"Name",value:"shouldPin"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},un={invokePinConversationMutation:function(e,n,t,r,i){var a;return Object(I.c)(this,void 0,void 0,(function(){var o,c;return Object(I.f)(this,(function(u){switch(u.label){case 0:return o=e.map((function(e){return{id:e}})),[4,Object(Ee.a)()];case 1:return[4,u.sent().mutate({variables:{conversations:o,itemIds:n,mailboxInfo:t,shouldPin:r,folderId:i},mutation:cn})];case 2:return c=u.sent(),[2,null===(a=null==c?void 0:c.data)||void 0===a?void 0:a.pinConversation]}}))}))}};function sn(e,n){return e&&Object(f.y)(e)!=n}var dn=Object(r.d)("pinConversations",s.a.pinConversations)((function(e,n,t,r){return Object(I.c)(this,void 0,void 0,(function(){var r,i,a,o,c,u;return Object(I.f)(this,(function(s){switch(s.label){case 0:return[4,z.b()];case 1:return s.sent(),r=Object(f.h)(e,n.id,sn,t),i=f.b.getConversationId(null==r?void 0:r[0],n),0==(a=function(e,n,t){for(var r={},i=0;i<e.length;i++){var a=Object(f.N)(e[i],n);if(t){var o=a.itemIds[0];r[o]||(r[o]=!0)}else a.itemIds.forEach((function(e){r[e]||(r[e]=!0)}))}return Object.keys(r)}(r,n.id,t)).length?[2,Promise.resolve()]:(f.ab.lastIndexToRender+=a.length,Object(on.a)(r,n.id,t),o=Object(oe.a)(e,n),c={itemIds:a,conversationIds:[i]},Object(C.d)(t?"Pin":"Unpin",o,c),u=Object(E.b)(n),[2,un.invokePinConversationMutation([i],a,u,t,n.tableQuery.folderId)])}}))}))})),ln=t(3314),bn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"PinItem"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shouldPin"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pinItem"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"shouldPin"},value:{kind:"Variable",name:{kind:"Name",value:"shouldPin"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},fn={invokePinItemMutation:function(e,n,t){var r;return Object(I.c)(this,void 0,void 0,(function(){var i;return Object(I.f)(this,(function(a){switch(a.label){case 0:return[4,Object(Ee.a)()];case 1:return[4,a.sent().mutate({variables:{ids:e,mailboxInfo:n,shouldPin:t},mutation:bn})];case 2:return i=a.sent(),[2,null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.pinItem]}}))}))}},vn=Object(r.d)("pinItems",s.a.pinItems)((function(e,n,t,r){return Object(I.c)(this,void 0,void 0,(function(){var r,i,a,o,c;return Object(I.f)(this,(function(u){switch(u.label){case 0:return[4,z.b()];case 1:return u.sent(),r=function(e,n,t){var r=[];return e.forEach((function(e){(f.b.getIsPinned(e,n)&&!t||!f.b.getIsPinned(e,n)&&t)&&r.push(e)})),r}(e,n,t),0==(i=Object(f.E)(r,n.id)).length?[2,Promise.resolve()]:(f.ab.lastIndexToRender+=i.length,Object(ln.a)(r,n.id,t),t&&(a=Object(oe.a)(e,n),o={rowKeys:r},Object(C.d)("Pin",a,o)),c=Object(E.b)(n),[2,fn.invokePinItemMutation(i,c,t)])}}))}))}));function mn(e,n,t){var r=f.ab.tableViews.get(n),i=f.b.getIsPinned(e,r);switch(r.tableQuery.listViewType){case 0:dn([e],r,!i,t);break;case 1:vn([e],r,!i,t)}}function On(e,n,t,r){var i=f.ab.tableViews.get(n);switch(i.tableQuery.listViewType){case 0:dn(e,i,t,r);break;case 1:vn(e,i,t,r)}}var jn=t(7409),kn=t(14078),pn=t(731);function hn(e){return Object(I.c)(this,void 0,void 0,(function(){return Object(I.f)(this,(function(n){switch(n.label){case 0:return[4,z.b()];case 1:return n.sent(),Object(Se.a)().SegmentationSettings.ReportJunkEmailEnabled?[2,Object(pn.b)(Object(S.b)(kn.a),Object(S.b)(kn.b),!1,{okText:Object(S.b)(jn.f),cancelText:Object(S.b)(jn.e),delayCallbackAfterAnimation:!0}).then((function(n){n===pn.a.ok&&e()}))]:(e(),[2,Promise.resolve()])}}))}))}function yn(e,n){return e.filter((function(e){return n.rowKeys.indexOf(e)>=0}))}var gn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkItemAsPhishing"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markItemAsPhishing"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},In=Object(r.d)("markItemsAsPhishing",s.a.markItemsAsPhishing)((function(e,n,t,r){if(Object(Se.a)().SegmentationSettings.ReportJunkEmailEnabled)try{Sn.invokeMarkItemAsPhishingMutation(e,Object(E.b)(n))}catch(e){}return r(),Promise.resolve()})),Sn={invokeMarkItemAsPhishingMutation:function(e,n){var t;return Object(I.c)(this,void 0,void 0,(function(){var r;return Object(I.f)(this,(function(i){switch(i.label){case 0:return[4,Object(Ee.a)()];case 1:return[4,i.sent().mutate({variables:{ids:e,mailboxInfo:n},mutation:gn})];case 2:return r=i.sent(),[2,null===(t=null==r?void 0:r.data)||void 0===t?void 0:t.markItemAsPhishing]}}))}))}},wn=t(4920);function Nn(e,n,t){hn((function(){!function(e,n,t){var r=yn(e,n);if(0==r.length)return;var i=Object(oe.a)(e,n),a=Object(f.E)(r,n.id),o=Object(wn.a)(r,n.id);In(o,n,t,(function(){Object(Me.a)(a,n,"MarkAsPhishing")})),Object(C.d)("MarkAsPhishing",i,{conversationIds:a})}(e,n,t)}))}function Tn(e,n,t){hn((function(){!function(e,n,t){var r=yn(e,n);if(0==r.length)return;var i=Object(oe.a)(e,n),a=Object(f.E)(r,n.id);In(a,n,t,(function(){var e=Object(d.a)(a);Object(b.a)(e,n.tableQuery.folderId,"MarkAsPhishing")})),Object(C.d)("MarkAsPhishing",i,{itemIds:a})}(e,n,t)}))}function Cn(e,n,t){switch(n.tableQuery.listViewType){case 0:Nn(e,n,t);break;case 1:Tn(e,n,t)}}function An(e,n,t){var r=w.u.items.get(e);return hn((function(){In([e],n,t,(function(){var n=Object(d.a)([e]);Object(b.a)(n,r.ParentFolderId.Id,"MarkAsPhishing")}))}))}var xn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SetInferenceClassificationOnConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"inferenceClassification"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"InferenceClassification"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setInferenceClassificationOnConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"inferenceClassification"},value:{kind:"Variable",name:{kind:"Name",value:"inferenceClassification"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},Rn=Object(r.d)("moveConversationToFocusedOrOtherAction",s.a.moveConversationToFocusedOrOther)((function(e,n,t,r){return Object(I.c)(this,void 0,void 0,(function(){var r,i,a,o,c;return Object(I.f)(this,(function(u){switch(u.label){case 0:return r=v.a.tableViews.get(n),i=0==t,a=Object(f.E)(e,n),o=Object(fe.u)(),[4,z.b()];case 1:return u.sent(),c=function(e,n,t){var r;return Object(I.c)(this,void 0,void 0,(function(){var i,a;return Object(I.f)(this,(function(o){switch(o.label){case 0:return i=e.map((function(e){return{id:e}})),[4,Object(Ee.a)()];case 1:return[4,o.sent().mutate({variables:{conversations:i,folderId:n,inferenceClassification:t},mutation:xn})];case 2:return a=o.sent(),[2,null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.setInferenceClassificationOnConversation]}}))}))}(a,r.tableQuery.folderId,i?"Focused":"Other"),o.markUserPerceivedTime(),Object(Me.a)(a,r,"Move"),[2,c]}}))}))}));var Fn=t(2556);function En(e,n){var t=function(e,n){var t,r,i=[];try{for(var a=Object(I.k)(e),o=a.next();!o.done;o=a.next()){var c=o.value,u=Object(J.a)("InferenceClassification",n),s=Object(W.a)({Updates:[u],ItemId:Object(_.a)({Id:c})});i.push(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return Object(H.a)(Object(I.a)({ConflictResolution:"AlwaysOverwrite",ItemChanges:i,MessageDisposition:"SaveOnly"},Object(Fn.a)()))}(e,n),r=Object(q.b)();return r.TimeZoneContext.TimeZoneDefinition.Id="UTC",Object(K.a)({Header:r,Body:t}).then((function(e){return e.Body.ResponseMessages.Items[0]})).catch((function(e){return Promise.reject(e)}))}var Mn=Object(r.d)("moveItemsToFocusedOrOther",s.a.moveItemToFocusedOrOther)((function(e,n,t,r){return Object(I.c)(this,void 0,void 0,(function(){var r,i,a,o,c,u;return Object(I.f)(this,(function(s){switch(s.label){case 0:return r=v.a.tableViews.get(n),i=0==t,a=Object(f.E)(e,n),o=Object(fe.u)(),[4,z.b()];case 1:return s.sent(),c=Object(d.a)(a),u=En(a,i?"Focused":"Other"),Object(b.a)(c,r.tableQuery.folderId,"Move"),o.markUserPerceivedTime(),[2,u.then((function(e){return Object(O.a)(e)}))]}}))}))}));function Vn(e,n,t,r){return Object(I.c)(this,void 0,void 0,(function(){var i;return Object(I.f)(this,(function(a){switch(a.label){case 0:switch(i=v.a.tableViews.get(n),i.tableQuery.listViewType){case 0:return[3,1];case 1:return[3,3]}return[3,5];case 1:return[4,Rn(e,n,t,r)];case 2:return a.sent(),[3,5];case 3:return[4,Mn(e,n,t,r)];case 4:return a.sent(),[3,5];case 5:return[2]}}))}))}var Dn=t(14079),Pn=t(33);function _n(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(I.a)({__type:"ApplyBulkItemActionJsonRequest:#Exchange"},t)),Object(Pn.a)("ApplyBulkItemAction",e,n)}function Ln(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(I.a)({__type:"CreateOrUpdateFocusedOtherOverrideJsonRequest:#Exchange"},t)),Object(Pn.a)("CreateOrUpdateFocusedOtherOverride",e,n)}function Bn(e,n){var t={SenderSmtpAddress:e,AlwaysClassifyAs:n};return Ln({Header:Object(q.b)(),Body:t}).then((function(e){return e.Body})).catch((function(e){return Promise.reject(e)}))}var Un=t(7889),Jn=t(7890),Wn=Object(r.d)("alwaysMoveRowToFocusedOrOtherInternal",s.a.alwaysMoveRowToFocusedOrOther)((function(e,n,t,r){return Object(I.c)(this,void 0,void 0,(function(){var r,i,a,o=this;return Object(I.f)(this,(function(c){switch(c.label){case 0:if(null==(r=f.b.getLastSenderSMTP(e[0],n)))return[2];switch(t){case 0:a="Focused",i=Object(S.b)(Jn.a);break;case 1:a="Other",i=Object(S.b)(Un.a);break;case-1:throw new Error("FocusedViewFilter.None is not supported for this action")}return[4,Object(pn.b)(null,Object(S.c)(Object(S.b)(Dn.a),r,i)).then((function(i){return Object(I.c)(o,void 0,void 0,(function(){return Object(I.f)(this,(function(o){switch(o.label){case 0:return i!==pn.a.ok?[3,2]:n.rowKeys.indexOf(e[0])>-1?[4,Hn(e[0],r,a,n,t)]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}}))}))}))];case 1:return c.sent(),[2]}}))}))}));function Hn(e,n,t,r,i){return Object(I.c)(this,void 0,void 0,(function(){return Object(I.f)(this,(function(a){switch(a.label){case 0:return[4,Vn([e],r.id,i)];case 1:return a.sent(),[4,Bn(n,t).then((function(e){return Object(O.a)(e)}))];case 2:return a.sent(),[4,(o={Id:r.serverFolderId},c=[{EmailAddress:n}],u=Object(J.a)("InferenceClassification",t),s={SourceFolderId:o,EmailAddresses:c,ActionType:3,ItemPropertyToUpdate:u},_n({Header:Object(q.b)(),Body:s}).then((function(e){return e.Body.ResponseMessages.Items[0]})).catch((function(e){return Promise.reject(e)}))).then((function(e){return Object(O.a)(e)}))];case 3:return a.sent(),[2]}var o,c,u,s}))}))}var Kn=t(754),qn=t(9519),Qn=t(2045),zn=t(981),Gn=t(14080),Yn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UnsubscribeEmail"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isTrustedUnsubscribe"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"unsubscribeEmail"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"isTrustedUnsubscribe"},value:{kind:"Variable",name:{kind:"Name",value:"isTrustedUnsubscribe"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},Zn=new RegExp("List-Unsubscribe:[ ]+<mailto:"),Xn=Object(r.d)("unsubscribeWithoutConfirmDialog",s.a.unsubscribe)((function(e,n,t,r){return Object(I.c)(this,void 0,void 0,(function(){var n;return Object(I.f)(this,(function(r){switch(r.label){case 0:return n={itemId:e.ItemId.Id,itemConversationId:e.ConversationId,isRead:e.IsRead,mailboxInfo:e.MailboxInfo},Object(b.a)([n],e.ParentFolderId.Id,"Unsubscribe"),[4,nt.invokeUnsubscribeEmailMutation([e.ItemId.Id],t,e.MailboxInfo)];case 1:return r.sent(),[2]}}))}))})),$n=Object(R.action)("showUnsubscribeDialog")((function(e,n,t,r){var i=this;return Object(pn.b)(Object(S.b)(Gn.b),Object(S.c)(Object(S.b)(Gn.a),e.From.Mailbox.Name),!1,{okText:Object(S.b)(qn.a),cancelText:Object(S.b)(Kn.a)}).then((function(a){return Object(I.c)(i,void 0,void 0,(function(){return Object(I.f)(this,(function(i){return a===pn.a.ok?[2,Xn(e,n,t,r)]:[2]}))}))}))})),et=Object(R.action)("unsubscribeEmail")((function(e,n,t,r){void 0===r&&(r={message:$.a.items.get(e),originalTableView:f.ab.tableViews.get(n),reportToExternalSender:Object(Se.a)().SafetyUserOptions.ReportToExternalSender});var i=r.message,a=r.originalTableView,o=r.reportToExternalSender,c=i.MessageSafety&&(2==i.MessageSafety.MessageSafetyLevel||1==i.MessageSafety.MessageSafetyLevel);if(!o||!c)return $n(i,a,!1,t);var u=Object(zn.a)({BaseShape:"IdOnly"});return Object(Qn.a)(i.ItemId.Id,u,"MessageDetails").then((function(e){if("Success"==e[0].ResponseClass){var n=e[0],r=n.Items[0].ExtendedProperty&&n.Items[0].ExtendedProperty[0].Value;return $n(i,a,Zn.test(r),t)}throw new Error(e[0].MessageText)}))})),nt={invokeUnsubscribeEmailMutation:function(e,n,t){var r;return Object(I.c)(this,void 0,void 0,(function(){var i;return Object(I.f)(this,(function(a){switch(a.label){case 0:return[4,Object(Ee.a)()];case 1:return[4,a.sent().mutate({variables:{ids:e,isTrustedUnsubscribe:n,mailboxInfo:t},mutation:Yn})];case 2:return i=a.sent(),[2,null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.unsubscribeEmail]}}))}))}},tt=Object(i.action)("unsubscribeEmailV2",(function(e,n,t,r){return{message:e,cacheEntry:n,actionSource:t,itemViewState:r}}));function rt(e,n,t,r,i,a){var o,c=(o={ActionType:0,DestinationFolderId:{Id:n},EmailAddresses:e,SourceFolderId:{Id:t},CountType:r,KeepNCount:i,BulkActionRequest:!0,BulkActionCustomData:a&&JSON.stringify(a)},Object(I.a)({__type:"ApplyBulkItemActionRequest:#Exchange"},o));return _n({Header:Object(q.b)(),Body:c}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var it=t(14081);function at(e){return Object(I.a)({__type:"CreateSweepRuleForSenderRequest:#Exchange"},e)}function ot(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(I.a)({__type:"CreateSweepRuleForSenderJsonRequest:#Exchange"},t)),Object(Pn.a)("CreateSweepRuleForSender",e,n)}function ct(e){return e.map((function(e){return Object(S.c)(Object(S.b)(it.a),e.Name)}))}function ut(e,n,t,r,i){var a=at({EmailAddresses:e,ActionType:0,RuleName:null,RuleNames:ct(e),SourceFolderId:{Id:t},DestinationFolderId:{Id:n},CountType:r,KeepNCount:i});return ot({Header:Object(q.b)(),Body:a}).then((function(e){return e.Body}))}var st=t(7769),dt=t(2314),lt={};lt[st.a.All]={keepNType:1,keepNCount:0},lt[st.a.AllCurrentAndFuture]={keepNType:1,keepNCount:0},lt[st.a.AllButOne]={keepNType:1,keepNCount:1},lt[st.a.AllOlderThan]={keepNType:0,keepNCount:10};var bt=Object(R.action)("sweepConversations")((function(e,n,t,r){return Object(I.c)(this,void 0,void 0,(function(){var i,a,o,c,u,s,d;return Object(I.f)(this,(function(l){return i=function(e){return lt[e]}(t),a=i.keepNType,o=i.keepNCount,c=n.tableQuery.folderId,u=e.map((function(e){return e.EmailAddress})).join(", "),s=u.length>70?u.slice(0,70)+"...":u,d={Scenario:"Sweep",senderSMTPs:s,destinationFolderId:r},dt.i.importAndExecute(n.tableQuery.folderId,"Sweep",d),rt(e,r,c,a,o,d),t==st.a.All?[2]:(Object(st.e)(1),[2,ut(e,r,c,a,o).then((function(e){"Success"==e.ResponseMessages.Items[0].ResponseClass&&Object(st.e)(2)})).catch((function(){Object(st.e)(3)}))])}))}))}));function ft(e){return Object(c.a)(e.rowKeys,e.id,!1)}var vt=t(5),mt=t(3986),Ot=t(11535);var jt=t(1244),kt=t(1959),pt=t(7411);Object(i.mutator)(pt.a,(function(e){ht(e.serverFolderId)}));function ht(e){Object(ne.a)(e,!1).forEach((function(e){e.lastEmptiedTime=null}))}var yt=Object(R.action)("clearTableViewLastEmptiedTime")((function(e){ht(e.serverFolderId)})),gt=Object(R.action)("emptyTableView")((function(e,n,t,r,i){return void 0===i&&(i={folderToBeEmptied:ve.d.folderTable.get(e.tableQuery.folderId)}),Object(I.c)(this,void 0,void 0,(function(){var a,o,c,u,s,d,l,b,v,m,O,j,k;return Object(I.f)(this,(function(p){switch(p.label){case 0:return a=i.folderToBeEmptied,o=e.selectAllModeTimeStamp,c=e.id,u=e.serverFolderId,s=e.totalRowsInView,d="ArchiveMailbox"==a.mailboxInfo.type?Object(jt.a)(kt.a):Object(jt.a)(kt.g),l=Object(w.p)(a),b=Object(f.C)(a),m=a,Object(w.k)(a.FolderId.Id)||Object(w.j)(a.FolderId.Id)||"junkemail"===a.DistinguishedFolderId||((m=Object(I.a)({},a)).FolderId={Id:u},m.TotalCount=s,v=o,Object(f.W)(a.FolderId.Id)&&(O=f.ab.inboxPausedDateTime,Object(vt.Hb)(O,o)&&(v=O))),0===b&&(j=function(){return Object(Ot.a)(r,c)}),k=function(){var n,t,i=[];if(r.length>0)switch(b){case 0:i=Object(wn.a)(r,c);break;case 1:n=e,t={},r.forEach((function(e){var r=f.b.getRowClientItemId(e,n).Id;t[r]||(t[r]=!0)})),i=Object.keys(t)}return i},[4,mt.a.importAndExecute(null,m,Object(f.m)(e),Object(f.R)(e),n,t,r,v,e.totalRowsInView,b,d,l,c,j,k)];case 1:return p.sent(),e&&yt(e),[2]}}))}))})),It=Object(i.mutatorAction)("updateMessageLikers",(function(e,n,t,r,i){var a,o;if(t?e.LikeCount>1?(e.LikeCount--,e.Likers=e.Likers.filter((function(e){return e.EmailAddress!==r}))):(e.LikeCount=null,e.Likers=null):(e.LikeCount?e.LikeCount++:(e.LikeCount=1,e.Likers=[]),e.Likers.push({EmailAddress:r,Name:i,MailboxType:"Mailbox",RoutingType:"SMTP"})),n&&Object(f.S)(n)&&e.ConversationId){var c=Object(f.G)([e.ConversationId.Id],n);try{for(var u=Object(I.k)(c),s=u.next();!s.done;s=u.next()){var d=s.value;Object(ee.a)(d,n.id).globalLikeCount+=t?-1:1}}catch(e){a={error:e}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}}}));function St(e){return Object(I.a)({__type:"LikeItemJsonRequest:#Exchange"},e)}function wt(e,n){var t;return t={IsUnlike:n,ItemId:e},Object(I.a)({__type:"LikeItemRequest:#Exchange"},t)}function Nt(e,n,t){var r,i,a=wt(e,n);return(r=St({Header:Object(q.b)(),Body:a}),i=t,void 0===r||r.__type||(r=St(r)),Object(Pn.a)("LikeItem2",r,i)).then((function(e){return e.Body}))}var Tt=t(14082),Ct=Object(i.action)("likeItem",(function(e,n,t,i,a){return Object(r.c)({name:"LikeItem",actionSource:"ReadingPane"},{itemId:e,message:n,tableView:t,isLocalUpdateOnly:i,instrumentationContext:a})}));Object(i.orchestrator)(Ct,(function(e){var n=e.tableView,t=e.itemId,r=e.message,i=e.instrumentationContext,a=Object(Se.a)().SessionSettings.UserEmailAddress,o=!!r.Likers&&r.Likers.some((function(e){return e.EmailAddress===a}));It(r,n,o,a,Object(Se.a)().SessionSettings.UserDisplayName),e.isLocalUpdateOnly||Nt(t,o,t.mailboxInfo.requestOptions),o||Object(C.d)("Like",[i],{itemIds:[r.ItemId.Id],conversationIds:[r.ConversationId.Id]}),w.s.importAndExecute(o?Object(S.b)(Tt.b):Object(S.b)(Tt.a))}));var At=Ct;function xt(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(I.a)({__type:"ReactToItemJsonRequest:#Exchange"},t)),Object(Pn.a)("ReactToItem",e,n)}function Rt(e,n){return t={ItemIds:[e],ReactionType:n},Object(I.a)({__type:"ReactToItemRequest:#Exchange"},t);var t}var Ft=Object(i.action)("reactToItem",(function(e,n,t,i,a,o,c){return Object(r.c)({name:"ReactToItem",actionSource:"ReadingPane"},{message:e,itemId:n,conversationId:t,reactionType:i,instrumentationContext:a,actionAnnouncementString:o,ownerCurrentReactionType:c})})),Et=Object(i.mutatorAction)("updateMessageReactors",(function(e,n,t,r,i){e.Reactions||(e.Reactions=[]),e.OwnerReactionType=i;var a=e.OwnerReactionType===n,o=!1;e.Reactions.forEach((function(i){i.ReactionType===e.OwnerReactionType&&(i.Count--,i.Reactors=i.Reactors.filter((function(e){return e.ReactorEmail.EmailAddress!==t})),0===i.Count&&(i.Count=null,i.Reactors=null)),i.ReactionType!==n||a||(o=!0,i.Count++,i.Reactors.push({ReactorEmail:{EmailAddress:t,Name:r,MailboxType:"Mailbox",RoutingType:"SMTP"}}))})),o||a||e.Reactions.push({Count:1,ReactionType:n,Reactors:[{ReactorEmail:{EmailAddress:t,Name:r,MailboxType:"Mailbox",RoutingType:"SMTP"}}]}),e.Reactions=e.Reactions.filter((function(e){return null!==e.Reactors})),e.OwnerReactionType=a?null:n}));Object(i.orchestrator)(Ft,(function(e){var n=e.itemId,t=e.message,r=e.reactionType,i=e.conversationId,a=e.instrumentationContext,o=e.actionAnnouncementString,c=e.ownerCurrentReactionType,u=Object(Se.a)().SessionSettings.UserEmailAddress,s=Object(Se.a)().SessionSettings.UserDisplayName;Et(t,r,u,s,c),function(e,n){var t=Rt(e,n),r=Object(q.b)();r.TimeZoneContext.TimeZoneDefinition.Id="UTC",xt({Header:r,Body:t}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}(n,null!==t.OwnerReactionType?r:"0"),Object(C.d)("Reaction",[a],{itemIds:[null==n?void 0:n.Id],conversationIds:[null==i?void 0:i.Id]}),w.s.importAndExecute(o)}));var Mt=Ft,Vt=t(14083);var Dt=t(1554),Pt=t(11536),_t=t(197),Lt=t(451),Bt=t(0),Ut=t(14084),Jt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkItemAsJunk"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isJunk"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reportToSafety"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markItemAsJunk"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"isJunk"},value:{kind:"Variable",name:{kind:"Name",value:"isJunk"}}},{kind:"ObjectField",name:{kind:"Name",value:"reportToSafety"},value:{kind:"Variable",name:{kind:"Name",value:"reportToSafety"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}},{kind:"Field",name:{kind:"Name",value:"movedItemIds"}},{kind:"Field",name:{kind:"Name",value:"undoRequestId"}}]}}]}}]},Wt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UndoMarkItemAsJunk"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isJunk"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reportToSafety"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"undoMarkItemAsJunk"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}},{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"isJunk"},value:{kind:"Variable",name:{kind:"Name",value:"isJunk"}}},{kind:"ObjectField",name:{kind:"Name",value:"reportToSafety"},value:{kind:"Variable",name:{kind:"Name",value:"reportToSafety"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}},{kind:"Field",name:{kind:"Name",value:"movedItemIds"}}]}}]}}]},Ht=Object(r.d)("markItemsJunkNotJunkBasedOnItemIds",s.a.markItemsJunkNotJunk)((function(e,n,t,r,i,a){var o;return Object(I.c)(this,void 0,void 0,(function(){var c,u,s,d,l,b,f,v,m,O,j=this;return Object(I.f)(this,(function(k){switch(k.label){case 0:return c=z.d(null===(o=null==r?void 0:r.tableQuery)||void 0===o?void 0:o.folderId,Object(E.b)(r)),[4,z.b()];case 1:k.sent(),u=Object(Se.a)().SegmentationSettings.ReportJunkEmailEnabled,s=Object(Se.a)().UserOptions.ReportJunkSelected,d=Object(Se.a)().UserOptions.CheckForReportJunkDialog,l=!1,b=function(){l=!l},f=Promise.resolve(),m=!1,O=Object(E.b)(r);try{Object(_t.a)()||d&&s&&u&&n?(v=qt.invokeMarkItemAsJunkMutation(e,n,!0,O),m=!0):!u||d&&n?v=qt.invokeMarkItemAsJunkMutation(e,n,!1,O):f=Object(pn.b)(n?Object(S.b)(Ut.a):Object(S.b)(Ut.b),_t.a?Object(S.b)(Ut.c):Object(S.b)(Ut.d),!1,{okText:Object(S.b)(jn.f),cancelText:Object(S.b)(jn.e),bodyElement:n?Bt.createElement(Dt.a,{label:Object(S.b)(Pt.a),onChange:b}):null}).then((function(t){if(n){var r=t===pn.a.ok;Object(Lt.a)((function(e){e.UserOptions.ReportJunkSelected=r,e.UserOptions.CheckForReportJunkDialog=l}),[{key:"CheckForReportJunkDialog",valuetype:"Boolean",value:[String(l)]},{key:"ReportJunkSelected",valuetype:"Boolean",value:[String(r)]}])}t==pn.a.ok?(v=qt.invokeMarkItemAsJunkMutation(e,n,!0,O),m=!0):v=qt.invokeMarkItemAsJunkMutation(e,n,!1,O)}))}catch(e){}return c&&z.a((function(){return Object(I.c)(j,void 0,void 0,(function(){var e;return Object(I.f)(this,(function(t){switch(t.label){case 0:return[4,v];case 1:return(e=t.sent()).success?[4,Kt(m,n,e.movedItemIds,r,e.undoRequestId)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2,Promise.resolve()]}}))}))}),r.serverFolderId,v),t&&f.then((function(){return function(e,n,t){if(Object(Se.a)().UserOptions.ShowNotificationBar){var r;r=t?1===e?Object(S.b)(Vt.a):Object(S.c)(Object(S.b)(Vt.c),e):1===e?Object(S.b)(Vt.b):Object(S.c)(Object(S.b)(Vt.d),e);var i=Object(ge.j)();Ie.e.importAndExecute("markAsJunkNotification","MailModuleNotificationBarHost",r,{icon:"Blocked",primaryActionText:n?Object(S.b)(ye.a):null,allowClear:!0,minWidth:i.minWidth,maxWidth:i.maxWidth,notificationCallback:function(e){e===Ie.a.PrimaryActionClicked&&z.f.importAndExecute("NotificationBar")}})}}(e.length,c,n)})),a(),n&&Object(C.d)("MarkAsJunk",i,{itemIds:e}),[2,f]}}))}))}));function Kt(e,n,t,r,i){return Object(I.c)(this,void 0,void 0,(function(){var a,o,c,u,s;return Object(I.f)(this,(function(d){switch(d.label){case 0:return t.length>0?(a=Object(E.b)(r),o=qt.invokeUndoMarkItemAsJunkMutation(t,!n,e,a,i),c=Object(jt.a)("inbox"),n&&c!==r.tableQuery.folderId?[4,o]:[3,2]):[3,3];case 1:if(u=d.sent(),(s=u.movedItemIds).length>0)return[2,Ke(s,r.tableQuery.folderId)];d.label=2;case 2:return[2,o];case 3:return[2,Promise.resolve()]}}))}))}var qt={invokeMarkItemAsJunkMutation:function(e,n,t,r){var i;return Object(I.c)(this,void 0,void 0,(function(){var a;return Object(I.f)(this,(function(o){switch(o.label){case 0:return[4,Object(Ee.a)()];case 1:return[4,o.sent().mutate({variables:{ids:e,isJunk:n,reportToSafety:t,mailboxInfo:r},mutation:Jt})];case 2:return a=o.sent(),[2,null===(i=null==a?void 0:a.data)||void 0===i?void 0:i.markItemAsJunk]}}))}))},invokeUndoMarkItemAsJunkMutation:function(e,n,t,r,i){var a;return Object(I.c)(this,void 0,void 0,(function(){var o;return Object(I.f)(this,(function(c){switch(c.label){case 0:return[4,Object(Ee.a)()];case 1:return[4,c.sent().mutate({variables:{ids:e,isJunk:n,reportToSafety:t,mailboxInfo:r,undoRequestId:i},mutation:Wt})];case 2:return o=c.sent(),[2,null===(a=null==o?void 0:o.data)||void 0===a?void 0:a.undoMarkItemAsJunk]}}))}))}};function Qt(e,n,t,r){switch(n.tableQuery.listViewType){case 0:!function(e,n,t,r){var i=Object(wn.a)(e,n.id),a=Object(oe.a)(e,n);Ht(i,t,r,n,a,(function(){var t=Object(f.E)(e,n.id);Object(Me.a)(t,n,"MarkAsJunk")}))}(e,n,t,r);break;case 1:!function(e,n,t,r){var i=Object(f.E)(e,n.id),a=Object(oe.a)(e,n);Ht(i,t,r,n,a,(function(){var e=Object(d.a)(i);Object(b.a)(e,n.tableQuery.folderId,"MarkAsJunk")}))}(e,n,t,r)}}var zt=Object(i.action)("MARK_ITEMS_JUNK_NOT_JUNK_BASED_ON_NODE_IDS",(function(e,n,t,r){return{nodeIds:e,tableViewId:n,isJunkValueToSet:t,actionSource:r}})),Gt=t(2100);function Yt(e,n,t,r,i){void 0===i&&(i={item:$.a.items.get(e)});var a=i.item,o=Object(Gt.a)(a.ParentFolderId.Id,"junkemail");return Ht([e],!o,t,n,r,(function(){var n=Object(d.a)([e]);Object(b.a)(n,a.ParentFolderId.Id,"MarkAsJunk")}))}var Zt=Object(i.action)("ON_KEYBOARD_MARK_AS_JUNK_NOT_JUNK",(function(e,n,t){return{tableView:e,selectedNodeIds:n,selectedRowKeys:t}})),Xt=Object(i.action)("ON_KEYBOARD_TOGGLE_FLAG_STATE",(function(e,n,t){return{tableView:e,selectedNodeIds:n,selectedRowKeys:t}})),$t=Object(i.action)("ON_KEYBOARD_DELETE",(function(e,n,t,r,i){return{tableView:e,selectedNodeIds:n,selectedRowKeys:t,isInVirtualSelectAllMode:r,isExplicitSoftDelete:i}})),er=t(10467),nr=t(14085);function tr(e){return ar(e,(function(e){return e.Name}),Object(S.b)(nr.h),Object(S.b)(nr.t),Object(S.b)(nr.p),Object(S.b)(nr.e),Object(S.b)(nr.l))}function rr(e){var n=Object(_t.a)();return ar(e,(function(e){return e.EmailAddress}),n?Object(S.b)(nr.f):Object(S.b)(nr.g),n?Object(S.b)(nr.r):Object(S.b)(nr.s),n?Object(S.b)(nr.n):Object(S.b)(nr.o),n?Object(S.b)(nr.c):Object(S.b)(nr.d),n?Object(S.b)(nr.j):Object(S.b)(nr.k))}function ir(e){return function(e,n,t,r,i,a){switch(e.length){case 0:throw new Error("formatDomains: no email addresses");case 1:return Object(S.c)(n,e[0]);case 2:return Object(S.c)(t,e[0],e[1]);case 3:return Object(S.c)(r,e[0],e[1]);case 4:case 5:case 6:return Object(S.c)(i,e[0],e[1],e.length-2);default:return Object(S.c)(a,e[0],e[1],e.length-2)}}(e,Object(S.b)(nr.a),Object(S.b)(nr.q),Object(S.b)(nr.m),Object(S.b)(nr.b),Object(S.b)(nr.i))}function ar(e,n,t,r,i,a,o){switch(e.length){case 0:throw new Error("formatSenders: no email addresses");case 1:return Object(S.c)(t,n(e[0]));case 2:return Object(S.c)(r,n(e[0]),n(e[1]));case 3:return Object(S.c)(i,n(e[0]),n(e[1]));case 4:case 5:case 6:return Object(S.c)(a,n(e[0]),n(e[1]),e.length-2);default:return Object(S.c)(o,n(e[0]),n(e[1]),e.length-2)}}function or(e){return e.map((function(e){return""}))}var cr=Object(i.action)("ADD_DOMAINS_TO_BLOCKED_LIST",(function(e){return{domains:e}})),ur=t(3587),sr=t(14086),dr=t(24),lr=!1;function br(e,n){return Object(I.c)(this,void 0,void 0,(function(){var t,r,i,a,o,c;return Object(I.f)(this,(function(u){switch(u.label){case 0:return e?[4,vr(e)]:[2];case 1:return u.sent()?[4,Object(pn.b)(Object(S.b)(sr.b),Object(S.b)(sr.a),!1,{hideCancelButton:!0})]:[3,3];case 2:return u.sent(),[2];case 3:return lr=!1,t=function(e){var n=e.map((function(e){return e.EmailAddress.split("@")[1]}));return n.filter((function(e,t){return n.indexOf(e)===t}))}(e),r=Object(I.g)(function(e,n){return[tr(e),rr(e),ir(n)]}(e,t),3),i=r[0],a=r[1],o=r[2],c=Bt.createElement(Dt.a,{key:"blockDomainCheckbox",defaultChecked:lr,label:o,onChange:fr}),[4,Object(pn.b)(i,a,!1,{bodyElement:Object(dr.i)("tri-blockDomain")?c:null})];case 4:if(u.sent()!==pn.a.ok)return[2];lr&&(cr(t),Object(fe.s)("BlockDomain",[t.length]));try{d=at({EmailAddresses:s=e,ActionType:2,RuleName:null,RuleNames:or(s)}),ot({Header:Object(q.b)(),Body:d}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}catch(e){}return n(),[2]}var s,d}))}))}function fr(){lr=!lr}function vr(e){return Object(I.c)(this,void 0,void 0,(function(){var n,t,r,i,a,o;return Object(I.f)(this,(function(c){switch(c.label){case 0:return Object(_t.a)()?[2,Promise.resolve(!1)]:[4,Object(ur.b)(Object(Se.a)().SessionSettings.UserEmailAddress,e.map((function(e){return e.EmailAddress})))];case 1:if(n=c.sent()){t=n.ResponseMessages.map((function(e){return Object(ur.a)(e.MessageText)})).filter((function(e){return!!e}));try{for(r=Object(I.k)(t),i=r.next();!i.done;i=r.next())if(0===i.value.ExternalMemberCount)return[2,Promise.resolve(!0)]}catch(e){a={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(a)throw a.error}}}return[2,Promise.resolve(!1)]}}))}))}var mr=t(8187),Or=t(11533),jr=t(23),kr=t(2511);function pr(e,n,t){if(e&&0!=e.length){var r=Object(oe.a)(e,n);br(Object(mr.a)(e,n),(function(){hr(e,n,t,r)})),Object(kr.a)("Block",r,{rowKeys:e})}else jr.d("Block button should not be exposed when there is nothing selected in list view.")}var hr=Object(r.d)("deleteRowsUponBlocking",s.a.blockSendersFromTable)((function(e,n,t,r){var i=e.filter((function(e){return n.rowKeys.indexOf(e)>=0}));switch(n.tableQuery.listViewType){case 0:var a=Object(Or.a)(i,n.id);Object(er.b)(a,n.id,"MoveToDeletedItems",r);break;case 1:var o=Object(f.E)(e,n.id);Object(p.c)(o,"MoveToDeletedItems",n.tableQuery.folderId,null,r,null,Object(z.d)(n.tableQuery.folderId,Object(E.b)(n)))}}));function yr(e,n,t){e?(br(Object(mr.b)([e]),(function(){gr(e,n,t)})),Object(kr.a)("Block",n,{itemIds:[e]})):jr.d("blockLastSendersFromReadingPane should not be called on invalid items.")}var gr=Object(r.d)("deleteItemUponBlock",{name:"TnS_BlockSenderFromReadingPane",actionSource:function(e,n,t){return t}})((function(e,n,t){return Object(p.a)([e],"MoveToDeletedItems",n)}));function Ir(e,n,t,r){if(!e||0===e.length)throw new Error("Update category action should not be exposed.");if(r&&(n||t))throw new Error("When clearCategories is true, categoriesToAdd and categoriesToRemove both have to be null.");if(n&&t)throw new Error("Can only add or remove categories at one time.")}var Sr=t(3675),wr=t(2136),Nr={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CategorizeConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoriesToAdd"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoriesToRemove"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clearAllCategories"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"processRightAway"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"categorizeConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"categoriesToAdd"},value:{kind:"Variable",name:{kind:"Name",value:"categoriesToAdd"}}},{kind:"ObjectField",name:{kind:"Name",value:"categoriesToRemove"},value:{kind:"Variable",name:{kind:"Name",value:"categoriesToRemove"}}},{kind:"ObjectField",name:{kind:"Name",value:"clearAllCategories"},value:{kind:"Variable",name:{kind:"Name",value:"clearAllCategories"}}},{kind:"ObjectField",name:{kind:"Name",value:"processRightAway"},value:{kind:"Variable",name:{kind:"Name",value:"processRightAway"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},Tr=t(14087);function Cr(e){if(Object(Se.a)().UserOptions.ShowNotificationBar){var n=Object(ge.j)();Ie.e.importAndExecute("removeCategoryNotification","MailModuleNotificationBarHost",Object(S.b)(Tr.a),{icon:"Tag",primaryActionText:e?Object(S.b)(ye.a):null,allowClear:!0,minWidth:n.minWidth,maxWidth:n.maxWidth,notificationCallback:function(e){e===Ie.a.PrimaryActionClicked&&(Object(fe.s)("Category_RPEasyRemoveCategory_Undo"),z.f.importAndExecute("NotificationBar"))}})}}function Ar(e,n,t,r,i,a,o,c){return Object(I.c)(this,void 0,void 0,(function(){return Object(I.f)(this,(function(u){switch(u.label){case 0:return Ir(e,t,r,i),[4,z.b()];case 1:return u.sent(),c?[2,c.then((function(c){return xr(e,n,t,r,i,a,o)}))]:[2,xr(e,n,t,r,i,a,o)]}}))}))}function xr(e,n,t,r,i,a,o){return Object(Sr.a)(e,n.id,t,r,i),function(e,n){wr.a.add(e,n,0)}(e,n),function(e,n,t,r,i,a,o){var c=this,u=Object(f.l)(n,!0),s=e.map((function(e){return Object(f.i)(e,n.id)})),d=Rr.invokeCategorizeConversationMutation(s,u,t,r,i);o&&(z.a((function(){return Object(I.c)(c,void 0,void 0,(function(){return Object(I.f)(this,(function(t){switch(t.label){case 0:return[4,d];case 1:return t.sent().success?[4,Ar(e,n,r,null,!1,a,!1,null)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2,Promise.resolve()]}}))}))}),n.serverFolderId,d),Cr(o));return Object(m.c)(d,e,n.serverFolderId,n,!1,!0)}(e,n,t,r,i,a,o)}var Rr={invokeCategorizeConversationMutation:function(e,n,t,r,i){var a;return Object(I.c)(this,void 0,void 0,(function(){var o,c;return Object(I.f)(this,(function(u){switch(u.label){case 0:return o=e.map((function(e){return{id:e.conversationId,messagesAsOf:Object(M.a)(e.conversationLastSyncTimeStamp)}})),[4,Object(Ee.a)()];case 1:return[4,u.sent().mutate({variables:{conversations:o,categoriesToAdd:t,categoriesToRemove:r,clearAllCategories:i,processRightAway:Object(dr.i)("tri-processConversationCategoriesRightAway"),folderId:n},mutation:Nr})];case 2:return c=u.sent(),[2,null===(a=null==c?void 0:c.data)||void 0===a?void 0:a.categorizeConversation]}}))}))}},Fr=t(3676),Er={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CategorizeItem"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"items"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CategorizeItemSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"categorizeItem"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"items"},value:{kind:"Variable",name:{kind:"Name",value:"items"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]};function Mr(e,n,t,r,i,a,o,c){return Object(I.c)(this,void 0,void 0,(function(){return Object(I.f)(this,(function(u){switch(u.label){case 0:return Ir(e,t,r,i),[4,z.b()];case 1:return u.sent(),c?[2,c.then((function(c){return Vr(e,n,t,r,i,a,o)}))]:[2,Vr(e,n,t,r,i,a,o)]}}))}))}function Vr(e,n,t,r,i,a,o){var c=Object(f.E)(e,n.id);return Object(Fr.a)(c,t,r,i),wr.a.add(e,n,0),function(e,n,t,r,i,a){return Object(I.c)(this,void 0,void 0,(function(){var o,c,u,s=this;return Object(I.f)(this,(function(d){switch(d.label){case 0:o=Object(E.b)(n),d.label=1;case 1:return d.trys.push([1,3,,4]),c=Dr.invokeCategorizeItemMutation(t,o),i&&(z.a((function(){return Object(I.c)(s,void 0,void 0,(function(){return Object(I.f)(this,(function(t){switch(t.label){case 0:return[4,c];case 1:return t.sent().success?[4,Mr(e,n,r,null,!1,a,!1,null)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2,Promise.resolve()]}}))}))}),n.serverFolderId,c),Cr(i)),[4,c];case 2:return d.sent(),Object(m.a)(e,n.serverFolderId,!0),[3,4];case 3:return u=d.sent(),Object(m.a)(e,n.serverFolderId,!0),Object(m.b)(n),[2,Promise.reject(u)];case 4:return[2]}}))}))}(e,n,function(e){var n=[];return e.forEach((function(e){var t=Object(w.v)(e);n.push({id:t.ItemId.Id,categories:t.Categories})})),n}(c),r,o,a)}var Dr={invokeCategorizeItemMutation:function(e,n){var t;return Object(I.c)(this,void 0,void 0,(function(){var r;return Object(I.f)(this,(function(i){switch(i.label){case 0:return[4,Object(Ee.a)()];case 1:return[4,i.sent().mutate({variables:{items:e,mailboxInfo:n},mutation:Er})];case 2:return r=i.sent(),[2,null===(t=null==r?void 0:r.data)||void 0===t?void 0:t.categorizeItem]}}))}))}},Pr=t(1085),_r=Object(r.d)("addCategories",s.a.addCategories)((function(e,n,t,r,i){var a=Ur(e,n,t,null,!1,r,!1,i);Pr.A.importAndExecute(t);var o=Object(oe.a)(e,n);return Object(C.d)("Categorize",o,{rowKeys:e}),a})),Lr=Object(r.d)("clearCategories",s.a.clearCategories)((function(e,n,t){return Ur(e,n,null,null,!0,t,!1)})),Br=Object(r.d)("removeCategoriesFromTable",s.a.removeCategories)((function(e,n,t,r,i){var a=Object(E.b)(n);return Ur(e,n,null,t,!1,r,i&&z.d(n.tableQuery.folderId,a))}));function Ur(e,n,t,r,i,a,o,c){return Object(f.S)(n)?Ar(e,n,t,r,i,a,o,c):Mr(e,n,t,r,i,a,o,c)}var Jr=t(2018),Wr=t(2350),Hr=Object(R.action)("translateFromTable")((function(e,n,t){return Object(I.c)(this,void 0,void 0,(function(){var t,r;return Object(I.f)(this,(function(i){switch(i.label){case 0:if(t=f.b.getRowClientItemId(e[0],n),!e||0==e.length)return jr.d("Translate button should not show when empty list"),[2];switch(n.tableQuery.listViewType){case 0:return[3,1];case 1:return[3,6]}return[3,8];case 1:return[4,Wr.j.import()];case 2:return[4,i.sent()(t)];case 3:return(null==(r=i.sent())?void 0:r.Id)?[4,Jr.B.import()]:[3,5];case 4:i.sent()(Object(Jr.q)(r.Id)),i.label=5;case 5:return[3,8];case 6:return[4,Jr.B.import()];case 7:return i.sent()(Object(Jr.q)(t.Id)),[3,8];case 8:return[2]}}))}))})),Kr=Object(i.action)("toggleIgnoreConversations",(function(e,n,t,r){return{rowKeysToIgnore:e,tableView:n,shouldIgnore:t,actionSource:r}})),qr=Object(i.action)("INTERNAL_TOGGLE_IGNORE_CONVERSATION",(function(e,n,t,i){return Object(r.c)({name:"TnS_Ignore",customData:[i,t],options:{isCore:!0}},{rowKeysToIgnore:e,tableView:n,shouldIgnore:t,actionSource:i})})),Qr=Object(i.action)("MOVE_SHARED_FOLDER_ITEMS",(function(e,n,t,r,i){return{rowKeys:e,originalTableViewId:n,destinationFolderId:t,parentFolderId:r,actionSource:i}})),zr=Object(i.action)("MOVE_SHARED_FOLDER_CONVERSATIONS",(function(e,n,t){return{rowKeys:e,destinationFolderId:n,originalTableView:t}})),Gr=Object(i.action)("ON_REMOVE_MEETING",(function(e,n){return{tableViewId:e,conversationId:n}})),Yr=t(5882),Zr=Object(i.action)("removeSpotlight",(function(e,n,t,r){return{rowKey:e,tableViewId:n,actionSource:t,itemOrConversationId:r}})),Xr=t(14088),$r=t(2581),ei=t(1300),ni=t(2211);Object(i.orchestrator)(tt,(function(e){Object(pn.b)(Object(S.b)(Xr.b),Object(S.c)(Object(S.b)(Xr.a),e.message.From.Mailbox.Name),!1,{okText:Object(S.b)($r.a),cancelText:Object(S.b)(Kn.a)}).then((function(n){var t,r;n===pn.a.ok&&(t=e.cacheEntry,r=e.itemViewState,Object(ei.e)("ReadingPaneInfoBar",t.smtpInfo.smtpAddress,t.smtpInfo.smtpIdentifier,t.unsubscribeSilentUris,t.unsubscribeHttpUris[0],(function(){Object(ni.a)(r,"unsubscribeInfoBar")})))}))}));var ti=t(14089),ri=t(5129);function ii(){return Object(ri.a)().then((function(e){if(e.WasSuccessful)return e.Options;throw new Error("getMailboxJunkEmailConfigurationOperation "+e.ErrorCode+" "+e.ErrorMessage)}))}var ai=t(7829);function oi(e){return Object(ai.a)({Header:Object(q.b)(),Options:e})}Object(i.orchestrator)(a,(function(e){return Object(I.c)(void 0,void 0,void 0,(function(){var n;return Object(I.f)(this,(function(t){switch(t.label){case 0:return[4,Object(pn.b)(Object(S.c)(Object(S.b)(ti.b),e.mailbox.EmailAddress),Object(S.c)(Object(S.b)(ti.a),e.mailbox.EmailAddress))];case 1:return t.sent()!==pn.a.ok?[3,3]:[4,ii()];case 2:n=t.sent(),o(e.mailbox,n),oi(n),t.label=3;case 3:return[2]}}))}))}));var ci=function(){function e(e,n,t,r){var i=this;this.checkboxToggled=function(){i.isChecked=!i.isChecked},this.title=e,this.subtext=n,this.isChecked=!1,this.onConfirm=t,this.onDismiss=r,this.dialogOptions={okText:Object(S.b)($r.a),cancelText:Object(S.b)(Kn.a),bodyElement:Bt.createElement(Dt.a,{label:Object(S.b)(Pt.a),onChange:this.checkboxToggled})}}return e.prototype.show=function(){var e=this;return Object(pn.b)(this.title,this.subtext,!1,this.dialogOptions).then((function(n){return n===pn.a.ok?e.onConfirm(e.isChecked):e.onDismiss()}))},e}(),ui=t(14090),si={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"IgnoreConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"enableAlwaysDelete"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"processRightAway"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ignoreConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"enableAlwaysDelete"},value:{kind:"Variable",name:{kind:"Name",value:"enableAlwaysDelete"}}},{kind:"ObjectField",name:{kind:"Name",value:"processRightAway"},value:{kind:"Variable",name:{kind:"Name",value:"processRightAway"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},di=(Object(i.orchestrator)(Kr,(function(e){var n=e.shouldIgnore,t=e.rowKeysToIgnore,r=n?128:256;if((r&Object(Se.a)().UserOptions.NewEnabledPonts)==r){var i=void 0;i=n?1==t.length?Object(S.b)(ui.b):Object(S.c)(Object(S.b)(ui.c),t.length):1==t.length?Object(S.b)(ui.e):Object(S.c)(Object(S.b)(ui.f),t.length);var a=n?Object(S.b)(ui.a):Object(S.b)(ui.d);new ci(i,a,(function(t){t&&function(e){var n=Object(Se.a)().UserOptions.NewEnabledPonts&~e;Object(Lt.a)((function(e){e.UserOptions.NewEnabledPonts=n}),[{key:"NewEnabledPonts",valuetype:"Integer32",value:[""+n]}])}(r),qr(e.rowKeysToIgnore,e.tableView,n,e.actionSource)}),(function(){})).show()}else qr(e.rowKeysToIgnore,e.tableView,n,e.actionSource)})),Object(i.orchestrator)(qr,(function(e){var n,t,r=e.shouldIgnore,i=e.tableView,a=e.rowKeysToIgnore,o=[],c=i.id;try{for(var u=Object(I.k)(a),s=u.next();!s.done;s=u.next()){var l=s.value;o.push(f.b.getConversationId(l,i))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(t=u.return)&&t.call(u)}finally{if(n)throw n.error}}if(r){var v=Object(oe.a)(a,i);Object(C.d)("Ignore",v,{rowKeys:a})}if(Object(f.S)(i))Object(Me.a)(o,i,"Ignore");else{var O=Object(f.E)(a,c),j=Object(d.a)(O);Object(b.a)(j,i.tableQuery.folderId,"Ignore")}var k=di.ignoreConversationMutation(o,i.tableQuery.folderId,r,Object(dr.i)("tri-processIgnoreRightAway"));return Object(m.c)(k,a,i.tableQuery.folderId,i,!1,!0)})),{ignoreConversationMutation:function(e,n,t,r){var i;return Object(I.c)(this,void 0,void 0,(function(){var a,o;return Object(I.f)(this,(function(c){switch(c.label){case 0:return a=e.map((function(e){return{id:e}})),[4,Object(Ee.a)()];case 1:return[4,c.sent().mutate({variables:{conversations:a,folderId:n,enableAlwaysDelete:t,processRightAway:r},mutation:si})];case 2:return o=c.sent(),[2,null===(i=null==o?void 0:o.data)||void 0===i?void 0:i.ignoreConversation]}}))}))}}),li=t(2072),bi=t(4206),fi=t(2959);Object(i.orchestrator)(h,(function(e){var n=f.ab.tableViews.get(e.tableViewId),t=Object(I.j)([],Object(I.g)(n.selectedRowKeys.keys())),r=Object(fi.a)(t[0]),i=Object(bi.a)(e.nodeIds,r),a=f.ab.expandedConversationViewState;a.selectedNodeIds.indexOf(e.nodeIds[0])>-1&&Object(li.m)(a.expandedRowKey,n),Object(p.a)(i,n.tableQuery.folderId&&Object(Gt.a)(n.tableQuery.folderId,"deleteditems")||function(e){var n,t;try{for(var r=Object(I.k)(e),i=r.next();!i.done;i=r.next()){var a=i.value,o=w.u.items.get(a);if((null==o?void 0:o.ParentFolderId)&&"deleteditems"==Object(we.a)(o.ParentFolderId.Id))return!0}}catch(e){n={error:e}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}return!1}(i)?"SoftDelete":"MoveToDeletedItems",null,e.actionSource,Object(E.b)(n)),r&&Object(li.u)(a.latestNodeIdsInEachFork,i)}));Object(i.orchestrator)(rn,(function(e){var n=f.ab.tableViews.get(e.tableViewId),t=Object(I.j)([],Object(I.g)(n.selectedRowKeys.keys())),r=Object(bi.a)(e.nodeIds,Object(fi.a)(t[0]));Object(li.m)(f.ab.expandedConversationViewState.expandedRowKey,n),Qe(r,e.destinationFolderId,n,e.actionSource)})),Object(i.orchestrator)(zt,(function(e){var n=f.ab.tableViews.get(e.tableViewId),t=Object(I.j)([],Object(I.g)(n.selectedRowKeys.keys())),r=Object(bi.a)(e.nodeIds,Object(fi.a)(t[0]));Object(li.m)(f.ab.expandedConversationViewState.expandedRowKey,n),Ht(r,e.isJunkValueToSet,e.actionSource,n,null,(function(){var e=Object(d.a)(r);Object(b.a)(e,n.tableQuery.folderId,"MarkAsJunk")}))})),Object(i.orchestrator)(Zt,(function(e){var n=e.tableView,t=e.selectedNodeIds,r=e.selectedRowKeys;if(t.length>0)zt(t,n.id,!0,"Keyboard");else{if(0===r.length)return;Qt(r,n,!0,"Keyboard")}}));var vi=t(3306);Object(i.orchestrator)(Xt,(function(e){var n=e.tableView,t=e.selectedNodeIds,r=e.selectedRowKeys;if(Object(me.b)(15))if(t.length>0){var i=function(e,n){var t,r;try{for(var i=Object(I.k)(e),a=i.next();!a.done;a=i.next()){var o=a.value;if("Flagged"!==Object(vi.a)(o,n).Flag.FlagStatus)return"Flagged"}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return Object(se.s)()?"NotFlagged":"Complete"}(t,Object(fi.a)(r[0]));ae(Object(bi.a)(t,Object(fi.a)(r[0])),null,{FlagStatus:i},n.id,"Keyboard")}else{if(0===r.length)return;de(r,n.id,"Keyboard")}}));var mi=t(2053),Oi=(Object(i.orchestrator)($t,(function(e){var n=e.tableView,t=e.selectedNodeIds,r=e.selectedRowKeys,i=e.isInVirtualSelectAllMode,a=e.isExplicitSoftDelete;if(Object(me.b)(12)){if(i)gt(n,a,"Keyboard",n.virtualSelectAllExclusionList);else{if(t.length>0)return h(t,n.id,"Keyboard"),void mi.b.importAndExecute();r.length>0&&Object(c.a)(r,n.id,a,"Keyboard")}0==n.rowKeys.length&&mi.b.importAndExecute()}})),t(4088)),ji=t(3294),ki=(Object(i.orchestrator)(Qr,(function(e){return Object(I.c)(void 0,void 0,void 0,(function(){var n,t,r,i,a,o,c,u,l,v,m,O,j,k;return Object(I.f)(this,(function(p){switch(p.label){case 0:return n=e.rowKeys,t=e.originalTableViewId,r=e.destinationFolderId,i=e.parentFolderId,a=e.actionSource,o=Object(f.E)(n,t),c=Object(d.a)(o),u=Object(f.J)(),Object(fe.s)(s.a.moveItems.name(n,r,u,a),s.a.moveItems.customData(n,r,u,a)),Ae(c,r),Object(b.a)(c,i,"Move"),[4,z.b()];case 1:p.sent(),l=o.map((function(e){return{Id:e}})),p.label=2;case 2:return p.trys.push([2,7,,8]),[4,Object(Xe.a)(o,Object(Be.a)(r),!0)];case 3:return v=p.sent(),(m=(null===(k=v.ResponseMessages)||void 0===k?void 0:k.Items)?v.ResponseMessages.Items[0]:null)&&"Success"==m.ResponseClass?[4,Object(Oi.a)(l,"HardDelete",null)]:[3,5];case 4:return O=p.sent(),ki(u,n),"Success"!==O[0].ResponseClass?(Object(ji.a)(u),Object(me.j)(r)):Te(o.length,r,!1),[3,6];case 5:ki(u,n),Object(ji.a)(u),Object(me.j)(r),p.label=6;case 6:return[3,8];case 7:return j=p.sent(),jr.d("Shared Folder move item action failed : "+JSON.stringify(j)),[3,8];case 8:return[2]}}))}))})),function(e,n){var t=e.tableQuery.folderId;wr.a.removeRowsFromTombstone(n,t)}),pi=(Object(i.orchestrator)(zr,(function(e){return Object(I.c)(void 0,void 0,void 0,(function(){var n,t,r,i,a,o,c,u,s;return Object(I.f)(this,(function(d){switch(d.label){case 0:n=e.rowKeys,t=e.originalTableView,r=e.destinationFolderId,i=n.map((function(e){return Object(f.i)(e,t.id)})),a=Object(f.E)(n,t.id),xe(n,t,r),Object(Me.a)(a,t,"Move"),d.label=1;case 1:return d.trys.push([1,6,,7]),[4,en(i,r,t.tableQuery.folderId)];case 2:return(o=d.sent())&&"Success"==o.ResponseClass?(c=Object(E.b)(t),[4,er.c.invokeDeleteConversationMutation(i,Object(f.l)(t),"HardDelete",c)]):[3,4];case 3:return u=d.sent(),ki(t,n),u.success?Te(i.length,r,!1):(Object(ji.a)(t),Object(me.j)(r)),[3,5];case 4:ki(t,n),Object(ji.a)(t),Object(me.j)(r),d.label=5;case 5:return[3,7];case 6:return s=d.sent(),jr.d("Shared Folder move conversation action failed : "+JSON.stringify(s)),[3,7];case 7:return[2]}}))}))})),t(14091));function hi(e,n){if(Object(se.h)().UserOptions.ShowNotificationBar){var t=n?Object(S.b)(pi.a):Object(S.b)(pi.b),r=Object(ge.j)();Ie.e.importAndExecute("scheduleNotification","MailModuleNotificationBarHost",t,{icon:"Clock",primaryActionText:e?Object(S.b)(ye.a):null,minWidth:r.minWidth,maxWidth:r.maxWidth,notificationCallback:function(e){e===Ie.a.PrimaryActionClicked&&z.f.importAndExecute("NotificationBar")}})}}var yi={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ScheduleConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scheduleReturnTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"scheduleConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"scheduleReturnTime"},value:{kind:"Variable",name:{kind:"Name",value:"scheduleReturnTime"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}},{kind:"Field",name:{kind:"Name",value:"undoRequestId"}}]}}]}}]},gi={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UndoScheduleConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"undoScheduleConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]},Ii=Object(r.d)("ScheduleConversation",s.a.scheduleItems)((function(e,n,t,r){return Object(I.c)(this,void 0,void 0,(function(){var t,i,a,o,c,u,s,d,l=this;return Object(I.f)(this,(function(b){switch(b.label){case 0:return t=n.id,0==(i=Object(f.h)(e,t,(function(e){return!!e}))).length?[2,Promise.resolve()]:(a=Object(f.E)(i,t),o=i.map((function(e){return Object(f.i)(e,t)})),c=1===n.tableQuery.type?i.map((function(e){return f.b.getParentFolderId(e,n)}))[0]:n.tableQuery.folderId,u=Object(jt.a)("scheduled"),[4,(s=c===u)?z.b():z.c()]);case 1:return b.sent(),hi(!s,r),s||Object(Me.a)(a,n,"Snooze"),d=function(e,n,t){var r;return Object(I.c)(this,void 0,void 0,(function(){var i,a;return Object(I.f)(this,(function(o){switch(o.label){case 0:return i=e.map((function(e){return{id:e.conversationId}})),[4,Object(Ee.a)()];case 1:return[4,o.sent().mutate({variables:{conversations:i,folderId:n,scheduleReturnTime:t?Object(vt.ub)(t):null},mutation:yi})];case 2:return a=o.sent(),[2,null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.scheduleConversation]}}))}))}(o,c,r),s||z.a((function(){return Object(I.c)(l,void 0,void 0,(function(){var e;return Object(I.f)(this,(function(n){switch(n.label){case 0:return[4,d];case 1:return(e=n.sent()).success?[4,Si(o,u,e.undoRequestId)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2,Promise.resolve()]}}))}))}),n.serverFolderId,d),[2,Object(m.c)(d,i,n.serverFolderId,n,!1,!0)]}}))}))}));function Si(e,n,t){var r;return Object(I.c)(this,void 0,void 0,(function(){var i,a;return Object(I.f)(this,(function(o){switch(o.label){case 0:return i=e.map((function(e){return{id:e.conversationId}})),[4,Object(Ee.a)()];case 1:return[4,o.sent().mutate({variables:{conversations:i,folderId:n,undoRequestId:t},mutation:gi})];case 2:return a=o.sent(),[2,null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.undoScheduleConversation]}}))}))}var wi=t(8184),Ni=t(8185),Ti=t(6145);function Ci(e,n){var t=function(e,n){return Object(wi.a)({MessageAction:Object(Ni.a)({Action:n?"Schedule":"Unschedule",ScheduleReturnTime:n?Object(vt.ub)(n):null}),Ids:e.map((function(e){return Object(_.a)({Id:e})}))})}(e,n);return Object(Ti.a)({Header:Object(q.b)(),Body:t}).then((function(e){return e.Body.ResponseMessages.Items}))}var Ai=Object(r.d)("scheduleItems",s.a.scheduleItems)((function(e,n,t,r){return Object(I.c)(this,void 0,void 0,(function(){var t,i,a,o,c,u=this;return Object(I.f)(this,(function(s){switch(s.label){case 0:return 0===(t=Object(f.E)(e,n.id)).length?[2,Promise.resolve()]:(i=1===n.tableQuery.type?e.map((function(e){return f.b.getParentFolderId(e,n)}))[0]:n.tableQuery.folderId,[4,(a="scheduled"===Object(we.a)(i))?z.b():z.c()]);case 1:return s.sent(),hi(!a,r),a||(o=Object(d.a)(t),Object(b.a)(o,i,"Snooze")),c=Ci(t,r),a||z.a((function(){return Object(I.c)(u,void 0,void 0,(function(){var e,n,t,r,i,a,o;return Object(I.f)(this,(function(u){switch(u.label){case 0:return e=[],[4,c];case 1:n=u.sent();try{for(t=Object(I.k)(n),r=t.next();!r.done;r=t.next())"Success"===(i=r.value).ResponseClass&&e.push(i.Item.ItemId.Id)}catch(e){a={error:e}}finally{try{r&&!r.done&&(o=t.return)&&o.call(t)}finally{if(a)throw a.error}}return e.length>0?[4,Ci(e)]:[3,3];case 2:u.sent(),u.label=3;case 3:return[2,Promise.resolve()]}}))}))}),n.serverFolderId),[2,c.then((function(e){return Object(O.a)(e)})).catch((function(e){return Promise.reject(e)}))]}}))}))})),xi=t(730);Object(i.orchestrator)(y,(function(e){var n=e.rowKeys,t=e.actionSource,r=e.scheduleReturnTime,i=e.tableViewId,a=Object(f.M)().tableViews.get(i);Object(C.d)("Snooze",null,{rowKeys:n});var o=r;if(void 0!==o){var c=Object(vt.ac)(o),u=Object(vt.ac)(Object(xi.i)());(Object(vt.Hb)(c,u)||Object(vt.Lb)(c,u))&&(o=Object(vt.h)(u,1))}switch(a.tableQuery.listViewType){case 0:return void Ii(n,a,t,o);case 1:return void Ai(n,a,t,o);default:throw new Error("scheduleRows: Invalid listView type")}})),Object(i.mutator)(o,(function(e){e.junkEmailConfiguration.TrustedSendersAndDomains.push(e.mailbox.EmailAddress)}));var Ri=t(6044),Fi=t(6045);Object(i.orchestrator)(ei.d,(function(e){"ReadingPaneInfoBar"===e.unsubscribeSourceType&&(e.responseType===ei.a.Success?e.completedCallback&&e.completedCallback():Object(pn.b)(Object(S.b)(Fi.a),Object(S.b)(Ri.a),!1,{hideCancelButton:!0}))})),Object(i.orchestrator)(Gr,(function(e){var n=e.tableViewId,t=e.conversationId,r=f.ab.tableViews.get(n);if(Object(f.S)(r)){var i=Object(f.G)([t],r);if(0===i.length)return;wr.a.add(i,r,4)}}));Object(i.orchestrator)(cr,(function(e){return Object(I.c)(void 0,void 0,void 0,(function(){var n;return Object(I.f)(this,(function(t){switch(t.label){case 0:return[4,ii()];case 1:return n=t.sent(),e.domains.forEach((function(e){-1===n.BlockedSendersAndDomains.indexOf(e)&&n.BlockedSendersAndDomains.push(e)})),oi(n),[2]}}))}))})),t.d(n,"addMailboxToSafeSenders",(function(){return a})),t.d(n,"deleteMailListRows",(function(){return c.a})),t.d(n,"restoreMailListRows",(function(){return k})),t.d(n,"deleteItems",(function(){return p.a})),t.d(n,"deleteItemsBasedOnNodeOrThreadIds",(function(){return h})),t.d(n,"scheduleRows",(function(){return y})),t.d(n,"toggleRowsFlagState",(function(){return de})),t.d(n,"setMailListRowsFlagState",(function(){return ce})),t.d(n,"setItemsFlagStateFromItemIds",(function(){return ae})),t.d(n,"moveMailListRows",(function(){return Ye})),t.d(n,"copyMailListRows",(function(){return nn})),t.d(n,"moveItemsFromItemIds",(function(){return Qe})),t.d(n,"moveItemsBasedOnNodeIds",(function(){return rn})),t.d(n,"archiveMailListRowsFromTable",(function(){return an})),t.d(n,"toggleRowPinnedState",(function(){return mn})),t.d(n,"markRowsPinnedUnpinned",(function(){return On})),t.d(n,"markRowsAsPhishingFromTable",(function(){return Cn})),t.d(n,"markItemAsPhishingFromReadingPane",(function(){return An})),t.d(n,"restoreConversations",(function(){return u.a})),t.d(n,"moveMailListRowsToFocusedOrOther",(function(){return Vn})),t.d(n,"alwaysMoveRowToFocusedOrOther",(function(){return Wn})),t.d(n,"unsubscribeEmail",(function(){return et})),t.d(n,"unsubscribeEmailV2",(function(){return tt})),t.d(n,"sweepConversations",(function(){return bt})),t.d(n,"emptySearchTableView",(function(){return ft})),t.d(n,"emptyTableView",(function(){return gt})),t.d(n,"likeItem",(function(){return At})),t.d(n,"reactToItem",(function(){return Mt})),t.d(n,"markRowsJunkNotJunkFromTable",(function(){return Qt})),t.d(n,"markItemsJunkNotJunkBasedOnNodeIds",(function(){return zt})),t.d(n,"markItemJunkNotJunkFromReadingPane",(function(){return Yt})),t.d(n,"onKeyboardMarkAsJunkNotJunk",(function(){return Zt})),t.d(n,"onKeyboardToggleFlagState",(function(){return Xt})),t.d(n,"onKeyboardDelete",(function(){return $t})),t.d(n,"blockLastSendersFromTable",(function(){return pr})),t.d(n,"blockLastSenderFromReadingPane",(function(){return yr})),t.d(n,"addCategoriesFromTable",(function(){return _r})),t.d(n,"removeCategoriesFromTable",(function(){return Br})),t.d(n,"clearCategoriesFromTable",(function(){return Lr})),t.d(n,"translateFromTable",(function(){return Hr})),t.d(n,"toggleIgnoreConversations",(function(){return Kr})),t.d(n,"moveSharedFolderItems",(function(){return Qr})),t.d(n,"moveSharedFolderConversations",(function(){return zr})),t.d(n,"onRemoveMeeting",(function(){return Gr})),t.d(n,"dismissNudge",(function(){return Yr.a})),t.d(n,"removeSpotlight",(function(){return Zr}))},64:function(e,n,t){"use strict";var r,i,a,o;t.d(n,"c",(function(){return r})),t.d(n,"e",(function(){return i})),t.d(n,"d",(function(){return a})),t.d(n,"b",(function(){return o})),t.d(n,"a",(function(){return c})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(r||(r={})),function(e){e[e.January=0]="January",e[e.February=1]="February",e[e.March=2]="March",e[e.April=3]="April",e[e.May=4]="May",e[e.June=5]="June",e[e.July=6]="July",e[e.August=7]="August",e[e.September=8]="September",e[e.October=9]="October",e[e.November=10]="November",e[e.December=11]="December"}(i||(i={})),function(e){e[e.FirstDay=0]="FirstDay",e[e.FirstFullWeek=1]="FirstFullWeek",e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(a||(a={})),function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.WorkWeek=3]="WorkWeek"}(o||(o={}));var c=7},730:function(e,n,t){"use strict";var r=t(2),i=Object(r.action)("initializeOwaObservableDateTime"),a=Object(r.action)("observableNowChanged"),o=Object(r.action)("observableTodayChanged"),c=t(5),u=t(14),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0}),d=Object(u.computed)((function(){return Object(c.nc)(s().now)})),l=function(){return d.get()},b=Object(u.computed)((function(){return Object(c.nc)(s().today)})),f=function(){return b.get()},v=function(e){return Object(c.Hb)(e,l())},m=function(e){return Object(c.Fb)(e,l())},O=function(e){return k(e,c.Hb)},j=function(e){return k(e,c.Ib)},k=function(e,n){return n(Object(c.Yb)(Object(c.nc)(e)),f())};function p(e){if(!e)return"";var n=Object(c.nc)(e);return function(e,n){var t=Object(c.Yb)(e);if(Object(c.Jb)(t,n))return c.ab;var r=function(e){return Object(c.Ob)(t,Object(c.e)(n,-e),n)};if(r(3))return c.ib;if(r(30))return c.hb;return c.Y}(n,f())(n)}function h(e){if(!e)return"";var n=Object(c.nc)(e);return function(e,n){var t=Object(c.Yb)(e);if(Object(c.Jb)(t,n))return c.T;return c.U}(n,f())(n)}function y(e){return e?function(e,n){var t=Object(c.Yb)(e);return Object(c.Jb)(t,n)?Object(c.ab)(e):g(t,n,2)?Object(c.lb)(e):g(t,n,7)?Object(c.H)(Object(c.bb)(e),Object(c.ab)(e)):Object(c.H)(Object(c.J)(e),Object(c.ab)(e))}(Object(c.nc)(e),f()):""}function g(e,n,t){return Object(c.Ob)(e,Object(c.e)(n,-t),n)}var I=Object(r.action)("updateTimes"),S=Object(r.action)("setNow"),w=Object(r.action)("setToday",(function(e){return{today:e}}));Object(r.mutator)(S,(function(){s().now=Object(c.lc)()})),Object(r.mutator)(w,(function(e){var n=e.today;s().today=n}));var N=t(21),T=t(79),C=!1;Object(r.orchestrator)(i,(function(){if(I(),!C){var e=Object(c.Rb)(),n=Object(c.ac)(Object(c.h)(e,1)),t=Object(c.w)(n,e);setTimeout((function(){return setInterval(I,N.g)}),t),document&&document.addEventListener("visibilitychange",I),C=!0}})),Object(r.orchestrator)(T.l,(function(){I()})),Object(r.orchestrator)(I,(function(){S();var e=Object(c.Ab)(Object(c.mc)()),n=s().today!=e;n&&w(e),a(),n&&o()})),t.d(n,"d",(function(){return i})),t.d(n,"j",(function(){return a})),t.d(n,"l",(function(){return o})),t.d(n,"i",(function(){return l})),t.d(n,"k",(function(){return f})),t.d(n,"g",(function(){return v})),t.d(n,"e",(function(){return m})),t.d(n,"f",(function(){return O})),t.d(n,"h",(function(){return j})),t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return h})),t.d(n,"c",(function(){return y}))},7411:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("ON_BULK_ACTION_STOPPED",(function(e){return{serverFolderId:e}}))},754:function(e){e.exports=JSON.parse('{"a":"Wea"}')},7769:function(e,n,t){"use strict";var r=t(4469),i=t(5194),a=t(183),o=Object(a.action)("setSweepOptionType")((function(e,n){void 0===n&&(n={sweepStore:r.a}),n.sweepStore.sweepOptionType=e})),c=t(6),u=t(23);var s=Object(a.action)("setSweepRequestStatus")((function(e,n){void 0===n&&(n={sweepStore:r.a});var t,i,a,o=n.sweepStore;o.isSweepDialogShown&&(t=o.sweepRequestStatus,a="Invalid state transition {0} to {1}",1==(i=e)&&0!=t&&u.d(Object(c.c)(a,t,i)),2!=i&&3!=i||1==t||u.d(Object(c.c)(a,t,i)),o.sweepRequestStatus=e)})),d=Object(a.action)("showHideSweepDialog")((function(e,n){void 0===n&&(n={sweepStore:r.a}),n.sweepStore.isSweepDialogShown=e,e||(n.sweepStore.sweepOptionType=i.a.All,n.sweepStore.sweepRequestStatus=0)})),l=t(31);t.d(n,"b",(function(){return f})),t.d(n,"c",(function(){return v})),t.d(n,"g",(function(){return r.a})),t.d(n,"a",(function(){return i.a})),t.d(n,"d",(function(){return o})),t.d(n,"e",(function(){return s})),t.d(n,"f",(function(){return d}));var b=new l.c((function(){return t.e(1040).then(t.bind(null,18487))})),f=new l.b(b,(function(e){return e.onSweepMoveToFolderClicked})),v=new l.b(b,(function(e){return e.setSweepDestinationFolderId}))},7829:function(e,n,t){"use strict";var r=t(33),i=t(1);function a(e,n){var t;return void 0===e||e.__type||(t=e,e=Object(i.a)({__type:"SetMailboxJunkEmailConfigurationRequest:#Exchange"},t)),Object(r.a)("SetMailboxJunkEmailConfiguration",e,n)}t.d(n,"a",(function(){return a}))},815:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(0),i=t(261);function a(e,n){var t=r.useRef(n);return t.current||(t.current=Object(i.a)(e)),t.current}},8186:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(1),i=t(180),a=t(3223);function o(e,n,t){if(void 0===n&&(n=Object(i.b)()),!e||!e.ConversationActions||0===e.ConversationActions.length)throw new Error("ApplyConversationAction requestBody is invalid!");t=t||{};var o=Object(r.a)({},t),c=o.headers?new Headers(o.headers):new Headers;return c.set("X-OWA-ActionSource","ApplyConversationAction_"+e.ConversationActions[0].Action),o.headers=c,Object(a.a)({Header:n,Body:e},o).then((function(e){return e.Body.ResponseMessages.Items[0]})).catch((function(e){return Promise.reject(e)}))}},8187:function(e,n,t){"use strict";t.d(n,"a",(function(){return d})),t.d(n,"b",(function(){return l}));var r=t(9520),i=t(6),a=t(731),o=t(1947),c=t(1955),u=t(5640);function s(e){for(var n={},t=[],o=0;o<e.length;o++){var c=e[o].EmailAddress;if(c){if(Object(u.a)(c))return Object(a.b)(Object(i.c)(Object(i.b)(r.a),c),null,!1,{hideCancelButton:!0}),null;var s=c.toLowerCase();n[s]||(n[s]=!0,t.push(e[o]))}}return t.length>0?t:null}function d(e,n){var t=[];return e.forEach((function(e){var r=o.b.getLastSenderMailbox(e,n);r&&t.push(r)})),s(t)}function l(e){var n=[];return e.forEach((function(e){var t=c.a.items.get(e);t&&Object(o.Y)(t)&&n.push(t.From.Mailbox)})),s(n)}},85:function(e,n,t){"use strict";var r=t(64),i={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn15Mins:9e5,MillisecondsIn20Mins:12e5,MillisecondsIn22Mins:132e4,MillisecondsIn24Mins:144e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,SecondsInOneMinute:60,DaysInOneWeek:7,AllDaysOfWeek:[r.c.Sunday,r.c.Monday,r.c.Tuesday,r.c.Wednesday,r.c.Thursday,r.c.Friday,r.c.Saturday]};n.a=i},859:function(e,n,t){"use strict";function r(e){return e>=200&&e<300}t.d(n,"a",(function(){return r}))},891:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i}));var r=1,i=16},9518:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1951);function i(e){return Object(r.C)(e,"ArchiveMailbox")||Object(r.C)(e,"SharedMailbox")}},9519:function(e){e.exports=JSON.parse('{"a":"_Ab"}')},9520:function(e){e.exports=JSON.parse('{"a":"O1a"}')},984:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(1);function i(e){return Object(r.a)({__type:"TargetFolderId:#Exchange"},e)}},988:function(e,n,t){"use strict";t.d(n,"b",(function(){return i}));var r=t(2),i=Object(r.createStore)("popoutParent",{projections:[],isAvailable:!1}),a=i();n.a=a}}]);
//# sourceMappingURL=owa.MailBoot~TriageAction.js.map
self.scriptsLoaded['owa.MailBoot~TriageAction.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~TriageAction.js'] = (new Date()).getTime();