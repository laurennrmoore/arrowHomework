self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~UpNextV2.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[868],{1004:function(e,t,n){"use strict";var r=n(738),a=n(665),i=n(640),c=n(741),o=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Object(r.a)(t,Object(i.a)(e)),e=Object(a.a)(e);return t}:c.a;t.a=o},1086:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return o}));var r=n(2),a=Object(r.action)("initializeOwaAccountsStore"),i=Object(r.action)("owaConnectedAccountAdded",(function(e,t){return{userIdentity:e,accountProviderType:t}})),c=Object(r.action)("removeAccount",(function(e){return{userIdentity:e}})),o=Object(r.action)("owaAccountStoreInitializationFailed",(function(e,t,n,r){return{userIdentity:e,isRetry:t,accountProvider:n,error:r}}))},1087:function(e,t,n){"use strict";n.d(t,"e",(function(){return"{id}"})),n.d(t,"f",(function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"})),n.d(t,"a",(function(){return"data-custom"})),n.d(t,"c",(function(){return"originalsrc"})),n.d(t,"b",(function(){return"data-loadstatus"})),n.d(t,"d",(function(){return"pending"}))},1090:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=/[\(\[\{][^\)\]\}]*[\)\]\}]/g,a=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,i=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,c=/\s+/g,o=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function u(e,t,n){return e?(e=function(e){return e=(e=(e=(e=e.replace(r,"")).replace(a,"")).replace(c," ")).trim()}(e),o.test(e)||!n&&i.test(e)?"":function(e,t){var n="",r=e.split(" ");return 2===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[1].charAt(0).toUpperCase()):3===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[2].charAt(0).toUpperCase()):0!==r.length&&(n+=r[0].charAt(0).toUpperCase()),t&&n.length>1?n.charAt(1)+n.charAt(0):n}(e,t)):""}},1096:function(e,t,n){"use strict";var r,a=n(2),i=Object(a.createStore)("cacheLoaderStore",{loadedCalendarAccounts:[]});!function(e){e[e.Outlook=0]="Outlook",e[e.OutlookGroup=1]="OutlookGroup",e[e.TeamsCalendars=2]="TeamsCalendars"}(r||(r={}));var c=n(94),o=n(209);function u(e,t){switch(e){case r.Outlook:case r.OutlookGroup:return(t||Object(o.d)().userIdentity)+e.toString();case r.TeamsCalendars:return e.toString();default:return Object(c.a)(e)}}var s=n(57),d=n(24);function l(e,t){var n=u(e,t);return i().loadedCalendarAccounts.some((function(e){return e===n}))}function f(e){return function(e){if(e&&e!==Object(s.b)()){var t=[r.Outlook];return Object(d.i)("cal-multiAccounts-groups")&&t.push(r.OutlookGroup),t}return[r.Outlook,r.OutlookGroup,r.TeamsCalendars]}(e).every((function(t){return l(t,e)}))}var b=Object(a.action)("addToLoadedCalendarAccounts",(function(e){return{calendarAccountData:e}}));Object(a.mutator)(b,(function(e){i().loadedCalendarAccounts.push(e.calendarAccountData)}));var O=n(1283),v=n(23),j=Object(a.action)("calendarCacheInitializedForAccount",(function(e,t){return{calendarEndpointType:e,userId:t}})),p=n(1),m=n(1309),h=n(1323),g=n(1318);var w=n(742),y=Object(w.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(w.a)(1e3)}),I={};function x(e,t){if(t=t||Object(o.d)().userIdentity,l(e,t))return Promise.resolve();var n=u(e,t),a=I[n];if(a)return a.requestPromise;var i=y((function(){return function(e,t){return Object(p.c)(this,void 0,void 0,(function(){return Object(p.f)(this,(function(n){switch(n.label){case 0:switch(e){case r.Outlook:return[3,1];case r.OutlookGroup:return[3,3];case r.TeamsCalendars:return[3,5]}return[3,8];case 1:return[4,Object(m.f)(t)];case 2:return n.sent(),[3,9];case 3:return[4,Object(h.b)(t)];case 4:return n.sent(),[3,9];case 5:return Object(d.i)("cal-showAddTeamsCalendars")?[4,g.d.importAndExecute()]:[3,7];case 6:n.sent(),n.label=7;case 7:return[3,9];case 8:Object(c.a)(e),n.label=9;case 9:return[2]}}))}))}(e,t)})).retriableFunc();return I[n]={requestPromise:i},i.then((function(){b(n),j(e,t)})).catch((function(e){v.d("initializeCalendarsCacheForAccount: failed to initialize calendar cache",e)}))}Object(a.orchestrator)(O.e,(function(e){x(r.Outlook,e.userIdentity),Object(d.i)("cal-multiAccounts-groups")&&x(r.OutlookGroup,e.userIdentity)}));var E=n(374);function k(){return Object(p.c)(this,void 0,void 0,(function(){var e,t,n,a,i,c;return Object(p.f)(this,(function(o){switch(o.label){case 0:return e=x(r.Outlook),t=Object(E.n)().map((function(e){Object(s.i)(e.userIdentity)&&x(r.Outlook,e.userIdentity)})),n=x(r.OutlookGroup),a=x(r.TeamsCalendars),i=Object(p.j)(Object(p.j)([e,n],Object(p.g)(t)),[a]),Object(d.i)("cal-multiAccounts-groups")&&(c=Object(E.n)().map((function(e){Object(s.i)(e.userIdentity)&&x(r.OutlookGroup,e.userIdentity)})),i=i.concat(c)),[4,Promise.all(i)];case 1:return o.sent(),[2]}}))}))}n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return x})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return k}))},1100:function(e,t,n){"use strict";var r;!function(e){e.None="None",e.OwaProxy="OwaProxy",e.ConnectorsProxy="ConnectorsProxy",e.Compose="Compose",e.OwaAndConnectorsProxy="OwaAndConnectorsProxy",e.OwaConnectorsProxyAndCompose="OwaConnectorsProxyAndCompose"}(r||(r={})),t.a=r},11545:function(e,t,n){var r=n(14140),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},12155:function(e,t,n){"use strict";n.r(t);var r=n(2736),a=n(2),i=n(2095),c=n(4959),o=n(860),u=Object(o.f)("UpNextMailCalendarCacheId");function s(){return u.getLockId()}Object(a.orchestrator)(c.d,(function(){var e=Object(c.b)();"DoesNotExist"!==Object(i.d)(s())&&Object(r.i)(e,s())}));function d(){var e=Object(c.b)();Object(r.e)(e,s())}var l=n(1),f=n(9542),b=n(20),O=n(424),v=n(0),j=n(57),p=n(24),m=n(11545),h=n(378).bind(m),g=Object(b.a)((function(e){var t=Object(p.i)("mon-densities");return v.createElement("div",{className:m.upNextEventContainer},e.eventCountString&&v.createElement("div",{className:m.conflictingEventsCount},e.eventCountString),v.createElement(O.a,{className:h(m.eventIconColumn,!t&&m.eventIconColumnSize),iconName:"Event"}),v.createElement("div",{className:h(m.eventDetailsColumn,t&&Object(j.d)())},v.createElement("div",{className:m.eventName},e.eventName),v.createElement("div",{className:m.eventTimeLocationRow},v.createElement("div",{className:m.eventTime},e.timeUntilEvent),e.eventLocation&&v.createElement("div",{className:m.eventLocation},e.eventLocation))))})),w=n(14141),y=n(6),I=n(21),x=n(5),E=n(137),k=n(730),S=59*I.g;function C(e,t){var n=Object(k.i)();if(Object(E.u)(n,e.Start,e.End))return t?Object(y.b)(f.c)+",":Object(y.b)(f.c);var r=Object(x.nc)(e.Start),a=Math.abs(Object(x.Ab)(n)-Object(x.Ab)(r));if(a<=S){var i=Math.ceil(a/I.g);return Object(y.c)(Object(y.b)(w.a),i)}var c=Object(x.Jb)(n,r),o=Object(x.ab)(r);return c?o:Object(y.c)(Object(y.b)(f.f),o)}var A=n(2082);var T=n(1882),D=n(121),_=n(3299),P=n(2363),M=n(514),N=n(2598),R=n(11545),F="UpNext";function L(e,t,n,r,a,i){e.push(v.createElement(g,{key:t,eventCountString:a,eventLocation:r,eventName:n,timeUntilEvent:i}))}var W=Object(b.a)((function(e){var t,n,r=e.upNextEvent,a=r.ItemId,i=e.conflictingEvents.length+1,c=i>1,o=Object(l.j)([r],Object(l.g)(e.conflictingEvents)),u=!c&&a,s=v.useCallback((function(){Object(P.b)()?function(e){Object(D.s)("TnS_UpNextClicked"),e?_.f.importAndExecute(F,e):_.i.importAndExecute(F)}(u):function(e){e?Object(N.a)(e,"Mail_UpNext",null,6):window.open(Object(M.d)())}(u)}),[u]),d=v.useCallback((function(){var e=o.length;n=setTimeout((function(){n&&Object(D.s)("TnS_UpNextHover",[e]),n=null}),300)}),[u]),b=v.useCallback((function(){n=null}),[u]);v.useEffect((function(){Object(D.s)("TnS_UpNext",[o.length],{sessionSampleRate:10})}),[u]);for(var O=[],j=i>3,p=j?2:o.length,m=0;m<p;m++){var h=o[m],g=null===(t=h.Location)||void 0===t?void 0:t.DisplayName,w=c&&Object(y.c)(Object(y.b)(f.a),m+1,i),I=C(h,!!g);L(O,h.ItemId.Id,Object(A.c)(h),g,w,I)}if(j){var x=i-p;L(O,"viewAll",Object(y.b)(f.g),null,Object(y.c)(Object(y.b)(f.d),x),C(r,!1))}var E=R.allEventsContainer;2==i?E=R.allEventsContainerTwoEvents:i>2&&(E=R.allEventsContainerThreeOrMoreEvents);var k=c?void 0:Object(A.e)(r),S=c?function(e,t,n){var r=[];r.push(Object(y.c)(Object(y.b)(f.b),t));for(var a=0;a<e.length;a++){var i=e[a];r.push(Object(y.c)(Object(y.b)(f.e),a+1,t)),r.push(Object(A.a)(i))}return n&&r.push(Object(y.b)(f.g)),r.join(" ")}(o.slice(0,p),o.length,j):Object(A.a)(r);return v.createElement(T.a,{ariaLabel:S,className:R.upNextEventButtonContainer,"data-is-focusable":!0,"data-automation-id":"UpNext",onClick:s,role:"menuitem",title:k,styles:e.containerStyle},v.createElement("div",{className:E,onMouseEnter:d,onMouseLeave:b},O))}));var G=Object(b.a)((function(e){var t="DoesNotExist"!==Object(i.d)(s())?Object(r.c)(s()):null;if(!t||!t.upNextEvent)return null;var n=t.conflictingEvents;return v.createElement(W,{upNextEvent:t.upNextEvent,conflictingEvents:n,containerStyle:e.containerStyle})}));function Y(){return!!Object(r.b)(s())}n.d(t,"initializeUpNextV2",(function(){return d})),n.d(t,"UpNextV2",(function(){return G})),n.d(t,"isUpNextEventReady",(function(){return Y}))},1255:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var r="A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴऀ-५ॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞭꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ0-9٠-٩۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯෦-෯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９",a=new RegExp("^(["+r+"!#$%&'*+/=?^_`{|}~-](?:["+r+".!#$%&'*+/=?^_`{|}~-]*["+r+"!#$%&'*+/=?^_`{|}~-])?)(?=@)"),i=new RegExp('^("['+r+'.!#$%&\'*+\\/=?^_`{|}~\\-(),:;<>@[\\\\\\]" ]*")(?=@)'),c=new RegExp("^["+r+"-]+(?:\\.["+r+"-]+)*$"),o=/[^\\]"/,u=/^[A-Za-z0-9_-]+:.*$/,s=function(e){var t=e.match(a);if(t)return-1!==t[0].indexOf("..")?null:t[0];var n=e.match(i);if(n){var r=o.exec(n[0]);return r&&r.index!==n[0].length-2?null:n[0]}return null};function d(e){if(!e)return!1;var t=s(e);return!!t&&!!e.substring(t.length+1).match(c)}function l(e){return u.test(e)}function f(e){return d(e)||l(e)}},1262:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1080),a=n(57);function i(){var e=!0;if(Object(a.s)()){var t=Object(r.f)(r.c.ExternalImages);e=null===t.externalImagesSelectedOption||0===t.externalImagesSelectedOption}else{var n=Object(a.h)().PolicySettings;e=void 0===n.ExternalImageProxyEnabled||n.ExternalImageProxyEnabled}return e}},1269:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(514);function a(e){var t=e&&e!==window;return Object(r.w)()||t}},1271:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(988);function a(e){return Object(r.b)().projections.filter((function(t){return t.tabId==e}))[0]}},1272:function(e,t,n){"use strict";var r=n(1),a=n(67),i=600,c=800,o=8,u=25,s={location:!1,menubar:!1,resizable:!0,scrollbars:!1,status:!1,toolbar:!1},d=-1;function l(e,t,n){try{t=function(e){var t=u*(1+(d=(d+1)%o)),n={left:window.screenX+t,top:window.screenY+t,height:Math.max(25*Math.pow(window.innerHeight,.5),i),width:Math.max(8*Math.pow(window.innerWidth,2/3),c)};return Object(r.a)(Object(r.a)(Object(r.a)({},s),n),e)}(t);var l=(n||window).open(e,"_blank",function(e){return Object.getOwnPropertyNames(e).map((function(t){return t+"="+("boolean"==typeof(n=e[t])?n?"1":"0":n?String(n):void 0);var n})).join(",")}(t));return(Object(a.e)()||Object(a.f)())&&l.moveTo(t.left,t.top),l}catch(e){return null}}var f=n(988);var b=n(1297),O=n(44),v=n(982),j=n(121);t.a=Object(O.d)("addPopoutV2",{name:"PopoutAddPopout",customData:function(e,t,n,r,a,i){return[(t||"").split("/")[0],i]}})((function(e,t,n,r,a,i,c){var o=function(e){var t=null,n=void 0,r=null,a=null;return e&&(!function(e){return void 0!==e.deeplinkData||!!e.projectionTabId}(e)?n=e:(n=e.deeplinkData,Object(f.b)().isAvailable&&(t=e.projectionTabId||null),r=e.projectionTargetWindow,a=e.projectionParentWindow)),{deeplinkCallback:void 0===n?function(){return Promise.resolve(null)}:"function"==typeof n?n:function(){return Promise.resolve(n)},projectionTabId:t,projectionTargetWindow:r,projectionParentWindow:a}}(n),u=o.deeplinkCallback,s=o.projectionTabId,d=o.projectionTargetWindow,O=o.projectionParentWindow,p=new j.b(s?"PopoutProjectionPerf":"PopoutDeeplinkPerf"),m=s?"about:blank":Object(b.a)(e,t,{skipOptinCheck:a,urlParameters:c}),h=d||l(m,r,O);h&&v.h.import().then((function(t){return t(e,h,s,u,p)}))}))},1283:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return u}));var r=n(1086);n.d(t,"e",(function(){return r.c})),n.d(t,"d",(function(){return r.b}));var a=n(31),i=new a.c((function(){return n.e(899).then(n.bind(null,1881))})),c=new a.a(i,(function(e){return e.initializeOwaAccountsStore})),o=new a.a(i,(function(e){return e.initializeOwaConnectedAccount})),u=new a.a(i,(function(e){return e.removeOWAConnectedAccount}))},1290:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1255);function a(e){return Object(r.a)(e.EmailAddress)||e.ItemId&&"PrivateDL"==e.MailboxType}},1291:function(e,t,n){"use strict";function r(e){var t;return null===(t=null==e?void 0:e.ItemId)||void 0===t?void 0:t.Id}n.d(t,"a",(function(){return r}))},1293:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"GetCalendarViewRequest:#Exchange"},e)}},1295:function(e,t,n){"use strict";var r=n(33),a=n(1);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.a)({__type:"GetCalendarViewJsonRequest:#Exchange"},n)),Object(r.a)("GetCalendarView",e,t)}n.d(t,"a",(function(){return i}))},1297:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),a=n(514),i=n(817),c="version";function o(e,t,n){var o;void 0===n&&(n={});var u=n.isStandalone?{}:((o={})[i.a]=i.b,o[c]=Object(r.r)(),o),s=n.urlParameters||{};return Object.keys(s).map((function(e){u[e]=s[e]})),Object(a.q)(e,t,n.skipOptinCheck,u)}},1307:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return u}));var r=n(1),a=n(209),i=n(982),c={width:1095,height:640};function o(e,t,n,i,c){if(e){var o=Object(a.d)();u(Object(r.a)({ItemId:Object(r.a)({mailboxInfo:o},e)},t),n,!!t,i||0,void 0,void 0,c)}}function u(e,t,n,r,a,o,u){Object(i.c)("calendar","compose",{event:e,composeEntrySource:t,shouldDuplicate:a,eventScope:o,eventHasUpdates:n,includeFluidOnPopout:u},c)}},1310:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(33),a=n(1314);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("GetUserUnifiedGroups",e,t)}},1311:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"GetUserUnifiedGroupsRequest:#Exchange"},e)}},1312:function(e,t,n){"use strict";var r=n(740),a=n(1004),i=n(584);t.a=function(e){return Object(r.a)(e,i.a,a.a)}},1314:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"GetUserUnifiedGroupsJsonRequest:#Exchange"},e)}},1315:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},1318:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}));var r=n(31),a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(19),n.e(25),n.e(840)]).then(n.bind(null,1883))})),i=new r.a(a,(function(e){return e.initializeSelectedTeamsCalendars})),c=new r.a(a,(function(e){return e.getSelectedTeamsCalendars})),o=new r.a(a,(function(e){return e.createCalendarFromTeamsChannel})),u=new r.a(a,(function(e){return e.createCalendarCacheInfoFromTeamsChannel}))},1320:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n(613),a=n(1295),i=n(1293),c=n(984),o=n(5),u=n(180),s=n(1244),d=n(419),l=n(581),f="X-OWA-ExplicitLogonUser",b="X-AnchorMailbox",O=6,v=null;function j(e,t,n,j,p,m){var h;void 0===n&&(n=Object(s.a)("calendar"));var g=null;return p?g={headers:(h={},h[f]=p,h[b]=p,h)}:j&&(g=Object(d.a)(j.mailboxInfo)),v||(v=Object(l.a)(O)),v.add((function(){var s={Header:Object(u.b)(),Body:Object(i.a)({CalendarId:Object(c.a)({BaseFolderId:Object(r.a)({Id:n})}),RangeStart:Object(o.rb)(e),RangeEnd:Object(o.rb)(t),IncludeDeclinedMeetings:m})};return Object(a.a)(s,g).then((function(e){return e.Body}))}))}},1321:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"GetCalendarEventRequest:#Exchange"},e)}},1323:function(e,t,n){"use strict";var r=n(1),a=n(121),i=n(76),c="Groups",o=n(183),u=n(209),s=n(180),d=n(419),l=n(1310),f=n(1311),b=n(1325),O=n(6);function v(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n,a;return Object(r.f)(this,(function(r){switch(r.label){case 0:return 4,(t=[]).push({FilterType:1,SortType:4,SortDirection:"Descending"}),t.push({FilterType:2,SortType:4,SortDirection:"Descending"}),(n=Object(s.b)()).RequestServerVersion="V2018_01_08",a=Object(d.a)(Object(u.d)(e)),[4,Object(l.a)({Header:n,Body:Object(f.a)({RequestedGroupsSets:t})},a)];case 1:return[2,r.sent()]}}))}))}var j=Object(o.action)("getGroupCalendarsService")((function(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,v(e)];case 1:return null!=(t=n.sent())&&t.Body.GroupsSets&&t.Body.GroupsSets.length>0?[2,p(t.Body.GroupsSets,e)]:[2,null]}}))}))}));function p(e,t){var n=[],r=[],a=Object(i.r)(t,c);if(e.forEach((function(e){e.Groups.forEach((function(e){var i,c=e.SmtpAddress.toLowerCase(),o={type:"GroupMailbox",userIdentity:t,mailboxSmtpAddress:c},u={calendarId:{itemId:{Id:c},mailboxInfo:o},CalendarColor:-1,CalendarName:e.DisplayName,OwnerEmailAddress:c,OwnerName:e.DisplayName,IsGroupMailboxCalendar:!0,IsGeneralScheduleCalendar:!0,ParentGroupId:a,CanShare:!1,DistinguishedFolderId:c,__typename:"LinkedCalendarEntry"};n.push({entry:u,groupMailboxGuid:null===(i=e.MailboxGuid)||void 0===i?void 0:i.toLowerCase()});var s={id:{id:c,mailboxInfo:o},calculatedFolderId:c,displayName:e.DisplayName,colorScheme:null};r.push(s)}))})),r.length>0){var o={calendarGroupId:{itemId:{Id:a},mailboxInfo:{type:"GroupMailbox",userIdentity:t,mailboxSmtpAddress:t}},serverGroupId:a,GroupName:Object(O.b)(b.a),GroupType:3};return{groupCalendars:n,calendarGroup:o,calendars:r}}return null}var m=n(426);var h=n(197),g=Object(o.action)("getGroupCalendars")((function(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,j(e)];case 1:return t=r.sent(),null!=(n=Object(h.a)(e)?function(e){var t,n=Object(i.k)().filter((function(e){return Object(m.f)(e)}));if(0==n.length)return e;for(var r=[],a=[],c=function(t){var i=e.groupCalendars[t];n.some((function(e){var t,n,r=e;return(null===(t=r.OwnerEmailAddress)||void 0===t?void 0:t.toLowerCase())===i.entry.calendarId.mailboxInfo.mailboxSmtpAddress&&(null===(n=r.SharedOwnerMailboxGuid)||void 0===n?void 0:n.toLowerCase())===i.groupMailboxGuid}))||(r.push(i),a.push(e.calendars[t]))},o=0;o<(null===(t=null==e?void 0:e.groupCalendars)||void 0===t?void 0:t.length);o++)c(o);return(null==r?void 0:r.length)>0?{groupCalendars:r,calendarGroup:e.calendarGroup,calendars:a}:null}(t):t)&&null!=n.groupCalendars?(n.groupCalendars.forEach((function(e){Object(i.b)(e.entry)})),Object(i.a)(n.calendarGroup),[2,{group:n.calendarGroup,calendars:n.calendars}]):[2,null]}}))}))})),w=n(57),y=Object(o.action)("initializeGroupCalendars")((function(e,t){var n;return Object(r.c)(this,void 0,void 0,(function(){var o,s,d,l,f,b;return Object(r.f)(this,(function(r){switch(r.label){case 0:o=new a.b("initializeGroupCalendars"),e||(e=Object(u.d)().userIdentity),s=!!(null===(n=Object(w.i)(e))||void 0===n?void 0:n.GroupsEnabled),d=Object(i.r)(e,c),l=!Object(i.s)().some((function(t){return t.serverGroupId===d&&t.calendarGroupId.mailboxInfo.userIdentity===e})),f=s&&(t||l),o.addCustomData({issueServiceCall:f,GroupsEnabled:s,featureEnabled:!0,refresh:t,initialLoad:l}),r.label=1;case 1:return r.trys.push([1,4,,5]),f?[4,g(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return o.end(),[3,5];case 4:throw b=r.sent(),o.endWithError("ServerError",Error(b)),b;case 5:return[2]}}))}))})),I=n(2),x=n(23),E=n(992),k=null;Object(I.orchestrator)(i.C,(function(e){var t=e.payload,n=t.id,r=t.EventType,a=t.Group;x.g.info(n+": "+r+", "+(null==a?void 0:a.SmtpAddress)),"Reload"!=r&&(k||(k=Object(E.a)(y.bind(null,Object(u.d)().userIdentity,!0),2e3)),k())})),n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return c}))},1324:function(e,t,n){"use strict";var r=n(33),a=n(1);function i(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.a)({__type:"GetCalendarEventJsonRequest:#Exchange"},n)),Object(r.a)("GetCalendarEvent",e,t)}n.d(t,"a",(function(){return i}))},1325:function(e){e.exports=JSON.parse('{"a":"sZa"}')},1352:function(e,t,n){"use strict";var r;function a(e){return r=null==e?void 0:e.getCalendarFolders,e}function i(){var e=r;return r=void 0,e}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}))},137:function(e,t,n){"use strict";var r=n(618),a=n(5);function i(){var e=Object(a.Rb)(),t=Object(a.f)(Object(a.mc)(),12),n=Object(a.f)(Object(a.mc)(),18),r="Evening";return Object(a.y)(t,e)>0?r="Morning":Object(a.y)(n,e)>0&&(r="Afternoon"),r}function c(e,t,n){return Object(a.Ob)(e,t,n)}var o=n(85);function u(e,t){return function(e){var t=e%o.a.SecondsInOneMinute;return e-t+o.a.SecondsInOneMinute}(Object(a.y)(e,t))}var s=15*o.a.SecondsInOneMinute;function d(e,t){return u(e,t)<=s}var l=n(64),f=function(e,t,n){switch(n){case l.d.FirstFullWeek:return b(e,t,o.a.DaysInOneWeek);case l.d.FirstFourDayWeek:return b(e,t,4);default:return function(e,t){var n=O(e)-1,r=(Object(a.ob)(e)-n%o.a.DaysInOneWeek-t+2*o.a.DaysInOneWeek)%o.a.DaysInOneWeek;return Math.floor((n+r)/o.a.DaysInOneWeek+1)}(e,t)}};function b(e,t,n){var r=O(e)-1,i=Object(a.ob)(e)-r%o.a.DaysInOneWeek,c=O(Object(a.nc)(Object(a.Db)(e)-1,l.e.December,31))-1,u=(t-i+2*o.a.DaysInOneWeek)%o.a.DaysInOneWeek;0!==u&&u>=n&&(u-=o.a.DaysInOneWeek);var s=r-u;return s<0&&(0!==(u=(t-(i-=c%o.a.DaysInOneWeek)+2*o.a.DaysInOneWeek)%o.a.DaysInOneWeek)&&u+1>=n&&(u-=o.a.DaysInOneWeek),s=c-u),Math.floor(s/o.a.DaysInOneWeek+1)}function O(e){for(var t=Object(a.yb)(e),n=Object(a.Db)(e),r=0,i=0;i<t;i++)r+=v(i+1,n);return r+=Object(a.mb)(e)}function v(e,t){return Object(a.pb)(Object(a.nc)(t,e,0))}function j(e){for(var t=[],n=0;n<o.a.DaysInOneWeek;n++)e&1<<n&&t.push(n);return t}function p(e,t,n){for(var i=[],c=n.sort((function(e,t){var n=Object(a.p)(e.start,t.start);return 0!==n?n:Object(a.p)(e.end,t.end)})),o=Object(a.Yb)(e),u=0;Object(a.p)(o,t)<0&&u<c.length;){var s={start:o,end:Object(a.A)(o)},d=Object(r.h)(c[u],s,!1);d<=0?(0===d&&i.push(o),o=Object(a.e)(o,1)):u++}return i}n.d(t,"h",(function(){return r.g})),n.d(t,"g",(function(){return r.f})),n.d(t,"n",(function(){return r.k})),n.d(t,"d",(function(){return r.c})),n.d(t,"e",(function(){return r.d})),n.d(t,"s",(function(){return r.n})),n.d(t,"o",(function(){return r.l})),n.d(t,"p",(function(){return r.m})),n.d(t,"b",(function(){return r.a})),n.d(t,"j",(function(){return r.h})),n.d(t,"c",(function(){return r.b})),n.d(t,"f",(function(){return r.e})),n.d(t,"l",(function(){return r.j})),n.d(t,"k",(function(){return r.i})),n.d(t,"t",(function(){return r.o})),n.d(t,"w",(function(){return i})),n.d(t,"u",(function(){return c})),n.d(t,"v",(function(){return d})),n.d(t,"q",(function(){return u})),n.d(t,"r",(function(){return f})),n.d(t,"a",(function(){return o.a})),n.d(t,"i",(function(){return j})),n.d(t,"m",(function(){return p}))},14140:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'@-webkit-keyframes _3GYWRGGf7P_GI0nsmyJJEq{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@-webkit-keyframes _2qguJkZ4YN-a4-jZornQTp{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@keyframes _3GYWRGGf7P_GI0nsmyJJEq{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@keyframes _2qguJkZ4YN-a4-jZornQTp{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@-webkit-keyframes _1uBAfIo7O7RpspBEYft67J{to{-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes gqklPe3BnRAQGJ-1Nd_Xp{to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes _1uBAfIo7O7RpspBEYft67J{to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes gqklPe3BnRAQGJ-1Nd_Xp{to{-webkit-transform:translateY(0);transform:translateY(0)}}.bquTIlYhtqsZHlrJCQ0ci{font-size:12px;font-weight:400;color:"[theme:themeDark, default:#0D62AA]";cursor:pointer;height:34px;overflow:hidden}html[dir] .bquTIlYhtqsZHlrJCQ0ci{padding:0 8px}._1KWaEy1JwXTPcXePft1XyO,._1Lt2W5uQ7oe52kMFzniHCz,.HpJj1IBE9g7fhlrQQuBva{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-item-align:start;align-self:flex-start;height:34px}.HpJj1IBE9g7fhlrQQuBva{height:68px}html[dir] .HpJj1IBE9g7fhlrQQuBva{-webkit-transform:translateY(0);transform:translateY(0);-webkit-transition:-webkit-transform .3s cubic-bezier(.8,0,.2,1);transition:-webkit-transform .3s cubic-bezier(.8,0,.2,1);transition:transform .3s cubic-bezier(.8,0,.2,1);transition:transform .3s cubic-bezier(.8,0,.2,1),-webkit-transform .3s cubic-bezier(.8,0,.2,1)}._1Lt2W5uQ7oe52kMFzniHCz{height:102px;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;-webkit-animation-play-state:running;animation-play-state:running;-webkit-animation-timing-function:cubic-bezier(.8,0,.2,1);animation-timing-function:cubic-bezier(.8,0,.2,1)}html[dir=ltr] ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:gqklPe3BnRAQGJ-1Nd_Xp;animation-name:gqklPe3BnRAQGJ-1Nd_Xp}html[dir=rtl] ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_1uBAfIo7O7RpspBEYft67J;animation-name:_1uBAfIo7O7RpspBEYft67J}html[dir] .bquTIlYhtqsZHlrJCQ0ci:hover .HpJj1IBE9g7fhlrQQuBva{-webkit-transform:translateY(-34px);transform:translateY(-34px);-webkit-transition-delay:.1s;transition-delay:.1s}.bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-duration:3.6s;animation-duration:3.6s}html[dir=ltr] .bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_2qguJkZ4YN-a4-jZornQTp;animation-name:_2qguJkZ4YN-a4-jZornQTp}html[dir=rtl] .bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_3GYWRGGf7P_GI0nsmyJJEq;animation-name:_3GYWRGGf7P_GI0nsmyJJEq}._1hagGpG7AzPUNXP0Svq92n{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;-ms-flex-item-align:end;align-self:flex-end;height:34px}.Zxu7pq6NX4jIi550qVOsj{font-size:14px;font-weight:400;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;line-height:34px}html[dir=ltr] .Zxu7pq6NX4jIi550qVOsj{padding-right:6px}html[dir=rtl] .Zxu7pq6NX4jIi550qVOsj{padding-left:6px}._3PRzKbmV4xQJvn21aAkCeP{-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}html[dir=ltr] ._3PRzKbmV4xQJvn21aAkCeP{padding-right:8px}html[dir=rtl] ._3PRzKbmV4xQJvn21aAkCeP{padding-left:8px}._2lRj5U7zDS3bSBmfrr_4Qr{font-size:16px}._3wJAY7Lg8iqglCkKc_1xfx,._2KWQkcW6CcNYP-7HUovRXb,._5h5kaMsfWHnnSvF2gbHpv,._3xLd9sljnn8QP_g_E9drtK{overflow:hidden;word-break:break-all}html[dir] ._3wJAY7Lg8iqglCkKc_1xfx,html[dir] ._2KWQkcW6CcNYP-7HUovRXb,html[dir] ._5h5kaMsfWHnnSvF2gbHpv,html[dir] ._3xLd9sljnn8QP_g_E9drtK{text-align:start}.HI72OmTBCYbpLJFgasLYQ{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-item-align:start;align-self:flex-start}.HI72OmTBCYbpLJFgasLYQ._36S61kBQD0qYRekwQsOnMS,.HI72OmTBCYbpLJFgasLYQ._25Qoo9vQEWo5UUlsDlhlr8{font-size:11px}._5h5kaMsfWHnnSvF2gbHpv{font-weight:600;height:16px}._5h5kaMsfWHnnSvF2gbHpv,._1cph5Ohu1BNS65JDq4b3tl{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;max-width:162px}._1cph5Ohu1BNS65JDq4b3tl{display:-webkit-box;display:-ms-flexbox;display:flex}._3xLd9sljnn8QP_g_E9drtK{-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;max-width:162px}html[dir=ltr] ._3xLd9sljnn8QP_g_E9drtK{margin-right:4px}html[dir=rtl] ._3xLd9sljnn8QP_g_E9drtK{margin-left:4px}._2KWQkcW6CcNYP-7HUovRXb{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}',""]),t.locals={upNextEventButtonContainer:"bquTIlYhtqsZHlrJCQ0ci",allEventsContainer:"_1KWaEy1JwXTPcXePft1XyO",allEventsContainerThreeOrMoreEvents:"_1Lt2W5uQ7oe52kMFzniHCz",allEventsContainerTwoEvents:"HpJj1IBE9g7fhlrQQuBva",reverseMotion:"gqklPe3BnRAQGJ-1Nd_Xp","reverseMotion-rtl":"_1uBAfIo7O7RpspBEYft67J",motionForThreeOrMore:"_2qguJkZ4YN-a4-jZornQTp","motionForThreeOrMore-rtl":"_3GYWRGGf7P_GI0nsmyJJEq",upNextEventContainer:"_1hagGpG7AzPUNXP0Svq92n",conflictingEventsCount:"Zxu7pq6NX4jIi550qVOsj",eventIconColumn:"_3PRzKbmV4xQJvn21aAkCeP",eventIconColumnSize:"_2lRj5U7zDS3bSBmfrr_4Qr",eventEntities:"_3wJAY7Lg8iqglCkKc_1xfx",eventLocation:"_2KWQkcW6CcNYP-7HUovRXb",eventName:"_5h5kaMsfWHnnSvF2gbHpv",eventTime:"_3xLd9sljnn8QP_g_E9drtK",eventDetailsColumn:"HI72OmTBCYbpLJFgasLYQ",compact:"_36S61kBQD0qYRekwQsOnMS",medium:"_25Qoo9vQEWo5UUlsDlhlr8",eventTimeLocationRow:"_1cph5Ohu1BNS65JDq4b3tl"}},14141:function(e){e.exports=JSON.parse('{"a":"DQc"}')},1557:function(e,t,n){var r=n(1558),a=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1558:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,"._3k2DZQclSrOtYR-5XBK9RP{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={view:"_3k2DZQclSrOtYR-5XBK9RP"}},1986:function(e,t,n){"use strict";var r=n(1),a=n(2051),i=n(374),c=n(730),o=n(121),u=n(5),s="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";function b(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,b,O,v,j;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(n={},b=Object(i.k)(e)){if(b.accountState==i.b.AccessRevoked)return[2,null];if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.c)(b.accountState,b.accountProviderType),[2,null]}return t?(n[s]=t,n[f]=t):b&&(n[s]=b.anchorMailbox),b?(O=b.token,!(v=Object(c.g)(b.tokenExpiry))&&O?[3,2]:(Object(o.s)("getAndUpdateAccessToken",{tokenExpiry:Object(u.y)(b.tokenExpiry,Object(u.Rb)()),isTokenExpired_1:v,isTokenInvalid_2:!O},{isCore:!0}),[4,a.a.importAndExecute(b.accountId,e,O)])):[3,3];case 1:(O=r.sent())||(O=""),r.label=2;case 2:j=void 0,"Outlook"==b.accountProviderType?(j='MSAuth1.0 usertoken="'+O+'", type="MSACT"',n[l]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType||(j="Bearer "+O,n[l]=2..toString()),n[d]=j,r.label=3;case 3:return[2,n]}}))}))}var O=n(1989),v=n(23);function j(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,a;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=Object(O.a)(),a=n,[4,p(e,t)];case 1:return a.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function p(e,t){var n;return Object(r.c)(this,void 0,void 0,(function(){var a,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return a=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,[4,b(e.mailboxInfo.userIdentity,m(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return i=r.sent(),Object(O.b)(a,i),[2,a]}}))}))}function m(e,t){var n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&v.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return m}))},1989:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach((function(n){return e.set(n,t[n])}))}function a(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},1991:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),a=Object(r.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},2030:function(e,t,n){"use strict";var r=n(1),a=n(1989);function i(e,t){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":t||e}}function c(e,t,n){t&&(e||n)&&Object(a.b)(t,i(e,n))}function o(e,t){var n,a=null!=t?t:{},i=(null===(n=a.headers)||void 0===n?void 0:n.set)?new Headers(a.headers):new Headers;return a.datapoint=a.datapoint||{},a.datapoint.mailbox=a.datapoint.mailbox||"Explicit",c(e,i),Object(r.a)(Object(r.a)({},a),{headers:i})}var u=n(374),s=n(1986),d=n(87),l=n(319);function f(e){return Object(r.c)(this,void 0,void 0,(function(){var t=this;return Object(r.f)(this,(function(n){return[2,Object(d.b)().then((function(n){return Object(r.c)(t,void 0,void 0,(function(){var t,a;return Object(r.f)(this,(function(r){switch(r.label){case 0:return e?Object(u.r)(e.userIdentity)?[4,Object(s.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return t=r.sent(),l(n,t),[3,3];case 2:"GroupMailbox"!=e.type&&"TeamsMailbox"!=e.type||(a=i(e.mailboxSmtpAddress),l(n,a)),r.label=3;case 3:return[2,n]}}))}))}))]}))}))}function b(){return Object(d.b)().then((function(e){return e.prefer='exchange.Behavior="CalendarInternal"',e}))}function O(e){return void 0===e&&(e=null),Object(u.r)(e)?b().then((function(t){return Object(s.a)(e).then((function(e){return Object.keys(e).forEach((function(n){return t[n]=e[n]})),t}))})):Promise.resolve({})}var v=n(65);function j(e,t,n,r){var a=new Headers;return n&&a.set("X-OWA-CANARY",Object(v.a)()),t&&a.set("X-OWA-ActionName",t),(e||r)&&(r?c(e,a,r):c(e,a)),a}n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return j}))},2051:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(31),a=n(1991);n.d(t,"b",(function(){return a.a}));var i=new r.c((function(){return n.e(1286).then(n.bind(null,2298))})),c=new r.a(i,(function(e){return e.getAndUpdateAccessToken}))},2058:function(e,t,n){"use strict";var r=n(137),a=n(5);function i(e){return c({start:e.Start,end:e.End})}function c(e){var t=Object(a.Yb)(e.end),n={start:e.start,end:e.end},r=Object(a.Ib)(e.end,t),i=Object(a.Ib)(e.start,t);return r&&!i&&(n.end=Object(a.fc)(n.end,1)),n}function o(e){return function(t){var n=i(t);return 0===Object(r.j)(e,n,!0)}}var u=n(21);function s(e){var t=i(e),n=Object(a.w)(Object(a.Yb)(t.end),Object(a.Yb)(t.start));return Math.ceil(n/u.e)}var d=n(85);function l(e){return e.IsAllDayEvent||Object(a.w)(e.End,e.Start)>=d.a.MillisecondsInOneDay}function f(e){return Object(a.Gb)(e.Start,e.End)?b(e):s(e)>=1}function b(e){return Math.abs(Object(a.s)(e.Start,e.End))>1}n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"f",(function(){return b}))},2080:function(e,t,n){"use strict";function r(e,t){return!e.some((function(e){return e&&t&&e.calculatedFolderId===t.calculatedFolderId}))}function a(e,t){return e.indexOf(t)<0}function i(e,t){if(void 0===t&&(t=a),!e)return[];var n=[];return e&&e.forEach((function(e){t(n,e)&&n.push(e)})),n}var c=n(14);function o(e,t){if(void 0===t&&(t=a),!e)return e;var n=new c.ObservableMap;return e.forEach((function(e,r){n.set(r,i(e,t))})),n}function u(e,t){if(void 0===t&&(t=a),!e)return[];var n=[];return e.forEach((function(e){e&&e.forEach((function(e){t(n,e)&&n.push(e)}))})),n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return u}))},2082:function(e,t,n){"use strict";var r=n(137),a=n(730),i=n(6),c=n(2673),o=n(5),u=n(2058),s=n(2674),d=n(714);function l(e,t){var n=[];return e.IsDraft&&n.push(Object(i.b)(s.a)),e.Subject?n.push(e.Subject):t||n.push(Object(i.b)(s.b)),n.join(" ")}function f(e){return e.Location?Object(d.d)(e.Location.DisplayName,e.Location.PostalAddress):""}function b(e,t,n){var s=[];s.push(function(e,t,n){var s=l(e),d=Object(u.e)(e),f=j(e.Start,e.End,t,e.IsAllDayEvent,d,!0),b=function(e,t,n){if(Object(a.h)(e)||Object(a.h)(t))return c.h;return n?c.g:""}(e.Start,e.End,n),O=Object(i.b)(c.b);e.IsAllDayEvent&&d&&Object(o.w)(e.End,e.Start)==r.a.MillisecondsInOneDay?O=Object(i.b)(c.i):e.IsAllDayEvent&&d&&(O=Object(i.b)(c.a));return Object(i.c)(O,f,s,b)}(e,t,n));var d=f(e);return d&&s.push(Object(i.c)(Object(i.b)(c.c),d)),e.Organizer&&e.IsMeeting&&s.push(Object(i.c)(Object(i.b)(c.d),e.Organizer.Mailbox.Name)),"Occurrence"===e.CalendarItemType&&s.push(Object(i.b)(c.f)),"Private"===e.Sensitivity&&s.push(Object(i.b)(c.e)),s.join(" ")}function O(e,t){var n=[],r=l(e);r&&n.push(r);var a=f(e);a&&n.push(a);var i=Object(u.e)(e),c=j(e.Start,e.End,t,e.IsAllDayEvent,i,!1);return n.push(c),n.join("\n")}function v(e,t){var n=f(e),r=O(e);return n?r+" "+n:r}function j(e,t,n,a,s,d){if(n&&(e=Object(o.Sb)(n,e),t=Object(o.Sb)(n,t)),Object(o.Jb)(e,t))return Object(i.c)(Object(i.b)(c.l),d?Object(o.gb)(e):"",Object(o.ab)(e),Object(o.ab)(t)).replace("  "," ");if(a&&s){if(Object(o.w)(t,e)==r.a.MillisecondsInOneDay)return Object(o.gb)(e);var l=Object(o.gb)(Object(u.a)({start:e,end:t}).end);return Object(i.c)(Object(i.b)(c.j),Object(o.gb)(e),l)}return Object(i.c)(Object(i.b)(c.k),Object(o.gb)(e),Object(o.ab)(e),Object(o.gb)(t),Object(o.ab)(t))}n.d(t,"a",(function(){return b})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return v})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return l}))},2259:function(e,t,n){"use strict";var r=n(2),a=n(1),i=n(57),c=Object(r.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",(function(e,t){return{settings:e,userIdentity:t}})),o=Object(r.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED",(function(e){return{userIdentity:e}}));var u="ows/beta/ScenarioSettings",s=["IsTimePanelDatePickerExpanded","TimePanelCalendarIds","IsTimePanelCalendarViewTaskListSelected","WasFocusTimeSuggestionDisabled"];function d(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}var l=71,f=n(210);function b(e){return!!Object(f.a)("workloadScenarioSettings")&&0!=(e&l)}var O=n(737);function v(e){if(s.some((function(t){return t===e})))return"Owa";var t=Object(O.b)();return b(t)?d(t):null}var j=n(2030),p=n(151);function m(e){var t;return Object(a.c)(this,void 0,void 0,(function(){var n,r,i,c,o,s,l,f;return Object(a.f)(this,(function(a){switch(a.label){case 0:return n=["Owa"],b(r=Object(O.b)())&&(i=d(r),n.push(i)),c=function(e){var t=e.join(",");return u+"/?Scenarios="+t}(n),s=p.b,l=[c,void 0,void 0],[4,Object(j.b)(e)];case 1:return[4,s.apply(void 0,l.concat([a.sent(),!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS"]))];case 2:return o=a.sent(),f={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null,isTimePanelOpen:!1,isTimePanelDatePickerExpanded:!1,isTimePanelCalendarViewTaskListSelected:!0,wasFocusTimeSuggestionDisabled:!1},null===(t=null==o?void 0:o.settings)||void 0===t||t.forEach((function(e){var t,n=v(e.settingName);(t=e).calendarIds&&"TimePanelCalendarIds"===t.settingName&&n===v("TimePanelCalendarIds")?f.timePanelCalendarIds=e.calendarIds:!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)||n!==v("TimePanelSelectedView")?!function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)||n!==v("SelectedCalendarListView")?!function(e){return void 0!==e.isOpen&&"IsTimePanelOpen"===e.settingName}(e)||n!==v("IsTimePanelOpen")?!function(e){return void 0!==e.isExpanded&&"IsTimePanelDatePickerExpanded"===e.settingName}(e)||n!==v("IsTimePanelDatePickerExpanded")?!function(e){return void 0!==e.isSelected&&"IsTimePanelCalendarViewTaskListSelected"===e.settingName}(e)||n!==v("IsTimePanelCalendarViewTaskListSelected")?function(e){return void 0!==e.wasDisabled&&"WasFocusTimeSuggestionDisabled"===e.settingName}(e)&&n===v("WasFocusTimeSuggestionDisabled")&&(f.wasFocusTimeSuggestionDisabled=e.wasDisabled):f.isTimePanelCalendarViewTaskListSelected=e.isSelected:f.isTimePanelDatePickerExpanded=e.isExpanded:f.isTimePanelOpen=e.isOpen:f.timePanelSelectedCalendarView=e.selectedView:f.timePanelSelectedView=e.selectedView})),[2,f]}}))}))}var h=n(742),g=Object(h.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(h.a)(1e3)}),w={};function y(){return Object(a.c)(this,void 0,void 0,(function(){var e;return Object(a.f)(this,(function(t){switch(t.label){case 0:return e=Object(i.e)().map(I),[4,Promise.all(e)];case 1:return t.sent(),[2]}}))}))}function I(e){return Object(a.c)(this,void 0,void 0,(function(){var t;return Object(a.f)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),w[e]?[2]:(w[e]=g((function(){return m(e)})),[4,w[e].retriableFunc()]);case 1:return t=n.sent(),c(t,e),[3,3];case 2:return n.sent(),o(e),[3,3];case 3:return[2]}}))}))}var x=n(1283);Object(r.orchestrator)(x.e,(function(e){I(e.userIdentity)}));function E(e,t){return u+"/"+e+"/"+t}function k(e){return Object(a.c)(this,void 0,void 0,(function(){var t,n,r;return Object(a.f)(this,(function(a){switch(a.label){case 0:return(t=v("TimePanelSelectedView"))?(n=E(t,"TimePanelSelectedView"),r={ViewType:e},[4,Object(p.d)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}function S(e,t){return Object(a.c)(this,void 0,void 0,(function(){var n,r,i,c,o;return Object(a.f)(this,(function(a){switch(a.label){case 0:return(n=v("TimePanelCalendarIds"))?(r=E(n,"TimePanelCalendarIds"),i={CalendarIds:e},c=p.d,o=[r,i,void 0,void 0],[4,Object(j.b)(t)]):[3,3];case 1:return[4,c.apply(void 0,o.concat([a.sent(),!0,void 0,"UpdateTimePanelCalendarIdsRequest"]))];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function C(e){return Object(a.c)(this,void 0,void 0,(function(){var t,n,r;return Object(a.f)(this,(function(a){switch(a.label){case 0:return(t=v("IsTimePanelOpen"))?(n=E(t,"IsTimePanelOpen"),r={IsOpen:e},[4,Object(p.d)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}function A(e){return Object(a.c)(this,void 0,void 0,(function(){var t,n,r;return Object(a.f)(this,(function(a){switch(a.label){case 0:return(t=v("SelectedCalendarListView"))?(n=E(t,"SelectedCalendarListView"),r={ViewType:e},[4,Object(p.d)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}function T(e){return Object(a.c)(this,void 0,void 0,(function(){var t,n,r;return Object(a.f)(this,(function(a){switch(a.label){case 0:return(t=v("IsTimePanelDatePickerExpanded"))?(n=E(t,"IsTimePanelDatePickerExpanded"),r={isExpanded:e},[4,Object(p.d)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}function D(e){return Object(a.c)(this,void 0,void 0,(function(){var t,n,r;return Object(a.f)(this,(function(a){switch(a.label){case 0:return(t=v("IsTimePanelCalendarViewTaskListSelected"))?(n=E(t,"IsTimePanelCalendarViewTaskListSelected"),r={isSelected:e},[4,Object(p.d)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}function _(e){return Object(a.c)(this,void 0,void 0,(function(){var t,n,r;return Object(a.f)(this,(function(a){switch(a.label){case 0:return(t=v("WasFocusTimeSuggestionDisabled"))?(n=E(t,"WasFocusTimeSuggestionDisabled"),r={wasDisabled:e},[4,Object(p.d)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))}n.d(t,"j",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return y})),n.d(t,"h",(function(){return k})),n.d(t,"g",(function(){return S})),n.d(t,"f",(function(){return C})),n.d(t,"e",(function(){return A})),n.d(t,"d",(function(){return T})),n.d(t,"c",(function(){return D})),n.d(t,"i",(function(){return _}))},2286:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("UPDATE_SELECTED_CALENDARS_IN_STORE",(function(e,t){return{calendarIds:e,userIdentity:t}})),i=Object(r.action)("ADD_SELECTED_CALENDAR_IN_STORE",(function(e,t){return{calendarId:e,userIdentity:t}})),c={selectedCalendars:new(n(14).ObservableMap)},o=Object(r.createStore)("selectedCalendarsStore",c),u=n(2080);Object(r.mutator)(a,(function(e){var t=e.calendarIds,n=e.userIdentity;o().selectedCalendars.set(n,Object(u.b)(t))}));var s=n(1);function d(){return Object(u.c)(o().selectedCalendars)}function l(){return Object(u.d)(d())}function f(e){var t=d().get(e);return t||[]}Object(r.mutator)(i,(function(e){var t=e.calendarId,n=e.userIdentity;o().selectedCalendars.set(n,Object(u.b)(Object(s.j)(Object(s.j)([],Object(s.g)(f(n))),[t])))}));var b=Object(r.action)("UPDATE_SELECTED_CALENDARS",(function(e,t){return{calendarIds:e,userIdentity:t}})),O=Object(r.action)("ADD_SELECTED_CALENDAR",(function(e,t){return{calendarId:e,userIdentity:t}})),v=(Object(r.action)("INITIALIZE_SELECTED_CALENDARS",(function(e,t){return{calendarIds:e,userIdentity:t}})),Object(r.action)("SELECTED_CALENDARS_UPDATED",(function(e,t){return{calendarIds:e,userIdentity:t}}))),j=n(209),p=n(23),m=n(57),h=n(419),g="OWA.ViewStateConfiguration";function w(e,t){e&&m.w.importAndExecute([{key:"SelectedCalendarsDesktop",valuetype:"StringArray",value:Object(u.b)(e)}],g,Object(h.a)(Object(j.d)(t))).catch((function(e){p.g.warn("Could not save new selected calendars list to user configuration")}))}function y(e){return e?function(e){var t=d().get(e);return t?t.length:0}(e):(t=d(),n=0,t.forEach((function(e,t){e&&(n+=e.length)})),n);var t,n}Object(r.orchestrator)(b,(function(e){var t=e.calendarIds,n=e.userIdentity;a(t,n),v(t,n),w(t,n)})),Object(r.orchestrator)(O,(function(e){var t=e.calendarId,n=e.userIdentity;i(t,n);var r=f(n);v(r,n),w(r,n)})),Object(r.orchestrator)(m.B,(function(e){var t=e.userConfiguration,n=e.userIdentity,r=t.ViewStateConfiguration.SelectedCalendarsDesktop,i=n||Object(j.d)().userIdentity;a(r,i),v(r,i)})),n.d(t,"g",(function(){return b})),n.d(t,"a",(function(){return O})),n.d(t,"f",(function(){return v})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return l}))},2514:function(e,t,n){"use strict";var r=n(2),a=n(44),i=Object(r.action)("toggleShowDeclinedEventsMode",(function(e,t){return Object(a.c)({name:"ToggleShowDeclinedEventsMode",customData:{CurrentDateRangeType:t,ShowDeclinedEventsMode:e}},{isDeclinedEventsMode:e,dateRangeType:t})})),c=i,o=n(451);Object(r.orchestrator)(i,(function(e){var t=e.isDeclinedEventsMode;Object(o.a)((function(e){e.ViewStateConfiguration.CalendarViewShowDeclinedMeetings=t}),[{key:"CalendarViewShowDeclinedMeetings",valuetype:"Boolean",value:[""+t]}],"OWA.ViewStateConfiguration")}));var u=n(57),s=n(24);function d(){return!!Object(s.i)("cal-surface-declinedMeetings")&&Object(u.h)().ViewStateConfiguration.CalendarViewShowDeclinedMeetings}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return c}))},2598:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1),a=n(374),i=n(982),c=n(1307);function o(e,t,n,o,u){var s="read/"+(Object(a.r)(e.mailboxInfo.userIdentity)?"account/"+encodeURIComponent(e.mailboxInfo.userIdentity)+"/":"")+encodeURIComponent(e.Id);Object(i.c)("calendar",s,Object(r.a)(Object(r.a)({},n),{entrySource:t,includeFluidOnPopout:u}),c.a,!1,t)}},2673:function(e){e.exports=JSON.parse('{"c":"_ea","e":"$ea","f":"afa","d":"bfa","b":"cfa","i":"dfa","a":"efa","l":"ffa","j":"gfa","k":"hfa","h":"ifa","g":"jfa"}')},2674:function(e){e.exports=JSON.parse('{"a":"kfa","b":"lfa"}')},2736:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("updateUpNextEvent",(function(e,t){return{id:e,eventsCacheLockId:t}})),i={scenarios:new(n(14).ObservableMap)},c=Object(r.createStore)("UpNextStore",i);Object(r.mutator)(a,(function(e){c().scenarios.set(e.eventsCacheLockId,e.id)}));var o=n(860),u=n(1),s=n(2095),d=(Object(r.action)("cancelRefreshUpNextPoll",(function(e){return{eventsCacheLockId:e}})),Object(r.action)("onUpNextEventUpdated",(function(e,t,n){return{id:e,parentFolderId:t,eventsCacheLockId:n}}))),l=Object(r.action)("initializeUpNextEventLoader",(function(e,t){return{calendarIds:e,eventsCacheLockId:t}})),f=n(5);function b(){var e=Object(f.mc)(),t=Object(f.e)(e,1);return{start:e,end:Object(f.A)(t)}}var O=n(379),v=n(485),j=n(1282),p=n(21);function m(e,t){void 0===t&&(t=!1);var n=Object(f.Rb)(),r=Object(u.j)([],Object(u.g)(e));return t||r.sort(j.a),function(e,t){if(!e||0===e.length)return null;var n=h(t),r=e.filter((function(r,a){return!!n(r)&&!e.slice(a+1).some((function(e){return Object(f.Hb)(e.End,t)}))}));if(0===r.length)return null;if(1===r.length)return r[0];return r.reduce((function(e,n){if(0===e.length)return[n];var r=g(e[0].Start,t),a=g(n.Start,t);return a<r?[n]:a===r?(e.push(n),e):e}),[]).sort(j.b)[0]}(r,n)}function h(e){return function(t){var n=Object(f.Hb)(t.End,e),r=Object(f.w)(t.End,t.Start)>p.e,a=!Object(v.c)(t),i=Object(O.v)(t);return!n&&!r&&!t.IsAllDayEvent&&!t.IsCancelled&&!t.IsDraft&&"Decline"!==t.ResponseType&&a&&i}}function g(e,t){return Math.abs(Object(f.w)(e,t))}var w=n(2058);function y(e){var t=b();return Object(s.c)(e,t).filter(Object(w.d)(t))}var I=n(730);function x(e){return c().scenarios.get(e)}function E(e){var t=x(e);return t?function(e,t){return y(e).filter((function(e){return e.ItemId.Id===t.Id}))[0]||null}(e,t):null}function k(e){var t=E(e);if(!t)return{upNextEvent:null,conflictingEvents:[]};var n=y(e).filter((function(e){return function(e,t){var n=Object(I.i)();return t.ItemId.Id!==e.ItemId.Id&&(Object(j.f)(t,e)&&!Object(f.Fb)(t.Start,e.Start)&&h(n)(t))}(t,e)}));return{upNextEvent:t,conflictingEvents:n}}function S(e){var t=E(e);if(!t)return{upNextEvent:null,eventsWithinUpNextEvent:[]};var n=y(e).filter((function(e){return function(e,t){if(t.ItemId.Id===e.ItemId.Id||!t.IsOnlineMeeting||null===t.OnlineMeetingJoinUrl)return!1;var n=Object(f.Ob)(Object(f.gc)(Object(f.Rb)(),1),t.Start,t.End),r=Object(f.Ob)(Object(f.Rb)(),t.Start,t.End),a=Object(f.w)(t.End,t.Start)>p.e;return(n||r)&&!a&&!t.IsAllDayEvent&&!t.IsCancelled&&!t.IsDraft&&"Decline"!==t.ResponseType&&!Object(v.c)(t)&&Object(O.v)(t)}(t,e)}));return{upNextEvent:t,eventsWithinUpNextEvent:n}}function C(e){return c().scenarios.has(e)}function A(){return Object(u.j)([],Object(u.g)(c().scenarios.keys()))}function T(e){return Object(u.c)(this,void 0,void 0,(function(){var t,n;return Object(u.f)(this,(function(r){return t=function(e){return m(y(e),!0)}(e),n=t?t.ItemId:null,x(e)===n?[2]:(a(n,e),d(n,t?t.ParentFolderId:null,e),[2])}))}))}function D(){A().forEach(T)}Object(r.orchestrator)(o.b,(function(){D()})),Object(r.orchestrator)(o.c,(function(){D()})),Object(r.orchestrator)(o.a,(function(){D()})),Object(r.orchestrator)(l,(function(e){var t=e.calendarIds,n=e.eventsCacheLockId,r=b();C(n)||a(null,n),Object(s.h)(t,r,n)}));var _=n(715);Object(r.orchestrator)(s.a,(function(e){return Object(u.c)(void 0,void 0,void 0,(function(){var t;return Object(u.f)(this,(function(n){switch(n.label){case 0:return C(t=e.eventsCacheLockId)?[4,T(t)]:[3,2];case 1:n.sent(),Object(_.b)((function(){return function(e){return Object(u.c)(this,void 0,void 0,(function(){return Object(u.f)(this,(function(t){switch(t.label){case 0:return[4,T(e)];case 1:return t.sent(),[2,null]}}))}))}(t)}),t,1e4),n.label=2;case 2:return[2]}}))}))}));Object(r.orchestrator)(s.k,(function(e){var t=e.eventsCacheLockId;C(t)&&T(t)})),Object(r.orchestrator)(I.l,(function(){A().forEach((function(e){return Object(s.m)(b(),e)}))})),Object(r.orchestrator)(s.j,(function(e){var t=e.eventsCacheLockId;C(t)&&T(t)}));n.d(t,"g",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"i",(function(){return s.l})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return x})),n.d(t,"c",(function(){return k})),n.d(t,"d",(function(){return S})),n.d(t,"f",(function(){return C})),n.d(t,"h",(function(){return D}))},3299:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"g",(function(){return O}));var r=n(2363),a=n(31),i=new a.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(16),n.e(22),n.e(28),n.e(31),n.e(40),n.e(53),n.e(59),n.e(87),n.e(187),n.e(310),n.e(1042)]).then(n.bind(null,4495))}));Object(a.f)(r.d,i,(function(e){return e.openTimePanelOrchestrator}));var c=Object(a.d)(i,(function(e){return e.TimePanel})),o=Object(a.d)(i,(function(e){return e.TimePanelHeaderBar})),u=new a.a(i,(function(e){return e.loadTimePanelData})),s=new a.a(i,(function(e){return e.openEventDetailsView})),d=(new a.a(i,(function(e){return e.openAttendeeTrackingView})),new a.a(i,(function(e){return e.closeAttendeeTrackingView})),new a.a(i,(function(e){return e.openTasksView}))),l=new a.a(i,(function(e){return e.openCalendarView})),f=new a.a(i,(function(e){return e.openConflictsView})),b=new a.a(i,(function(e){return e.closeConflictsView})),O=new a.a(i,(function(e){return e.openEventQuickComposeView}))},419:function(e,t,n){"use strict";var r=n(1);function a(e,t){return e?Object(r.a)({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return a}))},479:function(e,t,n){"use strict";var r=n(658),a=n(879),i=n(448);t.a=function(e){return Object(i.a)(e)?Object(r.a)(e):Object(a.a)(e)}},489:function(e,t,n){"use strict";var r=n(151),a=!0,i=!0;function c(e,t,n){return Object(r.g)(e,"GET",n,{throwServiceError:a,customHeaders:d(t)})}function o(e,t,n,c){return Object(r.g)(e,"DELETE",n,{requestObject:c,sendPayloadAsBody:i,throwServiceError:a,customHeaders:d(t)})}function u(e,t,n,c,o){return Object(r.g)(e,"POST",n,{requestObject:c,sendPayloadAsBody:i,throwServiceError:a,customHeaders:d(t,o)})}function s(e,t,n,c,o){return Object(r.g)(e,"PATCH",n,{requestObject:c,sendPayloadAsBody:i,throwServiceError:a,customHeaders:d(t,o)})}function d(e,t){var n={};return e&&(n["x-anchormailbox"]=e),!0===t&&(n.Prefer="return=representation"),!1===t&&(n.Prefer="return=minimal"),n}n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return s}))},4959:function(e,t,n){"use strict";var r,a=n(2),i=Object(a.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS_IN_STORE",(function(e,t){return{calendarIds:e,userIdentity:t}})),c=Object(a.action)("SET_TIME_PANEL_CONFIG_LOAD_STATE",(function(e,t){return{loadState:e,userIdentity:t}})),o=Object(a.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",(function(e,t){return{calendarIds:e,userIdentity:t}})),u=Object(a.action)("ON_SELECTED_TIME_PANEL_CALENDARIDS_UPDATED");!function(e){e[e.Loaded=0]="Loaded",e[e.Failed=1]="Failed"}(r||(r={}));var s=n(2259),d=(Object(a.orchestrator)(s.b,(function(e){c(r.Failed,e.userIdentity),u()})),n(14)),l=Object(a.createStore)("timePanelSelectedCalendarIdsStore",{configLoadStates:new d.ObservableMap,calendarIdsMap:new d.ObservableMap}),f=n(2080);function b(){return Object(f.c)(l().calendarIdsMap)}function O(e){return e?function(e){var t=b().get(e);return t?t.length:0}(e):Object(f.d)(b()).length}function v(){return O()>0}var j=n(2286),p=(Object(a.orchestrator)(j.f,(function(){v()||u()})),n(1));function m(){return l().configLoadStates}var h=n(374),g=n(76),w=n(209);function y(){var e=m(),t=0===e.size,n=new d.ObservableMap;return t?n:(Object(p.j)([Object(w.d)().userIdentity],Object(p.g)(Object(h.n)().map((function(e){return e.userIdentity})))).forEach((function(t){if(v()&&e.get(t)!==r.Failed)n.set(t,b().get(t));else if(Object(j.c)()>0)n.set(t,Object(j.b)().get(t));else{var a=Object(g.v)(t);a&&n.set(t,[a.id.id])}})),n)}var I=n(742),x=n(57),E=n(23),k=Object(I.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(I.a)(1e3)}),S={};Object(a.orchestrator)(o,(function(e){return Object(p.c)(void 0,void 0,void 0,(function(){var t,n;return Object(p.f)(this,(function(r){switch(r.label){case 0:return t=e.calendarIds,n=e.userIdentity,Object(w.d)().userIdentity===n&&1===O()&&1===O(n)&&0===t.length?[2]:v()?[3,2]:[4,C()];case 1:r.sent(),r.label=2;case 2:return T(t,n),[2]}}))}))}));function C(){return Object(p.c)(this,void 0,void 0,(function(){return Object(p.f)(this,(function(e){switch(e.label){case 0:return[4,Promise.all(Object(x.e)().map((function(e){var t,n=null!==(t=Object(j.b)().get(e))&&void 0!==t?t:[];if(0===Object(j.c)()){var r=Object(g.v)(e);r&&(n=[r.id.id])}T(n,e,!0)})))];case 1:return e.sent(),[2]}}))}))}var A=1e3;function T(e,t,n){var r;return Object(p.c)(this,void 0,void 0,(function(){var a,c,o,d,l,b;return Object(p.f)(this,(function(O){switch(O.label){case 0:a=Object(f.b)(e),c=y().get(t),O.label=1;case 1:return O.trys.push([1,3,4,5]),i(a,t),n||u(),null===(r=S[t])||void 0===r||r.cancel(),o=k((function(){return Object(s.g)(a,t)})),v=o.retriableFunc,j=A,p=!1,l={cancel:function(){d.cancel(),o.cancel()},updateFunc:(d={delayFunc:function(){return new Promise((function(e,t){return function(e,t){setTimeout((function(){if(!p)return v(),e()}),j)}(e)}))},cancel:function(){return p=!0}}).delayFunc},S[t]=l,[4,l.updateFunc()];case 2:return O.sent(),[3,5];case 3:return b=O.sent(),E.g.warn("updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: "+b),i(c,t),n||u(),[3,5];case 4:return delete S[t],[7];case 5:return[2]}var v,j,p}))}))}Object(a.orchestrator)(s.j,(function(e){var t,n=e.settings,a=e.userIdentity;c(r.Loaded,a),(null===(t=n.timePanelCalendarIds)||void 0===t?void 0:t.length)>0&&i(n.timePanelCalendarIds,a),u()})),Object(a.mutator)(c,(function(e){var t=e.userIdentity,n=e.loadState;l().configLoadStates.set(t,n)})),Object(a.mutator)(i,(function(e){var t=e.calendarIds,n=e.userIdentity;l().calendarIdsMap.set(n,Object(f.b)(t))}));function D(){return Object(f.d)(y())}n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return D}))},531:function(e,t,n){"use strict";var r=n(311),a=n(303),i="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(a.a)(e)&&Object(r.a)(e)==i}},581:function(e,t,n){"use strict";function r(e){var t=0,n=[];function r(){t-=1,n.length>0&&n.shift()()}return{add:function(a){return new Promise((function(i,c){var o=function(){t+=1,a().then((function(e){r(),i(e)}),(function(e){r(),c(e)}))};t===e?n.push(o):o()}))},getRunningCount:function(){return t},getQueueLength:function(){return n.length}}}n.d(t,"a",(function(){return r}))},615:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"}(r||(r={}))},618:function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return o})),n.d(t,"k",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"n",(function(){return l})),n.d(t,"l",(function(){return f})),n.d(t,"m",(function(){return b})),n.d(t,"a",(function(){return O})),n.d(t,"h",(function(){return v})),n.d(t,"b",(function(){return j})),n.d(t,"e",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"i",(function(){return h})),n.d(t,"o",(function(){return g}));var r=n(85),a=n(64),i=n(5);function c(e,t){return void 0===t&&(t=Object(i.Rb)()),s(Object(i.cc)(t,e),r.a.DaysInOneWeek)}function o(e,t){var n=u(e,t),r=Object(i.B)(e),a=Object(i.e)(Object(i.C)(r,t),1);return s(n,Math.abs(Object(i.s)(n,a)-1))}function u(e,t){var n=Object(i.bc)(e);return Object(i.cc)(n,t)}function s(e,t){return{start:e,end:Object(i.e)(e,t-1)}}function d(e,t,n,r,o){switch(void 0===o&&(o=1),e){case a.b.Day:return s(Object(i.Yb)(t),o);case a.b.Month:var u=Object(i.bc)(t),d=Object(i.B)(t);return s(u,Math.abs(Object(i.s)(u,d)-1));case a.b.Week:return c(n,t);case a.b.WorkWeek:return function(e,t,n){void 0===n&&(n=Object(i.Rb)());for(var r,a,o=c(e,n),u=0;u<=m(o);u++){var s=Object(i.e)(o.start,u);if(!r&&t.includes(Object(i.ob)(s))&&(r=s),s=Object(i.e)(o.end,-u),!a&&t.includes(Object(i.ob)(s))&&(a=s),r&&a)break}return{start:r,end:a}}(n,r,t)}}function l(e,t){var n=o(e,t);return Object(i.t)(n.end,n.start,t)}function f(e,t){var n;return s(n=t==a.b.WorkWeek?Object(i.k)(e.start,1):Object(i.e)(e.end,1),t==a.b.Month?Object(i.pb)(n):Object(i.s)(e.end,e.start)+1)}function b(e,t){var n,r;if(t==a.b.WorkWeek)n=Object(i.k)(e.start,-1),r=Object(i.k)(e.end,-1);else{r=Object(i.e)(e.start,-1);var c=t==a.b.Month?-Object(i.pb)(r):Object(i.s)(e.start,e.end)-1;n=Object(i.e)(e.start,c)}return{start:n,end:r}}function O(e,t){return e&&t&&0==Object(i.p)(e.start,t.start)&&0==Object(i.p)(e.end,t.end)}function v(e,t,n){if(!e||!t)throw new Error("Date ranges cannot be null in call to areDateRangesOverlapping");return n?Object(i.p)(e.start,t.start)<=0?Object(i.p)(e.end,t.start)>=0?0:1:Object(i.p)(t.end,e.start)>=0?0:-1:Object(i.p)(e.start,t.start)<0?Object(i.p)(e.end,t.start)>0?0:1:Object(i.p)(t.end,e.start)>0?0:-1}function j(e,t,n){return!(!e||!t)&&(n?Object(i.p)(e.start,t.start)<=0&&Object(i.p)(e.end,t.end)>=0:Object(i.p)(e.start,t.start)<0&&Object(i.p)(e.end,t.end)>0)}function p(e,t){return e&&t?{start:Object(i.p)(e.start,t.start)<0?e.start:t.start,end:Object(i.p)(e.end,t.end)>0?e.end:t.end}:null}function m(e){return Object(i.s)(e.end,e.start)}function h(e){return Math.floor(Object(i.v)(e.end,e.start)/24)+(Object(i.v)(e.end,e.start)%24>0?1:0)}function g(e,t){return Object(i.s)(e.start,t)<=0&&Object(i.s)(e.end,t)>=0}},620:function(e,t,n){"use strict";var r=n(293),a=n(184),i=Object(r.a)(a.a,"DataView"),c=n(452),o=Object(r.a)(a.a,"Promise"),u=n(645),s=Object(r.a)(a.a,"WeakMap"),d=n(311),l=n(423),f=Object(l.a)(i),b=Object(l.a)(c.a),O=Object(l.a)(o),v=Object(l.a)(u.a),j=Object(l.a)(s),p=d.a;(i&&"[object DataView]"!=p(new i(new ArrayBuffer(1)))||c.a&&"[object Map]"!=p(new c.a)||o&&"[object Promise]"!=p(o.resolve())||u.a&&"[object Set]"!=p(new u.a)||s&&"[object WeakMap]"!=p(new s))&&(p=function(e){var t=Object(d.a)(e),n="[object Object]"==t?e.constructor:void 0,r=n?Object(l.a)(n):"";if(r)switch(r){case f:return"[object DataView]";case b:return"[object Map]";case O:return"[object Promise]";case v:return"[object Set]";case j:return"[object WeakMap]"}return t});t.a=p},64:function(e,t,n){"use strict";var r,a,i,c;n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return o})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(r||(r={})),function(e){e[e.January=0]="January",e[e.February=1]="February",e[e.March=2]="March",e[e.April=3]="April",e[e.May=4]="May",e[e.June=5]="June",e[e.July=6]="July",e[e.August=7]="August",e[e.September=8]="September",e[e.October=9]="October",e[e.November=10]="November",e[e.December=11]="December"}(a||(a={})),function(e){e[e.FirstDay=0]="FirstDay",e[e.FirstFullWeek=1]="FirstFullWeek",e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(i||(i={})),function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.WorkWeek=3]="WorkWeek"}(c||(c={}));var o=7},640:function(e,t,n){"use strict";var r=n(882),a=n(741),i=Object.prototype.propertyIsEnumerable,c=Object.getOwnPropertySymbols,o=c?function(e){return null==e?[]:(e=Object(e),Object(r.a)(c(e),(function(t){return i.call(e,t)})))}:a.a;t.a=o},645:function(e,t,n){"use strict";var r=n(293),a=n(184),i=Object(r.a)(a.a,"Set");t.a=i},699:function(e,t,n){"use strict";var r=/\s/;var a=function(e){for(var t=e.length;t--&&r.test(e.charAt(t)););return t},i=/^\s+/;var c=function(e){return e?e.slice(0,a(e)+1).replace(i,""):e},o=n(216),u=n(531),s=NaN,d=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,f=/^0o[0-7]+$/i,b=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(u.a)(e))return s;if(Object(o.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(o.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=c(e);var n=l.test(e);return n||f.test(e)?b(e.slice(2),n?2:8):d.test(e)?s:+e}},702:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(615),a=n(2),i=n(817),c=n(8),o={state:r.a.NotStarted,isPopoutV2:Object(c.a)(i.a)==i.b},u=Object(a.createStore)("popoutChild",o);u()},709:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o}));var r,a=2,i=[window.location.origin];function c(e,t,n){var r={version:a,type:t,serializedData:JSON.stringify(n)};e.postMessage(JSON.stringify(r),"*")}function o(e){if(i.indexOf(e.origin)>=0){var t=void 0;try{t=JSON.parse(e.data)}catch(e){return null}if(t&&a==t.version)return t}return null}!function(e){e[e.Unknown=0]="Unknown",e[e.PopoutReady=1]="PopoutReady",e[e.SetData=2]="SetData",e[e.CloseWindow=3]="CloseWindow",e[e.DeeplinkReady=4]="DeeplinkReady"}(r||(r={}))},738:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=t.length,a=e.length;++n<r;)e[a+n]=t[n];return e}},740:function(e,t,n){"use strict";var r=n(738),a=n(292);t.a=function(e,t,n){var i=t(e);return Object(a.a)(e)?i:Object(r.a)(i,n(e))}},741:function(e,t,n){"use strict";t.a=function(){return[]}},742:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(c,o){a?o(new Error("The function retry was cancelled")):(r++,e().then((function(e){return c(e)})).catch((function(e){t&&r>=t?o(e):setTimeout((function(){return i(c,o)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return i(e,t)}))},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},744:function(e,t,n){"use strict";function r(e){if(!e)return e;var t=e.replace(/\+/g,"_");return t=t.replace(/\//g,"-")}function a(e){if(!e)return e;var t=e.replace(/_/g,"+");return t=t.replace(/-/g,"/")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},745:function(e,t,n){"use strict";var r=n(876);n.d(t,"a",(function(){return r.a}))},769:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"RecurringMasterItemId:#Exchange"},e)}},817:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));var r="popoutv2",a="1",i="_owa_projection_root"},818:function(e,t,n){"use strict";var r=n(740),a=n(640),i=n(479);t.a=function(e){return Object(r.a)(e,i.a,a.a)}},824:function(e,t,n){"use strict";var r=n(1),a=n(5),i=n(888),c=n(893),o=n(889),u=n(890),s=n(894),d=n(892),l=n(180),f=n(745),b=n(24),O=n(419);function v(e,t,n,v,j,p,m){return Object(r.c)(this,void 0,void 0,(function(){var h,g,w;return Object(r.f)(this,(function(r){switch(r.label){case 0:h=Object(l.b)(),j&&(h.TimeZoneContext.TimeZoneDefinition.Id=j),w=null,p&&(w=Object(O.a)(p)),r.label=1;case 1:return r.trys.push([1,,3,4]),[4,Object(d.a)({request:{Header:h,Body:Object(u.a)({MailboxDataArray:n.map((function(e){return Object(s.a)({Email:Object(c.a)({Address:e})})})),FreeBusyViewOptions:Object(o.a)({RequestedView:v,TimeWindow:Object(i.a)({StartTime:Object(a.rb)(e),EndTime:Object(a.rb)(t)}),MergedFreeBusyIntervalInMinutes:m})})}},w)];case 2:return g=r.sent(),[3,4];case 3:return Object(b.i)("cal-mf-diagnostics")&&Object(f.a)({action:"GetUserAvailabilityInternal",status:g?g.Body.ResponseCode:"Error",response:null==g?void 0:g.Body}),[7];case 4:return[2,g.Body]}}))}))}var j=n(313),p=n(23),m=n(581),h=Object(m.a)(4),g=function(e){var t={};return e.forEach((function(e){return t[e]={FreeBusyViewType:"None"}})),t};function w(e,t,n,a,i,c,o){return void 0===i&&(i=!0),Object(r.c)(this,void 0,void 0,(function(){var u,s,d,l,f,b,O;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(0===n.length)return[2];(u=new j.a("FreeBusyAvailabilityRequested",{isCore:!0})).addCustomData({numAttendees:n.length}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,h.add((function(){return v(e,t,n,"DetailedMerged",e.tz,c,o)}))];case 2:return s=r.sent(),u.addCustomData({executingRequests:h.getRunningCount(),queuedRequests:h.getQueueLength()}),u.end(),d="Success"===s.ResponseClass&&n.length===s.Responses.length,l={},d?n.forEach((function(e,t){l[e]=s.Responses[t].CalendarView})):l=g(n),i&&(f=d?Object.keys(l).filter((function(e){return"None"==l[e].FreeBusyViewType})):n).length>0&&w(e,t,f,a,!1,c,o),a(l),[3,4];case 3:return b=r.sent(),u.endWithError("ServerError",b),p.g.warn('[getAvailabilityFunction] Received error calling getUserAvailabilityService, Error: "'+b.stack+'"'),i?w(e,t,n,a,!1,c,o):(O=g(n),a(O)),[3,4];case 4:return[2]}}))}))}n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return v}))},85:function(e,t,n){"use strict";var r=n(64),a={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn15Mins:9e5,MillisecondsIn20Mins:12e5,MillisecondsIn22Mins:132e4,MillisecondsIn24Mins:144e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,SecondsInOneMinute:60,DaysInOneWeek:7,AllDaysOfWeek:[r.c.Sunday,r.c.Monday,r.c.Tuesday,r.c.Wednesday,r.c.Thursday,r.c.Friday,r.c.Saturday]};t.a=a},876:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),a=Object(r.action)("logServiceCallForDiagnostics",(function(e){return{serviceCall:e}}))},879:function(e,t,n){"use strict";var r=n(537),a=n(659),i=Object(a.a)(Object.keys,Object),c=Object.prototype.hasOwnProperty;t.a=function(e){if(!Object(r.a)(e))return i(e);var t=[];for(var n in Object(e))c.call(e,n)&&"constructor"!=n&&t.push(n);return t}},882:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=null==e?0:e.length,a=0,i=[];++n<r;){var c=e[n];t(c,n,e)&&(i[a++]=c)}return i}},888:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"Duration:#Exchange"},e)}},889:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"FreeBusyViewOptions:#Exchange"},e)}},890:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"GetUserAvailabilityRequest:#Exchange"},e)}},892:function(e,t,n){"use strict";var r=n(33),a=n(1);function i(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(a.a)({__type:"GetUserAvailabilityInternalJsonRequest:#Exchange"},n))),Object(r.a)("GetUserAvailabilityInternal",e,t)}n.d(t,"a",(function(){return i}))},893:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"EmailAddress:#Exchange"},e)}},894:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function a(e){return Object(r.a)({__type:"MailboxData:#Exchange"},e)}},9542:function(e){e.exports=JSON.parse('{"a":"wQc","d":"xQc","c":"yQc","g":"zQc","f":"AQc","b":"BQc","e":"CQc"}')},982:function(e,t,n){"use strict";var r=n(31),a=n(1272),i=n(990),c=n(20),o=n(0),u=n(989),s=n(702),d=n(24),l=n(615),f=n(1301),b=n(1557),O=Object(c.a)((function(e){o.useEffect((function(){Object(d.i)("rp-popoutsDebug")||v()}),[]);return o.createElement("div",{className:b.view},Object(s.a)().state==l.a.Loading?o.createElement("span",null,o.createElement(f.a,null),e.loadingString):o.createElement("button",{onClick:v},"Get Data"))}));function v(){Object(u.a)()}function j(e,t,n,r){var a="";if(r)a="readimid/",a+=encodeURIComponent(btoa(r));else{if(a=n?"readconv/":"read/",e&&"GroupMailbox"==e.type){a+="group/";var i=e.mailboxSmtpAddress.split("@");a+=i[1]+"/"+i[0]+"/"}a+=encodeURIComponent(n||t)}return a}var p=n(1269);n(1271);n.d(t,"h",(function(){return h})),n.d(t,"c",(function(){return a.a})),n.d(t,"i",(function(){return i.a})),n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return l.a})),n.d(t,"f",(function(){return s.a})),n.d(t,"d",(function(){return u.b})),n.d(t,"e",(function(){return j})),n.d(t,"g",(function(){return p.a}));var m=new r.c((function(){return n.e(982).then(n.bind(null,18279))})),h=new r.b(m,(function(e){return e.bootPopout}))},989:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return l}));var r,a=n(1),i=n(990),c=n(709),o=n(615),u=n(702),s=!1;function d(){Object(i.a)(o.a.Loading),r?r():s=!0}function l(e){return Object(a.c)(this,void 0,void 0,(function(){return Object(a.f)(this,(function(t){switch(t.label){case 0:return s?[3,2]:[4,new Promise((function(e){r=function(){e()}}))];case 1:t.sent(),t.label=2;case 2:return[2,Object(u.a)().isPopoutV2?new Promise((function(t,n){var r=function(n){var a=Object(c.b)(n);if(a&&a.type==c.a.SetData){window.removeEventListener("message",r);var i=void 0;try{i=e?e(a.serializedData):JSON.parse(a.serializedData)}catch(e){}t(i)}};window.addEventListener("message",r);try{var a=window.opener;Object(c.c)(a,c.a.PopoutReady,null)}catch(e){t(null)}})):Promise.resolve(null)]}}))}))}},990:function(e,t,n){"use strict";var r=n(702),a=n(2),i=n(615),c=n(709);t.a=Object(a.mutatorAction)("setPopoutChildState",(function(e){var t=Object(r.a)();t.state=e,e==i.a.Ready&&t.isPopoutV2&&window.opener&&Object(c.c)(window.opener,c.a.DeeplinkReady,null)}))},992:function(e,t,n){"use strict";var r=n(216),a=n(184),i=function(){return a.a.Date.now()},c=n(699),o="Expected a function",u=Math.max,s=Math.min;t.a=function(e,t,n){var a,d,l,f,b,O,v=0,j=!1,p=!1,m=!0;if("function"!=typeof e)throw new TypeError(o);function h(t){var n=a,r=d;return a=d=void 0,v=t,f=e.apply(r,n)}function g(e){var n=e-O;return void 0===O||n>=t||n<0||p&&e-v>=l}function w(){var e=i();if(g(e))return y(e);b=setTimeout(w,function(e){var n=t-(e-O);return p?s(n,l-(e-v)):n}(e))}function y(e){return b=void 0,m&&a?h(e):(a=d=void 0,f)}function I(){var e=i(),n=g(e);if(a=arguments,d=this,O=e,n){if(void 0===b)return function(e){return v=e,b=setTimeout(w,t),j?h(e):f}(O);if(p)return clearTimeout(b),b=setTimeout(w,t),h(O)}return void 0===b&&(b=setTimeout(w,t)),f}return t=Object(c.a)(t)||0,Object(r.a)(n)&&(j=!!n.leading,l=(p="maxWait"in n)?u(Object(c.a)(n.maxWait)||0,t):l,m="trailing"in n?!!n.trailing:m),I.cancel=function(){void 0!==b&&clearTimeout(b),v=0,a=O=d=b=void 0},I.flush=function(){return void 0===b?f:y(i())},I}}}]);
//# sourceMappingURL=owa.MailBoot~UpNextV2.js.map
self.scriptsLoaded['owa.MailBoot~UpNextV2.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~UpNextV2.js'] = (new Date()).getTime();