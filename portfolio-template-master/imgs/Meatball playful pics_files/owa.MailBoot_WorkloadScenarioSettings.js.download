self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~WorkloadScenarioSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[876],{10334:function(e,t,n){"use strict";var r=n(1),i=n(2),a=Object(i.action)("updateAutoOpenRegistrationInStore",(function(e,t){return{autoOpenPaneId:e,autoOpenRegistration:t}})),c=n(44),u=Object(i.action)("updateAutoOpenRegistration",(function(e,t){return{autoOpenPaneId:e,autoOpenRegistration:t}})),o=Object(i.action)("flexPaneAutoOpened",(function(e){return Object(c.c)({name:"flexPaneAutoOpened",customData:{autoOpenPaneId:e}},{autoOpenPaneId:e})})),s=["whatsNewPane","OwaTimePanel"],d=n(14),l=Object(i.createStore)("suiteHeaderAutoOpenStore",{autoOpenRegistrationMap:new d.ObservableMap});var b=n(5756),f=n(2610),O=!1;Object(i.orchestrator)(u,(function(e){var t=e.autoOpenPaneId,n=e.autoOpenRegistration;a(t,n),O||function(){var e,t,n=l().autoOpenRegistrationMap;try{for(var i=Object(r.k)(s),a=i.next();!a.done;a=i.next()){var c=a.value;if(!n.has(c))break;var u=n.get(c),d=u.shouldAutoOpen,v=u.handleAutoOpen;if(d&&!Object(b.b)()){v?v():Object(f.b)(c),o(c),O=!0;break}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}}()}));Object(i.mutator)(a,(function(e){l().autoOpenRegistrationMap.set(e.autoOpenPaneId,e.autoOpenRegistration)}));n.d(t,"a",(function(){return u}))},18511:function(e,t,n){"use strict";n.r(t);var r=n(2259),i=(n(4959),n(3112),n(3506),n(24)),a=n(209),c=n(10334),u=n(2086),o=n(2363),s=n(2),d=null;function l(){Object(o.d)("AutoOpen")}Object(s.orchestrator)(r.j,(function(e){var t=e.settings,n=e.userIdentity;if(Object(a.d)().userIdentity===n&&(d=t.isTimePanelOpen,Object(u.c)())){var r=d&&Object(o.b)()&&Object(i.i)("cal-time-panel-softPin");Object(c.a)("OwaTimePanel",{shouldAutoOpen:r,handleAutoOpen:l})}})),Object(s.orchestrator)(u.e,(function(e){if(null!==d){var t=e.isRendered&&d&&Object(o.b)()&&Object(i.i)("cal-time-panel-softPin");Object(c.a)("OwaTimePanel",{shouldAutoOpen:t,handleAutoOpen:l})}}));n(8518);n.d(t,"loadWorkloadScenarioSettings",(function(){return r.a}))},1986:function(e,t,n){"use strict";var r=n(1),i=n(2051),a=n(374),c=n(730),u=n(121),o=n(5),s="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",b="X-OWA-ExplicitLogonUser";function f(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,f,O,v,j;return Object(r.f)(this,(function(r){switch(r.label){case 0:if(n={},f=Object(a.k)(e)){if(f.accountState==a.b.AccessRevoked)return[2,null];if(f.accountState==a.b.AccountDeprovisioned||f.accountState==a.b.AccountNotFound)return Object(a.c)(f.accountState,f.accountProviderType),[2,null]}return t?(n[s]=t,n[b]=t):f&&(n[s]=f.anchorMailbox),f?(O=f.token,!(v=Object(c.g)(f.tokenExpiry))&&O?[3,2]:(Object(u.s)("getAndUpdateAccessToken",{tokenExpiry:Object(o.y)(f.tokenExpiry,Object(o.Rb)()),isTokenExpired_1:v,isTokenInvalid_2:!O},{isCore:!0}),[4,i.a.importAndExecute(f.accountId,e,O)])):[3,3];case 1:(O=r.sent())||(O=""),r.label=2;case 2:j=void 0,"Outlook"==f.accountProviderType?(j='MSAuth1.0 usertoken="'+O+'", type="MSACT"',n[l]=1..toString()):"Google"!=f.accountProviderType&&"ICloud"!=f.accountProviderType||(j="Bearer "+O,n[l]=2..toString()),n[d]=j,r.label=3;case 3:return[2,n]}}))}))}var O=n(1989),v=n(23);function j(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n=Object(O.a)(),i=n,[4,p(e,t)];case 1:return i.headers=r.sent(),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",[2,n]}}))}))}function p(e,t){var n;return Object(r.c)(this,void 0,void 0,(function(){var i,a;return Object(r.f)(this,(function(r){switch(r.label){case 0:return i=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,[4,f(e.mailboxInfo.userIdentity,m(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null)];case 1:return a=r.sent(),Object(O.b)(i,a),[2,i]}}))}))}function m(e,t){var n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&v.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return m}))},1989:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach((function(n){return e.set(n,t[n])}))}function i(e){var t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},1991:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),i=Object(r.action)("triggerReInitializeAccount",(function(e){return{userIdentity:e}}))},2030:function(e,t,n){"use strict";var r=n(1),i=n(1989);function a(e,t){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":t||e}}function c(e,t,n){t&&(e||n)&&Object(i.b)(t,a(e,n))}function u(e,t){var n,i=null!=t?t:{},a=(null===(n=i.headers)||void 0===n?void 0:n.set)?new Headers(i.headers):new Headers;return i.datapoint=i.datapoint||{},i.datapoint.mailbox=i.datapoint.mailbox||"Explicit",c(e,a),Object(r.a)(Object(r.a)({},i),{headers:a})}var o=n(374),s=n(1986),d=n(87),l=n(319);function b(e){return Object(r.c)(this,void 0,void 0,(function(){var t=this;return Object(r.f)(this,(function(n){return[2,Object(d.b)().then((function(n){return Object(r.c)(t,void 0,void 0,(function(){var t,i;return Object(r.f)(this,(function(r){switch(r.label){case 0:return e?Object(o.r)(e.userIdentity)?[4,Object(s.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null)]:[3,2]:[3,3];case 1:return t=r.sent(),l(n,t),[3,3];case 2:"GroupMailbox"!=e.type&&"TeamsMailbox"!=e.type||(i=a(e.mailboxSmtpAddress),l(n,i)),r.label=3;case 3:return[2,n]}}))}))}))]}))}))}function f(){return Object(d.b)().then((function(e){return e.prefer='exchange.Behavior="CalendarInternal"',e}))}function O(e){return void 0===e&&(e=null),Object(o.r)(e)?f().then((function(t){return Object(s.a)(e).then((function(e){return Object.keys(e).forEach((function(n){return t[n]=e[n]})),t}))})):Promise.resolve({})}var v=n(65);function j(e,t,n,r){var i=new Headers;return n&&i.set("X-OWA-CANARY",Object(v.a)()),t&&i.set("X-OWA-ActionName",t),(e||r)&&(r?c(e,i,r):c(e,i)),i}n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return b})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return f})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return j}))},2051:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(31),i=n(1991);n.d(t,"b",(function(){return i.a}));var a=new r.c((function(){return n.e(1286).then(n.bind(null,2298))})),c=new r.a(a,(function(e){return e.getAndUpdateAccessToken}))},2166:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return o}));var r,i=n(210),a=n(57);function c(){var e,t,n=d();return s()&&n?r.ToDo:(t=Object(a.h)(),(null===(e=t.SessionSettings)||void 0===e?void 0:e.IsShadowMailbox)||n?r.None:r.LegacyTasks)}function u(){return s()&&d()}function o(){return s()&&d(!0)}function s(){var e,t,n=Object(a.h)(),r=Object(i.a)("todoIsExplicitLogon")&&(null===(e=n.SessionSettings)||void 0===e?void 0:e.IsExplicitLogon),c=null===(t=n.SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return!r&&!c}function d(e){var t=Object(a.h)(),n=t.UserOptions,r=t.PolicySettings;return!!((null==n?void 0:n.ReactOptinSettings)&&(n.ReactOptinSettings.TasksGraduatedFromBeta||n.ReactOptinSettings.TasksEnabled&&(e||function(e){var t;return(null===(t=null==e?void 0:e.ReactOptinSettings)||void 0===t?void 0:t.TasksShouldUseSharedToggle)?1!==e.ClientTypeOptInState:1!==e.TasksClientTypeOptInState}(n))&&function(e){if(e&&!1===e.OutlookBetaToggleEnabled)return!1;return!0}(r))&&null!==n.ReactOptinSettings.TasksRedirectUrl)}!function(e){e[e.None=0]="None",e[e.LegacyTasks=1]="LegacyTasks",e[e.ToDo=2]="ToDo"}(r||(r={}))},2259:function(e,t,n){"use strict";var r=n(2),i=n(1),a=n(57),c=Object(r.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",(function(e,t){return{settings:e,userIdentity:t}})),u=Object(r.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED",(function(e){return{userIdentity:e}}));var o="ows/beta/ScenarioSettings",s=["IsTimePanelDatePickerExpanded","TimePanelCalendarIds","IsTimePanelCalendarViewTaskListSelected","WasFocusTimeSuggestionDisabled"];function d(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}var l=71,b=n(210);function f(e){return!!Object(b.a)("workloadScenarioSettings")&&0!=(e&l)}var O=n(737);function v(e){if(s.some((function(t){return t===e})))return"Owa";var t=Object(O.b)();return f(t)?d(t):null}var j=n(2030),p=n(151);function m(e){var t;return Object(i.c)(this,void 0,void 0,(function(){var n,r,a,c,u,s,l,b;return Object(i.f)(this,(function(i){switch(i.label){case 0:return n=["Owa"],f(r=Object(O.b)())&&(a=d(r),n.push(a)),c=function(e){var t=e.join(",");return o+"/?Scenarios="+t}(n),s=p.b,l=[c,void 0,void 0],[4,Object(j.b)(e)];case 1:return[4,s.apply(void 0,l.concat([i.sent(),!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS"]))];case 2:return u=i.sent(),b={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null,isTimePanelOpen:!1,isTimePanelDatePickerExpanded:!1,isTimePanelCalendarViewTaskListSelected:!0,wasFocusTimeSuggestionDisabled:!1},null===(t=null==u?void 0:u.settings)||void 0===t||t.forEach((function(e){var t,n=v(e.settingName);(t=e).calendarIds&&"TimePanelCalendarIds"===t.settingName&&n===v("TimePanelCalendarIds")?b.timePanelCalendarIds=e.calendarIds:!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)||n!==v("TimePanelSelectedView")?!function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)||n!==v("SelectedCalendarListView")?!function(e){return void 0!==e.isOpen&&"IsTimePanelOpen"===e.settingName}(e)||n!==v("IsTimePanelOpen")?!function(e){return void 0!==e.isExpanded&&"IsTimePanelDatePickerExpanded"===e.settingName}(e)||n!==v("IsTimePanelDatePickerExpanded")?!function(e){return void 0!==e.isSelected&&"IsTimePanelCalendarViewTaskListSelected"===e.settingName}(e)||n!==v("IsTimePanelCalendarViewTaskListSelected")?function(e){return void 0!==e.wasDisabled&&"WasFocusTimeSuggestionDisabled"===e.settingName}(e)&&n===v("WasFocusTimeSuggestionDisabled")&&(b.wasFocusTimeSuggestionDisabled=e.wasDisabled):b.isTimePanelCalendarViewTaskListSelected=e.isSelected:b.isTimePanelDatePickerExpanded=e.isExpanded:b.isTimePanelOpen=e.isOpen:b.timePanelSelectedCalendarView=e.selectedView:b.timePanelSelectedView=e.selectedView})),[2,b]}}))}))}var h=n(742),S=Object(h.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(h.a)(1e3)}),w={};function T(){return Object(i.c)(this,void 0,void 0,(function(){var e;return Object(i.f)(this,(function(t){switch(t.label){case 0:return e=Object(a.e)().map(g),[4,Promise.all(e)];case 1:return t.sent(),[2]}}))}))}function g(e){return Object(i.c)(this,void 0,void 0,(function(){var t;return Object(i.f)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),w[e]?[2]:(w[e]=S((function(){return m(e)})),[4,w[e].retriableFunc()]);case 1:return t=n.sent(),c(t,e),[3,3];case 2:return n.sent(),u(e),[3,3];case 3:return[2]}}))}))}var I=n(1283);Object(r.orchestrator)(I.e,(function(e){g(e.userIdentity)}));function P(e,t){return o+"/"+e+"/"+t}function k(e){return Object(i.c)(this,void 0,void 0,(function(){var t,n,r;return Object(i.f)(this,(function(i){switch(i.label){case 0:return(t=v("TimePanelSelectedView"))?(n=P(t,"TimePanelSelectedView"),r={ViewType:e},[4,Object(p.d)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}function x(e,t){return Object(i.c)(this,void 0,void 0,(function(){var n,r,a,c,u;return Object(i.f)(this,(function(i){switch(i.label){case 0:return(n=v("TimePanelCalendarIds"))?(r=P(n,"TimePanelCalendarIds"),a={CalendarIds:e},c=p.d,u=[r,a,void 0,void 0],[4,Object(j.b)(t)]):[3,3];case 1:return[4,c.apply(void 0,u.concat([i.sent(),!0,void 0,"UpdateTimePanelCalendarIdsRequest"]))];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function y(e){return Object(i.c)(this,void 0,void 0,(function(){var t,n,r;return Object(i.f)(this,(function(i){switch(i.label){case 0:return(t=v("IsTimePanelOpen"))?(n=P(t,"IsTimePanelOpen"),r={IsOpen:e},[4,Object(p.d)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}function C(e){return Object(i.c)(this,void 0,void 0,(function(){var t,n,r;return Object(i.f)(this,(function(i){switch(i.label){case 0:return(t=v("SelectedCalendarListView"))?(n=P(t,"SelectedCalendarListView"),r={ViewType:e},[4,Object(p.d)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}function E(e){return Object(i.c)(this,void 0,void 0,(function(){var t,n,r;return Object(i.f)(this,(function(i){switch(i.label){case 0:return(t=v("IsTimePanelDatePickerExpanded"))?(n=P(t,"IsTimePanelDatePickerExpanded"),r={isExpanded:e},[4,Object(p.d)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}function A(e){return Object(i.c)(this,void 0,void 0,(function(){var t,n,r;return Object(i.f)(this,(function(i){switch(i.label){case 0:return(t=v("IsTimePanelCalendarViewTaskListSelected"))?(n=P(t,"IsTimePanelCalendarViewTaskListSelected"),r={isSelected:e},[4,Object(p.d)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}function D(e){return Object(i.c)(this,void 0,void 0,(function(){var t,n,r;return Object(i.f)(this,(function(i){switch(i.label){case 0:return(t=v("WasFocusTimeSuggestionDisabled"))?(n=P(t,"WasFocusTimeSuggestionDisabled"),r={wasDisabled:e},[4,Object(p.d)(n,r,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}n.d(t,"j",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return T})),n.d(t,"h",(function(){return k})),n.d(t,"g",(function(){return x})),n.d(t,"f",(function(){return y})),n.d(t,"e",(function(){return C})),n.d(t,"d",(function(){return E})),n.d(t,"c",(function(){return A})),n.d(t,"i",(function(){return D}))},2289:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("closeFlexPane",(function(e){return{flexPaneId:e}}));t.a=i},2363:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("openTimePanel",(function(e){return{source:e}})),a=Object(r.action)("handleTimePanelClosed",(function(e,t,n,r){return{source:e,sessionDuration:t,lastView:n,clientItemId:r}})),c=Object(r.action)("popView"),u=n(514);function o(){return!Object(u.w)()||!window.opener}var s=n(2572);function d(){return o()&&Object(s.a)("Tasks")}n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return d}))},2479:function(e,t,n){"use strict";var r=n(1),i={abovePanelHeight:n(2820).b,initialPanelView:"Calendar",initialCalendarView:"Agenda",areFREsDisabled:!1,isFullComposeEnabled:!1,isClosePaneButtonEnabled:!1,isTasksViewDisabled:!1};function a(e){i=Object(r.a)({},e)}function c(){return i}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}))},2572:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2648),i=n(2479),a=n(2166);function c(e){return"Tasks"!==Object(r.a)(e)||Object(a.c)()&&!Object(i.a)().isTasksViewDisabled}},2610:function(e,t,n){"use strict";function r(){return window.O365Shell}var i=n(2),a=Object(i.action)("openFlexPane",(function(e){return{flexPaneId:e}})),c=(Object(i.orchestrator)(a,(function(e){var t=r();t&&t.FlexPane.OpenFlexPaneForProvider(e.flexPaneId)})),n(2289));Object(i.orchestrator)(c.a,(function(e){var t=r();t&&t.FlexPane.CloseFlexPaneForProvider(e.flexPaneId)}));function u(e){var t=r();t&&t.Theme.SetSearchActive(e)}function o(e,t){requestAnimationFrame((function(){return r().Extensibility.SetCustomHeaderButtonBadgeValue(e,t)}))}function s(e,t){r().Extensibility.UpdateButtonState(e,t)}n.d(t,"a",(function(){return c.a})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s}))},2648:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r={Conflicts:"Calendar",EventDetails:"Calendar",AttendeeTracking:"Calendar",Calendar:"Calendar",ComposeForm:"Calendar",Tasks:"Tasks",TaskDetails:"Tasks"};function i(e){return e?r[e]:null}},2820:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r=48,i=65},3112:function(e,t,n){"use strict";var r=n(2479),i=n(2),a=Object(i.createStore)("timePanelSettingStore",{panelViewStack:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{stack:e||[]}}(Object(r.a)().initialPanelView)}),c=n(2572),u=n(2259),o=n(209),s=Object(i.action)("pushTimePanelView",(function(e){return{newView:e}})),d=Object(i.action)("updateTopTimePanelView",(function(e){return{updatedView:e}})),l=Object(i.action)("popTimePanelView");function b(e){Object(c.a)(e)&&function(e,t){if(0===t.length)return null;t[t.length-1]=e}(e,a().panelViewStack.stack)}Object(i.mutator)(s,(function(e){var t,n=e.newView;Object(c.a)(n)&&(t=n,a().panelViewStack.stack.push(t))})),Object(i.mutator)(d,(function(e){return b(e.updatedView)})),Object(i.mutator)(l,(function(){var e=a().panelViewStack;e.stack.pop()})),Object(i.mutator)(u.j,(function(e){var t=e.settings,n=e.userIdentity;Object(o.d)().userIdentity===n&&t.timePanelSelectedView&&b(t.timePanelSelectedView)}));var f=n(1),O=n(742),v=n(23),j=Object(O.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(O.a)(1e3)}),p=null;Object(i.orchestrator)(d,(function(e){return Object(f.c)(void 0,void 0,void 0,(function(){var t,n;return Object(f.f)(this,(function(r){switch(r.label){case 0:if(t=e.updatedView,"Tasks"!==(i=t)&&"Calendar"!==i||!Object(c.a)(t))return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),p&&p.cancel(),[4,(p=j((function(){return Object(u.h)(t)}))).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),v.g.warn("viewStackOrchestrator: updateTimePanelSelectedViewService with retry failed: "+n),[3,4];case 4:p=null,r.label=5;case 5:return[2]}var i}))}))}));var m=n(2648);function h(){return Object(m.a)(S())}function S(){var e,t=a().panelViewStack;return 0===(e=t.stack).length?null:e[e.length-1]}function w(){return a().panelViewStack.stack.length}function T(){return-1!==a().panelViewStack.stack.indexOf("Conflicts")}function g(){return-1!==a().panelViewStack.stack.indexOf("AttendeeTracking")}function I(){var e=a().panelViewStack;return w()>=2?e.stack[w()-2]:null}n.d(t,"j",(function(){return s})),n.d(t,"k",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return S})),n.d(t,"e",(function(){return w})),n.d(t,"g",(function(){return T})),n.d(t,"f",(function(){return g})),n.d(t,"d",(function(){return I})),n.d(t,"c",(function(){return m.a})),n.d(t,"h",(function(){return c.a}))},3506:function(e,t,n){"use strict";var r=n(2),i=n(44),a=Object(r.action)("updateSelectedCalendarView",(function(e){return{updatedView:e}})),c=Object(r.action)("updateIsTaskListSelected",(function(e){return Object(i.c)({name:"updateIsTaskListSelected",customData:{isSelected:e}},{isSelected:e})})),u=Object(r.action)("updateIsDatePickerExpanded",(function(e){return Object(i.c)({name:"updateIsDatePickerExpanded",customData:{isExpanded:e}},{isExpanded:e})})),o=n(57),s=n(2479),d=Object(r.createStore)("calendarListSettingsStore",{selectedView:Object(s.a)().initialCalendarView,isDatePickerExpanded:Object(o.s)(),isTaskListSelected:!0});function l(){return d().selectedView}function b(){return d().isTaskListSelected}function f(){return d().isDatePickerExpanded}var O=n(2259),v=n(209);function j(e){d().isDatePickerExpanded=e}function p(e){d().isTaskListSelected=e}Object(r.mutator)(u,(function(e){return j(e.isExpanded)})),Object(r.mutator)(O.j,(function(e){var t=e.settings,n=e.userIdentity;Object(v.d)().userIdentity===n&&null!==t.isTimePanelDatePickerExpanded&&void 0!==t.isTimePanelDatePickerExpanded&&j(e.settings.isTimePanelDatePickerExpanded)})),Object(r.mutator)(c,(function(e){return p(e.isSelected)})),Object(r.mutator)(O.j,(function(e){var t=e.settings,n=e.userIdentity;Object(v.d)().userIdentity===n&&null!==t.isTimePanelCalendarViewTaskListSelected&&void 0!==t.isTimePanelCalendarViewTaskListSelected&&p(e.settings.isTimePanelCalendarViewTaskListSelected)}));var m=Object(r.action)("updateSelectedCalendarViewInStore",(function(e){return{updatedView:e}})),h=(Object(r.mutator)(m,(function(e){var t=e.updatedView;d().selectedView=t})),n(1)),S=n(742),w=n(23),T=Object(S.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(S.a)(1e3)}),g=null;Object(r.orchestrator)(u,(function(e){return Object(h.c)(void 0,void 0,void 0,(function(){var t,n;return Object(h.f)(this,(function(r){switch(r.label){case 0:t=e.isExpanded,r.label=1;case 1:return r.trys.push([1,3,,4]),g&&g.cancel(),[4,(g=T((function(){return Object(O.d)(t)}))).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),w.g.warn("updateIsDatePickerExpandedOrchestrator: updateIsTimePanelDatePickerExpandedService with retry failed: "+n),[3,4];case 4:return g=null,[2]}}))}))}));var I=Object(S.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(S.a)(1e3)}),P=null;Object(r.orchestrator)(c,(function(e){return Object(h.c)(void 0,void 0,void 0,(function(){var t,n;return Object(h.f)(this,(function(r){switch(r.label){case 0:t=e.isSelected,r.label=1;case 1:return r.trys.push([1,3,,4]),P&&P.cancel(),[4,(P=I((function(){return Object(O.c)(t)}))).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),w.g.warn("updateIsTaskListSelectedOrchestrator: updateIsTimePanelCalendarViewTaskListSelectedService with retry failed: "+n),[3,4];case 4:return P=null,[2]}}))}))}));var k=Object(S.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(S.a)(1e3)}),x=null;Object(r.orchestrator)(a,(function(e){return Object(h.c)(void 0,void 0,void 0,(function(){var t,n;return Object(h.f)(this,(function(r){switch(r.label){case 0:t=e.updatedView,m(t),r.label=1;case 1:return r.trys.push([1,3,,4]),x&&x.cancel(),[4,(x=k((function(){return Object(O.e)(t)}))).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),w.g.warn("updateSelectedCalendarViewOrchestrator: updateSelectedCalendarView with retry failed: "+n),[3,4];case 4:return x=null,[2]}}))}))}));Object(r.orchestrator)(O.j,(function(e){var t=e.settings,n=e.userIdentity;Object(v.d)().userIdentity===n&&t.timePanelSelectedCalendarView&&m(t.timePanelSelectedCalendarView)}));n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return f}))},4959:function(e,t,n){"use strict";var r,i=n(2),a=Object(i.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS_IN_STORE",(function(e,t){return{calendarIds:e,userIdentity:t}})),c=Object(i.action)("SET_TIME_PANEL_CONFIG_LOAD_STATE",(function(e,t){return{loadState:e,userIdentity:t}})),u=Object(i.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",(function(e,t){return{calendarIds:e,userIdentity:t}})),o=Object(i.action)("ON_SELECTED_TIME_PANEL_CALENDARIDS_UPDATED");!function(e){e[e.Loaded=0]="Loaded",e[e.Failed=1]="Failed"}(r||(r={}));var s=n(2259),d=(Object(i.orchestrator)(s.b,(function(e){c(r.Failed,e.userIdentity),o()})),n(14)),l=Object(i.createStore)("timePanelSelectedCalendarIdsStore",{configLoadStates:new d.ObservableMap,calendarIdsMap:new d.ObservableMap}),b=n(2080);function f(){return Object(b.c)(l().calendarIdsMap)}function O(e){return e?function(e){var t=f().get(e);return t?t.length:0}(e):Object(b.d)(f()).length}function v(){return O()>0}var j=n(2286),p=(Object(i.orchestrator)(j.f,(function(){v()||o()})),n(1));function m(){return l().configLoadStates}var h=n(374),S=n(76),w=n(209);function T(){var e=m(),t=0===e.size,n=new d.ObservableMap;return t?n:(Object(p.j)([Object(w.d)().userIdentity],Object(p.g)(Object(h.n)().map((function(e){return e.userIdentity})))).forEach((function(t){if(v()&&e.get(t)!==r.Failed)n.set(t,f().get(t));else if(Object(j.c)()>0)n.set(t,Object(j.b)().get(t));else{var i=Object(S.v)(t);i&&n.set(t,[i.id.id])}})),n)}var g=n(742),I=n(57),P=n(23),k=Object(g.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(g.a)(1e3)}),x={};Object(i.orchestrator)(u,(function(e){return Object(p.c)(void 0,void 0,void 0,(function(){var t,n;return Object(p.f)(this,(function(r){switch(r.label){case 0:return t=e.calendarIds,n=e.userIdentity,Object(w.d)().userIdentity===n&&1===O()&&1===O(n)&&0===t.length?[2]:v()?[3,2]:[4,y()];case 1:r.sent(),r.label=2;case 2:return E(t,n),[2]}}))}))}));function y(){return Object(p.c)(this,void 0,void 0,(function(){return Object(p.f)(this,(function(e){switch(e.label){case 0:return[4,Promise.all(Object(I.e)().map((function(e){var t,n=null!==(t=Object(j.b)().get(e))&&void 0!==t?t:[];if(0===Object(j.c)()){var r=Object(S.v)(e);r&&(n=[r.id.id])}E(n,e,!0)})))];case 1:return e.sent(),[2]}}))}))}var C=1e3;function E(e,t,n){var r;return Object(p.c)(this,void 0,void 0,(function(){var i,c,u,d,l,f;return Object(p.f)(this,(function(O){switch(O.label){case 0:i=Object(b.b)(e),c=T().get(t),O.label=1;case 1:return O.trys.push([1,3,4,5]),a(i,t),n||o(),null===(r=x[t])||void 0===r||r.cancel(),u=k((function(){return Object(s.g)(i,t)})),v=u.retriableFunc,j=C,p=!1,l={cancel:function(){d.cancel(),u.cancel()},updateFunc:(d={delayFunc:function(){return new Promise((function(e,t){return function(e,t){setTimeout((function(){if(!p)return v(),e()}),j)}(e)}))},cancel:function(){return p=!0}}).delayFunc},x[t]=l,[4,l.updateFunc()];case 2:return O.sent(),[3,5];case 3:return f=O.sent(),P.g.warn("updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: "+f),a(c,t),n||o(),[3,5];case 4:return delete x[t],[7];case 5:return[2]}var v,j,p}))}))}Object(i.orchestrator)(s.j,(function(e){var t,n=e.settings,i=e.userIdentity;c(r.Loaded,i),(null===(t=n.timePanelCalendarIds)||void 0===t?void 0:t.length)>0&&a(n.timePanelCalendarIds,i),o()})),Object(i.mutator)(c,(function(e){var t=e.userIdentity,n=e.loadState;l().configLoadStates.set(t,n)})),Object(i.mutator)(a,(function(e){var t=e.calendarIds,n=e.userIdentity;l().calendarIdsMap.set(n,Object(b.b)(t))}));function A(){return Object(b.d)(T())}n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return T})),n.d(t,"b",(function(){return A}))},5756:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("DEACTIVATE_CHARM",(function(e){return{charm:e}})),a=Object(r.createStore)("headerViewState",{activeCharm:null});Object(r.mutator)(i,(function(e){var t=e.charm,n=a();n.activeCharm===t&&(n.activeCharm=null)}));var c=Object(r.action)("TOGGLE_CHARM",(function(e){return{charm:e}}));function u(){return a().activeCharm}Object(r.mutator)(c,(function(e){var t=e.charm,n=a();n.activeCharm===t?n.activeCharm=null:n.activeCharm=t})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c}))},8518:function(e,t,n){"use strict";var r=n(2),i=n(44),a=Object(r.action)("updateWasSuggestionDisabled",(function(e){return Object(i.c)({name:"updateWasSuggestionDisabledSetting",options:{isCore:!0},customData:{wasDisabled_1:e}},{wasDisabled:e})})),c=Object(r.createStore)("focusTimeSettingsStore",{wasSuggestionDisabled:!1});function u(){return c().wasSuggestionDisabled}var o=n(2259),s=n(209);Object(r.mutator)(a,(function(e){c().wasSuggestionDisabled=e.wasDisabled})),Object(r.mutator)(o.j,(function(e){var t=e.settings,n=e.userIdentity;Object(s.d)().userIdentity===n&&t.wasFocusTimeSuggestionDisabled&&(c().wasSuggestionDisabled=t.wasFocusTimeSuggestionDisabled)}));var d=n(1),l=n(742),b=n(23),f=Object(l.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(l.a)(1e3)}),O=null;Object(r.orchestrator)(a,(function(e){return Object(d.c)(void 0,void 0,void 0,(function(){var t,n;return Object(d.f)(this,(function(r){switch(r.label){case 0:t=e.wasDisabled,r.label=1;case 1:return r.trys.push([1,3,,4]),O&&O.cancel(),[4,(O=f((function(){return Object(o.i)(t)}))).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),b.g.warn("updateWasSuggestionDisabledOrchestrator: updateWasFocusTimeSuggestionDisabledService with retry failed: "+n),[3,4];case 4:return O=null,[2]}}))}))})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return u}))}}]);
//# sourceMappingURL=owa.MailBoot~WorkloadScenarioSettings.js.map
self.scriptsLoaded['owa.MailBoot~WorkloadScenarioSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~WorkloadScenarioSettings.js'] = (new Date()).getTime();