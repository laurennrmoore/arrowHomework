self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailComposeCommand.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[916],{16750:function(e){e.exports=JSON.parse('{"a":"Hvc","b":"Ivc"}')},18417:function(e,t,n){"use strict";n.r(t);var c=n(3479),i=n(2806),r=n(2805),o=n(3480);function a(e,t){t&&(Object(c.a)(e)||Object(r.d)(e)||!Object(o.b)(e))||(Object(i.a)(e),Object(r.b)(e,t))}var s=n(3610),u=n(8484);function b(e,t){Object(i.a)(e),Object(c.a)(e)?(Object(r.b)(e),Object(s.a)(e,"SavePublicFolder")):Object(u.a)(e,t).catch((function(e){return e}))}var l=n(8355),f=n(5560);function d(e,t){Object(f.b)(e)&&Object(l.a)(null==t?void 0:t.document),Object(i.a)(e),Object(f.a)(e,t)}var j=n(9535),O=n(1),p=n(9590),v=n(8023),h=n(731),g=n(6),m=n(2),S=n(16750),w=n(4084),x=n(2078),k=n(8558),E=n(2128),T=n(2013);function y(e,t){return Object(O.c)(this,void 0,void 0,(function(){var n,c,i;return Object(O.f)(this,(function(o){switch(o.label){case 0:return[4,x.c.import()];case 1:return n=o.sent(),[4,P(e,n,t)];case 2:return o.sent()?(c="",i=!0,n(e,(function(t){return t.queryElements("img",(function(e){return t.deleteNode(e)})),c=t.getContent(3),function(e){var t,n=null===(t=null==e?void 0:e.attachmentWell)||void 0===t?void 0:t.inlineAttachments;n.length>0&&E.g.import().then((function(t){var c=Object(O.a)(Object(O.a)({},e.itemId),{mailboxInfo:Object(T.a)()}),i=function(e,t,n){Object(E.w)(e,t,n)};n.forEach((function(n){t(e.attachmentWell,n,c,e,i)}))}))}(e),null}),(function(e){return c=Object(p.a)(e),i=!1,null})),[4,Object(r.b)(e,!0)]):[3,4];case 3:o.sent(),Object(w.a)(e,!1),A(e,c,i),"Text"==e.bodyType&&Object(k.a)(e.expressionId,t),o.label=4;case 4:return[2]}}))}))}function P(e,t,n){return Object(O.c)(this,void 0,void 0,(function(){var c,i;return Object(O.f)(this,(function(r){switch(r.label){case 0:return!(c="Text"==e.bodyType)&&Object(v.a)(e).length>0?(Object(h.b)(null,Object(g.b)(S.a),!1,{targetWindow:n,hideCancelButton:!0}),[2,!1]):[3,1];case 1:return i=c||function(e,t){var n=!1;return t(e,(function(e){return n=e.isEmpty(),null})),n}(e,t),[4,Object(h.b)(null,Object(g.b)(S.b),i,{targetWindow:n})];case 2:return[2,r.sent()==h.a.ok]}}))}))}var A=Object(m.mutatorAction)("switchBodyType",(function(e,t,n){e.content=t,e.bodyType=n?"Text":"HTML",e.isRibbonShown=!n,e.docking.isBottomDocking=!1,e.isDirty=!0})),I=n(10311);n.d(t,"save",(function(){return a})),n.d(t,"send",(function(){return b})),n.d(t,"discard",(function(){return d})),n.d(t,"upConvert",(function(){return j.a})),n.d(t,"switchBodyType",(function(){return y})),n.d(t,"runPostOpenTasks",(function(){return I.a}))},3563:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var c=n(31),i=new c.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(6),n.e(640)]).then(n.bind(null,5379))})),r=new c.a(i,(function(e){return e.mountAndShowFlexPane})),o=new c.a(i,(function(e){return e.hideFlexPane}))},4609:function(e,t,n){"use strict";var c=n(2);t.a=Object(c.action)("toggleExpressionSidePane",(function(e){return{showExpressionPane:e}}))},5546:function(e,t,n){"use strict";var c=n(2);t.a=Object(c.mutatorAction)("updateExpressionPage",(function(e,t){if(e.page.toString()!=t)switch(t){case"0":e.page=0;break;case"1":e.page=1;break;case"2":e.page=2}}))},6011:function(e,t,n){"use strict";var c=n(183);t.a=Object(c.action)("setExpressionPickerIsOpen")((function(e,t){e.isOpen=t}))},6499:function(e,t,n){"use strict";var c=n(183);t.a=Object(c.action)("setEmojiCategoryIndex")((function(e,t){e.emojiCategoryIndex=t}))},7125:function(e,t,n){"use strict";var c=n(2);t.a=Object(c.mutatorAction)("setExpressionPickerOpenedSource",(function(e,t){e.source=t}))},7126:function(e,t,n){"use strict";var c=n(2);t.a=Object(c.mutatorAction)("setShouldRestoreSelectionAfterInsertNode",(function(e,t){e.shouldRestoreSelectionAfterInsertNode=t}))},7127:function(e,t,n){"use strict";var c=n(2);t.a=Object(c.mutatorAction)("setWordToReplace",(function(e,t){e.wordToReplace=t}))},7128:function(e,t,n){"use strict";var c=n(1),i=n(4367),r=n(8528),o=n(8011),a=n(183);t.a=Object(a.action)("updateSearch")((function(e,t,n,a){return Object(c.c)(this,void 0,void 0,(function(){var s;return Object(c.f)(this,(function(c){switch(c.label){case 0:return t===e.searchTerm?[2]:(e.isSearching=!0,e.searchTerm=t,t?e.gifPickerViewState?(s=e.gifPickerViewState,[4,Object(o.a)(e.gifPickerViewState,t,n,a)]):[3,2]:[3,3]);case 1:s.gifResults=c.sent(),c.label=2;case 2:return e.emojiPickerViewState.emojiResults=Object(r.a)(t),2!==e.page&&e.numSearchesToInsertEmoji++,[3,4];case 3:e.gifPickerViewState&&(e.gifPickerViewState.gifResults=null),e.emojiPickerViewState.emojiResults=Object(i.a)(),c.label=4;case 4:return e.isSearching=!1,[2]}}))}))}))},8355:function(e,t,n){"use strict";var c,i=n(67),r=Object(i.h)()?function(e){!c&&e&&((c=e.createElement("input")).type="textbox",c.style.width="0",c.style.height="0",e.body.appendChild(c)),c.style.display="",c.focus(),c.style.display="none"}:function(){};t.a=r},8558:function(e,t,n){"use strict";var c=n(6499),i=n(6011),r=n(7125),o=n(7126),a=n(7127),s=n(5546),u=n(8010),b=n(2981),l=n(183),f=n(1080),d=n(121),j=Object(l.action)("saveEmojiSkinToneToServer")((function(e){var t=Object(f.f)(f.c.DiverseEmojis);if(t.diverseEmojisSelectedSkinTone!=b.a.selectedSkinTone){t.diverseEmojisSelectedSkinTone=b.a.selectedSkinTone;var n=f.h.importAndExecute(f.c.DiverseEmojis,t);if(e){var c="ExpressionPicker_EmojiSkinToneSavedToServer";n.then((function(){Object(d.s)(c,[!0])})).catch((function(e){Object(d.s)(c,[!1,b.a.selectedSkinTone,O(e.toString())])}))}}}));function O(e){switch(e){case"Options are not loaded. Cannot update options.":return 0;case"Error: Error processing options response":return 1;default:return 2}}var p=n(7128),v=n(5105),h=n(102),g=n(2),m=Object(g.action)("resetExpressionPickerViewState",(function(e){return{viewState:e}}));Object(g.orchestrator)(m,(function(e){var t=e.viewState;Object(i.a)(t,!1),t.searchTerm&&Object(p.a)(t,"",null),Object(s.a)(t,Object(v.a)()?(0).toString():1..toString()),Object(a.a)(t,""),Object(u.a)(t),Object(c.a)(t,0),Object(r.a)(t,null),Object(o.a)(t,!1),Object(h.g)()||j(!0)}));var S=m,w=n(4609),x=n(3563),k=n(514);function E(e,t){var n=b.a.expressionPickerViewStates.get(e||b.a.primaryExpressionId);(null==n?void 0:n.isOpen)&&(Object(i.a)(n,!1),S(n),b.a.useFlexPane?Object(k.w)()||t&&t!==window?x.a.importAndExecute(t):window.O365Shell.FlexPane.CloseFlexPaneForProvider("Expressions"):Object(w.a)(!1))}n.d(t,"a",(function(){return E}))},9590:function(e,t,n){"use strict";function c(e){return e?"<div>"+(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&#39;")).replace(/"/g,"&quot;")).replace(/^ /gm,"&nbsp;")).replace(/(\n|\r\n)/g,"<br></div><div>")).replace(/\s\s/g," &nbsp;"))+"<br></div>":e}n.d(t,"a",(function(){return c}))}}]);
//# sourceMappingURL=owa.MailComposeCommand.js.map
self.scriptsLoaded['owa.MailComposeCommand.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailComposeCommand.js'] = (new Date()).getTime();