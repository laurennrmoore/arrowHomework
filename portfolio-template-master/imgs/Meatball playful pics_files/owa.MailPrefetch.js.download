self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailPrefetch.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[931],{2308:function(n,e,t){"use strict";t.d(e,"a",(function(){return r})),t.d(e,"b",(function(){return o})),t.d(e,"c",(function(){return i}));var r=20,o=10,i=100},2449:function(n,e,t){"use strict";var r=t(31),o=t(2560),i=t(1956),c=t(183),a=Object(c.action)("setIsPendingDeleteConversationItemParts")((function(n,e,t){void 0===t&&(t={conversationItemParts:i.u.conversations.get(n)});var r=t.conversationItemParts;r&&(r.isPendingDelete=e)})),u=t(2308);t.d(e,"d",(function(){return s})),t.d(e,"f",(function(){return d})),t.d(e,"e",(function(){return l})),t.d(e,"c",(function(){return o.a})),t.d(e,"g",(function(){return a})),t.d(e,"a",(function(){return u.b})),t.d(e,"b",(function(){return u.c}));var f=new r.c((function(){return Promise.all([t.e(15),t.e(17),t.e(16),t.e(286),t.e(722)]).then(t.bind(null,18252))})),s=new r.a(f,(function(n){return n.loadAllRecipientsForItem})),d=new r.a(f,(function(n){return n.loadItem})),l=new r.a(f,(function(n){return n.loadConversation}))},2560:function(n,e,t){"use strict";t.d(e,"a",(function(){return u}));var r=t(1),o=t(1956),i=t(2487),c=t(3036),a=t(2);function u(n){var e,t,a,u;if(o.u.conversations.has(n)){var d=o.u.conversations.get(n);try{for(var l=Object(r.k)(d.conversationNodeIds),v=l.next();!v.done;v=l.next()){var w=v.value,h=o.u.conversationNodes.get(w);if(h)try{for(var O=(a=void 0,Object(r.k)(h.itemIds)),y=O.next();!y.done;y=O.next()){var b=y.value;Object(i.a)(b,1)}}catch(n){a={error:n}}finally{try{y&&!y.done&&(u=O.return)&&u.call(O)}finally{if(a)throw a.error}}f(w)}}catch(n){e={error:n}}finally{try{v&&!v.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}s(n)}Object(c.a)()}var f=Object(a.mutatorAction)("deleteConversationNode",(function(n){o.u.conversationNodes.delete(n)})),s=Object(a.mutatorAction)("deleteConversation",(function(n){o.u.conversations.delete(n)}))},3036:function(n,e,t){"use strict";t.d(e,"a",(function(){return o})),t.d(e,"b",(function(){return i}));var r=t(2),o=Object(r.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),i=Object(r.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},5763:function(n,e,t){"use strict";t.r(e);var r=t(2066),o=t(1956);var i=t(1947),c=t(2449),a=t(128),u=t(24);function f(){return Object(u.i)("fwk-prefetch-data-off")}function s(n,e,t,r){if(!f()){var o=e.rowKeys.indexOf(n);if(!(o<0||o>e.currentLoadedIndex))d(i.b.getRowClientItemId(n,e),e,t,r)}}function d(n,e,t,i){if(!f()){var u=e.tableQuery.listViewType;if(n&&function(n,e,t,i){var c;if(void 0===i&&(i={conversationCache:r.a,items:o.u.items}),0===e)c=i.conversationCache.get(n);else if(1===e){var a=i.items.get(n);c=null==a?void 0:a.NormalizedBody}return t?null!=c:null==c}(n.Id,u,t)){var s;switch(u){case 0:s=c.e;break;case 1:s=c.f}s&&s.import().then((function(e){Object(a.a)((function(){e(n,i)}))}))}}}var l,v=1e3;function w(n,e){d(n,e,!0,"PrefetchRowInCache")}function h(n,e,t){s(n,e,t,"PrefetchSingleRow")}function O(n,e){for(var t=Math.min(n.rowKeys.length,e),r=0;r<t;r++)s(n.rowKeys[r],n,!1,"PrefetchFirstN")}function y(n,e){l&&(clearTimeout(l),l=null),l=setTimeout((function(){l=null;var t=e.rowKeys.indexOf(n),r=t-1;r>=0&&s(e.rowKeys[r],e,!1,"PrefetchAdjacentRowsOnDelay"),(r=t+1)<e.rowKeys.length&&s(e.rowKeys[r],e,!1,"PrefetchAdjacentRowsOnDelay")}),v)}t.d(e,"prefetchRowInCache",(function(){return w})),t.d(e,"prefetchSingleRow",(function(){return h})),t.d(e,"prefetchFirstN",(function(){return O})),t.d(e,"prefetchAdjacentRowsOnDelay",(function(){return y}))}}]);
//# sourceMappingURL=owa.MailPrefetch.js.map
self.scriptsLoaded['owa.MailPrefetch.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailPrefetch.js'] = (new Date()).getTime();