self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.NotificationDiagnostics.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[952],{12146:function(t,n,e){"use strict";e.r(n);var i=e(1),r=e(869),o=e(24);function a(){return new Date(Date.now()).toLocaleTimeString()}function c(t,n,e){t.push(n),t.length>e&&t.splice(0,1)}var s,u=e(183),d=Object(u.action)("addChannelDatapoint")((function(t,n){c(n.datapoints,{message:t,timestamp:a()},1e3)})),f=e(2815),l="Channel",b=!1;function p(t){!function(){Object(i.c)(this,void 0,void 0,(function(){var t,n,e;return Object(i.f)(this,(function(i){switch(i.label){case 0:return b?[3,3]:(b=!0,s={name:l,datapoints:[]},[4,f.e.import()]);case 1:return t=i.sent(),[4,f.f.import()];case 2:n=i.sent(),e=t(),n(s),s=e.loggers.get(l),i.label=3;case 3:return[2]}}))}))}(),d(t,s)}var v=e(1951);function g(t){var n="";if(t){var e=v.d.folderTable.get(t);e&&(n=e.DisplayName)}return n}function h(t){var n="";return t.Conversation?n=t.Conversation.ConversationTopic:t.Item&&(n=t.Item.Subject),n}var m,j=Object(u.action)("addNotificationDatapoint")((function(t,n){var e=t,i=t;c(n.datapoints,{id:t.id,type:t.EventType,folder:g(e.FolderId||i.folderId),subject:h(e),timestamp:a()},1e3)})),w="Notifications",O=!1;function D(t){!function(){Object(i.c)(this,void 0,void 0,(function(){var t,n,e;return Object(i.f)(this,(function(i){switch(i.label){case 0:return O?[3,3]:(O=!0,m={name:w,datapoints:[]},[4,f.e.import()]);case 1:return t=i.sent(),[4,f.f.import()];case 2:n=i.sent(),e=t(),n(m),m=e.loggers.get(w),i.label=3;case 3:return[2]}}))}))}(),j(t,m)}var S,I=Object(u.action)("addSubscriptionDatapoint")((function(t,n){var e;n.datapoints.push({id:t.subscriptionId,type:(null===(e=t.subscriptionParameters)||void 0===e?void 0:e.NotificationType)?t.subscriptionParameters.NotificationType:"",folder:t.subscriptionParameters?g(t.subscriptionParameters.FolderId):"",status:"Uninitialized",handlers:1,retries:0,error:""})})),T=Object(u.action)("disconnectSubscriptionDatapoint")((function(t,n){for(var e=n.datapoints,i=0;i<e.length;i++)if(e[i].id===t){e[i].status="Disconnected";break}})),C=Object(u.action)("setSubscriptionDatapointStatus")((function(t,n,e,i,r,o){for(var a=o.datapoints,c=0;c<a.length;c++)if(a[c].id===t)switch(a[c].handlers=e,a[c].retries=i,r&&(a[c].error=r),n){case 0:a[c].status="Uninitialized";break;case 3:a[c].status="Connected";break;case 2:a[c].status="Pending";break;case 1:a[c].status="Disconnected"}})),P="Subscriptions",N=!1;function y(){return Object(i.c)(this,void 0,void 0,(function(){var t,n,e;return Object(i.f)(this,(function(i){switch(i.label){case 0:return N?[3,3]:(N=!0,S={name:P,datapoints:[]},[4,f.e.import()]);case 1:return t=i.sent(),[4,f.f.import()];case 2:n=i.sent(),e=t(),n(S),S=e.loggers.get(P),i.label=3;case 3:return[2]}}))}))}function k(t){y(),I(t,S)}function z(t,n,e){y(),C(t.subscriptionId,n.status,n.refs.length,n.retries,e,S)}function U(t){y(),T(t.subscriptionId,S)}var E=e(23);function F(t){E.g.warn(t)}function L(t){E.d(t)}function $(){return Object(i.c)(this,void 0,void 0,(function(){var t,n;return Object(i.f)(this,(function(e){switch(e.label){case 0:return Object(o.i)("fwk-devTools")?[4,r.d.import()]:[3,2];case 1:t=e.sent(),(n=t()).on(r.a.ChannelData,p),n.on(r.a.NotificationData,D),n.on(r.a.SubscriptionAdded,k),n.on(r.a.SubscriptionRemoved,U),n.on(r.a.SubscriptionUpdated,z),n.on(r.a.TraceWarn,F),n.on(r.a.TraceError,L),e.label=2;case 2:return[2]}}))}))}e.d(n,"initializeNotificationDiagnostics",(function(){return $}))},2815:function(t,n,e){"use strict";var i=e(31),r=e(1),o=e(2),a=function(t,n,e){var i=null;return{init:function(a){var c;return null!==i?a:(i=Object(o.createStore)(t,n),e(i()),Object(r.a)(Object(r.a)({},a),((c={})[t]=i,c)))},getIfInitialized:function(){return i?i():null}}};e.d(n,"b",(function(){return s})),e.d(n,"f",(function(){return u})),e.d(n,"e",(function(){return d})),e.d(n,"g",(function(){return f})),e.d(n,"a",(function(){return l})),e.d(n,"c",(function(){return b})),e.d(n,"d",(function(){return a}));var c=new i.c((function(){return Promise.all([e.e(0),e.e(1),e.e(2),e.e(3),e.e(6),e.e(18),e.e(20),e.e(46),e.e(50),e.e(55),e.e(59),e.e(64),e.e(70),e.e(84),e.e(127),e.e(147),e.e(610)]).then(e.bind(null,18238))})),s=Object(i.d)(c,(function(t){return t.DiagnosticsPanel})),u=new i.a(c,(function(t){return t.registerDiagnostics})),d=(new i.b(c,(function(t){return t.setSelectedPivot})),new i.b(c,(function(t){return t.getDiagnosticsLogState}))),f=new i.b(c,(function(t){return t.initializeDefaultDiagnostics})),l=Object(i.d)(c,(function(t){return t.DiagnosticsHost})),b=(Object(i.d)(c,(function(t){return t.DiagnosticsInspector})),Object(i.d)(c,(function(t){return t.TwoColumnInspector})))}}]);
//# sourceMappingURL=owa.NotificationDiagnostics.js.map
self.scriptsLoaded['owa.NotificationDiagnostics.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.NotificationDiagnostics.js'] = (new Date()).getTime();