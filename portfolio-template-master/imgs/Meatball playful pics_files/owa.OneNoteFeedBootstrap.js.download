self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OneNoteFeedBootstrap.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[956],{18437:function(t,n,e){"use strict";e.r(n);var i=e(1),r=e(440),u=e(581),o=1,s=null,a="/NotesClient/api/v2.0/me/connectednotes";function c(){return Object(i.c)(this,void 0,void 0,(function(){var t,n,e;return Object(i.f)(this,(function(c){switch(c.label){case 0:return t=Object(i.g)(Object(r.getAccessTokenforResourceAsLazy)(window.location.origin),2),n=t[0],e=t[1],n?[3,2]:[4,e];case 1:n=c.sent(),c.label=2;case 2:return s||(s=Object(u.a)(o)),[2,s.add((function(){return fetch(a,{method:"GET",headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}})}))]}}))}))}var f=e(217),l=e(19),h=e(297);var d=1073741824;function v(){var t,n=Object(l.a)().UserOptions.NewEnabledPonts;t=n&=~d,h.a.importAndExecute([{key:"NewEnabledPonts",valuetype:"Integer32",value:[""+t]}])}var p=e(2597),b=!1;function m(){return Object(i.c)(this,void 0,void 0,(function(){var t,n;return Object(i.f)(this,(function(e){switch(e.label){case 0:return(Object(l.a)().UserOptions.NewEnabledPonts&d)!=d||b?[3,3]:(b=!0,[4,c()]);case 1:return t=e.sent(),Object(f.a)(t.status)?[4,t.json()]:[3,3];case 2:n=e.sent(),n.value.length>0&&(p.b.import().then((function(t){t("SamsungNotesSynced")})),v()),e.label=3;case 3:return[2]}}))}))}e.d(n,"initializeOneNoteFeed",(function(){return m}))},186:function(t,n,e){"use strict";function i(){var t=Object.create(null),n=0,e=0,i=0,r=!1;function u(n){i--,delete t[n]}this.put=function(n,e,r,o){if(void 0!==r&&("number"!=typeof r||isNaN(r)||r<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var s=t[n];s?clearTimeout(s.timeout):i++;var a={value:e,expire:r+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){u(n),o&&o(n,e)}.bind(this),r)),t[n]=a,e},this.del=function(n){var e=!0,i=t[n];return i?(clearTimeout(i.timeout),!isNaN(i.expire)&&i.expire<Date.now()&&(e=!1)):e=!1,e&&u(n),e},this.clear=function(){for(var u in t)clearTimeout(t[u].timeout);i=0,t=Object.create(null),r&&(n=0,e=0)},this.get=function(u){var o=t[u];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return r&&n++,o.value;r&&e++,i--,delete t[u]}else r&&e++;return null},this.size=function(){return i},this.memsize=function(){var n,e=0;for(n in t)e++;return e},this.debug=function(t){r=t},this.hits=function(){return n},this.misses=function(){return e},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var n={};for(var e in t){var i=t[e];n[e]={value:i.value,expire:i.expire||"NaN"}}return JSON.stringify(n)},this.importJson=function(n,e){var i=JSON.parse(n),r=Date.now(),u=e&&e.skipDuplicates;for(var o in i)if(i.hasOwnProperty(o)){if(u)if(t[o])continue;var s=i[o],a=s.expire-r;if(a<=0){this.del(o);continue}a=a>0?a:void 0,this.put(o,s.value,a)}return this.size()}}t.exports=new i,t.exports.Cache=i},203:function(t,n,e){"use strict";e.d(n,"a",(function(){return u})),e.d(n,"b",(function(){return o}));var i=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function r(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function u(){return r()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r()}function o(t){return i.test(t)}},217:function(t,n,e){"use strict";var i=e(859);e.d(n,"a",(function(){return i.a}))},2597:function(t,n,e){"use strict";e.d(n,"a",(function(){return u})),e.d(n,"b",(function(){return o}));var i=e(31),r=new i.c((function(){return Promise.all([e.e(21),e.e(24),e.e(64),e.e(68),e.e(641)]).then(e.bind(null,4145))})),u=new i.a(r,(function(t){return t.loadAndInitializeFloodgateEngine})),o=new i.b(r,(function(t){return t.logFloodgateActivity}))},326:function(t,n,e){"use strict";e.d(n,"b",(function(){return u})),e.d(n,"a",(function(){return o}));var i,r=e(1);function u(t){i=t}function o(){var t,n;return Object(r.c)(this,void 0,void 0,(function(){var e,u;return Object(r.f)(this,(function(r){switch(r.label){case 0:return(u=i)?[4,i()]:[3,2];case 1:u=r.sent(),r.label=2;case 2:if((e=u)&&e.length>0){if("bearer"===(null===(t=null==e?void 0:e.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,e.split(" ")[1]];if("msauth1.0"===(null===(n=null==e?void 0:e.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return[2,e]}return[2,void 0]}}))}))}},518:function(t,n,e){"use strict";var i=function(){function t(t,n,e){this.maxParallelTasks=t,this.taskCallback=n,this.taskDelay=e,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var n=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(n).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();e.d(n,"a",(function(){return i}))},581:function(t,n,e){"use strict";function i(t){var n=0,e=[];function i(){n-=1,e.length>0&&e.shift()()}return{add:function(r){return new Promise((function(u,o){var s=function(){n+=1,r().then((function(t){i(),u(t)}),(function(t){i(),o(t)}))};n===t?e.push(s):s()}))},getRunningCount:function(){return n},getQueueLength:function(){return e.length}}}e.d(n,"a",(function(){return i}))},859:function(t,n,e){"use strict";function i(t){return t>=200&&t<300}e.d(n,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.OneNoteFeedBootstrap.js.map
self.scriptsLoaded['owa.OneNoteFeedBootstrap.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OneNoteFeedBootstrap.js'] = (new Date()).getTime();