self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OutlookServiceOptions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[960],{151:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"f",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return s})),n.d(t,"g",(function(){return f}));var r=n(31),o=new r.c((function(){return Promise.all([n.e(4),n.e(21),n.e(973)]).then(n.bind(null,1559))})),a=new r.a(o,(function(e){return e.makePostRequest})).importAndExecute,i=new r.a(o,(function(e){return e.makePatchRequest})).importAndExecute,u=new r.a(o,(function(e){return e.makePutRequest})).importAndExecute,c=new r.a(o,(function(e){return e.makeGetRequest})).importAndExecute,d=new r.a(o,(function(e){return e.makeDeleteRequest})).importAndExecute,s=new r.a(o,(function(e){return e.makeGraphRequest})).importAndExecute,f=new r.a(o,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},18362:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n(53),a=n(198),i=n(203),u=n(151),c=n(23),d=n(1249),s=n(980);var f=n(1259),p=n(2),O="ows/v1.0/OutlookOptions",b=null,l=Object(p.mutatorAction)("setOptionLoadState",(function(e){Object(d.b)().loadState=e}));function A(){switch(Object(d.b)().loadState){case d.a.OptionsLoading:return b;case d.a.OptionsLoaded:return Promise.resolve();case d.a.OptionsNotLoaded:default:return l(d.a.OptionsLoading),b=Object(u.b)(O).then((function(e){!function(e){e?(e.options&&e.options.forEach((function(e){null!=e&&(e.feature==a.b.SurfaceActions&&(e=function(e){return e.readSurfaceActions=e.readSurfaceActions?e.readSurfaceActions:[],e.readSurfaceAddins=e.readSurfaceAddins?e.readSurfaceAddins:[],e.composeSurfaceActions=e.composeSurfaceActions?e.composeSurfaceActions:[],e.composeSurfaceAddins=e.composeSurfaceAddins?e.composeSurfaceAddins:[],e}(e)),Object(a.h)(e.feature,e))})),void 0===t&&(t=Object(s.a)()),Object.keys(Object(a.f)().options).forEach((function(e){if(!Object(a.f)().options[e].lastModifiedDateTime&&t[e]){var n=Number(e);Object(a.d)(n,t[e])}})),l(d.a.OptionsLoaded)):(c.g.info("Error loading options"),Object(f.a)(),l(d.a.OptionsNotLoaded));var t}(e),b=null}))}}var m="ows/v1.0/OutlookOptions/{0}";function j(e,t){return Object(r.c)(this,void 0,void 0,(function(){var n,i,u;return Object(r.f)(this,(function(s){switch(s.label){case 0:return n=Object(o.a)(m,a.b[e]),Object(d.b)().loadState===d.a.OptionsLoaded?[3,2]:[4,A()];case 1:s.sent(),s.label=2;case 2:return Object(d.b)().loadState===d.a.OptionsLoaded?Object(a.f)().options[e]&&Object(a.f)().options[e].lastModifiedDateTime?t&&0!==Object.keys(t).length?((i=t)["feature@is.Queryable"],i["feature@odata.type"],i.createdDateTime,i.lastModifiedDateTime,u=Object(r.h)(i,["feature@is.Queryable","feature@odata.type","createdDateTime","lastModifiedDateTime"]),[2,h(1,n,u)]):(c.g.info("createOrUpdateOptionsForFeature called with no changes to options"),[2,Promise.resolve()]):[2,h(0,n,t)]:[2,Promise.reject(new Error("Options are not loaded. Cannot update options."))]}}))}))}function h(e,t,n){var r={correlationId:Object(i.a)(),options:n};return(1==e?Object(u.d)(t,r,r.correlationId):Object(u.e)(t,r,r.correlationId)).then((function(e){if(!function(e){if((null==e?void 0:e.options)&&1==e.options.length){var t=e.options[0];return Object(a.h)(t.feature,t),!0}return!1}(e)){var t=new Error("Error processing options response");throw t.networkError=!0,t}}))}function v(e){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(t){switch(t.label){case 0:return[4,A()];case 1:return t.sent(),[2,Object(a.e)(e)]}}))}))}var S=Object(p.action)("updateAddInArray",(function(e,t,n){return{addinsArray:e,productId:t,isPushOperation:n}}));Object(p.mutator)(S,(function(e){e.isPushOperation?e.addinsArray.push(e.productId):e.addinsArray.splice(e.addinsArray.indexOf(e.productId),1)}));var w=S;function E(e,t,n){var r=Object(a.e)(a.b.SurfaceActions),o=Object(a.e)(a.b.CalendarSurfaceAddins),i=!!n.readMode&&g(r.readSurfaceAddins,e,t);i=n.composeMode?i||g(r.composeSurfaceAddins,e,t):i;var u=!!n.calendarMode&&g(o.calendarSurfaceAddins,e,t);i&&j(a.b.SurfaceActions,r),u&&j(a.b.CalendarSurfaceAddins,o)}var g=function(e,t,n){var r=!1;return n?-1===e.indexOf(t)&&(w(e,t,!0),r=!0):-1!==e.indexOf(t)&&(w(e,t,!1),r=!0),r};n.d(t,"createOrUpdateOptionsForFeature",(function(){return j})),n.d(t,"loadOptions",(function(){return A})),n.d(t,"getServerOptionsForFeature",(function(){return v})),n.d(t,"updateAddinPinStatus",(function(){return E})),n.d(t,"updateAddInArray",(function(){return w}))},203:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function a(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function i(e){return r.test(e)}}}]);
//# sourceMappingURL=owa.OutlookServiceOptions.js.map
self.scriptsLoaded['owa.OutlookServiceOptions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OutlookServiceOptions.js'] = (new Date()).getTime();