self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OwaRoamingDictionary.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[971],{12201:function(e,n,t){"use strict";t.r(n);var r=t(1),o=t(11872),i=t(11816),s=t(203),c=t(121),a=t(4),u="3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770",l=2,f=100,d=0;function b(e){var n=this;return function(t,o,i,s,b,v){return Object(r.c)(n,void 0,void 0,(function(){var n,t,v,p;return Object(r.f)(this,(function(r){switch(r.label){case 0:return n={name:o,properties:{Sampled:"Production"===g()?l:f}},i&&(null===(v=Object.keys(i))||void 0===v||v.forEach((function(e){n.properties["Data."+e]=i[e]}))),"Office.System.Activity"===s&&b&&(null===(p=Object.keys(b))||void 0===p||p.forEach((function(e){n.properties["Activity."+e]=b[e]}))),t=/_/gi,n.properties["App.Name"]="Outlook",n.properties["App.Platform"]="Web",n.properties["App.Version"]=Object(a.r)(),n.properties["Event.Contract"]=s,n.properties["Event.Name"]=null==o?void 0:o.replace(t,"."),n.properties["Event.Time"]=new Date,n.properties["Event.Sequence"]=d++,n.properties["Event.Source"]="OWA",n.properties["Release.AudienceGroup"]=g(),n.properties["Session.Id"]=e,[4,Object(c.i)(u)];case 1:return r.sent().logEvent(n),[2]}}))}))}}function g(){switch(Object(a.y)()){case"Dogfood":return"Dogfood";case"Microsoft":return"Microsoft";case"FirstRelease":case"WW":default:return"Production"}}var v=t(197),p=t(440),O=t(23),h="Compose.Send",m="https://augloop.office.com/v2";function j(){return Object(r.c)(this,void 0,void 0,(function(){var e,n,t;return Object(r.f)(this,(function(o){switch(o.label){case 0:return Object(v.a)()?[2,Object(p.getDelegationTokenForOwa)(h,"augloop")]:[3,1];case 1:return e=Object(r.g)(Object(p.getAccessTokenforResourceAsLazy)(m,"augloop",Object(s.a)()),2),n=e[0],t=e[1],n?[3,3]:[4,t];case 2:n=o.sent(),o.label=3;case 3:return[2,n]}}))}))}function I(e){return Object(r.c)(this,void 0,void 0,(function(){var e;return Object(r.f)(this,(function(n){switch(n.label){case 0:return O.g.info("[AugLoopPlugin] requestAuthToken callback"),e={},[4,j()];case 1:return[2,(e.Token=n.sent(),e)]}}))}))}var A=t(2936),E=t(11817),S="AugLoopSessionCloseError",L={};function y(e){return L[e]?O.g.info("[augloopSession] cached augloop session. Id:"+e):(O.g.info("[augloopSession] Initialize augloop session. Id:"+e),L[e]=function(e){return Object(r.c)(this,void 0,void 0,(function(){var n;return Object(r.f)(this,(function(t){switch(t.label){case 0:return(n=Object(o.createRuntime)())?[4,n.init(Object(i.a)(),{appName:"Outlook",appPlatform:"Web",appVersion:Object(a.r)(),releaseAudienceGroup:g(),releaseChannel:void 0,releaseFork:void 0,sessionId:e,flights:Object(E.a)().join(";")},{onResult:w,onAnnotationResult:R,sendTelemetryEvent:b(e),requestAuthToken:I,isFeatureEnabled:N,executeLocalLambda:k,areLicenseFeaturesEnabled:D},{telemetryAggregationIntervalSec:30,initSession:!1})]:[3,2];case 1:return t.sent(),[2,n.createSession({docSessionId:Object(s.a)()}).then((function(e){return function(e){if(!e)return void O.g.info("[augloopSession]. Unable to submit seed operation, session is undefined");var n=new A.AddOperation;n.parentPath=["session"];var t=new A.Document;n.items=[{id:"doc",body:t}],e.submitSeedOperations([n])}(e),e}))];case 2:return[2,Promise.resolve(null)]}}))}))}(e)),L[e]}function w(e,n,t,r){}function N(e,n){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(n){return O.g.info("[augloopSession] isFeatureEnabled callback: feature name: "+e),[2,!0]}))}))}function k(e,n,t,r){return Promise.resolve(null)}function D(e){return Promise.resolve(!1)}function R(e){}function P(e){return Object(r.c)(this,void 0,void 0,(function(){var n;return Object(r.f)(this,(function(t){switch(t.label){case 0:return[4,L[e]];case 1:if(n=t.sent()){try{n.close()}catch(e){Object(c.s)(S,{error:e.message},{logEvery:1}),O.g.info("[augloopSession] exception encountered when closing augLoop session: "+e.message)}O.g.info("[augloopSession] disposed augloop session. Id:"+e),delete L[e]}return[2]}}))}))}t.d(n,"getAugLoopSession",(function(){return y})),t.d(n,"disposeAugLoopSession",(function(){return P}))},12223:function(e,n,t){"use strict";t.r(n);var r=t(1),o=t(12149),i=t(24),s=t(203),c=t(4004),a=t(57),u=t(197),l=t(440),f=t(23),d=void 0,b=36e5,g=122,v="1.0.0",p="Web";function O(e){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(n){switch(n.label){case 0:return e?[4,e.saveWordListToRoamingService(Object(s.a)())]:[3,2];case 1:if(n.sent().success)return[2,!0];n.label=2;case 2:return[2,!1]}}))}))}function h(e){d=window.setInterval((function(){e&&O(e)}),b)}function m(){return Object(r.c)(this,void 0,void 0,(function(){var e,n,t,o;return Object(r.f)(this,(function(i){switch(i.label){case 0:return"wl.skydrive",e="https://officeapps.live.com",Object(u.a)()?[4,Object(l.getDelegationTokenForOwa)("wl.skydrive")]:[3,2];case 1:return[2,(t=i.sent())||""];case 2:return n=Object(r.g)(Object(l.getAccessTokenforResourceAsLazy)(e),2),t=n[0],o=n[1],t?[3,4]:[4,o];case 3:t=i.sent(),i.label=4;case 4:return[2,t||""]}}))}))}function j(){return Object(r.c)(this,void 0,void 0,(function(){return Object(r.f)(this,(function(e){return[2,new Promise((function(e){c.d.importAndExecute((function(n){(null==n?void 0:n.proofingLocale)?e(n.proofingLocale):e(Object(a.j)())}))}))]}))}))}var I=void 0;function A(){E()}function E(){return Object(r.c)(this,void 0,void 0,(function(){var e,n;return Object(r.f)(this,(function(t){switch(t.label){case 0:return I?(f.g.info("[roamingDictionary] Instance of roaming dictionary already exists. Returning"),[2,I]):[3,1];case 1:return[4,j()];case 2:return e=t.sent(),(I=function(e){return f.g.info("[roamingDictionary] Initialize roaming dictionary"),new o.b(m,Object(i.i)("ring-dogfood")?"PPE":"PROD",g,v,p,e,void 0)}(null!=e?e:"en"))?(f.g.info("[roamingDictionary] Loading word list from service"),[4,I.loadWordListFromRoamingService(Object(s.a)())]):[3,4];case 3:return(n=t.sent()).success?(f.g.info("[roamingDictionary] Word list loaded successfully"),h(I)):f.g.info("[roamingDictionary] Error loading word list: "+n.errorMessage),[3,5];case 4:f.g.info("[roamingDictionary] iniitalizeRoamingDictionary failed"),t.label=5;case 5:return[2,I]}}))}))}function S(){return Object(r.c)(this,void 0,void 0,(function(){var e;return Object(r.f)(this,(function(n){switch(n.label){case 0:return(e=I)?[4,O(I)]:[3,2];case 1:e=n.sent(),n.label=2;case 2:return e?(t=I,clearInterval(d),h(t),[2,!0]):[2,!1]}var t}))}))}t.d(n,"preloadRoamingDictionary",(function(){return A})),t.d(n,"getRoamingDictionary",(function(){return E})),t.d(n,"saveRoamingDictionary",(function(){return S}))},3337:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=["am-ET","ar-AE","ar-BH","ar-DZ","ar-EG","ar-IL","ar-IQ","ar-JO","ar-KW","ar-LB","ar-LY","ar-MA","ar-OM","ar-QA","ar-SA","ar-SY","ar-TN","ar-YE","bg-BG","bn-BD","bn-IN","bs-Latn-BA","ca-ES","ca-ES-valencia","cs-CZ","cy-GB","da-DK","de-AT","de-CH","de-DE","de-LI","de-LU","el-GR","en-029","en-AU","en-BZ","en-CA","en-GB","en-ID","en-IE","en-JM","en-NZ","en-PH","en-SG","en-TT","en-US","en-ZA","en-ZW","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-ES","es-GT","es-HN","es-MX","es-NI","es-PA","es-PE","es-PR","es-PY","es-SV","es-US","es-UY","es-VE","et-EE","eu-ES","fa-IR","fi-FI","fr-BE","fr-CA","fr-CH","fr-FR","fr-LU","fr-MC","ga-IE","gd-GB","gl-ES","gu-IN","ha-Latn-NG","he-IL","hi-IN","hr-BA","hr-HR","hu-HU","hy-AM","id-ID","is-IS","it-CH","it-IT","ja-JP","ka-GE","kk-KZ","kn-IN","ko-KR","kok-IN","ky-KG","lb-LU","lt-LT","lv-LV","mi-NZ","mk-MK","ml-IN","mr-IN","ms-BN","ms-MY","mt-MT","nb-NO","ne-IN","ne-NP","nl-BE","nl-NL","nn-NO","or-IN","pa-IN","pl-PL","pt-PT","ro-MD","ro-RO","ru-MD","ru-RU","si-LK","sk-SK","sl-SI","sq-AL","sr-Cyrl-BA","sr-Latn-CS","sv-FI","sv-SE","sw-KE","ta-IN","te-IN","tr-TR","tt-RU","uk-UA","ur-IN","ur-PK","uz-Latn-UZ","vi-VN"];function o(e){return e?-1!==r.indexOf(e):null}}}]);
//# sourceMappingURL=owa.OwaRoamingDictionary.js.map
self.scriptsLoaded['owa.OwaRoamingDictionary.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OwaRoamingDictionary.js'] = (new Date()).getTime();