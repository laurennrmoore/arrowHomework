self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OwsGateway.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[973],{1559:function(e,t,n){"use strict";n.r(t);var r=n(2779);function a(e,t,n,a){return Object(r.g)(n,t,a,e)}n.d(t,"makeOwsPrimeRequest",(function(){return r.g})),n.d(t,"makePostRequest",(function(){return r.e})),n.d(t,"makePatchRequest",(function(){return r.d})),n.d(t,"makePutRequest",(function(){return r.f})),n.d(t,"makeGetRequest",(function(){return r.b})),n.d(t,"makeDeleteRequest",(function(){return r.a})),n.d(t,"makeGraphRequest",(function(){return r.c})),n.d(t,"sendOwsPrimeRequest",(function(){return a}))},159:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(41);function a(){var e=Object(r.a)(),t=e.origin;return t||(t=e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")),t}},186:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,a=!1;function o(t){r--,delete e[t]}this.put=function(t,n,a,i){if(void 0!==a&&("number"!=typeof a||isNaN(a)||a<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==i&&"function"!=typeof i)throw new Error("Cache timeout callback must be a function");var u=e[t];u?clearTimeout(u.timeout):r++;var c={value:n,expire:a+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){o(t),i&&i(t,n)}.bind(this),a)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),a&&(t=0,n=0)},this.get=function(o){var i=e[o];if(void 0!==i){if(isNaN(i.expire)||i.expire>=Date.now())return a&&t++,i.value;a&&n++,r--,delete e[o]}else a&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){a=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),a=Date.now(),o=n&&n.skipDuplicates;for(var i in r)if(r.hasOwnProperty(i)){if(o)if(e[i])continue;var u=r[i],c=u.expire-a;if(c<=0){this.del(i);continue}c=c>0?c:void 0,this.put(i,u.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},203:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function o(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}function i(e){return r.test(e)}},21:function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return u})),n.d(t,"l",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"k",(function(){return p})),n.d(t,"d",(function(){return v}));var r=6048e5,a=864e5,o=36e5,i=6e4,u=1e3,c=12,s=30,d=365,l=-864e13,f=864e13,p=Date.UTC(1601,0,1),v=Date.UTC(4501,0,1)},210:function(e,t,n){"use strict";var r=n(4),a={showOwaBranding:{default:!0,native:!1},includePartnerIn3SRequest:{default:!1,native:!0},loadThemeFromHostApp:{default:!1,opx:!0},opxDeeplink:{default:!1,opx:!0},authRedirectOnSessionTimeout:{default:!0,native:!1,opx:!1},opxComponentLifecycle:{default:!1,opx:!0},navigateToView:{default:!1,opx:!0},readingPaneModal:{default:!0,teams:!1},readingPaneHeaderTitleAndJoinLink:{default:!0,teams:!1},composeFormSaveCloseHandlers:{default:!1,teams:!0},opxServiceWorker:{default:!1,opx:!0},routeOptionsStaticUrl:{default:!1,opx:!0},scenarioData:{default:!1,opx:!0},teamsChannelOptions:{default:!1,teams:!0},macA11y:{default:!1,macoutlook:!0},teamsCalendarPicker:{default:!1,teams:!0},joinTeamsMeeting:{default:!1,opx:!0},calendarPaneHeaderWeather:{default:!0,teams:!1},use3SPeopleSuggestions:{default:!0,macoutlook:!1},defaultCalendarColor:{default:!1,opx:!0},roomAddedHandler:{default:!1,opx:!0},roomFinderFreeBusyStyles:{default:!1,macoutlook:!0,outlookdesktop:!0},defaultSelectCalendarItemSvg:{default:!0,opx:!1},opxInboxRules:{default:!1,opx:!0},moduleNameFromWindow:{default:!0,opx:!1},showArchiveUnreadCount:{default:!1,native:!0},headerFeedback:{default:!0,opx:!1},spacesTeamsMessage:{default:!1,opx:!0},spacesEnabled:{default:!0,native:!1},composeFrom:{default:!1,opx:!0},groupDiscoverCloseButton:{default:!1,opx:!0},updateModalProps:{default:!1,opx:!0},modalOpenedHandler:{default:!1,opx:!0},fullscreenComposeFormPopOut:{default:!1,teams:!0},defaultOutlookThemeColor:{default:!0,opx:!1},yammerDailyDigest:{default:!1,outlookdesktop:!0},yammerDirectFollower:{default:!1,outlookdesktop:!0},yammerDiscovery:{default:!1,outlookdesktop:!0},yammerHostClientType:{default:!1,opx:!0},showMinimumThreeInsights:{default:!1,opx:!0},groupCreatedHandler:{default:!1,opx:!0},groupDeletedHandler:{default:!1,opx:!0},updateSearchAnswerOnQueryChange:{default:!1,opx:!0},insightsCountUpdatedHandler:{default:!1,opx:!0},processMeetingInsightsHandler:{default:!1,opx:!0},todoIsExplicitLogon:{default:!0,opx:!1},timeStreamSharedSpace:{default:!1,opx:!0},focusZoneCicularNavigation:{default:!1,opx:!0},componentTokenProvider:{default:!1,opx:!0,native:!0},calendarOfficeRail:{default:!0,teams:!1},hideCalendarModuleContent:{default:!1,teams:!0},fullComposeFormModal:{default:!0,teams:!1},renderCalendarHeader:{default:!0,teams:!1},weekWeatherIcon:{default:!0,teams:!1},surfacePLTDataPoint:{default:!1,teams:!0},schedulingAssistant:{default:!0,teams:!1},composeFormHeader:{default:!0,teams:!1},saveInFullCompose:{default:!0,teams:!1},discardInFullCompose:{default:!0,teams:!1},addIns:{default:!0,teams:!1},settings:{default:!0,teams:!1},multiAccounts:{default:!0,teams:!1},accountSettingsHx:{default:!1,native:!0},nativeDiagnostics:{default:!1,native:!0},nativeQsp:{default:!1,native:!0},moduleSwitch:{default:!1,native:!0},diagInAppSupport:{default:!1,native:!0},folderHierarchyHx:{default:!1,native:!0},monarchErrorMessage:{default:!1,native:!0},noteFeedSidePanel:{default:!0,native:!1},whatsNew:{default:!0,native:!1},owaBrandingCharm:{default:!0,native:!1},appLauncher:{default:!0,native:!1},incorrectNativeEntryPoint:{default:!1,native:!0},monarchFeedback:{default:!1,native:!0},nativeResolvers:{default:!1,native:!0},managedQueryLink:{default:!1,native:!0},wrongIndex:{default:!1,native:!0},outlookSuiteHeaderStrategy:{default:!1,native:!0},calendarRibbon:{default:!1,native:!0},mailRibbon:{default:!1,native:!0},hxDiagnostics:{default:!1,native:!0},initialMailData:{default:!1,native:!0},pauseInbox:{default:!0,native:!1},hxVersionQueryStringParam:{default:!1,native:!0},nativeServiceWorker:{default:!1,native:!0},nativeHostAttachmentHijack:{default:!1,native:!0},useNativeHostRPConversationOption:{default:!1,native:!0},reboot:{default:!1,native:!0},calendarFolderHx:{default:!1,native:!0},skipAwaitLpcConfig:{default:!1,opx:!0},workloadScenarioSettings:{default:!0,opx:!1},ribbonDefaultToSLR:{default:!1,native:!0},ribbonPersistDefault:{default:!1,native:!0}},o=n(154),i=function(e){var t=function(e){return a[e]}(e);if(t){if(window.HxGlobals&&window.nativeHost&&r.d in t)return t[r.d];if(Object(o.b)()&&r.g in t)return t[r.g];var n=Object(r.z)();return n&&n in t?t[n]:n&&(n===r.f||n===r.c||n===r.b||n===r.a||n===r.g||n===r.e||n===r.h)&&"opx"in t?t.opx:t.default}return!1};n.d(t,"a",(function(){return i}))},217:function(e,t,n){"use strict";var r=n(859);n.d(t,"a",(function(){return r.a}))},262:function(e,t,n){"use strict";var r=n(21);t.a=function(e,t){return new Date(+e+t*r.g)}},2779:function(e,t,n){"use strict";var r=n(1),a=n(24),o=n(217),i=n(8),u=n(514),c=n(2969),s=n(65),d=n(170),l=n(156),f=n(440),p=n(23),v=n(93),h=n(895),m="owsserver",b="owsapi",O=n(10),j=n(171);n.d(t,"g",(function(){return w})),n.d(t,"c",(function(){return y})),n.d(t,"e",(function(){return C})),n.d(t,"d",(function(){return T})),n.d(t,"f",(function(){return S})),n.d(t,"b",(function(){return P})),n.d(t,"a",(function(){return R}));var g=2048,k=null;function w(e,t,n,o,i,c,s,d,l){var p="object"==typeof n&&n.customHeaders||s,v=p?Object.keys(p).reduce((function(e,t){return e[t.toLowerCase()]=p[t],e}),{}):void 0,h="object"==typeof n?Object(r.a)(Object(r.a)({},n),{customHeaders:v}):{returnFullResponse:n,correlationId:i,requestObject:c,customHeaders:v,throwServiceError:d,includeCredentials:l};if(!h.customHeaders||!h.customHeaders.authorization){void 0===h.includeCredentials&&(h.includeCredentials=!Object(a.i)("auth-authzHeaderNoCookies"));var m=Object(u.m)(),b=Object(r.g)(Object(f.getAccessTokenforResourceAsLazy)(m),2),O=b[0],j=b[1];return O?x(e,t,h,o,O):j.then((function(n){return x(e,t,h,o,n)}))}return x(e,t,h,o)}function x(e,t,n,r,f){var w,x=n.returnFullResponse,y=n.correlationId,C=n.requestObject,T=n.customHeaders,S=n.throwServiceError,P=n.sendPayloadAsBody,R=n.includeCredentials,H=new Headers;H.append("X-OWA-CANARY",Object(s.a)()),H.append("X-MS-AppName","owa-react"+Object(u.r)());var I={n:Object(d.a)().toString()};y&&(H.append("client-request-id",y),I.cri=y),T&&Object.keys(T).forEach((function(e){H.append(e,T[e])}));var D=Object(O.a)();D.sessionId&&H.set("X-OWA-SessionId",D.sessionId);var A=Object(v.b)();if(A&&(H.append(v.a,A),I.cv=A),f){if(f.length>0&&"msauth1.0"===(null===(w=null==f?void 0:f.split(" ")[0])||void 0===w?void 0:w.toLowerCase()))H.append("Authorization",f);else{if(Object(a.i)("fwk-devTools")){var N=f.split(".");3==N.length&&0!==N[2].length||p.d("BearerTokenIncomplete "+N.length)}H.append("Authorization","Bearer  "+f)}}if(!T||!T["x-anchormailbox"]){var L=Object(c.a)();L&&L.length>0&&H.append("X-AnchorMailbox",L)}var q={method:t,credentials:!1!==R?"same-origin":"omit",body:n.requestBody};if(C){H.append("Content-Type","application/json");var E=JSON.stringify(C),F=e.search(/ows\/|owa\//i)>=0;if(Object(a.i)("fwk-emptyPost")&&F&&"POST"==t&&!P){var M=encodeURIComponent(E);M.length<g?H.append("X-OWA-UrlPostData",M):q.body=E}else q.body=E}Object(j.a)(H),q.headers=H;var U=function(e,t){var n=function(e,t){var n=Object(u.x)(e,t),r=n.split("/");r.length>0&&("ows"==r[0]||"OutlookGateway"==r[0])&&(r[0]=Object(u.f)(r[0]),n=r.join("/"));return Object(u.a)(n)}(Object(a.i)("fwk-proxyOwsPrime")?"/OutlookGateway/":"/",e),r=Object(u.m)()+n;if(Object(a.i)("fwk-devTools")&&Object(i.d)(m)&&(Object(i.a)(b)==e||!Object(i.d)(b))&&(null==k&&(k=confirm("A query param '"+m+"' is set to redirect some of calls to '"+Object(i.a)(m)+"'.\n\nThose calls contain PII. If this is not intentional, click 'Cancel' below or remove the queryparam and reload the page.")),k)){var o=e.split("/");o.length>0&&"ows"==o.shift()&&(e=o.join("/")),r=Object(i.a)(m)+"/"+e}return Object(u.v)(r,t)}(e,I),z=Object(l.a)(U,q);return Object(h.a)(q,n,z,r,U),z.then((function(n){if(x)return n;if(Object(o.a)(n.status))return n.text().then((function(e){return e?JSON.parse(e):{}}));throw new Error(t+" request to "+e+" failed, http error:"+n.status)})).catch((function(e){if(p.g.warn(e),S)throw{stack:e.stack,message:e.message,correlationVector:A,correlationId:n.correlationId,networkError:!0};return[]}))}function y(e,t){return w(e,"POST",{requestBody:t,customHeaders:{"Content-Type":"application/json"}})}function C(e,t,n,r,a,o,i,u,c,s){return w(e,"POST",{returnFullResponse:r,correlationId:n,requestObject:t,customHeaders:a,throwServiceError:o,sendPayloadAsBody:i,includeCredentials:u,datapoint:s},c)}function T(e,t,n,r,a,o,i,u){return w(e,"PATCH",{returnFullResponse:r,correlationId:n,requestObject:t,customHeaders:a,throwServiceError:o,includeCredentials:i},u)}function S(e,t,n,r,a,o,i,u){return w(e,"PUT",r,i,n,t,a,o,u)}function P(e,t,n,r,a,o,i){return w(e,"GET",n,i,t,void 0,r,a,o)}function R(e,t,n,r,a,o,i,u){return w(e,"DELETE",{returnFullResponse:r,correlationId:n,requestObject:t,customHeaders:a,throwServiceError:o,includeCredentials:i},u)}},289:function(e,t,n){"use strict";var r=n(21);t.a=function(e,t){return new Date(+e+t*r.h)}},2969:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return u}));var r=n(42),a=n(41),o=n(57);function i(){var e=Object(r.a)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.a)(t)}function u(){var e,t,n=(e="",(t=Object(a.a)().pathname.split("/").filter((function(e){return e.length}))).length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e);if(0===n.length){var r=Object(o.h)();if(null==r?void 0:r.SessionSettings){var u=r.SessionSettings.ExternalDirectoryTenantGuid,c=r.SessionSettings.UserPuid;c&&u&&(n="PUID:"+c+"@"+u)}}return 0===n.length&&(n=i()),n}},326:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r,a=n(1);function o(e){r=e}function i(){var e,t;return Object(a.c)(this,void 0,void 0,(function(){var n,o;return Object(a.f)(this,(function(a){switch(a.label){case 0:return(o=r)?[4,r()]:[3,2];case 1:o=a.sent(),a.label=2;case 2:if((n=o)&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return[2,n.split(" ")[1]];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return[2,n]}return[2,void 0]}}))}))}},427:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},478:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(80);function a(e){return Object(r.a)(e,[r.c])}},514:function(e,t,n){"use strict";var r=n(478),a=n(34),o=n(80);function i(e){return Object(o.a)(e,[o.b])}var u=n(29),c=n(71);function s(e){return Object(u.b)(Object(u.c)(Object(u.a)(Object(c.a)()||"",e)))}var d,l,f,p=n(617),v=n(734),h=n(219);function m(){return d||(d=Object(a.a)("/calendar")+"/"),d}function b(){return l||(l=Object(a.a)("/mail")+"/"),l}function O(){return f||(f=Object(a.a)("/files")+"/"),f}var j,g,k,w=n(867);function x(e){return j&&g===e||(g=e,j=e?Object(a.a)("/people/group/owner")+"/":Object(a.a)("/people/group/member")+"/"),j}function y(){return k||(k=Object(a.a)("/people/group/deleted")+"/"),k}function C(e){return window.location.origin+m()+"showPeek/item/"+encodeURIComponent(e)}var T=n(295),S=n(706),P=n(8),R=n(637),H=Object(S.a)().split("/").slice(1).join("/")+"deeplink/";function I(e,t,n,r){n&&((r=r||{}).minus="");var a="";if(r){var o=Object(P.b)();Object(R.a)(o),Object.keys(r).filter((function(e){return e})).forEach((function(e){return o[e]=r[e]})),a="?"+Object(P.i)(o)}var i={pathname:"/"+e+"/"+H+t,search:a};return T.format(i)}var D,A,N=n(220),L=n(1),q=n(19),E="https://to-do.microsoft.com";function F(e,t){var n,r,a,o=Object(q.a)(),i=o.UserOptions,u=null===(r=o.SessionSettings)||void 0===r?void 0:r.UserPrincipalName,c=E,s={};if(null===(a=null==i?void 0:i.ReactOptinSettings)||void 0===a?void 0:a.TasksRedirectUrl){var d;c=(n=Object(L.g)(i.ReactOptinSettings.TasksRedirectUrl.split("?"),2))[0],d=n[1],s=Object(P.g)(d),u&&(s.auth_upn=u)}return e&&(s.utm_source=e),t&&delete s.fromOwa,Object.keys(s).length>0?Object(h.a)(c,s):c}function M(){return D||(D=Object(a.a)("/spaces")+"/"),D}function U(){return A||(A=Object(a.a)("/eventify")+"/"),A}var z=n(159);n.d(t,"j",(function(){return r.a})),n.d(t,"t",(function(){return a.a})),n.d(t,"f",(function(){return i})),n.d(t,"l",(function(){return s})),n.d(t,"s",(function(){return p.a})),n.d(t,"x",(function(){return u.a})),n.d(t,"a",(function(){return u.b})),n.d(t,"b",(function(){return u.c})),n.d(t,"o",(function(){return v.a})),n.d(t,"v",(function(){return h.a})),n.d(t,"d",(function(){return m})),n.d(t,"k",(function(){return b})),n.d(t,"g",(function(){return O})),n.d(t,"p",(function(){return w.a})),n.d(t,"i",(function(){return x})),n.d(t,"h",(function(){return y})),n.d(t,"c",(function(){return C})),n.d(t,"q",(function(){return I})),n.d(t,"w",(function(){return N.a})),n.d(t,"u",(function(){return F})),n.d(t,"n",(function(){return M})),n.d(t,"e",(function(){return U})),n.d(t,"m",(function(){return z.a})),n.d(t,"r",(function(){return c.a}))},518:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.tryRunTask=function(){var e=this;if(this.canRunMoreTasks()){var t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()}},e}();n.d(t,"a",(function(){return r}))},617:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(8),a=n(637);function o(){var e=Object(r.b)();Object(a.a)(e);var t=Object(r.i)(e);return t.length>0?"?"+t:""}},637:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=["hostApp","isanonymous","cspoff","frameName","opxInstanceId","hxVersion"];function a(e){e&&Object.keys(e).forEach((function(t){r.includes(t)&&delete e[t]}))}},706:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(71),a=n(34);function o(e){return(Object(a.a)("/"+(e||Object(r.a)()))+"/").replace(/^\//,"")}},734:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(41),a=n(34),o=n(159);function i(e){var t=Object(r.a)(),n=Object(o.a)()+Object(a.a)("/owa")+"/",i=t.search&&t.search.length>0;n+=i?t.search:"?";for(var u=Object.keys(e),c=i,s=0;s<u.length;s++)c?n+="&":c=!0,n+=u[s]+"="+e[u[s]];return n}},859:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},867:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,a=n(34);function o(){return r||(r=Object(a.a)("/people")+"/"),r}},895:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=0,a={};function o(e){var t=r++;return a[t]=e,function(){delete a[t]}}function i(e,t,n,r,o){var i=Object.keys(a);t.datapoint&&(e.datapoint=t.datapoint);for(var u=0;u<i.length;u++)a[i[u]](n,r||"OWS",o,0,e)}}}]);
//# sourceMappingURL=owa.OwsGateway.js.map
self.scriptsLoaded['owa.OwsGateway.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OwsGateway.js'] = (new Date()).getTime();