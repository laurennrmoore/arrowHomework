self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SessionDataStash.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1021],{1504:function(e,n,r){"use strict";r.d(n,"a",(function(){return o})),r.d(n,"b",(function(){return t}));var i=r(9),o=new i.a(new i.b((function(){return Promise.all([r.e(9),r.e(11),r.e(12),r.e(38),r.e(272),r.e(488)]).then(r.bind(null,1904))})),(function(e){return e.getInitialMailDataHx})),t=new i.a(new i.b((function(){return Promise.all([r.e(9),r.e(11),r.e(12),r.e(38),r.e(272),r.e(1020)]).then(r.bind(null,1907))})),(function(e){return e.getSessionDataForOneOutlook}))},1564:function(e,n,r){"use strict";r.r(n);var i=r(1),o=r(3305),t=r(210),d=r(1504),l=r(15),u=r(23),a=Object(l.f)((function(e){return Object(i.c)(void 0,void 0,void 0,(function(){var n,r,o,l,a,s,f,c,v,I,g,h;return Object(i.f)(this,(function(i){try{if(Object(t.a)("initialMailData"))return"UserMailbox",n=null===(s=null===(a=e.owaUserConfig)||void 0===a?void 0:a.SessionSettings)||void 0===s?void 0:s.LogonEmailAddress,r=null===(v=null===(c=null===(f=e.owaUserConfig)||void 0===f?void 0:f.SessionSettings)||void 0===c?void 0:c.DefaultFolderNames)||void 0===v?void 0:v.indexOf("msgfolderroot"),o=void 0,r&&r>-1&&(o=null===(h=null===(g=null===(I=e.owaUserConfig)||void 0===I?void 0:I.SessionSettings)||void 0===g?void 0:g.DefaultFolderIds)||void 0===h?void 0:h[r]),n||(Object(u.d)("getInitialMailData: SessionSettings not available"),n="no-smtp-address"),r||Object(u.d)("getInitialMailData: RootFolder not available in defaultNames"),l={type:"UserMailbox",userIdentity:n,mailboxSmtpAddress:n},[2,d.a.importAndExecute(l,null==o?void 0:o.Id)]}catch(e){u.g.warn("getInitialMailData: "+e.message)}return[2,null]}))}))}),"imd");function s(e){return Object(i.c)(this,void 0,void 0,(function(){var n;return Object(i.f)(this,(function(r){switch(r.label){case 0:return[4,a(e)];case 1:return n=r.sent(),Object(o.c)(e,n),[2]}}))}))}r.d(n,"stashSessionDataResponses",(function(){return s}))},1959:function(e,n,r){"use strict";r.d(n,"f",(function(){return i})),r.d(n,"d",(function(){return o})),r.d(n,"j",(function(){return t})),r.d(n,"a",(function(){return d})),r.d(n,"g",(function(){return l})),r.d(n,"b",(function(){return u})),r.d(n,"h",(function(){return a})),r.d(n,"l",(function(){return s})),r.d(n,"k",(function(){return f})),r.d(n,"i",(function(){return c})),r.d(n,"c",(function(){return v})),r.d(n,"e",(function(){return I}));var i=["journal","outbox","syncissues"],o="archivemsgfolderroot",t="msgfolderroot",d="archivedeleteditems",l="deleteditems",u="archiverecoverableitemsdeletions",a="recoverableitemsdeletions",s="msgfolderroot",f="sharedFolderTree",c="primaryFolderTree",v="archiveFolderTree",I="favorites"},2901:function(e,n,r){"use strict";var i=function(e,n){var r,i;if(e.ExtendedProperty)for(var o=0;o<e.ExtendedProperty.length;o++){var t=e.ExtendedProperty[o];if((null===(r=null==t?void 0:t.ExtendedFieldURI)||void 0===r?void 0:r.PropertyTag)===n||(null===(i=null==t?void 0:t.ExtendedFieldURI)||void 0===i?void 0:i.PropertyName)===n)return t.Value}},o=function(e){var n=i(e,"SourceWellKnownFolderType");return n&&parseInt(n,10)||-1},t=function(e){return i(e,"0x7018")||null},d=function(e){return"false"!==i(e,"0x10f4")},l=r(1959),u=r(23);function a(e,n,r,i,o,t,u){var a,f=e.RootFolder;if(!f||!f.Folders||!f.ParentFolder)throw new Error("folderHierarchyWeb: failed to get folders");var c=[];null==f||f.Folders.forEach((function(e){if(e&&function(e,n,r){if(i=null==e?void 0:e.__type,"Folder:#Exchange"!=i)return!1;var i;if((null==e?void 0:e.DistinguishedFolderId)&&l.f.indexOf(e.DistinguishedFolderId)>=0)return!1;if(d(e))return!1;if("clutter"===e.DistinguishedFolderId&&0===e.TotalCount)return!1;if("junkemail"===e.DistinguishedFolderId)return!!n;if("notes"===e.DistinguishedFolderId)return!!r;return!0}(e,i,o)){var r=s(e,n);if(r&&(c.push(r),null==u?void 0:u[r.FolderId.Id])){var t=u[r.FolderId.Id];r.ReplicaList=t,r.mailboxInfo.auxiliaryMailboxGuid=t[0]}}}));var v=function(e,n){return"SharedMailbox"===n?void 0:e}((null===(a=null==f?void 0:f.ParentFolder)||void 0===a?void 0:a.DistinguishedFolderId)||"none",n.type);f.ParentFolder.DistinguishedFolderId=v;var I=s(f.ParentFolder,n);return t&&function(e,n,r){if(e){var i={},o={},t=[];i[e.FolderId.Id]=e,t.push(e.FolderId.Id),n.forEach((function(e){e&&(i[e.FolderId.Id]=e,t.push(e.FolderId.Id))})),t.forEach((function(e){var n,r=i[e],t=null===(n=r.ParentFolderId)||void 0===n?void 0:n.Id;r.DistinguishedFolderId&&(o[r.DistinguishedFolderId]=e);var d=t&&i[t];d&&d.childFolderIds.push(e)}));var d=[];r.forEach((function(e){var n=o[e];n&&d.push(n)}));for(var l=e.childFolderIds||[],u=0;u<l.length;u++){var a=l[u]||null;a&&-1==d.indexOf(a)&&d.push(a)}e.childFolderIds=d}}(I,c,r),{__typename:"FolderHierarchyResult",Folders:c,RootFolder:I,IndexedPagingOffset:f.IndexedPagingOffset,TotalItemsInView:f.TotalItemsInView,IncludesLastItemInRange:f.IncludesLastItemInRange}}function s(e,n){var r=e,i=r.FolderId,d=r.ParentFolderId,l=r.DisplayName,a=r.ArchiveTag,s=r.PolicyTag,I=r.ChildFolderCount,g=r.UnreadCount,h=r.TotalCount,F=r.FolderClass,b=r.DistinguishedFolderId;if(!i||!d)return u.g.warn("mapOWSFolderToGql: ignoring folder with missing folderId or missing parentFolderId"),null;var m=I||0,p=c(i);return{id:p.Id,__typename:"MailFolder",type:r.__type,FolderId:p,ParentFolderId:c(d),DisplayName:l||"",DistinguishedFolderId:b||null,FolderClass:F||"IPF.Note",UnreadCount:g||0,TotalCount:h||0,ArchiveTag:a?v(a):null,PolicyTag:s?v(s):null,hasChildren:m>0,remoteFolderDisplayName:t(r),sourceWellKnownFolderType:o(r),ReplicaList:r.ReplicaList,PermissionSet:r.PermissionSet,size:f(r),childFolderIds:[],pausedTotalCount:null,principalSMTPAddress:null,mailboxInfo:{type:n.type,userIdentity:n.userIdentity,mailboxSmtpAddress:n.mailboxSmtpAddress,auxiliaryMailboxGuid:n.auxiliaryMailboxGuid}}}function f(e){var n,r;return null===(r=null===(n=e.ExtendedProperty)||void 0===n?void 0:n[0])||void 0===r?void 0:r.Value}function c(e){return{__typename:"FolderId",Id:e.Id,ChangeKey:e.ChangeKey}}function v(e){return{__typename:"RetentionTagType",IsExplicit:e.IsExplicit,Value:e.Value}}r.d(n,"a",(function(){return o})),r.d(n,"b",(function(){return a})),r.d(n,"c",(function(){return s}))},3305:function(e,n,r){"use strict";r.d(n,"c",(function(){return g})),r.d(n,"e",(function(){return h})),r.d(n,"d",(function(){return F})),r.d(n,"f",(function(){return b})),r.d(n,"g",(function(){return m})),r.d(n,"a",(function(){return p})),r.d(n,"b",(function(){return y}));var i,o,t,d,l,u,a=r(1),s=r(15),f=r(2901),c=r(4785),v=r(910),I=r(23);function g(e,n){var r,a,s,f,c,v;i=u?void 0:e.findConversation,o=u?void 0:null==n?void 0:n.conversationRows,l=u?void 0:e.findMailFolderItem,(null===(a=null===(r=e.findFolders)||void 0===r?void 0:r.Header)||void 0===a?void 0:a.ServerVersionInfo)||(null===(f=null===(s=e.findConversation)||void 0===s?void 0:s.Header)||void 0===f?void 0:f.ServerVersionInfo)||(null===(v=null===(c=e.findMailFolderItem)||void 0===c?void 0:c.Header)||void 0===v?void 0:v.ServerVersionInfo),t=e.findFolders,d=null==n?void 0:n.folderHierarchy}function h(e,n){var r,t=y(i,(function(e){return e.Body}),"fcr");if(i=void 0,o=void 0,u=!0,t){var d=void 0;if(e!=(null===(r=t.FolderId)||void 0===r?void 0:r.Id)?d="wf":t.Conversations?"number"==typeof t.IndexedOffset&&n===t.Conversations.length-t.IndexedOffset||(d="wi"):d="ni",Object(s.b)("fcr",d||"s"),!d)return t}return null}function F(e,n){return Object(a.c)(this,void 0,void 0,(function(){var r,t,d,l;return Object(a.f)(this,(function(a){switch(a.label){case 0:return r="fcr",t=o,d=i,i=void 0,o=void 0,u=!0,t||!d?[3,2]:[4,v.b.importAndExecute(d)];case 1:t=a.sent(),a.label=2;case 2:return t?(e!=t.folderId?l="wf":0!==n&&(l="wi"),Object(s.b)(r,l||"s"),[2,l?null:t]):[2,null]}}))}))}function b(e,n,r){var i=y(l,(function(e){var n,r,i;return null===(i=null===(r=null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseMessages)||void 0===r?void 0:r.Items)||void 0===i?void 0:i[0]}),"fir");if(l=void 0,u=!0,i){var o=void 0,t=null==i?void 0:i.RootFolder;if(e!=r?o="wf":(null==t?void 0:t.Items)?"number"==typeof t.IndexedPagingOffset&&n===t.Items.length-t.IndexedPagingOffset||(o="wi"):o="ni",Object(s.b)("fir",o||"s"),!o)return i}return null}function m(e){var n=d,r=t;return d=void 0,t=void 0,!n&&r&&(n=function(e,n){var r=p(e);if(!r)return;try{return Object(f.b)(r,n,[],Object(c.a)("junkemail"),Object(c.a)("notes"),!1)}catch(e){return void I.g.warn("tryGetFolderHierarchyFromResponse: "+e.message)}}(r,e)),n&&Object(s.b)("ffr","s"),n}function p(e){return y(e,(function(e){var n,r,i;return null===(i=null===(r=null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseMessages)||void 0===r?void 0:r.Items)||void 0===i?void 0:i[0]}),"ffr")}function y(e,n,r){var i="njr";if(e){var o=n(e);if(o){if("Error"!=o.ResponseClass)return o;i="e",Object(s.b)(r+"_c",o.ResponseCode||"un")}else i="nrm"}return Object(s.b)(r,i),null}},4785:function(e,n,r){"use strict";var i=r(57),o=r(24);function t(e){var n,r=Object(i.h)().SegmentationSettings,t=null===(n=Object(i.h)().SessionSettings)||void 0===n?void 0:n.IsShadowMailbox;return"junkemail"===e?!!(null==r?void 0:r.JunkEMail):"notes"!==e||!!(null==r?void 0:r.StickyNotes)&&Object(o.i)("cal-stickyNotesFolder")&&!t}r.d(n,"a",(function(){return t}))}}]);
//# sourceMappingURL=owa.SessionDataStash.js.map
self.scriptsLoaded['owa.SessionDataStash.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SessionDataStash.js'] = (new Date()).getTime();