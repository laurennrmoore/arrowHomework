self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Signature.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1030],{10331:function(t,e,n){"use strict";n.r(e);var a=n(1),r=n(151),i=n(2),u=n(2842),o=Object(i.mutatorAction)("setDefaultSignatureName",(function(t,e){e?Object(u.a)().defaultReplySignatureName=t:Object(u.a)().defaultSignatureName=t})),c=Object(i.mutatorAction)("setLegacySignatureInStore",(function(t,e){"html"==t?Object(u.a)().legacySignature.html=e:"txt"==t&&(Object(u.a)().legacySignature.txt=e)})),l=Object(i.mutatorAction)("setRoamingSignatureInStore",(function(t){var e=Object(u.a)().roamingSignatureMap;if("htm"==t.secondaryKey)(n=e.get(t.name))?n.html=t:n={html:t,txt:null},e.set(t.name,n);else if("txt"==t.secondaryKey){var n;(n=e.get(t.name))?n.txt=t:n={html:null,txt:t},e.set(t.name,n)}})),s=n(57),g=n(7547),f=n(6),m=n(16530),d="dataURI";function b(){var t,e,n=Object(u.a)(),a=n.roamingSignatureMap,r=n.legacySignature,i=Object(s.h)().UserOptions,c=i.AutoAddSignature,b=i.AutoAddSignatureOnReply,v=null===(t=r.html)||void 0===t?void 0:t.value;if(v){var O=function(t){for(var e=(new DOMParser).parseFromString(t,"text/html"),n=e.getElementsByTagName("img"),a=0;a<n.length;a++){var r=n[a];if(!r.currentSrc){var i=r.nextElementSibling;i.id==d&&(r.src=i.textContent,r.parentElement.removeChild(i))}}return e.body.innerHTML}(v),S={name:Object(f.b)(m.a),value:O,secondaryKey:"htm"};if(l(S),null===(e=r.txt)||void 0===e?void 0:e.value){var j={name:Object(f.b)(m.a),value:r.txt.value,secondaryKey:"txt"};l(j)}Object(g.c)(a),Object(g.d)(),c&&(o(Object(f.b)(m.a),!1),Object(g.b)(Object(f.b)(m.a))),b&&(o(Object(f.b)(m.a),!0),Object(g.a)(Object(f.b)(m.a)))}}var v,O=n(6248);function S(){return Object(a.c)(this,void 0,void 0,(function(){return Object(a.f)(this,(function(t){return v||(v=Object(r.b)(O.a+"?settingname="+O.f+","+O.i+","+O.h+","+O.e+","+O.c,null,!1,{"x-outlook-client":"owa"}).then((function(t){var e;t.forEach((function(t){var n,a;switch(null===(n=t.name)||void 0===n?void 0:n.toLowerCase()){case O.f:c("html",t);break;case O.i:c("txt",t);break;case O.h:e=t.value,a=t.value,Object(r.b)(O.a+"?settingname="+a,null,!1,{"x-islargesetting":!0}).then((function(t){t.forEach((function(t){l(t)}))}));break;case O.e:o(t.value,!1);break;case O.c:o(t.value,!0)}})),e&&""!=e||b()}))),[2,v]}))}))}var j=n(5054),h=n(19),p=n(24);function x(){return Object(a.c)(this,void 0,void 0,(function(){var t,e;return Object(a.f)(this,(function(n){if(function(){var t;return Object(p.i)("cmp-roaming-signature")&&!(null===(t=Object(h.a)().SessionSettings)||void 0===t?void 0:t.IsExplicitLogon)}()){if(null===(t=Object(u.a)()).legacySignature.html||null===t.legacySignature.txt)return[2,S()]}else if(null===(e=Object(h.a)().UserOptions).SignatureHtml||null===e.SignatureText)return[2,j.a.importAndExecute()];return[2,Promise.resolve()]}))}))}n.d(e,"loadSignature",(function(){return x}))},16530:function(t){t.exports=JSON.parse('{"a":"i_a"}')},2842:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return o}));var a=n(14),r=n(2),i={legacySignature:{html:null,txt:null},roamingSignatureMap:new a.ObservableMap,defaultSignatureName:"",defaultReplySignatureName:""},u=Object(r.createStore)("signature",i),o=u()},5054:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n(31),r=new a.c((function(){return n.e(941).then(n.bind(null,7752))})),i=new a.a(r,(function(t){return t.loadSignatureInUserOptions}))},6248:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"g",(function(){return r})),n.d(e,"d",(function(){return i})),n.d(e,"b",(function(){return u})),n.d(e,"f",(function(){return o})),n.d(e,"i",(function(){return c})),n.d(e,"h",(function(){return l})),n.d(e,"e",(function(){return s})),n.d(e,"c",(function(){return g}));var a="/ows/beta/OutlookCloudSettings/settings/account",r="Roaming_Signature_List",i="Roaming_New_Signature",u="Roaming_Reply_Signature",o="signaturehtml",c="signaturetxt",l=r.toLowerCase(),s=i.toLowerCase(),g=u.toLowerCase()},7547:function(t,e,n){"use strict";n.d(e,"c",(function(){return f})),n.d(e,"d",(function(){return m})),n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return b}));var a=n(1),r=n(2842),i=n(151),u=n(6248),o=n(19),c=621355968e9,l=1e4,s="encoding:utf-8",g={"x-outlook-client":"owa",Accept:"application/json","x-overridetimestamp":!0};function f(t){var e=[];t.forEach((function(t,n){e.push.apply(e,Object(a.j)([],Object(a.g)(function(t){var e=t.html.name,n=t.txt?t.txt.value:"";return[v(e,t.html.value,"Blob","RoamingSetting","htm",!0,"roaming_signature_list"),v(e,n,"Blob","RoamingSetting","txt",!0,"roaming_signature_list")]}(t))))})),e.length>0&&Object(i.d)(u.a,e,null,!0,Object(a.a)(Object(a.a)({},g),{"x-islargesetting":!0}))}function m(){var t=r.b.roamingSignatureMap,e=[];t.forEach((function(t){var n;(null===(n=t.html)||void 0===n?void 0:n.name)&&e.push(t.html.name)}));var n=[v(u.g,e.join(),"BlobArray","RoamingSetting",u.g,!1)];Object(i.d)(u.a,n,null,!0,g)}function d(t){var e=[v(u.d,t,"String","RoamingSetting",u.d,!1)];Object(i.d)(u.a,e,null,!0,g)}function b(t){var e=[v(u.b,t,"String","RoamingSetting",u.b,!1)];Object(i.d)(u.a,e,null,!0,g)}function v(t,e,n,a,r,i,u){var g={name:t,value:e,type:n,scope:Object(o.a)().SessionSettings.UserEmailAddress,itemClass:a,timestamp:c+Date.now()*l,secondaryKey:r,metadata:s};return u&&(g.parentSetting=u),i&&(g["value@is.Large"]=i),g}}}]);
//# sourceMappingURL=owa.Signature.js.map
self.scriptsLoaded['owa.Signature.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Signature.js'] = (new Date()).getTime();