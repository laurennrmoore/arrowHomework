self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.UpsellModuleAsync.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1072],{11604:function(e,n,t){"use strict";t.d(n,"d",(function(){return r})),t.d(n,"e",(function(){return i})),t.d(n,"b",(function(){return l})),t.d(n,"c",(function(){return c})),t.d(n,"a",(function(){return u}));var r="mailtoHandlerOperation",i="mailtoHandlerOperationTime",l="mailtoHandlerIgnoredCount",c=14,u=6048e5},18340:function(e,n,t){"use strict";t.r(n);var r,i=t(1),l=t(20),c=t(0),u=t(1083),o=t(31),a=new o.c((function(){return t.e(1071).then(t.bind(null,18377))})),s=Object(o.d)(a,(function(e){return e.EdgeUpsellBanner})),d=Object(o.d)(a,(function(e){return e.IrisUpsellBanner})),f=t(8231),b=new o.c((function(){return t.e(934).then(t.bind(null,18547))})),w=Object(o.d)(b,(function(e){return e.MailtoProtocolUpsellBanner})),p=t(2);!function(e){e.IrisUpsell="IrisUpsell",e.EdgeUpsell="EdgeUpsell",e.OWAMailHandlerUpsell="OWAMailHandlerUpsell",e.None=""}(r||(r={}));var O=Object(p.createStore)("UpsellBannerState",{upsellBannerType:r.None})(),j=t(24),m=t(8223),v=Object(p.mutatorAction)("setUpsellBannerType",(function(e){O.upsellBannerType=e})),U=t(67),g=function(){return Object(i.c)(this,void 0,void 0,(function(){var e;return Object(i.f)(this,(function(n){switch(n.label){case 0:return Object(j.i)("fwk-mailtoProtocolHandler")&&Object(f.a)()&&Object(f.b)()?(v(r.OWAMailHandlerUpsell),[2,!0]):[3,1];case 1:return Object(U.k)()||Object(U.f)()||Object(U.q)()||Object(U.m)()?[3,6]:Object(j.i)("edge-iris-upsell-experiment")?[4,m.b.import()]:[3,5];case 2:return(null==(e=n.sent())?void 0:e.message)?[3,4]:[4,m.c.importAndExecute()];case 3:n.sent(),n.label=4;case 4:return v(e.message?r.IrisUpsell:r.None),[2,!!e.message];case 5:if(Object(j.i)("edge-upsell-experiment"))return v(r.EdgeUpsell),[2,!0];n.label=6;case 6:return[2,!1]}}))}))},B=Object(l.a)((function(){var e=Object(i.g)(c.useState(!1),2),n=e[0],t=e[1];if(c.useEffect((function(){!function(){Object(i.c)(this,void 0,void 0,(function(){var e;return Object(i.f)(this,(function(n){switch(n.label){case 0:return[4,g()];case 1:return e=n.sent(),t(e),[2]}}))}))}()}),[]),n)switch(O.upsellBannerType){case r.IrisUpsell:return c.createElement(d,{lid:u.b.EdgeUpsell});case r.EdgeUpsell:return c.createElement(s,{lid:u.b.EdgeUpsell});case r.OWAMailHandlerUpsell:return c.createElement(w,{lid:u.b.MailtoProtocolHandler});default:return c.createElement("div",null)}return null}));t.d(n,"TopUpsellBanner",(function(){return B}))},8223:function(e,n,t){"use strict";t.d(n,"c",(function(){return l})),t.d(n,"d",(function(){return c})),t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return o})),t.d(n,"f",(function(){return a})),t.d(n,"e",(function(){return s}));var r=t(31),i=new r.c((function(){return Promise.all([t.e(4),t.e(491)]).then(t.bind(null,12172))})),l=new r.a(i,(function(e){return e.initializeUpsellBarState})),c=new r.a(i,(function(e){return e.initializeLeftNavUpsellState})),u=new r.b(i,(function(e){return e.ArcStore})),o=new r.b(i,(function(e){return e.BizBarArcStore})),a=new r.a(i,(function(e){return e.makeImpressionCall})),s=new r.a(i,(function(e){return e.makeBeaconCall}))},8231:function(e,n,t){"use strict";t.d(n,"a",(function(){return l})),t.d(n,"c",(function(){return c})),t.d(n,"b",(function(){return u}));var r=t(11604),i=t(11);function l(){var e;return!!(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.registerProtocolHandler)}function c(){if(!Object(i.b)(window,r.d)){var e=Object(i.a)(window,r.b);if(e){var n=parseInt(e);Object(i.e)(window,r.b,(n+1).toString())}else Object(i.e)(window,r.b,"1")}}function u(){if(Object(i.c)(window)){if(Object(i.b)(window,r.d))return"TryItNow"!==Object(i.a)(window,r.d)&&"Close"!==Object(i.a)(window,r.d)&&(new Date).getTime()-Number(Object(i.a)(window,r.e))>=r.a;var e=Object(i.a)(window,r.b);return!e||parseInt(e)<=r.c}return!1}}}]);
//# sourceMappingURL=owa.UpsellModuleAsync.js.map
self.scriptsLoaded['owa.UpsellModuleAsync.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.UpsellModuleAsync.js'] = (new Date()).getTime();